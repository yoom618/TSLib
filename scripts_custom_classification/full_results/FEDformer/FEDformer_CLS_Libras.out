Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.838690280914307
Epoch: 1, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.002 Vali Acc: 0.567 Test Loss: 2.002 Test Acc: 0.567
Validation loss decreased (inf --> -0.566647).  Saving model ...
Epoch: 2 cost time: 3.587005138397217
Epoch: 2, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.280 Vali Acc: 0.683 Test Loss: 1.280 Test Acc: 0.683
Validation loss decreased (-0.566647 --> -0.683321).  Saving model ...
Epoch: 3 cost time: 3.372786283493042
Epoch: 3, Steps: 12 | Train Loss: 1.043 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
Validation loss decreased (-0.683321 --> -0.722213).  Saving model ...
Epoch: 4 cost time: 3.411210775375366
Epoch: 4, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.769 Vali Acc: 0.772 Test Loss: 0.769 Test Acc: 0.772
Validation loss decreased (-0.722213 --> -0.772215).  Saving model ...
Epoch: 5 cost time: 3.4783811569213867
Epoch: 5, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
Validation loss decreased (-0.772215 --> -0.827772).  Saving model ...
Epoch: 6 cost time: 3.268871784210205
Epoch: 6, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.568 Vali Acc: 0.822 Test Loss: 0.568 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3600072860717773
Epoch: 7, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 8 cost time: 3.394470691680908
Epoch: 8, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
Validation loss decreased (-0.844439 --> -0.883329).  Saving model ...
Epoch: 9 cost time: 3.426558494567871
Epoch: 9, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.499 Vali Acc: 0.906 Test Loss: 0.499 Test Acc: 0.906
Validation loss decreased (-0.883329 --> -0.905551).  Saving model ...
Epoch: 10 cost time: 3.38655161857605
Epoch: 10, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.434 Vali Acc: 0.867 Test Loss: 0.434 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.439127206802368
Epoch: 11, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.582 Vali Acc: 0.894 Test Loss: 0.582 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6130199432373047
Epoch: 12, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.546 Vali Acc: 0.889 Test Loss: 0.546 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.581033229827881
Epoch: 13, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.535 Vali Acc: 0.906 Test Loss: 0.535 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4276983737945557
Epoch: 14, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.570 Vali Acc: 0.900 Test Loss: 0.570 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3457465171813965
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.499242067337036
Epoch: 16, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.747 Vali Acc: 0.867 Test Loss: 0.747 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.568342447280884
Epoch: 17, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4554340839385986
Epoch: 18, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.894 Test Loss: 0.688 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.404860496520996
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.089564800262451
Epoch: 1, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.124 Vali Acc: 0.522 Test Loss: 2.124 Test Acc: 0.522
Validation loss decreased (inf --> -0.522201).  Saving model ...
Epoch: 2 cost time: 3.5427513122558594
Epoch: 2, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.420 Vali Acc: 0.617 Test Loss: 1.420 Test Acc: 0.617
Validation loss decreased (-0.522201 --> -0.616652).  Saving model ...
Epoch: 3 cost time: 3.6992366313934326
Epoch: 3, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.078 Vali Acc: 0.683 Test Loss: 1.078 Test Acc: 0.683
Validation loss decreased (-0.616652 --> -0.683323).  Saving model ...
Epoch: 4 cost time: 3.494770050048828
Epoch: 4, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.936 Vali Acc: 0.744 Test Loss: 0.936 Test Acc: 0.744
Validation loss decreased (-0.683323 --> -0.744435).  Saving model ...
Epoch: 5 cost time: 3.5755834579467773
Epoch: 5, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.659 Vali Acc: 0.817 Test Loss: 0.659 Test Acc: 0.817
Validation loss decreased (-0.744435 --> -0.816660).  Saving model ...
Epoch: 6 cost time: 3.2885849475860596
Epoch: 6, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.665 Vali Acc: 0.828 Test Loss: 0.665 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 7 cost time: 3.716592311859131
Epoch: 7, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
Validation loss decreased (-0.827771 --> -0.855550).  Saving model ...
Epoch: 8 cost time: 3.765946865081787
Epoch: 8, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
Validation loss decreased (-0.855550 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 3.2845311164855957
Epoch: 9, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.616 Vali Acc: 0.894 Test Loss: 0.616 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894438).  Saving model ...
Epoch: 10 cost time: 3.5966603755950928
Epoch: 10, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.632183074951172
Epoch: 11, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.894438 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 3.4854354858398438
Epoch: 12, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9797754287719727
Epoch: 13, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.589 Vali Acc: 0.889 Test Loss: 0.589 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.539287805557251
Epoch: 14, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6905527114868164
Epoch: 15, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.577 Vali Acc: 0.883 Test Loss: 0.577 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7814390659332275
Epoch: 16, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.802865743637085
Epoch: 17, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 3.57768177986145
Epoch: 18, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.539 Vali Acc: 0.894 Test Loss: 0.539 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7295992374420166
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 3.5677998065948486
Epoch: 20, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.582 Vali Acc: 0.906 Test Loss: 0.582 Test Acc: 0.906
Validation loss decreased (-0.899994 --> -0.905550).  Saving model ...
Epoch: 21 cost time: 3.8198437690734863
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3051280975341797
Epoch: 22, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.598 Vali Acc: 0.883 Test Loss: 0.598 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.651503324508667
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.748 Vali Acc: 0.867 Test Loss: 0.748 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.604182243347168
Epoch: 24, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.557 Vali Acc: 0.894 Test Loss: 0.557 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6197781562805176
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.897 Vali Acc: 0.833 Test Loss: 0.897 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.664576530456543
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.095 Vali Acc: 0.794 Test Loss: 1.095 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.618191719055176
Epoch: 27, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.561 Vali Acc: 0.767 Test Loss: 1.561 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5512521266937256
Epoch: 28, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.473 Vali Acc: 0.756 Test Loss: 1.473 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.301636219024658
Epoch: 29, Steps: 12 | Train Loss: 0.372 Vali Loss: 1.199 Vali Acc: 0.806 Test Loss: 1.199 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.274820327758789
Epoch: 30, Steps: 12 | Train Loss: 0.333 Vali Loss: 1.510 Vali Acc: 0.761 Test Loss: 1.510 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.780919313430786
Epoch: 1, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.291 Vali Acc: 0.383 Test Loss: 2.291 Test Acc: 0.383
Validation loss decreased (inf --> -0.383310).  Saving model ...
Epoch: 2 cost time: 3.2607243061065674
Epoch: 2, Steps: 12 | Train Loss: 2.040 Vali Loss: 1.649 Vali Acc: 0.522 Test Loss: 1.649 Test Acc: 0.522
Validation loss decreased (-0.383310 --> -0.522206).  Saving model ...
Epoch: 3 cost time: 3.2598135471343994
Epoch: 3, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.240 Vali Acc: 0.639 Test Loss: 1.240 Test Acc: 0.639
Validation loss decreased (-0.522206 --> -0.638876).  Saving model ...
Epoch: 4 cost time: 3.8186402320861816
Epoch: 4, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.106 Vali Acc: 0.672 Test Loss: 1.106 Test Acc: 0.672
Validation loss decreased (-0.638876 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 3.3986167907714844
Epoch: 5, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
Validation loss decreased (-0.672211 --> -0.722214).  Saving model ...
Epoch: 6 cost time: 3.7397043704986572
Epoch: 6, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.824 Vali Acc: 0.772 Test Loss: 0.824 Test Acc: 0.772
Validation loss decreased (-0.722214 --> -0.772214).  Saving model ...
Epoch: 7 cost time: 3.3708996772766113
Epoch: 7, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.741 Vali Acc: 0.800 Test Loss: 0.741 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 3.3484997749328613
Epoch: 8, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 3.660429000854492
Epoch: 9, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.746 Vali Acc: 0.833 Test Loss: 0.746 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6704769134521484
Epoch: 10, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.751 Vali Acc: 0.839 Test Loss: 0.751 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.513491153717041
Epoch: 11, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5429396629333496
Epoch: 12, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.976 Vali Acc: 0.833 Test Loss: 0.976 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5932443141937256
Epoch: 13, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 3.8186588287353516
Epoch: 14, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.683 Vali Acc: 0.872 Test Loss: 0.683 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 15 cost time: 3.5238919258117676
Epoch: 15, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.768 Vali Acc: 0.867 Test Loss: 0.768 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.418997287750244
Epoch: 16, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.763 Vali Acc: 0.828 Test Loss: 0.763 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.484776496887207
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.788 Vali Acc: 0.861 Test Loss: 0.788 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4335761070251465
Epoch: 18, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.891 Vali Acc: 0.844 Test Loss: 0.891 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.561750888824463
Epoch: 19, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.070 Vali Acc: 0.828 Test Loss: 1.070 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5717525482177734
Epoch: 20, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.787 Vali Acc: 0.878 Test Loss: 0.787 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877770).  Saving model ...
Epoch: 21 cost time: 3.4944515228271484
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.848 Vali Acc: 0.833 Test Loss: 0.848 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2941083908081055
Epoch: 22, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.890 Vali Acc: 0.856 Test Loss: 0.890 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.25390887260437
Epoch: 23, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.791 Vali Acc: 0.856 Test Loss: 0.791 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.5532279014587402
Epoch: 24, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.546492099761963
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.868 Vali Acc: 0.861 Test Loss: 0.868 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.4901254177093506
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.837 Vali Acc: 0.856 Test Loss: 0.837 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.3898823261260986
Epoch: 27, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.831 Vali Acc: 0.856 Test Loss: 0.831 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.847778797149658
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.999 Vali Acc: 0.833 Test Loss: 0.999 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.347970724105835
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.203 Vali Acc: 0.850 Test Loss: 1.203 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.7232203483581543
Epoch: 30, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.936 Vali Acc: 0.822 Test Loss: 0.936 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.387862205505371
Epoch: 1, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.443 Vali Acc: 0.222 Test Loss: 2.443 Test Acc: 0.222
Validation loss decreased (inf --> -0.222198).  Saving model ...
Epoch: 2 cost time: 3.624556303024292
Epoch: 2, Steps: 12 | Train Loss: 2.283 Vali Loss: 1.891 Vali Acc: 0.344 Test Loss: 1.891 Test Acc: 0.344
Validation loss decreased (-0.222198 --> -0.344426).  Saving model ...
Epoch: 3 cost time: 3.5915920734405518
Epoch: 3, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.399 Vali Acc: 0.539 Test Loss: 1.399 Test Acc: 0.539
Validation loss decreased (-0.344426 --> -0.538875).  Saving model ...
Epoch: 4 cost time: 3.60494065284729
Epoch: 4, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.182 Vali Acc: 0.644 Test Loss: 1.182 Test Acc: 0.644
Validation loss decreased (-0.538875 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 3.270551919937134
Epoch: 5, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.942 Vali Acc: 0.728 Test Loss: 0.942 Test Acc: 0.728
Validation loss decreased (-0.644433 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 3.1753556728363037
Epoch: 6, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
Validation loss decreased (-0.727768 --> -0.761103).  Saving model ...
Epoch: 7 cost time: 3.0288920402526855
Epoch: 7, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.841 Vali Acc: 0.744 Test Loss: 0.841 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3030166625976562
Epoch: 8, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.761103 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 3.7697196006774902
Epoch: 9, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.701 Vali Acc: 0.794 Test Loss: 0.701 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.649742364883423
Epoch: 10, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.964 Vali Acc: 0.778 Test Loss: 0.964 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4610941410064697
Epoch: 11, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2981302738189697
Epoch: 12, Steps: 12 | Train Loss: 0.226 Vali Loss: 1.057 Vali Acc: 0.783 Test Loss: 1.057 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.485010862350464
Epoch: 13, Steps: 12 | Train Loss: 0.345 Vali Loss: 1.075 Vali Acc: 0.778 Test Loss: 1.075 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5136213302612305
Epoch: 14, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.717 Vali Acc: 0.828 Test Loss: 0.717 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.4895434379577637
Epoch: 15, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.871 Vali Acc: 0.811 Test Loss: 0.871 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.503441333770752
Epoch: 16, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.544 Vali Acc: 0.783 Test Loss: 1.544 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.6695873737335205
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.017 Vali Acc: 0.833 Test Loss: 1.017 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.5979459285736084
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.886 Vali Acc: 0.811 Test Loss: 0.886 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.894314289093018
Epoch: 1, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.258 Vali Acc: 0.250 Test Loss: 2.258 Test Acc: 0.250
Validation loss decreased (inf --> -0.249977).  Saving model ...
Epoch: 2 cost time: 3.373732328414917
Epoch: 2, Steps: 12 | Train Loss: 2.393 Vali Loss: 1.916 Vali Acc: 0.344 Test Loss: 1.916 Test Acc: 0.344
Validation loss decreased (-0.249977 --> -0.344425).  Saving model ...
Epoch: 3 cost time: 3.5585999488830566
Epoch: 3, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.514 Vali Acc: 0.606 Test Loss: 1.514 Test Acc: 0.606
Validation loss decreased (-0.344425 --> -0.605540).  Saving model ...
Epoch: 4 cost time: 3.3360228538513184
Epoch: 4, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.479 Vali Acc: 0.606 Test Loss: 1.479 Test Acc: 0.606
Validation loss decreased (-0.605540 --> -0.605541).  Saving model ...
Epoch: 5 cost time: 3.5918078422546387
Epoch: 5, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.271 Vali Acc: 0.644 Test Loss: 1.271 Test Acc: 0.644
Validation loss decreased (-0.605541 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 3.4389092922210693
Epoch: 6, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.951 Vali Acc: 0.744 Test Loss: 0.951 Test Acc: 0.744
Validation loss decreased (-0.644432 --> -0.744435).  Saving model ...
Epoch: 7 cost time: 3.4871935844421387
Epoch: 7, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.878 Vali Acc: 0.733 Test Loss: 0.878 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.56773042678833
Epoch: 8, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
Validation loss decreased (-0.744435 --> -0.799994).  Saving model ...
Epoch: 9 cost time: 3.610347270965576
Epoch: 9, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.807 Vali Acc: 0.778 Test Loss: 0.807 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5538365840911865
Epoch: 10, Steps: 12 | Train Loss: 0.437 Vali Loss: 1.043 Vali Acc: 0.761 Test Loss: 1.043 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4327237606048584
Epoch: 11, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.610422372817993
Epoch: 12, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.935 Vali Acc: 0.772 Test Loss: 0.935 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.251866579055786
Epoch: 13, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.316 Vali Acc: 0.767 Test Loss: 1.316 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.345003366470337
Epoch: 14, Steps: 12 | Train Loss: 0.535 Vali Loss: 1.083 Vali Acc: 0.789 Test Loss: 1.083 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.354246139526367
Epoch: 15, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3025715351104736
Epoch: 16, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.888 Vali Acc: 0.811 Test Loss: 0.888 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811102).  Saving model ...
Epoch: 17 cost time: 3.7797508239746094
Epoch: 17, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.925 Vali Acc: 0.811 Test Loss: 0.925 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.498685598373413
Epoch: 18, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.971 Vali Acc: 0.822 Test Loss: 0.971 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 19 cost time: 3.6487085819244385
Epoch: 19, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.243 Vali Acc: 0.817 Test Loss: 1.243 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.175676107406616
Epoch: 20, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.958 Vali Acc: 0.833 Test Loss: 0.958 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833324).  Saving model ...
Epoch: 21 cost time: 3.3672237396240234
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.892 Vali Acc: 0.839 Test Loss: 0.892 Test Acc: 0.839
Validation loss decreased (-0.833324 --> -0.838880).  Saving model ...
Epoch: 22 cost time: 3.45465350151062
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.031 Vali Acc: 0.833 Test Loss: 1.031 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4287943840026855
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.115 Vali Acc: 0.850 Test Loss: 1.115 Test Acc: 0.850
Validation loss decreased (-0.838880 --> -0.849989).  Saving model ...
Epoch: 24 cost time: 3.5464868545532227
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.088 Vali Acc: 0.789 Test Loss: 1.088 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.16733717918396
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.858 Vali Acc: 0.833 Test Loss: 0.858 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5173189640045166
Epoch: 26, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.005 Vali Acc: 0.856 Test Loss: 1.005 Test Acc: 0.856
Validation loss decreased (-0.849989 --> -0.855546).  Saving model ...
Epoch: 27 cost time: 3.6038167476654053
Epoch: 27, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.174 Vali Acc: 0.839 Test Loss: 1.174 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.639212131500244
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.646 Vali Acc: 0.839 Test Loss: 1.646 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6436245441436768
Epoch: 29, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.121 Vali Acc: 0.822 Test Loss: 1.121 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.556079149246216
Epoch: 30, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.236 Vali Acc: 0.750 Test Loss: 1.236 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.373769760131836
Epoch: 31, Steps: 12 | Train Loss: 0.399 Vali Loss: 1.539 Vali Acc: 0.811 Test Loss: 1.539 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.7414703369140625
Epoch: 32, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.987 Vali Acc: 0.844 Test Loss: 0.987 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.528656482696533
Epoch: 33, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.394 Vali Acc: 0.822 Test Loss: 1.394 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.7604522705078125
Epoch: 34, Steps: 12 | Train Loss: 0.445 Vali Loss: 1.277 Vali Acc: 0.839 Test Loss: 1.277 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.546926975250244
Epoch: 35, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.676 Vali Acc: 0.800 Test Loss: 1.676 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.761709213256836
Epoch: 36, Steps: 12 | Train Loss: 0.483 Vali Loss: 1.280 Vali Acc: 0.811 Test Loss: 1.280 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.196125507354736
Epoch: 1, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.028 Vali Acc: 0.344 Test Loss: 2.028 Test Acc: 0.344
Validation loss decreased (inf --> -0.344424).  Saving model ...
Epoch: 2 cost time: 3.728656053543091
Epoch: 2, Steps: 12 | Train Loss: 2.444 Vali Loss: 1.999 Vali Acc: 0.378 Test Loss: 1.999 Test Acc: 0.378
Validation loss decreased (-0.344424 --> -0.377758).  Saving model ...
Epoch: 3 cost time: 3.4887688159942627
Epoch: 3, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.678 Vali Acc: 0.511 Test Loss: 1.678 Test Acc: 0.511
Validation loss decreased (-0.377758 --> -0.511094).  Saving model ...
Epoch: 4 cost time: 3.5827741622924805
Epoch: 4, Steps: 12 | Train Loss: 1.252 Vali Loss: 1.544 Vali Acc: 0.589 Test Loss: 1.544 Test Acc: 0.589
Validation loss decreased (-0.511094 --> -0.588873).  Saving model ...
Epoch: 5 cost time: 3.584930181503296
Epoch: 5, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.286 Vali Acc: 0.633 Test Loss: 1.286 Test Acc: 0.633
Validation loss decreased (-0.588873 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 3.3757026195526123
Epoch: 6, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.965 Vali Acc: 0.717 Test Loss: 0.965 Test Acc: 0.717
Validation loss decreased (-0.633320 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 3.553178071975708
Epoch: 7, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.833 Vali Acc: 0.744 Test Loss: 0.833 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 3.198035717010498
Epoch: 8, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.678 Vali Acc: 0.806 Test Loss: 0.678 Test Acc: 0.806
Validation loss decreased (-0.744436 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 3.4341156482696533
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.862 Vali Acc: 0.739 Test Loss: 0.862 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.495692253112793
Epoch: 10, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.991 Vali Acc: 0.756 Test Loss: 0.991 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4680683612823486
Epoch: 11, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.718 Vali Acc: 0.794 Test Loss: 0.718 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.638256549835205
Epoch: 12, Steps: 12 | Train Loss: 0.227 Vali Loss: 1.114 Vali Acc: 0.794 Test Loss: 1.114 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.417239189147949
Epoch: 13, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.939 Vali Acc: 0.794 Test Loss: 0.939 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2874090671539307
Epoch: 14, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.832 Vali Acc: 0.828 Test Loss: 0.832 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827769).  Saving model ...
Epoch: 15 cost time: 3.478363275527954
Epoch: 15, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.48183274269104
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.933 Vali Acc: 0.833 Test Loss: 0.933 Test Acc: 0.833
Validation loss decreased (-0.827769 --> -0.833324).  Saving model ...
Epoch: 17 cost time: 3.572129726409912
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.926 Vali Acc: 0.833 Test Loss: 0.926 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833324).  Saving model ...
Epoch: 18 cost time: 3.434248685836792
Epoch: 18, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.996 Vali Acc: 0.856 Test Loss: 0.996 Test Acc: 0.856
Validation loss decreased (-0.833324 --> -0.855546).  Saving model ...
Epoch: 19 cost time: 3.2583885192871094
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.052 Vali Acc: 0.794 Test Loss: 1.052 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.435556650161743
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.984 Vali Acc: 0.828 Test Loss: 0.984 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2913780212402344
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.840 Vali Acc: 0.844 Test Loss: 0.840 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6942758560180664
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.077 Vali Acc: 0.772 Test Loss: 1.077 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.635946273803711
Epoch: 23, Steps: 12 | Train Loss: 0.196 Vali Loss: 1.222 Vali Acc: 0.783 Test Loss: 1.222 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5968284606933594
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 1.034 Vali Acc: 0.844 Test Loss: 1.034 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4950194358825684
Epoch: 25, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.186 Vali Acc: 0.772 Test Loss: 1.186 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.513864517211914
Epoch: 26, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.121 Vali Acc: 0.883 Test Loss: 1.121 Test Acc: 0.883
Validation loss decreased (-0.855546 --> -0.883322).  Saving model ...
Epoch: 27 cost time: 3.4572930335998535
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.855 Vali Acc: 0.872 Test Loss: 0.855 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4749279022216797
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.227 Vali Acc: 0.833 Test Loss: 1.227 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.630380392074585
Epoch: 29, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.231 Vali Acc: 0.856 Test Loss: 1.231 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4446871280670166
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.064 Vali Acc: 0.833 Test Loss: 1.064 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.336226463317871
Epoch: 31, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.095 Vali Acc: 0.833 Test Loss: 1.095 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.488069534301758
Epoch: 32, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.068 Vali Acc: 0.856 Test Loss: 1.068 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.374415397644043
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.858 Vali Acc: 0.872 Test Loss: 0.858 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.6124956607818604
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.924 Vali Acc: 0.850 Test Loss: 0.924 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.7047743797302246
Epoch: 35, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.184 Vali Acc: 0.844 Test Loss: 1.184 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.3472182750701904
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.960 Vali Acc: 0.844 Test Loss: 0.960 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.285139083862305
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.099 Vali Acc: 0.350 Test Loss: 2.099 Test Acc: 0.350
Validation loss decreased (inf --> -0.349979).  Saving model ...
Epoch: 2 cost time: 3.1663315296173096
Epoch: 2, Steps: 12 | Train Loss: 2.433 Vali Loss: 1.874 Vali Acc: 0.439 Test Loss: 1.874 Test Acc: 0.439
Validation loss decreased (-0.349979 --> -0.438870).  Saving model ...
Epoch: 3 cost time: 3.133070945739746
Epoch: 3, Steps: 12 | Train Loss: 1.968 Vali Loss: 1.661 Vali Acc: 0.539 Test Loss: 1.661 Test Acc: 0.539
Validation loss decreased (-0.438870 --> -0.538872).  Saving model ...
Epoch: 4 cost time: 3.5171453952789307
Epoch: 4, Steps: 12 | Train Loss: 1.283 Vali Loss: 1.531 Vali Acc: 0.561 Test Loss: 1.531 Test Acc: 0.561
Validation loss decreased (-0.538872 --> -0.561096).  Saving model ...
Epoch: 5 cost time: 3.142493724822998
Epoch: 5, Steps: 12 | Train Loss: 0.934 Vali Loss: 1.203 Vali Acc: 0.644 Test Loss: 1.203 Test Acc: 0.644
Validation loss decreased (-0.561096 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 3.319352865219116
Epoch: 6, Steps: 12 | Train Loss: 0.657 Vali Loss: 1.002 Vali Acc: 0.683 Test Loss: 1.002 Test Acc: 0.683
Validation loss decreased (-0.644432 --> -0.683323).  Saving model ...
Epoch: 7 cost time: 3.137007713317871
Epoch: 7, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.817 Vali Acc: 0.744 Test Loss: 0.817 Test Acc: 0.744
Validation loss decreased (-0.683323 --> -0.744436).  Saving model ...
Epoch: 8 cost time: 3.4702041149139404
Epoch: 8, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
Validation loss decreased (-0.744436 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 3.443723678588867
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.837 Vali Acc: 0.772 Test Loss: 0.837 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0755035877227783
Epoch: 10, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.991 Vali Acc: 0.789 Test Loss: 0.991 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.151149272918701
Epoch: 11, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.751 Vali Acc: 0.817 Test Loss: 0.751 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.227052927017212
Epoch: 12, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.911 Vali Acc: 0.833 Test Loss: 0.911 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833324).  Saving model ...
Epoch: 13 cost time: 3.3020031452178955
Epoch: 13, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.894 Vali Acc: 0.817 Test Loss: 0.894 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.225409746170044
Epoch: 14, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.862 Vali Acc: 0.817 Test Loss: 0.862 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5362744331359863
Epoch: 15, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.800 Vali Acc: 0.778 Test Loss: 0.800 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.559436321258545
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.020 Vali Acc: 0.778 Test Loss: 1.020 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1438286304473877
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.935 Vali Acc: 0.806 Test Loss: 0.935 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.116642713546753
Epoch: 18, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.173 Vali Acc: 0.828 Test Loss: 1.173 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2603821754455566
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.022 Vali Acc: 0.811 Test Loss: 1.022 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.5268845558166504
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.202 Vali Acc: 0.794 Test Loss: 1.202 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.52667236328125
Epoch: 21, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.371 Vali Acc: 0.789 Test Loss: 1.371 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.524416923522949
Epoch: 22, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.934 Vali Acc: 0.811 Test Loss: 0.934 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.961328506469727
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.1916468143463135
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0355653762817383
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.971648931503296
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0427467823028564
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.48892879486084
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.1664681434631348
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.591799259185791
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.4582738876342773
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.296888828277588
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1984355449676514
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 13743119
model size : 71.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.430300235748291
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.141 Vali Acc: 0.461 Test Loss: 2.141 Test Acc: 0.461
Validation loss decreased (inf --> -0.461090).  Saving model ...
Epoch: 2 cost time: 3.595404863357544
Epoch: 2, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.391 Vali Acc: 0.672 Test Loss: 1.391 Test Acc: 0.672
Validation loss decreased (-0.461090 --> -0.672208).  Saving model ...
Epoch: 3 cost time: 3.4936468601226807
Epoch: 3, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.053 Vali Acc: 0.711 Test Loss: 1.053 Test Acc: 0.711
Validation loss decreased (-0.672208 --> -0.711101).  Saving model ...
Epoch: 4 cost time: 3.609238862991333
Epoch: 4, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
Validation loss decreased (-0.711101 --> -0.772214).  Saving model ...
Epoch: 5 cost time: 3.3028244972229004
Epoch: 5, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
Validation loss decreased (-0.772214 --> -0.822216).  Saving model ...
Epoch: 6 cost time: 3.454943895339966
Epoch: 6, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2510335445404053
Epoch: 7, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.617 Vali Acc: 0.856 Test Loss: 0.617 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855549).  Saving model ...
Epoch: 8 cost time: 3.22248911857605
Epoch: 8, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.486 Vali Acc: 0.872 Test Loss: 0.486 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872217).  Saving model ...
Epoch: 9 cost time: 3.4018783569335938
Epoch: 9, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.427 Vali Acc: 0.894 Test Loss: 0.427 Test Acc: 0.894
Validation loss decreased (-0.872217 --> -0.894440).  Saving model ...
Epoch: 10 cost time: 3.176304578781128
Epoch: 10, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.412 Vali Acc: 0.922 Test Loss: 0.412 Test Acc: 0.922
Validation loss decreased (-0.894440 --> -0.922218).  Saving model ...
Epoch: 11 cost time: 3.257204532623291
Epoch: 11, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.555 Vali Acc: 0.878 Test Loss: 0.555 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.401444435119629
Epoch: 12, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.454 Vali Acc: 0.872 Test Loss: 0.454 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.775273323059082
Epoch: 13, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.462 Vali Acc: 0.906 Test Loss: 0.462 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.231076955795288
Epoch: 14, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.530 Vali Acc: 0.933 Test Loss: 0.530 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933328).  Saving model ...
Epoch: 15 cost time: 3.225362539291382
Epoch: 15, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.446 Vali Acc: 0.894 Test Loss: 0.446 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1746933460235596
Epoch: 16, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.513 Vali Acc: 0.906 Test Loss: 0.513 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.319833278656006
Epoch: 17, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.485 Vali Acc: 0.922 Test Loss: 0.485 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4673991203308105
Epoch: 18, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.906 Test Loss: 0.603 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5913028717041016
Epoch: 19, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.621594190597534
Epoch: 20, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.900 Test Loss: 0.591 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1751012802124023
Epoch: 21, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.4240498542785645
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.4639689922332764
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.717 Vali Acc: 0.872 Test Loss: 0.717 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5553529262542725
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.715 Vali Acc: 0.867 Test Loss: 0.715 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.450777769088745
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.284 Vali Acc: 0.439 Test Loss: 2.284 Test Acc: 0.439
Validation loss decreased (inf --> -0.438866).  Saving model ...
Epoch: 2 cost time: 3.4716200828552246
Epoch: 2, Steps: 12 | Train Loss: 2.021 Vali Loss: 1.545 Vali Acc: 0.617 Test Loss: 1.545 Test Acc: 0.617
Validation loss decreased (-0.438866 --> -0.616651).  Saving model ...
Epoch: 3 cost time: 3.264956474304199
Epoch: 3, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.210 Vali Acc: 0.661 Test Loss: 1.210 Test Acc: 0.661
Validation loss decreased (-0.616651 --> -0.661099).  Saving model ...
Epoch: 4 cost time: 3.3353757858276367
Epoch: 4, Steps: 12 | Train Loss: 0.805 Vali Loss: 0.973 Vali Acc: 0.744 Test Loss: 0.973 Test Acc: 0.744
Validation loss decreased (-0.661099 --> -0.744435).  Saving model ...
Epoch: 5 cost time: 3.4863429069519043
Epoch: 5, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 6 cost time: 3.3710012435913086
Epoch: 6, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 7 cost time: 3.261838436126709
Epoch: 7, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.605 Vali Acc: 0.867 Test Loss: 0.605 Test Acc: 0.867
Validation loss decreased (-0.783325 --> -0.866661).  Saving model ...
Epoch: 8 cost time: 3.5334670543670654
Epoch: 8, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 3.3405275344848633
Epoch: 9, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.705681562423706
Epoch: 10, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.500929832458496
Epoch: 11, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.598 Vali Acc: 0.878 Test Loss: 0.598 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4771218299865723
Epoch: 12, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.27720046043396
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 3.1436214447021484
Epoch: 14, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.663 Vali Acc: 0.861 Test Loss: 0.663 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.101841688156128
Epoch: 15, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.724 Vali Acc: 0.872 Test Loss: 0.724 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2592978477478027
Epoch: 16, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.704 Vali Acc: 0.889 Test Loss: 0.704 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5360944271087646
Epoch: 17, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.729 Vali Acc: 0.867 Test Loss: 0.729 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4617674350738525
Epoch: 18, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.791 Vali Acc: 0.878 Test Loss: 0.791 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.462193012237549
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.731 Vali Acc: 0.889 Test Loss: 0.731 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.3059093952178955
Epoch: 20, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.727 Vali Acc: 0.894 Test Loss: 0.727 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.2433505058288574
Epoch: 21, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.889 Test Loss: 0.741 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4997127056121826
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.739 Vali Acc: 0.889 Test Loss: 0.739 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.453065872192383
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.770 Vali Acc: 0.883 Test Loss: 0.770 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3354668617248535
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.396 Vali Acc: 0.339 Test Loss: 2.396 Test Acc: 0.339
Validation loss decreased (inf --> -0.338865).  Saving model ...
Epoch: 2 cost time: 3.369156837463379
Epoch: 2, Steps: 12 | Train Loss: 2.181 Vali Loss: 1.762 Vali Acc: 0.556 Test Loss: 1.762 Test Acc: 0.556
Validation loss decreased (-0.338865 --> -0.555538).  Saving model ...
Epoch: 3 cost time: 3.8527002334594727
Epoch: 3, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.431 Vali Acc: 0.567 Test Loss: 1.431 Test Acc: 0.567
Validation loss decreased (-0.555538 --> -0.566652).  Saving model ...
Epoch: 4 cost time: 3.3660075664520264
Epoch: 4, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.040 Vali Acc: 0.722 Test Loss: 1.040 Test Acc: 0.722
Validation loss decreased (-0.566652 --> -0.722212).  Saving model ...
Epoch: 5 cost time: 3.47225022315979
Epoch: 5, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.061 Vali Acc: 0.689 Test Loss: 1.061 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3636155128479004
Epoch: 6, Steps: 12 | Train Loss: 0.495 Vali Loss: 1.004 Vali Acc: 0.739 Test Loss: 1.004 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 3.3178446292877197
Epoch: 7, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.748 Vali Acc: 0.778 Test Loss: 0.748 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 3.5553715229034424
Epoch: 8, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.769 Vali Acc: 0.817 Test Loss: 0.769 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816659).  Saving model ...
Epoch: 9 cost time: 3.604917287826538
Epoch: 9, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.841 Vali Acc: 0.833 Test Loss: 0.841 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 3.822493553161621
Epoch: 10, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.742 Vali Acc: 0.833 Test Loss: 0.742 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 3.6962132453918457
Epoch: 11, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.980 Vali Acc: 0.772 Test Loss: 0.980 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2239131927490234
Epoch: 12, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.666 Vali Acc: 0.867 Test Loss: 0.666 Test Acc: 0.867
Validation loss decreased (-0.833326 --> -0.866660).  Saving model ...
Epoch: 13 cost time: 3.4539220333099365
Epoch: 13, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.853 Vali Acc: 0.822 Test Loss: 0.853 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.495124578475952
Epoch: 14, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.766 Vali Acc: 0.822 Test Loss: 0.766 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5997023582458496
Epoch: 15, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.435204267501831
Epoch: 16, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.788 Vali Acc: 0.844 Test Loss: 0.788 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.3933286666870117
Epoch: 17, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.820 Vali Acc: 0.861 Test Loss: 0.820 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2941226959228516
Epoch: 18, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.714 Vali Acc: 0.806 Test Loss: 0.714 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.242544651031494
Epoch: 19, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.130 Vali Acc: 0.828 Test Loss: 1.130 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.345890760421753
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.859 Vali Acc: 0.822 Test Loss: 0.859 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.231990337371826
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.747 Vali Acc: 0.828 Test Loss: 0.747 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.344386339187622
Epoch: 22, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.920 Vali Acc: 0.817 Test Loss: 0.920 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.722954034805298
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.506 Vali Acc: 0.222 Test Loss: 2.506 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 3.0510525703430176
Epoch: 2, Steps: 12 | Train Loss: 2.343 Vali Loss: 1.968 Vali Acc: 0.439 Test Loss: 1.968 Test Acc: 0.439
Validation loss decreased (-0.222197 --> -0.438869).  Saving model ...
Epoch: 3 cost time: 3.219757556915283
Epoch: 3, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.652 Vali Acc: 0.467 Test Loss: 1.652 Test Acc: 0.467
Validation loss decreased (-0.438869 --> -0.466650).  Saving model ...
Epoch: 4 cost time: 3.375511646270752
Epoch: 4, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.101 Vali Acc: 0.683 Test Loss: 1.101 Test Acc: 0.683
Validation loss decreased (-0.466650 --> -0.683322).  Saving model ...
Epoch: 5 cost time: 3.18086314201355
Epoch: 5, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.146 Vali Acc: 0.650 Test Loss: 1.146 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.225106954574585
Epoch: 6, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.992 Vali Acc: 0.739 Test Loss: 0.992 Test Acc: 0.739
Validation loss decreased (-0.683322 --> -0.738879).  Saving model ...
Epoch: 7 cost time: 3.3386051654815674
Epoch: 7, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761103).  Saving model ...
Epoch: 8 cost time: 3.5141124725341797
Epoch: 8, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 3.342228889465332
Epoch: 9, Steps: 12 | Train Loss: 0.282 Vali Loss: 1.012 Vali Acc: 0.811 Test Loss: 1.012 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811101).  Saving model ...
Epoch: 10 cost time: 3.3115713596343994
Epoch: 10, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.371108055114746
Epoch: 11, Steps: 12 | Train Loss: 0.392 Vali Loss: 1.093 Vali Acc: 0.750 Test Loss: 1.093 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.322601079940796
Epoch: 12, Steps: 12 | Train Loss: 0.325 Vali Loss: 1.018 Vali Acc: 0.783 Test Loss: 1.018 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.499929428100586
Epoch: 13, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.840 Vali Acc: 0.800 Test Loss: 0.840 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.35481858253479
Epoch: 14, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.843 Vali Acc: 0.817 Test Loss: 0.843 Test Acc: 0.817
Validation loss decreased (-0.811101 --> -0.816658).  Saving model ...
Epoch: 15 cost time: 3.3726913928985596
Epoch: 15, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.810 Vali Acc: 0.811 Test Loss: 0.810 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3249902725219727
Epoch: 16, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.862 Vali Acc: 0.828 Test Loss: 0.862 Test Acc: 0.828
Validation loss decreased (-0.816658 --> -0.827769).  Saving model ...
Epoch: 17 cost time: 3.3573670387268066
Epoch: 17, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.034 Vali Acc: 0.806 Test Loss: 1.034 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3771438598632812
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.175 Vali Acc: 0.761 Test Loss: 1.175 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5119259357452393
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.918 Vali Acc: 0.833 Test Loss: 0.918 Test Acc: 0.833
Validation loss decreased (-0.827769 --> -0.833324).  Saving model ...
Epoch: 20 cost time: 3.5336737632751465
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.071 Vali Acc: 0.817 Test Loss: 1.071 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.211064577102661
Epoch: 21, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.777 Vali Acc: 0.817 Test Loss: 0.777 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.512143611907959
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.269 Vali Acc: 0.806 Test Loss: 1.269 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.283651113510132
Epoch: 23, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.411 Vali Acc: 0.822 Test Loss: 1.411 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3151214122772217
Epoch: 24, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.125 Vali Acc: 0.833 Test Loss: 1.125 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.1356987953186035
Epoch: 25, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.192 Vali Acc: 0.828 Test Loss: 1.192 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.382477045059204
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.150 Vali Acc: 0.844 Test Loss: 1.150 Test Acc: 0.844
Validation loss decreased (-0.833324 --> -0.844433).  Saving model ...
Epoch: 27 cost time: 3.2541284561157227
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.211 Vali Acc: 0.817 Test Loss: 1.211 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.3363826274871826
Epoch: 28, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.460 Vali Acc: 0.806 Test Loss: 1.460 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.266629695892334
Epoch: 29, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.269 Vali Acc: 0.828 Test Loss: 1.269 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.559091091156006
Epoch: 30, Steps: 12 | Train Loss: 0.222 Vali Loss: 1.401 Vali Acc: 0.794 Test Loss: 1.401 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.5499022006988525
Epoch: 31, Steps: 12 | Train Loss: 0.195 Vali Loss: 1.264 Vali Acc: 0.794 Test Loss: 1.264 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.5885379314422607
Epoch: 32, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.653 Vali Acc: 0.778 Test Loss: 1.653 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.405693531036377
Epoch: 33, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.247 Vali Acc: 0.844 Test Loss: 1.247 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.4029791355133057
Epoch: 34, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.537 Vali Acc: 0.800 Test Loss: 1.537 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.734027624130249
Epoch: 35, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.248 Vali Acc: 0.828 Test Loss: 1.248 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.5470774173736572
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.922 Vali Acc: 0.867 Test Loss: 0.922 Test Acc: 0.867
Validation loss decreased (-0.844433 --> -0.866657).  Saving model ...
Epoch: 37 cost time: 3.569936752319336
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.097 Vali Acc: 0.850 Test Loss: 1.097 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.5039591789245605
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.146 Vali Acc: 0.850 Test Loss: 1.146 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.6444666385650635
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.148 Vali Acc: 0.878 Test Loss: 1.148 Test Acc: 0.878
Validation loss decreased (-0.866657 --> -0.877766).  Saving model ...
Epoch: 40 cost time: 3.4319610595703125
Epoch: 40, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.994 Vali Acc: 0.872 Test Loss: 0.994 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.386054277420044
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.038 Vali Acc: 0.850 Test Loss: 1.038 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.628251075744629
Epoch: 42, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.227 Vali Acc: 0.833 Test Loss: 1.227 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.637505531311035
Epoch: 43, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.367 Vali Acc: 0.839 Test Loss: 1.367 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.3817217350006104
Epoch: 44, Steps: 12 | Train Loss: 0.227 Vali Loss: 1.154 Vali Acc: 0.828 Test Loss: 1.154 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.518404483795166
Epoch: 45, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.417 Vali Acc: 0.833 Test Loss: 1.417 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.4952993392944336
Epoch: 46, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.994 Vali Acc: 0.856 Test Loss: 0.994 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.4416046142578125
Epoch: 47, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.250 Vali Acc: 0.856 Test Loss: 1.250 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.650538682937622
Epoch: 48, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.113 Vali Acc: 0.856 Test Loss: 1.113 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.2532851696014404
Epoch: 49, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.437 Vali Acc: 0.856 Test Loss: 1.437 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.904148101806641
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.319 Vali Acc: 0.267 Test Loss: 2.319 Test Acc: 0.267
Validation loss decreased (inf --> -0.266643).  Saving model ...
Epoch: 2 cost time: 3.4756393432617188
Epoch: 2, Steps: 12 | Train Loss: 2.395 Vali Loss: 1.893 Vali Acc: 0.439 Test Loss: 1.893 Test Acc: 0.439
Validation loss decreased (-0.266643 --> -0.438870).  Saving model ...
Epoch: 3 cost time: 3.24379301071167
Epoch: 3, Steps: 12 | Train Loss: 1.896 Vali Loss: 1.704 Vali Acc: 0.550 Test Loss: 1.704 Test Acc: 0.550
Validation loss decreased (-0.438870 --> -0.549983).  Saving model ...
Epoch: 4 cost time: 3.1722278594970703
Epoch: 4, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
Validation loss decreased (-0.549983 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 3.3234829902648926
Epoch: 5, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.274 Vali Acc: 0.606 Test Loss: 1.274 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605543).  Saving model ...
Epoch: 6 cost time: 3.413986921310425
Epoch: 6, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.118 Vali Acc: 0.717 Test Loss: 1.118 Test Acc: 0.717
Validation loss decreased (-0.605543 --> -0.716655).  Saving model ...
Epoch: 7 cost time: 3.408824920654297
Epoch: 7, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.908 Vali Acc: 0.733 Test Loss: 0.908 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 3.517848014831543
Epoch: 8, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.744 Vali Acc: 0.828 Test Loss: 0.744 Test Acc: 0.828
Validation loss decreased (-0.733324 --> -0.827770).  Saving model ...
Epoch: 9 cost time: 3.396327257156372
Epoch: 9, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.947 Vali Acc: 0.822 Test Loss: 0.947 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.401695966720581
Epoch: 10, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.704 Vali Acc: 0.811 Test Loss: 0.704 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.231569528579712
Epoch: 11, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.975 Vali Acc: 0.761 Test Loss: 0.975 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.054354190826416
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.897 Vali Acc: 0.783 Test Loss: 0.897 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.212991714477539
Epoch: 13, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.311922311782837
Epoch: 14, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.950 Vali Acc: 0.778 Test Loss: 0.950 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1794538497924805
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.852 Vali Acc: 0.783 Test Loss: 0.852 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9891722202301025
Epoch: 16, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.952 Vali Acc: 0.833 Test Loss: 0.952 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833324).  Saving model ...
Epoch: 17 cost time: 3.011103391647339
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 1.072 Vali Acc: 0.772 Test Loss: 1.072 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.193286657333374
Epoch: 18, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.962 Vali Acc: 0.822 Test Loss: 0.962 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3778460025787354
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.957 Vali Acc: 0.844 Test Loss: 0.957 Test Acc: 0.844
Validation loss decreased (-0.833324 --> -0.844435).  Saving model ...
Epoch: 20 cost time: 3.175729274749756
Epoch: 20, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.980 Vali Acc: 0.850 Test Loss: 0.980 Test Acc: 0.850
Validation loss decreased (-0.844435 --> -0.849990).  Saving model ...
Epoch: 21 cost time: 3.1261260509490967
Epoch: 21, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.215 Vali Acc: 0.822 Test Loss: 1.215 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2002477645874023
Epoch: 22, Steps: 12 | Train Loss: 0.540 Vali Loss: 1.409 Vali Acc: 0.833 Test Loss: 1.409 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9776039123535156
Epoch: 23, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.966 Vali Acc: 0.828 Test Loss: 0.966 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.049377202987671
Epoch: 24, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.227 Vali Acc: 0.761 Test Loss: 1.227 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.274397611618042
Epoch: 25, Steps: 12 | Train Loss: 0.292 Vali Loss: 1.357 Vali Acc: 0.833 Test Loss: 1.357 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.17502498626709
Epoch: 26, Steps: 12 | Train Loss: 0.231 Vali Loss: 1.819 Vali Acc: 0.794 Test Loss: 1.819 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1156327724456787
Epoch: 27, Steps: 12 | Train Loss: 0.257 Vali Loss: 1.292 Vali Acc: 0.839 Test Loss: 1.292 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.2647101879119873
Epoch: 28, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.282 Vali Acc: 0.839 Test Loss: 1.282 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.1477410793304443
Epoch: 29, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.058 Vali Acc: 0.828 Test Loss: 1.058 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.2587783336639404
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.162 Vali Acc: 0.839 Test Loss: 1.162 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.841228723526001
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.070 Vali Acc: 0.350 Test Loss: 2.070 Test Acc: 0.350
Validation loss decreased (inf --> -0.349979).  Saving model ...
Epoch: 2 cost time: 3.3379623889923096
Epoch: 2, Steps: 12 | Train Loss: 2.457 Vali Loss: 1.925 Vali Acc: 0.422 Test Loss: 1.925 Test Acc: 0.422
Validation loss decreased (-0.349979 --> -0.422203).  Saving model ...
Epoch: 3 cost time: 3.3123581409454346
Epoch: 3, Steps: 12 | Train Loss: 1.973 Vali Loss: 1.753 Vali Acc: 0.517 Test Loss: 1.753 Test Acc: 0.517
Validation loss decreased (-0.422203 --> -0.516649).  Saving model ...
Epoch: 4 cost time: 3.2243709564208984
Epoch: 4, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.356 Vali Acc: 0.611 Test Loss: 1.356 Test Acc: 0.611
Validation loss decreased (-0.516649 --> -0.611098).  Saving model ...
Epoch: 5 cost time: 3.6362855434417725
Epoch: 5, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.315 Vali Acc: 0.617 Test Loss: 1.315 Test Acc: 0.617
Validation loss decreased (-0.611098 --> -0.616654).  Saving model ...
Epoch: 6 cost time: 3.4388747215270996
Epoch: 6, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.173 Vali Acc: 0.694 Test Loss: 1.173 Test Acc: 0.694
Validation loss decreased (-0.616654 --> -0.694433).  Saving model ...
Epoch: 7 cost time: 3.3706398010253906
Epoch: 7, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.985 Vali Acc: 0.717 Test Loss: 0.985 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716657).  Saving model ...
Epoch: 8 cost time: 3.5109734535217285
Epoch: 8, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
Validation loss decreased (-0.716657 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 3.263965368270874
Epoch: 9, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.859 Vali Acc: 0.772 Test Loss: 0.859 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.235086441040039
Epoch: 10, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.691 Vali Acc: 0.811 Test Loss: 0.691 Test Acc: 0.811
Validation loss decreased (-0.799992 --> -0.811104).  Saving model ...
Epoch: 11 cost time: 3.384300947189331
Epoch: 11, Steps: 12 | Train Loss: 0.383 Vali Loss: 1.073 Vali Acc: 0.778 Test Loss: 1.073 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5269861221313477
Epoch: 12, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.829 Vali Acc: 0.794 Test Loss: 0.829 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.560058832168579
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.792 Vali Acc: 0.783 Test Loss: 0.792 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.214859962463379
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.928 Vali Acc: 0.794 Test Loss: 0.928 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3708930015563965
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.691 Vali Acc: 0.822 Test Loss: 0.691 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 3.3980939388275146
Epoch: 16, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.141 Vali Acc: 0.806 Test Loss: 1.141 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.375339984893799
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.940 Vali Acc: 0.839 Test Loss: 0.940 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838879).  Saving model ...
Epoch: 18 cost time: 3.563969135284424
Epoch: 18, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.067 Vali Acc: 0.833 Test Loss: 1.067 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5390055179595947
Epoch: 19, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.955 Vali Acc: 0.839 Test Loss: 0.955 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.48884654045105
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.102 Vali Acc: 0.783 Test Loss: 1.102 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1993155479431152
Epoch: 21, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.139 Vali Acc: 0.811 Test Loss: 1.139 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.355849266052246
Epoch: 22, Steps: 12 | Train Loss: 0.496 Vali Loss: 1.207 Vali Acc: 0.833 Test Loss: 1.207 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.388014554977417
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.007 Vali Acc: 0.822 Test Loss: 1.007 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.6647305488586426
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.056 Vali Acc: 0.844 Test Loss: 1.056 Test Acc: 0.844
Validation loss decreased (-0.838879 --> -0.844434).  Saving model ...
Epoch: 25 cost time: 3.437776565551758
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.309 Vali Acc: 0.778 Test Loss: 1.309 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.411076307296753
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.193 Vali Acc: 0.822 Test Loss: 1.193 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5252912044525146
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.205 Vali Acc: 0.833 Test Loss: 1.205 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.1048102378845215
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.233 Vali Acc: 0.822 Test Loss: 1.233 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.526911497116089
Epoch: 29, Steps: 12 | Train Loss: 0.294 Vali Loss: 1.638 Vali Acc: 0.833 Test Loss: 1.638 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.2752819061279297
Epoch: 30, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.212 Vali Acc: 0.817 Test Loss: 1.212 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.2325141429901123
Epoch: 31, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.021 Vali Acc: 0.844 Test Loss: 1.021 Test Acc: 0.844
Validation loss decreased (-0.844434 --> -0.844434).  Saving model ...
Epoch: 32 cost time: 3.258852481842041
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.021 Vali Acc: 0.844 Test Loss: 1.021 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3104257583618164
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.120 Vali Acc: 0.828 Test Loss: 1.120 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.2935261726379395
Epoch: 34, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.243 Vali Acc: 0.861 Test Loss: 1.243 Test Acc: 0.861
Validation loss decreased (-0.844434 --> -0.861099).  Saving model ...
Epoch: 35 cost time: 3.175499677658081
Epoch: 35, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.977 Vali Acc: 0.867 Test Loss: 0.977 Test Acc: 0.867
Validation loss decreased (-0.861099 --> -0.866657).  Saving model ...
Epoch: 36 cost time: 3.3867623805999756
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.844 Test Loss: 1.033 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.3162877559661865
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.873 Vali Acc: 0.850 Test Loss: 0.873 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4364805221557617
Epoch: 38, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.021 Vali Acc: 0.828 Test Loss: 1.021 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.4492006301879883
Epoch: 39, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.010 Vali Acc: 0.856 Test Loss: 1.010 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.1663668155670166
Epoch: 40, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.135 Vali Acc: 0.828 Test Loss: 1.135 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.165757179260254
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.225 Vali Acc: 0.833 Test Loss: 1.225 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.248786687850952
Epoch: 42, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.100 Vali Acc: 0.822 Test Loss: 1.100 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.4110724925994873
Epoch: 43, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.927 Vali Acc: 0.767 Test Loss: 1.927 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.362677812576294
Epoch: 44, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.046 Vali Acc: 0.839 Test Loss: 1.046 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.291956901550293
Epoch: 45, Steps: 12 | Train Loss: 0.405 Vali Loss: 1.327 Vali Acc: 0.811 Test Loss: 1.327 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.868306398391724
Epoch: 1, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.083 Vali Acc: 0.350 Test Loss: 2.083 Test Acc: 0.350
Validation loss decreased (inf --> -0.349979).  Saving model ...
Epoch: 2 cost time: 3.366364002227783
Epoch: 2, Steps: 12 | Train Loss: 2.444 Vali Loss: 1.819 Vali Acc: 0.439 Test Loss: 1.819 Test Acc: 0.439
Validation loss decreased (-0.349979 --> -0.438871).  Saving model ...
Epoch: 3 cost time: 3.260632276535034
Epoch: 3, Steps: 12 | Train Loss: 1.983 Vali Loss: 1.710 Vali Acc: 0.506 Test Loss: 1.710 Test Acc: 0.506
Validation loss decreased (-0.438871 --> -0.505538).  Saving model ...
Epoch: 4 cost time: 3.259376049041748
Epoch: 4, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.367 Vali Acc: 0.628 Test Loss: 1.367 Test Acc: 0.628
Validation loss decreased (-0.505538 --> -0.627764).  Saving model ...
Epoch: 5 cost time: 3.3072125911712646
Epoch: 5, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.291 Vali Acc: 0.611 Test Loss: 1.291 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.199354887008667
Epoch: 6, Steps: 12 | Train Loss: 0.685 Vali Loss: 1.154 Vali Acc: 0.700 Test Loss: 1.154 Test Acc: 0.700
Validation loss decreased (-0.627764 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 3.266451597213745
Epoch: 7, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711101).  Saving model ...
Epoch: 8 cost time: 3.29656720161438
Epoch: 8, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
Validation loss decreased (-0.711101 --> -0.788881).  Saving model ...
Epoch: 9 cost time: 3.319730520248413
Epoch: 9, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.914 Vali Acc: 0.789 Test Loss: 0.914 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.001218557357788
Epoch: 10, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.695 Vali Acc: 0.806 Test Loss: 0.695 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805549).  Saving model ...
Epoch: 11 cost time: 3.1591360569000244
Epoch: 11, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.952 Vali Acc: 0.772 Test Loss: 0.952 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2076809406280518
Epoch: 12, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.889 Vali Acc: 0.789 Test Loss: 0.889 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2380402088165283
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.859 Vali Acc: 0.756 Test Loss: 0.859 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.391789197921753
Epoch: 14, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.816 Vali Acc: 0.817 Test Loss: 0.816 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816659).  Saving model ...
Epoch: 15 cost time: 3.225490093231201
Epoch: 15, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.735 Vali Acc: 0.822 Test Loss: 0.735 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 16 cost time: 3.2307937145233154
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.960 Vali Acc: 0.822 Test Loss: 0.960 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.998399257659912
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.876 Vali Acc: 0.822 Test Loss: 0.876 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.148526191711426
Epoch: 18, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.842 Vali Acc: 0.828 Test Loss: 0.842 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827769).  Saving model ...
Epoch: 19 cost time: 3.072016716003418
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.877 Vali Acc: 0.861 Test Loss: 0.877 Test Acc: 0.861
Validation loss decreased (-0.827769 --> -0.861102).  Saving model ...
Epoch: 20 cost time: 3.2123053073883057
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.963 Vali Acc: 0.833 Test Loss: 0.963 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3039519786834717
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.101 Vali Acc: 0.772 Test Loss: 1.101 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3647048473358154
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.253 Vali Acc: 0.833 Test Loss: 1.253 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3944270610809326
Epoch: 23, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.048 Vali Acc: 0.839 Test Loss: 1.048 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0966854095458984
Epoch: 24, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.081 Vali Acc: 0.850 Test Loss: 1.081 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.230055093765259
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.956 Vali Acc: 0.833 Test Loss: 0.956 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.2734529972076416
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.830 Vali Acc: 0.861 Test Loss: 0.830 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861103).  Saving model ...
Epoch: 27 cost time: 3.1048662662506104
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.942 Vali Acc: 0.839 Test Loss: 0.942 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0920372009277344
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.932 Vali Acc: 0.839 Test Loss: 0.932 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2618415355682373
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.064 Vali Acc: 0.856 Test Loss: 1.064 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.277474880218506
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.109 Vali Acc: 0.844 Test Loss: 1.109 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.2263376712799072
Epoch: 31, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.139 Vali Acc: 0.844 Test Loss: 1.139 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.172391176223755
Epoch: 32, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.069 Vali Acc: 0.822 Test Loss: 1.069 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.3279407024383545
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.208 Vali Acc: 0.833 Test Loss: 1.208 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.4139199256896973
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.064 Vali Acc: 0.850 Test Loss: 1.064 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.2023837566375732
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.932 Vali Acc: 0.844 Test Loss: 0.932 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.112595558166504
Epoch: 36, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.936 Vali Acc: 0.850 Test Loss: 0.936 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.2346460819244385
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.393425464630127
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.251063346862793
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.4679248332977295
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.275263786315918
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.11275577545166
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.171929359436035
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.550746440887451
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2624425888061523
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0540125370025635
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3120150566101074
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.146833658218384
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.541666269302368
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 10597391
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.951476097106934
Epoch: 1, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.100 Vali Acc: 0.533 Test Loss: 2.100 Test Acc: 0.533
Validation loss decreased (inf --> -0.533312).  Saving model ...
Epoch: 2 cost time: 3.2749404907226562
Epoch: 2, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.427 Vali Acc: 0.606 Test Loss: 1.427 Test Acc: 0.606
Validation loss decreased (-0.533312 --> -0.605541).  Saving model ...
Epoch: 3 cost time: 3.5291712284088135
Epoch: 3, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.056 Vali Acc: 0.733 Test Loss: 1.056 Test Acc: 0.733
Validation loss decreased (-0.605541 --> -0.733323).  Saving model ...
Epoch: 4 cost time: 3.6137075424194336
Epoch: 4, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.912 Vali Acc: 0.739 Test Loss: 0.912 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 5 cost time: 3.5361344814300537
Epoch: 5, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
Validation loss decreased (-0.738880 --> -0.838882).  Saving model ...
Epoch: 6 cost time: 3.4379396438598633
Epoch: 6, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.723 Vali Acc: 0.794 Test Loss: 0.723 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.390615940093994
Epoch: 7, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 3.445876359939575
Epoch: 8, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.619 Vali Acc: 0.856 Test Loss: 0.619 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855549).  Saving model ...
Epoch: 9 cost time: 3.4698102474212646
Epoch: 9, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.528639316558838
Epoch: 10, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 11 cost time: 3.5623581409454346
Epoch: 11, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.487 Vali Acc: 0.867 Test Loss: 0.487 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 12 cost time: 3.389127731323242
Epoch: 12, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3956243991851807
Epoch: 13, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.610 Vali Acc: 0.878 Test Loss: 0.610 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877772).  Saving model ...
Epoch: 14 cost time: 3.483304262161255
Epoch: 14, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.549 Vali Acc: 0.867 Test Loss: 0.549 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.552525758743286
Epoch: 15, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.877772 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 3.5821051597595215
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.687 Vali Acc: 0.894 Test Loss: 0.687 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.458804130554199
Epoch: 17, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.679 Vali Acc: 0.889 Test Loss: 0.679 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4737560749053955
Epoch: 18, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.883 Test Loss: 0.629 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.392805576324463
Epoch: 19, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.889 Test Loss: 0.604 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3391122817993164
Epoch: 20, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.612 Vali Acc: 0.889 Test Loss: 0.612 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.536677122116089
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.1039302349090576
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.900 Test Loss: 0.583 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.622241973876953
Epoch: 23, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.906 Test Loss: 0.584 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905550).  Saving model ...
Epoch: 24 cost time: 3.442951202392578
Epoch: 24, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.602 Vali Acc: 0.894 Test Loss: 0.602 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3520991802215576
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.586 Vali Acc: 0.883 Test Loss: 0.586 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.34993839263916
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.735 Vali Acc: 0.867 Test Loss: 0.735 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.423866033554077
Epoch: 27, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.652 Vali Acc: 0.883 Test Loss: 0.652 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4480347633361816
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.745 Vali Acc: 0.878 Test Loss: 0.745 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.1574039459228516
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.420585870742798
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.146 Vali Acc: 0.800 Test Loss: 1.146 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.527440071105957
Epoch: 31, Steps: 12 | Train Loss: 0.270 Vali Loss: 1.289 Vali Acc: 0.767 Test Loss: 1.289 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.2892656326293945
Epoch: 32, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.967 Vali Acc: 0.850 Test Loss: 0.967 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.330178737640381
Epoch: 33, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.156095504760742
Epoch: 1, Steps: 12 | Train Loss: 2.643 Vali Loss: 2.212 Vali Acc: 0.489 Test Loss: 2.212 Test Acc: 0.489
Validation loss decreased (inf --> -0.488867).  Saving model ...
Epoch: 2 cost time: 3.273291826248169
Epoch: 2, Steps: 12 | Train Loss: 1.919 Vali Loss: 1.564 Vali Acc: 0.539 Test Loss: 1.564 Test Acc: 0.539
Validation loss decreased (-0.488867 --> -0.538873).  Saving model ...
Epoch: 3 cost time: 3.469482183456421
Epoch: 3, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.123 Vali Acc: 0.706 Test Loss: 1.123 Test Acc: 0.706
Validation loss decreased (-0.538873 --> -0.705544).  Saving model ...
Epoch: 4 cost time: 3.6915946006774902
Epoch: 4, Steps: 12 | Train Loss: 0.806 Vali Loss: 1.026 Vali Acc: 0.717 Test Loss: 1.026 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716656).  Saving model ...
Epoch: 5 cost time: 3.65696382522583
Epoch: 5, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.817 Vali Acc: 0.794 Test Loss: 0.817 Test Acc: 0.794
Validation loss decreased (-0.716656 --> -0.794436).  Saving model ...
Epoch: 6 cost time: 3.483186960220337
Epoch: 6, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.812 Vali Acc: 0.783 Test Loss: 0.812 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.404816150665283
Epoch: 7, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.671 Vali Acc: 0.833 Test Loss: 0.671 Test Acc: 0.833
Validation loss decreased (-0.794436 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 3.6919894218444824
Epoch: 8, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855549).  Saving model ...
Epoch: 9 cost time: 3.5231363773345947
Epoch: 9, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.497300386428833
Epoch: 10, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.731 Vali Acc: 0.883 Test Loss: 0.731 Test Acc: 0.883
Validation loss decreased (-0.855549 --> -0.883326).  Saving model ...
Epoch: 11 cost time: 3.2976479530334473
Epoch: 11, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.682 Vali Acc: 0.906 Test Loss: 0.682 Test Acc: 0.906
Validation loss decreased (-0.883326 --> -0.905549).  Saving model ...
Epoch: 12 cost time: 3.539226770401001
Epoch: 12, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.25472354888916
Epoch: 13, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.682 Vali Acc: 0.883 Test Loss: 0.682 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6163644790649414
Epoch: 14, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.708 Vali Acc: 0.867 Test Loss: 0.708 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.685124397277832
Epoch: 15, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.717 Vali Acc: 0.894 Test Loss: 0.717 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.375530242919922
Epoch: 16, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.628 Vali Acc: 0.889 Test Loss: 0.628 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.4864370822906494
Epoch: 17, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.617 Vali Acc: 0.889 Test Loss: 0.617 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.4113354682922363
Epoch: 18, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3578546047210693
Epoch: 19, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.906 Test Loss: 0.625 Test Acc: 0.906
Validation loss decreased (-0.905549 --> -0.905549).  Saving model ...
Epoch: 20 cost time: 3.3965296745300293
Epoch: 20, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.461092472076416
Epoch: 21, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.390578269958496
Epoch: 22, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.325122356414795
Epoch: 23, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4207892417907715
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.2811570167541504
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.652 Vali Acc: 0.894 Test Loss: 0.652 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.3385541439056396
Epoch: 26, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.906 Test Loss: 0.635 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.4669106006622314
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.635 Vali Acc: 0.906 Test Loss: 0.635 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.5456206798553467
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.702 Vali Acc: 0.889 Test Loss: 0.702 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.176086187362671
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.809 Vali Acc: 0.867 Test Loss: 0.809 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.272116184234619
Epoch: 1, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.336 Vali Acc: 0.356 Test Loss: 2.336 Test Acc: 0.356
Validation loss decreased (inf --> -0.355532).  Saving model ...
Epoch: 2 cost time: 3.5733864307403564
Epoch: 2, Steps: 12 | Train Loss: 2.113 Vali Loss: 1.765 Vali Acc: 0.489 Test Loss: 1.765 Test Acc: 0.489
Validation loss decreased (-0.355532 --> -0.488871).  Saving model ...
Epoch: 3 cost time: 3.4259443283081055
Epoch: 3, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.281 Vali Acc: 0.650 Test Loss: 1.281 Test Acc: 0.650
Validation loss decreased (-0.488871 --> -0.649987).  Saving model ...
Epoch: 4 cost time: 3.5243053436279297
Epoch: 4, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.064 Vali Acc: 0.656 Test Loss: 1.064 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655545).  Saving model ...
Epoch: 5 cost time: 3.512486696243286
Epoch: 5, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.055 Vali Acc: 0.728 Test Loss: 1.055 Test Acc: 0.728
Validation loss decreased (-0.655545 --> -0.727767).  Saving model ...
Epoch: 6 cost time: 3.634796619415283
Epoch: 6, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.972 Vali Acc: 0.756 Test Loss: 0.972 Test Acc: 0.756
Validation loss decreased (-0.727767 --> -0.755546).  Saving model ...
Epoch: 7 cost time: 3.4290218353271484
Epoch: 7, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.930 Vali Acc: 0.722 Test Loss: 0.930 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7000272274017334
Epoch: 8, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.754 Vali Acc: 0.811 Test Loss: 0.754 Test Acc: 0.811
Validation loss decreased (-0.755546 --> -0.811104).  Saving model ...
Epoch: 9 cost time: 3.45561146736145
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.757 Vali Acc: 0.833 Test Loss: 0.757 Test Acc: 0.833
Validation loss decreased (-0.811104 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 3.2716293334960938
Epoch: 10, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.620039463043213
Epoch: 11, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.851 Vali Acc: 0.783 Test Loss: 0.851 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.569876194000244
Epoch: 12, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.816 Vali Acc: 0.828 Test Loss: 0.816 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4989476203918457
Epoch: 13, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 14 cost time: 3.603069305419922
Epoch: 14, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.923 Vali Acc: 0.850 Test Loss: 0.923 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 3.5155746936798096
Epoch: 15, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.915 Vali Acc: 0.817 Test Loss: 0.915 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.482659339904785
Epoch: 16, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.883 Vali Acc: 0.850 Test Loss: 0.883 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 17 cost time: 3.158158302307129
Epoch: 17, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.916 Vali Acc: 0.856 Test Loss: 0.916 Test Acc: 0.856
Validation loss decreased (-0.849991 --> -0.855546).  Saving model ...
Epoch: 18 cost time: 3.513643264770508
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.905 Vali Acc: 0.850 Test Loss: 0.905 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.473553419113159
Epoch: 19, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.059 Vali Acc: 0.839 Test Loss: 1.059 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2763071060180664
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.068 Vali Acc: 0.844 Test Loss: 1.068 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2300448417663574
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.989 Vali Acc: 0.817 Test Loss: 0.989 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.166597843170166
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.741 Vali Acc: 0.856 Test Loss: 0.741 Test Acc: 0.856
Validation loss decreased (-0.855546 --> -0.855548).  Saving model ...
Epoch: 23 cost time: 3.602846145629883
Epoch: 23, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.755 Vali Acc: 0.872 Test Loss: 0.755 Test Acc: 0.872
Validation loss decreased (-0.855548 --> -0.872215).  Saving model ...
Epoch: 24 cost time: 3.2879889011383057
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.802 Vali Acc: 0.872 Test Loss: 0.802 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2687673568725586
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.776 Vali Acc: 0.872 Test Loss: 0.776 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2945709228515625
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.808 Vali Acc: 0.867 Test Loss: 0.808 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3649353981018066
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.867 Test Loss: 0.853 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2764251232147217
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.867 Test Loss: 0.846 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.570760726928711
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.872 Test Loss: 0.827 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.4536168575286865
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.872 Test Loss: 0.801 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.22540283203125
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.883 Test Loss: 0.797 Test Acc: 0.883
Validation loss decreased (-0.872215 --> -0.883325).  Saving model ...
Epoch: 32 cost time: 3.400209426879883
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.889 Test Loss: 0.784 Test Acc: 0.889
Validation loss decreased (-0.883325 --> -0.888881).  Saving model ...
Epoch: 33 cost time: 3.0652201175689697
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.889 Test Loss: 0.782 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 34 cost time: 3.3578941822052
Epoch: 34, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.889 Test Loss: 0.786 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6814067363739014
Epoch: 35, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.883 Test Loss: 0.790 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.5983798503875732
Epoch: 36, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.883 Test Loss: 0.792 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.5514028072357178
Epoch: 37, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.883 Test Loss: 0.795 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.300745725631714
Epoch: 38, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.883 Test Loss: 0.796 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.534121513366699
Epoch: 39, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.883 Test Loss: 0.798 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.2841806411743164
Epoch: 40, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.883 Test Loss: 0.802 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.397632360458374
Epoch: 41, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.889 Test Loss: 0.806 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.24257230758667
Epoch: 42, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.883 Test Loss: 0.805 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.1823320388793945
Epoch: 43, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.889 Test Loss: 0.806 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.889954328536987
Epoch: 1, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.480 Vali Acc: 0.267 Test Loss: 2.480 Test Acc: 0.267
Validation loss decreased (inf --> -0.266642).  Saving model ...
Epoch: 2 cost time: 3.028836727142334
Epoch: 2, Steps: 12 | Train Loss: 2.310 Vali Loss: 1.974 Vali Acc: 0.400 Test Loss: 1.974 Test Acc: 0.400
Validation loss decreased (-0.266642 --> -0.399980).  Saving model ...
Epoch: 3 cost time: 3.3224613666534424
Epoch: 3, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.449 Vali Acc: 0.617 Test Loss: 1.449 Test Acc: 0.617
Validation loss decreased (-0.399980 --> -0.616652).  Saving model ...
Epoch: 4 cost time: 3.3785202503204346
Epoch: 4, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.094 Vali Acc: 0.628 Test Loss: 1.094 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627767).  Saving model ...
Epoch: 5 cost time: 3.2556376457214355
Epoch: 5, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.212 Vali Acc: 0.711 Test Loss: 1.212 Test Acc: 0.711
Validation loss decreased (-0.627767 --> -0.711099).  Saving model ...
Epoch: 6 cost time: 3.429682970046997
Epoch: 6, Steps: 12 | Train Loss: 0.726 Vali Loss: 1.111 Vali Acc: 0.744 Test Loss: 1.111 Test Acc: 0.744
Validation loss decreased (-0.711099 --> -0.744433).  Saving model ...
Epoch: 7 cost time: 3.4408044815063477
Epoch: 7, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3887088298797607
Epoch: 8, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.744433 --> -0.788882).  Saving model ...
Epoch: 9 cost time: 3.266047716140747
Epoch: 9, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.751 Vali Acc: 0.778 Test Loss: 0.751 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5063412189483643
Epoch: 10, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4474589824676514
Epoch: 11, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.903 Vali Acc: 0.800 Test Loss: 0.903 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 3.248079776763916
Epoch: 12, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.864 Vali Acc: 0.811 Test Loss: 0.864 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811102).  Saving model ...
Epoch: 13 cost time: 3.2903335094451904
Epoch: 13, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.775 Vali Acc: 0.828 Test Loss: 0.775 Test Acc: 0.828
Validation loss decreased (-0.811102 --> -0.827770).  Saving model ...
Epoch: 14 cost time: 3.1532516479492188
Epoch: 14, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.776 Vali Acc: 0.833 Test Loss: 0.776 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 3.2078371047973633
Epoch: 15, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.780 Vali Acc: 0.833 Test Loss: 0.780 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2575056552886963
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 1.121 Vali Acc: 0.750 Test Loss: 1.121 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1144216060638428
Epoch: 17, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 3.1667494773864746
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.922 Vali Acc: 0.850 Test Loss: 0.922 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1980602741241455
Epoch: 19, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.015 Vali Acc: 0.817 Test Loss: 1.015 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2585978507995605
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.238 Vali Acc: 0.844 Test Loss: 1.238 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.291053533554077
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.169 Vali Acc: 0.839 Test Loss: 1.169 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.178989887237549
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.090 Vali Acc: 0.850 Test Loss: 1.090 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.1694540977478027
Epoch: 23, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.026 Vali Acc: 0.822 Test Loss: 1.026 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.167051315307617
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.364 Vali Acc: 0.856 Test Loss: 1.364 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855542).  Saving model ...
Epoch: 25 cost time: 3.4453375339508057
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.066 Vali Acc: 0.872 Test Loss: 1.066 Test Acc: 0.872
Validation loss decreased (-0.855542 --> -0.872212).  Saving model ...
Epoch: 26 cost time: 3.2186777591705322
Epoch: 26, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.022 Vali Acc: 0.867 Test Loss: 1.022 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.076353073120117
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.182 Vali Acc: 0.850 Test Loss: 1.182 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1530139446258545
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.517 Vali Acc: 0.822 Test Loss: 1.517 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.382443428039551
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.205 Vali Acc: 0.817 Test Loss: 1.205 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.272890090942383
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.013 Vali Acc: 0.861 Test Loss: 1.013 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.1904866695404053
Epoch: 31, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.196 Vali Acc: 0.839 Test Loss: 1.196 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.306321382522583
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.223 Vali Acc: 0.867 Test Loss: 1.223 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.113430976867676
Epoch: 33, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.398 Vali Acc: 0.800 Test Loss: 1.398 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.2942628860473633
Epoch: 34, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.319 Vali Acc: 0.833 Test Loss: 1.319 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.179201602935791
Epoch: 35, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.230 Vali Acc: 0.833 Test Loss: 1.230 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.937373876571655
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.339 Vali Acc: 0.283 Test Loss: 2.339 Test Acc: 0.283
Validation loss decreased (inf --> -0.283310).  Saving model ...
Epoch: 2 cost time: 3.436624050140381
Epoch: 2, Steps: 12 | Train Loss: 2.416 Vali Loss: 1.865 Vali Acc: 0.411 Test Loss: 1.865 Test Acc: 0.411
Validation loss decreased (-0.283310 --> -0.411092).  Saving model ...
Epoch: 3 cost time: 3.2897963523864746
Epoch: 3, Steps: 12 | Train Loss: 1.898 Vali Loss: 1.541 Vali Acc: 0.500 Test Loss: 1.541 Test Acc: 0.500
Validation loss decreased (-0.411092 --> -0.499985).  Saving model ...
Epoch: 4 cost time: 3.272106647491455
Epoch: 4, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.281 Vali Acc: 0.583 Test Loss: 1.281 Test Acc: 0.583
Validation loss decreased (-0.499985 --> -0.583321).  Saving model ...
Epoch: 5 cost time: 3.342216968536377
Epoch: 5, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.504 Vali Acc: 0.633 Test Loss: 1.504 Test Acc: 0.633
Validation loss decreased (-0.583321 --> -0.633318).  Saving model ...
Epoch: 6 cost time: 3.3445990085601807
Epoch: 6, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.272 Vali Acc: 0.706 Test Loss: 1.272 Test Acc: 0.706
Validation loss decreased (-0.633318 --> -0.705543).  Saving model ...
Epoch: 7 cost time: 3.304003953933716
Epoch: 7, Steps: 12 | Train Loss: 0.694 Vali Loss: 1.001 Vali Acc: 0.656 Test Loss: 1.001 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3067727088928223
Epoch: 8, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
Validation loss decreased (-0.705543 --> -0.783325).  Saving model ...
Epoch: 9 cost time: 3.506770133972168
Epoch: 9, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3338370323181152
Epoch: 10, Steps: 12 | Train Loss: 0.519 Vali Loss: 1.082 Vali Acc: 0.733 Test Loss: 1.082 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1316707134246826
Epoch: 11, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.783325 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 3.2512502670288086
Epoch: 12, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.000 Vali Acc: 0.767 Test Loss: 1.000 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0881669521331787
Epoch: 13, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.935 Vali Acc: 0.794 Test Loss: 0.935 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3401267528533936
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
Validation loss decreased (-0.799992 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 3.4844589233398438
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.858 Vali Acc: 0.817 Test Loss: 0.858 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4507944583892822
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.893 Vali Acc: 0.789 Test Loss: 0.893 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.218379497528076
Epoch: 17, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.852 Vali Acc: 0.839 Test Loss: 0.852 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838880).  Saving model ...
Epoch: 18 cost time: 3.3386588096618652
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.047 Vali Acc: 0.850 Test Loss: 1.047 Test Acc: 0.850
Validation loss decreased (-0.838880 --> -0.849990).  Saving model ...
Epoch: 19 cost time: 3.470182180404663
Epoch: 19, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.928 Vali Acc: 0.828 Test Loss: 0.928 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.268465518951416
Epoch: 20, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.983 Vali Acc: 0.833 Test Loss: 0.983 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.385854959487915
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.863 Vali Acc: 0.856 Test Loss: 0.863 Test Acc: 0.856
Validation loss decreased (-0.849990 --> -0.855547).  Saving model ...
Epoch: 22 cost time: 3.3138599395751953
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.013 Vali Acc: 0.817 Test Loss: 1.013 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2824182510375977
Epoch: 23, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.014 Vali Acc: 0.844 Test Loss: 1.014 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.357347011566162
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.148 Vali Acc: 0.844 Test Loss: 1.148 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3416874408721924
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.837 Vali Acc: 0.844 Test Loss: 0.837 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.265972852706909
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.019 Vali Acc: 0.850 Test Loss: 1.019 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.309840440750122
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.013 Vali Acc: 0.800 Test Loss: 1.013 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.3660707473754883
Epoch: 28, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.171 Vali Acc: 0.861 Test Loss: 1.171 Test Acc: 0.861
Validation loss decreased (-0.855547 --> -0.861099).  Saving model ...
Epoch: 29 cost time: 3.1916136741638184
Epoch: 29, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.997 Vali Acc: 0.861 Test Loss: 0.997 Test Acc: 0.861
Validation loss decreased (-0.861099 --> -0.861101).  Saving model ...
Epoch: 30 cost time: 3.229813814163208
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.307 Vali Acc: 0.856 Test Loss: 1.307 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2290518283843994
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.179 Vali Acc: 0.839 Test Loss: 1.179 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.0757980346679688
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.088 Vali Acc: 0.883 Test Loss: 1.088 Test Acc: 0.883
Validation loss decreased (-0.861101 --> -0.883322).  Saving model ...
Epoch: 33 cost time: 3.264235019683838
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.084 Vali Acc: 0.867 Test Loss: 1.084 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2077744007110596
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.145 Vali Acc: 0.867 Test Loss: 1.145 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0429108142852783
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.060 Vali Acc: 0.889 Test Loss: 1.060 Test Acc: 0.889
Validation loss decreased (-0.883322 --> -0.888878).  Saving model ...
Epoch: 36 cost time: 3.2648062705993652
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.949 Vali Acc: 0.867 Test Loss: 0.949 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.085395097732544
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.110 Vali Acc: 0.861 Test Loss: 1.110 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.2949349880218506
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.027 Vali Acc: 0.839 Test Loss: 1.027 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.201200008392334
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.958 Vali Acc: 0.878 Test Loss: 0.958 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.3202617168426514
Epoch: 40, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.306 Vali Acc: 0.844 Test Loss: 1.306 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.278582811355591
Epoch: 41, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.018 Vali Acc: 0.867 Test Loss: 1.018 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.1410622596740723
Epoch: 42, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.425 Vali Acc: 0.828 Test Loss: 1.425 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.169466733932495
Epoch: 43, Steps: 12 | Train Loss: 0.354 Vali Loss: 1.402 Vali Acc: 0.800 Test Loss: 1.402 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.6429696083068848
Epoch: 44, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.246 Vali Acc: 0.839 Test Loss: 1.246 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.3511056900024414
Epoch: 45, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.401 Vali Acc: 0.811 Test Loss: 1.401 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.180991172790527
Epoch: 1, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.098 Vali Acc: 0.361 Test Loss: 2.098 Test Acc: 0.361
Validation loss decreased (inf --> -0.361090).  Saving model ...
Epoch: 2 cost time: 3.5223395824432373
Epoch: 2, Steps: 12 | Train Loss: 2.456 Vali Loss: 1.972 Vali Acc: 0.433 Test Loss: 1.972 Test Acc: 0.433
Validation loss decreased (-0.361090 --> -0.433314).  Saving model ...
Epoch: 3 cost time: 3.4504475593566895
Epoch: 3, Steps: 12 | Train Loss: 1.969 Vali Loss: 1.717 Vali Acc: 0.467 Test Loss: 1.717 Test Acc: 0.467
Validation loss decreased (-0.433314 --> -0.466649).  Saving model ...
Epoch: 4 cost time: 3.480771064758301
Epoch: 4, Steps: 12 | Train Loss: 1.295 Vali Loss: 1.396 Vali Acc: 0.589 Test Loss: 1.396 Test Acc: 0.589
Validation loss decreased (-0.466649 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 3.5686233043670654
Epoch: 5, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.556 Vali Acc: 0.650 Test Loss: 1.556 Test Acc: 0.650
Validation loss decreased (-0.588875 --> -0.649984).  Saving model ...
Epoch: 6 cost time: 3.489884614944458
Epoch: 6, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.275 Vali Acc: 0.683 Test Loss: 1.275 Test Acc: 0.683
Validation loss decreased (-0.649984 --> -0.683321).  Saving model ...
Epoch: 7 cost time: 3.596691608428955
Epoch: 7, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.022 Vali Acc: 0.667 Test Loss: 1.022 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.445148229598999
Epoch: 8, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
Validation loss decreased (-0.683321 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 3.5436480045318604
Epoch: 9, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.952 Vali Acc: 0.756 Test Loss: 0.952 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755546).  Saving model ...
Epoch: 10 cost time: 3.3445146083831787
Epoch: 10, Steps: 12 | Train Loss: 0.599 Vali Loss: 1.020 Vali Acc: 0.722 Test Loss: 1.020 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.380869150161743
Epoch: 11, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.902 Vali Acc: 0.811 Test Loss: 0.902 Test Acc: 0.811
Validation loss decreased (-0.755546 --> -0.811102).  Saving model ...
Epoch: 12 cost time: 3.159822702407837
Epoch: 12, Steps: 12 | Train Loss: 0.330 Vali Loss: 1.019 Vali Acc: 0.806 Test Loss: 1.019 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5861589908599854
Epoch: 13, Steps: 12 | Train Loss: 0.217 Vali Loss: 1.004 Vali Acc: 0.789 Test Loss: 1.004 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4230122566223145
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.793 Vali Acc: 0.806 Test Loss: 0.793 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1838042736053467
Epoch: 15, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.566699981689453
Epoch: 16, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.022 Vali Acc: 0.772 Test Loss: 1.022 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.4958298206329346
Epoch: 17, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.817 Vali Acc: 0.822 Test Loss: 0.817 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 3.191715717315674
Epoch: 18, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.050 Vali Acc: 0.828 Test Loss: 1.050 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827767).  Saving model ...
Epoch: 19 cost time: 3.269984483718872
Epoch: 19, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.761 Vali Acc: 0.828 Test Loss: 0.761 Test Acc: 0.828
Validation loss decreased (-0.827767 --> -0.827770).  Saving model ...
Epoch: 20 cost time: 3.5136325359344482
Epoch: 20, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.795 Vali Acc: 0.867 Test Loss: 0.795 Test Acc: 0.867
Validation loss decreased (-0.827770 --> -0.866659).  Saving model ...
Epoch: 21 cost time: 3.48030948638916
Epoch: 21, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.820 Vali Acc: 0.833 Test Loss: 0.820 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.431873321533203
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.114 Vali Acc: 0.833 Test Loss: 1.114 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.4551689624786377
Epoch: 23, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.959 Vali Acc: 0.828 Test Loss: 0.959 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.659593343734741
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.112 Vali Acc: 0.833 Test Loss: 1.112 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.580653667449951
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.883 Vali Acc: 0.844 Test Loss: 0.883 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.3860440254211426
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.829 Vali Acc: 0.833 Test Loss: 0.829 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.232384204864502
Epoch: 27, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.055 Vali Acc: 0.861 Test Loss: 1.055 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.421869993209839
Epoch: 28, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.359 Vali Acc: 0.833 Test Loss: 1.359 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.043011426925659
Epoch: 29, Steps: 12 | Train Loss: 0.340 Vali Loss: 1.253 Vali Acc: 0.806 Test Loss: 1.253 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.6928954124450684
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.174 Vali Acc: 0.817 Test Loss: 1.174 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.1201581954956055
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.131 Vali Acc: 0.389 Test Loss: 2.131 Test Acc: 0.389
Validation loss decreased (inf --> -0.388868).  Saving model ...
Epoch: 2 cost time: 3.3340535163879395
Epoch: 2, Steps: 12 | Train Loss: 2.461 Vali Loss: 1.919 Vali Acc: 0.461 Test Loss: 1.919 Test Acc: 0.461
Validation loss decreased (-0.388868 --> -0.461092).  Saving model ...
Epoch: 3 cost time: 3.6884872913360596
Epoch: 3, Steps: 12 | Train Loss: 2.005 Vali Loss: 1.742 Vali Acc: 0.494 Test Loss: 1.742 Test Acc: 0.494
Validation loss decreased (-0.461092 --> -0.494427).  Saving model ...
Epoch: 4 cost time: 3.4534919261932373
Epoch: 4, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.404 Vali Acc: 0.606 Test Loss: 1.404 Test Acc: 0.606
Validation loss decreased (-0.494427 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 3.6145830154418945
Epoch: 5, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.515 Vali Acc: 0.667 Test Loss: 1.515 Test Acc: 0.667
Validation loss decreased (-0.605542 --> -0.666652).  Saving model ...
Epoch: 6 cost time: 3.428588390350342
Epoch: 6, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.310 Vali Acc: 0.678 Test Loss: 1.310 Test Acc: 0.678
Validation loss decreased (-0.666652 --> -0.677765).  Saving model ...
Epoch: 7 cost time: 3.7217066287994385
Epoch: 7, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.011 Vali Acc: 0.683 Test Loss: 1.011 Test Acc: 0.683
Validation loss decreased (-0.677765 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 3.2121787071228027
Epoch: 8, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.752 Vali Acc: 0.756 Test Loss: 0.752 Test Acc: 0.756
Validation loss decreased (-0.683323 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 3.49442720413208
Epoch: 9, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.945 Vali Acc: 0.756 Test Loss: 0.945 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.469273567199707
Epoch: 10, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.964 Vali Acc: 0.733 Test Loss: 0.964 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.397183418273926
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.896 Vali Acc: 0.800 Test Loss: 0.896 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 3.4829261302948
Epoch: 12, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.962 Vali Acc: 0.806 Test Loss: 0.962 Test Acc: 0.806
Validation loss decreased (-0.799991 --> -0.805546).  Saving model ...
Epoch: 13 cost time: 3.405190944671631
Epoch: 13, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.899 Vali Acc: 0.783 Test Loss: 0.899 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.271634101867676
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.783 Vali Acc: 0.828 Test Loss: 0.783 Test Acc: 0.828
Validation loss decreased (-0.805546 --> -0.827770).  Saving model ...
Epoch: 15 cost time: 3.503106117248535
Epoch: 15, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.835 Vali Acc: 0.828 Test Loss: 0.835 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4253203868865967
Epoch: 16, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.877 Vali Acc: 0.822 Test Loss: 0.877 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2971749305725098
Epoch: 17, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.880 Vali Acc: 0.839 Test Loss: 0.880 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838880).  Saving model ...
Epoch: 18 cost time: 3.171219825744629
Epoch: 18, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.997 Vali Acc: 0.833 Test Loss: 0.997 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3622283935546875
Epoch: 19, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.870 Vali Acc: 0.811 Test Loss: 0.870 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2268295288085938
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.930 Vali Acc: 0.861 Test Loss: 0.930 Test Acc: 0.861
Validation loss decreased (-0.838880 --> -0.861102).  Saving model ...
Epoch: 21 cost time: 3.2301783561706543
Epoch: 21, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.902 Vali Acc: 0.861 Test Loss: 0.902 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861102).  Saving model ...
Epoch: 22 cost time: 3.2887308597564697
Epoch: 22, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.004 Vali Acc: 0.833 Test Loss: 1.004 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1283655166625977
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.000 Vali Acc: 0.811 Test Loss: 1.000 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.429155111312866
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.964 Vali Acc: 0.856 Test Loss: 0.964 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2967052459716797
Epoch: 25, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.945 Vali Acc: 0.844 Test Loss: 0.945 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.3075666427612305
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.998 Vali Acc: 0.839 Test Loss: 0.998 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1723692417144775
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.160 Vali Acc: 0.839 Test Loss: 1.160 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.274787664413452
Epoch: 28, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.101 Vali Acc: 0.839 Test Loss: 1.101 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.9944372177124023
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.041 Vali Acc: 0.839 Test Loss: 1.041 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.589404821395874
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.891 Vali Acc: 0.861 Test Loss: 0.891 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861102).  Saving model ...
Epoch: 31 cost time: 3.3968024253845215
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.853 Vali Acc: 0.850 Test Loss: 0.853 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1760900020599365
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.135 Vali Acc: 0.839 Test Loss: 1.135 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.241842031478882
Epoch: 33, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.464 Vali Acc: 0.794 Test Loss: 1.464 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.23085618019104
Epoch: 34, Steps: 12 | Train Loss: 0.238 Vali Loss: 1.770 Vali Acc: 0.806 Test Loss: 1.770 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2786812782287598
Epoch: 35, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.114 Vali Acc: 0.850 Test Loss: 1.114 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.183288812637329
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.441 Vali Acc: 0.856 Test Loss: 1.441 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.304325819015503
Epoch: 37, Steps: 12 | Train Loss: 0.198 Vali Loss: 1.247 Vali Acc: 0.817 Test Loss: 1.247 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.439122438430786
Epoch: 38, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.962 Vali Acc: 0.811 Test Loss: 1.962 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.4116933345794678
Epoch: 39, Steps: 12 | Train Loss: 0.218 Vali Loss: 1.626 Vali Acc: 0.772 Test Loss: 1.626 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.180084705352783
Epoch: 40, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.622 Vali Acc: 0.783 Test Loss: 1.622 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4500744342803955
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.4778056144714355
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.3641998767852783
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.288257360458374
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 3.2282259464263916
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1421144008636475
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2313733100891113
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0481326580047607
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.478614568710327
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 10 cost time: 3.2450079917907715
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.233673572540283
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2012341022491455
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.38498592376709
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4259824752807617
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 15 cost time: 3.3301913738250732
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.446014404296875
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.332599639892578
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4898464679718018
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5003628730773926
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4558663368225098
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.4931647777557373
Epoch: 21, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.4812660217285156
Epoch: 22, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.247170925140381
Epoch: 23, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6299426555633545
Epoch: 24, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 9024527
model size : 53.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.996096134185791
Epoch: 1, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.102 Vali Acc: 0.572 Test Loss: 2.102 Test Acc: 0.572
Validation loss decreased (inf --> -0.572201).  Saving model ...
Epoch: 2 cost time: 3.3911139965057373
Epoch: 2, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.369 Vali Acc: 0.644 Test Loss: 1.369 Test Acc: 0.644
Validation loss decreased (-0.572201 --> -0.644431).  Saving model ...
Epoch: 3 cost time: 3.6970622539520264
Epoch: 3, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.111 Vali Acc: 0.722 Test Loss: 1.111 Test Acc: 0.722
Validation loss decreased (-0.644431 --> -0.722211).  Saving model ...
Epoch: 4 cost time: 3.4615912437438965
Epoch: 4, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.818 Vali Acc: 0.794 Test Loss: 0.818 Test Acc: 0.794
Validation loss decreased (-0.722211 --> -0.794436).  Saving model ...
Epoch: 5 cost time: 3.446441173553467
Epoch: 5, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.676 Vali Acc: 0.800 Test Loss: 0.676 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 3.4178154468536377
Epoch: 6, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.552 Vali Acc: 0.839 Test Loss: 0.552 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 7 cost time: 3.4650564193725586
Epoch: 7, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.593 Vali Acc: 0.800 Test Loss: 0.593 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4737253189086914
Epoch: 8, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 9 cost time: 3.524186372756958
Epoch: 9, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861105).  Saving model ...
Epoch: 10 cost time: 3.1790852546691895
Epoch: 10, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
Validation loss decreased (-0.861105 --> -0.883328).  Saving model ...
Epoch: 11 cost time: 3.4243457317352295
Epoch: 11, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.540 Vali Acc: 0.867 Test Loss: 0.540 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.42651104927063
Epoch: 12, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.487 Vali Acc: 0.883 Test Loss: 0.487 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 13 cost time: 3.2949624061584473
Epoch: 13, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.477724313735962
Epoch: 14, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.677 Vali Acc: 0.894 Test Loss: 0.677 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894438).  Saving model ...
Epoch: 15 cost time: 3.2818284034729004
Epoch: 15, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1353096961975098
Epoch: 16, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.765 Vali Acc: 0.878 Test Loss: 0.765 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4300801753997803
Epoch: 17, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.459 Vali Acc: 0.894 Test Loss: 0.459 Test Acc: 0.894
Validation loss decreased (-0.894438 --> -0.894440).  Saving model ...
Epoch: 18 cost time: 3.488539457321167
Epoch: 18, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.746 Vali Acc: 0.867 Test Loss: 0.746 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.064422130584717
Epoch: 19, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.662 Vali Acc: 0.883 Test Loss: 0.662 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1975343227386475
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.680 Vali Acc: 0.889 Test Loss: 0.680 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.27968692779541
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.732 Vali Acc: 0.850 Test Loss: 0.732 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.124296188354492
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.916 Vali Acc: 0.883 Test Loss: 0.916 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.1356475353240967
Epoch: 23, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.694 Vali Acc: 0.889 Test Loss: 0.694 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.175781011581421
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.772 Vali Acc: 0.906 Test Loss: 0.772 Test Acc: 0.906
Validation loss decreased (-0.894440 --> -0.905548).  Saving model ...
Epoch: 25 cost time: 3.2487282752990723
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.258685827255249
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.177 Vali Acc: 0.878 Test Loss: 1.177 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.483797550201416
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.028 Vali Acc: 0.878 Test Loss: 1.028 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.558926582336426
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.088 Vali Acc: 0.889 Test Loss: 1.088 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.8038856983184814
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.811 Vali Acc: 0.867 Test Loss: 0.811 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.4680135250091553
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.966 Vali Acc: 0.889 Test Loss: 0.966 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.5999603271484375
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.950 Vali Acc: 0.906 Test Loss: 0.950 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.743194580078125
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.776 Vali Acc: 0.894 Test Loss: 0.776 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.638957977294922
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.891 Vali Acc: 0.900 Test Loss: 0.891 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.6050162315368652
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.831 Vali Acc: 0.906 Test Loss: 0.831 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.130847215652466
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.225 Vali Acc: 0.500 Test Loss: 2.225 Test Acc: 0.500
Validation loss decreased (inf --> -0.499978).  Saving model ...
Epoch: 2 cost time: 3.364691972732544
Epoch: 2, Steps: 12 | Train Loss: 1.965 Vali Loss: 1.524 Vali Acc: 0.578 Test Loss: 1.524 Test Acc: 0.578
Validation loss decreased (-0.499978 --> -0.577763).  Saving model ...
Epoch: 3 cost time: 3.2847537994384766
Epoch: 3, Steps: 12 | Train Loss: 1.284 Vali Loss: 1.227 Vali Acc: 0.683 Test Loss: 1.227 Test Acc: 0.683
Validation loss decreased (-0.577763 --> -0.683321).  Saving model ...
Epoch: 4 cost time: 3.195446491241455
Epoch: 4, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.910 Vali Acc: 0.783 Test Loss: 0.910 Test Acc: 0.783
Validation loss decreased (-0.683321 --> -0.783324).  Saving model ...
Epoch: 5 cost time: 3.385655164718628
Epoch: 5, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.796 Vali Acc: 0.772 Test Loss: 0.796 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.166166067123413
Epoch: 6, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.651 Vali Acc: 0.833 Test Loss: 0.651 Test Acc: 0.833
Validation loss decreased (-0.783324 --> -0.833327).  Saving model ...
Epoch: 7 cost time: 3.1280083656311035
Epoch: 7, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1298937797546387
Epoch: 8, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.672 Vali Acc: 0.861 Test Loss: 0.672 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861104).  Saving model ...
Epoch: 9 cost time: 3.225552558898926
Epoch: 9, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.244471311569214
Epoch: 10, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.564 Vali Acc: 0.883 Test Loss: 0.564 Test Acc: 0.883
Validation loss decreased (-0.861104 --> -0.883328).  Saving model ...
Epoch: 11 cost time: 3.369427442550659
Epoch: 11, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.711 Vali Acc: 0.883 Test Loss: 0.711 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.136463165283203
Epoch: 12, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.548 Vali Acc: 0.889 Test Loss: 0.548 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888883).  Saving model ...
Epoch: 13 cost time: 3.312300443649292
Epoch: 13, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.717 Vali Acc: 0.867 Test Loss: 0.717 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2304201126098633
Epoch: 14, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.735 Vali Acc: 0.900 Test Loss: 0.735 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 3.352037191390991
Epoch: 15, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.737 Vali Acc: 0.872 Test Loss: 0.737 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1534156799316406
Epoch: 16, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.750 Vali Acc: 0.889 Test Loss: 0.750 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.103428840637207
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.655 Vali Acc: 0.894 Test Loss: 0.655 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2457449436187744
Epoch: 18, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.2281742095947266
Epoch: 19, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.850 Vali Acc: 0.878 Test Loss: 0.850 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.468773126602173
Epoch: 20, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.786 Vali Acc: 0.889 Test Loss: 0.786 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.5034983158111572
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.795 Vali Acc: 0.900 Test Loss: 0.795 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.652421236038208
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.731 Vali Acc: 0.894 Test Loss: 0.731 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.4896700382232666
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.868 Vali Acc: 0.889 Test Loss: 0.868 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.776935338973999
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.797 Vali Acc: 0.856 Test Loss: 0.797 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.977781295776367
Epoch: 1, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.344 Vali Acc: 0.367 Test Loss: 2.344 Test Acc: 0.367
Validation loss decreased (inf --> -0.366643).  Saving model ...
Epoch: 2 cost time: 3.4344801902770996
Epoch: 2, Steps: 12 | Train Loss: 2.144 Vali Loss: 1.742 Vali Acc: 0.511 Test Loss: 1.742 Test Acc: 0.511
Validation loss decreased (-0.366643 --> -0.511094).  Saving model ...
Epoch: 3 cost time: 3.377685070037842
Epoch: 3, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.383 Vali Acc: 0.633 Test Loss: 1.383 Test Acc: 0.633
Validation loss decreased (-0.511094 --> -0.633320).  Saving model ...
Epoch: 4 cost time: 3.229466199874878
Epoch: 4, Steps: 12 | Train Loss: 1.075 Vali Loss: 0.984 Vali Acc: 0.700 Test Loss: 0.984 Test Acc: 0.700
Validation loss decreased (-0.633320 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 3.821455717086792
Epoch: 5, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.880 Vali Acc: 0.744 Test Loss: 0.880 Test Acc: 0.744
Validation loss decreased (-0.699990 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 3.418919801712036
Epoch: 6, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0713422298431396
Epoch: 7, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.940 Vali Acc: 0.750 Test Loss: 0.940 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 3.378905773162842
Epoch: 8, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.914 Vali Acc: 0.794 Test Loss: 0.914 Test Acc: 0.794
Validation loss decreased (-0.749991 --> -0.794435).  Saving model ...
Epoch: 9 cost time: 3.4454872608184814
Epoch: 9, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.892 Vali Acc: 0.778 Test Loss: 0.892 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4659578800201416
Epoch: 10, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.922 Vali Acc: 0.783 Test Loss: 0.922 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.453632354736328
Epoch: 11, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.812 Vali Acc: 0.850 Test Loss: 0.812 Test Acc: 0.850
Validation loss decreased (-0.794435 --> -0.849992).  Saving model ...
Epoch: 12 cost time: 3.2490386962890625
Epoch: 12, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
Validation loss decreased (-0.849992 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 3.1904759407043457
Epoch: 13, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.761 Vali Acc: 0.844 Test Loss: 0.761 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3308470249176025
Epoch: 14, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.834 Vali Acc: 0.867 Test Loss: 0.834 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866658).  Saving model ...
Epoch: 15 cost time: 3.217515230178833
Epoch: 15, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.887 Vali Acc: 0.828 Test Loss: 0.887 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3316707611083984
Epoch: 16, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.844 Vali Acc: 0.856 Test Loss: 0.844 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.218482494354248
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.968 Vali Acc: 0.839 Test Loss: 0.968 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2847375869750977
Epoch: 18, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.361 Vali Acc: 0.778 Test Loss: 1.361 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.454610824584961
Epoch: 19, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.826 Vali Acc: 0.861 Test Loss: 0.826 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.243400812149048
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.207 Vali Acc: 0.806 Test Loss: 1.207 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3355042934417725
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.918 Vali Acc: 0.878 Test Loss: 0.918 Test Acc: 0.878
Validation loss decreased (-0.866658 --> -0.877769).  Saving model ...
Epoch: 22 cost time: 3.358264923095703
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.980 Vali Acc: 0.872 Test Loss: 0.980 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6096303462982178
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.774 Vali Acc: 0.872 Test Loss: 0.774 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5021519660949707
Epoch: 24, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.104 Vali Acc: 0.861 Test Loss: 1.104 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4420199394226074
Epoch: 25, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.051 Vali Acc: 0.861 Test Loss: 1.051 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.139991044998169
Epoch: 26, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.851 Vali Acc: 0.872 Test Loss: 0.851 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.369919776916504
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.843 Vali Acc: 0.867 Test Loss: 0.843 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.48742938041687
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.860 Vali Acc: 0.867 Test Loss: 0.860 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.3634982109069824
Epoch: 29, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.798 Vali Acc: 0.867 Test Loss: 0.798 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.161311626434326
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.876 Vali Acc: 0.861 Test Loss: 0.876 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.50496244430542
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.872 Test Loss: 0.893 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.330671310424805
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.436 Vali Acc: 0.267 Test Loss: 2.436 Test Acc: 0.267
Validation loss decreased (inf --> -0.266642).  Saving model ...
Epoch: 2 cost time: 3.283586263656616
Epoch: 2, Steps: 12 | Train Loss: 2.334 Vali Loss: 1.933 Vali Acc: 0.383 Test Loss: 1.933 Test Acc: 0.383
Validation loss decreased (-0.266642 --> -0.383314).  Saving model ...
Epoch: 3 cost time: 3.2163963317871094
Epoch: 3, Steps: 12 | Train Loss: 1.783 Vali Loss: 1.542 Vali Acc: 0.556 Test Loss: 1.542 Test Acc: 0.556
Validation loss decreased (-0.383314 --> -0.555540).  Saving model ...
Epoch: 4 cost time: 3.2600314617156982
Epoch: 4, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.138 Vali Acc: 0.611 Test Loss: 1.138 Test Acc: 0.611
Validation loss decreased (-0.555540 --> -0.611100).  Saving model ...
Epoch: 5 cost time: 3.4131314754486084
Epoch: 5, Steps: 12 | Train Loss: 0.895 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
Validation loss decreased (-0.611100 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 3.3879404067993164
Epoch: 6, Steps: 12 | Train Loss: 0.640 Vali Loss: 1.030 Vali Acc: 0.700 Test Loss: 1.030 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2301814556121826
Epoch: 7, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.965 Vali Acc: 0.794 Test Loss: 0.965 Test Acc: 0.794
Validation loss decreased (-0.716658 --> -0.794435).  Saving model ...
Epoch: 8 cost time: 3.3951873779296875
Epoch: 8, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6400249004364014
Epoch: 9, Steps: 12 | Train Loss: 0.462 Vali Loss: 1.078 Vali Acc: 0.794 Test Loss: 1.078 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0832531452178955
Epoch: 10, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.750 Vali Acc: 0.806 Test Loss: 0.750 Test Acc: 0.806
Validation loss decreased (-0.794435 --> -0.805548).  Saving model ...
Epoch: 11 cost time: 3.131265878677368
Epoch: 11, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.841 Vali Acc: 0.806 Test Loss: 0.841 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0858025550842285
Epoch: 12, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
Validation loss decreased (-0.805548 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 3.2250194549560547
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.039 Vali Acc: 0.783 Test Loss: 1.039 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6784300804138184
Epoch: 14, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.845 Vali Acc: 0.822 Test Loss: 0.845 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2559266090393066
Epoch: 15, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.785 Vali Acc: 0.828 Test Loss: 0.785 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4790380001068115
Epoch: 16, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.858 Vali Acc: 0.811 Test Loss: 0.858 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2296676635742188
Epoch: 17, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.713 Vali Acc: 0.817 Test Loss: 0.713 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.323660135269165
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.908 Vali Acc: 0.861 Test Loss: 0.908 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861102).  Saving model ...
Epoch: 19 cost time: 3.45588755607605
Epoch: 19, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.894 Vali Acc: 0.850 Test Loss: 0.894 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2837586402893066
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.957 Vali Acc: 0.867 Test Loss: 0.957 Test Acc: 0.867
Validation loss decreased (-0.861102 --> -0.866657).  Saving model ...
Epoch: 21 cost time: 3.2968077659606934
Epoch: 21, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.069 Vali Acc: 0.883 Test Loss: 1.069 Test Acc: 0.883
Validation loss decreased (-0.866657 --> -0.883323).  Saving model ...
Epoch: 22 cost time: 3.257025718688965
Epoch: 22, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.765 Vali Acc: 0.856 Test Loss: 0.765 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4304304122924805
Epoch: 23, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.740 Vali Acc: 0.867 Test Loss: 0.740 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.181774377822876
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.941 Vali Acc: 0.878 Test Loss: 0.941 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3992319107055664
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.982 Vali Acc: 0.850 Test Loss: 0.982 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.5138862133026123
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.344 Vali Acc: 0.839 Test Loss: 1.344 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3722691535949707
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.960 Vali Acc: 0.844 Test Loss: 0.960 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.2776546478271484
Epoch: 28, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.197 Vali Acc: 0.833 Test Loss: 1.197 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2333898544311523
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.122 Vali Acc: 0.844 Test Loss: 1.122 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.1617777347564697
Epoch: 30, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.064 Vali Acc: 0.806 Test Loss: 1.064 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.157923460006714
Epoch: 31, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.634 Vali Acc: 0.817 Test Loss: 1.634 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.008410215377808
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.272 Vali Acc: 0.272 Test Loss: 2.272 Test Acc: 0.272
Validation loss decreased (inf --> -0.272200).  Saving model ...
Epoch: 2 cost time: 3.18644642829895
Epoch: 2, Steps: 12 | Train Loss: 2.365 Vali Loss: 1.878 Vali Acc: 0.350 Test Loss: 1.878 Test Acc: 0.350
Validation loss decreased (-0.272200 --> -0.349981).  Saving model ...
Epoch: 3 cost time: 3.6875810623168945
Epoch: 3, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.706 Vali Acc: 0.494 Test Loss: 1.706 Test Acc: 0.494
Validation loss decreased (-0.349981 --> -0.494427).  Saving model ...
Epoch: 4 cost time: 3.2610177993774414
Epoch: 4, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.367 Vali Acc: 0.561 Test Loss: 1.367 Test Acc: 0.561
Validation loss decreased (-0.494427 --> -0.561097).  Saving model ...
Epoch: 5 cost time: 3.3057761192321777
Epoch: 5, Steps: 12 | Train Loss: 0.952 Vali Loss: 1.097 Vali Acc: 0.639 Test Loss: 1.097 Test Acc: 0.639
Validation loss decreased (-0.561097 --> -0.638878).  Saving model ...
Epoch: 6 cost time: 3.3264658451080322
Epoch: 6, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.065 Vali Acc: 0.672 Test Loss: 1.065 Test Acc: 0.672
Validation loss decreased (-0.638878 --> -0.672212).  Saving model ...
Epoch: 7 cost time: 3.3895201683044434
Epoch: 7, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.960 Vali Acc: 0.756 Test Loss: 0.960 Test Acc: 0.756
Validation loss decreased (-0.672212 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 3.6192264556884766
Epoch: 8, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.892 Vali Acc: 0.761 Test Loss: 0.892 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 9 cost time: 3.2504639625549316
Epoch: 9, Steps: 12 | Train Loss: 0.440 Vali Loss: 1.119 Vali Acc: 0.772 Test Loss: 1.119 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772211).  Saving model ...
Epoch: 10 cost time: 3.4023876190185547
Epoch: 10, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.925 Vali Acc: 0.772 Test Loss: 0.925 Test Acc: 0.772
Validation loss decreased (-0.772211 --> -0.772213).  Saving model ...
Epoch: 11 cost time: 3.32428240776062
Epoch: 11, Steps: 12 | Train Loss: 0.351 Vali Loss: 1.045 Vali Acc: 0.739 Test Loss: 1.045 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6032516956329346
Epoch: 12, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.695 Vali Acc: 0.806 Test Loss: 0.695 Test Acc: 0.806
Validation loss decreased (-0.772213 --> -0.805549).  Saving model ...
Epoch: 13 cost time: 3.235572576522827
Epoch: 13, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.972 Vali Acc: 0.789 Test Loss: 0.972 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.179443359375
Epoch: 14, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.813 Vali Acc: 0.800 Test Loss: 0.813 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.352975368499756
Epoch: 15, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.991 Vali Acc: 0.794 Test Loss: 0.991 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.265831470489502
Epoch: 16, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.898 Vali Acc: 0.839 Test Loss: 0.898 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838880).  Saving model ...
Epoch: 17 cost time: 3.057023763656616
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.750 Vali Acc: 0.806 Test Loss: 0.750 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.152038097381592
Epoch: 18, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1555230617523193
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.997 Vali Acc: 0.817 Test Loss: 0.997 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.159458637237549
Epoch: 20, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.915 Vali Acc: 0.844 Test Loss: 0.915 Test Acc: 0.844
Validation loss decreased (-0.838880 --> -0.844435).  Saving model ...
Epoch: 21 cost time: 3.3635239601135254
Epoch: 21, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.059 Vali Acc: 0.828 Test Loss: 1.059 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.445765972137451
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.292 Vali Acc: 0.806 Test Loss: 1.292 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.198042869567871
Epoch: 23, Steps: 12 | Train Loss: 0.274 Vali Loss: 1.118 Vali Acc: 0.822 Test Loss: 1.118 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.320507764816284
Epoch: 24, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.993 Vali Acc: 0.861 Test Loss: 0.993 Test Acc: 0.861
Validation loss decreased (-0.844435 --> -0.861101).  Saving model ...
Epoch: 25 cost time: 3.376519203186035
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.050 Vali Acc: 0.850 Test Loss: 1.050 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.1784563064575195
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.423 Vali Acc: 0.839 Test Loss: 1.423 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.29307222366333
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 1.371 Vali Acc: 0.817 Test Loss: 1.371 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.460827589035034
Epoch: 28, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.269 Vali Acc: 0.850 Test Loss: 1.269 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.353318214416504
Epoch: 29, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.184 Vali Acc: 0.844 Test Loss: 1.184 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.2816965579986572
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.170 Vali Acc: 0.817 Test Loss: 1.170 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.2824783325195312
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.153 Vali Acc: 0.839 Test Loss: 1.153 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.3826382160186768
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.196 Vali Acc: 0.839 Test Loss: 1.196 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.289405584335327
Epoch: 33, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.155 Vali Acc: 0.872 Test Loss: 1.155 Test Acc: 0.872
Validation loss decreased (-0.861101 --> -0.872211).  Saving model ...
Epoch: 34 cost time: 3.514350652694702
Epoch: 34, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.413 Vali Acc: 0.789 Test Loss: 1.413 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5007200241088867
Epoch: 35, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.408 Vali Acc: 0.861 Test Loss: 1.408 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2922449111938477
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.277 Vali Acc: 0.833 Test Loss: 1.277 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.3836147785186768
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.455 Vali Acc: 0.839 Test Loss: 1.455 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.376847267150879
Epoch: 38, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.151 Vali Acc: 0.861 Test Loss: 1.151 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.2096638679504395
Epoch: 39, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.160 Vali Acc: 0.878 Test Loss: 1.160 Test Acc: 0.878
Validation loss decreased (-0.872211 --> -0.877766).  Saving model ...
Epoch: 40 cost time: 3.377453565597534
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.747 Vali Acc: 0.828 Test Loss: 1.747 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4244866371154785
Epoch: 41, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.220 Vali Acc: 0.883 Test Loss: 1.220 Test Acc: 0.883
Validation loss decreased (-0.877766 --> -0.883321).  Saving model ...
Epoch: 42 cost time: 3.435990810394287
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.139 Vali Acc: 0.889 Test Loss: 1.139 Test Acc: 0.889
Validation loss decreased (-0.883321 --> -0.888878).  Saving model ...
Epoch: 43 cost time: 3.58947491645813
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.470 Vali Acc: 0.861 Test Loss: 1.470 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.784975290298462
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.298 Vali Acc: 0.839 Test Loss: 1.298 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.3877241611480713
Epoch: 45, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.337 Vali Acc: 0.800 Test Loss: 1.337 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.405940294265747
Epoch: 46, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.270 Vali Acc: 0.861 Test Loss: 1.270 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.366173505783081
Epoch: 47, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.430 Vali Acc: 0.856 Test Loss: 1.430 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.5323195457458496
Epoch: 48, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.801 Vali Acc: 0.800 Test Loss: 1.801 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.375527858734131
Epoch: 49, Steps: 12 | Train Loss: 0.241 Vali Loss: 1.617 Vali Acc: 0.822 Test Loss: 1.617 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.2790517807006836
Epoch: 50, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.685 Vali Acc: 0.822 Test Loss: 1.685 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.183095932006836
Epoch: 51, Steps: 12 | Train Loss: 0.129 Vali Loss: 2.677 Vali Acc: 0.761 Test Loss: 2.677 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.354062795639038
Epoch: 52, Steps: 12 | Train Loss: 0.548 Vali Loss: 2.210 Vali Acc: 0.794 Test Loss: 2.210 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.996654510498047
Epoch: 1, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.027 Vali Acc: 0.383 Test Loss: 2.027 Test Acc: 0.383
Validation loss decreased (inf --> -0.383313).  Saving model ...
Epoch: 2 cost time: 3.239529848098755
Epoch: 2, Steps: 12 | Train Loss: 2.398 Vali Loss: 1.867 Vali Acc: 0.400 Test Loss: 1.867 Test Acc: 0.400
Validation loss decreased (-0.383313 --> -0.399981).  Saving model ...
Epoch: 3 cost time: 3.305616855621338
Epoch: 3, Steps: 12 | Train Loss: 1.933 Vali Loss: 1.750 Vali Acc: 0.467 Test Loss: 1.750 Test Acc: 0.467
Validation loss decreased (-0.399981 --> -0.466649).  Saving model ...
Epoch: 4 cost time: 3.354573965072632
Epoch: 4, Steps: 12 | Train Loss: 1.372 Vali Loss: 1.388 Vali Acc: 0.539 Test Loss: 1.388 Test Acc: 0.539
Validation loss decreased (-0.466649 --> -0.538875).  Saving model ...
Epoch: 5 cost time: 3.345911741256714
Epoch: 5, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.086 Vali Acc: 0.672 Test Loss: 1.086 Test Acc: 0.672
Validation loss decreased (-0.538875 --> -0.672211).  Saving model ...
Epoch: 6 cost time: 3.2343220710754395
Epoch: 6, Steps: 12 | Train Loss: 0.670 Vali Loss: 1.063 Vali Acc: 0.644 Test Loss: 1.063 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9832568168640137
Epoch: 7, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.021 Vali Acc: 0.728 Test Loss: 1.021 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727768).  Saving model ...
Epoch: 8 cost time: 3.5406455993652344
Epoch: 8, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.986 Vali Acc: 0.772 Test Loss: 0.986 Test Acc: 0.772
Validation loss decreased (-0.727768 --> -0.772212).  Saving model ...
Epoch: 9 cost time: 3.6219775676727295
Epoch: 9, Steps: 12 | Train Loss: 0.461 Vali Loss: 1.195 Vali Acc: 0.767 Test Loss: 1.195 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.323878049850464
Epoch: 10, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.162520170211792
Epoch: 11, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.977 Vali Acc: 0.744 Test Loss: 0.977 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3769822120666504
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.772212 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 3.09051775932312
Epoch: 13, Steps: 12 | Train Loss: 0.182 Vali Loss: 1.035 Vali Acc: 0.778 Test Loss: 1.035 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.452531099319458
Epoch: 14, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.869 Vali Acc: 0.800 Test Loss: 0.869 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4042632579803467
Epoch: 15, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.794 Vali Acc: 0.822 Test Loss: 0.794 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3166003227233887
Epoch: 16, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.770 Vali Acc: 0.850 Test Loss: 0.770 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 3.3506176471710205
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.714 Vali Acc: 0.822 Test Loss: 0.714 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.348134756088257
Epoch: 18, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.860 Vali Acc: 0.856 Test Loss: 0.860 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855547).  Saving model ...
Epoch: 19 cost time: 3.405719518661499
Epoch: 19, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.816 Vali Acc: 0.839 Test Loss: 0.816 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4453582763671875
Epoch: 20, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.915 Vali Acc: 0.850 Test Loss: 0.915 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.448143720626831
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.104 Vali Acc: 0.861 Test Loss: 1.104 Test Acc: 0.861
Validation loss decreased (-0.855547 --> -0.861100).  Saving model ...
Epoch: 22 cost time: 3.530109405517578
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.969 Vali Acc: 0.839 Test Loss: 0.969 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4061901569366455
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.030 Vali Acc: 0.844 Test Loss: 1.030 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6358797550201416
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.033 Vali Acc: 0.850 Test Loss: 1.033 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.6361448764801025
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.008 Vali Acc: 0.817 Test Loss: 1.008 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.3892481327056885
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.231 Vali Acc: 0.811 Test Loss: 1.231 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4524104595184326
Epoch: 27, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.196 Vali Acc: 0.850 Test Loss: 1.196 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.4137163162231445
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.867 Vali Acc: 0.872 Test Loss: 0.867 Test Acc: 0.872
Validation loss decreased (-0.861100 --> -0.872214).  Saving model ...
Epoch: 29 cost time: 3.470194101333618
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.137 Vali Acc: 0.844 Test Loss: 1.137 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5318517684936523
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.020 Vali Acc: 0.833 Test Loss: 1.020 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2922163009643555
Epoch: 31, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.107 Vali Acc: 0.861 Test Loss: 1.107 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.378551483154297
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.075 Vali Acc: 0.783 Test Loss: 1.075 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.370120048522949
Epoch: 33, Steps: 12 | Train Loss: 0.425 Vali Loss: 2.318 Vali Acc: 0.783 Test Loss: 2.318 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.359394073486328
Epoch: 34, Steps: 12 | Train Loss: 0.363 Vali Loss: 2.070 Vali Acc: 0.794 Test Loss: 2.070 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.1475141048431396
Epoch: 35, Steps: 12 | Train Loss: 0.283 Vali Loss: 1.864 Vali Acc: 0.817 Test Loss: 1.864 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.1399524211883545
Epoch: 36, Steps: 12 | Train Loss: 0.195 Vali Loss: 1.386 Vali Acc: 0.806 Test Loss: 1.386 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3793816566467285
Epoch: 37, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.351 Vali Acc: 0.839 Test Loss: 1.351 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.1432340145111084
Epoch: 38, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.404 Vali Acc: 0.822 Test Loss: 1.404 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.742419481277466
Epoch: 1, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.183 Vali Acc: 0.272 Test Loss: 2.183 Test Acc: 0.272
Validation loss decreased (inf --> -0.272200).  Saving model ...
Epoch: 2 cost time: 3.180751323699951
Epoch: 2, Steps: 12 | Train Loss: 2.415 Vali Loss: 1.872 Vali Acc: 0.400 Test Loss: 1.872 Test Acc: 0.400
Validation loss decreased (-0.272200 --> -0.399981).  Saving model ...
Epoch: 3 cost time: 3.112783670425415
Epoch: 3, Steps: 12 | Train Loss: 1.980 Vali Loss: 1.805 Vali Acc: 0.461 Test Loss: 1.805 Test Acc: 0.461
Validation loss decreased (-0.399981 --> -0.461093).  Saving model ...
Epoch: 4 cost time: 3.3620920181274414
Epoch: 4, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.415 Vali Acc: 0.561 Test Loss: 1.415 Test Acc: 0.561
Validation loss decreased (-0.461093 --> -0.561097).  Saving model ...
Epoch: 5 cost time: 3.396418571472168
Epoch: 5, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.114 Vali Acc: 0.667 Test Loss: 1.114 Test Acc: 0.667
Validation loss decreased (-0.561097 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 3.2429757118225098
Epoch: 6, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.103 Vali Acc: 0.644 Test Loss: 1.103 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.519667625427246
Epoch: 7, Steps: 12 | Train Loss: 0.570 Vali Loss: 1.012 Vali Acc: 0.722 Test Loss: 1.012 Test Acc: 0.722
Validation loss decreased (-0.666656 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 3.2661550045013428
Epoch: 8, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.984 Vali Acc: 0.783 Test Loss: 0.984 Test Acc: 0.783
Validation loss decreased (-0.722212 --> -0.783323).  Saving model ...
Epoch: 9 cost time: 3.1734251976013184
Epoch: 9, Steps: 12 | Train Loss: 0.438 Vali Loss: 1.168 Vali Acc: 0.772 Test Loss: 1.168 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6413016319274902
Epoch: 10, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.969 Vali Acc: 0.767 Test Loss: 0.969 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2706785202026367
Epoch: 11, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.955 Vali Acc: 0.767 Test Loss: 0.955 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3881642818450928
Epoch: 12, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.803 Vali Acc: 0.789 Test Loss: 0.803 Test Acc: 0.789
Validation loss decreased (-0.783323 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 3.487675666809082
Epoch: 13, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.943 Vali Acc: 0.761 Test Loss: 0.943 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4572665691375732
Epoch: 14, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.812 Vali Acc: 0.789 Test Loss: 0.812 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.472454786300659
Epoch: 15, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.874 Vali Acc: 0.817 Test Loss: 0.874 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816658).  Saving model ...
Epoch: 16 cost time: 3.2460947036743164
Epoch: 16, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.690 Vali Acc: 0.833 Test Loss: 0.690 Test Acc: 0.833
Validation loss decreased (-0.816658 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 3.2342941761016846
Epoch: 17, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.804 Vali Acc: 0.839 Test Loss: 0.804 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838881).  Saving model ...
Epoch: 18 cost time: 3.3553669452667236
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.929 Vali Acc: 0.867 Test Loss: 0.929 Test Acc: 0.867
Validation loss decreased (-0.838881 --> -0.866657).  Saving model ...
Epoch: 19 cost time: 3.03179931640625
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.186985492706299
Epoch: 20, Steps: 12 | Train Loss: 0.129 Vali Loss: 1.067 Vali Acc: 0.839 Test Loss: 1.067 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2736546993255615
Epoch: 21, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.112 Vali Acc: 0.844 Test Loss: 1.112 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3226101398468018
Epoch: 22, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.974 Vali Acc: 0.839 Test Loss: 0.974 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4361155033111572
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.122 Vali Acc: 0.861 Test Loss: 1.122 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.310635805130005
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.866 Vali Acc: 0.839 Test Loss: 0.866 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1595394611358643
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.804 Vali Acc: 0.878 Test Loss: 0.804 Test Acc: 0.878
Validation loss decreased (-0.866657 --> -0.877770).  Saving model ...
Epoch: 26 cost time: 3.2944586277008057
Epoch: 26, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.052 Vali Acc: 0.872 Test Loss: 1.052 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3890368938446045
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.129 Vali Acc: 0.850 Test Loss: 1.129 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0086004734039307
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.406 Vali Acc: 0.789 Test Loss: 1.406 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2607033252716064
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.369 Vali Acc: 0.828 Test Loss: 1.369 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.365259885787964
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.171 Vali Acc: 0.839 Test Loss: 1.171 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.293046712875366
Epoch: 31, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.394 Vali Acc: 0.817 Test Loss: 1.394 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.506410598754883
Epoch: 32, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.549 Vali Acc: 0.806 Test Loss: 1.549 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.297271251678467
Epoch: 33, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.364 Vali Acc: 0.822 Test Loss: 1.364 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.58573055267334
Epoch: 34, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.394 Vali Acc: 0.828 Test Loss: 1.394 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.3959367275238037
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.378 Vali Acc: 0.817 Test Loss: 1.378 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.349254131317139
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.288444757461548
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.1688709259033203
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.435883045196533
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1737468242645264
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 3.443537473678589
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 7 cost time: 3.240375280380249
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.3639485836029053
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.127244710922241
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1751956939697266
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 11 cost time: 3.205197811126709
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 12 cost time: 3.3312225341796875
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2550013065338135
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2391133308410645
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6201207637786865
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.4311630725860596
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.383125066757202
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3004863262176514
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2726731300354004
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.1510205268859863
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.5124876499176025
Epoch: 21, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 8238095
model size : 50.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.933934926986694
Epoch: 1, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.197 Vali Acc: 0.517 Test Loss: 2.197 Test Acc: 0.517
Validation loss decreased (inf --> -0.516645).  Saving model ...
Epoch: 2 cost time: 3.1818387508392334
Epoch: 2, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.429 Vali Acc: 0.600 Test Loss: 1.429 Test Acc: 0.600
Validation loss decreased (-0.516645 --> -0.599986).  Saving model ...
Epoch: 3 cost time: 3.297971725463867
Epoch: 3, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.137 Vali Acc: 0.733 Test Loss: 1.137 Test Acc: 0.733
Validation loss decreased (-0.599986 --> -0.733322).  Saving model ...
Epoch: 4 cost time: 3.37117600440979
Epoch: 4, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.947 Vali Acc: 0.744 Test Loss: 0.947 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744435).  Saving model ...
Epoch: 5 cost time: 3.1835083961486816
Epoch: 5, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.714 Vali Acc: 0.800 Test Loss: 0.714 Test Acc: 0.800
Validation loss decreased (-0.744435 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 3.277066946029663
Epoch: 6, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.710 Vali Acc: 0.828 Test Loss: 0.710 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827771).  Saving model ...
Epoch: 7 cost time: 3.4187259674072266
Epoch: 7, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.760 Vali Acc: 0.794 Test Loss: 0.760 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1731278896331787
Epoch: 8, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 9 cost time: 3.2176053524017334
Epoch: 9, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 3.0551633834838867
Epoch: 10, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 3.165100336074829
Epoch: 11, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 2.977064847946167
Epoch: 12, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 3.1943092346191406
Epoch: 13, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2163987159729004
Epoch: 14, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.678 Vali Acc: 0.894 Test Loss: 0.678 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1851367950439453
Epoch: 15, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 3.0846962928771973
Epoch: 16, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.473 Vali Acc: 0.894 Test Loss: 0.473 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9798967838287354
Epoch: 17, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1604461669921875
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3409671783447266
Epoch: 19, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4123082160949707
Epoch: 20, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.820 Vali Acc: 0.889 Test Loss: 0.820 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.111560821533203
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.623 Vali Acc: 0.883 Test Loss: 0.623 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.122347116470337
Epoch: 22, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.793 Vali Acc: 0.894 Test Loss: 0.793 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.2276384830474854
Epoch: 23, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.906 Test Loss: 0.806 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905547).  Saving model ...
Epoch: 24 cost time: 3.1984703540802
Epoch: 24, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.894 Test Loss: 0.790 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1187524795532227
Epoch: 25, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.894 Test Loss: 0.736 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.296138048171997
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.900 Test Loss: 0.727 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.0368034839630127
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.894 Test Loss: 0.738 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.151148557662964
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.889 Test Loss: 0.757 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.12066388130188
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.900 Test Loss: 0.758 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.217226266860962
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.900 Test Loss: 0.759 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.2492470741271973
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.894 Test Loss: 0.760 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.1401398181915283
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.900 Test Loss: 0.756 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.305936574935913
Epoch: 33, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.900 Test Loss: 0.751 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.096828937530518
Epoch: 1, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.263 Vali Acc: 0.478 Test Loss: 2.263 Test Acc: 0.478
Validation loss decreased (inf --> -0.477755).  Saving model ...
Epoch: 2 cost time: 3.422039747238159
Epoch: 2, Steps: 12 | Train Loss: 2.076 Vali Loss: 1.566 Vali Acc: 0.572 Test Loss: 1.566 Test Acc: 0.572
Validation loss decreased (-0.477755 --> -0.572207).  Saving model ...
Epoch: 3 cost time: 3.3568098545074463
Epoch: 3, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.222 Vali Acc: 0.650 Test Loss: 1.222 Test Acc: 0.650
Validation loss decreased (-0.572207 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 3.46382999420166
Epoch: 4, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.070 Vali Acc: 0.711 Test Loss: 1.070 Test Acc: 0.711
Validation loss decreased (-0.649988 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 3.223463296890259
Epoch: 5, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.808 Vali Acc: 0.767 Test Loss: 0.808 Test Acc: 0.767
Validation loss decreased (-0.711100 --> -0.766659).  Saving model ...
Epoch: 6 cost time: 3.611346483230591
Epoch: 6, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.839 Vali Acc: 0.794 Test Loss: 0.839 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794436).  Saving model ...
Epoch: 7 cost time: 3.4966228008270264
Epoch: 7, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.824 Vali Acc: 0.811 Test Loss: 0.824 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 8 cost time: 3.4873619079589844
Epoch: 8, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.729 Vali Acc: 0.856 Test Loss: 0.729 Test Acc: 0.856
Validation loss decreased (-0.811103 --> -0.855548).  Saving model ...
Epoch: 9 cost time: 3.4889862537384033
Epoch: 9, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.593 Vali Acc: 0.872 Test Loss: 0.593 Test Acc: 0.872
Validation loss decreased (-0.855548 --> -0.872216).  Saving model ...
Epoch: 10 cost time: 3.5280978679656982
Epoch: 10, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.318786859512329
Epoch: 11, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.607 Vali Acc: 0.878 Test Loss: 0.607 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 12 cost time: 3.3139514923095703
Epoch: 12, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.675 Vali Acc: 0.889 Test Loss: 0.675 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 3.1829140186309814
Epoch: 13, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.926 Vali Acc: 0.828 Test Loss: 0.926 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3441684246063232
Epoch: 14, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.689 Vali Acc: 0.883 Test Loss: 0.689 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3212480545043945
Epoch: 15, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.614 Vali Acc: 0.883 Test Loss: 0.614 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3227903842926025
Epoch: 16, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.639 Vali Acc: 0.894 Test Loss: 0.639 Test Acc: 0.894
Validation loss decreased (-0.888882 --> -0.894438).  Saving model ...
Epoch: 17 cost time: 3.113072156906128
Epoch: 17, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9895479679107666
Epoch: 18, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.766 Vali Acc: 0.883 Test Loss: 0.766 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.446763515472412
Epoch: 19, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.707 Vali Acc: 0.894 Test Loss: 0.707 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1320109367370605
Epoch: 20, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.705 Vali Acc: 0.883 Test Loss: 0.705 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.5121748447418213
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.710 Vali Acc: 0.900 Test Loss: 0.710 Test Acc: 0.900
Validation loss decreased (-0.894438 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 3.0014748573303223
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.774 Vali Acc: 0.889 Test Loss: 0.774 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1288952827453613
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.783 Vali Acc: 0.889 Test Loss: 0.783 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5280182361602783
Epoch: 24, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.735 Vali Acc: 0.889 Test Loss: 0.735 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3694727420806885
Epoch: 25, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.889 Test Loss: 0.725 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.3071117401123047
Epoch: 26, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.889 Test Loss: 0.726 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.265821695327759
Epoch: 27, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.894 Test Loss: 0.738 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.297173261642456
Epoch: 28, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.894 Test Loss: 0.750 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.5917956829071045
Epoch: 29, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.900 Test Loss: 0.746 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.5370755195617676
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.900 Test Loss: 0.744 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.502845525741577
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.900 Test Loss: 0.740 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.5036461353302
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.333 Vali Acc: 0.367 Test Loss: 2.333 Test Acc: 0.367
Validation loss decreased (inf --> -0.366643).  Saving model ...
Epoch: 2 cost time: 3.678372859954834
Epoch: 2, Steps: 12 | Train Loss: 2.254 Vali Loss: 1.755 Vali Acc: 0.483 Test Loss: 1.755 Test Acc: 0.483
Validation loss decreased (-0.366643 --> -0.483316).  Saving model ...
Epoch: 3 cost time: 3.334961414337158
Epoch: 3, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.383 Vali Acc: 0.611 Test Loss: 1.383 Test Acc: 0.611
Validation loss decreased (-0.483316 --> -0.611097).  Saving model ...
Epoch: 4 cost time: 3.518077850341797
Epoch: 4, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.130 Vali Acc: 0.656 Test Loss: 1.130 Test Acc: 0.656
Validation loss decreased (-0.611097 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 3.3141114711761475
Epoch: 5, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.945 Vali Acc: 0.700 Test Loss: 0.945 Test Acc: 0.700
Validation loss decreased (-0.655544 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 3.167020082473755
Epoch: 6, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.976 Vali Acc: 0.761 Test Loss: 0.976 Test Acc: 0.761
Validation loss decreased (-0.699991 --> -0.761101).  Saving model ...
Epoch: 7 cost time: 3.248948335647583
Epoch: 7, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.941 Vali Acc: 0.739 Test Loss: 0.941 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5631794929504395
Epoch: 8, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.928 Vali Acc: 0.783 Test Loss: 0.928 Test Acc: 0.783
Validation loss decreased (-0.761101 --> -0.783324).  Saving model ...
Epoch: 9 cost time: 3.4064433574676514
Epoch: 9, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
Validation loss decreased (-0.783324 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 3.3878331184387207
Epoch: 10, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.443016767501831
Epoch: 11, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.770 Vali Acc: 0.839 Test Loss: 0.770 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838881).  Saving model ...
Epoch: 12 cost time: 3.2015480995178223
Epoch: 12, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.805 Vali Acc: 0.839 Test Loss: 0.805 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7395424842834473
Epoch: 13, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.871 Vali Acc: 0.817 Test Loss: 0.871 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3089184761047363
Epoch: 14, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.805 Vali Acc: 0.878 Test Loss: 0.805 Test Acc: 0.878
Validation loss decreased (-0.838881 --> -0.877770).  Saving model ...
Epoch: 15 cost time: 3.8138155937194824
Epoch: 15, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.875 Vali Acc: 0.811 Test Loss: 0.875 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.883639335632324
Epoch: 16, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.722 Vali Acc: 0.867 Test Loss: 0.722 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6740779876708984
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.029 Vali Acc: 0.811 Test Loss: 1.029 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.733623743057251
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.997 Vali Acc: 0.856 Test Loss: 0.997 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.050914525985718
Epoch: 19, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.885 Vali Acc: 0.867 Test Loss: 0.885 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9182302951812744
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.843 Vali Acc: 0.867 Test Loss: 0.843 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8341174125671387
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.528195142745972
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.318 Vali Acc: 0.822 Test Loss: 1.318 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.397526264190674
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.023 Vali Acc: 0.850 Test Loss: 1.023 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.382792234420776
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.289 Vali Acc: 0.800 Test Loss: 1.289 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.379276990890503
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.429 Vali Acc: 0.233 Test Loss: 2.429 Test Acc: 0.233
Validation loss decreased (inf --> -0.233309).  Saving model ...
Epoch: 2 cost time: 4.921078681945801
Epoch: 2, Steps: 12 | Train Loss: 2.386 Vali Loss: 1.944 Vali Acc: 0.328 Test Loss: 1.944 Test Acc: 0.328
Validation loss decreased (-0.233309 --> -0.327758).  Saving model ...
Epoch: 3 cost time: 4.41043496131897
Epoch: 3, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.572 Vali Acc: 0.522 Test Loss: 1.572 Test Acc: 0.522
Validation loss decreased (-0.327758 --> -0.522207).  Saving model ...
Epoch: 4 cost time: 4.187294960021973
Epoch: 4, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.161 Vali Acc: 0.622 Test Loss: 1.161 Test Acc: 0.622
Validation loss decreased (-0.522207 --> -0.622211).  Saving model ...
Epoch: 5 cost time: 3.5953359603881836
Epoch: 5, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.026 Vali Acc: 0.700 Test Loss: 1.026 Test Acc: 0.700
Validation loss decreased (-0.622211 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 3.28640079498291
Epoch: 6, Steps: 12 | Train Loss: 0.643 Vali Loss: 1.047 Vali Acc: 0.711 Test Loss: 1.047 Test Acc: 0.711
Validation loss decreased (-0.699990 --> -0.711101).  Saving model ...
Epoch: 7 cost time: 3.2481024265289307
Epoch: 7, Steps: 12 | Train Loss: 0.613 Vali Loss: 1.080 Vali Acc: 0.733 Test Loss: 1.080 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 3.2977845668792725
Epoch: 8, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.661 Vali Acc: 0.828 Test Loss: 0.661 Test Acc: 0.828
Validation loss decreased (-0.733323 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 3.3459300994873047
Epoch: 9, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.714 Vali Acc: 0.794 Test Loss: 0.714 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2704155445098877
Epoch: 10, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.683 Vali Acc: 0.817 Test Loss: 0.683 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5069761276245117
Epoch: 11, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.881 Vali Acc: 0.794 Test Loss: 0.881 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.34946346282959
Epoch: 12, Steps: 12 | Train Loss: 0.459 Vali Loss: 1.069 Vali Acc: 0.811 Test Loss: 1.069 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.432194232940674
Epoch: 13, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.895 Vali Acc: 0.817 Test Loss: 0.895 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5064244270324707
Epoch: 14, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.7284884452819824
Epoch: 15, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.060 Vali Acc: 0.822 Test Loss: 1.060 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.553952932357788
Epoch: 16, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.743 Vali Acc: 0.828 Test Loss: 0.743 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.743610143661499
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.989 Vali Acc: 0.833 Test Loss: 0.989 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833323).  Saving model ...
Epoch: 18 cost time: 3.7997498512268066
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.787 Vali Acc: 0.839 Test Loss: 0.787 Test Acc: 0.839
Validation loss decreased (-0.833323 --> -0.838881).  Saving model ...
Epoch: 19 cost time: 3.4560108184814453
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.168 Vali Acc: 0.833 Test Loss: 1.168 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5781311988830566
Epoch: 20, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.090 Vali Acc: 0.844 Test Loss: 1.090 Test Acc: 0.844
Validation loss decreased (-0.838881 --> -0.844434).  Saving model ...
Epoch: 21 cost time: 3.5126068592071533
Epoch: 21, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.044 Vali Acc: 0.867 Test Loss: 1.044 Test Acc: 0.867
Validation loss decreased (-0.844434 --> -0.866656).  Saving model ...
Epoch: 22 cost time: 3.251652717590332
Epoch: 22, Steps: 12 | Train Loss: 0.319 Vali Loss: 1.078 Vali Acc: 0.806 Test Loss: 1.078 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.537245273590088
Epoch: 23, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.472 Vali Acc: 0.811 Test Loss: 1.472 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2300329208374023
Epoch: 24, Steps: 12 | Train Loss: 0.324 Vali Loss: 1.350 Vali Acc: 0.822 Test Loss: 1.350 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4666523933410645
Epoch: 25, Steps: 12 | Train Loss: 0.326 Vali Loss: 1.326 Vali Acc: 0.817 Test Loss: 1.326 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.264213800430298
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.934 Vali Acc: 0.850 Test Loss: 0.934 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.359151840209961
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.365 Vali Acc: 0.850 Test Loss: 1.365 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.1873364448547363
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.317 Vali Acc: 0.811 Test Loss: 1.317 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2925548553466797
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.305 Vali Acc: 0.844 Test Loss: 1.305 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.705253839492798
Epoch: 30, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.361 Vali Acc: 0.850 Test Loss: 1.361 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.345102310180664
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.152 Vali Acc: 0.861 Test Loss: 1.152 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.953183174133301
Epoch: 1, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.287 Vali Acc: 0.339 Test Loss: 2.287 Test Acc: 0.339
Validation loss decreased (inf --> -0.338866).  Saving model ...
Epoch: 2 cost time: 3.1676816940307617
Epoch: 2, Steps: 12 | Train Loss: 2.492 Vali Loss: 1.820 Vali Acc: 0.428 Test Loss: 1.820 Test Acc: 0.428
Validation loss decreased (-0.338866 --> -0.427760).  Saving model ...
Epoch: 3 cost time: 3.2258946895599365
Epoch: 3, Steps: 12 | Train Loss: 1.944 Vali Loss: 1.895 Vali Acc: 0.461 Test Loss: 1.895 Test Acc: 0.461
Validation loss decreased (-0.427760 --> -0.461092).  Saving model ...
Epoch: 4 cost time: 3.266587257385254
Epoch: 4, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.289 Vali Acc: 0.622 Test Loss: 1.289 Test Acc: 0.622
Validation loss decreased (-0.461092 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 3.5783040523529053
Epoch: 5, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.216 Vali Acc: 0.656 Test Loss: 1.216 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655543).  Saving model ...
Epoch: 6 cost time: 3.3963353633880615
Epoch: 6, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.996 Vali Acc: 0.706 Test Loss: 0.996 Test Acc: 0.706
Validation loss decreased (-0.655543 --> -0.705546).  Saving model ...
Epoch: 7 cost time: 3.57541561126709
Epoch: 7, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 3.4659085273742676
Epoch: 8, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.736 Vali Acc: 0.817 Test Loss: 0.736 Test Acc: 0.817
Validation loss decreased (-0.733324 --> -0.816659).  Saving model ...
Epoch: 9 cost time: 3.3994076251983643
Epoch: 9, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 10 cost time: 3.418393850326538
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.601806163787842
Epoch: 11, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.794 Vali Acc: 0.794 Test Loss: 0.794 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6238551139831543
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 1.050 Vali Acc: 0.794 Test Loss: 1.050 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.695668935775757
Epoch: 13, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.848 Vali Acc: 0.806 Test Loss: 0.848 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2954559326171875
Epoch: 14, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.742 Vali Acc: 0.839 Test Loss: 0.742 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838881).  Saving model ...
Epoch: 15 cost time: 3.406193971633911
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.048 Vali Acc: 0.828 Test Loss: 1.048 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.362061023712158
Epoch: 16, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9571075439453125
Epoch: 17, Steps: 12 | Train Loss: 0.190 Vali Loss: 1.123 Vali Acc: 0.817 Test Loss: 1.123 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.9252521991729736
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.957 Vali Acc: 0.811 Test Loss: 0.957 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.9141433238983154
Epoch: 19, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.257 Vali Acc: 0.811 Test Loss: 1.257 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9484970569610596
Epoch: 20, Steps: 12 | Train Loss: 0.265 Vali Loss: 1.387 Vali Acc: 0.839 Test Loss: 1.387 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.170415163040161
Epoch: 21, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.191 Vali Acc: 0.833 Test Loss: 1.191 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.9625258445739746
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.266 Vali Acc: 0.822 Test Loss: 1.266 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.6250035762786865
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.020 Vali Acc: 0.856 Test Loss: 1.020 Test Acc: 0.856
Validation loss decreased (-0.838881 --> -0.855545).  Saving model ...
Epoch: 24 cost time: 3.788320541381836
Epoch: 24, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.941 Vali Acc: 0.867 Test Loss: 0.941 Test Acc: 0.867
Validation loss decreased (-0.855545 --> -0.866657).  Saving model ...
Epoch: 25 cost time: 3.5877087116241455
Epoch: 25, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.403 Vali Acc: 0.861 Test Loss: 1.403 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.134229898452759
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 1.222 Vali Acc: 0.828 Test Loss: 1.222 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8014378547668457
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.381 Vali Acc: 0.789 Test Loss: 1.381 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8913917541503906
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.277 Vali Acc: 0.839 Test Loss: 1.277 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.63693904876709
Epoch: 29, Steps: 12 | Train Loss: 0.221 Vali Loss: 1.230 Vali Acc: 0.839 Test Loss: 1.230 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.231519937515259
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.498 Vali Acc: 0.828 Test Loss: 1.498 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.881333351135254
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.250 Vali Acc: 0.822 Test Loss: 1.250 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.966876983642578
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.240 Vali Acc: 0.822 Test Loss: 1.240 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.8639628887176514
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.258 Vali Acc: 0.833 Test Loss: 1.258 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.307079315185547
Epoch: 34, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.367 Vali Acc: 0.878 Test Loss: 1.367 Test Acc: 0.878
Validation loss decreased (-0.866657 --> -0.877764).  Saving model ...
Epoch: 35 cost time: 4.2650651931762695
Epoch: 35, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.109 Vali Acc: 0.878 Test Loss: 1.109 Test Acc: 0.878
Validation loss decreased (-0.877764 --> -0.877767).  Saving model ...
Epoch: 36 cost time: 4.087847471237183
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.559 Vali Acc: 0.833 Test Loss: 1.559 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.9030489921569824
Epoch: 37, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.408 Vali Acc: 0.839 Test Loss: 1.408 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.8713159561157227
Epoch: 38, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.213 Vali Acc: 0.822 Test Loss: 1.213 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.877917766571045
Epoch: 39, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.362 Vali Acc: 0.867 Test Loss: 1.362 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.7194266319274902
Epoch: 40, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.456 Vali Acc: 0.833 Test Loss: 1.456 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.8436222076416016
Epoch: 41, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.756 Vali Acc: 0.822 Test Loss: 1.756 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.228195667266846
Epoch: 42, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.481 Vali Acc: 0.861 Test Loss: 1.481 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.8221280574798584
Epoch: 43, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.392 Vali Acc: 0.872 Test Loss: 1.392 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.054831027984619
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.458 Vali Acc: 0.817 Test Loss: 1.458 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.868701934814453
Epoch: 45, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.436 Vali Acc: 0.883 Test Loss: 1.436 Test Acc: 0.883
Validation loss decreased (-0.877767 --> -0.883319).  Saving model ...
Epoch: 46 cost time: 4.1399149894714355
Epoch: 46, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.415 Vali Acc: 0.889 Test Loss: 1.415 Test Acc: 0.889
Validation loss decreased (-0.883319 --> -0.888875).  Saving model ...
Epoch: 47 cost time: 4.100817680358887
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.883 Test Loss: 1.324 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.190149784088135
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.319 Vali Acc: 0.883 Test Loss: 1.319 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 4.029999017715454
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.320 Vali Acc: 0.878 Test Loss: 1.320 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.6280224323272705
Epoch: 50, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.264 Vali Acc: 0.878 Test Loss: 1.264 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.9743874073028564
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 1.290 Vali Acc: 0.872 Test Loss: 1.290 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.9064605236053467
Epoch: 52, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.872 Test Loss: 1.297 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.9344186782836914
Epoch: 53, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.254 Vali Acc: 0.872 Test Loss: 1.254 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 4.108765125274658
Epoch: 54, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.883 Test Loss: 1.248 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.873946189880371
Epoch: 55, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.883 Test Loss: 1.250 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 4.221589088439941
Epoch: 56, Steps: 12 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.883 Test Loss: 1.251 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.248498201370239
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.038 Vali Acc: 0.372 Test Loss: 2.038 Test Acc: 0.372
Validation loss decreased (inf --> -0.372202).  Saving model ...
Epoch: 2 cost time: 3.9206862449645996
Epoch: 2, Steps: 12 | Train Loss: 2.480 Vali Loss: 1.831 Vali Acc: 0.383 Test Loss: 1.831 Test Acc: 0.383
Validation loss decreased (-0.372202 --> -0.383315).  Saving model ...
Epoch: 3 cost time: 3.918137788772583
Epoch: 3, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.831 Vali Acc: 0.494 Test Loss: 1.831 Test Acc: 0.494
Validation loss decreased (-0.383315 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 3.993468999862671
Epoch: 4, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.357 Vali Acc: 0.606 Test Loss: 1.357 Test Acc: 0.606
Validation loss decreased (-0.494426 --> -0.605542).  Saving model ...
Epoch: 5 cost time: 3.8498730659484863
Epoch: 5, Steps: 12 | Train Loss: 0.964 Vali Loss: 1.227 Vali Acc: 0.639 Test Loss: 1.227 Test Acc: 0.639
Validation loss decreased (-0.605542 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 3.7271792888641357
Epoch: 6, Steps: 12 | Train Loss: 0.699 Vali Loss: 1.102 Vali Acc: 0.672 Test Loss: 1.102 Test Acc: 0.672
Validation loss decreased (-0.638877 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 3.7729110717773438
Epoch: 7, Steps: 12 | Train Loss: 0.697 Vali Loss: 1.131 Vali Acc: 0.728 Test Loss: 1.131 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727766).  Saving model ...
Epoch: 8 cost time: 4.296799659729004
Epoch: 8, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.691 Vali Acc: 0.806 Test Loss: 0.691 Test Acc: 0.806
Validation loss decreased (-0.727766 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 4.010602712631226
Epoch: 9, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.747 Vali Acc: 0.811 Test Loss: 0.747 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811104).  Saving model ...
Epoch: 10 cost time: 4.180443286895752
Epoch: 10, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.046711444854736
Epoch: 11, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.736 Vali Acc: 0.811 Test Loss: 0.736 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 12 cost time: 4.2812769412994385
Epoch: 12, Steps: 12 | Train Loss: 0.369 Vali Loss: 1.011 Vali Acc: 0.806 Test Loss: 1.011 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.109675407409668
Epoch: 13, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.715 Vali Acc: 0.817 Test Loss: 0.715 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 14 cost time: 4.087011098861694
Epoch: 14, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.815 Vali Acc: 0.844 Test Loss: 0.815 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844436).  Saving model ...
Epoch: 15 cost time: 4.382384777069092
Epoch: 15, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.084 Vali Acc: 0.811 Test Loss: 1.084 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.075018882751465
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.774 Vali Acc: 0.806 Test Loss: 0.774 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.071020126342773
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.943 Vali Acc: 0.828 Test Loss: 0.943 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.9303038120269775
Epoch: 18, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.922 Vali Acc: 0.828 Test Loss: 0.922 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.931194305419922
Epoch: 19, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.909 Vali Acc: 0.833 Test Loss: 0.909 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.935694456100464
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.168 Vali Acc: 0.867 Test Loss: 1.168 Test Acc: 0.867
Validation loss decreased (-0.844436 --> -0.866655).  Saving model ...
Epoch: 21 cost time: 4.237506628036499
Epoch: 21, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.833 Vali Acc: 0.844 Test Loss: 0.833 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.88983416557312
Epoch: 22, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.160 Vali Acc: 0.806 Test Loss: 1.160 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.8711633682250977
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.024 Vali Acc: 0.850 Test Loss: 1.024 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.792417049407959
Epoch: 24, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.033 Vali Acc: 0.833 Test Loss: 1.033 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.211636066436768
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.984 Vali Acc: 0.822 Test Loss: 0.984 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.8554821014404297
Epoch: 26, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.000 Vali Acc: 0.839 Test Loss: 1.000 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.951676845550537
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.024 Vali Acc: 0.850 Test Loss: 1.024 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.981721878051758
Epoch: 28, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.945 Vali Acc: 0.856 Test Loss: 0.945 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.8952345848083496
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.062 Vali Acc: 0.839 Test Loss: 1.062 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.303949356079102
Epoch: 30, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.879 Vali Acc: 0.856 Test Loss: 0.879 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.779103517532349
Epoch: 1, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.235 Vali Acc: 0.278 Test Loss: 2.235 Test Acc: 0.278
Validation loss decreased (inf --> -0.277755).  Saving model ...
Epoch: 2 cost time: 4.089849472045898
Epoch: 2, Steps: 12 | Train Loss: 2.494 Vali Loss: 1.841 Vali Acc: 0.400 Test Loss: 1.841 Test Acc: 0.400
Validation loss decreased (-0.277755 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 3.684711456298828
Epoch: 3, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.902 Vali Acc: 0.461 Test Loss: 1.902 Test Acc: 0.461
Validation loss decreased (-0.399982 --> -0.461092).  Saving model ...
Epoch: 4 cost time: 3.8986575603485107
Epoch: 4, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.416 Vali Acc: 0.583 Test Loss: 1.416 Test Acc: 0.583
Validation loss decreased (-0.461092 --> -0.583319).  Saving model ...
Epoch: 5 cost time: 4.035410642623901
Epoch: 5, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.298 Vali Acc: 0.644 Test Loss: 1.298 Test Acc: 0.644
Validation loss decreased (-0.583319 --> -0.644431).  Saving model ...
Epoch: 6 cost time: 4.016535997390747
Epoch: 6, Steps: 12 | Train Loss: 0.728 Vali Loss: 1.137 Vali Acc: 0.650 Test Loss: 1.137 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 3.8039164543151855
Epoch: 7, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.119 Vali Acc: 0.694 Test Loss: 1.119 Test Acc: 0.694
Validation loss decreased (-0.649989 --> -0.694433).  Saving model ...
Epoch: 8 cost time: 4.147587537765503
Epoch: 8, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.747 Vali Acc: 0.794 Test Loss: 0.747 Test Acc: 0.794
Validation loss decreased (-0.694433 --> -0.794437).  Saving model ...
Epoch: 9 cost time: 4.006772518157959
Epoch: 9, Steps: 12 | Train Loss: 0.471 Vali Loss: 1.032 Vali Acc: 0.772 Test Loss: 1.032 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.020101308822632
Epoch: 10, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.0702805519104
Epoch: 11, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.640 Vali Acc: 0.806 Test Loss: 0.640 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805549).  Saving model ...
Epoch: 12 cost time: 3.930466890335083
Epoch: 12, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.922 Vali Acc: 0.789 Test Loss: 0.922 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.063192844390869
Epoch: 13, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.763 Vali Acc: 0.817 Test Loss: 0.763 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816659).  Saving model ...
Epoch: 14 cost time: 3.793811082839966
Epoch: 14, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
Validation loss decreased (-0.816659 --> -0.844437).  Saving model ...
Epoch: 15 cost time: 3.919778347015381
Epoch: 15, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.212 Vali Acc: 0.794 Test Loss: 1.212 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.2189600467681885
Epoch: 16, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.952 Vali Acc: 0.839 Test Loss: 0.952 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7029201984405518
Epoch: 17, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.887 Vali Acc: 0.844 Test Loss: 0.887 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.9618284702301025
Epoch: 18, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.920 Vali Acc: 0.817 Test Loss: 0.920 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.757784843444824
Epoch: 19, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.865 Vali Acc: 0.828 Test Loss: 0.865 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.908168077468872
Epoch: 20, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.449 Vali Acc: 0.800 Test Loss: 1.449 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.9266602993011475
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.003 Vali Acc: 0.833 Test Loss: 1.003 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.6985511779785156
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.128 Vali Acc: 0.828 Test Loss: 1.128 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8633153438568115
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.893 Vali Acc: 0.861 Test Loss: 0.893 Test Acc: 0.861
Validation loss decreased (-0.844437 --> -0.861102).  Saving model ...
Epoch: 24 cost time: 3.556077718734741
Epoch: 24, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.038 Vali Acc: 0.817 Test Loss: 1.038 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6451869010925293
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.015 Vali Acc: 0.856 Test Loss: 1.015 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.6350302696228027
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.144 Vali Acc: 0.850 Test Loss: 1.144 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5918359756469727
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.166 Vali Acc: 0.822 Test Loss: 1.166 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.8169498443603516
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.193 Vali Acc: 0.833 Test Loss: 1.193 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.955505847930908
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.113 Vali Acc: 0.833 Test Loss: 1.113 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.939572334289551
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.421 Vali Acc: 0.844 Test Loss: 1.421 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.155989408493042
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.051 Vali Acc: 0.844 Test Loss: 1.051 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.8121304512023926
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.126 Vali Acc: 0.833 Test Loss: 1.126 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.9753241539001465
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.297 Vali Acc: 0.850 Test Loss: 1.297 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.289585113525391
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.8379709720611572
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.81709623336792
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.8716046810150146
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 3.6412672996520996
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9664437770843506
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.769442319869995
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.610938310623169
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8805432319641113
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.925600051879883
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6276397705078125
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9885828495025635
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.875412702560425
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.181105852127075
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 7844879
model size : 49.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.596519708633423
Epoch: 1, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.307 Vali Acc: 0.383 Test Loss: 2.307 Test Acc: 0.383
Validation loss decreased (inf --> -0.383310).  Saving model ...
Epoch: 2 cost time: 3.692196846008301
Epoch: 2, Steps: 12 | Train Loss: 2.128 Vali Loss: 1.692 Vali Acc: 0.650 Test Loss: 1.692 Test Acc: 0.650
Validation loss decreased (-0.383310 --> -0.649983).  Saving model ...
Epoch: 3 cost time: 3.7368881702423096
Epoch: 3, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.266 Vali Acc: 0.656 Test Loss: 1.266 Test Acc: 0.656
Validation loss decreased (-0.649983 --> -0.655543).  Saving model ...
Epoch: 4 cost time: 3.4839069843292236
Epoch: 4, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.042 Vali Acc: 0.722 Test Loss: 1.042 Test Acc: 0.722
Validation loss decreased (-0.655543 --> -0.722212).  Saving model ...
Epoch: 5 cost time: 3.655825138092041
Epoch: 5, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.863 Vali Acc: 0.744 Test Loss: 0.863 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744436).  Saving model ...
Epoch: 6 cost time: 3.7776637077331543
Epoch: 6, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.699 Vali Acc: 0.794 Test Loss: 0.699 Test Acc: 0.794
Validation loss decreased (-0.744436 --> -0.794437).  Saving model ...
Epoch: 7 cost time: 3.6414756774902344
Epoch: 7, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822216).  Saving model ...
Epoch: 8 cost time: 3.7049365043640137
Epoch: 8, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.496 Vali Acc: 0.839 Test Loss: 0.496 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838884).  Saving model ...
Epoch: 9 cost time: 3.9272549152374268
Epoch: 9, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 3.851271629333496
Epoch: 10, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866663).  Saving model ...
Epoch: 11 cost time: 3.8097379207611084
Epoch: 11, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7535974979400635
Epoch: 12, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
Validation loss decreased (-0.866663 --> -0.883329).  Saving model ...
Epoch: 13 cost time: 3.792968511581421
Epoch: 13, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 3.7931764125823975
Epoch: 14, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 3.7550604343414307
Epoch: 15, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.428 Vali Acc: 0.911 Test Loss: 0.428 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911107).  Saving model ...
Epoch: 16 cost time: 3.8079328536987305
Epoch: 16, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.427 Vali Acc: 0.883 Test Loss: 0.427 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4379026889801025
Epoch: 17, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.133542537689209
Epoch: 18, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.460 Vali Acc: 0.883 Test Loss: 0.460 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.764516592025757
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.468 Vali Acc: 0.894 Test Loss: 0.468 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.763765811920166
Epoch: 20, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.608471393585205
Epoch: 21, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.439781665802002
Epoch: 22, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.497 Vali Acc: 0.894 Test Loss: 0.497 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6290948390960693
Epoch: 23, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.481 Vali Acc: 0.894 Test Loss: 0.481 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.795611619949341
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.927584648132324
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.541 Vali Acc: 0.906 Test Loss: 0.541 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.9246180057525635
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.427 Vali Acc: 0.333 Test Loss: 2.427 Test Acc: 0.333
Validation loss decreased (inf --> -0.333309).  Saving model ...
Epoch: 2 cost time: 3.9178290367126465
Epoch: 2, Steps: 12 | Train Loss: 2.262 Vali Loss: 1.866 Vali Acc: 0.594 Test Loss: 1.866 Test Acc: 0.594
Validation loss decreased (-0.333309 --> -0.594426).  Saving model ...
Epoch: 3 cost time: 3.8388774394989014
Epoch: 3, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.440 Vali Acc: 0.589 Test Loss: 1.440 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8406338691711426
Epoch: 4, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.203 Vali Acc: 0.622 Test Loss: 1.203 Test Acc: 0.622
Validation loss decreased (-0.594426 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 3.6481547355651855
Epoch: 5, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.989 Vali Acc: 0.739 Test Loss: 0.989 Test Acc: 0.739
Validation loss decreased (-0.622210 --> -0.738879).  Saving model ...
Epoch: 6 cost time: 3.8974688053131104
Epoch: 6, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.833 Vali Acc: 0.733 Test Loss: 0.833 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.907470941543579
Epoch: 7, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.698 Vali Acc: 0.839 Test Loss: 0.698 Test Acc: 0.839
Validation loss decreased (-0.738879 --> -0.838882).  Saving model ...
Epoch: 8 cost time: 3.612532377243042
Epoch: 8, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.628 Vali Acc: 0.822 Test Loss: 0.628 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6196701526641846
Epoch: 9, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
Validation loss decreased (-0.838882 --> -0.872217).  Saving model ...
Epoch: 10 cost time: 3.634570598602295
Epoch: 10, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.528 Vali Acc: 0.883 Test Loss: 0.528 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 11 cost time: 3.785935878753662
Epoch: 11, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6675496101379395
Epoch: 12, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.550 Vali Acc: 0.894 Test Loss: 0.550 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 13 cost time: 3.820030689239502
Epoch: 13, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.514 Vali Acc: 0.883 Test Loss: 0.514 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.555058717727661
Epoch: 14, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.485386371612549
Epoch: 15, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.487039089202881
Epoch: 16, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.427885055541992
Epoch: 17, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7576420307159424
Epoch: 18, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.583 Vali Acc: 0.883 Test Loss: 0.583 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.04170298576355
Epoch: 19, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.551 Vali Acc: 0.894 Test Loss: 0.551 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.908254623413086
Epoch: 20, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.559 Vali Acc: 0.872 Test Loss: 0.559 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7666513919830322
Epoch: 21, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.570 Vali Acc: 0.894 Test Loss: 0.570 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.824064254760742
Epoch: 22, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.894 Test Loss: 0.562 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4840593338012695
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.519 Vali Acc: 0.244 Test Loss: 2.519 Test Acc: 0.244
Validation loss decreased (inf --> -0.244419).  Saving model ...
Epoch: 2 cost time: 4.046063184738159
Epoch: 2, Steps: 12 | Train Loss: 2.359 Vali Loss: 2.059 Vali Acc: 0.428 Test Loss: 2.059 Test Acc: 0.428
Validation loss decreased (-0.244419 --> -0.427757).  Saving model ...
Epoch: 3 cost time: 4.249305725097656
Epoch: 3, Steps: 12 | Train Loss: 1.885 Vali Loss: 1.671 Vali Acc: 0.500 Test Loss: 1.671 Test Acc: 0.500
Validation loss decreased (-0.427757 --> -0.499983).  Saving model ...
Epoch: 4 cost time: 4.3804919719696045
Epoch: 4, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.408 Vali Acc: 0.544 Test Loss: 1.408 Test Acc: 0.544
Validation loss decreased (-0.499983 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 3.841371536254883
Epoch: 5, Steps: 12 | Train Loss: 1.116 Vali Loss: 1.130 Vali Acc: 0.689 Test Loss: 1.130 Test Acc: 0.689
Validation loss decreased (-0.544430 --> -0.688878).  Saving model ...
Epoch: 6 cost time: 3.496682643890381
Epoch: 6, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.003 Vali Acc: 0.678 Test Loss: 1.003 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.001497030258179
Epoch: 7, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.871 Vali Acc: 0.756 Test Loss: 0.871 Test Acc: 0.756
Validation loss decreased (-0.688878 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 4.138710021972656
Epoch: 8, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.780 Vali Acc: 0.761 Test Loss: 0.780 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 3.87705397605896
Epoch: 9, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.612 Vali Acc: 0.822 Test Loss: 0.612 Test Acc: 0.822
Validation loss decreased (-0.761103 --> -0.822216).  Saving model ...
Epoch: 10 cost time: 3.7690582275390625
Epoch: 10, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.701 Vali Acc: 0.817 Test Loss: 0.701 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0430474281311035
Epoch: 11, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844440).  Saving model ...
Epoch: 12 cost time: 3.7463743686676025
Epoch: 12, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.753 Vali Acc: 0.806 Test Loss: 0.753 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9358932971954346
Epoch: 13, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855550).  Saving model ...
Epoch: 14 cost time: 3.561728000640869
Epoch: 14, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9053142070770264
Epoch: 15, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 3.9230921268463135
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.549 Vali Acc: 0.828 Test Loss: 0.549 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9281439781188965
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.05886435508728
Epoch: 18, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.599 Vali Acc: 0.839 Test Loss: 0.599 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.0539679527282715
Epoch: 19, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.213151454925537
Epoch: 20, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.630 Vali Acc: 0.839 Test Loss: 0.630 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.208446979522705
Epoch: 21, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.9838593006134033
Epoch: 22, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 23 cost time: 4.390897989273071
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.0580058097839355
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.11949896812439
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.8982770442962646
Epoch: 26, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.8490617275238037
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.150097608566284
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.594 Vali Acc: 0.883 Test Loss: 0.594 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 29 cost time: 3.9846625328063965
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.8048911094665527
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.021887540817261
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.856 Test Loss: 0.647 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.6827564239501953
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.861 Test Loss: 0.624 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.041265487670898
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.952782392501831
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.878 Test Loss: 0.614 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.8956637382507324
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.878 Test Loss: 0.601 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.097643852233887
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.878 Test Loss: 0.592 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.965702533721924
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.872 Test Loss: 0.601 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.8829638957977295
Epoch: 38, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.241175174713135
Epoch: 1, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.618 Vali Acc: 0.172 Test Loss: 2.618 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 3.8775765895843506
Epoch: 2, Steps: 12 | Train Loss: 2.488 Vali Loss: 2.288 Vali Acc: 0.294 Test Loss: 2.288 Test Acc: 0.294
Validation loss decreased (-0.172196 --> -0.294422).  Saving model ...
Epoch: 3 cost time: 4.155006170272827
Epoch: 3, Steps: 12 | Train Loss: 2.125 Vali Loss: 1.939 Vali Acc: 0.394 Test Loss: 1.939 Test Acc: 0.394
Validation loss decreased (-0.294422 --> -0.394425).  Saving model ...
Epoch: 4 cost time: 4.014636278152466
Epoch: 4, Steps: 12 | Train Loss: 1.779 Vali Loss: 1.597 Vali Acc: 0.556 Test Loss: 1.597 Test Acc: 0.556
Validation loss decreased (-0.394425 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 3.6867833137512207
Epoch: 5, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.252 Vali Acc: 0.633 Test Loss: 1.252 Test Acc: 0.633
Validation loss decreased (-0.555540 --> -0.633321).  Saving model ...
Epoch: 6 cost time: 3.8536624908447266
Epoch: 6, Steps: 12 | Train Loss: 1.107 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
Validation loss decreased (-0.633321 --> -0.722212).  Saving model ...
Epoch: 7 cost time: 3.594533920288086
Epoch: 7, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.899 Vali Acc: 0.733 Test Loss: 0.899 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 3.5810632705688477
Epoch: 8, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 3.849247694015503
Epoch: 9, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.706 Vali Acc: 0.772 Test Loss: 0.706 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 10 cost time: 3.6389553546905518
Epoch: 10, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.716 Vali Acc: 0.772 Test Loss: 0.716 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7882959842681885
Epoch: 11, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.580 Vali Acc: 0.817 Test Loss: 0.580 Test Acc: 0.817
Validation loss decreased (-0.772215 --> -0.816661).  Saving model ...
Epoch: 12 cost time: 3.9366989135742188
Epoch: 12, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.816 Vali Acc: 0.817 Test Loss: 0.816 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.809048652648926
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.618 Vali Acc: 0.806 Test Loss: 0.618 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.946324586868286
Epoch: 14, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 3.7170515060424805
Epoch: 15, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 4.193272352218628
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.769 Vali Acc: 0.794 Test Loss: 0.769 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.068162202835083
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.126532793045044
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9925386905670166
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.653 Vali Acc: 0.872 Test Loss: 0.653 Test Acc: 0.872
Validation loss decreased (-0.849993 --> -0.872216).  Saving model ...
Epoch: 20 cost time: 3.7419450283050537
Epoch: 20, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.653 Vali Acc: 0.839 Test Loss: 0.653 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.241815567016602
Epoch: 21, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.610 Vali Acc: 0.861 Test Loss: 0.610 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.922149896621704
Epoch: 22, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.731 Vali Acc: 0.872 Test Loss: 0.731 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.2796101570129395
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.9919471740722656
Epoch: 24, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.692 Vali Acc: 0.889 Test Loss: 0.692 Test Acc: 0.889
Validation loss decreased (-0.872216 --> -0.888882).  Saving model ...
Epoch: 25 cost time: 4.079985857009888
Epoch: 25, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.987602710723877
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.723 Vali Acc: 0.861 Test Loss: 0.723 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7191944122314453
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.795 Vali Acc: 0.844 Test Loss: 0.795 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6715893745422363
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.625 Vali Acc: 0.883 Test Loss: 0.625 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.795781373977661
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.867 Vali Acc: 0.850 Test Loss: 0.867 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.833782911300659
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.920 Vali Acc: 0.850 Test Loss: 0.920 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.71390438079834
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.767 Vali Acc: 0.872 Test Loss: 0.767 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.6939971446990967
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.754 Vali Acc: 0.872 Test Loss: 0.754 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.441657543182373
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.743 Vali Acc: 0.872 Test Loss: 0.743 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.866197109222412
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.878 Test Loss: 0.763 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.432961940765381
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.547 Vali Acc: 0.233 Test Loss: 2.547 Test Acc: 0.233
Validation loss decreased (inf --> -0.233308).  Saving model ...
Epoch: 2 cost time: 3.790088415145874
Epoch: 2, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.167 Vali Acc: 0.328 Test Loss: 2.167 Test Acc: 0.328
Validation loss decreased (-0.233308 --> -0.327756).  Saving model ...
Epoch: 3 cost time: 3.529837131500244
Epoch: 3, Steps: 12 | Train Loss: 2.226 Vali Loss: 1.883 Vali Acc: 0.378 Test Loss: 1.883 Test Acc: 0.378
Validation loss decreased (-0.327756 --> -0.377759).  Saving model ...
Epoch: 4 cost time: 3.7327234745025635
Epoch: 4, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.632 Vali Acc: 0.517 Test Loss: 1.632 Test Acc: 0.517
Validation loss decreased (-0.377759 --> -0.516650).  Saving model ...
Epoch: 5 cost time: 3.758941650390625
Epoch: 5, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.375 Vali Acc: 0.594 Test Loss: 1.375 Test Acc: 0.594
Validation loss decreased (-0.516650 --> -0.594431).  Saving model ...
Epoch: 6 cost time: 3.791945457458496
Epoch: 6, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.195 Vali Acc: 0.656 Test Loss: 1.195 Test Acc: 0.656
Validation loss decreased (-0.594431 --> -0.655544).  Saving model ...
Epoch: 7 cost time: 3.6453163623809814
Epoch: 7, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6547725200653076
Epoch: 8, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.001 Vali Acc: 0.689 Test Loss: 1.001 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 3.6150121688842773
Epoch: 9, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 3.4898743629455566
Epoch: 10, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.759 Vali Acc: 0.772 Test Loss: 0.759 Test Acc: 0.772
Validation loss decreased (-0.711102 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 3.637660503387451
Epoch: 11, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.779818534851074
Epoch: 12, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.802 Vali Acc: 0.789 Test Loss: 0.802 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 3.4238457679748535
Epoch: 13, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 3.3761420249938965
Epoch: 14, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.661 Vali Acc: 0.806 Test Loss: 0.661 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 15 cost time: 3.75117826461792
Epoch: 15, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.758 Vali Acc: 0.839 Test Loss: 0.758 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838881).  Saving model ...
Epoch: 16 cost time: 3.519878387451172
Epoch: 16, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.736 Vali Acc: 0.811 Test Loss: 0.736 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6120800971984863
Epoch: 17, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.662 Vali Acc: 0.817 Test Loss: 0.662 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7932515144348145
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.767 Vali Acc: 0.811 Test Loss: 0.767 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6893296241760254
Epoch: 19, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7998926639556885
Epoch: 20, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.660 Vali Acc: 0.872 Test Loss: 0.660 Test Acc: 0.872
Validation loss decreased (-0.838881 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 3.3639333248138428
Epoch: 21, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.913 Vali Acc: 0.811 Test Loss: 0.913 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4958817958831787
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.778 Vali Acc: 0.839 Test Loss: 0.778 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.677464008331299
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3969643115997314
Epoch: 24, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.689 Vali Acc: 0.844 Test Loss: 0.689 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.307971477508545
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.785 Vali Acc: 0.839 Test Loss: 0.785 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7547078132629395
Epoch: 26, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.688 Vali Acc: 0.839 Test Loss: 0.688 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.623934268951416
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.718 Vali Acc: 0.872 Test Loss: 0.718 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8559842109680176
Epoch: 28, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 3.5206832885742188
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.697 Vali Acc: 0.872 Test Loss: 0.697 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4798643589019775
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.732 Vali Acc: 0.872 Test Loss: 0.732 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.8520584106445312
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.762 Vali Acc: 0.856 Test Loss: 0.762 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.7074174880981445
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.837 Vali Acc: 0.872 Test Loss: 0.837 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.398047685623169
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.879 Vali Acc: 0.811 Test Loss: 0.879 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.343780040740967
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.789 Vali Acc: 0.850 Test Loss: 0.789 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.4676332473754883
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.418271541595459
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.716 Vali Acc: 0.861 Test Loss: 0.716 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.652209758758545
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.861 Test Loss: 0.782 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.6974775791168213
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.762 Vali Acc: 0.867 Test Loss: 0.762 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.04603123664856
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.290 Vali Acc: 0.333 Test Loss: 2.290 Test Acc: 0.333
Validation loss decreased (inf --> -0.333310).  Saving model ...
Epoch: 2 cost time: 3.934312343597412
Epoch: 2, Steps: 12 | Train Loss: 2.569 Vali Loss: 1.985 Vali Acc: 0.372 Test Loss: 1.985 Test Acc: 0.372
Validation loss decreased (-0.333310 --> -0.372202).  Saving model ...
Epoch: 3 cost time: 4.25292444229126
Epoch: 3, Steps: 12 | Train Loss: 2.318 Vali Loss: 1.824 Vali Acc: 0.428 Test Loss: 1.824 Test Acc: 0.428
Validation loss decreased (-0.372202 --> -0.427760).  Saving model ...
Epoch: 4 cost time: 4.020859479904175
Epoch: 4, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.648 Vali Acc: 0.467 Test Loss: 1.648 Test Acc: 0.467
Validation loss decreased (-0.427760 --> -0.466650).  Saving model ...
Epoch: 5 cost time: 3.985271692276001
Epoch: 5, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.419 Vali Acc: 0.561 Test Loss: 1.419 Test Acc: 0.561
Validation loss decreased (-0.466650 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 4.128900527954102
Epoch: 6, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.226 Vali Acc: 0.617 Test Loss: 1.226 Test Acc: 0.617
Validation loss decreased (-0.561097 --> -0.616654).  Saving model ...
Epoch: 7 cost time: 3.978374719619751
Epoch: 7, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.124 Vali Acc: 0.656 Test Loss: 1.124 Test Acc: 0.656
Validation loss decreased (-0.616654 --> -0.655544).  Saving model ...
Epoch: 8 cost time: 4.26974630355835
Epoch: 8, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.953 Vali Acc: 0.678 Test Loss: 0.953 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 3.735241651535034
Epoch: 9, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.791 Vali Acc: 0.717 Test Loss: 0.791 Test Acc: 0.717
Validation loss decreased (-0.677768 --> -0.716659).  Saving model ...
Epoch: 10 cost time: 3.7503433227539062
Epoch: 10, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.708 Vali Acc: 0.772 Test Loss: 0.708 Test Acc: 0.772
Validation loss decreased (-0.716659 --> -0.772215).  Saving model ...
Epoch: 11 cost time: 3.8430824279785156
Epoch: 11, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.2309730052948
Epoch: 12, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.787 Vali Acc: 0.789 Test Loss: 0.787 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 3.692662477493286
Epoch: 13, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
Validation loss decreased (-0.788881 --> -0.788882).  Saving model ...
Epoch: 14 cost time: 3.8535120487213135
Epoch: 14, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.701 Vali Acc: 0.794 Test Loss: 0.701 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 15 cost time: 3.5268101692199707
Epoch: 15, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.801 Vali Acc: 0.806 Test Loss: 0.801 Test Acc: 0.806
Validation loss decreased (-0.794437 --> -0.805548).  Saving model ...
Epoch: 16 cost time: 3.7794582843780518
Epoch: 16, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.658 Vali Acc: 0.800 Test Loss: 0.658 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.959635019302368
Epoch: 17, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
Validation loss decreased (-0.805548 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 3.9056782722473145
Epoch: 18, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.765 Vali Acc: 0.844 Test Loss: 0.765 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844437).  Saving model ...
Epoch: 19 cost time: 3.884348154067993
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.628 Vali Acc: 0.828 Test Loss: 0.628 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8625919818878174
Epoch: 20, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.672 Vali Acc: 0.856 Test Loss: 0.672 Test Acc: 0.856
Validation loss decreased (-0.844437 --> -0.855549).  Saving model ...
Epoch: 21 cost time: 4.04195499420166
Epoch: 21, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.022 Vali Acc: 0.794 Test Loss: 1.022 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.000593185424805
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.805 Vali Acc: 0.828 Test Loss: 0.805 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.747399091720581
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.014409780502319
Epoch: 24, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.642 Vali Acc: 0.833 Test Loss: 0.642 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8084402084350586
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.8628668785095215
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5813848972320557
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.679 Vali Acc: 0.833 Test Loss: 0.679 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8437228202819824
Epoch: 28, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.703 Vali Acc: 0.856 Test Loss: 0.703 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.6462669372558594
Epoch: 29, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.704 Vali Acc: 0.856 Test Loss: 0.704 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.735119581222534
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.682 Vali Acc: 0.872 Test Loss: 0.682 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872215).  Saving model ...
Epoch: 31 cost time: 3.635374069213867
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.7253944873809814
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.651923656463623
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.8401899337768555
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.742 Vali Acc: 0.867 Test Loss: 0.742 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.781557321548462
Epoch: 35, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.893 Vali Acc: 0.844 Test Loss: 0.893 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.7929177284240723
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.811 Vali Acc: 0.839 Test Loss: 0.811 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.681580066680908
Epoch: 37, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.785 Vali Acc: 0.867 Test Loss: 0.785 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.007512331008911
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.791 Vali Acc: 0.833 Test Loss: 0.791 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.8266308307647705
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.887526512145996
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.679 Vali Acc: 0.861 Test Loss: 0.679 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.992448568344116
Epoch: 1, Steps: 12 | Train Loss: 2.749 Vali Loss: 2.422 Vali Acc: 0.233 Test Loss: 2.422 Test Acc: 0.233
Validation loss decreased (inf --> -0.233309).  Saving model ...
Epoch: 2 cost time: 3.8016340732574463
Epoch: 2, Steps: 12 | Train Loss: 2.650 Vali Loss: 1.967 Vali Acc: 0.411 Test Loss: 1.967 Test Acc: 0.411
Validation loss decreased (-0.233309 --> -0.411091).  Saving model ...
Epoch: 3 cost time: 3.808391571044922
Epoch: 3, Steps: 12 | Train Loss: 2.370 Vali Loss: 1.773 Vali Acc: 0.461 Test Loss: 1.773 Test Acc: 0.461
Validation loss decreased (-0.411091 --> -0.461093).  Saving model ...
Epoch: 4 cost time: 3.8077545166015625
Epoch: 4, Steps: 12 | Train Loss: 2.008 Vali Loss: 1.620 Vali Acc: 0.500 Test Loss: 1.620 Test Acc: 0.500
Validation loss decreased (-0.461093 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 3.6316826343536377
Epoch: 5, Steps: 12 | Train Loss: 1.608 Vali Loss: 1.423 Vali Acc: 0.550 Test Loss: 1.423 Test Acc: 0.550
Validation loss decreased (-0.499984 --> -0.549986).  Saving model ...
Epoch: 6 cost time: 3.653043746948242
Epoch: 6, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.247 Vali Acc: 0.617 Test Loss: 1.247 Test Acc: 0.617
Validation loss decreased (-0.549986 --> -0.616654).  Saving model ...
Epoch: 7 cost time: 3.7435717582702637
Epoch: 7, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.128 Vali Acc: 0.656 Test Loss: 1.128 Test Acc: 0.656
Validation loss decreased (-0.616654 --> -0.655544).  Saving model ...
Epoch: 8 cost time: 3.836524248123169
Epoch: 8, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.938 Vali Acc: 0.694 Test Loss: 0.938 Test Acc: 0.694
Validation loss decreased (-0.655544 --> -0.694435).  Saving model ...
Epoch: 9 cost time: 3.8068885803222656
Epoch: 9, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.789 Vali Acc: 0.706 Test Loss: 0.789 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705548).  Saving model ...
Epoch: 10 cost time: 3.789902448654175
Epoch: 10, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
Validation loss decreased (-0.705548 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 4.174209833145142
Epoch: 11, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.725 Vali Acc: 0.761 Test Loss: 0.725 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.423980951309204
Epoch: 12, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7207882404327393
Epoch: 13, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7548952102661133
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.686 Vali Acc: 0.806 Test Loss: 0.686 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 15 cost time: 3.8977582454681396
Epoch: 15, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.813 Vali Acc: 0.817 Test Loss: 0.813 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816659).  Saving model ...
Epoch: 16 cost time: 3.8263213634490967
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.728 Vali Acc: 0.800 Test Loss: 0.728 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.040796518325806
Epoch: 17, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 3.981541633605957
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.777 Vali Acc: 0.822 Test Loss: 0.777 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.936141014099121
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.822216 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 3.749619483947754
Epoch: 20, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.726 Vali Acc: 0.861 Test Loss: 0.726 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861104).  Saving model ...
Epoch: 21 cost time: 3.767446756362915
Epoch: 21, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.856 Vali Acc: 0.817 Test Loss: 0.856 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7737622261047363
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.886683225631714
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.775 Vali Acc: 0.839 Test Loss: 0.775 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.652947425842285
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.704 Vali Acc: 0.844 Test Loss: 0.704 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.8137011528015137
Epoch: 25, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.736 Vali Acc: 0.844 Test Loss: 0.736 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6552960872650146
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.810 Vali Acc: 0.850 Test Loss: 0.810 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5062263011932373
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.9399635791778564
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.846 Vali Acc: 0.822 Test Loss: 0.846 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.939945697784424
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.920 Vali Acc: 0.789 Test Loss: 0.920 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.515761613845825
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.722 Vali Acc: 0.844 Test Loss: 0.722 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.84466814994812
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 4.1379382610321045
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.898336887359619
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.7794604301452637
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7286362648010254
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8681724071502686
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.803978204727173
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.000310659408569
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.026306390762329
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5267493724823
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.7428715229034424
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 5102095
model size : 29.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.753345727920532
Epoch: 1, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.392 Vali Acc: 0.322 Test Loss: 2.392 Test Acc: 0.322
Validation loss decreased (inf --> -0.322198).  Saving model ...
Epoch: 2 cost time: 3.4266226291656494
Epoch: 2, Steps: 12 | Train Loss: 2.141 Vali Loss: 1.755 Vali Acc: 0.583 Test Loss: 1.755 Test Acc: 0.583
Validation loss decreased (-0.322198 --> -0.583316).  Saving model ...
Epoch: 3 cost time: 3.390955924987793
Epoch: 3, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.354 Vali Acc: 0.617 Test Loss: 1.354 Test Acc: 0.617
Validation loss decreased (-0.583316 --> -0.616653).  Saving model ...
Epoch: 4 cost time: 3.449674367904663
Epoch: 4, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.090 Vali Acc: 0.689 Test Loss: 1.090 Test Acc: 0.689
Validation loss decreased (-0.616653 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 3.4316563606262207
Epoch: 5, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.948 Vali Acc: 0.744 Test Loss: 0.948 Test Acc: 0.744
Validation loss decreased (-0.688878 --> -0.744435).  Saving model ...
Epoch: 6 cost time: 3.336066246032715
Epoch: 6, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
Validation loss decreased (-0.744435 --> -0.783326).  Saving model ...
Epoch: 7 cost time: 3.9447691440582275
Epoch: 7, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.605 Vali Acc: 0.828 Test Loss: 0.605 Test Acc: 0.828
Validation loss decreased (-0.783326 --> -0.827772).  Saving model ...
Epoch: 8 cost time: 3.6415181159973145
Epoch: 8, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.627518892288208
Epoch: 9, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.484 Vali Acc: 0.856 Test Loss: 0.484 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855551).  Saving model ...
Epoch: 10 cost time: 3.5482113361358643
Epoch: 10, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.396 Vali Acc: 0.894 Test Loss: 0.396 Test Acc: 0.894
Validation loss decreased (-0.855551 --> -0.894440).  Saving model ...
Epoch: 11 cost time: 3.7088801860809326
Epoch: 11, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.428 Vali Acc: 0.878 Test Loss: 0.428 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.12893271446228
Epoch: 12, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.794006109237671
Epoch: 13, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 3.7713918685913086
Epoch: 14, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.450 Vali Acc: 0.872 Test Loss: 0.450 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5936648845672607
Epoch: 15, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.432 Vali Acc: 0.894 Test Loss: 0.432 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.938032388687134
Epoch: 16, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.423 Vali Acc: 0.883 Test Loss: 0.423 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.684548854827881
Epoch: 17, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6031558513641357
Epoch: 18, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.391071319580078
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.453 Vali Acc: 0.894 Test Loss: 0.453 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8022890090942383
Epoch: 20, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.668306350708008
Epoch: 21, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5962843894958496
Epoch: 22, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.459 Vali Acc: 0.894 Test Loss: 0.459 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.6967453956604004
Epoch: 23, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.485413074493408
Epoch: 1, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.410 Vali Acc: 0.283 Test Loss: 2.410 Test Acc: 0.283
Validation loss decreased (inf --> -0.283309).  Saving model ...
Epoch: 2 cost time: 4.080746650695801
Epoch: 2, Steps: 12 | Train Loss: 2.257 Vali Loss: 1.879 Vali Acc: 0.506 Test Loss: 1.879 Test Acc: 0.506
Validation loss decreased (-0.283309 --> -0.505537).  Saving model ...
Epoch: 3 cost time: 3.8725624084472656
Epoch: 3, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.479 Vali Acc: 0.561 Test Loss: 1.479 Test Acc: 0.561
Validation loss decreased (-0.505537 --> -0.561096).  Saving model ...
Epoch: 4 cost time: 3.7586889266967773
Epoch: 4, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.202 Vali Acc: 0.683 Test Loss: 1.202 Test Acc: 0.683
Validation loss decreased (-0.561096 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 3.6576004028320312
Epoch: 5, Steps: 12 | Train Loss: 0.950 Vali Loss: 1.071 Vali Acc: 0.706 Test Loss: 1.071 Test Acc: 0.706
Validation loss decreased (-0.683321 --> -0.705545).  Saving model ...
Epoch: 6 cost time: 3.9562458992004395
Epoch: 6, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.857 Vali Acc: 0.778 Test Loss: 0.857 Test Acc: 0.778
Validation loss decreased (-0.705545 --> -0.777769).  Saving model ...
Epoch: 7 cost time: 3.847747564315796
Epoch: 7, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
Validation loss decreased (-0.777769 --> -0.777770).  Saving model ...
Epoch: 8 cost time: 3.7468152046203613
Epoch: 8, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.658 Vali Acc: 0.817 Test Loss: 0.658 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816660).  Saving model ...
Epoch: 9 cost time: 3.759981870651245
Epoch: 9, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.816660 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 3.4925317764282227
Epoch: 10, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.504 Vali Acc: 0.894 Test Loss: 0.504 Test Acc: 0.894
Validation loss decreased (-0.849994 --> -0.894439).  Saving model ...
Epoch: 11 cost time: 3.818601369857788
Epoch: 11, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.509 Vali Acc: 0.883 Test Loss: 0.509 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6270673274993896
Epoch: 12, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894439).  Saving model ...
Epoch: 13 cost time: 3.694668769836426
Epoch: 13, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.483 Vali Acc: 0.894 Test Loss: 0.483 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 14 cost time: 3.6330840587615967
Epoch: 14, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.519 Vali Acc: 0.878 Test Loss: 0.519 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.751086711883545
Epoch: 15, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 3.597851037979126
Epoch: 16, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.545 Vali Acc: 0.894 Test Loss: 0.545 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7591347694396973
Epoch: 17, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.510 Vali Acc: 0.883 Test Loss: 0.510 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6579012870788574
Epoch: 18, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.555 Vali Acc: 0.894 Test Loss: 0.555 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.546766519546509
Epoch: 19, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.514 Vali Acc: 0.889 Test Loss: 0.514 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7234184741973877
Epoch: 20, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6136250495910645
Epoch: 21, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.720168113708496
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.687800645828247
Epoch: 23, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.8185949325561523
Epoch: 24, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.570 Vali Acc: 0.894 Test Loss: 0.570 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.301408529281616
Epoch: 25, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.586 Vali Acc: 0.889 Test Loss: 0.586 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.098634719848633
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.467 Vali Acc: 0.267 Test Loss: 2.467 Test Acc: 0.267
Validation loss decreased (inf --> -0.266642).  Saving model ...
Epoch: 2 cost time: 3.9691715240478516
Epoch: 2, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.053 Vali Acc: 0.411 Test Loss: 2.053 Test Acc: 0.411
Validation loss decreased (-0.266642 --> -0.411091).  Saving model ...
Epoch: 3 cost time: 3.5076286792755127
Epoch: 3, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.692 Vali Acc: 0.544 Test Loss: 1.692 Test Acc: 0.544
Validation loss decreased (-0.411091 --> -0.544428).  Saving model ...
Epoch: 4 cost time: 3.858565092086792
Epoch: 4, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.395 Vali Acc: 0.556 Test Loss: 1.395 Test Acc: 0.556
Validation loss decreased (-0.544428 --> -0.555542).  Saving model ...
Epoch: 5 cost time: 3.6975789070129395
Epoch: 5, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.232 Vali Acc: 0.644 Test Loss: 1.232 Test Acc: 0.644
Validation loss decreased (-0.555542 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 3.6705968379974365
Epoch: 6, Steps: 12 | Train Loss: 0.912 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
Validation loss decreased (-0.644432 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 3.7081339359283447
Epoch: 7, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.880 Vali Acc: 0.733 Test Loss: 0.880 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733325).  Saving model ...
Epoch: 8 cost time: 3.35801100730896
Epoch: 8, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9322216510772705
Epoch: 9, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
Validation loss decreased (-0.733325 --> -0.783326).  Saving model ...
Epoch: 10 cost time: 3.458359479904175
Epoch: 10, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 3.6902120113372803
Epoch: 11, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 12 cost time: 3.7150824069976807
Epoch: 12, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 3.4261579513549805
Epoch: 13, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
Validation loss decreased (-0.833327 --> -0.855550).  Saving model ...
Epoch: 14 cost time: 3.576403856277466
Epoch: 14, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.115449905395508
Epoch: 15, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 3.989712953567505
Epoch: 16, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.707202672958374
Epoch: 17, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.129885196685791
Epoch: 18, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.688 Vali Acc: 0.861 Test Loss: 0.688 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.102853536605835
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.093838691711426
Epoch: 20, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 21 cost time: 3.648913621902466
Epoch: 21, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.164673089981079
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.788102626800537
Epoch: 23, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.242363929748535
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.872 Test Loss: 0.618 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.477857828140259
Epoch: 25, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.872 Test Loss: 0.609 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.949855089187622
Epoch: 26, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 27 cost time: 3.4766182899475098
Epoch: 27, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.860531806945801
Epoch: 28, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7069623470306396
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.872 Test Loss: 0.631 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.7679150104522705
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6486754417419434
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.709979295730591
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.670475959777832
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.9553210735321045
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.643 Vali Acc: 0.878 Test Loss: 0.643 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.7717697620391846
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.878 Test Loss: 0.640 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.6727211475372314
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.878 Test Loss: 0.632 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.186315536499023
Epoch: 1, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.543 Vali Acc: 0.206 Test Loss: 2.543 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 3.7437045574188232
Epoch: 2, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.256 Vali Acc: 0.272 Test Loss: 2.256 Test Acc: 0.272
Validation loss decreased (-0.205530 --> -0.272200).  Saving model ...
Epoch: 3 cost time: 3.626115083694458
Epoch: 3, Steps: 12 | Train Loss: 2.183 Vali Loss: 1.936 Vali Acc: 0.361 Test Loss: 1.936 Test Acc: 0.361
Validation loss decreased (-0.272200 --> -0.361092).  Saving model ...
Epoch: 4 cost time: 3.5972447395324707
Epoch: 4, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.574 Vali Acc: 0.539 Test Loss: 1.574 Test Acc: 0.539
Validation loss decreased (-0.361092 --> -0.538873).  Saving model ...
Epoch: 5 cost time: 3.736086368560791
Epoch: 5, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.295 Vali Acc: 0.639 Test Loss: 1.295 Test Acc: 0.639
Validation loss decreased (-0.538873 --> -0.638876).  Saving model ...
Epoch: 6 cost time: 3.500396251678467
Epoch: 6, Steps: 12 | Train Loss: 1.092 Vali Loss: 1.063 Vali Acc: 0.661 Test Loss: 1.063 Test Acc: 0.661
Validation loss decreased (-0.638876 --> -0.661100).  Saving model ...
Epoch: 7 cost time: 3.46272611618042
Epoch: 7, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.904 Vali Acc: 0.706 Test Loss: 0.904 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705547).  Saving model ...
Epoch: 8 cost time: 3.7292861938476562
Epoch: 8, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.896 Vali Acc: 0.722 Test Loss: 0.896 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 3.7835934162139893
Epoch: 9, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.741 Vali Acc: 0.722 Test Loss: 0.741 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722215).  Saving model ...
Epoch: 10 cost time: 3.6222589015960693
Epoch: 10, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.815 Vali Acc: 0.778 Test Loss: 0.815 Test Acc: 0.778
Validation loss decreased (-0.722215 --> -0.777770).  Saving model ...
Epoch: 11 cost time: 3.696413993835449
Epoch: 11, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.665 Vali Acc: 0.756 Test Loss: 0.665 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5375001430511475
Epoch: 12, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.642 Vali Acc: 0.828 Test Loss: 0.642 Test Acc: 0.828
Validation loss decreased (-0.777770 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 3.484675168991089
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.020217657089233
Epoch: 14, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.847 Vali Acc: 0.817 Test Loss: 0.847 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.811349391937256
Epoch: 15, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.764 Vali Acc: 0.789 Test Loss: 0.764 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.861384391784668
Epoch: 16, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.844 Vali Acc: 0.767 Test Loss: 0.844 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.477415084838867
Epoch: 17, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.735 Vali Acc: 0.822 Test Loss: 0.735 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.030986785888672
Epoch: 18, Steps: 12 | Train Loss: 0.207 Vali Loss: 1.243 Vali Acc: 0.789 Test Loss: 1.243 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.581894397735596
Epoch: 19, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.804 Vali Acc: 0.828 Test Loss: 0.804 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.378902912139893
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.859 Vali Acc: 0.778 Test Loss: 0.859 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.45656418800354
Epoch: 21, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.880 Vali Acc: 0.833 Test Loss: 0.880 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 4.218393325805664
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.833325 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 3.7186403274536133
Epoch: 23, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.835573196411133
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.784 Vali Acc: 0.867 Test Loss: 0.784 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866659).  Saving model ...
Epoch: 25 cost time: 3.966823101043701
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.779 Vali Acc: 0.850 Test Loss: 0.779 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.747028350830078
Epoch: 26, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.862 Vali Acc: 0.844 Test Loss: 0.862 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.592515230178833
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.725 Vali Acc: 0.861 Test Loss: 0.725 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.883601665496826
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.783186197280884
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.803 Vali Acc: 0.878 Test Loss: 0.803 Test Acc: 0.878
Validation loss decreased (-0.866659 --> -0.877770).  Saving model ...
Epoch: 30 cost time: 4.081359386444092
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.791 Vali Acc: 0.861 Test Loss: 0.791 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.466230630874634
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.910 Vali Acc: 0.850 Test Loss: 0.910 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.107177019119263
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.806 Vali Acc: 0.844 Test Loss: 0.806 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.6880383491516113
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.900 Vali Acc: 0.867 Test Loss: 0.900 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.9402968883514404
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.963407278060913
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.890 Vali Acc: 0.872 Test Loss: 0.890 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.033358097076416
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.827 Vali Acc: 0.833 Test Loss: 0.827 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.9277071952819824
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.193 Vali Acc: 0.839 Test Loss: 1.193 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.7133724689483643
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.793 Vali Acc: 0.867 Test Loss: 0.793 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.340697288513184
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.108 Vali Acc: 0.867 Test Loss: 1.108 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.571745872497559
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.475 Vali Acc: 0.256 Test Loss: 2.475 Test Acc: 0.256
Validation loss decreased (inf --> -0.255531).  Saving model ...
Epoch: 2 cost time: 3.597543239593506
Epoch: 2, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.024 Vali Acc: 0.356 Test Loss: 2.024 Test Acc: 0.356
Validation loss decreased (-0.255531 --> -0.355535).  Saving model ...
Epoch: 3 cost time: 3.9616315364837646
Epoch: 3, Steps: 12 | Train Loss: 2.300 Vali Loss: 1.765 Vali Acc: 0.433 Test Loss: 1.765 Test Acc: 0.433
Validation loss decreased (-0.355535 --> -0.433316).  Saving model ...
Epoch: 4 cost time: 3.7645304203033447
Epoch: 4, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.576 Vali Acc: 0.500 Test Loss: 1.576 Test Acc: 0.500
Validation loss decreased (-0.433316 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 3.607332229614258
Epoch: 5, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.381 Vali Acc: 0.572 Test Loss: 1.381 Test Acc: 0.572
Validation loss decreased (-0.499984 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 3.7856650352478027
Epoch: 6, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
Validation loss decreased (-0.572208 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 4.057275772094727
Epoch: 7, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.048 Vali Acc: 0.667 Test Loss: 1.048 Test Acc: 0.667
Validation loss decreased (-0.599987 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 3.9626986980438232
Epoch: 8, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.076 Vali Acc: 0.633 Test Loss: 1.076 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8178703784942627
Epoch: 9, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.879 Vali Acc: 0.672 Test Loss: 0.879 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 3.710615396499634
Epoch: 10, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.845 Vali Acc: 0.756 Test Loss: 0.845 Test Acc: 0.756
Validation loss decreased (-0.672213 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 3.666391611099243
Epoch: 11, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.735 Vali Acc: 0.783 Test Loss: 0.735 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 3.8455708026885986
Epoch: 12, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.656 Vali Acc: 0.844 Test Loss: 0.656 Test Acc: 0.844
Validation loss decreased (-0.783326 --> -0.844438).  Saving model ...
Epoch: 13 cost time: 3.8789713382720947
Epoch: 13, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.961352586746216
Epoch: 14, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9081192016601562
Epoch: 15, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.727 Vali Acc: 0.783 Test Loss: 0.727 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9468514919281006
Epoch: 16, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.775 Vali Acc: 0.800 Test Loss: 0.775 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8749427795410156
Epoch: 17, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.869 Vali Acc: 0.817 Test Loss: 0.869 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.692925214767456
Epoch: 18, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.001 Vali Acc: 0.800 Test Loss: 1.001 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.6700665950775146
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.745 Vali Acc: 0.811 Test Loss: 0.745 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9961371421813965
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.6198041439056396
Epoch: 21, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.782 Vali Acc: 0.844 Test Loss: 0.782 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.768197536468506
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.6770548820495605
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.294 Vali Acc: 0.311 Test Loss: 2.294 Test Acc: 0.311
Validation loss decreased (inf --> -0.311088).  Saving model ...
Epoch: 2 cost time: 3.7127223014831543
Epoch: 2, Steps: 12 | Train Loss: 2.652 Vali Loss: 1.972 Vali Acc: 0.317 Test Loss: 1.972 Test Acc: 0.317
Validation loss decreased (-0.311088 --> -0.316647).  Saving model ...
Epoch: 3 cost time: 3.758297920227051
Epoch: 3, Steps: 12 | Train Loss: 2.413 Vali Loss: 1.822 Vali Acc: 0.417 Test Loss: 1.822 Test Acc: 0.417
Validation loss decreased (-0.316647 --> -0.416648).  Saving model ...
Epoch: 4 cost time: 4.051305770874023
Epoch: 4, Steps: 12 | Train Loss: 2.003 Vali Loss: 1.659 Vali Acc: 0.511 Test Loss: 1.659 Test Acc: 0.511
Validation loss decreased (-0.416648 --> -0.511095).  Saving model ...
Epoch: 5 cost time: 3.94364070892334
Epoch: 5, Steps: 12 | Train Loss: 1.545 Vali Loss: 1.462 Vali Acc: 0.539 Test Loss: 1.462 Test Acc: 0.539
Validation loss decreased (-0.511095 --> -0.538874).  Saving model ...
Epoch: 6 cost time: 3.762957811355591
Epoch: 6, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.275 Vali Acc: 0.567 Test Loss: 1.275 Test Acc: 0.567
Validation loss decreased (-0.538874 --> -0.566654).  Saving model ...
Epoch: 7 cost time: 3.759084463119507
Epoch: 7, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.073 Vali Acc: 0.683 Test Loss: 1.073 Test Acc: 0.683
Validation loss decreased (-0.566654 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 3.8265902996063232
Epoch: 8, Steps: 12 | Train Loss: 0.763 Vali Loss: 1.007 Vali Acc: 0.667 Test Loss: 1.007 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.159966945648193
Epoch: 9, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.835 Vali Acc: 0.689 Test Loss: 0.835 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688881).  Saving model ...
Epoch: 10 cost time: 3.515425682067871
Epoch: 10, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 3.557452917098999
Epoch: 11, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.730 Vali Acc: 0.789 Test Loss: 0.730 Test Acc: 0.789
Validation loss decreased (-0.722214 --> -0.788882).  Saving model ...
Epoch: 12 cost time: 3.5138638019561768
Epoch: 12, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
Validation loss decreased (-0.788882 --> -0.838882).  Saving model ...
Epoch: 13 cost time: 3.771718740463257
Epoch: 13, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.667 Vali Acc: 0.811 Test Loss: 0.667 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.038104057312012
Epoch: 14, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.768 Vali Acc: 0.822 Test Loss: 0.768 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.626638889312744
Epoch: 15, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.756 Vali Acc: 0.767 Test Loss: 0.756 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6715259552001953
Epoch: 16, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.803 Vali Acc: 0.822 Test Loss: 0.803 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8896734714508057
Epoch: 17, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.773 Vali Acc: 0.811 Test Loss: 0.773 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8409721851348877
Epoch: 18, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.931 Vali Acc: 0.778 Test Loss: 0.931 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.741515636444092
Epoch: 19, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8357882499694824
Epoch: 20, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.629 Vali Acc: 0.839 Test Loss: 0.629 Test Acc: 0.839
Validation loss decreased (-0.838882 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 3.7714414596557617
Epoch: 21, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.703 Vali Acc: 0.856 Test Loss: 0.703 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855549).  Saving model ...
Epoch: 22 cost time: 3.7476632595062256
Epoch: 22, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.574643611907959
Epoch: 23, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.770293712615967
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 25 cost time: 3.8239471912384033
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.682 Vali Acc: 0.867 Test Loss: 0.682 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.83723521232605
Epoch: 26, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.752 Vali Acc: 0.867 Test Loss: 0.752 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.711533546447754
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.778 Vali Acc: 0.867 Test Loss: 0.778 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.9884421825408936
Epoch: 28, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.4075279235839844
Epoch: 29, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.699 Vali Acc: 0.883 Test Loss: 0.699 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883326).  Saving model ...
Epoch: 30 cost time: 3.335195302963257
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.623081684112549
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.529855489730835
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.311192035675049
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.690 Vali Acc: 0.872 Test Loss: 0.690 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.4049038887023926
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.712 Vali Acc: 0.872 Test Loss: 0.712 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.5752980709075928
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.698 Vali Acc: 0.861 Test Loss: 0.698 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.679600715637207
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.736 Vali Acc: 0.872 Test Loss: 0.736 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.862597703933716
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.686 Vali Acc: 0.872 Test Loss: 0.686 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.6785852909088135
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.872 Test Loss: 0.717 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.8949575424194336
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.867 Test Loss: 0.747 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.666799783706665
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.501 Vali Acc: 0.200 Test Loss: 2.501 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 3.9843087196350098
Epoch: 2, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.039 Vali Acc: 0.328 Test Loss: 2.039 Test Acc: 0.328
Validation loss decreased (-0.199975 --> -0.327757).  Saving model ...
Epoch: 3 cost time: 3.641592264175415
Epoch: 3, Steps: 12 | Train Loss: 2.385 Vali Loss: 1.812 Vali Acc: 0.417 Test Loss: 1.812 Test Acc: 0.417
Validation loss decreased (-0.327757 --> -0.416649).  Saving model ...
Epoch: 4 cost time: 3.8269224166870117
Epoch: 4, Steps: 12 | Train Loss: 2.064 Vali Loss: 1.658 Vali Acc: 0.478 Test Loss: 1.658 Test Acc: 0.478
Validation loss decreased (-0.416649 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 3.763780355453491
Epoch: 5, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.466 Vali Acc: 0.494 Test Loss: 1.466 Test Acc: 0.494
Validation loss decreased (-0.477761 --> -0.494430).  Saving model ...
Epoch: 6 cost time: 3.682062864303589
Epoch: 6, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.266 Vali Acc: 0.594 Test Loss: 1.266 Test Acc: 0.594
Validation loss decreased (-0.494430 --> -0.594432).  Saving model ...
Epoch: 7 cost time: 3.5840256214141846
Epoch: 7, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.062 Vali Acc: 0.672 Test Loss: 1.062 Test Acc: 0.672
Validation loss decreased (-0.594432 --> -0.672212).  Saving model ...
Epoch: 8 cost time: 3.662722587585449
Epoch: 8, Steps: 12 | Train Loss: 0.761 Vali Loss: 1.023 Vali Acc: 0.661 Test Loss: 1.023 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.82177734375
Epoch: 9, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.799 Vali Acc: 0.706 Test Loss: 0.799 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705548).  Saving model ...
Epoch: 10 cost time: 3.5979156494140625
Epoch: 10, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
Validation loss decreased (-0.705548 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 3.4022061824798584
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.777 Vali Acc: 0.761 Test Loss: 0.777 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 3.8837931156158447
Epoch: 12, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
Validation loss decreased (-0.761103 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 4.1939287185668945
Epoch: 13, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.628512382507324
Epoch: 14, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.733 Vali Acc: 0.817 Test Loss: 0.733 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.466128349304199
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.701 Vali Acc: 0.772 Test Loss: 0.701 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.129877328872681
Epoch: 16, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.731 Vali Acc: 0.822 Test Loss: 0.731 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.653533220291138
Epoch: 17, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.756 Vali Acc: 0.806 Test Loss: 0.756 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.599947929382324
Epoch: 18, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.874 Vali Acc: 0.789 Test Loss: 0.874 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.9639909267425537
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.681 Vali Acc: 0.828 Test Loss: 0.681 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8274173736572266
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.699 Vali Acc: 0.817 Test Loss: 0.699 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.173614263534546
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
Validation loss decreased (-0.833327 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 4.227189064025879
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.702 Vali Acc: 0.828 Test Loss: 0.702 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9602138996124268
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.087830305099487
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.639 Vali Acc: 0.861 Test Loss: 0.639 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.173919439315796
Epoch: 25, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.716 Vali Acc: 0.839 Test Loss: 0.716 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.181734800338745
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.751 Vali Acc: 0.878 Test Loss: 0.751 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877770).  Saving model ...
Epoch: 27 cost time: 3.7876806259155273
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.055787801742554
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9555656909942627
Epoch: 29, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.782 Vali Acc: 0.844 Test Loss: 0.782 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.51113224029541
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.803 Vali Acc: 0.850 Test Loss: 0.803 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.011075496673584
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.331793308258057
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.9697890281677246
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.350762367248535
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.734 Vali Acc: 0.856 Test Loss: 0.734 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.7889955043792725
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.0929765701293945
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.749 Vali Acc: 0.867 Test Loss: 0.749 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.623488664627075
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.8492212295532227
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9524919986724854
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4493377208709717
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.419069290161133
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 3.758103847503662
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.617820978164673
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7010793685913086
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.84842848777771
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.732880115509033
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4792959690093994
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.662994861602783
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5073599815368652
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5607845783233643
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.8464248180389404
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 3529231
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.883844375610352
Epoch: 1, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.386 Vali Acc: 0.356 Test Loss: 2.386 Test Acc: 0.356
Validation loss decreased (inf --> -0.355532).  Saving model ...
Epoch: 2 cost time: 3.163306713104248
Epoch: 2, Steps: 12 | Train Loss: 2.117 Vali Loss: 1.754 Vali Acc: 0.561 Test Loss: 1.754 Test Acc: 0.561
Validation loss decreased (-0.355532 --> -0.561094).  Saving model ...
Epoch: 3 cost time: 3.395771026611328
Epoch: 3, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.394 Vali Acc: 0.611 Test Loss: 1.394 Test Acc: 0.611
Validation loss decreased (-0.561094 --> -0.611097).  Saving model ...
Epoch: 4 cost time: 3.4102213382720947
Epoch: 4, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.157 Vali Acc: 0.667 Test Loss: 1.157 Test Acc: 0.667
Validation loss decreased (-0.611097 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 3.3187365531921387
Epoch: 5, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.921 Vali Acc: 0.761 Test Loss: 0.921 Test Acc: 0.761
Validation loss decreased (-0.666655 --> -0.761102).  Saving model ...
Epoch: 6 cost time: 3.4718270301818848
Epoch: 6, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772215).  Saving model ...
Epoch: 7 cost time: 3.4757347106933594
Epoch: 7, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.643 Vali Acc: 0.817 Test Loss: 0.643 Test Acc: 0.817
Validation loss decreased (-0.772215 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 3.592395544052124
Epoch: 8, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.585 Vali Acc: 0.817 Test Loss: 0.585 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 3.5038561820983887
Epoch: 9, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
Validation loss decreased (-0.816661 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 3.7771198749542236
Epoch: 10, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
Validation loss decreased (-0.849995 --> -0.872218).  Saving model ...
Epoch: 11 cost time: 3.561772108078003
Epoch: 11, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.872218 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 3.690126895904541
Epoch: 12, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.415 Vali Acc: 0.872 Test Loss: 0.415 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4061999320983887
Epoch: 13, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.532 Vali Acc: 0.894 Test Loss: 0.532 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6905384063720703
Epoch: 14, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.776334047317505
Epoch: 15, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.447 Vali Acc: 0.906 Test Loss: 0.447 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905551).  Saving model ...
Epoch: 16 cost time: 3.6729798316955566
Epoch: 16, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.433 Vali Acc: 0.894 Test Loss: 0.433 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.750894546508789
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.521 Vali Acc: 0.894 Test Loss: 0.521 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3968427181243896
Epoch: 18, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4265644550323486
Epoch: 19, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.538 Vali Acc: 0.906 Test Loss: 0.538 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1962411403656006
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.429 Vali Acc: 0.894 Test Loss: 0.429 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6003262996673584
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.4599452018737793
Epoch: 22, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4512081146240234
Epoch: 23, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.4283394813537598
Epoch: 24, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.532 Vali Acc: 0.894 Test Loss: 0.532 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4472222328186035
Epoch: 25, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3174920082092285
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.462 Vali Acc: 0.256 Test Loss: 2.462 Test Acc: 0.256
Validation loss decreased (inf --> -0.255531).  Saving model ...
Epoch: 2 cost time: 3.4737608432769775
Epoch: 2, Steps: 12 | Train Loss: 2.237 Vali Loss: 1.913 Vali Acc: 0.533 Test Loss: 1.913 Test Acc: 0.533
Validation loss decreased (-0.255531 --> -0.533314).  Saving model ...
Epoch: 3 cost time: 3.841080904006958
Epoch: 3, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.536 Vali Acc: 0.594 Test Loss: 1.536 Test Acc: 0.594
Validation loss decreased (-0.533314 --> -0.594429).  Saving model ...
Epoch: 4 cost time: 3.7574846744537354
Epoch: 4, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.286 Vali Acc: 0.617 Test Loss: 1.286 Test Acc: 0.617
Validation loss decreased (-0.594429 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 3.7479183673858643
Epoch: 5, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.054 Vali Acc: 0.722 Test Loss: 1.054 Test Acc: 0.722
Validation loss decreased (-0.616654 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 3.845494031906128
Epoch: 6, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.886 Vali Acc: 0.756 Test Loss: 0.886 Test Acc: 0.756
Validation loss decreased (-0.722212 --> -0.755547).  Saving model ...
Epoch: 7 cost time: 3.930316925048828
Epoch: 7, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.774 Vali Acc: 0.800 Test Loss: 0.774 Test Acc: 0.800
Validation loss decreased (-0.755547 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 3.744438648223877
Epoch: 8, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.699 Vali Acc: 0.828 Test Loss: 0.699 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 9 cost time: 3.8612003326416016
Epoch: 9, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 3.5073890686035156
Epoch: 10, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.510 Vali Acc: 0.872 Test Loss: 0.510 Test Acc: 0.872
Validation loss decreased (-0.833326 --> -0.872217).  Saving model ...
Epoch: 11 cost time: 3.62160062789917
Epoch: 11, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.415430784225464
Epoch: 12, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 13 cost time: 3.4974818229675293
Epoch: 13, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.556 Vali Acc: 0.894 Test Loss: 0.556 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 14 cost time: 3.2540066242218018
Epoch: 14, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.528411626815796
Epoch: 15, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 3.5636024475097656
Epoch: 16, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5552639961242676
Epoch: 17, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.02264928817749
Epoch: 18, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.678135871887207
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.031112194061279
Epoch: 20, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.7747364044189453
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.600 Vali Acc: 0.894 Test Loss: 0.600 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.933748960494995
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.870765209197998
Epoch: 23, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.656 Vali Acc: 0.894 Test Loss: 0.656 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.152210712432861
Epoch: 24, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.561 Vali Acc: 0.894 Test Loss: 0.561 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.9421281814575195
Epoch: 25, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.894 Test Loss: 0.580 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.460085153579712
Epoch: 1, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.544 Vali Acc: 0.161 Test Loss: 2.544 Test Acc: 0.161
Validation loss decreased (inf --> -0.161086).  Saving model ...
Epoch: 2 cost time: 3.917856454849243
Epoch: 2, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.089 Vali Acc: 0.378 Test Loss: 2.089 Test Acc: 0.378
Validation loss decreased (-0.161086 --> -0.377757).  Saving model ...
Epoch: 3 cost time: 3.6348488330841064
Epoch: 3, Steps: 12 | Train Loss: 1.946 Vali Loss: 1.740 Vali Acc: 0.578 Test Loss: 1.740 Test Acc: 0.578
Validation loss decreased (-0.377757 --> -0.577760).  Saving model ...
Epoch: 4 cost time: 3.8986475467681885
Epoch: 4, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.460 Vali Acc: 0.567 Test Loss: 1.460 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5915751457214355
Epoch: 5, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.192 Vali Acc: 0.656 Test Loss: 1.192 Test Acc: 0.656
Validation loss decreased (-0.577760 --> -0.655544).  Saving model ...
Epoch: 6 cost time: 4.062485218048096
Epoch: 6, Steps: 12 | Train Loss: 0.963 Vali Loss: 0.998 Vali Acc: 0.717 Test Loss: 0.998 Test Acc: 0.717
Validation loss decreased (-0.655544 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 3.8794515132904053
Epoch: 7, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.911 Vali Acc: 0.739 Test Loss: 0.911 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738880).  Saving model ...
Epoch: 8 cost time: 3.9978322982788086
Epoch: 8, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.868 Vali Acc: 0.767 Test Loss: 0.868 Test Acc: 0.767
Validation loss decreased (-0.738880 --> -0.766658).  Saving model ...
Epoch: 9 cost time: 3.8114206790924072
Epoch: 9, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.877 Vali Acc: 0.728 Test Loss: 0.877 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8332293033599854
Epoch: 10, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 4.004158973693848
Epoch: 11, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.725 Vali Acc: 0.817 Test Loss: 0.725 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816659).  Saving model ...
Epoch: 12 cost time: 3.5284924507141113
Epoch: 12, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 3.7703208923339844
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.681 Vali Acc: 0.839 Test Loss: 0.681 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838882).  Saving model ...
Epoch: 14 cost time: 3.6309051513671875
Epoch: 14, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
Validation loss decreased (-0.838882 --> -0.866661).  Saving model ...
Epoch: 15 cost time: 3.67012619972229
Epoch: 15, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.027539968490601
Epoch: 16, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7671539783477783
Epoch: 17, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.9431045055389404
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.598 Vali Acc: 0.856 Test Loss: 0.598 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.77780818939209
Epoch: 19, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7250289916992188
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.7314746379852295
Epoch: 21, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 22 cost time: 3.584294080734253
Epoch: 22, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.568 Vali Acc: 0.867 Test Loss: 0.568 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4860990047454834
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4067068099975586
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.651 Vali Acc: 0.878 Test Loss: 0.651 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 25 cost time: 3.5040154457092285
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.950165033340454
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7165050506591797
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8848886489868164
Epoch: 28, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.594 Vali Acc: 0.867 Test Loss: 0.594 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.9509403705596924
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.622 Vali Acc: 0.883 Test Loss: 0.622 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883327).  Saving model ...
Epoch: 30 cost time: 4.0331549644470215
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.591 Vali Acc: 0.872 Test Loss: 0.591 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.287402868270874
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.617 Vali Acc: 0.872 Test Loss: 0.617 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.8470618724823
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.940429210662842
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.872 Test Loss: 0.613 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.9251813888549805
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.809129476547241
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.872 Test Loss: 0.628 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.852306842803955
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.629119396209717
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.872 Test Loss: 0.635 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.896406650543213
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.639 Vali Acc: 0.878 Test Loss: 0.639 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.7409024238586426
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.878 Test Loss: 0.646 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.392282485961914
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.611 Vali Acc: 0.150 Test Loss: 2.611 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 4.012691497802734
Epoch: 2, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.269 Vali Acc: 0.278 Test Loss: 2.269 Test Acc: 0.278
Validation loss decreased (-0.149974 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 3.580620288848877
Epoch: 3, Steps: 12 | Train Loss: 2.151 Vali Loss: 1.950 Vali Acc: 0.389 Test Loss: 1.950 Test Acc: 0.389
Validation loss decreased (-0.277755 --> -0.388869).  Saving model ...
Epoch: 4 cost time: 3.938261032104492
Epoch: 4, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.624 Vali Acc: 0.539 Test Loss: 1.624 Test Acc: 0.539
Validation loss decreased (-0.388869 --> -0.538873).  Saving model ...
Epoch: 5 cost time: 3.4750750064849854
Epoch: 5, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.298 Vali Acc: 0.656 Test Loss: 1.298 Test Acc: 0.656
Validation loss decreased (-0.538873 --> -0.655543).  Saving model ...
Epoch: 6 cost time: 3.6260557174682617
Epoch: 6, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.050 Vali Acc: 0.639 Test Loss: 1.050 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5801239013671875
Epoch: 7, Steps: 12 | Train Loss: 0.827 Vali Loss: 0.942 Vali Acc: 0.689 Test Loss: 0.942 Test Acc: 0.689
Validation loss decreased (-0.655543 --> -0.688879).  Saving model ...
Epoch: 8 cost time: 3.693275213241577
Epoch: 8, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.875 Vali Acc: 0.711 Test Loss: 0.875 Test Acc: 0.711
Validation loss decreased (-0.688879 --> -0.711102).  Saving model ...
Epoch: 9 cost time: 3.7194228172302246
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.875 Vali Acc: 0.700 Test Loss: 0.875 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.321675062179565
Epoch: 10, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.689 Vali Acc: 0.789 Test Loss: 0.689 Test Acc: 0.789
Validation loss decreased (-0.711102 --> -0.788882).  Saving model ...
Epoch: 11 cost time: 3.5587685108184814
Epoch: 11, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.696 Vali Acc: 0.794 Test Loss: 0.696 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 3.6394665241241455
Epoch: 12, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.634 Vali Acc: 0.794 Test Loss: 0.634 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 13 cost time: 3.6637122631073
Epoch: 13, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.698 Vali Acc: 0.800 Test Loss: 0.698 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 3.5404012203216553
Epoch: 14, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.799993 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 3.6509788036346436
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.703 Vali Acc: 0.828 Test Loss: 0.703 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.710685968399048
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.633 Vali Acc: 0.828 Test Loss: 0.633 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.873657703399658
Epoch: 17, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5746095180511475
Epoch: 18, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 19 cost time: 3.880795478820801
Epoch: 19, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.776 Vali Acc: 0.806 Test Loss: 0.776 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7094738483428955
Epoch: 20, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.879457473754883
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6247165203094482
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.685 Vali Acc: 0.833 Test Loss: 0.685 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.965069055557251
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.8281259536743164
Epoch: 24, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.787 Vali Acc: 0.861 Test Loss: 0.787 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.8039872646331787
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.768 Vali Acc: 0.867 Test Loss: 0.768 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 26 cost time: 3.7461915016174316
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.93231463432312
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.896 Vali Acc: 0.867 Test Loss: 0.896 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.643509864807129
Epoch: 28, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.778 Vali Acc: 0.872 Test Loss: 0.778 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872214).  Saving model ...
Epoch: 29 cost time: 3.5555617809295654
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.879 Vali Acc: 0.844 Test Loss: 0.879 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.385424852371216
Epoch: 30, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.065 Vali Acc: 0.856 Test Loss: 1.065 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7023167610168457
Epoch: 31, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.592268943786621
Epoch: 32, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.556 Vali Acc: 0.778 Test Loss: 1.556 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.676564931869507
Epoch: 33, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.938 Vali Acc: 0.822 Test Loss: 0.938 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4406280517578125
Epoch: 34, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.858 Vali Acc: 0.839 Test Loss: 0.858 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.5995845794677734
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.977 Vali Acc: 0.828 Test Loss: 0.977 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.368025541305542
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.997 Vali Acc: 0.850 Test Loss: 0.997 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.6433510780334473
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.857 Vali Acc: 0.867 Test Loss: 0.857 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.6591849327087402
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.820 Vali Acc: 0.878 Test Loss: 0.820 Test Acc: 0.878
Validation loss decreased (-0.872214 --> -0.877770).  Saving model ...
Epoch: 39 cost time: 3.9105191230773926
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.841 Vali Acc: 0.872 Test Loss: 0.841 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.103778123855591
Epoch: 40, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.876 Vali Acc: 0.872 Test Loss: 0.876 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.8252053260803223
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.872 Test Loss: 0.834 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.5845203399658203
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.856 Vali Acc: 0.872 Test Loss: 0.856 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.8098082542419434
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.872 Test Loss: 0.856 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.809607744216919
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.872 Test Loss: 0.852 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.93813157081604
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.872 Test Loss: 0.849 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.6153149604797363
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.872 Test Loss: 0.850 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 4.179810523986816
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.872 Test Loss: 0.852 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.762360095977783
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.872 Test Loss: 0.856 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.260796070098877
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.468 Vali Acc: 0.211 Test Loss: 2.468 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 3.4351367950439453
Epoch: 2, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.010 Vali Acc: 0.350 Test Loss: 2.010 Test Acc: 0.350
Validation loss decreased (-0.211086 --> -0.349980).  Saving model ...
Epoch: 3 cost time: 3.4231607913970947
Epoch: 3, Steps: 12 | Train Loss: 2.276 Vali Loss: 1.823 Vali Acc: 0.417 Test Loss: 1.823 Test Acc: 0.417
Validation loss decreased (-0.349980 --> -0.416648).  Saving model ...
Epoch: 4 cost time: 3.530900239944458
Epoch: 4, Steps: 12 | Train Loss: 1.947 Vali Loss: 1.690 Vali Acc: 0.478 Test Loss: 1.690 Test Acc: 0.478
Validation loss decreased (-0.416648 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 3.361551284790039
Epoch: 5, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.498 Vali Acc: 0.528 Test Loss: 1.498 Test Acc: 0.528
Validation loss decreased (-0.477761 --> -0.527763).  Saving model ...
Epoch: 6 cost time: 3.4495575428009033
Epoch: 6, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.220 Vali Acc: 0.639 Test Loss: 1.220 Test Acc: 0.639
Validation loss decreased (-0.527763 --> -0.638877).  Saving model ...
Epoch: 7 cost time: 3.4818413257598877
Epoch: 7, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.109 Vali Acc: 0.661 Test Loss: 1.109 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 3.5421860218048096
Epoch: 8, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.990 Vali Acc: 0.689 Test Loss: 0.990 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688879).  Saving model ...
Epoch: 9 cost time: 3.911334753036499
Epoch: 9, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.895 Vali Acc: 0.689 Test Loss: 0.895 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 10 cost time: 3.539775848388672
Epoch: 10, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.772 Vali Acc: 0.756 Test Loss: 0.772 Test Acc: 0.756
Validation loss decreased (-0.688880 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 3.5776703357696533
Epoch: 11, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
Validation loss decreased (-0.755548 --> -0.788882).  Saving model ...
Epoch: 12 cost time: 3.8335695266723633
Epoch: 12, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 13 cost time: 4.046860933303833
Epoch: 13, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.683 Vali Acc: 0.806 Test Loss: 0.683 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.541069507598877
Epoch: 14, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
Validation loss decreased (-0.816660 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 3.5126261711120605
Epoch: 15, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.663 Vali Acc: 0.817 Test Loss: 0.663 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.0869176387786865
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.664 Vali Acc: 0.839 Test Loss: 0.664 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6898491382598877
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.683 Vali Acc: 0.839 Test Loss: 0.683 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.249765872955322
Epoch: 18, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.659 Vali Acc: 0.839 Test Loss: 0.659 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.103034496307373
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.686 Vali Acc: 0.828 Test Loss: 0.686 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9011521339416504
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.188758373260498
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.919 Vali Acc: 0.817 Test Loss: 0.919 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.1217122077941895
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.754 Vali Acc: 0.833 Test Loss: 0.754 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.1565306186676025
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.885 Vali Acc: 0.839 Test Loss: 0.885 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.256831884384155
Epoch: 24, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.926 Vali Acc: 0.861 Test Loss: 0.926 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861102).  Saving model ...
Epoch: 25 cost time: 4.280629396438599
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.675 Vali Acc: 0.828 Test Loss: 0.675 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.842595338821411
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.6365411281585693
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.749 Vali Acc: 0.833 Test Loss: 0.749 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.7545087337493896
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.730 Vali Acc: 0.861 Test Loss: 0.730 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861104).  Saving model ...
Epoch: 29 cost time: 3.943013906478882
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.737 Vali Acc: 0.844 Test Loss: 0.737 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.000321626663208
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.871 Vali Acc: 0.872 Test Loss: 0.871 Test Acc: 0.872
Validation loss decreased (-0.861104 --> -0.872214).  Saving model ...
Epoch: 31 cost time: 4.005272626876831
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6597840785980225
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.849 Vali Acc: 0.844 Test Loss: 0.849 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.9316720962524414
Epoch: 33, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.854 Vali Acc: 0.872 Test Loss: 0.854 Test Acc: 0.872
Validation loss decreased (-0.872214 --> -0.872214).  Saving model ...
Epoch: 34 cost time: 4.350773334503174
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.887 Vali Acc: 0.861 Test Loss: 0.887 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.922091007232666
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.812 Vali Acc: 0.861 Test Loss: 0.812 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.122226238250732
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.745 Vali Acc: 0.872 Test Loss: 0.745 Test Acc: 0.872
Validation loss decreased (-0.872214 --> -0.872215).  Saving model ...
Epoch: 37 cost time: 4.20618462562561
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.766 Vali Acc: 0.878 Test Loss: 0.766 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877770).  Saving model ...
Epoch: 38 cost time: 3.954740524291992
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.772 Vali Acc: 0.867 Test Loss: 0.772 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.055921316146851
Epoch: 39, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.883 Test Loss: 0.795 Test Acc: 0.883
Validation loss decreased (-0.877770 --> -0.883325).  Saving model ...
Epoch: 40 cost time: 4.036072254180908
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.883 Test Loss: 0.807 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.0944390296936035
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.796 Vali Acc: 0.878 Test Loss: 0.796 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.9040703773498535
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.878 Test Loss: 0.794 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.935774326324463
Epoch: 43, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.872 Test Loss: 0.796 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.7372164726257324
Epoch: 44, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.878 Test Loss: 0.799 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.8015124797821045
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.878 Test Loss: 0.800 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.621159553527832
Epoch: 46, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.878 Test Loss: 0.801 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.698253870010376
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.878 Test Loss: 0.801 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.657454252243042
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.883 Test Loss: 0.810 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.6997458934783936
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.878 Test Loss: 0.809 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.205892562866211
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.290 Vali Acc: 0.322 Test Loss: 2.290 Test Acc: 0.322
Validation loss decreased (inf --> -0.322199).  Saving model ...
Epoch: 2 cost time: 3.9527993202209473
Epoch: 2, Steps: 12 | Train Loss: 2.595 Vali Loss: 1.925 Vali Acc: 0.350 Test Loss: 1.925 Test Acc: 0.350
Validation loss decreased (-0.322199 --> -0.349981).  Saving model ...
Epoch: 3 cost time: 3.9355287551879883
Epoch: 3, Steps: 12 | Train Loss: 2.325 Vali Loss: 1.870 Vali Acc: 0.417 Test Loss: 1.870 Test Acc: 0.417
Validation loss decreased (-0.349981 --> -0.416648).  Saving model ...
Epoch: 4 cost time: 4.104525566101074
Epoch: 4, Steps: 12 | Train Loss: 2.100 Vali Loss: 1.740 Vali Acc: 0.472 Test Loss: 1.740 Test Acc: 0.472
Validation loss decreased (-0.416648 --> -0.472205).  Saving model ...
Epoch: 5 cost time: 3.746293067932129
Epoch: 5, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.542 Vali Acc: 0.522 Test Loss: 1.542 Test Acc: 0.522
Validation loss decreased (-0.472205 --> -0.522207).  Saving model ...
Epoch: 6 cost time: 3.8492934703826904
Epoch: 6, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.263 Vali Acc: 0.606 Test Loss: 1.263 Test Acc: 0.606
Validation loss decreased (-0.522207 --> -0.605543).  Saving model ...
Epoch: 7 cost time: 3.729673147201538
Epoch: 7, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.114 Vali Acc: 0.661 Test Loss: 1.114 Test Acc: 0.661
Validation loss decreased (-0.605543 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 4.562193393707275
Epoch: 8, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.029 Vali Acc: 0.706 Test Loss: 1.029 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 4.178888320922852
Epoch: 9, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.937 Vali Acc: 0.689 Test Loss: 0.937 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4907968044281006
Epoch: 10, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.756 Vali Acc: 0.717 Test Loss: 0.756 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 3.5451016426086426
Epoch: 11, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 3.599649429321289
Epoch: 12, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.761104 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 3.8090789318084717
Epoch: 13, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.691 Vali Acc: 0.783 Test Loss: 0.691 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.554981231689453
Epoch: 14, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.635 Vali Acc: 0.839 Test Loss: 0.635 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 15 cost time: 3.9415013790130615
Epoch: 15, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 3.9615254402160645
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.641 Vali Acc: 0.817 Test Loss: 0.641 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.436272382736206
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.663 Vali Acc: 0.833 Test Loss: 0.663 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8227667808532715
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.716 Vali Acc: 0.833 Test Loss: 0.716 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.793916940689087
Epoch: 19, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.753 Vali Acc: 0.828 Test Loss: 0.753 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.8531274795532227
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.668 Vali Acc: 0.839 Test Loss: 0.668 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.074038982391357
Epoch: 21, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.837 Vali Acc: 0.833 Test Loss: 0.837 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.0255279541015625
Epoch: 22, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.739 Vali Acc: 0.867 Test Loss: 0.739 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866659).  Saving model ...
Epoch: 23 cost time: 4.156574487686157
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.800 Vali Acc: 0.833 Test Loss: 0.800 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8064496517181396
Epoch: 24, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.882 Vali Acc: 0.839 Test Loss: 0.882 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.974137544631958
Epoch: 25, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.781 Vali Acc: 0.856 Test Loss: 0.781 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.740659475326538
Epoch: 26, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.9760427474975586
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.5487442016601562
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.737 Vali Acc: 0.817 Test Loss: 0.737 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.4763247966766357
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.871 Vali Acc: 0.822 Test Loss: 0.871 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.743680000305176
Epoch: 30, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.065 Vali Acc: 0.828 Test Loss: 1.065 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.6472713947296143
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.901 Vali Acc: 0.833 Test Loss: 0.901 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.753864288330078
Epoch: 32, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.841 Vali Acc: 0.856 Test Loss: 0.841 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.317117929458618
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.454 Vali Acc: 0.200 Test Loss: 2.454 Test Acc: 0.200
Validation loss decreased (inf --> -0.199975).  Saving model ...
Epoch: 2 cost time: 3.675213575363159
Epoch: 2, Steps: 12 | Train Loss: 2.565 Vali Loss: 1.978 Vali Acc: 0.367 Test Loss: 1.978 Test Acc: 0.367
Validation loss decreased (-0.199975 --> -0.366647).  Saving model ...
Epoch: 3 cost time: 3.4845387935638428
Epoch: 3, Steps: 12 | Train Loss: 2.346 Vali Loss: 1.885 Vali Acc: 0.406 Test Loss: 1.885 Test Acc: 0.406
Validation loss decreased (-0.366647 --> -0.405537).  Saving model ...
Epoch: 4 cost time: 3.5282771587371826
Epoch: 4, Steps: 12 | Train Loss: 2.101 Vali Loss: 1.774 Vali Acc: 0.461 Test Loss: 1.774 Test Acc: 0.461
Validation loss decreased (-0.405537 --> -0.461093).  Saving model ...
Epoch: 5 cost time: 3.447902202606201
Epoch: 5, Steps: 12 | Train Loss: 1.641 Vali Loss: 1.617 Vali Acc: 0.528 Test Loss: 1.617 Test Acc: 0.528
Validation loss decreased (-0.461093 --> -0.527762).  Saving model ...
Epoch: 6 cost time: 3.4598021507263184
Epoch: 6, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.271 Vali Acc: 0.617 Test Loss: 1.271 Test Acc: 0.617
Validation loss decreased (-0.527762 --> -0.616654).  Saving model ...
Epoch: 7 cost time: 3.7281267642974854
Epoch: 7, Steps: 12 | Train Loss: 0.927 Vali Loss: 1.115 Vali Acc: 0.667 Test Loss: 1.115 Test Acc: 0.667
Validation loss decreased (-0.616654 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 3.651528835296631
Epoch: 8, Steps: 12 | Train Loss: 0.743 Vali Loss: 1.012 Vali Acc: 0.694 Test Loss: 1.012 Test Acc: 0.694
Validation loss decreased (-0.666656 --> -0.694434).  Saving model ...
Epoch: 9 cost time: 3.54437518119812
Epoch: 9, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.905 Vali Acc: 0.694 Test Loss: 0.905 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 10 cost time: 3.5823934078216553
Epoch: 10, Steps: 12 | Train Loss: 0.532 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
Validation loss decreased (-0.694435 --> -0.755548).  Saving model ...
Epoch: 11 cost time: 3.496365785598755
Epoch: 11, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.693 Vali Acc: 0.794 Test Loss: 0.693 Test Acc: 0.794
Validation loss decreased (-0.755548 --> -0.794438).  Saving model ...
Epoch: 12 cost time: 3.5243122577667236
Epoch: 12, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5976200103759766
Epoch: 13, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.705 Vali Acc: 0.794 Test Loss: 0.705 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4649910926818848
Epoch: 14, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 3.58693790435791
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.684 Vali Acc: 0.817 Test Loss: 0.684 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.489008903503418
Epoch: 16, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.656 Vali Acc: 0.822 Test Loss: 0.656 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6053552627563477
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.726 Vali Acc: 0.833 Test Loss: 0.726 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 18 cost time: 3.5214760303497314
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.676 Vali Acc: 0.811 Test Loss: 0.676 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.480360746383667
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7756404876708984
Epoch: 20, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 3.6816186904907227
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.827 Vali Acc: 0.861 Test Loss: 0.827 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861103).  Saving model ...
Epoch: 22 cost time: 3.724421739578247
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.768 Vali Acc: 0.828 Test Loss: 0.768 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.7647714614868164
Epoch: 23, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.688 Vali Acc: 0.844 Test Loss: 0.688 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.8740668296813965
Epoch: 24, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.783 Vali Acc: 0.856 Test Loss: 0.783 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8476390838623047
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.812105417251587
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.759 Vali Acc: 0.867 Test Loss: 0.759 Test Acc: 0.867
Validation loss decreased (-0.861103 --> -0.866659).  Saving model ...
Epoch: 27 cost time: 3.5345044136047363
Epoch: 27, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.763 Vali Acc: 0.856 Test Loss: 0.763 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9135305881500244
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.739 Vali Acc: 0.850 Test Loss: 0.739 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.965123414993286
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.743 Vali Acc: 0.872 Test Loss: 0.743 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872215).  Saving model ...
Epoch: 30 cost time: 3.7467308044433594
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.825 Vali Acc: 0.861 Test Loss: 0.825 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.735521078109741
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.005 Vali Acc: 0.839 Test Loss: 1.005 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.694114923477173
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.883 Vali Acc: 0.867 Test Loss: 0.883 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.9556193351745605
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.7687201499938965
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.782 Vali Acc: 0.850 Test Loss: 0.782 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.6151325702667236
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.861 Vali Acc: 0.878 Test Loss: 0.861 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877769).  Saving model ...
Epoch: 36 cost time: 3.760169267654419
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.828 Vali Acc: 0.844 Test Loss: 0.828 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.588130474090576
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.923 Vali Acc: 0.867 Test Loss: 0.923 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.868734359741211
Epoch: 38, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.9619951248168945
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.879 Vali Acc: 0.867 Test Loss: 0.879 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.8978047370910645
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.823 Vali Acc: 0.844 Test Loss: 0.823 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.388137340545654
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.846 Vali Acc: 0.861 Test Loss: 0.846 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.1586527824401855
Epoch: 42, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.810 Vali Acc: 0.850 Test Loss: 0.810 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.9120209217071533
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.856 Test Loss: 0.850 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.851534843444824
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.861 Test Loss: 0.851 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.8300507068634033
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.856 Test Loss: 0.835 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.490467071533203
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.8640785217285156
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.565157651901245
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5054218769073486
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6646881103515625
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.9196290969848633
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.6716690063476562
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.882305145263672
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9291679859161377
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.760824680328369
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.832559585571289
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 2742799
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.076801300048828
Epoch: 1, Steps: 12 | Train Loss: 2.692 Vali Loss: 2.401 Vali Acc: 0.339 Test Loss: 2.401 Test Acc: 0.339
Validation loss decreased (inf --> -0.338865).  Saving model ...
Epoch: 2 cost time: 3.583004951477051
Epoch: 2, Steps: 12 | Train Loss: 2.230 Vali Loss: 1.809 Vali Acc: 0.528 Test Loss: 1.809 Test Acc: 0.528
Validation loss decreased (-0.338865 --> -0.527760).  Saving model ...
Epoch: 3 cost time: 3.8382935523986816
Epoch: 3, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.375 Vali Acc: 0.628 Test Loss: 1.375 Test Acc: 0.628
Validation loss decreased (-0.527760 --> -0.627764).  Saving model ...
Epoch: 4 cost time: 4.439906120300293
Epoch: 4, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.190 Vali Acc: 0.667 Test Loss: 1.190 Test Acc: 0.667
Validation loss decreased (-0.627764 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 4.041395425796509
Epoch: 5, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.006 Vali Acc: 0.733 Test Loss: 1.006 Test Acc: 0.733
Validation loss decreased (-0.666655 --> -0.733323).  Saving model ...
Epoch: 6 cost time: 3.7028861045837402
Epoch: 6, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.832 Vali Acc: 0.733 Test Loss: 0.832 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 3.4642608165740967
Epoch: 7, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.698 Vali Acc: 0.811 Test Loss: 0.698 Test Acc: 0.811
Validation loss decreased (-0.733325 --> -0.811104).  Saving model ...
Epoch: 8 cost time: 3.5288240909576416
Epoch: 8, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844439).  Saving model ...
Epoch: 9 cost time: 3.7856295108795166
Epoch: 9, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 10 cost time: 3.8689281940460205
Epoch: 10, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.479 Vali Acc: 0.861 Test Loss: 0.479 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 11 cost time: 3.6829731464385986
Epoch: 11, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 4.305432081222534
Epoch: 12, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.411 Vali Acc: 0.872 Test Loss: 0.411 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0802788734436035
Epoch: 13, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.883329 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 4.09330415725708
Epoch: 14, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.396 Vali Acc: 0.883 Test Loss: 0.396 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.295809984207153
Epoch: 15, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.408 Vali Acc: 0.894 Test Loss: 0.408 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.027161598205566
Epoch: 16, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 4.031313419342041
Epoch: 17, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.425 Vali Acc: 0.894 Test Loss: 0.425 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.951629638671875
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.420 Vali Acc: 0.906 Test Loss: 0.420 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905551).  Saving model ...
Epoch: 19 cost time: 4.1261091232299805
Epoch: 19, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.094618320465088
Epoch: 20, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.431 Vali Acc: 0.883 Test Loss: 0.431 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.896925210952759
Epoch: 21, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.524 Vali Acc: 0.900 Test Loss: 0.524 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.154369592666626
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6294665336608887
Epoch: 23, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.492 Vali Acc: 0.906 Test Loss: 0.492 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.8020927906036377
Epoch: 24, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.469 Vali Acc: 0.906 Test Loss: 0.469 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.855238199234009
Epoch: 25, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.6858835220336914
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.526 Vali Acc: 0.900 Test Loss: 0.526 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5637147426605225
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.905551 --> -0.911106).  Saving model ...
Epoch: 28 cost time: 3.5106360912323
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.906 Test Loss: 0.490 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.690605401992798
Epoch: 29, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.906 Test Loss: 0.492 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6464080810546875
Epoch: 30, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.911301612854004
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.781395435333252
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.906 Test Loss: 0.513 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.902750015258789
Epoch: 33, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.8240468502044678
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.911 Test Loss: 0.522 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.8701491355895996
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.906 Test Loss: 0.517 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.917504072189331
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.906 Test Loss: 0.526 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.344825029373169
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.542 Vali Acc: 0.911 Test Loss: 0.542 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.81527042388916
Epoch: 1, Steps: 12 | Train Loss: 2.701 Vali Loss: 2.436 Vali Acc: 0.283 Test Loss: 2.436 Test Acc: 0.283
Validation loss decreased (inf --> -0.283309).  Saving model ...
Epoch: 2 cost time: 3.5122921466827393
Epoch: 2, Steps: 12 | Train Loss: 2.303 Vali Loss: 1.928 Vali Acc: 0.494 Test Loss: 1.928 Test Acc: 0.494
Validation loss decreased (-0.283309 --> -0.494425).  Saving model ...
Epoch: 3 cost time: 3.8872451782226562
Epoch: 3, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.513 Vali Acc: 0.556 Test Loss: 1.513 Test Acc: 0.556
Validation loss decreased (-0.494425 --> -0.555540).  Saving model ...
Epoch: 4 cost time: 3.679563283920288
Epoch: 4, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.284 Vali Acc: 0.617 Test Loss: 1.284 Test Acc: 0.617
Validation loss decreased (-0.555540 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 3.820345401763916
Epoch: 5, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.112 Vali Acc: 0.678 Test Loss: 1.112 Test Acc: 0.678
Validation loss decreased (-0.616654 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 3.7000415325164795
Epoch: 6, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.918 Vali Acc: 0.756 Test Loss: 0.918 Test Acc: 0.756
Validation loss decreased (-0.677767 --> -0.755546).  Saving model ...
Epoch: 7 cost time: 4.261834383010864
Epoch: 7, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.797 Vali Acc: 0.806 Test Loss: 0.797 Test Acc: 0.806
Validation loss decreased (-0.755546 --> -0.805548).  Saving model ...
Epoch: 8 cost time: 3.9294755458831787
Epoch: 8, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822216).  Saving model ...
Epoch: 9 cost time: 3.9066274166107178
Epoch: 9, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.822216 --> -0.855549).  Saving model ...
Epoch: 10 cost time: 3.6976537704467773
Epoch: 10, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
Validation loss decreased (-0.855549 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 3.83233380317688
Epoch: 11, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9171671867370605
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.482 Vali Acc: 0.867 Test Loss: 0.482 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 13 cost time: 4.083686113357544
Epoch: 13, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
Validation loss decreased (-0.866662 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 3.9314043521881104
Epoch: 14, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.484 Vali Acc: 0.878 Test Loss: 0.484 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.234463930130005
Epoch: 15, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9151577949523926
Epoch: 16, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8705947399139404
Epoch: 17, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.742917776107788
Epoch: 18, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.446065902709961
Epoch: 19, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.556 Vali Acc: 0.889 Test Loss: 0.556 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.5560028553009033
Epoch: 20, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.568 Vali Acc: 0.889 Test Loss: 0.568 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.459468364715576
Epoch: 21, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5398080348968506
Epoch: 22, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.570 Vali Acc: 0.889 Test Loss: 0.570 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.6061861515045166
Epoch: 23, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.824612617492676
Epoch: 1, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.493 Vali Acc: 0.233 Test Loss: 2.493 Test Acc: 0.233
Validation loss decreased (inf --> -0.233308).  Saving model ...
Epoch: 2 cost time: 3.63204026222229
Epoch: 2, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.089 Vali Acc: 0.411 Test Loss: 2.089 Test Acc: 0.411
Validation loss decreased (-0.233308 --> -0.411090).  Saving model ...
Epoch: 3 cost time: 4.10429310798645
Epoch: 3, Steps: 12 | Train Loss: 1.930 Vali Loss: 1.721 Vali Acc: 0.522 Test Loss: 1.721 Test Acc: 0.522
Validation loss decreased (-0.411090 --> -0.522205).  Saving model ...
Epoch: 4 cost time: 3.5732150077819824
Epoch: 4, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.467 Vali Acc: 0.594 Test Loss: 1.467 Test Acc: 0.594
Validation loss decreased (-0.522205 --> -0.594430).  Saving model ...
Epoch: 5 cost time: 4.129905700683594
Epoch: 5, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.206 Vali Acc: 0.639 Test Loss: 1.206 Test Acc: 0.639
Validation loss decreased (-0.594430 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 3.739060163497925
Epoch: 6, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.007 Vali Acc: 0.706 Test Loss: 1.007 Test Acc: 0.706
Validation loss decreased (-0.638877 --> -0.705545).  Saving model ...
Epoch: 7 cost time: 3.883330821990967
Epoch: 7, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.867 Vali Acc: 0.756 Test Loss: 0.867 Test Acc: 0.756
Validation loss decreased (-0.705545 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 3.844904899597168
Epoch: 8, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.798 Vali Acc: 0.744 Test Loss: 0.798 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7514755725860596
Epoch: 9, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.732 Vali Acc: 0.778 Test Loss: 0.732 Test Acc: 0.778
Validation loss decreased (-0.755547 --> -0.777770).  Saving model ...
Epoch: 10 cost time: 3.7501909732818604
Epoch: 10, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.695 Vali Acc: 0.778 Test Loss: 0.695 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 11 cost time: 3.822587251663208
Epoch: 11, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 3.4397976398468018
Epoch: 12, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.583 Vali Acc: 0.839 Test Loss: 0.583 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 13 cost time: 3.4000914096832275
Epoch: 13, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.651 Vali Acc: 0.822 Test Loss: 0.651 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5062766075134277
Epoch: 14, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866661).  Saving model ...
Epoch: 15 cost time: 3.8776204586029053
Epoch: 15, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.577169418334961
Epoch: 16, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.627 Vali Acc: 0.856 Test Loss: 0.627 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.08170485496521
Epoch: 17, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.843285322189331
Epoch: 18, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.671055555343628
Epoch: 19, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.684 Vali Acc: 0.872 Test Loss: 0.684 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872215).  Saving model ...
Epoch: 20 cost time: 3.6456639766693115
Epoch: 20, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.112395286560059
Epoch: 21, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.597 Vali Acc: 0.867 Test Loss: 0.597 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7971067428588867
Epoch: 22, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.608 Vali Acc: 0.856 Test Loss: 0.608 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.873450994491577
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
Validation loss decreased (-0.872215 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 3.898366928100586
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.599 Vali Acc: 0.867 Test Loss: 0.599 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6352133750915527
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.616 Vali Acc: 0.889 Test Loss: 0.616 Test Acc: 0.889
Validation loss decreased (-0.872216 --> -0.888883).  Saving model ...
Epoch: 26 cost time: 3.546557903289795
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.612 Vali Acc: 0.889 Test Loss: 0.612 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 3.885038375854492
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.878 Test Loss: 0.602 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7610604763031006
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.620 Vali Acc: 0.889 Test Loss: 0.620 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.102130174636841
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.883 Test Loss: 0.634 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8194355964660645
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.635 Vali Acc: 0.883 Test Loss: 0.635 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.04145073890686
Epoch: 31, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.883 Test Loss: 0.639 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.3755202293396
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.883 Test Loss: 0.655 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.512801885604858
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.670 Vali Acc: 0.883 Test Loss: 0.670 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.363004446029663
Epoch: 34, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.878 Test Loss: 0.648 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.2393975257873535
Epoch: 35, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.878 Test Loss: 0.638 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.935155153274536
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.878 Test Loss: 0.646 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.890182018280029
Epoch: 1, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.561 Vali Acc: 0.183 Test Loss: 2.561 Test Acc: 0.183
Validation loss decreased (inf --> -0.183308).  Saving model ...
Epoch: 2 cost time: 4.4728686809539795
Epoch: 2, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.271 Vali Acc: 0.361 Test Loss: 2.271 Test Acc: 0.361
Validation loss decreased (-0.183308 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 3.7428367137908936
Epoch: 3, Steps: 12 | Train Loss: 2.205 Vali Loss: 1.937 Vali Acc: 0.411 Test Loss: 1.937 Test Acc: 0.411
Validation loss decreased (-0.361088 --> -0.411092).  Saving model ...
Epoch: 4 cost time: 4.109918117523193
Epoch: 4, Steps: 12 | Train Loss: 1.881 Vali Loss: 1.646 Vali Acc: 0.528 Test Loss: 1.646 Test Acc: 0.528
Validation loss decreased (-0.411092 --> -0.527761).  Saving model ...
Epoch: 5 cost time: 3.885904312133789
Epoch: 5, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.330 Vali Acc: 0.628 Test Loss: 1.330 Test Acc: 0.628
Validation loss decreased (-0.527761 --> -0.627764).  Saving model ...
Epoch: 6 cost time: 3.9048476219177246
Epoch: 6, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.086 Vali Acc: 0.661 Test Loss: 1.086 Test Acc: 0.661
Validation loss decreased (-0.627764 --> -0.661100).  Saving model ...
Epoch: 7 cost time: 3.857192039489746
Epoch: 7, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.895 Vali Acc: 0.728 Test Loss: 0.895 Test Acc: 0.728
Validation loss decreased (-0.661100 --> -0.727769).  Saving model ...
Epoch: 8 cost time: 3.8625693321228027
Epoch: 8, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 3.949307918548584
Epoch: 9, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.807 Vali Acc: 0.750 Test Loss: 0.807 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 4.248361825942993
Epoch: 10, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.762 Vali Acc: 0.767 Test Loss: 0.762 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 11 cost time: 3.897116184234619
Epoch: 11, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.710 Vali Acc: 0.806 Test Loss: 0.710 Test Acc: 0.806
Validation loss decreased (-0.766659 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 4.29807448387146
Epoch: 12, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9593114852905273
Epoch: 13, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.631 Vali Acc: 0.794 Test Loss: 0.631 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.699680805206299
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.571 Vali Acc: 0.806 Test Loss: 0.571 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805550).  Saving model ...
Epoch: 15 cost time: 3.844991445541382
Epoch: 15, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.703 Vali Acc: 0.806 Test Loss: 0.703 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.511333227157593
Epoch: 16, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.583 Vali Acc: 0.839 Test Loss: 0.583 Test Acc: 0.839
Validation loss decreased (-0.805550 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 4.192760944366455
Epoch: 17, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.668 Vali Acc: 0.822 Test Loss: 0.668 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8530313968658447
Epoch: 18, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.804 Vali Acc: 0.794 Test Loss: 0.804 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.381872892379761
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.881 Vali Acc: 0.806 Test Loss: 0.881 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.842515707015991
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.774 Vali Acc: 0.833 Test Loss: 0.774 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.737466812133789
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 3.91288685798645
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861104).  Saving model ...
Epoch: 23 cost time: 3.8261196613311768
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.681 Vali Acc: 0.856 Test Loss: 0.681 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.719295024871826
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7344582080841064
Epoch: 25, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6449854373931885
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.416980266571045
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.520756959915161
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.761 Vali Acc: 0.856 Test Loss: 0.761 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.7980406284332275
Epoch: 29, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.737 Vali Acc: 0.861 Test Loss: 0.737 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861104).  Saving model ...
Epoch: 30 cost time: 3.608654022216797
Epoch: 30, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.751 Vali Acc: 0.878 Test Loss: 0.751 Test Acc: 0.878
Validation loss decreased (-0.861104 --> -0.877770).  Saving model ...
Epoch: 31 cost time: 3.50346040725708
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.748 Vali Acc: 0.867 Test Loss: 0.748 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6194958686828613
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.753 Vali Acc: 0.878 Test Loss: 0.753 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5166068077087402
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.759 Vali Acc: 0.883 Test Loss: 0.759 Test Acc: 0.883
Validation loss decreased (-0.877770 --> -0.883326).  Saving model ...
Epoch: 34 cost time: 3.8409810066223145
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.753 Vali Acc: 0.878 Test Loss: 0.753 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5961039066314697
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.755 Vali Acc: 0.878 Test Loss: 0.755 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.705277919769287
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.771 Vali Acc: 0.883 Test Loss: 0.771 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.6178555488586426
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.779 Vali Acc: 0.883 Test Loss: 0.779 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.4285707473754883
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.759 Vali Acc: 0.878 Test Loss: 0.759 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.535940647125244
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.878 Test Loss: 0.772 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.4259328842163086
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.771 Vali Acc: 0.878 Test Loss: 0.771 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.5631496906280518
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.774 Vali Acc: 0.883 Test Loss: 0.774 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.330016851425171
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.878 Test Loss: 0.759 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.6640660762786865
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.878 Test Loss: 0.778 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.630311012268066
Epoch: 1, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.532 Vali Acc: 0.150 Test Loss: 2.532 Test Acc: 0.150
Validation loss decreased (inf --> -0.149975).  Saving model ...
Epoch: 2 cost time: 3.5436244010925293
Epoch: 2, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.129 Vali Acc: 0.289 Test Loss: 2.129 Test Acc: 0.289
Validation loss decreased (-0.149975 --> -0.288868).  Saving model ...
Epoch: 3 cost time: 4.128834247589111
Epoch: 3, Steps: 12 | Train Loss: 2.282 Vali Loss: 1.823 Vali Acc: 0.411 Test Loss: 1.823 Test Acc: 0.411
Validation loss decreased (-0.288868 --> -0.411093).  Saving model ...
Epoch: 4 cost time: 3.566108226776123
Epoch: 4, Steps: 12 | Train Loss: 2.014 Vali Loss: 1.745 Vali Acc: 0.478 Test Loss: 1.745 Test Acc: 0.478
Validation loss decreased (-0.411093 --> -0.477760).  Saving model ...
Epoch: 5 cost time: 3.7485156059265137
Epoch: 5, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.556 Vali Acc: 0.522 Test Loss: 1.556 Test Acc: 0.522
Validation loss decreased (-0.477760 --> -0.522207).  Saving model ...
Epoch: 6 cost time: 3.5603134632110596
Epoch: 6, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.334 Vali Acc: 0.589 Test Loss: 1.334 Test Acc: 0.589
Validation loss decreased (-0.522207 --> -0.588876).  Saving model ...
Epoch: 7 cost time: 4.210542440414429
Epoch: 7, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.072 Vali Acc: 0.667 Test Loss: 1.072 Test Acc: 0.667
Validation loss decreased (-0.588876 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 4.439279794692993
Epoch: 8, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.087 Vali Acc: 0.689 Test Loss: 1.087 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 4.345068454742432
Epoch: 9, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.891 Vali Acc: 0.733 Test Loss: 0.891 Test Acc: 0.733
Validation loss decreased (-0.688878 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 3.7299704551696777
Epoch: 10, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.874 Vali Acc: 0.706 Test Loss: 0.874 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7381949424743652
Epoch: 11, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.760 Vali Acc: 0.772 Test Loss: 0.760 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772215).  Saving model ...
Epoch: 12 cost time: 3.937685489654541
Epoch: 12, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
Validation loss decreased (-0.772215 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 3.396641731262207
Epoch: 13, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7012033462524414
Epoch: 14, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.628 Vali Acc: 0.800 Test Loss: 0.628 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6686763763427734
Epoch: 15, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.845 Vali Acc: 0.772 Test Loss: 0.845 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.659449338912964
Epoch: 16, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.665 Vali Acc: 0.811 Test Loss: 0.665 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8325390815734863
Epoch: 17, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833326).  Saving model ...
Epoch: 18 cost time: 4.19075870513916
Epoch: 18, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.633034706115723
Epoch: 19, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.854 Vali Acc: 0.811 Test Loss: 0.854 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7178170680999756
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.803 Vali Acc: 0.828 Test Loss: 0.803 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.470351457595825
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.778 Vali Acc: 0.822 Test Loss: 0.778 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.333268642425537
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.835 Vali Acc: 0.833 Test Loss: 0.835 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.9599390029907227
Epoch: 23, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.732 Vali Acc: 0.828 Test Loss: 0.732 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.25007963180542
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.781 Vali Acc: 0.861 Test Loss: 0.781 Test Acc: 0.861
Validation loss decreased (-0.833326 --> -0.861103).  Saving model ...
Epoch: 25 cost time: 3.641860246658325
Epoch: 25, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.491088628768921
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.768 Vali Acc: 0.856 Test Loss: 0.768 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7846450805664062
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.750 Vali Acc: 0.833 Test Loss: 0.750 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.7893178462982178
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.844 Vali Acc: 0.844 Test Loss: 0.844 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.6787772178649902
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.777 Vali Acc: 0.844 Test Loss: 0.777 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.682410478591919
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.845 Vali Acc: 0.856 Test Loss: 0.845 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.201995849609375
Epoch: 31, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.892 Vali Acc: 0.850 Test Loss: 0.892 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.6301088333129883
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.937 Vali Acc: 0.850 Test Loss: 0.937 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.631220579147339
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.813 Vali Acc: 0.844 Test Loss: 0.813 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.3633713722229004
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.807 Vali Acc: 0.861 Test Loss: 0.807 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.975205421447754
Epoch: 1, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.361 Vali Acc: 0.283 Test Loss: 2.361 Test Acc: 0.283
Validation loss decreased (inf --> -0.283310).  Saving model ...
Epoch: 2 cost time: 3.4064934253692627
Epoch: 2, Steps: 12 | Train Loss: 2.624 Vali Loss: 1.959 Vali Acc: 0.383 Test Loss: 1.959 Test Acc: 0.383
Validation loss decreased (-0.283310 --> -0.383314).  Saving model ...
Epoch: 3 cost time: 3.649925470352173
Epoch: 3, Steps: 12 | Train Loss: 2.368 Vali Loss: 1.693 Vali Acc: 0.483 Test Loss: 1.693 Test Acc: 0.483
Validation loss decreased (-0.383314 --> -0.483316).  Saving model ...
Epoch: 4 cost time: 3.538388729095459
Epoch: 4, Steps: 12 | Train Loss: 2.037 Vali Loss: 1.607 Vali Acc: 0.522 Test Loss: 1.607 Test Acc: 0.522
Validation loss decreased (-0.483316 --> -0.522206).  Saving model ...
Epoch: 5 cost time: 3.3215973377227783
Epoch: 5, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.465 Vali Acc: 0.544 Test Loss: 1.465 Test Acc: 0.544
Validation loss decreased (-0.522206 --> -0.544430).  Saving model ...
Epoch: 6 cost time: 3.449343204498291
Epoch: 6, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.274 Vali Acc: 0.572 Test Loss: 1.274 Test Acc: 0.572
Validation loss decreased (-0.544430 --> -0.572209).  Saving model ...
Epoch: 7 cost time: 3.545682668685913
Epoch: 7, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.024 Vali Acc: 0.672 Test Loss: 1.024 Test Acc: 0.672
Validation loss decreased (-0.572209 --> -0.672212).  Saving model ...
Epoch: 8 cost time: 3.448791265487671
Epoch: 8, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.009 Vali Acc: 0.706 Test Loss: 1.009 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 3.706176519393921
Epoch: 9, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.864 Vali Acc: 0.728 Test Loss: 0.864 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727769).  Saving model ...
Epoch: 10 cost time: 3.5560097694396973
Epoch: 10, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.790 Vali Acc: 0.739 Test Loss: 0.790 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 3.336306571960449
Epoch: 11, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.710 Vali Acc: 0.794 Test Loss: 0.710 Test Acc: 0.794
Validation loss decreased (-0.738881 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 3.828538179397583
Epoch: 12, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 3.5344417095184326
Epoch: 13, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.650 Vali Acc: 0.811 Test Loss: 0.650 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.874263048171997
Epoch: 14, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.634 Vali Acc: 0.817 Test Loss: 0.634 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.650345802307129
Epoch: 15, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6066970825195312
Epoch: 16, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 3.551664113998413
Epoch: 17, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.708 Vali Acc: 0.822 Test Loss: 0.708 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6988372802734375
Epoch: 18, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.684 Vali Acc: 0.817 Test Loss: 0.684 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.704784393310547
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.744 Vali Acc: 0.839 Test Loss: 0.744 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838881).  Saving model ...
Epoch: 20 cost time: 3.8294904232025146
Epoch: 20, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.710 Vali Acc: 0.794 Test Loss: 0.710 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.513279438018799
Epoch: 21, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.702 Vali Acc: 0.850 Test Loss: 0.702 Test Acc: 0.850
Validation loss decreased (-0.838881 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 3.5091397762298584
Epoch: 22, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.825 Vali Acc: 0.850 Test Loss: 0.825 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.406012535095215
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 3.46966814994812
Epoch: 24, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.867 Vali Acc: 0.856 Test Loss: 0.867 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855547).  Saving model ...
Epoch: 25 cost time: 3.8786585330963135
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.768 Vali Acc: 0.822 Test Loss: 0.768 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4274816513061523
Epoch: 26, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.799 Vali Acc: 0.867 Test Loss: 0.799 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866659).  Saving model ...
Epoch: 27 cost time: 3.5549213886260986
Epoch: 27, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.740 Vali Acc: 0.839 Test Loss: 0.740 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7131872177124023
Epoch: 28, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.728 Vali Acc: 0.867 Test Loss: 0.728 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 29 cost time: 3.766050100326538
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.729 Vali Acc: 0.839 Test Loss: 0.729 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.788271427154541
Epoch: 30, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.783 Vali Acc: 0.856 Test Loss: 0.783 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.033202171325684
Epoch: 31, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.741 Vali Acc: 0.839 Test Loss: 0.741 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.8691165447235107
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.738 Vali Acc: 0.850 Test Loss: 0.738 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.707937240600586
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.747 Vali Acc: 0.861 Test Loss: 0.747 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.856494665145874
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.784 Vali Acc: 0.856 Test Loss: 0.784 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.0043253898620605
Epoch: 35, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.792 Vali Acc: 0.856 Test Loss: 0.792 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.7843427658081055
Epoch: 36, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.834 Vali Acc: 0.844 Test Loss: 0.834 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.667769193649292
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.844 Test Loss: 0.843 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.6284854412078857
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.844 Test Loss: 0.830 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.234552383422852
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.442 Vali Acc: 0.239 Test Loss: 2.442 Test Acc: 0.239
Validation loss decreased (inf --> -0.238864).  Saving model ...
Epoch: 2 cost time: 3.7710072994232178
Epoch: 2, Steps: 12 | Train Loss: 2.662 Vali Loss: 1.978 Vali Acc: 0.406 Test Loss: 1.978 Test Acc: 0.406
Validation loss decreased (-0.238864 --> -0.405536).  Saving model ...
Epoch: 3 cost time: 3.7229180335998535
Epoch: 3, Steps: 12 | Train Loss: 2.408 Vali Loss: 1.682 Vali Acc: 0.522 Test Loss: 1.682 Test Acc: 0.522
Validation loss decreased (-0.405536 --> -0.522205).  Saving model ...
Epoch: 4 cost time: 3.5656955242156982
Epoch: 4, Steps: 12 | Train Loss: 2.075 Vali Loss: 1.592 Vali Acc: 0.506 Test Loss: 1.592 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.723085641860962
Epoch: 5, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.456 Vali Acc: 0.539 Test Loss: 1.456 Test Acc: 0.539
Validation loss decreased (-0.522205 --> -0.538874).  Saving model ...
Epoch: 6 cost time: 3.5431392192840576
Epoch: 6, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.278 Vali Acc: 0.611 Test Loss: 1.278 Test Acc: 0.611
Validation loss decreased (-0.538874 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 3.790598154067993
Epoch: 7, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.050 Vali Acc: 0.639 Test Loss: 1.050 Test Acc: 0.639
Validation loss decreased (-0.611098 --> -0.638878).  Saving model ...
Epoch: 8 cost time: 3.531632900238037
Epoch: 8, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.028 Vali Acc: 0.683 Test Loss: 1.028 Test Acc: 0.683
Validation loss decreased (-0.638878 --> -0.683323).  Saving model ...
Epoch: 9 cost time: 3.901785373687744
Epoch: 9, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.879 Vali Acc: 0.744 Test Loss: 0.879 Test Acc: 0.744
Validation loss decreased (-0.683323 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 3.618866443634033
Epoch: 10, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 3.547884702682495
Epoch: 11, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 3.5093183517456055
Epoch: 12, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (-0.783326 --> -0.811105).  Saving model ...
Epoch: 13 cost time: 3.7643911838531494
Epoch: 13, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.632 Vali Acc: 0.806 Test Loss: 0.632 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.493049383163452
Epoch: 14, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.629 Vali Acc: 0.806 Test Loss: 0.629 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.011828899383545
Epoch: 15, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6524412631988525
Epoch: 16, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.629 Vali Acc: 0.822 Test Loss: 0.629 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 3.5072529315948486
Epoch: 17, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.707 Vali Acc: 0.833 Test Loss: 0.707 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833326).  Saving model ...
Epoch: 18 cost time: 3.653576135635376
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.747 Vali Acc: 0.811 Test Loss: 0.747 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.640321969985962
Epoch: 19, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.753 Vali Acc: 0.833 Test Loss: 0.753 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4430317878723145
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.715 Vali Acc: 0.822 Test Loss: 0.715 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4336349964141846
Epoch: 21, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.705 Vali Acc: 0.817 Test Loss: 0.705 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.536508083343506
Epoch: 22, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.844 Vali Acc: 0.828 Test Loss: 0.844 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6587343215942383
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 3.927616834640503
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.811 Vali Acc: 0.839 Test Loss: 0.811 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.071765899658203
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.746 Vali Acc: 0.811 Test Loss: 0.746 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8803176879882812
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.806 Vali Acc: 0.872 Test Loss: 0.806 Test Acc: 0.872
Validation loss decreased (-0.844438 --> -0.872214).  Saving model ...
Epoch: 27 cost time: 3.7103469371795654
Epoch: 27, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.723 Vali Acc: 0.839 Test Loss: 0.723 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.678462028503418
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.816 Vali Acc: 0.833 Test Loss: 0.816 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6292636394500732
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.737 Vali Acc: 0.844 Test Loss: 0.737 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.574334144592285
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.782 Vali Acc: 0.856 Test Loss: 0.782 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.762240171432495
Epoch: 31, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.7308340072631836
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.791 Vali Acc: 0.844 Test Loss: 0.791 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.641700506210327
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.737 Vali Acc: 0.839 Test Loss: 0.737 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.5416929721832275
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.782 Vali Acc: 0.861 Test Loss: 0.782 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.5184552669525146
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.770 Vali Acc: 0.850 Test Loss: 0.770 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.547105073928833
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.861 Vali Acc: 0.856 Test Loss: 0.861 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.051780700683594
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.6836726665496826
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 4.09286642074585
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.776242733001709
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 3.7138378620147705
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 3.3490824699401855
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.633193016052246
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7719686031341553
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.798840284347534
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7406413555145264
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.6891298294067383
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.747886896133423
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.535731315612793
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3193509578704834
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.60444712638855
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 2349583
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.3568243980407715
Epoch: 1, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.447 Vali Acc: 0.328 Test Loss: 2.447 Test Acc: 0.328
Validation loss decreased (inf --> -0.327753).  Saving model ...
Epoch: 2 cost time: 3.4113755226135254
Epoch: 2, Steps: 12 | Train Loss: 2.151 Vali Loss: 1.854 Vali Acc: 0.556 Test Loss: 1.854 Test Acc: 0.556
Validation loss decreased (-0.327753 --> -0.555537).  Saving model ...
Epoch: 3 cost time: 3.6404664516448975
Epoch: 3, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.407 Vali Acc: 0.633 Test Loss: 1.407 Test Acc: 0.633
Validation loss decreased (-0.555537 --> -0.633319).  Saving model ...
Epoch: 4 cost time: 3.703380823135376
Epoch: 4, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.217 Vali Acc: 0.700 Test Loss: 1.217 Test Acc: 0.700
Validation loss decreased (-0.633319 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 3.6165146827697754
Epoch: 5, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
Validation loss decreased (-0.699988 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 3.577960729598999
Epoch: 6, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
Validation loss decreased (-0.727768 --> -0.788881).  Saving model ...
Epoch: 7 cost time: 3.8254384994506836
Epoch: 7, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.707 Vali Acc: 0.817 Test Loss: 0.707 Test Acc: 0.817
Validation loss decreased (-0.788881 --> -0.816660).  Saving model ...
Epoch: 8 cost time: 3.7025434970855713
Epoch: 8, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.597 Vali Acc: 0.817 Test Loss: 0.597 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 3.9764037132263184
Epoch: 9, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 3.828017234802246
Epoch: 10, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.833328 --> -0.866662).  Saving model ...
Epoch: 11 cost time: 3.8220601081848145
Epoch: 11, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 12 cost time: 3.6070754528045654
Epoch: 12, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.494 Vali Acc: 0.894 Test Loss: 0.494 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894440).  Saving model ...
Epoch: 13 cost time: 3.5363476276397705
Epoch: 13, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.443 Vali Acc: 0.856 Test Loss: 0.443 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.530651092529297
Epoch: 14, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.464 Vali Acc: 0.883 Test Loss: 0.464 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4803102016448975
Epoch: 15, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.458 Vali Acc: 0.883 Test Loss: 0.458 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.814531087875366
Epoch: 16, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.4656240940093994
Epoch: 17, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7628462314605713
Epoch: 18, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.6581172943115234
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.610 Vali Acc: 0.883 Test Loss: 0.610 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9499897956848145
Epoch: 20, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9641330242156982
Epoch: 21, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 3.909883737564087
Epoch: 22, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9110450744628906
Epoch: 23, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.547 Vali Acc: 0.906 Test Loss: 0.547 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905550).  Saving model ...
Epoch: 24 cost time: 4.0459394454956055
Epoch: 24, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.538 Vali Acc: 0.906 Test Loss: 0.538 Test Acc: 0.906
Validation loss decreased (-0.905550 --> -0.905550).  Saving model ...
Epoch: 25 cost time: 3.8475542068481445
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.527 Vali Acc: 0.894 Test Loss: 0.527 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.205991983413696
Epoch: 26, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.906 Test Loss: 0.515 Test Acc: 0.906
Validation loss decreased (-0.905550 --> -0.905550).  Saving model ...
Epoch: 27 cost time: 4.18359112739563
Epoch: 27, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.906 Test Loss: 0.519 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6868412494659424
Epoch: 28, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.4938721656799316
Epoch: 29, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.894 Test Loss: 0.552 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.6215431690216064
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.537522554397583
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4989676475524902
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.8807849884033203
Epoch: 33, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.554 Vali Acc: 0.906 Test Loss: 0.554 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.698744297027588
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.911 Test Loss: 0.553 Test Acc: 0.911
Validation loss decreased (-0.905550 --> -0.911106).  Saving model ...
Epoch: 35 cost time: 3.3723878860473633
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.549 Vali Acc: 0.911 Test Loss: 0.549 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 36 cost time: 3.8043627738952637
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.553 Vali Acc: 0.906 Test Loss: 0.553 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7589828968048096
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.906 Test Loss: 0.557 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.82889461517334
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.906 Test Loss: 0.562 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.5537242889404297
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.906 Test Loss: 0.570 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.654219150543213
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.906 Test Loss: 0.579 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.6330947875976562
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.906 Test Loss: 0.571 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.6439239978790283
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.906 Test Loss: 0.568 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.6876072883605957
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.906 Test Loss: 0.569 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.6814043521881104
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.906 Test Loss: 0.571 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.7456178665161133
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.906 Test Loss: 0.573 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.375866651535034
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.568 Vali Acc: 0.256 Test Loss: 2.568 Test Acc: 0.256
Validation loss decreased (inf --> -0.255530).  Saving model ...
Epoch: 2 cost time: 3.925124168395996
Epoch: 2, Steps: 12 | Train Loss: 2.304 Vali Loss: 2.050 Vali Acc: 0.494 Test Loss: 2.050 Test Acc: 0.494
Validation loss decreased (-0.255530 --> -0.494424).  Saving model ...
Epoch: 3 cost time: 3.4120688438415527
Epoch: 3, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.606 Vali Acc: 0.594 Test Loss: 1.606 Test Acc: 0.594
Validation loss decreased (-0.494424 --> -0.594428).  Saving model ...
Epoch: 4 cost time: 3.7468669414520264
Epoch: 4, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.395 Vali Acc: 0.589 Test Loss: 1.395 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5584492683410645
Epoch: 5, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.124 Vali Acc: 0.706 Test Loss: 1.124 Test Acc: 0.706
Validation loss decreased (-0.594428 --> -0.705544).  Saving model ...
Epoch: 6 cost time: 4.005911350250244
Epoch: 6, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.876 Vali Acc: 0.783 Test Loss: 0.876 Test Acc: 0.783
Validation loss decreased (-0.705544 --> -0.783325).  Saving model ...
Epoch: 7 cost time: 3.6190645694732666
Epoch: 7, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6736321449279785
Epoch: 8, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.692 Vali Acc: 0.806 Test Loss: 0.692 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805549).  Saving model ...
Epoch: 9 cost time: 3.9687817096710205
Epoch: 9, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 10 cost time: 3.8362221717834473
Epoch: 10, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.617 Vali Acc: 0.878 Test Loss: 0.617 Test Acc: 0.878
Validation loss decreased (-0.811105 --> -0.877772).  Saving model ...
Epoch: 11 cost time: 3.9986162185668945
Epoch: 11, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7494401931762695
Epoch: 12, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 13 cost time: 3.957159996032715
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6790504455566406
Epoch: 14, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.576 Vali Acc: 0.894 Test Loss: 0.576 Test Acc: 0.894
Validation loss decreased (-0.877772 --> -0.894439).  Saving model ...
Epoch: 15 cost time: 3.483698606491089
Epoch: 15, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.526 Vali Acc: 0.878 Test Loss: 0.526 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8466246128082275
Epoch: 16, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.629 Vali Acc: 0.889 Test Loss: 0.629 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.141988039016724
Epoch: 17, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.664 Vali Acc: 0.867 Test Loss: 0.664 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.697932481765747
Epoch: 18, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.708 Vali Acc: 0.878 Test Loss: 0.708 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.04417610168457
Epoch: 19, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7581627368927
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.789416790008545
Epoch: 21, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.626 Vali Acc: 0.883 Test Loss: 0.626 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.03692364692688
Epoch: 22, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.641808271408081
Epoch: 23, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 3.850969076156616
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.594 Vali Acc: 0.894 Test Loss: 0.594 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.275232553482056
Epoch: 25, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.617 Vali Acc: 0.883 Test Loss: 0.617 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8254008293151855
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.629 Vali Acc: 0.900 Test Loss: 0.629 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.494017601013184
Epoch: 27, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.906 Test Loss: 0.613 Test Acc: 0.906
Validation loss decreased (-0.899994 --> -0.905549).  Saving model ...
Epoch: 28 cost time: 3.9088149070739746
Epoch: 28, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.608 Vali Acc: 0.906 Test Loss: 0.608 Test Acc: 0.906
Validation loss decreased (-0.905549 --> -0.905549).  Saving model ...
Epoch: 29 cost time: 4.194727897644043
Epoch: 29, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.894 Test Loss: 0.621 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.9994661808013916
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.624 Vali Acc: 0.889 Test Loss: 0.624 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.804666519165039
Epoch: 31, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.037042140960693
Epoch: 32, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.906 Test Loss: 0.623 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.944105625152588
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.624 Vali Acc: 0.906 Test Loss: 0.624 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.3643951416015625
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.906 Test Loss: 0.633 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.089184522628784
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.906 Test Loss: 0.633 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.002831935882568
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.634 Vali Acc: 0.906 Test Loss: 0.634 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.756986141204834
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.889 Test Loss: 0.638 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.946434497833252
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.900 Test Loss: 0.629 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.146366357803345
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.624 Vali Acc: 0.139 Test Loss: 2.624 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 3.5689783096313477
Epoch: 2, Steps: 12 | Train Loss: 2.442 Vali Loss: 2.215 Vali Acc: 0.361 Test Loss: 2.215 Test Acc: 0.361
Validation loss decreased (-0.138863 --> -0.361089).  Saving model ...
Epoch: 3 cost time: 3.961897850036621
Epoch: 3, Steps: 12 | Train Loss: 2.043 Vali Loss: 1.830 Vali Acc: 0.456 Test Loss: 1.830 Test Acc: 0.456
Validation loss decreased (-0.361089 --> -0.455537).  Saving model ...
Epoch: 4 cost time: 3.871135711669922
Epoch: 4, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.587 Vali Acc: 0.572 Test Loss: 1.587 Test Acc: 0.572
Validation loss decreased (-0.455537 --> -0.572206).  Saving model ...
Epoch: 5 cost time: 3.8369786739349365
Epoch: 5, Steps: 12 | Train Loss: 1.302 Vali Loss: 1.276 Vali Acc: 0.633 Test Loss: 1.276 Test Acc: 0.633
Validation loss decreased (-0.572206 --> -0.633321).  Saving model ...
Epoch: 6 cost time: 3.8138556480407715
Epoch: 6, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.013 Vali Acc: 0.717 Test Loss: 1.013 Test Acc: 0.717
Validation loss decreased (-0.633321 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 3.6137571334838867
Epoch: 7, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.012 Vali Acc: 0.694 Test Loss: 1.012 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.918242931365967
Epoch: 8, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.884 Vali Acc: 0.717 Test Loss: 0.884 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 9 cost time: 3.714343547821045
Epoch: 9, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.796 Vali Acc: 0.756 Test Loss: 0.796 Test Acc: 0.756
Validation loss decreased (-0.716658 --> -0.755548).  Saving model ...
Epoch: 10 cost time: 4.078593730926514
Epoch: 10, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 11 cost time: 3.9007036685943604
Epoch: 11, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.647 Vali Acc: 0.794 Test Loss: 0.647 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794438).  Saving model ...
Epoch: 12 cost time: 3.8837571144104004
Epoch: 12, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827772).  Saving model ...
Epoch: 13 cost time: 3.8969225883483887
Epoch: 13, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.202941179275513
Epoch: 14, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844438).  Saving model ...
Epoch: 15 cost time: 4.058049917221069
Epoch: 15, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 4.036022663116455
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.708 Vali Acc: 0.844 Test Loss: 0.708 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.223322629928589
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.751 Vali Acc: 0.833 Test Loss: 0.751 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.290169715881348
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.709 Vali Acc: 0.861 Test Loss: 0.709 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861104).  Saving model ...
Epoch: 19 cost time: 4.1203413009643555
Epoch: 19, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.712 Vali Acc: 0.839 Test Loss: 0.712 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.3593034744262695
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.627 Vali Acc: 0.872 Test Loss: 0.627 Test Acc: 0.872
Validation loss decreased (-0.861104 --> -0.872216).  Saving model ...
Epoch: 21 cost time: 4.07685923576355
Epoch: 21, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.647 Vali Acc: 0.883 Test Loss: 0.647 Test Acc: 0.883
Validation loss decreased (-0.872216 --> -0.883327).  Saving model ...
Epoch: 22 cost time: 4.150981426239014
Epoch: 22, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.755 Vali Acc: 0.856 Test Loss: 0.755 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.21435809135437
Epoch: 23, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.779 Vali Acc: 0.883 Test Loss: 0.779 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.9688103199005127
Epoch: 24, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.642 Vali Acc: 0.878 Test Loss: 0.642 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.857250690460205
Epoch: 25, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.696 Vali Acc: 0.878 Test Loss: 0.696 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.9225006103515625
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.883 Test Loss: 0.618 Test Acc: 0.883
Validation loss decreased (-0.883327 --> -0.883327).  Saving model ...
Epoch: 27 cost time: 3.4837806224823
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.869 Vali Acc: 0.844 Test Loss: 0.869 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.799661159515381
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.622 Vali Acc: 0.878 Test Loss: 0.622 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.4516284465789795
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.618 Vali Acc: 0.883 Test Loss: 0.618 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.911792278289795
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.7368836402893066
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.878 Test Loss: 0.647 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.032049655914307
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.630 Vali Acc: 0.889 Test Loss: 0.630 Test Acc: 0.889
Validation loss decreased (-0.883327 --> -0.888883).  Saving model ...
Epoch: 33 cost time: 4.471144914627075
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.208632230758667
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.193591833114624
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.878 Test Loss: 0.720 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.288694620132446
Epoch: 36, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.709 Vali Acc: 0.872 Test Loss: 0.709 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.28002667427063
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.883 Test Loss: 0.710 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.423833847045898
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.878 Test Loss: 0.701 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.8598413467407227
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.878 Test Loss: 0.705 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.156942129135132
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.878 Test Loss: 0.709 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.706179141998291
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.883 Test Loss: 0.707 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.576723337173462
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.889 Test Loss: 0.713 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.634263038635254
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.610 Vali Acc: 0.117 Test Loss: 2.610 Test Acc: 0.117
Validation loss decreased (inf --> -0.116641).  Saving model ...
Epoch: 2 cost time: 3.8861985206604004
Epoch: 2, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.320 Vali Acc: 0.211 Test Loss: 2.320 Test Acc: 0.211
Validation loss decreased (-0.116641 --> -0.211088).  Saving model ...
Epoch: 3 cost time: 3.887726306915283
Epoch: 3, Steps: 12 | Train Loss: 2.219 Vali Loss: 2.008 Vali Acc: 0.356 Test Loss: 2.008 Test Acc: 0.356
Validation loss decreased (-0.211088 --> -0.355535).  Saving model ...
Epoch: 4 cost time: 3.950512647628784
Epoch: 4, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.721 Vali Acc: 0.456 Test Loss: 1.721 Test Acc: 0.456
Validation loss decreased (-0.355535 --> -0.455538).  Saving model ...
Epoch: 5 cost time: 3.8128411769866943
Epoch: 5, Steps: 12 | Train Loss: 1.496 Vali Loss: 1.335 Vali Acc: 0.622 Test Loss: 1.335 Test Acc: 0.622
Validation loss decreased (-0.455538 --> -0.622209).  Saving model ...
Epoch: 6 cost time: 4.063781976699829
Epoch: 6, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.094 Vali Acc: 0.672 Test Loss: 1.094 Test Acc: 0.672
Validation loss decreased (-0.622209 --> -0.672211).  Saving model ...
Epoch: 7 cost time: 3.9646213054656982
Epoch: 7, Steps: 12 | Train Loss: 0.851 Vali Loss: 1.032 Vali Acc: 0.711 Test Loss: 1.032 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711101).  Saving model ...
Epoch: 8 cost time: 3.9733893871307373
Epoch: 8, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.928 Vali Acc: 0.706 Test Loss: 0.928 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8167216777801514
Epoch: 9, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722214).  Saving model ...
Epoch: 10 cost time: 3.9805655479431152
Epoch: 10, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.806 Vali Acc: 0.739 Test Loss: 0.806 Test Acc: 0.739
Validation loss decreased (-0.722214 --> -0.738881).  Saving model ...
Epoch: 11 cost time: 3.7002081871032715
Epoch: 11, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
Validation loss decreased (-0.738881 --> -0.783326).  Saving model ...
Epoch: 12 cost time: 3.835400104522705
Epoch: 12, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788883).  Saving model ...
Epoch: 13 cost time: 3.5317814350128174
Epoch: 13, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.695 Vali Acc: 0.806 Test Loss: 0.695 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 3.4596965312957764
Epoch: 14, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 3.4781696796417236
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 3.4823102951049805
Epoch: 16, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.813 Vali Acc: 0.794 Test Loss: 0.813 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7910196781158447
Epoch: 17, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.809 Vali Acc: 0.806 Test Loss: 0.809 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7536587715148926
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.792 Vali Acc: 0.800 Test Loss: 0.792 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.725785493850708
Epoch: 19, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.705 Vali Acc: 0.828 Test Loss: 0.705 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.2108354568481445
Epoch: 20, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.740 Vali Acc: 0.839 Test Loss: 0.740 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.818187952041626
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.939178705215454
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.766 Vali Acc: 0.839 Test Loss: 0.766 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.747218132019043
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.782 Vali Acc: 0.839 Test Loss: 0.782 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.186990737915039
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.623 Vali Acc: 0.839 Test Loss: 0.623 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7263131141662598
Epoch: 25, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.665 Vali Acc: 0.861 Test Loss: 0.665 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 26 cost time: 3.8453140258789062
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.707 Vali Acc: 0.856 Test Loss: 0.707 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.6420485973358154
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.798 Vali Acc: 0.850 Test Loss: 0.798 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.914506196975708
Epoch: 28, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6278462409973145
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.572359561920166
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.734 Vali Acc: 0.867 Test Loss: 0.734 Test Acc: 0.867
Validation loss decreased (-0.861104 --> -0.866659).  Saving model ...
Epoch: 31 cost time: 3.6898605823516846
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.716 Vali Acc: 0.861 Test Loss: 0.716 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.097830295562744
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.779 Vali Acc: 0.878 Test Loss: 0.779 Test Acc: 0.878
Validation loss decreased (-0.866659 --> -0.877770).  Saving model ...
Epoch: 33 cost time: 3.9225094318389893
Epoch: 33, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.750 Vali Acc: 0.878 Test Loss: 0.750 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 34 cost time: 4.011925458908081
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.883 Test Loss: 0.728 Test Acc: 0.883
Validation loss decreased (-0.877770 --> -0.883326).  Saving model ...
Epoch: 35 cost time: 4.147688865661621
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.741 Vali Acc: 0.878 Test Loss: 0.741 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.250471115112305
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.883 Test Loss: 0.733 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.227359056472778
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.883 Test Loss: 0.730 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.953840494155884
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.883 Test Loss: 0.743 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.7912964820861816
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.889 Test Loss: 0.749 Test Acc: 0.889
Validation loss decreased (-0.883326 --> -0.888881).  Saving model ...
Epoch: 40 cost time: 4.126406908035278
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.883 Test Loss: 0.744 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.006419658660889
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.883 Test Loss: 0.741 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.6062934398651123
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.883 Test Loss: 0.748 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.614682912826538
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.883 Test Loss: 0.753 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.4756016731262207
Epoch: 44, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.740 Vali Acc: 0.872 Test Loss: 0.740 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.4364545345306396
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.883 Test Loss: 0.751 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.9378557205200195
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.889 Test Loss: 0.771 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.634840250015259
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.889 Test Loss: 0.771 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.4467175006866455
Epoch: 48, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.889 Test Loss: 0.776 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.748277425765991
Epoch: 49, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.878 Test Loss: 0.766 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.487492322921753
Epoch: 1, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.523 Vali Acc: 0.189 Test Loss: 2.523 Test Acc: 0.189
Validation loss decreased (inf --> -0.188864).  Saving model ...
Epoch: 2 cost time: 3.775428533554077
Epoch: 2, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.113 Vali Acc: 0.300 Test Loss: 2.113 Test Acc: 0.300
Validation loss decreased (-0.188864 --> -0.299979).  Saving model ...
Epoch: 3 cost time: 3.6565442085266113
Epoch: 3, Steps: 12 | Train Loss: 2.342 Vali Loss: 1.854 Vali Acc: 0.400 Test Loss: 1.854 Test Acc: 0.400
Validation loss decreased (-0.299979 --> -0.399981).  Saving model ...
Epoch: 4 cost time: 3.703852891921997
Epoch: 4, Steps: 12 | Train Loss: 1.954 Vali Loss: 1.714 Vali Acc: 0.528 Test Loss: 1.714 Test Acc: 0.528
Validation loss decreased (-0.399981 --> -0.527761).  Saving model ...
Epoch: 5 cost time: 3.649725914001465
Epoch: 5, Steps: 12 | Train Loss: 1.613 Vali Loss: 1.403 Vali Acc: 0.572 Test Loss: 1.403 Test Acc: 0.572
Validation loss decreased (-0.527761 --> -0.572208).  Saving model ...
Epoch: 6 cost time: 3.65181827545166
Epoch: 6, Steps: 12 | Train Loss: 1.184 Vali Loss: 1.251 Vali Acc: 0.606 Test Loss: 1.251 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605543).  Saving model ...
Epoch: 7 cost time: 3.600966215133667
Epoch: 7, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.131 Vali Acc: 0.617 Test Loss: 1.131 Test Acc: 0.617
Validation loss decreased (-0.605543 --> -0.616655).  Saving model ...
Epoch: 8 cost time: 4.043500185012817
Epoch: 8, Steps: 12 | Train Loss: 0.783 Vali Loss: 0.999 Vali Acc: 0.678 Test Loss: 0.999 Test Acc: 0.678
Validation loss decreased (-0.616655 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 3.730518102645874
Epoch: 9, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.903 Vali Acc: 0.706 Test Loss: 0.903 Test Acc: 0.706
Validation loss decreased (-0.677768 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 3.691593647003174
Epoch: 10, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.908 Vali Acc: 0.722 Test Loss: 0.908 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 3.632627248764038
Epoch: 11, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.806 Vali Acc: 0.711 Test Loss: 0.806 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7751553058624268
Epoch: 12, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
Validation loss decreased (-0.722213 --> -0.783326).  Saving model ...
Epoch: 13 cost time: 3.995955467224121
Epoch: 13, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.768 Vali Acc: 0.789 Test Loss: 0.768 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 3.666506290435791
Epoch: 14, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
Validation loss decreased (-0.788881 --> -0.838882).  Saving model ...
Epoch: 15 cost time: 3.5855023860931396
Epoch: 15, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.727 Vali Acc: 0.800 Test Loss: 0.727 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.867443084716797
Epoch: 16, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.833 Vali Acc: 0.806 Test Loss: 0.833 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.673164129257202
Epoch: 17, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.842 Vali Acc: 0.811 Test Loss: 0.842 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.0625224113464355
Epoch: 18, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.835 Vali Acc: 0.817 Test Loss: 0.835 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.2059831619262695
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.747 Vali Acc: 0.833 Test Loss: 0.747 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.982436418533325
Epoch: 20, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.704 Vali Acc: 0.839 Test Loss: 0.704 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.773075819015503
Epoch: 21, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.691 Vali Acc: 0.833 Test Loss: 0.691 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.183552503585815
Epoch: 22, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.695 Vali Acc: 0.833 Test Loss: 0.695 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.550694465637207
Epoch: 23, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.767 Vali Acc: 0.839 Test Loss: 0.767 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.808457612991333
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.679 Vali Acc: 0.872 Test Loss: 0.679 Test Acc: 0.872
Validation loss decreased (-0.838882 --> -0.872215).  Saving model ...
Epoch: 25 cost time: 3.7662017345428467
Epoch: 25, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.686 Vali Acc: 0.867 Test Loss: 0.686 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.6323964595794678
Epoch: 26, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.690 Vali Acc: 0.856 Test Loss: 0.690 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.610391855239868
Epoch: 27, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.935 Vali Acc: 0.850 Test Loss: 0.935 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.143154859542847
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.765 Vali Acc: 0.872 Test Loss: 0.765 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.0220115184783936
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.733 Vali Acc: 0.856 Test Loss: 0.733 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.9709725379943848
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.720 Vali Acc: 0.867 Test Loss: 0.720 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.7429559230804443
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.712 Vali Acc: 0.878 Test Loss: 0.712 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877771).  Saving model ...
Epoch: 32 cost time: 3.7685916423797607
Epoch: 32, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.787 Vali Acc: 0.867 Test Loss: 0.787 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.133599042892456
Epoch: 33, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.776 Vali Acc: 0.872 Test Loss: 0.776 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.1837849617004395
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.799 Vali Acc: 0.861 Test Loss: 0.799 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.237944841384888
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.819 Vali Acc: 0.867 Test Loss: 0.819 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.9661219120025635
Epoch: 36, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.805 Vali Acc: 0.867 Test Loss: 0.805 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.696449041366577
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.867 Test Loss: 0.806 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.6620538234710693
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.872 Test Loss: 0.816 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.544552803039551
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.878 Test Loss: 0.805 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.7500405311584473
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.878 Test Loss: 0.809 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.598951578140259
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.878 Test Loss: 0.810 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.375935792922974
Epoch: 1, Steps: 12 | Train Loss: 2.712 Vali Loss: 2.291 Vali Acc: 0.283 Test Loss: 2.291 Test Acc: 0.283
Validation loss decreased (inf --> -0.283310).  Saving model ...
Epoch: 2 cost time: 3.7040836811065674
Epoch: 2, Steps: 12 | Train Loss: 2.570 Vali Loss: 1.943 Vali Acc: 0.411 Test Loss: 1.943 Test Acc: 0.411
Validation loss decreased (-0.283310 --> -0.411092).  Saving model ...
Epoch: 3 cost time: 4.02753472328186
Epoch: 3, Steps: 12 | Train Loss: 2.336 Vali Loss: 1.785 Vali Acc: 0.428 Test Loss: 1.785 Test Acc: 0.428
Validation loss decreased (-0.411092 --> -0.427760).  Saving model ...
Epoch: 4 cost time: 3.83062744140625
Epoch: 4, Steps: 12 | Train Loss: 2.045 Vali Loss: 1.715 Vali Acc: 0.478 Test Loss: 1.715 Test Acc: 0.478
Validation loss decreased (-0.427760 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 3.64028263092041
Epoch: 5, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.440 Vali Acc: 0.550 Test Loss: 1.440 Test Acc: 0.550
Validation loss decreased (-0.477761 --> -0.549986).  Saving model ...
Epoch: 6 cost time: 3.9541807174682617
Epoch: 6, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.282 Vali Acc: 0.594 Test Loss: 1.282 Test Acc: 0.594
Validation loss decreased (-0.549986 --> -0.594432).  Saving model ...
Epoch: 7 cost time: 3.8952836990356445
Epoch: 7, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.140 Vali Acc: 0.667 Test Loss: 1.140 Test Acc: 0.667
Validation loss decreased (-0.594432 --> -0.666655).  Saving model ...
Epoch: 8 cost time: 3.6033897399902344
Epoch: 8, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.024 Vali Acc: 0.661 Test Loss: 1.024 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8711187839508057
Epoch: 9, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.898 Vali Acc: 0.706 Test Loss: 0.898 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705547).  Saving model ...
Epoch: 10 cost time: 4.132827520370483
Epoch: 10, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.868 Vali Acc: 0.683 Test Loss: 0.868 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5182604789733887
Epoch: 11, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.740 Vali Acc: 0.728 Test Loss: 0.740 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 3.674112558364868
Epoch: 12, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
Validation loss decreased (-0.727770 --> -0.788882).  Saving model ...
Epoch: 13 cost time: 3.5342905521392822
Epoch: 13, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 3.5175230503082275
Epoch: 14, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 3.672969341278076
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.677 Vali Acc: 0.822 Test Loss: 0.677 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.597355365753174
Epoch: 16, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.752 Vali Acc: 0.833 Test Loss: 0.752 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6742324829101562
Epoch: 17, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.796 Vali Acc: 0.828 Test Loss: 0.796 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8112030029296875
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.796 Vali Acc: 0.844 Test Loss: 0.796 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.9736618995666504
Epoch: 19, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.760 Vali Acc: 0.828 Test Loss: 0.760 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.038866281509399
Epoch: 20, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.072784423828125
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.141995668411255
Epoch: 22, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.069728851318359
Epoch: 23, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.710 Vali Acc: 0.872 Test Loss: 0.710 Test Acc: 0.872
Validation loss decreased (-0.849993 --> -0.872215).  Saving model ...
Epoch: 24 cost time: 4.223880052566528
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8563528060913086
Epoch: 25, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.741 Vali Acc: 0.828 Test Loss: 0.741 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.386061668395996
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.690 Vali Acc: 0.867 Test Loss: 0.690 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.915123701095581
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.717 Vali Acc: 0.867 Test Loss: 0.717 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9589037895202637
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.705 Vali Acc: 0.861 Test Loss: 0.705 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.6043412685394287
Epoch: 29, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.9949398040771484
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.715 Vali Acc: 0.872 Test Loss: 0.715 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.7522714138031006
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.872 Test Loss: 0.688 Test Acc: 0.872
Validation loss decreased (-0.872215 --> -0.872215).  Saving model ...
Epoch: 32 cost time: 3.6459574699401855
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.872 Test Loss: 0.690 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5174076557159424
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.867 Test Loss: 0.697 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.006361961364746
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.810480833053589
Epoch: 35, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.880676031112671
Epoch: 36, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.872 Test Loss: 0.693 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.7911536693573
Epoch: 37, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
Validation loss decreased (-0.872215 --> -0.877771).  Saving model ...
Epoch: 38 cost time: 3.832749843597412
Epoch: 38, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.878 Test Loss: 0.707 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.022866249084473
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.878 Test Loss: 0.705 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.9422950744628906
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.310485601425171
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.878 Test Loss: 0.706 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.82383131980896
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.878 Test Loss: 0.702 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 43 cost time: 3.908137083053589
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.878 Test Loss: 0.701 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 44 cost time: 3.8072760105133057
Epoch: 44, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.8312151432037354
Epoch: 45, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.867 Test Loss: 0.709 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.64369535446167
Epoch: 46, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.883 Test Loss: 0.714 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 47 cost time: 3.8466737270355225
Epoch: 47, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.883 Test Loss: 0.730 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.103834867477417
Epoch: 48, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.734 Vali Acc: 0.883 Test Loss: 0.734 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.8007893562316895
Epoch: 49, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.883 Test Loss: 0.730 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 4.463974714279175
Epoch: 50, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.722285032272339
Epoch: 51, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.878 Test Loss: 0.731 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 4.013818025588989
Epoch: 52, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.883 Test Loss: 0.735 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 4.347346067428589
Epoch: 53, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.883 Test Loss: 0.736 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 4.114673376083374
Epoch: 54, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.878 Test Loss: 0.736 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.8356096744537354
Epoch: 55, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.872 Test Loss: 0.732 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.839505910873413
Epoch: 56, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.733 Vali Acc: 0.867 Test Loss: 0.733 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.441892623901367
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.421 Vali Acc: 0.233 Test Loss: 2.421 Test Acc: 0.233
Validation loss decreased (inf --> -0.233309).  Saving model ...
Epoch: 2 cost time: 3.5397751331329346
Epoch: 2, Steps: 12 | Train Loss: 2.575 Vali Loss: 1.972 Vali Acc: 0.372 Test Loss: 1.972 Test Acc: 0.372
Validation loss decreased (-0.233309 --> -0.372202).  Saving model ...
Epoch: 3 cost time: 3.9527664184570312
Epoch: 3, Steps: 12 | Train Loss: 2.405 Vali Loss: 1.798 Vali Acc: 0.428 Test Loss: 1.798 Test Acc: 0.428
Validation loss decreased (-0.372202 --> -0.427760).  Saving model ...
Epoch: 4 cost time: 3.7395308017730713
Epoch: 4, Steps: 12 | Train Loss: 2.092 Vali Loss: 1.732 Vali Acc: 0.500 Test Loss: 1.732 Test Acc: 0.500
Validation loss decreased (-0.427760 --> -0.499983).  Saving model ...
Epoch: 5 cost time: 4.2573082447052
Epoch: 5, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.469 Vali Acc: 0.567 Test Loss: 1.469 Test Acc: 0.567
Validation loss decreased (-0.499983 --> -0.566652).  Saving model ...
Epoch: 6 cost time: 3.680239200592041
Epoch: 6, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.311 Vali Acc: 0.578 Test Loss: 1.311 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577765).  Saving model ...
Epoch: 7 cost time: 3.751504898071289
Epoch: 7, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.146 Vali Acc: 0.672 Test Loss: 1.146 Test Acc: 0.672
Validation loss decreased (-0.577765 --> -0.672211).  Saving model ...
Epoch: 8 cost time: 3.88447904586792
Epoch: 8, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.020 Vali Acc: 0.678 Test Loss: 1.020 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677768).  Saving model ...
Epoch: 9 cost time: 3.87982439994812
Epoch: 9, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
Validation loss decreased (-0.677768 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 4.012819051742554
Epoch: 10, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.890 Vali Acc: 0.672 Test Loss: 0.890 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.810058832168579
Epoch: 11, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.725 Vali Acc: 0.767 Test Loss: 0.725 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766659).  Saving model ...
Epoch: 12 cost time: 3.837057590484619
Epoch: 12, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
Validation loss decreased (-0.766659 --> -0.805549).  Saving model ...
Epoch: 13 cost time: 3.9108805656433105
Epoch: 13, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.746 Vali Acc: 0.806 Test Loss: 0.746 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.133885860443115
Epoch: 14, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.672 Vali Acc: 0.856 Test Loss: 0.672 Test Acc: 0.856
Validation loss decreased (-0.805549 --> -0.855549).  Saving model ...
Epoch: 15 cost time: 4.115195274353027
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.658 Vali Acc: 0.817 Test Loss: 0.658 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.322049856185913
Epoch: 16, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.740 Vali Acc: 0.806 Test Loss: 0.740 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.060369491577148
Epoch: 17, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.778 Vali Acc: 0.833 Test Loss: 0.778 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.06059718132019
Epoch: 18, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.778 Vali Acc: 0.839 Test Loss: 0.778 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.804473638534546
Epoch: 19, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.721 Vali Acc: 0.839 Test Loss: 0.721 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.0251429080963135
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.693 Vali Acc: 0.844 Test Loss: 0.693 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6943094730377197
Epoch: 21, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.089293718338013
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.661 Vali Acc: 0.850 Test Loss: 0.661 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.1025238037109375
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872216).  Saving model ...
Epoch: 24 cost time: 4.146238327026367
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.994190216064453
Epoch: 25, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.753 Vali Acc: 0.872 Test Loss: 0.753 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.111768960952759
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.671 Vali Acc: 0.878 Test Loss: 0.671 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 27 cost time: 4.340368032455444
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5882627964019775
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.705 Vali Acc: 0.867 Test Loss: 0.705 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.024378776550293
Epoch: 29, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.158627271652222
Epoch: 30, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.725 Vali Acc: 0.867 Test Loss: 0.725 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.409593820571899
Epoch: 31, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.694 Vali Acc: 0.872 Test Loss: 0.694 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.04184103012085
Epoch: 32, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.883 Test Loss: 0.712 Test Acc: 0.883
Validation loss decreased (-0.877771 --> -0.883326).  Saving model ...
Epoch: 33 cost time: 3.7672624588012695
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.6934475898742676
Epoch: 34, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.861 Test Loss: 0.696 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.87320613861084
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.872 Test Loss: 0.698 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.7371883392333984
Epoch: 36, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.668015718460083
Epoch: 37, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.867 Test Loss: 0.709 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.5286026000976562
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.711 Vali Acc: 0.872 Test Loss: 0.711 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.6982643604278564
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.872 Test Loss: 0.721 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.8178935050964355
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.867 Test Loss: 0.717 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.8035244941711426
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.714 Vali Acc: 0.872 Test Loss: 0.714 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.9339470863342285
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.872 Test Loss: 0.712 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.566078424453735
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.8549978733062744
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9290659427642822
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.655848741531372
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.719527244567871
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.634321928024292
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.626669406890869
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.7354795932769775
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4659154415130615
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5133862495422363
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5185811519622803
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5576395988464355
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.653414011001587
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.847433567047119
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.9994966983795166
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.457803964614868
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 17 cost time: 4.279323577880859
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 18 cost time: 3.6981701850891113
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.075979709625244
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 20 cost time: 3.817483901977539
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 21 cost time: 3.87870192527771
Epoch: 21, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.874082326889038
Epoch: 22, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6677045822143555
Epoch: 23, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.037126302719116
Epoch: 24, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.9504940509796143
Epoch: 25, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.573038339614868
Epoch: 26, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.69050931930542
Epoch: 27, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.4922194480895996
Epoch: 28, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.9550070762634277
Epoch: 29, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.09110689163208
Epoch: 30, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 2152975
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.719748020172119
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.531 Vali Acc: 0.172 Test Loss: 2.531 Test Acc: 0.172
Validation loss decreased (inf --> -0.172197).  Saving model ...
Epoch: 2 cost time: 3.8969340324401855
Epoch: 2, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.046 Vali Acc: 0.556 Test Loss: 2.046 Test Acc: 0.556
Validation loss decreased (-0.172197 --> -0.555535).  Saving model ...
Epoch: 3 cost time: 3.939182758331299
Epoch: 3, Steps: 12 | Train Loss: 1.901 Vali Loss: 1.650 Vali Acc: 0.611 Test Loss: 1.650 Test Acc: 0.611
Validation loss decreased (-0.555535 --> -0.611095).  Saving model ...
Epoch: 4 cost time: 3.9311344623565674
Epoch: 4, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.378 Vali Acc: 0.650 Test Loss: 1.378 Test Acc: 0.650
Validation loss decreased (-0.611095 --> -0.649986).  Saving model ...
Epoch: 5 cost time: 3.5730838775634766
Epoch: 5, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.167 Vali Acc: 0.667 Test Loss: 1.167 Test Acc: 0.667
Validation loss decreased (-0.649986 --> -0.666655).  Saving model ...
Epoch: 6 cost time: 3.7753326892852783
Epoch: 6, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.005 Vali Acc: 0.717 Test Loss: 1.005 Test Acc: 0.717
Validation loss decreased (-0.666655 --> -0.716657).  Saving model ...
Epoch: 7 cost time: 3.6395421028137207
Epoch: 7, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.825 Vali Acc: 0.756 Test Loss: 0.825 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755547).  Saving model ...
Epoch: 8 cost time: 3.6266329288482666
Epoch: 8, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.728 Vali Acc: 0.772 Test Loss: 0.728 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772215).  Saving model ...
Epoch: 9 cost time: 3.6656999588012695
Epoch: 9, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805549).  Saving model ...
Epoch: 10 cost time: 3.574470043182373
Epoch: 10, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 3.7205452919006348
Epoch: 11, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 3.6906564235687256
Epoch: 12, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 3.444664716720581
Epoch: 13, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.447 Vali Acc: 0.861 Test Loss: 0.447 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861107).  Saving model ...
Epoch: 14 cost time: 3.7531955242156982
Epoch: 14, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.430 Vali Acc: 0.889 Test Loss: 0.430 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 15 cost time: 3.5802574157714844
Epoch: 15, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.398 Vali Acc: 0.872 Test Loss: 0.398 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.778384208679199
Epoch: 16, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 3.7211802005767822
Epoch: 17, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.424 Vali Acc: 0.883 Test Loss: 0.424 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.774798631668091
Epoch: 18, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.716365337371826
Epoch: 19, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.410 Vali Acc: 0.894 Test Loss: 0.410 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 20 cost time: 3.6991326808929443
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.427 Vali Acc: 0.883 Test Loss: 0.427 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.01890230178833
Epoch: 21, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.420 Vali Acc: 0.883 Test Loss: 0.420 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.849489212036133
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.613682746887207
Epoch: 23, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.436 Vali Acc: 0.883 Test Loss: 0.436 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.927914619445801
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 3.780529022216797
Epoch: 25, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.439 Vali Acc: 0.878 Test Loss: 0.439 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.657297134399414
Epoch: 26, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.457 Vali Acc: 0.878 Test Loss: 0.457 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8719379901885986
Epoch: 27, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.440 Vali Acc: 0.894 Test Loss: 0.440 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.631507158279419
Epoch: 28, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.429 Vali Acc: 0.878 Test Loss: 0.429 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.808438539505005
Epoch: 29, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.4667365550994873
Epoch: 30, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.463 Vali Acc: 0.878 Test Loss: 0.463 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.852781295776367
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.466 Vali Acc: 0.894 Test Loss: 0.466 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.8851304054260254
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.460 Vali Acc: 0.894 Test Loss: 0.460 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.7375099658966064
Epoch: 33, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.803406238555908
Epoch: 34, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.481 Vali Acc: 0.889 Test Loss: 0.481 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.913999795913696
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.669 Vali Acc: 0.039 Test Loss: 2.669 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 3.838392734527588
Epoch: 2, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.244 Vali Acc: 0.450 Test Loss: 2.244 Test Acc: 0.450
Validation loss decreased (-0.038862 --> -0.449978).  Saving model ...
Epoch: 3 cost time: 3.409626007080078
Epoch: 3, Steps: 12 | Train Loss: 2.086 Vali Loss: 1.874 Vali Acc: 0.528 Test Loss: 1.874 Test Acc: 0.528
Validation loss decreased (-0.449978 --> -0.527759).  Saving model ...
Epoch: 4 cost time: 3.6856672763824463
Epoch: 4, Steps: 12 | Train Loss: 1.664 Vali Loss: 1.596 Vali Acc: 0.600 Test Loss: 1.596 Test Acc: 0.600
Validation loss decreased (-0.527759 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 3.61877703666687
Epoch: 5, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.367 Vali Acc: 0.611 Test Loss: 1.367 Test Acc: 0.611
Validation loss decreased (-0.599984 --> -0.611097).  Saving model ...
Epoch: 6 cost time: 3.764492988586426
Epoch: 6, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.180 Vali Acc: 0.678 Test Loss: 1.180 Test Acc: 0.678
Validation loss decreased (-0.611097 --> -0.677766).  Saving model ...
Epoch: 7 cost time: 3.754197120666504
Epoch: 7, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.970 Vali Acc: 0.733 Test Loss: 0.970 Test Acc: 0.733
Validation loss decreased (-0.677766 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 3.596135377883911
Epoch: 8, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.862 Vali Acc: 0.767 Test Loss: 0.862 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 9 cost time: 3.7688446044921875
Epoch: 9, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
Validation loss decreased (-0.766658 --> -0.805548).  Saving model ...
Epoch: 10 cost time: 3.8515396118164062
Epoch: 10, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.627 Vali Acc: 0.839 Test Loss: 0.627 Test Acc: 0.839
Validation loss decreased (-0.805548 --> -0.838883).  Saving model ...
Epoch: 11 cost time: 3.788902759552002
Epoch: 11, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866661).  Saving model ...
Epoch: 12 cost time: 4.184560060501099
Epoch: 12, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.70021653175354
Epoch: 13, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888884).  Saving model ...
Epoch: 14 cost time: 3.964625358581543
Epoch: 14, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 3.8230676651000977
Epoch: 15, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.718183755874634
Epoch: 16, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.97503924369812
Epoch: 17, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4212429523468018
Epoch: 18, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5198891162872314
Epoch: 19, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 3.5564208030700684
Epoch: 20, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.769333600997925
Epoch: 21, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6151976585388184
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5932209491729736
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.505 Vali Acc: 0.883 Test Loss: 0.505 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4493625164031982
Epoch: 24, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.512 Vali Acc: 0.883 Test Loss: 0.512 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.173322916030884
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.6255300045013428
Epoch: 26, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.639915943145752
Epoch: 27, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.536 Vali Acc: 0.883 Test Loss: 0.536 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.9992117881774902
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.7478675842285156
Epoch: 29, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.521 Vali Acc: 0.883 Test Loss: 0.521 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.522563457489014
Epoch: 1, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.729 Vali Acc: 0.033 Test Loss: 2.729 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 3.938706874847412
Epoch: 2, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.387 Vali Acc: 0.250 Test Loss: 2.387 Test Acc: 0.250
Validation loss decreased (-0.033306 --> -0.249976).  Saving model ...
Epoch: 3 cost time: 3.769745111465454
Epoch: 3, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.084 Vali Acc: 0.389 Test Loss: 2.084 Test Acc: 0.389
Validation loss decreased (-0.249976 --> -0.388868).  Saving model ...
Epoch: 4 cost time: 3.7599923610687256
Epoch: 4, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.830 Vali Acc: 0.489 Test Loss: 1.830 Test Acc: 0.489
Validation loss decreased (-0.388868 --> -0.488871).  Saving model ...
Epoch: 5 cost time: 3.667851686477661
Epoch: 5, Steps: 12 | Train Loss: 1.650 Vali Loss: 1.613 Vali Acc: 0.489 Test Loss: 1.613 Test Acc: 0.489
Validation loss decreased (-0.488871 --> -0.488873).  Saving model ...
Epoch: 6 cost time: 3.837554931640625
Epoch: 6, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.413 Vali Acc: 0.556 Test Loss: 1.413 Test Acc: 0.556
Validation loss decreased (-0.488873 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 3.5456607341766357
Epoch: 7, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.179 Vali Acc: 0.639 Test Loss: 1.179 Test Acc: 0.639
Validation loss decreased (-0.555541 --> -0.638877).  Saving model ...
Epoch: 8 cost time: 3.7891461849212646
Epoch: 8, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 3.58697247505188
Epoch: 9, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.897 Vali Acc: 0.717 Test Loss: 0.897 Test Acc: 0.717
Validation loss decreased (-0.649989 --> -0.716658).  Saving model ...
Epoch: 10 cost time: 3.791224718093872
Epoch: 10, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.789 Vali Acc: 0.783 Test Loss: 0.789 Test Acc: 0.783
Validation loss decreased (-0.716658 --> -0.783325).  Saving model ...
Epoch: 11 cost time: 4.001755475997925
Epoch: 11, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 4.031250953674316
Epoch: 12, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.616 Vali Acc: 0.817 Test Loss: 0.616 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816661).  Saving model ...
Epoch: 13 cost time: 3.76650071144104
Epoch: 13, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.595 Vali Acc: 0.811 Test Loss: 0.595 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.821004867553711
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
Validation loss decreased (-0.816661 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 3.8648903369903564
Epoch: 15, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.541 Vali Acc: 0.839 Test Loss: 0.541 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9694511890411377
Epoch: 16, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 3.8464114665985107
Epoch: 17, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
Validation loss decreased (-0.855550 --> -0.883328).  Saving model ...
Epoch: 18 cost time: 4.174166679382324
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.535813570022583
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7929799556732178
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3845677375793457
Epoch: 21, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.910814046859741
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6426258087158203
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.693387269973755
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4724225997924805
Epoch: 25, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.7916200160980225
Epoch: 26, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.555 Vali Acc: 0.861 Test Loss: 0.555 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.640524387359619
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.005086421966553
Epoch: 1, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.649 Vali Acc: 0.056 Test Loss: 2.649 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 3.862802028656006
Epoch: 2, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.436 Vali Acc: 0.200 Test Loss: 2.436 Test Acc: 0.200
Validation loss decreased (-0.055529 --> -0.199976).  Saving model ...
Epoch: 3 cost time: 3.4679348468780518
Epoch: 3, Steps: 12 | Train Loss: 2.376 Vali Loss: 2.244 Vali Acc: 0.250 Test Loss: 2.244 Test Acc: 0.250
Validation loss decreased (-0.199976 --> -0.249978).  Saving model ...
Epoch: 4 cost time: 3.876152753829956
Epoch: 4, Steps: 12 | Train Loss: 2.141 Vali Loss: 2.053 Vali Acc: 0.372 Test Loss: 2.053 Test Acc: 0.372
Validation loss decreased (-0.249978 --> -0.372202).  Saving model ...
Epoch: 5 cost time: 3.925036668777466
Epoch: 5, Steps: 12 | Train Loss: 1.953 Vali Loss: 1.851 Vali Acc: 0.406 Test Loss: 1.851 Test Acc: 0.406
Validation loss decreased (-0.372202 --> -0.405537).  Saving model ...
Epoch: 6 cost time: 4.072878122329712
Epoch: 6, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.641 Vali Acc: 0.522 Test Loss: 1.641 Test Acc: 0.522
Validation loss decreased (-0.405537 --> -0.522206).  Saving model ...
Epoch: 7 cost time: 3.690000534057617
Epoch: 7, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.389 Vali Acc: 0.578 Test Loss: 1.389 Test Acc: 0.578
Validation loss decreased (-0.522206 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 3.7080466747283936
Epoch: 8, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.190 Vali Acc: 0.639 Test Loss: 1.190 Test Acc: 0.639
Validation loss decreased (-0.577764 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 3.3165531158447266
Epoch: 9, Steps: 12 | Train Loss: 1.015 Vali Loss: 0.978 Vali Acc: 0.706 Test Loss: 0.978 Test Acc: 0.706
Validation loss decreased (-0.638877 --> -0.705546).  Saving model ...
Epoch: 10 cost time: 3.8533709049224854
Epoch: 10, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.858 Vali Acc: 0.728 Test Loss: 0.858 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727769).  Saving model ...
Epoch: 11 cost time: 3.470491886138916
Epoch: 11, Steps: 12 | Train Loss: 0.629 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 3.654827833175659
Epoch: 12, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 3.4822354316711426
Epoch: 13, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.646 Vali Acc: 0.772 Test Loss: 0.646 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772216).  Saving model ...
Epoch: 14 cost time: 3.6265275478363037
Epoch: 14, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.681 Vali Acc: 0.817 Test Loss: 0.681 Test Acc: 0.817
Validation loss decreased (-0.772216 --> -0.816660).  Saving model ...
Epoch: 15 cost time: 3.9490294456481934
Epoch: 15, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 16 cost time: 3.6447322368621826
Epoch: 16, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.075217008590698
Epoch: 17, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 3.6859357357025146
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8635642528533936
Epoch: 19, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.724 Vali Acc: 0.817 Test Loss: 0.724 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.239796876907349
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 3.573610305786133
Epoch: 21, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.672 Vali Acc: 0.828 Test Loss: 0.672 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.059998035430908
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5266952514648438
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.8949170112609863
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6897695064544678
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 3.921431541442871
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.9770162105560303
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.567 Vali Acc: 0.828 Test Loss: 0.567 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.858774185180664
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.881129741668701
Epoch: 29, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.4686434268951416
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.652940511703491
Epoch: 31, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.6753549575805664
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 3.685290813446045
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.503178834915161
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.680325508117676
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.6119606494903564
Epoch: 36, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.7347543239593506
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.897183895111084
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.751215934753418
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.670 Vali Acc: 0.867 Test Loss: 0.670 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 40 cost time: 4.060975551605225
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.712099552154541
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.654 Vali Acc: 0.861 Test Loss: 0.654 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.348042249679565
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.675 Vali Acc: 0.856 Test Loss: 0.675 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.455867290496826
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.5665979385375977
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.650 Vali Acc: 0.861 Test Loss: 0.650 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.606616497039795
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 46 cost time: 3.5880393981933594
Epoch: 46, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.867 Test Loss: 0.670 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.657336711883545
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.674 Vali Acc: 0.872 Test Loss: 0.674 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872215).  Saving model ...
Epoch: 48 cost time: 3.8773794174194336
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.698 Vali Acc: 0.861 Test Loss: 0.698 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.9510295391082764
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.861 Test Loss: 0.704 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.6601221561431885
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.745 Vali Acc: 0.856 Test Loss: 0.745 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.954779624938965
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.8455233573913574
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.861 Test Loss: 0.732 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.883781909942627
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.746342897415161
Epoch: 54, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.711 Vali Acc: 0.867 Test Loss: 0.711 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.8901278972625732
Epoch: 55, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.867 Test Loss: 0.710 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.9339981079101562
Epoch: 56, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.727 Vali Acc: 0.872 Test Loss: 0.727 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.8738925457000732
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.867 Test Loss: 0.720 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.144801378250122
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.599 Vali Acc: 0.083 Test Loss: 2.599 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 3.6750729084014893
Epoch: 2, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.354 Vali Acc: 0.283 Test Loss: 2.354 Test Acc: 0.283
Validation loss decreased (-0.083307 --> -0.283310).  Saving model ...
Epoch: 3 cost time: 3.6553847789764404
Epoch: 3, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.113 Vali Acc: 0.272 Test Loss: 2.113 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6418755054473877
Epoch: 4, Steps: 12 | Train Loss: 2.283 Vali Loss: 1.910 Vali Acc: 0.356 Test Loss: 1.910 Test Acc: 0.356
Validation loss decreased (-0.283310 --> -0.355536).  Saving model ...
Epoch: 5 cost time: 3.266672134399414
Epoch: 5, Steps: 12 | Train Loss: 2.062 Vali Loss: 1.757 Vali Acc: 0.378 Test Loss: 1.757 Test Acc: 0.378
Validation loss decreased (-0.355536 --> -0.377760).  Saving model ...
Epoch: 6 cost time: 3.6686854362487793
Epoch: 6, Steps: 12 | Train Loss: 1.890 Vali Loss: 1.596 Vali Acc: 0.422 Test Loss: 1.596 Test Acc: 0.422
Validation loss decreased (-0.377760 --> -0.422206).  Saving model ...
Epoch: 7 cost time: 4.021988868713379
Epoch: 7, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.411 Vali Acc: 0.533 Test Loss: 1.411 Test Acc: 0.533
Validation loss decreased (-0.422206 --> -0.533319).  Saving model ...
Epoch: 8 cost time: 3.730027437210083
Epoch: 8, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.262 Vali Acc: 0.622 Test Loss: 1.262 Test Acc: 0.622
Validation loss decreased (-0.533319 --> -0.622210).  Saving model ...
Epoch: 9 cost time: 3.900653839111328
Epoch: 9, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.123 Vali Acc: 0.650 Test Loss: 1.123 Test Acc: 0.650
Validation loss decreased (-0.622210 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 3.526674270629883
Epoch: 10, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.991 Vali Acc: 0.656 Test Loss: 0.991 Test Acc: 0.656
Validation loss decreased (-0.649989 --> -0.655546).  Saving model ...
Epoch: 11 cost time: 3.847073793411255
Epoch: 11, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.856 Vali Acc: 0.717 Test Loss: 0.856 Test Acc: 0.717
Validation loss decreased (-0.655546 --> -0.716658).  Saving model ...
Epoch: 12 cost time: 3.797635316848755
Epoch: 12, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.801 Vali Acc: 0.711 Test Loss: 0.801 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9366705417633057
Epoch: 13, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.706 Vali Acc: 0.744 Test Loss: 0.706 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 4.290841341018677
Epoch: 14, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 3.713578701019287
Epoch: 15, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
Validation loss decreased (-0.761104 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 3.8978819847106934
Epoch: 16, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5371487140655518
Epoch: 17, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 3.575244665145874
Epoch: 18, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.585 Vali Acc: 0.794 Test Loss: 0.585 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6093897819519043
Epoch: 19, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.276275873184204
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 3.7000155448913574
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9834775924682617
Epoch: 22, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.623 Vali Acc: 0.811 Test Loss: 0.623 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.911177158355713
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 4.4592249393463135
Epoch: 24, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.0781636238098145
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.636 Vali Acc: 0.817 Test Loss: 0.636 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.634551286697388
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.114560604095459
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.509737491607666
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 4.606356859207153
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.724 Vali Acc: 0.806 Test Loss: 0.724 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.852245807647705
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.152580976486206
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 32 cost time: 3.7726359367370605
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.672 Vali Acc: 0.844 Test Loss: 0.672 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.9185233116149902
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.854919195175171
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.728 Vali Acc: 0.817 Test Loss: 0.728 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.746311664581299
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.700 Vali Acc: 0.828 Test Loss: 0.700 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.914299488067627
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.677 Vali Acc: 0.856 Test Loss: 0.677 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855549).  Saving model ...
Epoch: 37 cost time: 3.7279489040374756
Epoch: 37, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.7577261924743652
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.689 Vali Acc: 0.839 Test Loss: 0.689 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.096074104309082
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.693 Vali Acc: 0.844 Test Loss: 0.693 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.896852731704712
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.942319393157959
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 4.317121744155884
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.7959136962890625
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 4.339499235153198
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.707 Vali Acc: 0.844 Test Loss: 0.707 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.904679775238037
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 4.379976749420166
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.916760444641113
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.566 Vali Acc: 0.156 Test Loss: 2.566 Test Acc: 0.156
Validation loss decreased (inf --> -0.155530).  Saving model ...
Epoch: 2 cost time: 3.7437031269073486
Epoch: 2, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.221 Vali Acc: 0.333 Test Loss: 2.221 Test Acc: 0.333
Validation loss decreased (-0.155530 --> -0.333311).  Saving model ...
Epoch: 3 cost time: 3.9977216720581055
Epoch: 3, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.067 Vali Acc: 0.344 Test Loss: 2.067 Test Acc: 0.344
Validation loss decreased (-0.333311 --> -0.344424).  Saving model ...
Epoch: 4 cost time: 3.7971513271331787
Epoch: 4, Steps: 12 | Train Loss: 2.380 Vali Loss: 1.934 Vali Acc: 0.383 Test Loss: 1.934 Test Acc: 0.383
Validation loss decreased (-0.344424 --> -0.383314).  Saving model ...
Epoch: 5 cost time: 3.9543235301971436
Epoch: 5, Steps: 12 | Train Loss: 2.172 Vali Loss: 1.806 Vali Acc: 0.433 Test Loss: 1.806 Test Acc: 0.433
Validation loss decreased (-0.383314 --> -0.433315).  Saving model ...
Epoch: 6 cost time: 3.8467442989349365
Epoch: 6, Steps: 12 | Train Loss: 2.011 Vali Loss: 1.645 Vali Acc: 0.461 Test Loss: 1.645 Test Acc: 0.461
Validation loss decreased (-0.433315 --> -0.461095).  Saving model ...
Epoch: 7 cost time: 4.069861173629761
Epoch: 7, Steps: 12 | Train Loss: 1.668 Vali Loss: 1.450 Vali Acc: 0.506 Test Loss: 1.450 Test Acc: 0.506
Validation loss decreased (-0.461095 --> -0.505541).  Saving model ...
Epoch: 8 cost time: 4.151971340179443
Epoch: 8, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.296 Vali Acc: 0.583 Test Loss: 1.296 Test Acc: 0.583
Validation loss decreased (-0.505541 --> -0.583320).  Saving model ...
Epoch: 9 cost time: 3.898756742477417
Epoch: 9, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.126 Vali Acc: 0.617 Test Loss: 1.126 Test Acc: 0.617
Validation loss decreased (-0.583320 --> -0.616655).  Saving model ...
Epoch: 10 cost time: 4.131828546524048
Epoch: 10, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.984 Vali Acc: 0.683 Test Loss: 0.984 Test Acc: 0.683
Validation loss decreased (-0.616655 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 3.9171597957611084
Epoch: 11, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.886 Vali Acc: 0.689 Test Loss: 0.886 Test Acc: 0.689
Validation loss decreased (-0.683323 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 3.7192118167877197
Epoch: 12, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.807 Vali Acc: 0.678 Test Loss: 0.807 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.819605827331543
Epoch: 13, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.701 Vali Acc: 0.756 Test Loss: 0.701 Test Acc: 0.756
Validation loss decreased (-0.688880 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 4.1019322872161865
Epoch: 14, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 3.547039270401001
Epoch: 15, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.761104 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 3.973270893096924
Epoch: 16, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.614 Vali Acc: 0.817 Test Loss: 0.614 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 3.8181376457214355
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 3.60956072807312
Epoch: 18, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5957350730895996
Epoch: 19, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 3.57837176322937
Epoch: 20, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.665867567062378
Epoch: 21, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.764953136444092
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.580 Vali Acc: 0.839 Test Loss: 0.580 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.600503921508789
Epoch: 23, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 3.745987892150879
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.071280002593994
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 26 cost time: 4.052722215652466
Epoch: 26, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.732448101043701
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.592 Vali Acc: 0.867 Test Loss: 0.592 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 28 cost time: 4.111443519592285
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.688 Vali Acc: 0.839 Test Loss: 0.688 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.331913709640503
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.986403703689575
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.667686939239502
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.614 Vali Acc: 0.872 Test Loss: 0.614 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 3.6634490489959717
Epoch: 32, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.634 Vali Acc: 0.856 Test Loss: 0.634 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.435663938522339
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.610531806945801
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.515589952468872
Epoch: 35, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.647 Vali Acc: 0.861 Test Loss: 0.647 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.8840723037719727
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.6367650032043457
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.044260263442993
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.659 Vali Acc: 0.861 Test Loss: 0.659 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.037578821182251
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.991150140762329
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.836700677871704
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.576756715774536
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.716 Vali Acc: 0.056 Test Loss: 2.716 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 3.850853681564331
Epoch: 2, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.376 Vali Acc: 0.267 Test Loss: 2.376 Test Acc: 0.267
Validation loss decreased (-0.055528 --> -0.266643).  Saving model ...
Epoch: 3 cost time: 3.6532812118530273
Epoch: 3, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.083 Vali Acc: 0.350 Test Loss: 2.083 Test Acc: 0.350
Validation loss decreased (-0.266643 --> -0.349979).  Saving model ...
Epoch: 4 cost time: 3.539724588394165
Epoch: 4, Steps: 12 | Train Loss: 2.385 Vali Loss: 1.876 Vali Acc: 0.378 Test Loss: 1.876 Test Acc: 0.378
Validation loss decreased (-0.349979 --> -0.377759).  Saving model ...
Epoch: 5 cost time: 3.6580591201782227
Epoch: 5, Steps: 12 | Train Loss: 2.244 Vali Loss: 1.724 Vali Acc: 0.478 Test Loss: 1.724 Test Acc: 0.478
Validation loss decreased (-0.377759 --> -0.477761).  Saving model ...
Epoch: 6 cost time: 3.712658405303955
Epoch: 6, Steps: 12 | Train Loss: 2.066 Vali Loss: 1.588 Vali Acc: 0.500 Test Loss: 1.588 Test Acc: 0.500
Validation loss decreased (-0.477761 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 3.477996826171875
Epoch: 7, Steps: 12 | Train Loss: 1.685 Vali Loss: 1.450 Vali Acc: 0.489 Test Loss: 1.450 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5861828327178955
Epoch: 8, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.294 Vali Acc: 0.578 Test Loss: 1.294 Test Acc: 0.578
Validation loss decreased (-0.499984 --> -0.577765).  Saving model ...
Epoch: 9 cost time: 3.6723127365112305
Epoch: 9, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.136 Vali Acc: 0.611 Test Loss: 1.136 Test Acc: 0.611
Validation loss decreased (-0.577765 --> -0.611100).  Saving model ...
Epoch: 10 cost time: 3.7409744262695312
Epoch: 10, Steps: 12 | Train Loss: 0.921 Vali Loss: 1.000 Vali Acc: 0.672 Test Loss: 1.000 Test Acc: 0.672
Validation loss decreased (-0.611100 --> -0.672212).  Saving model ...
Epoch: 11 cost time: 4.198055267333984
Epoch: 11, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
Validation loss decreased (-0.672212 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 3.847144365310669
Epoch: 12, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.819 Vali Acc: 0.700 Test Loss: 0.819 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 13 cost time: 4.1794281005859375
Epoch: 13, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
Validation loss decreased (-0.699992 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 4.302808523178101
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.755549 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 3.951833486557007
Epoch: 15, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 4.280379295349121
Epoch: 16, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8228399753570557
Epoch: 17, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 18 cost time: 3.8992292881011963
Epoch: 18, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7886502742767334
Epoch: 19, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822216).  Saving model ...
Epoch: 20 cost time: 3.812260389328003
Epoch: 20, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 21 cost time: 3.7136688232421875
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.639 Vali Acc: 0.811 Test Loss: 0.639 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.706054925918579
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.604 Vali Acc: 0.817 Test Loss: 0.604 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.969406843185425
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 3.765624523162842
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 3.6354222297668457
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 3.5889525413513184
Epoch: 26, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.618 Vali Acc: 0.811 Test Loss: 0.618 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5238983631134033
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.652 Vali Acc: 0.828 Test Loss: 0.652 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.492938756942749
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.694 Vali Acc: 0.828 Test Loss: 0.694 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.627305030822754
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.56274151802063
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.656 Vali Acc: 0.839 Test Loss: 0.656 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.015395164489746
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.691 Vali Acc: 0.844 Test Loss: 0.691 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.9236795902252197
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.682 Vali Acc: 0.839 Test Loss: 0.682 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.6386139392852783
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.667 Vali Acc: 0.861 Test Loss: 0.667 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861104).  Saving model ...
Epoch: 34 cost time: 3.75473952293396
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.8170716762542725
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.8606653213500977
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.4409425258636475
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.9981467723846436
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.8485946655273438
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.7047271728515625
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.856 Test Loss: 0.675 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.74688982963562
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.682 Vali Acc: 0.856 Test Loss: 0.682 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.5034658908843994
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.844 Test Loss: 0.688 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.6514031887054443
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.691 Vali Acc: 0.844 Test Loss: 0.691 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.390677452087402
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.9871208667755127
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.8417959213256836
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.458054065704346
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.815107583999634
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.417006492614746
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.280399799346924
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 4.294803857803345
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 9 cost time: 3.882397174835205
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.043828248977661
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.850308656692505
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 12 cost time: 4.021192312240601
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.881988525390625
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8728420734405518
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7764358520507812
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.639120578765869
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.161863088607788
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.503630876541138
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.423147916793823
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.7194552421569824
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.109711647033691
Epoch: 21, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 2108687
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.993571758270264
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.548 Vali Acc: 0.211 Test Loss: 2.548 Test Acc: 0.211
Validation loss decreased (inf --> -0.211086).  Saving model ...
Epoch: 2 cost time: 4.108344793319702
Epoch: 2, Steps: 12 | Train Loss: 2.396 Vali Loss: 2.112 Vali Acc: 0.444 Test Loss: 2.112 Test Acc: 0.444
Validation loss decreased (-0.211086 --> -0.444423).  Saving model ...
Epoch: 3 cost time: 3.7132554054260254
Epoch: 3, Steps: 12 | Train Loss: 1.943 Vali Loss: 1.704 Vali Acc: 0.594 Test Loss: 1.704 Test Acc: 0.594
Validation loss decreased (-0.444423 --> -0.594427).  Saving model ...
Epoch: 4 cost time: 3.688218355178833
Epoch: 4, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.420 Vali Acc: 0.639 Test Loss: 1.420 Test Acc: 0.639
Validation loss decreased (-0.594427 --> -0.638875).  Saving model ...
Epoch: 5 cost time: 3.7005703449249268
Epoch: 5, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.212 Vali Acc: 0.694 Test Loss: 1.212 Test Acc: 0.694
Validation loss decreased (-0.638875 --> -0.694432).  Saving model ...
Epoch: 6 cost time: 3.690778970718384
Epoch: 6, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.073 Vali Acc: 0.706 Test Loss: 1.073 Test Acc: 0.706
Validation loss decreased (-0.694432 --> -0.705545).  Saving model ...
Epoch: 7 cost time: 3.844381093978882
Epoch: 7, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.942 Vali Acc: 0.711 Test Loss: 0.942 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711102).  Saving model ...
Epoch: 8 cost time: 3.6126794815063477
Epoch: 8, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.784 Vali Acc: 0.778 Test Loss: 0.784 Test Acc: 0.778
Validation loss decreased (-0.711102 --> -0.777770).  Saving model ...
Epoch: 9 cost time: 3.7834692001342773
Epoch: 9, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 3.6242096424102783
Epoch: 10, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 3.3704440593719482
Epoch: 11, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 4.1773436069488525
Epoch: 12, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
Validation loss decreased (-0.833328 --> -0.861106).  Saving model ...
Epoch: 13 cost time: 3.7453114986419678
Epoch: 13, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
Validation loss decreased (-0.861106 --> -0.888884).  Saving model ...
Epoch: 14 cost time: 4.0888190269470215
Epoch: 14, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.438 Vali Acc: 0.872 Test Loss: 0.438 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6994428634643555
Epoch: 15, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.759143114089966
Epoch: 16, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.415 Vali Acc: 0.878 Test Loss: 0.415 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.094722509384155
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.597501516342163
Epoch: 18, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 3.638622522354126
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 4.036636114120483
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.410 Vali Acc: 0.906 Test Loss: 0.410 Test Acc: 0.906
Validation loss decreased (-0.888885 --> -0.905551).  Saving model ...
Epoch: 21 cost time: 3.71246600151062
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.404 Vali Acc: 0.894 Test Loss: 0.404 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.322044134140015
Epoch: 22, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.415 Vali Acc: 0.889 Test Loss: 0.415 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5066826343536377
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.411 Vali Acc: 0.883 Test Loss: 0.411 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4163312911987305
Epoch: 24, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.5960335731506348
Epoch: 25, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.440 Vali Acc: 0.889 Test Loss: 0.440 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6028826236724854
Epoch: 26, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4961934089660645
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.140033483505249
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.456 Vali Acc: 0.889 Test Loss: 0.456 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.792736053466797
Epoch: 29, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.175860643386841
Epoch: 30, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.239035129547119
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.593 Vali Acc: 0.211 Test Loss: 2.593 Test Acc: 0.211
Validation loss decreased (inf --> -0.211085).  Saving model ...
Epoch: 2 cost time: 3.9811618328094482
Epoch: 2, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.228 Vali Acc: 0.411 Test Loss: 2.228 Test Acc: 0.411
Validation loss decreased (-0.211085 --> -0.411089).  Saving model ...
Epoch: 3 cost time: 3.686650037765503
Epoch: 3, Steps: 12 | Train Loss: 2.088 Vali Loss: 1.868 Vali Acc: 0.494 Test Loss: 1.868 Test Acc: 0.494
Validation loss decreased (-0.411089 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 3.7951228618621826
Epoch: 4, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.597 Vali Acc: 0.556 Test Loss: 1.597 Test Acc: 0.556
Validation loss decreased (-0.494426 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 3.474458932876587
Epoch: 5, Steps: 12 | Train Loss: 1.389 Vali Loss: 1.378 Vali Acc: 0.622 Test Loss: 1.378 Test Acc: 0.622
Validation loss decreased (-0.555540 --> -0.622208).  Saving model ...
Epoch: 6 cost time: 3.7056713104248047
Epoch: 6, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.213 Vali Acc: 0.683 Test Loss: 1.213 Test Acc: 0.683
Validation loss decreased (-0.622208 --> -0.683321).  Saving model ...
Epoch: 7 cost time: 3.4297523498535156
Epoch: 7, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.077 Vali Acc: 0.683 Test Loss: 1.077 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683323).  Saving model ...
Epoch: 8 cost time: 3.316174030303955
Epoch: 8, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.898 Vali Acc: 0.767 Test Loss: 0.898 Test Acc: 0.767
Validation loss decreased (-0.683323 --> -0.766658).  Saving model ...
Epoch: 9 cost time: 3.426254987716675
Epoch: 9, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777770).  Saving model ...
Epoch: 10 cost time: 3.4258100986480713
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.697 Vali Acc: 0.822 Test Loss: 0.697 Test Acc: 0.822
Validation loss decreased (-0.777770 --> -0.822215).  Saving model ...
Epoch: 11 cost time: 3.682664632797241
Epoch: 11, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844439).  Saving model ...
Epoch: 12 cost time: 3.4063193798065186
Epoch: 12, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 13 cost time: 4.1142027378082275
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 14 cost time: 3.8406412601470947
Epoch: 14, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 15 cost time: 3.9389801025390625
Epoch: 15, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6437644958496094
Epoch: 16, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 3.6823513507843018
Epoch: 17, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8364431858062744
Epoch: 18, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.0584022998809814
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.681267499923706
Epoch: 20, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.518 Vali Acc: 0.894 Test Loss: 0.518 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 21 cost time: 3.8067259788513184
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9184279441833496
Epoch: 22, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7058091163635254
Epoch: 23, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.502 Vali Acc: 0.883 Test Loss: 0.502 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.538440704345703
Epoch: 24, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.5026376247406006
Epoch: 25, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.541 Vali Acc: 0.894 Test Loss: 0.541 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7604873180389404
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4112370014190674
Epoch: 27, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5731945037841797
Epoch: 28, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.647852897644043
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.556 Vali Acc: 0.878 Test Loss: 0.556 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.672743558883667
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.522869825363159
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.660 Vali Acc: 0.156 Test Loss: 2.660 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 3.858792304992676
Epoch: 2, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.368 Vali Acc: 0.267 Test Loss: 2.368 Test Acc: 0.267
Validation loss decreased (-0.155529 --> -0.266643).  Saving model ...
Epoch: 3 cost time: 3.5282580852508545
Epoch: 3, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.066 Vali Acc: 0.433 Test Loss: 2.066 Test Acc: 0.433
Validation loss decreased (-0.266643 --> -0.433313).  Saving model ...
Epoch: 4 cost time: 3.7976391315460205
Epoch: 4, Steps: 12 | Train Loss: 1.935 Vali Loss: 1.825 Vali Acc: 0.500 Test Loss: 1.825 Test Acc: 0.500
Validation loss decreased (-0.433313 --> -0.499982).  Saving model ...
Epoch: 5 cost time: 3.4486677646636963
Epoch: 5, Steps: 12 | Train Loss: 1.676 Vali Loss: 1.619 Vali Acc: 0.522 Test Loss: 1.619 Test Acc: 0.522
Validation loss decreased (-0.499982 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 3.5876057147979736
Epoch: 6, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.437 Vali Acc: 0.594 Test Loss: 1.437 Test Acc: 0.594
Validation loss decreased (-0.522206 --> -0.594430).  Saving model ...
Epoch: 7 cost time: 3.361973762512207
Epoch: 7, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.271 Vali Acc: 0.622 Test Loss: 1.271 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622210).  Saving model ...
Epoch: 8 cost time: 3.5901596546173096
Epoch: 8, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.069 Vali Acc: 0.689 Test Loss: 1.069 Test Acc: 0.689
Validation loss decreased (-0.622210 --> -0.688878).  Saving model ...
Epoch: 9 cost time: 3.3576574325561523
Epoch: 9, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.896 Vali Acc: 0.728 Test Loss: 0.896 Test Acc: 0.728
Validation loss decreased (-0.688878 --> -0.727769).  Saving model ...
Epoch: 10 cost time: 3.6660282611846924
Epoch: 10, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.828 Vali Acc: 0.756 Test Loss: 0.828 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755547).  Saving model ...
Epoch: 11 cost time: 3.638946533203125
Epoch: 11, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.712 Vali Acc: 0.806 Test Loss: 0.712 Test Acc: 0.806
Validation loss decreased (-0.755547 --> -0.805548).  Saving model ...
Epoch: 12 cost time: 3.718266248703003
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.678 Vali Acc: 0.811 Test Loss: 0.678 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 3.704146146774292
Epoch: 13, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827772).  Saving model ...
Epoch: 14 cost time: 3.764549493789673
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855550).  Saving model ...
Epoch: 15 cost time: 3.6870951652526855
Epoch: 15, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.599 Vali Acc: 0.822 Test Loss: 0.599 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.898557186126709
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 17 cost time: 3.5909156799316406
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 18 cost time: 3.778963088989258
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7740283012390137
Epoch: 19, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.504 Vali Acc: 0.872 Test Loss: 0.504 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 20 cost time: 3.805600643157959
Epoch: 20, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7071139812469482
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.528 Vali Acc: 0.878 Test Loss: 0.528 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 22 cost time: 3.9306716918945312
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.522 Vali Acc: 0.894 Test Loss: 0.522 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894439).  Saving model ...
Epoch: 23 cost time: 3.7438950538635254
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.531 Vali Acc: 0.872 Test Loss: 0.531 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.137948274612427
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.883 Test Loss: 0.556 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6231582164764404
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.553 Vali Acc: 0.878 Test Loss: 0.553 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7431721687316895
Epoch: 26, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.553 Vali Acc: 0.878 Test Loss: 0.553 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.506561279296875
Epoch: 27, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.6538872718811035
Epoch: 28, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.547 Vali Acc: 0.878 Test Loss: 0.547 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.5497748851776123
Epoch: 29, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.554 Vali Acc: 0.883 Test Loss: 0.554 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.4753243923187256
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.585 Vali Acc: 0.883 Test Loss: 0.585 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.6432852745056152
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.584 Vali Acc: 0.889 Test Loss: 0.584 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.8245248794555664
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.559 Vali Acc: 0.894 Test Loss: 0.559 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.588365077972412
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.737 Vali Acc: 0.067 Test Loss: 2.737 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 3.817594289779663
Epoch: 2, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.517 Vali Acc: 0.183 Test Loss: 2.517 Test Acc: 0.183
Validation loss decreased (-0.066639 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 3.93603515625
Epoch: 3, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.279 Vali Acc: 0.261 Test Loss: 2.279 Test Acc: 0.261
Validation loss decreased (-0.183308 --> -0.261088).  Saving model ...
Epoch: 4 cost time: 3.548543930053711
Epoch: 4, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.071 Vali Acc: 0.344 Test Loss: 2.071 Test Acc: 0.344
Validation loss decreased (-0.261088 --> -0.344424).  Saving model ...
Epoch: 5 cost time: 3.5816521644592285
Epoch: 5, Steps: 12 | Train Loss: 1.974 Vali Loss: 1.873 Vali Acc: 0.394 Test Loss: 1.873 Test Acc: 0.394
Validation loss decreased (-0.344424 --> -0.394426).  Saving model ...
Epoch: 6 cost time: 3.5659284591674805
Epoch: 6, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.654 Vali Acc: 0.478 Test Loss: 1.654 Test Acc: 0.478
Validation loss decreased (-0.394426 --> -0.477761).  Saving model ...
Epoch: 7 cost time: 3.505317449569702
Epoch: 7, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.411 Vali Acc: 0.572 Test Loss: 1.411 Test Acc: 0.572
Validation loss decreased (-0.477761 --> -0.572208).  Saving model ...
Epoch: 8 cost time: 3.683295965194702
Epoch: 8, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.154 Vali Acc: 0.678 Test Loss: 1.154 Test Acc: 0.678
Validation loss decreased (-0.572208 --> -0.677766).  Saving model ...
Epoch: 9 cost time: 3.680331230163574
Epoch: 9, Steps: 12 | Train Loss: 0.978 Vali Loss: 0.942 Vali Acc: 0.711 Test Loss: 0.942 Test Acc: 0.711
Validation loss decreased (-0.677766 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 3.721926689147949
Epoch: 10, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.859 Vali Acc: 0.739 Test Loss: 0.859 Test Acc: 0.739
Validation loss decreased (-0.711102 --> -0.738880).  Saving model ...
Epoch: 11 cost time: 4.032541751861572
Epoch: 11, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.760 Vali Acc: 0.761 Test Loss: 0.760 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 12 cost time: 4.062936067581177
Epoch: 12, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 13 cost time: 3.9781830310821533
Epoch: 13, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.638 Vali Acc: 0.794 Test Loss: 0.638 Test Acc: 0.794
Validation loss decreased (-0.761104 --> -0.794438).  Saving model ...
Epoch: 14 cost time: 3.9223129749298096
Epoch: 14, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.570 Vali Acc: 0.794 Test Loss: 0.570 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794439).  Saving model ...
Epoch: 15 cost time: 4.013241767883301
Epoch: 15, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 3.818128824234009
Epoch: 16, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 4.030611038208008
Epoch: 17, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.042010307312012
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 4.019035339355469
Epoch: 19, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 3.8717219829559326
Epoch: 20, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.666 Vali Acc: 0.806 Test Loss: 0.666 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.101232290267944
Epoch: 21, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.681 Vali Acc: 0.794 Test Loss: 0.681 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.208662033081055
Epoch: 22, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.580 Vali Acc: 0.839 Test Loss: 0.580 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.59253191947937
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.8754196166992188
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.614 Vali Acc: 0.811 Test Loss: 0.614 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.835909366607666
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.586 Vali Acc: 0.839 Test Loss: 0.586 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5278825759887695
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 3.7891952991485596
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.230351686477661
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 4.055676460266113
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.645 Vali Acc: 0.806 Test Loss: 0.645 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.929553985595703
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7780580520629883
Epoch: 31, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.814744234085083
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.839 Test Loss: 0.590 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.234373569488525
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.602 Vali Acc: 0.872 Test Loss: 0.602 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 34 cost time: 3.7983367443084717
Epoch: 34, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.8554885387420654
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.7098283767700195
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.637 Vali Acc: 0.861 Test Loss: 0.637 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.9626991748809814
Epoch: 37, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.647 Vali Acc: 0.872 Test Loss: 0.647 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.6961095333099365
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.7813045978546143
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.656 Vali Acc: 0.861 Test Loss: 0.656 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.517522096633911
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.936135768890381
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.492685317993164
Epoch: 42, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.695 Vali Acc: 0.861 Test Loss: 0.695 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.114666938781738
Epoch: 43, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.687 Vali Acc: 0.856 Test Loss: 0.687 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.6482789516448975
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.737 Vali Acc: 0.078 Test Loss: 2.737 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 3.752656936645508
Epoch: 2, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.494 Vali Acc: 0.217 Test Loss: 2.494 Test Acc: 0.217
Validation loss decreased (-0.077750 --> -0.216642).  Saving model ...
Epoch: 3 cost time: 3.7642812728881836
Epoch: 3, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.210 Vali Acc: 0.322 Test Loss: 2.210 Test Acc: 0.322
Validation loss decreased (-0.216642 --> -0.322200).  Saving model ...
Epoch: 4 cost time: 3.851468801498413
Epoch: 4, Steps: 12 | Train Loss: 2.319 Vali Loss: 1.996 Vali Acc: 0.344 Test Loss: 1.996 Test Acc: 0.344
Validation loss decreased (-0.322200 --> -0.344424).  Saving model ...
Epoch: 5 cost time: 3.9637014865875244
Epoch: 5, Steps: 12 | Train Loss: 2.088 Vali Loss: 1.845 Vali Acc: 0.344 Test Loss: 1.845 Test Acc: 0.344
Validation loss decreased (-0.344424 --> -0.344426).  Saving model ...
Epoch: 6 cost time: 3.6748046875
Epoch: 6, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.704 Vali Acc: 0.444 Test Loss: 1.704 Test Acc: 0.444
Validation loss decreased (-0.344426 --> -0.444427).  Saving model ...
Epoch: 7 cost time: 3.8475520610809326
Epoch: 7, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.559 Vali Acc: 0.506 Test Loss: 1.559 Test Acc: 0.506
Validation loss decreased (-0.444427 --> -0.505540).  Saving model ...
Epoch: 8 cost time: 3.8175575733184814
Epoch: 8, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.351 Vali Acc: 0.567 Test Loss: 1.351 Test Acc: 0.567
Validation loss decreased (-0.505540 --> -0.566653).  Saving model ...
Epoch: 9 cost time: 3.4798338413238525
Epoch: 9, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.096 Vali Acc: 0.656 Test Loss: 1.096 Test Acc: 0.656
Validation loss decreased (-0.566653 --> -0.655545).  Saving model ...
Epoch: 10 cost time: 3.746866226196289
Epoch: 10, Steps: 12 | Train Loss: 0.922 Vali Loss: 0.999 Vali Acc: 0.694 Test Loss: 0.999 Test Acc: 0.694
Validation loss decreased (-0.655545 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 3.710503339767456
Epoch: 11, Steps: 12 | Train Loss: 0.766 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 3.8296701908111572
Epoch: 12, Steps: 12 | Train Loss: 0.649 Vali Loss: 0.808 Vali Acc: 0.717 Test Loss: 0.808 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716659).  Saving model ...
Epoch: 13 cost time: 4.1124513149261475
Epoch: 13, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.701 Vali Acc: 0.739 Test Loss: 0.701 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 3.9712417125701904
Epoch: 14, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
Validation loss decreased (-0.738882 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 3.864494800567627
Epoch: 15, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.854342222213745
Epoch: 16, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.788882 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 3.882995367050171
Epoch: 17, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.879511833190918
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 19 cost time: 3.7147209644317627
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 3.961256504058838
Epoch: 20, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.144118785858154
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7709712982177734
Epoch: 22, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6138060092926025
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.969897747039795
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.986074209213257
Epoch: 25, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.4731500148773193
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.622 Vali Acc: 0.861 Test Loss: 0.622 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 3.814819574356079
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.579 Vali Acc: 0.828 Test Loss: 0.579 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.573136329650879
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.002070426940918
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 30 cost time: 3.9996771812438965
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
Validation loss decreased (-0.861105 --> -0.877772).  Saving model ...
Epoch: 31 cost time: 3.9689176082611084
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.3543877601623535
Epoch: 32, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.010446310043335
Epoch: 33, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.142576694488525
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.670 Vali Acc: 0.861 Test Loss: 0.670 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.3558149337768555
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.237708568572998
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.455744981765747
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.762763261795044
Epoch: 38, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.676 Vali Acc: 0.839 Test Loss: 0.676 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.6085801124572754
Epoch: 39, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.5968947410583496
Epoch: 40, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.703 Vali Acc: 0.856 Test Loss: 0.703 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.313975095748901
Epoch: 1, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.602 Vali Acc: 0.194 Test Loss: 2.602 Test Acc: 0.194
Validation loss decreased (inf --> -0.194418).  Saving model ...
Epoch: 2 cost time: 3.743927001953125
Epoch: 2, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.255 Vali Acc: 0.278 Test Loss: 2.255 Test Acc: 0.278
Validation loss decreased (-0.194418 --> -0.277755).  Saving model ...
Epoch: 3 cost time: 3.5204479694366455
Epoch: 3, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.036 Vali Acc: 0.322 Test Loss: 2.036 Test Acc: 0.322
Validation loss decreased (-0.277755 --> -0.322202).  Saving model ...
Epoch: 4 cost time: 3.6774327754974365
Epoch: 4, Steps: 12 | Train Loss: 2.352 Vali Loss: 1.890 Vali Acc: 0.439 Test Loss: 1.890 Test Acc: 0.439
Validation loss decreased (-0.322202 --> -0.438870).  Saving model ...
Epoch: 5 cost time: 3.5471715927124023
Epoch: 5, Steps: 12 | Train Loss: 2.170 Vali Loss: 1.772 Vali Acc: 0.444 Test Loss: 1.772 Test Acc: 0.444
Validation loss decreased (-0.438870 --> -0.444427).  Saving model ...
Epoch: 6 cost time: 3.5975611209869385
Epoch: 6, Steps: 12 | Train Loss: 1.953 Vali Loss: 1.658 Vali Acc: 0.489 Test Loss: 1.658 Test Acc: 0.489
Validation loss decreased (-0.444427 --> -0.488872).  Saving model ...
Epoch: 7 cost time: 3.6943070888519287
Epoch: 7, Steps: 12 | Train Loss: 1.675 Vali Loss: 1.510 Vali Acc: 0.561 Test Loss: 1.510 Test Acc: 0.561
Validation loss decreased (-0.488872 --> -0.561096).  Saving model ...
Epoch: 8 cost time: 3.3302433490753174
Epoch: 8, Steps: 12 | Train Loss: 1.379 Vali Loss: 1.253 Vali Acc: 0.617 Test Loss: 1.253 Test Acc: 0.617
Validation loss decreased (-0.561096 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 3.6483726501464844
Epoch: 9, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.049 Vali Acc: 0.672 Test Loss: 1.049 Test Acc: 0.672
Validation loss decreased (-0.616654 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 3.303396463394165
Epoch: 10, Steps: 12 | Train Loss: 0.864 Vali Loss: 0.962 Vali Acc: 0.672 Test Loss: 0.962 Test Acc: 0.672
Validation loss decreased (-0.672212 --> -0.672213).  Saving model ...
Epoch: 11 cost time: 3.4364523887634277
Epoch: 11, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.825 Vali Acc: 0.733 Test Loss: 0.825 Test Acc: 0.733
Validation loss decreased (-0.672213 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 3.5639684200286865
Epoch: 12, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.766 Vali Acc: 0.722 Test Loss: 0.766 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3457863330841064
Epoch: 13, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.678 Vali Acc: 0.756 Test Loss: 0.678 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 3.391151189804077
Epoch: 14, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
Validation loss decreased (-0.755549 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 3.338972806930542
Epoch: 15, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.633 Vali Acc: 0.772 Test Loss: 0.633 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5541810989379883
Epoch: 16, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.546 Vali Acc: 0.817 Test Loss: 0.546 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5055229663848877
Epoch: 17, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.685 Vali Acc: 0.778 Test Loss: 0.685 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.631096839904785
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 3.7872731685638428
Epoch: 19, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.640 Vali Acc: 0.817 Test Loss: 0.640 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8931915760040283
Epoch: 20, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7645137310028076
Epoch: 21, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8030941486358643
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 23 cost time: 3.887972354888916
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 4.062825679779053
Epoch: 24, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.499246597290039
Epoch: 25, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.574 Vali Acc: 0.839 Test Loss: 0.574 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.863475799560547
Epoch: 26, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.8673129081726074
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.608 Vali Acc: 0.828 Test Loss: 0.608 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.3896842002868652
Epoch: 28, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.613866090774536
Epoch: 29, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.634 Vali Acc: 0.822 Test Loss: 0.634 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.767667055130005
Epoch: 30, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 31 cost time: 3.557227849960327
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6449146270751953
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.617 Vali Acc: 0.861 Test Loss: 0.617 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 33 cost time: 3.7933731079101562
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.176684856414795
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.9045937061309814
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.8944499492645264
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.648 Vali Acc: 0.856 Test Loss: 0.648 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.136279106140137
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.935891628265381
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.9119272232055664
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.646 Vali Acc: 0.839 Test Loss: 0.646 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.911921262741089
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.0961949825286865
Epoch: 41, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.8155555725097656
Epoch: 42, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.666 Vali Acc: 0.856 Test Loss: 0.666 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.092132806777954
Epoch: 1, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.667 Vali Acc: 0.100 Test Loss: 2.667 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 3.6055798530578613
Epoch: 2, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.372 Vali Acc: 0.328 Test Loss: 2.372 Test Acc: 0.328
Validation loss decreased (-0.099973 --> -0.327754).  Saving model ...
Epoch: 3 cost time: 3.501377820968628
Epoch: 3, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.071 Vali Acc: 0.433 Test Loss: 2.071 Test Acc: 0.433
Validation loss decreased (-0.327754 --> -0.433313).  Saving model ...
Epoch: 4 cost time: 3.7432596683502197
Epoch: 4, Steps: 12 | Train Loss: 2.451 Vali Loss: 1.876 Vali Acc: 0.428 Test Loss: 1.876 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.547938823699951
Epoch: 5, Steps: 12 | Train Loss: 2.174 Vali Loss: 1.764 Vali Acc: 0.433 Test Loss: 1.764 Test Acc: 0.433
Validation loss decreased (-0.433313 --> -0.433316).  Saving model ...
Epoch: 6 cost time: 3.6871848106384277
Epoch: 6, Steps: 12 | Train Loss: 1.964 Vali Loss: 1.647 Vali Acc: 0.506 Test Loss: 1.647 Test Acc: 0.506
Validation loss decreased (-0.433316 --> -0.505539).  Saving model ...
Epoch: 7 cost time: 4.033725261688232
Epoch: 7, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.517 Vali Acc: 0.556 Test Loss: 1.517 Test Acc: 0.556
Validation loss decreased (-0.505539 --> -0.555540).  Saving model ...
Epoch: 8 cost time: 4.245197772979736
Epoch: 8, Steps: 12 | Train Loss: 1.392 Vali Loss: 1.291 Vali Acc: 0.572 Test Loss: 1.291 Test Acc: 0.572
Validation loss decreased (-0.555540 --> -0.572209).  Saving model ...
Epoch: 9 cost time: 3.8797755241394043
Epoch: 9, Steps: 12 | Train Loss: 1.140 Vali Loss: 1.075 Vali Acc: 0.672 Test Loss: 1.075 Test Acc: 0.672
Validation loss decreased (-0.572209 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 3.865900993347168
Epoch: 10, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.989 Vali Acc: 0.661 Test Loss: 0.989 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.009029865264893
Epoch: 11, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.864 Vali Acc: 0.728 Test Loss: 0.864 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 3.6588244438171387
Epoch: 12, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 13 cost time: 3.483501434326172
Epoch: 13, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.716 Vali Acc: 0.728 Test Loss: 0.716 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727771).  Saving model ...
Epoch: 14 cost time: 3.773080587387085
Epoch: 14, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.623 Vali Acc: 0.789 Test Loss: 0.623 Test Acc: 0.789
Validation loss decreased (-0.727771 --> -0.788883).  Saving model ...
Epoch: 15 cost time: 3.5761196613311768
Epoch: 15, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.659 Vali Acc: 0.811 Test Loss: 0.659 Test Acc: 0.811
Validation loss decreased (-0.788883 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 3.769127130508423
Epoch: 16, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 3.645319700241089
Epoch: 17, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.682 Vali Acc: 0.794 Test Loss: 0.682 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.528423309326172
Epoch: 18, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7652902603149414
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6775591373443604
Epoch: 20, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.688 Vali Acc: 0.828 Test Loss: 0.688 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6405279636383057
Epoch: 21, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.649 Vali Acc: 0.811 Test Loss: 0.649 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.888201951980591
Epoch: 22, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.604 Vali Acc: 0.811 Test Loss: 0.604 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.000186204910278
Epoch: 23, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 24 cost time: 3.85201358795166
Epoch: 24, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.86716628074646
Epoch: 25, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.574 Vali Acc: 0.839 Test Loss: 0.574 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.771799087524414
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 3.702390670776367
Epoch: 27, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4550304412841797
Epoch: 28, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.600 Vali Acc: 0.844 Test Loss: 0.600 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.422344446182251
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.611 Vali Acc: 0.844 Test Loss: 0.611 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.687199115753174
Epoch: 30, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 31 cost time: 3.7169125080108643
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.600 Vali Acc: 0.856 Test Loss: 0.600 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6288187503814697
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.7044641971588135
Epoch: 33, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.619 Vali Acc: 0.861 Test Loss: 0.619 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.584082841873169
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.9643871784210205
Epoch: 35, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.632 Vali Acc: 0.856 Test Loss: 0.632 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.12548041343689
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.644 Vali Acc: 0.856 Test Loss: 0.644 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.7416915893554688
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.652 Vali Acc: 0.856 Test Loss: 0.652 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.8748223781585693
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.656 Vali Acc: 0.856 Test Loss: 0.656 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.5973522663116455
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.5908572673797607
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.861 Test Loss: 0.635 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.161335229873657
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.3362298011779785
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.461529493331909
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.2432990074157715
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 3.624340534210205
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 3.588237762451172
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 7 cost time: 3.5435192584991455
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.2971503734588623
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 9 cost time: 3.867417335510254
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 10 cost time: 3.666382312774658
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.844571828842163
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7320950031280518
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6879491806030273
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4834885597229004
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6800713539123535
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 16 cost time: 3.684540271759033
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 17 cost time: 3.737792730331421
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 18 cost time: 3.6807146072387695
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5318353176116943
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8005030155181885
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3663055896759033
Epoch: 21, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.728342294692993
Epoch: 22, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.840299129486084
Epoch: 23, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.309061527252197
Epoch: 24, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.0590736865997314
Epoch: 25, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.132174253463745
Epoch: 26, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.141792297363281
Epoch: 27, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 1322255
model size : 9.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.988140106201172
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.593 Vali Acc: 0.167 Test Loss: 2.593 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 4.039164066314697
Epoch: 2, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.181 Vali Acc: 0.400 Test Loss: 2.181 Test Acc: 0.400
Validation loss decreased (-0.166641 --> -0.399978).  Saving model ...
Epoch: 3 cost time: 3.603848457336426
Epoch: 3, Steps: 12 | Train Loss: 2.018 Vali Loss: 1.791 Vali Acc: 0.606 Test Loss: 1.791 Test Acc: 0.606
Validation loss decreased (-0.399978 --> -0.605538).  Saving model ...
Epoch: 4 cost time: 3.7481307983398438
Epoch: 4, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.511 Vali Acc: 0.611 Test Loss: 1.511 Test Acc: 0.611
Validation loss decreased (-0.605538 --> -0.611096).  Saving model ...
Epoch: 5 cost time: 4.02879524230957
Epoch: 5, Steps: 12 | Train Loss: 1.290 Vali Loss: 1.274 Vali Acc: 0.661 Test Loss: 1.274 Test Acc: 0.661
Validation loss decreased (-0.611096 --> -0.661098).  Saving model ...
Epoch: 6 cost time: 4.0471227169036865
Epoch: 6, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.126 Vali Acc: 0.683 Test Loss: 1.126 Test Acc: 0.683
Validation loss decreased (-0.661098 --> -0.683322).  Saving model ...
Epoch: 7 cost time: 4.023038864135742
Epoch: 7, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.948 Vali Acc: 0.717 Test Loss: 0.948 Test Acc: 0.717
Validation loss decreased (-0.683322 --> -0.716657).  Saving model ...
Epoch: 8 cost time: 4.271009683609009
Epoch: 8, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
Validation loss decreased (-0.716657 --> -0.761103).  Saving model ...
Epoch: 9 cost time: 4.439138650894165
Epoch: 9, Steps: 12 | Train Loss: 0.502 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.761103 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 3.9172773361206055
Epoch: 10, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.624 Vali Acc: 0.839 Test Loss: 0.624 Test Acc: 0.839
Validation loss decreased (-0.799993 --> -0.838883).  Saving model ...
Epoch: 11 cost time: 3.7538490295410156
Epoch: 11, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9120304584503174
Epoch: 12, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 13 cost time: 4.011868238449097
Epoch: 13, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 4.215527534484863
Epoch: 14, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.432 Vali Acc: 0.856 Test Loss: 0.432 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 15 cost time: 3.7522826194763184
Epoch: 15, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.423 Vali Acc: 0.872 Test Loss: 0.423 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 3.6880598068237305
Epoch: 16, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.589327096939087
Epoch: 17, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 3.740647315979004
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.410 Vali Acc: 0.883 Test Loss: 0.410 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.622128963470459
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 3.5440731048583984
Epoch: 20, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 21 cost time: 3.541463613510132
Epoch: 21, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.410 Vali Acc: 0.883 Test Loss: 0.410 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.57344651222229
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.717947244644165
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 3.602161407470703
Epoch: 24, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 3.6921474933624268
Epoch: 25, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.6036291122436523
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.694437265396118
Epoch: 27, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.7611284255981445
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.6218526363372803
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.5674495697021484
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.440 Vali Acc: 0.894 Test Loss: 0.440 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.9659101963043213
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.584186315536499
Epoch: 32, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.473 Vali Acc: 0.894 Test Loss: 0.473 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.6934454441070557
Epoch: 33, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.6215343475341797
Epoch: 34, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.495 Vali Acc: 0.894 Test Loss: 0.495 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.273861885070801
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.601 Vali Acc: 0.172 Test Loss: 2.601 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 3.5359716415405273
Epoch: 2, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.264 Vali Acc: 0.406 Test Loss: 2.264 Test Acc: 0.406
Validation loss decreased (-0.172196 --> -0.405533).  Saving model ...
Epoch: 3 cost time: 3.932807207107544
Epoch: 3, Steps: 12 | Train Loss: 2.186 Vali Loss: 1.924 Vali Acc: 0.528 Test Loss: 1.924 Test Acc: 0.528
Validation loss decreased (-0.405533 --> -0.527759).  Saving model ...
Epoch: 4 cost time: 4.299878835678101
Epoch: 4, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.662 Vali Acc: 0.561 Test Loss: 1.662 Test Acc: 0.561
Validation loss decreased (-0.527759 --> -0.561094).  Saving model ...
Epoch: 5 cost time: 3.5998620986938477
Epoch: 5, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.439 Vali Acc: 0.606 Test Loss: 1.439 Test Acc: 0.606
Validation loss decreased (-0.561094 --> -0.605541).  Saving model ...
Epoch: 6 cost time: 3.8321142196655273
Epoch: 6, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.282 Vali Acc: 0.639 Test Loss: 1.282 Test Acc: 0.639
Validation loss decreased (-0.605541 --> -0.638876).  Saving model ...
Epoch: 7 cost time: 3.9078216552734375
Epoch: 7, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.097 Vali Acc: 0.694 Test Loss: 1.097 Test Acc: 0.694
Validation loss decreased (-0.638876 --> -0.694433).  Saving model ...
Epoch: 8 cost time: 3.6907715797424316
Epoch: 8, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.944 Vali Acc: 0.733 Test Loss: 0.944 Test Acc: 0.733
Validation loss decreased (-0.694433 --> -0.733324).  Saving model ...
Epoch: 9 cost time: 3.7138378620147705
Epoch: 9, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.768 Vali Acc: 0.789 Test Loss: 0.768 Test Acc: 0.789
Validation loss decreased (-0.733324 --> -0.788881).  Saving model ...
Epoch: 10 cost time: 3.534257173538208
Epoch: 10, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.689 Vali Acc: 0.811 Test Loss: 0.689 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 11 cost time: 3.7110893726348877
Epoch: 11, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 12 cost time: 3.635690927505493
Epoch: 12, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
Validation loss decreased (-0.822216 --> -0.861105).  Saving model ...
Epoch: 13 cost time: 3.748753309249878
Epoch: 13, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.426182270050049
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.490 Vali Acc: 0.872 Test Loss: 0.490 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 15 cost time: 3.6513831615448
Epoch: 15, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 16 cost time: 3.5152430534362793
Epoch: 16, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6838762760162354
Epoch: 17, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 3.935823917388916
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.511 Vali Acc: 0.894 Test Loss: 0.511 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 19 cost time: 3.9494035243988037
Epoch: 19, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.478 Vali Acc: 0.894 Test Loss: 0.478 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 20 cost time: 3.851433753967285
Epoch: 20, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.482 Vali Acc: 0.883 Test Loss: 0.482 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6876707077026367
Epoch: 21, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.743786334991455
Epoch: 22, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8136110305786133
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.482 Vali Acc: 0.878 Test Loss: 0.482 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.678727149963379
Epoch: 24, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.541 Vali Acc: 0.883 Test Loss: 0.541 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.633570909500122
Epoch: 25, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.7055745124816895
Epoch: 26, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.712864637374878
Epoch: 27, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.538 Vali Acc: 0.894 Test Loss: 0.538 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.4405698776245117
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 3.6021299362182617
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.537 Vali Acc: 0.889 Test Loss: 0.537 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7674782276153564
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.531 Vali Acc: 0.906 Test Loss: 0.531 Test Acc: 0.906
Validation loss decreased (-0.899995 --> -0.905550).  Saving model ...
Epoch: 31 cost time: 3.805851936340332
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.565 Vali Acc: 0.883 Test Loss: 0.565 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.521094560623169
Epoch: 32, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.572 Vali Acc: 0.883 Test Loss: 0.572 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5999655723571777
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.891190528869629
Epoch: 34, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.7267725467681885
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.552 Vali Acc: 0.894 Test Loss: 0.552 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.207934379577637
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.883 Test Loss: 0.596 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.7147157192230225
Epoch: 37, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.608 Vali Acc: 0.883 Test Loss: 0.608 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.6718475818634033
Epoch: 38, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.591 Vali Acc: 0.906 Test Loss: 0.591 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.8070356845855713
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.603 Vali Acc: 0.894 Test Loss: 0.603 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.9555325508117676
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.889 Test Loss: 0.609 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.116074562072754
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.659 Vali Acc: 0.122 Test Loss: 2.659 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 3.486884117126465
Epoch: 2, Steps: 12 | Train Loss: 2.565 Vali Loss: 2.389 Vali Acc: 0.267 Test Loss: 2.389 Test Acc: 0.267
Validation loss decreased (-0.122196 --> -0.266643).  Saving model ...
Epoch: 3 cost time: 3.5292224884033203
Epoch: 3, Steps: 12 | Train Loss: 2.321 Vali Loss: 2.111 Vali Acc: 0.367 Test Loss: 2.111 Test Acc: 0.367
Validation loss decreased (-0.266643 --> -0.366646).  Saving model ...
Epoch: 4 cost time: 3.710237741470337
Epoch: 4, Steps: 12 | Train Loss: 2.049 Vali Loss: 1.880 Vali Acc: 0.550 Test Loss: 1.880 Test Acc: 0.550
Validation loss decreased (-0.366646 --> -0.549981).  Saving model ...
Epoch: 5 cost time: 3.6933279037475586
Epoch: 5, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.668 Vali Acc: 0.561 Test Loss: 1.668 Test Acc: 0.561
Validation loss decreased (-0.549981 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 3.332381248474121
Epoch: 6, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.512 Vali Acc: 0.594 Test Loss: 1.512 Test Acc: 0.594
Validation loss decreased (-0.561094 --> -0.594429).  Saving model ...
Epoch: 7 cost time: 3.5927586555480957
Epoch: 7, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.304 Vali Acc: 0.628 Test Loss: 1.304 Test Acc: 0.628
Validation loss decreased (-0.594429 --> -0.627765).  Saving model ...
Epoch: 8 cost time: 3.5723178386688232
Epoch: 8, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.112 Vali Acc: 0.683 Test Loss: 1.112 Test Acc: 0.683
Validation loss decreased (-0.627765 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 3.934039354324341
Epoch: 9, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.937 Vali Acc: 0.722 Test Loss: 0.937 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722213).  Saving model ...
Epoch: 10 cost time: 3.31512713432312
Epoch: 10, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.866 Vali Acc: 0.744 Test Loss: 0.866 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 11 cost time: 4.15156888961792
Epoch: 11, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.836 Vali Acc: 0.739 Test Loss: 0.836 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4961326122283936
Epoch: 12, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.751 Vali Acc: 0.767 Test Loss: 0.751 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 3.665748357772827
Epoch: 13, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
Validation loss decreased (-0.766659 --> -0.805549).  Saving model ...
Epoch: 14 cost time: 3.594869375228882
Epoch: 14, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 3.733473777770996
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 16 cost time: 3.3973071575164795
Epoch: 16, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 3.3866217136383057
Epoch: 17, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 3.215973377227783
Epoch: 18, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4489269256591797
Epoch: 19, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6311795711517334
Epoch: 20, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 3.5349786281585693
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6547951698303223
Epoch: 22, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5368876457214355
Epoch: 23, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.494 Vali Acc: 0.861 Test Loss: 0.494 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.299797534942627
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4792592525482178
Epoch: 25, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.47233510017395
Epoch: 26, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5574698448181152
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5363364219665527
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.6938064098358154
Epoch: 29, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.547 Vali Acc: 0.867 Test Loss: 0.547 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.286330223083496
Epoch: 30, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.533 Vali Acc: 0.872 Test Loss: 0.533 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 3.7139499187469482
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.216897487640381
Epoch: 32, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.567 Vali Acc: 0.872 Test Loss: 0.567 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.318936586380005
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.3263537883758545
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.861 Test Loss: 0.602 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2074759006500244
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.113588809967041
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.134319305419922
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.582 Vali Acc: 0.872 Test Loss: 0.582 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.146707534790039
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.872 Test Loss: 0.584 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.3719472885131836
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.878 Test Loss: 0.593 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 3.4137701988220215
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.597 Vali Acc: 0.872 Test Loss: 0.597 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.8736324310302734
Epoch: 41, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.592 Vali Acc: 0.883 Test Loss: 0.592 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 42 cost time: 3.5121779441833496
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.685882091522217
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.611 Vali Acc: 0.872 Test Loss: 0.611 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.6578269004821777
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.607 Vali Acc: 0.883 Test Loss: 0.607 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.882265329360962
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.878 Test Loss: 0.609 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.471463203430176
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.621 Vali Acc: 0.878 Test Loss: 0.621 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.753885269165039
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.624 Vali Acc: 0.878 Test Loss: 0.624 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.537156581878662
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.617 Vali Acc: 0.883 Test Loss: 0.617 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.7626266479492188
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.633 Vali Acc: 0.878 Test Loss: 0.633 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.3380024433135986
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.883 Test Loss: 0.619 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.743136167526245
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.622 Vali Acc: 0.883 Test Loss: 0.622 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.101911544799805
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.732 Vali Acc: 0.072 Test Loss: 2.732 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 4.026473522186279
Epoch: 2, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.545 Vali Acc: 0.189 Test Loss: 2.545 Test Acc: 0.189
Validation loss decreased (-0.072195 --> -0.188863).  Saving model ...
Epoch: 3 cost time: 3.965222120285034
Epoch: 3, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.335 Vali Acc: 0.300 Test Loss: 2.335 Test Acc: 0.300
Validation loss decreased (-0.188863 --> -0.299977).  Saving model ...
Epoch: 4 cost time: 3.4897661209106445
Epoch: 4, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.137 Vali Acc: 0.317 Test Loss: 2.137 Test Acc: 0.317
Validation loss decreased (-0.299977 --> -0.316645).  Saving model ...
Epoch: 5 cost time: 3.626129388809204
Epoch: 5, Steps: 12 | Train Loss: 2.065 Vali Loss: 1.949 Vali Acc: 0.406 Test Loss: 1.949 Test Acc: 0.406
Validation loss decreased (-0.316645 --> -0.405536).  Saving model ...
Epoch: 6 cost time: 3.7610809803009033
Epoch: 6, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.791 Vali Acc: 0.394 Test Loss: 1.791 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8518168926239014
Epoch: 7, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.538 Vali Acc: 0.500 Test Loss: 1.538 Test Acc: 0.500
Validation loss decreased (-0.405536 --> -0.499985).  Saving model ...
Epoch: 8 cost time: 3.741743564605713
Epoch: 8, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.273 Vali Acc: 0.617 Test Loss: 1.273 Test Acc: 0.617
Validation loss decreased (-0.499985 --> -0.616654).  Saving model ...
Epoch: 9 cost time: 3.609740734100342
Epoch: 9, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.051 Vali Acc: 0.722 Test Loss: 1.051 Test Acc: 0.722
Validation loss decreased (-0.616654 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 3.343587636947632
Epoch: 10, Steps: 12 | Train Loss: 0.902 Vali Loss: 0.927 Vali Acc: 0.717 Test Loss: 0.927 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3012399673461914
Epoch: 11, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.886 Vali Acc: 0.728 Test Loss: 0.886 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 3.4487767219543457
Epoch: 12, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.800 Vali Acc: 0.733 Test Loss: 0.800 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 3.5246694087982178
Epoch: 13, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.723 Vali Acc: 0.744 Test Loss: 0.723 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 3.276918888092041
Epoch: 14, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.688 Vali Acc: 0.772 Test Loss: 0.688 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 3.356595277786255
Epoch: 15, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.596 Vali Acc: 0.806 Test Loss: 0.596 Test Acc: 0.806
Validation loss decreased (-0.772215 --> -0.805550).  Saving model ...
Epoch: 16 cost time: 3.219944953918457
Epoch: 16, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6697754859924316
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.633 Vali Acc: 0.817 Test Loss: 0.633 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816660).  Saving model ...
Epoch: 18 cost time: 3.556300401687622
Epoch: 18, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.571 Vali Acc: 0.817 Test Loss: 0.571 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 19 cost time: 3.6554925441741943
Epoch: 19, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.561 Vali Acc: 0.828 Test Loss: 0.561 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 3.5591721534729004
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 3.7280945777893066
Epoch: 21, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.580 Vali Acc: 0.833 Test Loss: 0.580 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.4800539016723633
Epoch: 22, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.4468023777008057
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.701648235321045
Epoch: 24, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 3.4200990200042725
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.460979700088501
Epoch: 26, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 3.392151355743408
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2706966400146484
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.574 Vali Acc: 0.867 Test Loss: 0.574 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 29 cost time: 3.0948586463928223
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.595200538635254
Epoch: 30, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.440110921859741
Epoch: 31, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.614 Vali Acc: 0.872 Test Loss: 0.614 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 32 cost time: 3.547471761703491
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.335606575012207
Epoch: 33, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.5466697216033936
Epoch: 34, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.647 Vali Acc: 0.867 Test Loss: 0.647 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.4164681434631348
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.4777917861938477
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877772).  Saving model ...
Epoch: 37 cost time: 3.3078131675720215
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.599 Vali Acc: 0.878 Test Loss: 0.599 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.665001392364502
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.4643774032592773
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.648 Vali Acc: 0.861 Test Loss: 0.648 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.558237075805664
Epoch: 40, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.626 Vali Acc: 0.867 Test Loss: 0.626 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.489903688430786
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.867 Test Loss: 0.631 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.466642141342163
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.615396499633789
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.878 Test Loss: 0.643 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.243605613708496
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.872 Test Loss: 0.639 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.4072606563568115
Epoch: 45, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.872 Test Loss: 0.639 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.7343950271606445
Epoch: 46, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.662 Vali Acc: 0.883 Test Loss: 0.662 Test Acc: 0.883
Validation loss decreased (-0.877772 --> -0.883327).  Saving model ...
Epoch: 47 cost time: 3.734766960144043
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.599149465560913
Epoch: 48, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.657 Vali Acc: 0.878 Test Loss: 0.657 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.684750556945801
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.878 Test Loss: 0.670 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.403907537460327
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.654 Vali Acc: 0.867 Test Loss: 0.654 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.4673571586608887
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.664 Vali Acc: 0.856 Test Loss: 0.664 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.4576988220214844
Epoch: 52, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.671 Vali Acc: 0.872 Test Loss: 0.671 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.383474349975586
Epoch: 53, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.677 Vali Acc: 0.878 Test Loss: 0.677 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.4229700565338135
Epoch: 54, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.692 Vali Acc: 0.861 Test Loss: 0.692 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.5465219020843506
Epoch: 55, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.676 Vali Acc: 0.872 Test Loss: 0.676 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.5815584659576416
Epoch: 56, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.856 Test Loss: 0.662 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.613718748092651
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.693 Vali Acc: 0.089 Test Loss: 2.693 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 3.6487042903900146
Epoch: 2, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.451 Vali Acc: 0.233 Test Loss: 2.451 Test Acc: 0.233
Validation loss decreased (-0.088862 --> -0.233309).  Saving model ...
Epoch: 3 cost time: 3.680485963821411
Epoch: 3, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.187 Vali Acc: 0.300 Test Loss: 2.187 Test Acc: 0.300
Validation loss decreased (-0.233309 --> -0.299978).  Saving model ...
Epoch: 4 cost time: 3.6622314453125
Epoch: 4, Steps: 12 | Train Loss: 2.385 Vali Loss: 1.984 Vali Acc: 0.272 Test Loss: 1.984 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.1268229484558105
Epoch: 5, Steps: 12 | Train Loss: 2.181 Vali Loss: 1.848 Vali Acc: 0.367 Test Loss: 1.848 Test Acc: 0.367
Validation loss decreased (-0.299978 --> -0.366648).  Saving model ...
Epoch: 6 cost time: 3.861253023147583
Epoch: 6, Steps: 12 | Train Loss: 1.972 Vali Loss: 1.745 Vali Acc: 0.383 Test Loss: 1.745 Test Acc: 0.383
Validation loss decreased (-0.366648 --> -0.383316).  Saving model ...
Epoch: 7 cost time: 4.060771226882935
Epoch: 7, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.509 Vali Acc: 0.489 Test Loss: 1.509 Test Acc: 0.489
Validation loss decreased (-0.383316 --> -0.488874).  Saving model ...
Epoch: 8 cost time: 3.603818416595459
Epoch: 8, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.353 Vali Acc: 0.556 Test Loss: 1.353 Test Acc: 0.556
Validation loss decreased (-0.488874 --> -0.555542).  Saving model ...
Epoch: 9 cost time: 3.539987087249756
Epoch: 9, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.139 Vali Acc: 0.667 Test Loss: 1.139 Test Acc: 0.667
Validation loss decreased (-0.555542 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 3.4336044788360596
Epoch: 10, Steps: 12 | Train Loss: 0.958 Vali Loss: 1.043 Vali Acc: 0.644 Test Loss: 1.043 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8044440746307373
Epoch: 11, Steps: 12 | Train Loss: 0.784 Vali Loss: 1.009 Vali Acc: 0.694 Test Loss: 1.009 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 3.303231716156006
Epoch: 12, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.930 Vali Acc: 0.667 Test Loss: 0.930 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6571872234344482
Epoch: 13, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.846 Vali Acc: 0.661 Test Loss: 0.846 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.772815227508545
Epoch: 14, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.765 Vali Acc: 0.744 Test Loss: 0.765 Test Acc: 0.744
Validation loss decreased (-0.694434 --> -0.744437).  Saving model ...
Epoch: 15 cost time: 3.8006651401519775
Epoch: 15, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.666 Vali Acc: 0.772 Test Loss: 0.666 Test Acc: 0.772
Validation loss decreased (-0.744437 --> -0.772216).  Saving model ...
Epoch: 16 cost time: 3.734438180923462
Epoch: 16, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
Validation loss decreased (-0.772216 --> -0.788882).  Saving model ...
Epoch: 17 cost time: 4.103459596633911
Epoch: 17, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 3.865598678588867
Epoch: 18, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.589 Vali Acc: 0.828 Test Loss: 0.589 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.827772).  Saving model ...
Epoch: 19 cost time: 3.858525514602661
Epoch: 19, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.573 Vali Acc: 0.817 Test Loss: 0.573 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.363309621810913
Epoch: 20, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.137580633163452
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.932424306869507
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6587531566619873
Epoch: 23, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.625 Vali Acc: 0.817 Test Loss: 0.625 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9004924297332764
Epoch: 24, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.639 Vali Acc: 0.817 Test Loss: 0.639 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4770774841308594
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.475982427597046
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 3.4090468883514404
Epoch: 27, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.642 Vali Acc: 0.811 Test Loss: 0.642 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.621245861053467
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.597841262817383
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.605 Vali Acc: 0.833 Test Loss: 0.605 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 3.9049761295318604
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.673 Vali Acc: 0.811 Test Loss: 0.673 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.172865867614746
Epoch: 31, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861104).  Saving model ...
Epoch: 32 cost time: 3.610992193222046
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.660 Vali Acc: 0.817 Test Loss: 0.660 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.8302102088928223
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.701 Vali Acc: 0.839 Test Loss: 0.701 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.9093451499938965
Epoch: 34, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.6614625453948975
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.538670063018799
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.723 Vali Acc: 0.839 Test Loss: 0.723 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.771761178970337
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.726 Vali Acc: 0.839 Test Loss: 0.726 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.5995888710021973
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.723 Vali Acc: 0.839 Test Loss: 0.723 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.4311282634735107
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.720 Vali Acc: 0.839 Test Loss: 0.720 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.7066471576690674
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.3987367153167725
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.614085912704468
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.577 Vali Acc: 0.189 Test Loss: 2.577 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 3.299617290496826
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.235 Vali Acc: 0.306 Test Loss: 2.235 Test Acc: 0.306
Validation loss decreased (-0.188863 --> -0.305533).  Saving model ...
Epoch: 3 cost time: 3.916736364364624
Epoch: 3, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.043 Vali Acc: 0.356 Test Loss: 2.043 Test Acc: 0.356
Validation loss decreased (-0.305533 --> -0.355535).  Saving model ...
Epoch: 4 cost time: 3.7393667697906494
Epoch: 4, Steps: 12 | Train Loss: 2.450 Vali Loss: 1.919 Vali Acc: 0.383 Test Loss: 1.919 Test Acc: 0.383
Validation loss decreased (-0.355535 --> -0.383314).  Saving model ...
Epoch: 5 cost time: 3.713754177093506
Epoch: 5, Steps: 12 | Train Loss: 2.206 Vali Loss: 1.841 Vali Acc: 0.389 Test Loss: 1.841 Test Acc: 0.389
Validation loss decreased (-0.383314 --> -0.388870).  Saving model ...
Epoch: 6 cost time: 3.658137321472168
Epoch: 6, Steps: 12 | Train Loss: 2.022 Vali Loss: 1.756 Vali Acc: 0.433 Test Loss: 1.756 Test Acc: 0.433
Validation loss decreased (-0.388870 --> -0.433316).  Saving model ...
Epoch: 7 cost time: 3.4603936672210693
Epoch: 7, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.535 Vali Acc: 0.483 Test Loss: 1.535 Test Acc: 0.483
Validation loss decreased (-0.433316 --> -0.483318).  Saving model ...
Epoch: 8 cost time: 4.006766080856323
Epoch: 8, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.397 Vali Acc: 0.561 Test Loss: 1.397 Test Acc: 0.561
Validation loss decreased (-0.483318 --> -0.561097).  Saving model ...
Epoch: 9 cost time: 3.801786422729492
Epoch: 9, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.111 Vali Acc: 0.644 Test Loss: 1.111 Test Acc: 0.644
Validation loss decreased (-0.561097 --> -0.644433).  Saving model ...
Epoch: 10 cost time: 3.8342058658599854
Epoch: 10, Steps: 12 | Train Loss: 0.940 Vali Loss: 1.004 Vali Acc: 0.672 Test Loss: 1.004 Test Acc: 0.672
Validation loss decreased (-0.644433 --> -0.672212).  Saving model ...
Epoch: 11 cost time: 3.4927446842193604
Epoch: 11, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.952 Vali Acc: 0.678 Test Loss: 0.952 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 12 cost time: 3.5048468112945557
Epoch: 12, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.885 Vali Acc: 0.667 Test Loss: 0.885 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.629664182662964
Epoch: 13, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
Validation loss decreased (-0.677768 --> -0.727770).  Saving model ...
Epoch: 14 cost time: 3.7172133922576904
Epoch: 14, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.710 Vali Acc: 0.767 Test Loss: 0.710 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 3.6488828659057617
Epoch: 15, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.655 Vali Acc: 0.811 Test Loss: 0.655 Test Acc: 0.811
Validation loss decreased (-0.766660 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 3.756573438644409
Epoch: 16, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.655 Vali Acc: 0.800 Test Loss: 0.655 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9688916206359863
Epoch: 17, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.623 Vali Acc: 0.806 Test Loss: 0.623 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9119863510131836
Epoch: 18, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 3.8194217681884766
Epoch: 19, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.573 Vali Acc: 0.828 Test Loss: 0.573 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 4.033232688903809
Epoch: 20, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8832502365112305
Epoch: 21, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.927638053894043
Epoch: 22, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 4.101951837539673
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.614 Vali Acc: 0.844 Test Loss: 0.614 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 24 cost time: 3.711822986602783
Epoch: 24, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.661466121673584
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.628 Vali Acc: 0.828 Test Loss: 0.628 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7308578491210938
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.681 Vali Acc: 0.844 Test Loss: 0.681 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5271873474121094
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.688 Vali Acc: 0.817 Test Loss: 0.688 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.812734603881836
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.714 Vali Acc: 0.828 Test Loss: 0.714 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.825578451156616
Epoch: 29, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.653 Vali Acc: 0.828 Test Loss: 0.653 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.624011754989624
Epoch: 30, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.681 Vali Acc: 0.794 Test Loss: 0.681 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.442619562149048
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.705 Vali Acc: 0.856 Test Loss: 0.705 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 32 cost time: 3.833974599838257
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.673 Vali Acc: 0.833 Test Loss: 0.673 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.8100054264068604
Epoch: 33, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.6556954383850098
Epoch: 34, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.8859076499938965
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.656 Vali Acc: 0.861 Test Loss: 0.656 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 3.793017625808716
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.679 Vali Acc: 0.839 Test Loss: 0.679 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.0647759437561035
Epoch: 37, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.685 Vali Acc: 0.856 Test Loss: 0.685 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.561568260192871
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.679 Vali Acc: 0.839 Test Loss: 0.679 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.555877685546875
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.703 Vali Acc: 0.856 Test Loss: 0.703 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.5568647384643555
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.700 Vali Acc: 0.839 Test Loss: 0.700 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.6920101642608643
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.4300458431243896
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.697 Vali Acc: 0.828 Test Loss: 0.697 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.6487884521484375
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.698288679122925
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.5167596340179443
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.298325300216675
Epoch: 1, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.611 Vali Acc: 0.139 Test Loss: 2.611 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 3.2347891330718994
Epoch: 2, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.328 Vali Acc: 0.272 Test Loss: 2.328 Test Acc: 0.272
Validation loss decreased (-0.138863 --> -0.272199).  Saving model ...
Epoch: 3 cost time: 3.4386157989501953
Epoch: 3, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.067 Vali Acc: 0.356 Test Loss: 2.067 Test Acc: 0.356
Validation loss decreased (-0.272199 --> -0.355535).  Saving model ...
Epoch: 4 cost time: 3.235703706741333
Epoch: 4, Steps: 12 | Train Loss: 2.497 Vali Loss: 1.909 Vali Acc: 0.394 Test Loss: 1.909 Test Acc: 0.394
Validation loss decreased (-0.355535 --> -0.394425).  Saving model ...
Epoch: 5 cost time: 3.388474464416504
Epoch: 5, Steps: 12 | Train Loss: 2.279 Vali Loss: 1.813 Vali Acc: 0.433 Test Loss: 1.813 Test Acc: 0.433
Validation loss decreased (-0.394425 --> -0.433315).  Saving model ...
Epoch: 6 cost time: 3.2813100814819336
Epoch: 6, Steps: 12 | Train Loss: 2.049 Vali Loss: 1.713 Vali Acc: 0.444 Test Loss: 1.713 Test Acc: 0.444
Validation loss decreased (-0.433315 --> -0.444427).  Saving model ...
Epoch: 7 cost time: 3.41984486579895
Epoch: 7, Steps: 12 | Train Loss: 1.771 Vali Loss: 1.512 Vali Acc: 0.494 Test Loss: 1.512 Test Acc: 0.494
Validation loss decreased (-0.444427 --> -0.494429).  Saving model ...
Epoch: 8 cost time: 3.4030723571777344
Epoch: 8, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.365 Vali Acc: 0.556 Test Loss: 1.365 Test Acc: 0.556
Validation loss decreased (-0.494429 --> -0.555542).  Saving model ...
Epoch: 9 cost time: 3.252330780029297
Epoch: 9, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.094 Vali Acc: 0.667 Test Loss: 1.094 Test Acc: 0.667
Validation loss decreased (-0.555542 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 3.1825361251831055
Epoch: 10, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.998 Vali Acc: 0.650 Test Loss: 0.998 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4128944873809814
Epoch: 11, Steps: 12 | Train Loss: 0.815 Vali Loss: 0.947 Vali Acc: 0.706 Test Loss: 0.947 Test Acc: 0.706
Validation loss decreased (-0.666656 --> -0.705546).  Saving model ...
Epoch: 12 cost time: 3.2797157764434814
Epoch: 12, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.874 Vali Acc: 0.678 Test Loss: 0.874 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.542876720428467
Epoch: 13, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.785 Vali Acc: 0.678 Test Loss: 0.785 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3724329471588135
Epoch: 14, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
Validation loss decreased (-0.705546 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 3.4558801651000977
Epoch: 15, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.620 Vali Acc: 0.789 Test Loss: 0.620 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788883).  Saving model ...
Epoch: 16 cost time: 3.434141159057617
Epoch: 16, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.631 Vali Acc: 0.772 Test Loss: 0.631 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3855221271514893
Epoch: 17, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.607 Vali Acc: 0.817 Test Loss: 0.607 Test Acc: 0.817
Validation loss decreased (-0.788883 --> -0.816661).  Saving model ...
Epoch: 18 cost time: 3.570795774459839
Epoch: 18, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.571 Vali Acc: 0.794 Test Loss: 0.571 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9359586238861084
Epoch: 19, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.565 Vali Acc: 0.817 Test Loss: 0.565 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 20 cost time: 3.5838663578033447
Epoch: 20, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.549 Vali Acc: 0.817 Test Loss: 0.549 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 21 cost time: 3.925610303878784
Epoch: 21, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.602 Vali Acc: 0.806 Test Loss: 0.602 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.521954298019409
Epoch: 22, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.571 Vali Acc: 0.822 Test Loss: 0.571 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 23 cost time: 3.601095199584961
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 3.563321113586426
Epoch: 24, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2869961261749268
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 3.3115053176879883
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 3.472944974899292
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.623 Vali Acc: 0.828 Test Loss: 0.623 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.496461868286133
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.4444291591644287
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.3875269889831543
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.631 Vali Acc: 0.839 Test Loss: 0.631 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.672982692718506
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.663 Vali Acc: 0.856 Test Loss: 0.663 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.6439883708953857
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.666 Vali Acc: 0.828 Test Loss: 0.666 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.635296583175659
Epoch: 33, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.632 Vali Acc: 0.839 Test Loss: 0.632 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.6885857582092285
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.772669553756714
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.6667063236236572
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.654 Vali Acc: 0.856 Test Loss: 0.654 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.154517650604248
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.4604177474975586
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3816936016082764
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.532252550125122
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 3.4633450508117676
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 3.2922723293304443
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1931142807006836
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.494199752807617
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 9 cost time: 3.401822328567505
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 10 cost time: 3.2151834964752197
Epoch: 10, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 11 cost time: 3.3719382286071777
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.553767442703247
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6438589096069336
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.892369031906128
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.038722991943359
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.904054880142212
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.550060272216797
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.6297926902770996
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.733969211578369
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.8545939922332764
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 929039
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.176800012588501
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.637 Vali Acc: 0.106 Test Loss: 2.637 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 3.6206557750701904
Epoch: 2, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.204 Vali Acc: 0.483 Test Loss: 2.204 Test Acc: 0.483
Validation loss decreased (-0.105529 --> -0.483311).  Saving model ...
Epoch: 3 cost time: 3.5338239669799805
Epoch: 3, Steps: 12 | Train Loss: 2.094 Vali Loss: 1.797 Vali Acc: 0.633 Test Loss: 1.797 Test Acc: 0.633
Validation loss decreased (-0.483311 --> -0.633315).  Saving model ...
Epoch: 4 cost time: 3.4867961406707764
Epoch: 4, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.500 Vali Acc: 0.667 Test Loss: 1.500 Test Acc: 0.667
Validation loss decreased (-0.633315 --> -0.666652).  Saving model ...
Epoch: 5 cost time: 3.6070079803466797
Epoch: 5, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.306 Vali Acc: 0.672 Test Loss: 1.306 Test Acc: 0.672
Validation loss decreased (-0.666652 --> -0.672209).  Saving model ...
Epoch: 6 cost time: 3.551133394241333
Epoch: 6, Steps: 12 | Train Loss: 1.073 Vali Loss: 1.151 Vali Acc: 0.711 Test Loss: 1.151 Test Acc: 0.711
Validation loss decreased (-0.672209 --> -0.711100).  Saving model ...
Epoch: 7 cost time: 3.694415330886841
Epoch: 7, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.981 Vali Acc: 0.744 Test Loss: 0.981 Test Acc: 0.744
Validation loss decreased (-0.711100 --> -0.744435).  Saving model ...
Epoch: 8 cost time: 3.4272656440734863
Epoch: 8, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 3.5231213569641113
Epoch: 9, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.744 Vali Acc: 0.778 Test Loss: 0.744 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777770).  Saving model ...
Epoch: 10 cost time: 3.4762165546417236
Epoch: 10, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
Validation loss decreased (-0.777770 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 3.499735116958618
Epoch: 11, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 12 cost time: 3.5899345874786377
Epoch: 12, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 3.3883731365203857
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855551).  Saving model ...
Epoch: 14 cost time: 3.501152515411377
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
Validation loss decreased (-0.855551 --> -0.872217).  Saving model ...
Epoch: 15 cost time: 3.5508248805999756
Epoch: 15, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3676397800445557
Epoch: 16, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888885).  Saving model ...
Epoch: 17 cost time: 3.403991460800171
Epoch: 17, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.483278751373291
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.383 Vali Acc: 0.883 Test Loss: 0.383 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7683913707733154
Epoch: 19, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
Validation loss decreased (-0.888885 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 3.670621156692505
Epoch: 20, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.380 Vali Acc: 0.906 Test Loss: 0.380 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.012006759643555
Epoch: 21, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7511072158813477
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.408 Vali Acc: 0.878 Test Loss: 0.408 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.653780221939087
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.408 Vali Acc: 0.894 Test Loss: 0.408 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.3145222663879395
Epoch: 24, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.114717245101929
Epoch: 25, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.2985610961914062
Epoch: 26, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.3902578353881836
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.5324654579162598
Epoch: 28, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.407 Vali Acc: 0.906 Test Loss: 0.407 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.91249680519104
Epoch: 29, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.409 Vali Acc: 0.906 Test Loss: 0.409 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.4342310428619385
Epoch: 1, Steps: 12 | Train Loss: 2.821 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.7706456184387207
Epoch: 2, Steps: 12 | Train Loss: 2.535 Vali Loss: 2.340 Vali Acc: 0.433 Test Loss: 2.340 Test Acc: 0.433
Validation loss decreased (-0.066640 --> -0.433310).  Saving model ...
Epoch: 3 cost time: 3.6246120929718018
Epoch: 3, Steps: 12 | Train Loss: 2.233 Vali Loss: 1.980 Vali Acc: 0.522 Test Loss: 1.980 Test Acc: 0.522
Validation loss decreased (-0.433310 --> -0.522202).  Saving model ...
Epoch: 4 cost time: 3.717494010925293
Epoch: 4, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.708 Vali Acc: 0.539 Test Loss: 1.708 Test Acc: 0.539
Validation loss decreased (-0.522202 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 3.2848939895629883
Epoch: 5, Steps: 12 | Train Loss: 1.558 Vali Loss: 1.510 Vali Acc: 0.578 Test Loss: 1.510 Test Acc: 0.578
Validation loss decreased (-0.538872 --> -0.577763).  Saving model ...
Epoch: 6 cost time: 3.9019954204559326
Epoch: 6, Steps: 12 | Train Loss: 1.323 Vali Loss: 1.334 Vali Acc: 0.633 Test Loss: 1.334 Test Acc: 0.633
Validation loss decreased (-0.577763 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 3.5498180389404297
Epoch: 7, Steps: 12 | Train Loss: 1.040 Vali Loss: 1.152 Vali Acc: 0.683 Test Loss: 1.152 Test Acc: 0.683
Validation loss decreased (-0.633320 --> -0.683322).  Saving model ...
Epoch: 8 cost time: 4.445202112197876
Epoch: 8, Steps: 12 | Train Loss: 0.850 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 3.576319932937622
Epoch: 9, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.890 Vali Acc: 0.733 Test Loss: 0.890 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 3.753608226776123
Epoch: 10, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.772 Vali Acc: 0.778 Test Loss: 0.772 Test Acc: 0.778
Validation loss decreased (-0.733324 --> -0.777770).  Saving model ...
Epoch: 11 cost time: 3.3873472213745117
Epoch: 11, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.733 Vali Acc: 0.800 Test Loss: 0.733 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 3.795297622680664
Epoch: 12, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.661 Vali Acc: 0.828 Test Loss: 0.661 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827771).  Saving model ...
Epoch: 13 cost time: 3.985225200653076
Epoch: 13, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 3.3444559574127197
Epoch: 14, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 15 cost time: 3.591295003890991
Epoch: 15, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.492 Vali Acc: 0.856 Test Loss: 0.492 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 16 cost time: 3.759432077407837
Epoch: 16, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.518 Vali Acc: 0.878 Test Loss: 0.518 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877773).  Saving model ...
Epoch: 17 cost time: 3.6962506771087646
Epoch: 17, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.475 Vali Acc: 0.889 Test Loss: 0.475 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 4.261620283126831
Epoch: 18, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.160236835479736
Epoch: 19, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9710769653320312
Epoch: 20, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.489 Vali Acc: 0.872 Test Loss: 0.489 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.6897852420806885
Epoch: 21, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 3.447652816772461
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8548824787139893
Epoch: 23, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.889 Test Loss: 0.532 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5674655437469482
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.526 Vali Acc: 0.883 Test Loss: 0.526 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2606518268585205
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.406599760055542
Epoch: 26, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.528 Vali Acc: 0.894 Test Loss: 0.528 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.247321128845215
Epoch: 27, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.527 Vali Acc: 0.883 Test Loss: 0.527 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.654224157333374
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.542 Vali Acc: 0.894 Test Loss: 0.542 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.585811138153076
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.547 Vali Acc: 0.883 Test Loss: 0.547 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.270362377166748
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.547 Vali Acc: 0.894 Test Loss: 0.547 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.2848269939422607
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.878 Test Loss: 0.556 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.335185289382935
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.753 Vali Acc: 0.144 Test Loss: 2.753 Test Acc: 0.144
Validation loss decreased (inf --> -0.144417).  Saving model ...
Epoch: 2 cost time: 3.3267436027526855
Epoch: 2, Steps: 12 | Train Loss: 2.612 Vali Loss: 2.445 Vali Acc: 0.322 Test Loss: 2.445 Test Acc: 0.322
Validation loss decreased (-0.144417 --> -0.322198).  Saving model ...
Epoch: 3 cost time: 3.4668166637420654
Epoch: 3, Steps: 12 | Train Loss: 2.359 Vali Loss: 2.139 Vali Acc: 0.461 Test Loss: 2.139 Test Acc: 0.461
Validation loss decreased (-0.322198 --> -0.461090).  Saving model ...
Epoch: 4 cost time: 3.2518231868743896
Epoch: 4, Steps: 12 | Train Loss: 2.067 Vali Loss: 1.897 Vali Acc: 0.489 Test Loss: 1.897 Test Acc: 0.489
Validation loss decreased (-0.461090 --> -0.488870).  Saving model ...
Epoch: 5 cost time: 3.674215316772461
Epoch: 5, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.713 Vali Acc: 0.522 Test Loss: 1.713 Test Acc: 0.522
Validation loss decreased (-0.488870 --> -0.522205).  Saving model ...
Epoch: 6 cost time: 3.4758172035217285
Epoch: 6, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.516 Vali Acc: 0.567 Test Loss: 1.516 Test Acc: 0.567
Validation loss decreased (-0.522205 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 3.2042670249938965
Epoch: 7, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.299 Vali Acc: 0.639 Test Loss: 1.299 Test Acc: 0.639
Validation loss decreased (-0.566652 --> -0.638876).  Saving model ...
Epoch: 8 cost time: 3.2869770526885986
Epoch: 8, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.135 Vali Acc: 0.656 Test Loss: 1.135 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 3.3913655281066895
Epoch: 9, Steps: 12 | Train Loss: 1.014 Vali Loss: 0.988 Vali Acc: 0.683 Test Loss: 0.988 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 3.5426840782165527
Epoch: 10, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.868 Vali Acc: 0.722 Test Loss: 0.868 Test Acc: 0.722
Validation loss decreased (-0.683323 --> -0.722214).  Saving model ...
Epoch: 11 cost time: 3.52524995803833
Epoch: 11, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.809 Vali Acc: 0.761 Test Loss: 0.809 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761103).  Saving model ...
Epoch: 12 cost time: 3.306933879852295
Epoch: 12, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 13 cost time: 3.7956082820892334
Epoch: 13, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.685 Vali Acc: 0.794 Test Loss: 0.685 Test Acc: 0.794
Validation loss decreased (-0.777770 --> -0.794438).  Saving model ...
Epoch: 14 cost time: 3.4830613136291504
Epoch: 14, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.691988706588745
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822217).  Saving model ...
Epoch: 16 cost time: 3.6072535514831543
Epoch: 16, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.565 Vali Acc: 0.839 Test Loss: 0.565 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 4.066713094711304
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.868961811065674
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 4.035940647125244
Epoch: 19, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 20 cost time: 3.8484790325164795
Epoch: 20, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.518 Vali Acc: 0.839 Test Loss: 0.518 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7252845764160156
Epoch: 21, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.539 Vali Acc: 0.861 Test Loss: 0.539 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 22 cost time: 3.6771767139434814
Epoch: 22, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.557 Vali Acc: 0.856 Test Loss: 0.557 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.546929121017456
Epoch: 23, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.556 Vali Acc: 0.844 Test Loss: 0.556 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5616955757141113
Epoch: 24, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.699807643890381
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 3.4321796894073486
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.531 Vali Acc: 0.883 Test Loss: 0.531 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883328).  Saving model ...
Epoch: 27 cost time: 3.573073148727417
Epoch: 27, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.517 Vali Acc: 0.872 Test Loss: 0.517 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.343431234359741
Epoch: 28, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.563 Vali Acc: 0.867 Test Loss: 0.563 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.6231014728546143
Epoch: 29, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.4366981983184814
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.538 Vali Acc: 0.878 Test Loss: 0.538 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.628870725631714
Epoch: 31, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.550 Vali Acc: 0.872 Test Loss: 0.550 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.5198593139648438
Epoch: 32, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.566 Vali Acc: 0.872 Test Loss: 0.566 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.357787609100342
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.551 Vali Acc: 0.894 Test Loss: 0.551 Test Acc: 0.894
Validation loss decreased (-0.883328 --> -0.894439).  Saving model ...
Epoch: 34 cost time: 3.540972948074341
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.556 Vali Acc: 0.878 Test Loss: 0.556 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5266048908233643
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.562 Vali Acc: 0.883 Test Loss: 0.562 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.553502321243286
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.565 Vali Acc: 0.889 Test Loss: 0.565 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.565473794937134
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.550 Vali Acc: 0.883 Test Loss: 0.550 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.6075799465179443
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.567 Vali Acc: 0.894 Test Loss: 0.567 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.7365238666534424
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.883 Test Loss: 0.583 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.5382957458496094
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.579 Vali Acc: 0.894 Test Loss: 0.579 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.7582247257232666
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.574 Vali Acc: 0.894 Test Loss: 0.574 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.449641227722168
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.894 Test Loss: 0.598 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.334913730621338
Epoch: 43, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.589 Vali Acc: 0.894 Test Loss: 0.589 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.225157737731934
Epoch: 1, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.760 Vali Acc: 0.111 Test Loss: 2.760 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 3.4486782550811768
Epoch: 2, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.550 Vali Acc: 0.117 Test Loss: 2.550 Test Acc: 0.117
Validation loss decreased (-0.111084 --> -0.116641).  Saving model ...
Epoch: 3 cost time: 3.525162935256958
Epoch: 3, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.326 Vali Acc: 0.289 Test Loss: 2.326 Test Acc: 0.289
Validation loss decreased (-0.116641 --> -0.288866).  Saving model ...
Epoch: 4 cost time: 3.792548656463623
Epoch: 4, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.124 Vali Acc: 0.367 Test Loss: 2.124 Test Acc: 0.367
Validation loss decreased (-0.288866 --> -0.366645).  Saving model ...
Epoch: 5 cost time: 3.516627788543701
Epoch: 5, Steps: 12 | Train Loss: 2.038 Vali Loss: 1.959 Vali Acc: 0.394 Test Loss: 1.959 Test Acc: 0.394
Validation loss decreased (-0.366645 --> -0.394425).  Saving model ...
Epoch: 6 cost time: 3.7250068187713623
Epoch: 6, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.760 Vali Acc: 0.506 Test Loss: 1.760 Test Acc: 0.506
Validation loss decreased (-0.394425 --> -0.505538).  Saving model ...
Epoch: 7 cost time: 3.2410366535186768
Epoch: 7, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.522 Vali Acc: 0.539 Test Loss: 1.522 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538874).  Saving model ...
Epoch: 8 cost time: 3.155245304107666
Epoch: 8, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.267 Vali Acc: 0.644 Test Loss: 1.267 Test Acc: 0.644
Validation loss decreased (-0.538874 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 3.0870614051818848
Epoch: 9, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.086 Vali Acc: 0.661 Test Loss: 1.086 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661100).  Saving model ...
Epoch: 10 cost time: 3.2709310054779053
Epoch: 10, Steps: 12 | Train Loss: 0.947 Vali Loss: 0.935 Vali Acc: 0.744 Test Loss: 0.935 Test Acc: 0.744
Validation loss decreased (-0.661100 --> -0.744435).  Saving model ...
Epoch: 11 cost time: 3.262000560760498
Epoch: 11, Steps: 12 | Train Loss: 0.748 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3385441303253174
Epoch: 12, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 3.630743980407715
Epoch: 13, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.748 Vali Acc: 0.739 Test Loss: 0.748 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.475511312484741
Epoch: 14, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777771).  Saving model ...
Epoch: 15 cost time: 3.218031883239746
Epoch: 15, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.665 Vali Acc: 0.778 Test Loss: 0.665 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3309388160705566
Epoch: 16, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788883).  Saving model ...
Epoch: 17 cost time: 3.1466028690338135
Epoch: 17, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
Validation loss decreased (-0.788883 --> -0.827772).  Saving model ...
Epoch: 18 cost time: 3.4592909812927246
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.551 Vali Acc: 0.839 Test Loss: 0.551 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 19 cost time: 3.137876272201538
Epoch: 19, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2658114433288574
Epoch: 20, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.469874143600464
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.762540817260742
Epoch: 22, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 3.739506721496582
Epoch: 23, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.646 Vali Acc: 0.828 Test Loss: 0.646 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6832399368286133
Epoch: 24, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 3.667910099029541
Epoch: 25, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.816962957382202
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.591 Vali Acc: 0.844 Test Loss: 0.591 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.727442979812622
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.7505648136138916
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.573948621749878
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.77898907661438
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.685140609741211
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.5346384048461914
Epoch: 32, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.7651407718658447
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.757164478302002
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.664 Vali Acc: 0.861 Test Loss: 0.664 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861104).  Saving model ...
Epoch: 35 cost time: 3.7524573802948
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.636 Vali Acc: 0.861 Test Loss: 0.636 Test Acc: 0.861
Validation loss decreased (-0.861104 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 3.7648162841796875
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.630 Vali Acc: 0.856 Test Loss: 0.630 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.06166672706604
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.768754482269287
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.693 Vali Acc: 0.856 Test Loss: 0.693 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.877246379852295
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.830219030380249
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.8805620670318604
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.649837017059326
Epoch: 42, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.3964645862579346
Epoch: 43, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.700 Vali Acc: 0.861 Test Loss: 0.700 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.970979690551758
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.707 Vali Acc: 0.839 Test Loss: 0.707 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.4316744804382324
Epoch: 45, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.715 Vali Acc: 0.867 Test Loss: 0.715 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 46 cost time: 3.560304641723633
Epoch: 46, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.604027271270752
Epoch: 47, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.5519871711730957
Epoch: 48, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.732 Vali Acc: 0.856 Test Loss: 0.732 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.8840322494506836
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.732 Vali Acc: 0.856 Test Loss: 0.732 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.543424129486084
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.7921669483184814
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.861 Test Loss: 0.727 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.857985496520996
Epoch: 52, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.856 Test Loss: 0.731 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.894237756729126
Epoch: 53, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.5769474506378174
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.724 Vali Acc: 0.867 Test Loss: 0.724 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.7916347980499268
Epoch: 55, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.861 Test Loss: 0.736 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.904886722564697
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.732 Vali Acc: 0.094 Test Loss: 2.732 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 3.5202829837799072
Epoch: 2, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.496 Vali Acc: 0.222 Test Loss: 2.496 Test Acc: 0.222
Validation loss decreased (-0.094417 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 3.5195086002349854
Epoch: 3, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.226 Vali Acc: 0.317 Test Loss: 2.226 Test Acc: 0.317
Validation loss decreased (-0.222197 --> -0.316644).  Saving model ...
Epoch: 4 cost time: 3.304806709289551
Epoch: 4, Steps: 12 | Train Loss: 2.361 Vali Loss: 1.990 Vali Acc: 0.350 Test Loss: 1.990 Test Acc: 0.350
Validation loss decreased (-0.316644 --> -0.349980).  Saving model ...
Epoch: 5 cost time: 3.513150453567505
Epoch: 5, Steps: 12 | Train Loss: 2.176 Vali Loss: 1.865 Vali Acc: 0.444 Test Loss: 1.865 Test Acc: 0.444
Validation loss decreased (-0.349980 --> -0.444426).  Saving model ...
Epoch: 6 cost time: 3.701348066329956
Epoch: 6, Steps: 12 | Train Loss: 1.977 Vali Loss: 1.756 Vali Acc: 0.467 Test Loss: 1.756 Test Acc: 0.467
Validation loss decreased (-0.444426 --> -0.466649).  Saving model ...
Epoch: 7 cost time: 3.5878376960754395
Epoch: 7, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.550 Vali Acc: 0.539 Test Loss: 1.550 Test Acc: 0.539
Validation loss decreased (-0.466649 --> -0.538873).  Saving model ...
Epoch: 8 cost time: 3.8209447860717773
Epoch: 8, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.342 Vali Acc: 0.561 Test Loss: 1.342 Test Acc: 0.561
Validation loss decreased (-0.538873 --> -0.561098).  Saving model ...
Epoch: 9 cost time: 3.837993860244751
Epoch: 9, Steps: 12 | Train Loss: 1.234 Vali Loss: 1.169 Vali Acc: 0.639 Test Loss: 1.169 Test Acc: 0.639
Validation loss decreased (-0.561098 --> -0.638877).  Saving model ...
Epoch: 10 cost time: 3.903749704360962
Epoch: 10, Steps: 12 | Train Loss: 1.040 Vali Loss: 0.991 Vali Acc: 0.689 Test Loss: 0.991 Test Acc: 0.689
Validation loss decreased (-0.638877 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 3.842827081680298
Epoch: 11, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.924 Vali Acc: 0.689 Test Loss: 0.924 Test Acc: 0.689
Validation loss decreased (-0.688879 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 3.9505834579467773
Epoch: 12, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.875 Vali Acc: 0.706 Test Loss: 0.875 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 3.8477866649627686
Epoch: 13, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.766 Vali Acc: 0.706 Test Loss: 0.766 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705548).  Saving model ...
Epoch: 14 cost time: 3.5337092876434326
Epoch: 14, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.683 Vali Acc: 0.756 Test Loss: 0.683 Test Acc: 0.756
Validation loss decreased (-0.705548 --> -0.755549).  Saving model ...
Epoch: 15 cost time: 3.2736318111419678
Epoch: 15, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.673 Vali Acc: 0.761 Test Loss: 0.673 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 3.363990068435669
Epoch: 16, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.643 Vali Acc: 0.778 Test Loss: 0.643 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 17 cost time: 3.3487377166748047
Epoch: 17, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
Validation loss decreased (-0.777771 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 3.9564173221588135
Epoch: 18, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.584 Vali Acc: 0.817 Test Loss: 0.584 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.509730815887451
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.576 Vali Acc: 0.811 Test Loss: 0.576 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8413243293762207
Epoch: 20, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.7744786739349365
Epoch: 21, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.615 Vali Acc: 0.817 Test Loss: 0.615 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5731348991394043
Epoch: 22, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.601 Vali Acc: 0.828 Test Loss: 0.601 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6886799335479736
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.662 Vali Acc: 0.811 Test Loss: 0.662 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.825403928756714
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.617 Vali Acc: 0.828 Test Loss: 0.617 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.8329126834869385
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.766749143600464
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.7496933937072754
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.591 Vali Acc: 0.839 Test Loss: 0.591 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 28 cost time: 3.3398659229278564
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.510422945022583
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.592 Vali Acc: 0.839 Test Loss: 0.592 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.4757916927337646
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.624 Vali Acc: 0.839 Test Loss: 0.624 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.359797716140747
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.651 Vali Acc: 0.844 Test Loss: 0.651 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 32 cost time: 3.353951930999756
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.654 Vali Acc: 0.828 Test Loss: 0.654 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4517977237701416
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.7721354961395264
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.661 Vali Acc: 0.856 Test Loss: 0.661 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 35 cost time: 3.715925931930542
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.046497344970703
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.657 Vali Acc: 0.839 Test Loss: 0.657 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.9724676609039307
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.686 Vali Acc: 0.844 Test Loss: 0.686 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.978377103805542
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.693 Vali Acc: 0.839 Test Loss: 0.693 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.763392686843872
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.691 Vali Acc: 0.872 Test Loss: 0.691 Test Acc: 0.872
Validation loss decreased (-0.855549 --> -0.872215).  Saving model ...
Epoch: 40 cost time: 3.2957372665405273
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.73532772064209
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.748 Vali Acc: 0.839 Test Loss: 0.748 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.6498138904571533
Epoch: 42, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.719 Vali Acc: 0.839 Test Loss: 0.719 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.4330101013183594
Epoch: 43, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.721 Vali Acc: 0.844 Test Loss: 0.721 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.4388270378112793
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.666 Vali Acc: 0.839 Test Loss: 0.666 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.558600664138794
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.714 Vali Acc: 0.861 Test Loss: 0.714 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.5006585121154785
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.454655170440674
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.7288172245025635
Epoch: 48, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.743 Vali Acc: 0.861 Test Loss: 0.743 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.6888880729675293
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.568295001983643
Epoch: 1, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.672 Vali Acc: 0.133 Test Loss: 2.672 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 3.640072822570801
Epoch: 2, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.351 Vali Acc: 0.306 Test Loss: 2.351 Test Acc: 0.306
Validation loss decreased (-0.133307 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 3.5904219150543213
Epoch: 3, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.133 Vali Acc: 0.333 Test Loss: 2.133 Test Acc: 0.333
Validation loss decreased (-0.305532 --> -0.333312).  Saving model ...
Epoch: 4 cost time: 3.8265411853790283
Epoch: 4, Steps: 12 | Train Loss: 2.451 Vali Loss: 1.962 Vali Acc: 0.372 Test Loss: 1.962 Test Acc: 0.372
Validation loss decreased (-0.333312 --> -0.372203).  Saving model ...
Epoch: 5 cost time: 3.2694196701049805
Epoch: 5, Steps: 12 | Train Loss: 2.215 Vali Loss: 1.870 Vali Acc: 0.400 Test Loss: 1.870 Test Acc: 0.400
Validation loss decreased (-0.372203 --> -0.399981).  Saving model ...
Epoch: 6 cost time: 3.345785140991211
Epoch: 6, Steps: 12 | Train Loss: 2.022 Vali Loss: 1.789 Vali Acc: 0.444 Test Loss: 1.789 Test Acc: 0.444
Validation loss decreased (-0.399981 --> -0.444427).  Saving model ...
Epoch: 7 cost time: 3.4883193969726562
Epoch: 7, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.595 Vali Acc: 0.450 Test Loss: 1.595 Test Acc: 0.450
Validation loss decreased (-0.444427 --> -0.449984).  Saving model ...
Epoch: 8 cost time: 3.4968528747558594
Epoch: 8, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.381 Vali Acc: 0.533 Test Loss: 1.381 Test Acc: 0.533
Validation loss decreased (-0.449984 --> -0.533320).  Saving model ...
Epoch: 9 cost time: 3.545750617980957
Epoch: 9, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.230 Vali Acc: 0.589 Test Loss: 1.230 Test Acc: 0.589
Validation loss decreased (-0.533320 --> -0.588877).  Saving model ...
Epoch: 10 cost time: 3.5938045978546143
Epoch: 10, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.085 Vali Acc: 0.656 Test Loss: 1.085 Test Acc: 0.656
Validation loss decreased (-0.588877 --> -0.655545).  Saving model ...
Epoch: 11 cost time: 3.4089157581329346
Epoch: 11, Steps: 12 | Train Loss: 0.807 Vali Loss: 1.012 Vali Acc: 0.672 Test Loss: 1.012 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672212).  Saving model ...
Epoch: 12 cost time: 3.3487443923950195
Epoch: 12, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.941 Vali Acc: 0.656 Test Loss: 0.941 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.286430835723877
Epoch: 13, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.804 Vali Acc: 0.706 Test Loss: 0.804 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705548).  Saving model ...
Epoch: 14 cost time: 3.577709197998047
Epoch: 14, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.715 Vali Acc: 0.794 Test Loss: 0.715 Test Acc: 0.794
Validation loss decreased (-0.705548 --> -0.794437).  Saving model ...
Epoch: 15 cost time: 3.2776880264282227
Epoch: 15, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.688 Vali Acc: 0.767 Test Loss: 0.688 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3702657222747803
Epoch: 16, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.679 Vali Acc: 0.794 Test Loss: 0.679 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794438).  Saving model ...
Epoch: 17 cost time: 3.443429946899414
Epoch: 17, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.603 Vali Acc: 0.828 Test Loss: 0.603 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827772).  Saving model ...
Epoch: 18 cost time: 3.890550136566162
Epoch: 18, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 19 cost time: 3.7533562183380127
Epoch: 19, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 3.826042652130127
Epoch: 20, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 3.490971326828003
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3757803440093994
Epoch: 22, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.593 Vali Acc: 0.839 Test Loss: 0.593 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.576455593109131
Epoch: 23, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.629 Vali Acc: 0.817 Test Loss: 0.629 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.321906328201294
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.183953285217285
Epoch: 25, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2048146724700928
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4248359203338623
Epoch: 27, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.597 Vali Acc: 0.839 Test Loss: 0.597 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.49334716796875
Epoch: 28, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.621 Vali Acc: 0.844 Test Loss: 0.621 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.52457594871521
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.5049712657928467
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.631 Vali Acc: 0.833 Test Loss: 0.631 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.960907459259033
Epoch: 1, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.665 Vali Acc: 0.133 Test Loss: 2.665 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 3.3200392723083496
Epoch: 2, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.391 Vali Acc: 0.294 Test Loss: 2.391 Test Acc: 0.294
Validation loss decreased (-0.133307 --> -0.294421).  Saving model ...
Epoch: 3 cost time: 3.2751641273498535
Epoch: 3, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.139 Vali Acc: 0.350 Test Loss: 2.139 Test Acc: 0.350
Validation loss decreased (-0.294421 --> -0.349979).  Saving model ...
Epoch: 4 cost time: 3.2430853843688965
Epoch: 4, Steps: 12 | Train Loss: 2.453 Vali Loss: 1.963 Vali Acc: 0.344 Test Loss: 1.963 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.175246000289917
Epoch: 5, Steps: 12 | Train Loss: 2.255 Vali Loss: 1.888 Vali Acc: 0.378 Test Loss: 1.888 Test Acc: 0.378
Validation loss decreased (-0.349979 --> -0.377759).  Saving model ...
Epoch: 6 cost time: 3.4926748275756836
Epoch: 6, Steps: 12 | Train Loss: 2.074 Vali Loss: 1.818 Vali Acc: 0.417 Test Loss: 1.818 Test Acc: 0.417
Validation loss decreased (-0.377759 --> -0.416648).  Saving model ...
Epoch: 7 cost time: 3.2574055194854736
Epoch: 7, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.627 Vali Acc: 0.500 Test Loss: 1.627 Test Acc: 0.500
Validation loss decreased (-0.416648 --> -0.499984).  Saving model ...
Epoch: 8 cost time: 3.325230598449707
Epoch: 8, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.415 Vali Acc: 0.583 Test Loss: 1.415 Test Acc: 0.583
Validation loss decreased (-0.499984 --> -0.583319).  Saving model ...
Epoch: 9 cost time: 3.2173447608947754
Epoch: 9, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.256 Vali Acc: 0.639 Test Loss: 1.256 Test Acc: 0.639
Validation loss decreased (-0.583319 --> -0.638876).  Saving model ...
Epoch: 10 cost time: 3.6424882411956787
Epoch: 10, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.106 Vali Acc: 0.656 Test Loss: 1.106 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 11 cost time: 3.407003164291382
Epoch: 11, Steps: 12 | Train Loss: 0.842 Vali Loss: 1.019 Vali Acc: 0.689 Test Loss: 1.019 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688879).  Saving model ...
Epoch: 12 cost time: 3.5046885013580322
Epoch: 12, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.956 Vali Acc: 0.644 Test Loss: 0.956 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7432401180267334
Epoch: 13, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.826 Vali Acc: 0.706 Test Loss: 0.826 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705547).  Saving model ...
Epoch: 14 cost time: 3.576038122177124
Epoch: 14, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
Validation loss decreased (-0.705547 --> -0.755548).  Saving model ...
Epoch: 15 cost time: 3.300723075866699
Epoch: 15, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
Validation loss decreased (-0.755548 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 3.4832053184509277
Epoch: 16, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.671 Vali Acc: 0.794 Test Loss: 0.671 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 17 cost time: 3.285365343093872
Epoch: 17, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.607 Vali Acc: 0.822 Test Loss: 0.607 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 3.4544973373413086
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.592 Vali Acc: 0.822 Test Loss: 0.592 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 19 cost time: 3.5987775325775146
Epoch: 19, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 3.33868670463562
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2398898601531982
Epoch: 21, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.615 Vali Acc: 0.806 Test Loss: 0.615 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5031943321228027
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3060669898986816
Epoch: 23, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4962546825408936
Epoch: 24, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3779149055480957
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.576 Vali Acc: 0.828 Test Loss: 0.576 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.534512519836426
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 3.6798436641693115
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 3.5560519695281982
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.596 Vali Acc: 0.861 Test Loss: 0.596 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 3.529059410095215
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4711861610412598
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.425565481185913
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 32 cost time: 3.349351167678833
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2760581970214844
Epoch: 33, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.447438955307007
Epoch: 34, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.642 Vali Acc: 0.856 Test Loss: 0.642 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.316885471343994
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.9767940044403076
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.9701731204986572
Epoch: 37, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.638 Vali Acc: 0.867 Test Loss: 0.638 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.1020071506500244
Epoch: 38, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.690 Vali Acc: 0.856 Test Loss: 0.690 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.1898326873779297
Epoch: 39, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.0593836307525635
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.2852180004119873
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.689 Vali Acc: 0.861 Test Loss: 0.689 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.957079648971558
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.2056941986083984
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.193002223968506
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4386110305786133
Epoch: 4, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1793558597564697
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.290836811065674
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3873720169067383
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.038135528564453
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.307744026184082
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.195733070373535
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 11 cost time: 3.091672658920288
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 12 cost time: 3.141707181930542
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1795554161071777
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2633049488067627
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5187392234802246
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.593029499053955
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.643756628036499
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.263212203979492
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2849719524383545
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.362069606781006
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.413684606552124
Epoch: 21, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 732431
model size : 7.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.675262451171875
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.599 Vali Acc: 0.183 Test Loss: 2.599 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 3.600712299346924
Epoch: 2, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.221 Vali Acc: 0.461 Test Loss: 2.221 Test Acc: 0.461
Validation loss decreased (-0.183307 --> -0.461089).  Saving model ...
Epoch: 3 cost time: 3.132265329360962
Epoch: 3, Steps: 12 | Train Loss: 2.065 Vali Loss: 1.846 Vali Acc: 0.561 Test Loss: 1.846 Test Acc: 0.561
Validation loss decreased (-0.461089 --> -0.561093).  Saving model ...
Epoch: 4 cost time: 3.4428398609161377
Epoch: 4, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.568 Vali Acc: 0.589 Test Loss: 1.568 Test Acc: 0.589
Validation loss decreased (-0.561093 --> -0.588873).  Saving model ...
Epoch: 5 cost time: 3.3087611198425293
Epoch: 5, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.336 Vali Acc: 0.650 Test Loss: 1.336 Test Acc: 0.650
Validation loss decreased (-0.588873 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 3.6520743370056152
Epoch: 6, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.191 Vali Acc: 0.689 Test Loss: 1.191 Test Acc: 0.689
Validation loss decreased (-0.649987 --> -0.688877).  Saving model ...
Epoch: 7 cost time: 3.755866527557373
Epoch: 7, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.051 Vali Acc: 0.733 Test Loss: 1.051 Test Acc: 0.733
Validation loss decreased (-0.688877 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 3.7581875324249268
Epoch: 8, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.940 Vali Acc: 0.739 Test Loss: 0.940 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738879).  Saving model ...
Epoch: 9 cost time: 3.441977024078369
Epoch: 9, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.782 Vali Acc: 0.783 Test Loss: 0.782 Test Acc: 0.783
Validation loss decreased (-0.738879 --> -0.783326).  Saving model ...
Epoch: 10 cost time: 3.504244804382324
Epoch: 10, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.680 Vali Acc: 0.817 Test Loss: 0.680 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816660).  Saving model ...
Epoch: 11 cost time: 3.669497013092041
Epoch: 11, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 12 cost time: 3.604867696762085
Epoch: 12, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4409351348876953
Epoch: 13, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855550).  Saving model ...
Epoch: 14 cost time: 3.6666362285614014
Epoch: 14, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.33241868019104
Epoch: 15, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.434 Vali Acc: 0.883 Test Loss: 0.434 Test Acc: 0.883
Validation loss decreased (-0.855550 --> -0.883329).  Saving model ...
Epoch: 16 cost time: 3.808812379837036
Epoch: 16, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.454 Vali Acc: 0.883 Test Loss: 0.454 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4366114139556885
Epoch: 17, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.409 Vali Acc: 0.872 Test Loss: 0.409 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.435342788696289
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.447 Vali Acc: 0.883 Test Loss: 0.447 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7217564582824707
Epoch: 19, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.400 Vali Acc: 0.894 Test Loss: 0.400 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 20 cost time: 3.448009967803955
Epoch: 20, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.946580410003662
Epoch: 21, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 3.740082025527954
Epoch: 22, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.422 Vali Acc: 0.894 Test Loss: 0.422 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4493298530578613
Epoch: 23, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4847304821014404
Epoch: 24, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.426 Vali Acc: 0.878 Test Loss: 0.426 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.6384217739105225
Epoch: 25, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.427 Vali Acc: 0.906 Test Loss: 0.427 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905551).  Saving model ...
Epoch: 26 cost time: 3.7501373291015625
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.283825159072876
Epoch: 27, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.466634511947632
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.586179494857788
Epoch: 29, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.382073402404785
Epoch: 30, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2240841388702393
Epoch: 31, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.466 Vali Acc: 0.906 Test Loss: 0.466 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.506192684173584
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.482 Vali Acc: 0.894 Test Loss: 0.482 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.5455870628356934
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.326047897338867
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.4048116207122803
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.177081108093262
Epoch: 1, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.680 Vali Acc: 0.111 Test Loss: 2.680 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 3.7162492275238037
Epoch: 2, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.357 Vali Acc: 0.439 Test Loss: 2.357 Test Acc: 0.439
Validation loss decreased (-0.111084 --> -0.438865).  Saving model ...
Epoch: 3 cost time: 3.4064383506774902
Epoch: 3, Steps: 12 | Train Loss: 2.213 Vali Loss: 2.026 Vali Acc: 0.567 Test Loss: 2.026 Test Acc: 0.567
Validation loss decreased (-0.438865 --> -0.566646).  Saving model ...
Epoch: 4 cost time: 3.589390516281128
Epoch: 4, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.762 Vali Acc: 0.572 Test Loss: 1.762 Test Acc: 0.572
Validation loss decreased (-0.566646 --> -0.572205).  Saving model ...
Epoch: 5 cost time: 3.9514012336730957
Epoch: 5, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.520 Vali Acc: 0.594 Test Loss: 1.520 Test Acc: 0.594
Validation loss decreased (-0.572205 --> -0.594429).  Saving model ...
Epoch: 6 cost time: 3.5053932666778564
Epoch: 6, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.362 Vali Acc: 0.622 Test Loss: 1.362 Test Acc: 0.622
Validation loss decreased (-0.594429 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 3.645779609680176
Epoch: 7, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.208 Vali Acc: 0.672 Test Loss: 1.208 Test Acc: 0.672
Validation loss decreased (-0.622209 --> -0.672210).  Saving model ...
Epoch: 8 cost time: 3.601625442504883
Epoch: 8, Steps: 12 | Train Loss: 0.897 Vali Loss: 1.092 Vali Acc: 0.700 Test Loss: 1.092 Test Acc: 0.700
Validation loss decreased (-0.672210 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 3.4534223079681396
Epoch: 9, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.910 Vali Acc: 0.767 Test Loss: 0.910 Test Acc: 0.767
Validation loss decreased (-0.699989 --> -0.766658).  Saving model ...
Epoch: 10 cost time: 3.6141741275787354
Epoch: 10, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.789 Vali Acc: 0.794 Test Loss: 0.789 Test Acc: 0.794
Validation loss decreased (-0.766658 --> -0.794437).  Saving model ...
Epoch: 11 cost time: 3.3117878437042236
Epoch: 11, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.761 Vali Acc: 0.794 Test Loss: 0.761 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 12 cost time: 3.3448269367218018
Epoch: 12, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822216).  Saving model ...
Epoch: 13 cost time: 3.663581132888794
Epoch: 13, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.675 Vali Acc: 0.811 Test Loss: 0.675 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3425259590148926
Epoch: 14, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.571 Vali Acc: 0.867 Test Loss: 0.571 Test Acc: 0.867
Validation loss decreased (-0.822216 --> -0.866661).  Saving model ...
Epoch: 15 cost time: 3.162943124771118
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.484196662902832
Epoch: 16, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 3.62837815284729
Epoch: 17, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.493 Vali Acc: 0.872 Test Loss: 0.493 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.504138469696045
Epoch: 18, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.541 Vali Acc: 0.883 Test Loss: 0.541 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.273308515548706
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.501 Vali Acc: 0.894 Test Loss: 0.501 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 20 cost time: 3.214245319366455
Epoch: 20, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.548 Vali Acc: 0.883 Test Loss: 0.548 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.255815029144287
Epoch: 21, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.894439 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 3.206717014312744
Epoch: 22, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.532 Vali Acc: 0.894 Test Loss: 0.532 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.418384313583374
Epoch: 23, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.5402016639709473
Epoch: 24, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.551 Vali Acc: 0.867 Test Loss: 0.551 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.129441976547241
Epoch: 25, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.3821728229522705
Epoch: 26, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4787473678588867
Epoch: 27, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.6565909385681152
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.8659865856170654
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.554 Vali Acc: 0.889 Test Loss: 0.554 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.457320213317871
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.552 Vali Acc: 0.894 Test Loss: 0.552 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.5127084255218506
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.89020299911499
Epoch: 1, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.735 Vali Acc: 0.172 Test Loss: 2.735 Test Acc: 0.172
Validation loss decreased (inf --> -0.172195).  Saving model ...
Epoch: 2 cost time: 3.0990264415740967
Epoch: 2, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.465 Vali Acc: 0.311 Test Loss: 2.465 Test Acc: 0.311
Validation loss decreased (-0.172195 --> -0.311086).  Saving model ...
Epoch: 3 cost time: 3.1507163047790527
Epoch: 3, Steps: 12 | Train Loss: 2.347 Vali Loss: 2.186 Vali Acc: 0.422 Test Loss: 2.186 Test Acc: 0.422
Validation loss decreased (-0.311086 --> -0.422200).  Saving model ...
Epoch: 4 cost time: 3.0086958408355713
Epoch: 4, Steps: 12 | Train Loss: 2.066 Vali Loss: 1.954 Vali Acc: 0.461 Test Loss: 1.954 Test Acc: 0.461
Validation loss decreased (-0.422200 --> -0.461092).  Saving model ...
Epoch: 5 cost time: 3.2570700645446777
Epoch: 5, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.725 Vali Acc: 0.533 Test Loss: 1.725 Test Acc: 0.533
Validation loss decreased (-0.461092 --> -0.533316).  Saving model ...
Epoch: 6 cost time: 3.1005895137786865
Epoch: 6, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.542 Vali Acc: 0.550 Test Loss: 1.542 Test Acc: 0.550
Validation loss decreased (-0.533316 --> -0.549985).  Saving model ...
Epoch: 7 cost time: 3.3685553073883057
Epoch: 7, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.352 Vali Acc: 0.644 Test Loss: 1.352 Test Acc: 0.644
Validation loss decreased (-0.549985 --> -0.644431).  Saving model ...
Epoch: 8 cost time: 3.2107770442962646
Epoch: 8, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.183 Vali Acc: 0.650 Test Loss: 1.183 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 3.3362598419189453
Epoch: 9, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.007 Vali Acc: 0.711 Test Loss: 1.007 Test Acc: 0.711
Validation loss decreased (-0.649988 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 3.41225004196167
Epoch: 10, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.920 Vali Acc: 0.733 Test Loss: 0.920 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 11 cost time: 3.3950912952423096
Epoch: 11, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.856 Vali Acc: 0.728 Test Loss: 0.856 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.361706256866455
Epoch: 12, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.767 Vali Acc: 0.767 Test Loss: 0.767 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766659).  Saving model ...
Epoch: 13 cost time: 3.5164132118225098
Epoch: 13, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 3.444603204727173
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.663 Vali Acc: 0.794 Test Loss: 0.663 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 15 cost time: 3.465930223464966
Epoch: 15, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 3.2468180656433105
Epoch: 16, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.612 Vali Acc: 0.811 Test Loss: 0.612 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 3.2050821781158447
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.375051975250244
Epoch: 18, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 3.003676652908325
Epoch: 19, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1549558639526367
Epoch: 20, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
Validation loss decreased (-0.833327 --> -0.861105).  Saving model ...
Epoch: 21 cost time: 3.3942484855651855
Epoch: 21, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1822662353515625
Epoch: 22, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.638 Vali Acc: 0.839 Test Loss: 0.638 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.962453603744507
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.967618465423584
Epoch: 24, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3772501945495605
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.560 Vali Acc: 0.856 Test Loss: 0.560 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.221952438354492
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.602 Vali Acc: 0.833 Test Loss: 0.602 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.13739275932312
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.589 Vali Acc: 0.856 Test Loss: 0.589 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.187087059020996
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.2585675716400146
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866661).  Saving model ...
Epoch: 30 cost time: 3.262761354446411
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.19482421875
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.251249313354492
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.612 Vali Acc: 0.856 Test Loss: 0.612 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.156855821609497
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.615 Vali Acc: 0.867 Test Loss: 0.615 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.4006426334381104
Epoch: 34, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 3.3312454223632812
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.4414846897125244
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.367809295654297
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.861 Test Loss: 0.604 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.5780861377716064
Epoch: 38, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.6114485263824463
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.5549397468566895
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.634 Vali Acc: 0.861 Test Loss: 0.634 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.8523316383361816
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.629 Vali Acc: 0.861 Test Loss: 0.629 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.7187633514404297
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.867 Test Loss: 0.639 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.3816990852355957
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.658 Vali Acc: 0.861 Test Loss: 0.658 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.2710888385772705
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.867 Test Loss: 0.654 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.199106931686401
Epoch: 1, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.663 Vali Acc: 0.094 Test Loss: 2.663 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 3.202329158782959
Epoch: 2, Steps: 12 | Train Loss: 2.603 Vali Loss: 2.501 Vali Acc: 0.289 Test Loss: 2.501 Test Acc: 0.289
Validation loss decreased (-0.094418 --> -0.288864).  Saving model ...
Epoch: 3 cost time: 3.1137967109680176
Epoch: 3, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.321 Vali Acc: 0.306 Test Loss: 2.321 Test Acc: 0.306
Validation loss decreased (-0.288864 --> -0.305532).  Saving model ...
Epoch: 4 cost time: 3.152090549468994
Epoch: 4, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.139 Vali Acc: 0.333 Test Loss: 2.139 Test Acc: 0.333
Validation loss decreased (-0.305532 --> -0.333312).  Saving model ...
Epoch: 5 cost time: 3.050109386444092
Epoch: 5, Steps: 12 | Train Loss: 2.046 Vali Loss: 1.938 Vali Acc: 0.383 Test Loss: 1.938 Test Acc: 0.383
Validation loss decreased (-0.333312 --> -0.383314).  Saving model ...
Epoch: 6 cost time: 3.0278005599975586
Epoch: 6, Steps: 12 | Train Loss: 1.860 Vali Loss: 1.752 Vali Acc: 0.478 Test Loss: 1.752 Test Acc: 0.478
Validation loss decreased (-0.383314 --> -0.477760).  Saving model ...
Epoch: 7 cost time: 3.178830623626709
Epoch: 7, Steps: 12 | Train Loss: 1.670 Vali Loss: 1.567 Vali Acc: 0.544 Test Loss: 1.567 Test Acc: 0.544
Validation loss decreased (-0.477760 --> -0.544429).  Saving model ...
Epoch: 8 cost time: 3.0810837745666504
Epoch: 8, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.336 Vali Acc: 0.600 Test Loss: 1.336 Test Acc: 0.600
Validation loss decreased (-0.544429 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 3.393430233001709
Epoch: 9, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.112 Vali Acc: 0.711 Test Loss: 1.112 Test Acc: 0.711
Validation loss decreased (-0.599987 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 3.2158560752868652
Epoch: 10, Steps: 12 | Train Loss: 0.901 Vali Loss: 0.947 Vali Acc: 0.711 Test Loss: 0.947 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711102).  Saving model ...
Epoch: 11 cost time: 3.236989974975586
Epoch: 11, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.865 Vali Acc: 0.728 Test Loss: 0.865 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 3.459374189376831
Epoch: 12, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.799 Vali Acc: 0.739 Test Loss: 0.799 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738881).  Saving model ...
Epoch: 13 cost time: 3.422452449798584
Epoch: 13, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.744 Vali Acc: 0.756 Test Loss: 0.744 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 14 cost time: 3.193195104598999
Epoch: 14, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2700605392456055
Epoch: 15, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.616 Vali Acc: 0.800 Test Loss: 0.616 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 3.231771230697632
Epoch: 16, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.575 Vali Acc: 0.817 Test Loss: 0.575 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 17 cost time: 3.1720356941223145
Epoch: 17, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 18 cost time: 3.015899896621704
Epoch: 18, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.563 Vali Acc: 0.811 Test Loss: 0.563 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2512874603271484
Epoch: 19, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 20 cost time: 3.137165069580078
Epoch: 20, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 21 cost time: 2.978444814682007
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.984698534011841
Epoch: 22, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.015547752380371
Epoch: 23, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2724814414978027
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.646 Vali Acc: 0.817 Test Loss: 0.646 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6303060054779053
Epoch: 25, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 3.529216766357422
Epoch: 26, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3834078311920166
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2443642616271973
Epoch: 28, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 3.619129180908203
Epoch: 29, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.606 Vali Acc: 0.833 Test Loss: 0.606 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.582277297973633
Epoch: 30, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.3477630615234375
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.5986642837524414
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 33 cost time: 3.3191468715667725
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.462932586669922
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 35 cost time: 3.4646501541137695
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 3.2982277870178223
Epoch: 36, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.0431277751922607
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.640 Vali Acc: 0.856 Test Loss: 0.640 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.2653861045837402
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.1070876121520996
Epoch: 39, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.640 Vali Acc: 0.861 Test Loss: 0.640 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.513598918914795
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.4200100898742676
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.655 Vali Acc: 0.872 Test Loss: 0.655 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 42 cost time: 3.510021448135376
Epoch: 42, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.646 Vali Acc: 0.867 Test Loss: 0.646 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.6116280555725098
Epoch: 43, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.3809030055999756
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.659 Vali Acc: 0.856 Test Loss: 0.659 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.296699285507202
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.670 Vali Acc: 0.867 Test Loss: 0.670 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.502631664276123
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.697 Vali Acc: 0.878 Test Loss: 0.697 Test Acc: 0.878
Validation loss decreased (-0.872216 --> -0.877771).  Saving model ...
Epoch: 47 cost time: 3.712968111038208
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.678 Vali Acc: 0.867 Test Loss: 0.678 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.5449514389038086
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.702 Vali Acc: 0.867 Test Loss: 0.702 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.3331329822540283
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.689 Vali Acc: 0.872 Test Loss: 0.689 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.1980133056640625
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.861 Test Loss: 0.697 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.2587647438049316
Epoch: 51, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 3.339362859725952
Epoch: 52, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.698 Vali Acc: 0.861 Test Loss: 0.698 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 3.2565882205963135
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.703 Vali Acc: 0.872 Test Loss: 0.703 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 3.059523105621338
Epoch: 54, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.706 Vali Acc: 0.878 Test Loss: 0.706 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.275925874710083
Epoch: 55, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.867 Test Loss: 0.712 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 3.2544872760772705
Epoch: 56, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.979146480560303
Epoch: 1, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.686 Vali Acc: 0.089 Test Loss: 2.686 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 3.357332229614258
Epoch: 2, Steps: 12 | Train Loss: 2.648 Vali Loss: 2.462 Vali Acc: 0.200 Test Loss: 2.462 Test Acc: 0.200
Validation loss decreased (-0.088862 --> -0.199975).  Saving model ...
Epoch: 3 cost time: 3.3430681228637695
Epoch: 3, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.209 Vali Acc: 0.239 Test Loss: 2.209 Test Acc: 0.239
Validation loss decreased (-0.199975 --> -0.238867).  Saving model ...
Epoch: 4 cost time: 3.5153708457946777
Epoch: 4, Steps: 12 | Train Loss: 2.344 Vali Loss: 1.999 Vali Acc: 0.333 Test Loss: 1.999 Test Acc: 0.333
Validation loss decreased (-0.238867 --> -0.333313).  Saving model ...
Epoch: 5 cost time: 3.4484610557556152
Epoch: 5, Steps: 12 | Train Loss: 2.147 Vali Loss: 1.817 Vali Acc: 0.422 Test Loss: 1.817 Test Acc: 0.422
Validation loss decreased (-0.333313 --> -0.422204).  Saving model ...
Epoch: 6 cost time: 3.3534624576568604
Epoch: 6, Steps: 12 | Train Loss: 2.002 Vali Loss: 1.688 Vali Acc: 0.489 Test Loss: 1.688 Test Acc: 0.489
Validation loss decreased (-0.422204 --> -0.488872).  Saving model ...
Epoch: 7 cost time: 2.959373712539673
Epoch: 7, Steps: 12 | Train Loss: 1.783 Vali Loss: 1.578 Vali Acc: 0.522 Test Loss: 1.578 Test Acc: 0.522
Validation loss decreased (-0.488872 --> -0.522206).  Saving model ...
Epoch: 8 cost time: 3.027815103530884
Epoch: 8, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.351 Vali Acc: 0.589 Test Loss: 1.351 Test Acc: 0.589
Validation loss decreased (-0.522206 --> -0.588875).  Saving model ...
Epoch: 9 cost time: 3.058684825897217
Epoch: 9, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.167 Vali Acc: 0.606 Test Loss: 1.167 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605544).  Saving model ...
Epoch: 10 cost time: 3.1947667598724365
Epoch: 10, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.015 Vali Acc: 0.644 Test Loss: 1.015 Test Acc: 0.644
Validation loss decreased (-0.605544 --> -0.644434).  Saving model ...
Epoch: 11 cost time: 3.06611704826355
Epoch: 11, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.914 Vali Acc: 0.689 Test Loss: 0.914 Test Acc: 0.689
Validation loss decreased (-0.644434 --> -0.688880).  Saving model ...
Epoch: 12 cost time: 3.48405385017395
Epoch: 12, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.864 Vali Acc: 0.644 Test Loss: 0.864 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.58065128326416
Epoch: 13, Steps: 12 | Train Loss: 0.655 Vali Loss: 0.787 Vali Acc: 0.706 Test Loss: 0.787 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705548).  Saving model ...
Epoch: 14 cost time: 3.528855085372925
Epoch: 14, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.717 Vali Acc: 0.733 Test Loss: 0.717 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 15 cost time: 3.7367770671844482
Epoch: 15, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.638 Vali Acc: 0.778 Test Loss: 0.638 Test Acc: 0.778
Validation loss decreased (-0.733326 --> -0.777771).  Saving model ...
Epoch: 16 cost time: 4.183875799179077
Epoch: 16, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
Validation loss decreased (-0.777771 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 3.767928123474121
Epoch: 17, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.609 Vali Acc: 0.806 Test Loss: 0.609 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 18 cost time: 3.91540789604187
Epoch: 18, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.618 Vali Acc: 0.800 Test Loss: 0.618 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.973834991455078
Epoch: 19, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.647 Vali Acc: 0.817 Test Loss: 0.647 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 3.800102472305298
Epoch: 20, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7176520824432373
Epoch: 21, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.617 Vali Acc: 0.806 Test Loss: 0.617 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6480112075805664
Epoch: 22, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 3.6147379875183105
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5063259601593018
Epoch: 24, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.634 Vali Acc: 0.828 Test Loss: 0.634 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.47013258934021
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.643862009048462
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.9342050552368164
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.9528040885925293
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.630 Vali Acc: 0.844 Test Loss: 0.630 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 29 cost time: 3.7587366104125977
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.820028305053711
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.8490216732025146
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.634 Vali Acc: 0.839 Test Loss: 0.634 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.7726945877075195
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.782794237136841
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.669 Vali Acc: 0.828 Test Loss: 0.669 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.65850567817688
Epoch: 34, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.681 Vali Acc: 0.839 Test Loss: 0.681 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.4205102920532227
Epoch: 35, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.677 Vali Acc: 0.833 Test Loss: 0.677 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.466926336288452
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3719558715820312
Epoch: 37, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.694 Vali Acc: 0.833 Test Loss: 0.694 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.522277355194092
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 39 cost time: 3.3133702278137207
Epoch: 39, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.701 Vali Acc: 0.828 Test Loss: 0.701 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.408773899078369
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.2119274139404297
Epoch: 41, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.711 Vali Acc: 0.828 Test Loss: 0.711 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.7337892055511475
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.492633819580078
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.737 Vali Acc: 0.856 Test Loss: 0.737 Test Acc: 0.856
Validation loss decreased (-0.849993 --> -0.855548).  Saving model ...
Epoch: 44 cost time: 3.5802950859069824
Epoch: 44, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.4716928005218506
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.737 Vali Acc: 0.856 Test Loss: 0.737 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.6996195316314697
Epoch: 46, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.7574706077575684
Epoch: 47, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.711 Vali Acc: 0.861 Test Loss: 0.711 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861104).  Saving model ...
Epoch: 48 cost time: 3.5252442359924316
Epoch: 48, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.758 Vali Acc: 0.839 Test Loss: 0.758 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.6629154682159424
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.784 Vali Acc: 0.839 Test Loss: 0.784 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2005703449249268
Epoch: 50, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.818 Vali Acc: 0.839 Test Loss: 0.818 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.2230098247528076
Epoch: 51, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.239896297454834
Epoch: 52, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.439241886138916
Epoch: 53, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.850 Test Loss: 0.779 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.3493852615356445
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.844 Test Loss: 0.774 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.55855131149292
Epoch: 55, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.607928514480591
Epoch: 56, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.644583225250244
Epoch: 57, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.04824423789978
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.603 Vali Acc: 0.111 Test Loss: 2.603 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 3.6204330921173096
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.272 Vali Acc: 0.383 Test Loss: 2.272 Test Acc: 0.383
Validation loss decreased (-0.111085 --> -0.383311).  Saving model ...
Epoch: 3 cost time: 3.8433284759521484
Epoch: 3, Steps: 12 | Train Loss: 2.614 Vali Loss: 2.081 Vali Acc: 0.350 Test Loss: 2.081 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5145833492279053
Epoch: 4, Steps: 12 | Train Loss: 2.456 Vali Loss: 1.969 Vali Acc: 0.372 Test Loss: 1.969 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6907403469085693
Epoch: 5, Steps: 12 | Train Loss: 2.250 Vali Loss: 1.854 Vali Acc: 0.450 Test Loss: 1.854 Test Acc: 0.450
Validation loss decreased (-0.383311 --> -0.449981).  Saving model ...
Epoch: 6 cost time: 3.5621683597564697
Epoch: 6, Steps: 12 | Train Loss: 2.013 Vali Loss: 1.739 Vali Acc: 0.478 Test Loss: 1.739 Test Acc: 0.478
Validation loss decreased (-0.449981 --> -0.477760).  Saving model ...
Epoch: 7 cost time: 3.462364673614502
Epoch: 7, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.654 Vali Acc: 0.489 Test Loss: 1.654 Test Acc: 0.489
Validation loss decreased (-0.477760 --> -0.488872).  Saving model ...
Epoch: 8 cost time: 3.440436840057373
Epoch: 8, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.411 Vali Acc: 0.572 Test Loss: 1.411 Test Acc: 0.572
Validation loss decreased (-0.488872 --> -0.572208).  Saving model ...
Epoch: 9 cost time: 3.7211294174194336
Epoch: 9, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.218 Vali Acc: 0.622 Test Loss: 1.218 Test Acc: 0.622
Validation loss decreased (-0.572208 --> -0.622210).  Saving model ...
Epoch: 10 cost time: 3.557347297668457
Epoch: 10, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
Validation loss decreased (-0.622210 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 3.476597309112549
Epoch: 11, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.963 Vali Acc: 0.667 Test Loss: 0.963 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 3.9861233234405518
Epoch: 12, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.886 Vali Acc: 0.678 Test Loss: 0.886 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677769).  Saving model ...
Epoch: 13 cost time: 3.4861927032470703
Epoch: 13, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.813 Vali Acc: 0.711 Test Loss: 0.813 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711103).  Saving model ...
Epoch: 14 cost time: 3.915558099746704
Epoch: 14, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.704 Vali Acc: 0.761 Test Loss: 0.704 Test Acc: 0.761
Validation loss decreased (-0.711103 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 3.9242453575134277
Epoch: 15, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.640 Vali Acc: 0.811 Test Loss: 0.640 Test Acc: 0.811
Validation loss decreased (-0.761104 --> -0.811105).  Saving model ...
Epoch: 16 cost time: 3.6926283836364746
Epoch: 16, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.624 Vali Acc: 0.811 Test Loss: 0.624 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 3.5338218212127686
Epoch: 17, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.639 Vali Acc: 0.806 Test Loss: 0.639 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.751438856124878
Epoch: 18, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.623 Vali Acc: 0.806 Test Loss: 0.623 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4287991523742676
Epoch: 19, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.649 Vali Acc: 0.800 Test Loss: 0.649 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5410079956054688
Epoch: 20, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.705 Vali Acc: 0.833 Test Loss: 0.705 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833326).  Saving model ...
Epoch: 21 cost time: 3.529189109802246
Epoch: 21, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.604 Vali Acc: 0.817 Test Loss: 0.604 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6105875968933105
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.640 Vali Acc: 0.833 Test Loss: 0.640 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 3.568185806274414
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 3.434058904647827
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.651 Vali Acc: 0.833 Test Loss: 0.651 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4061667919158936
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.615 Vali Acc: 0.828 Test Loss: 0.615 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5249078273773193
Epoch: 26, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.818422317504883
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.714790105819702
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.825413703918457
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.617 Vali Acc: 0.817 Test Loss: 0.617 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.7562997341156006
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.612 Vali Acc: 0.828 Test Loss: 0.612 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.766019821166992
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.606 Vali Acc: 0.817 Test Loss: 0.606 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.7984259128570557
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.647 Vali Acc: 0.828 Test Loss: 0.647 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.9393057823181152
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.667 Vali Acc: 0.839 Test Loss: 0.667 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.0236430168151855
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.602 Vali Acc: 0.139 Test Loss: 2.602 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 3.0677731037139893
Epoch: 2, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.328 Vali Acc: 0.344 Test Loss: 2.328 Test Acc: 0.344
Validation loss decreased (-0.138863 --> -0.344421).  Saving model ...
Epoch: 3 cost time: 3.1506664752960205
Epoch: 3, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.077 Vali Acc: 0.378 Test Loss: 2.077 Test Acc: 0.378
Validation loss decreased (-0.344421 --> -0.377757).  Saving model ...
Epoch: 4 cost time: 3.221994161605835
Epoch: 4, Steps: 12 | Train Loss: 2.479 Vali Loss: 1.940 Vali Acc: 0.422 Test Loss: 1.940 Test Acc: 0.422
Validation loss decreased (-0.377757 --> -0.422203).  Saving model ...
Epoch: 5 cost time: 3.4502477645874023
Epoch: 5, Steps: 12 | Train Loss: 2.277 Vali Loss: 1.838 Vali Acc: 0.450 Test Loss: 1.838 Test Acc: 0.450
Validation loss decreased (-0.422203 --> -0.449982).  Saving model ...
Epoch: 6 cost time: 3.479663133621216
Epoch: 6, Steps: 12 | Train Loss: 2.004 Vali Loss: 1.760 Vali Acc: 0.450 Test Loss: 1.760 Test Acc: 0.450
Validation loss decreased (-0.449982 --> -0.449982).  Saving model ...
Epoch: 7 cost time: 3.576707363128662
Epoch: 7, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.689 Vali Acc: 0.439 Test Loss: 1.689 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3922982215881348
Epoch: 8, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.473 Vali Acc: 0.506 Test Loss: 1.473 Test Acc: 0.506
Validation loss decreased (-0.449982 --> -0.505541).  Saving model ...
Epoch: 9 cost time: 3.5032920837402344
Epoch: 9, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.242 Vali Acc: 0.611 Test Loss: 1.242 Test Acc: 0.611
Validation loss decreased (-0.505541 --> -0.611099).  Saving model ...
Epoch: 10 cost time: 3.764518976211548
Epoch: 10, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.059 Vali Acc: 0.694 Test Loss: 1.059 Test Acc: 0.694
Validation loss decreased (-0.611099 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 3.533348321914673
Epoch: 11, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.944 Vali Acc: 0.694 Test Loss: 0.944 Test Acc: 0.694
Validation loss decreased (-0.694434 --> -0.694435).  Saving model ...
Epoch: 12 cost time: 3.54341721534729
Epoch: 12, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.879 Vali Acc: 0.700 Test Loss: 0.879 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 3.6798288822174072
Epoch: 13, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.818 Vali Acc: 0.722 Test Loss: 0.818 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 14 cost time: 3.8711395263671875
Epoch: 14, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.728 Vali Acc: 0.744 Test Loss: 0.728 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744437).  Saving model ...
Epoch: 15 cost time: 3.1859939098358154
Epoch: 15, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.744437 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 3.143925428390503
Epoch: 16, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.611 Vali Acc: 0.811 Test Loss: 0.611 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 17 cost time: 3.4397969245910645
Epoch: 17, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.609 Vali Acc: 0.817 Test Loss: 0.609 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 18 cost time: 3.417628288269043
Epoch: 18, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.581 Vali Acc: 0.811 Test Loss: 0.581 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2516725063323975
Epoch: 19, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.608 Vali Acc: 0.811 Test Loss: 0.608 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.365520477294922
Epoch: 20, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.675 Vali Acc: 0.822 Test Loss: 0.675 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 3.373551607131958
Epoch: 21, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.564 Vali Acc: 0.806 Test Loss: 0.564 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9532721042633057
Epoch: 22, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.606 Vali Acc: 0.839 Test Loss: 0.606 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 4.0502142906188965
Epoch: 23, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.597 Vali Acc: 0.828 Test Loss: 0.597 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.952303171157837
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.527855396270752
Epoch: 25, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4354827404022217
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.525773525238037
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.582 Vali Acc: 0.822 Test Loss: 0.582 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.6820993423461914
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.581 Vali Acc: 0.861 Test Loss: 0.581 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 29 cost time: 3.2822368144989014
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4117889404296875
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.524303913116455
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.2225680351257324
Epoch: 32, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.597 Vali Acc: 0.844 Test Loss: 0.597 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.4505717754364014
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.618 Vali Acc: 0.856 Test Loss: 0.618 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.225247621536255
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.5659587383270264
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.621 Vali Acc: 0.867 Test Loss: 0.621 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
Epoch: 36 cost time: 3.576558828353882
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.810871124267578
Epoch: 37, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.551013708114624
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.638 Vali Acc: 0.872 Test Loss: 0.638 Test Acc: 0.872
Validation loss decreased (-0.866660 --> -0.872216).  Saving model ...
Epoch: 39 cost time: 3.792534828186035
Epoch: 39, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.6440680027008057
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.9053807258605957
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.632 Vali Acc: 0.872 Test Loss: 0.632 Test Acc: 0.872
Validation loss decreased (-0.872216 --> -0.872216).  Saving model ...
Epoch: 42 cost time: 3.7636020183563232
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.646 Vali Acc: 0.872 Test Loss: 0.646 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.7897753715515137
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.649 Vali Acc: 0.861 Test Loss: 0.649 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.9329519271850586
Epoch: 44, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.650 Vali Acc: 0.856 Test Loss: 0.650 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.806051731109619
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.683 Vali Acc: 0.872 Test Loss: 0.683 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.464003562927246
Epoch: 46, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.671 Vali Acc: 0.872 Test Loss: 0.671 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.3821043968200684
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.680 Vali Acc: 0.872 Test Loss: 0.680 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.6939055919647217
Epoch: 48, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.678 Vali Acc: 0.872 Test Loss: 0.678 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.4156594276428223
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.867 Test Loss: 0.682 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.5974385738372803
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.693 Vali Acc: 0.867 Test Loss: 0.693 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.550050735473633
Epoch: 51, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.685 Vali Acc: 0.867 Test Loss: 0.685 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.147457599639893
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.5160531997680664
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.7836949825286865
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.795623302459717
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6682984828948975
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 3.5225558280944824
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 7 cost time: 3.383077621459961
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6077709197998047
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.33215594291687
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5637574195861816
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3375184535980225
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6257126331329346
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.4937901496887207
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.159142017364502
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.824629306793213
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.828428030014038
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 634127
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.9845123291015625
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.567 Vali Acc: 0.167 Test Loss: 2.567 Test Acc: 0.167
Validation loss decreased (inf --> -0.166641).  Saving model ...
Epoch: 2 cost time: 3.23075270652771
Epoch: 2, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.260 Vali Acc: 0.389 Test Loss: 2.260 Test Acc: 0.389
Validation loss decreased (-0.166641 --> -0.388866).  Saving model ...
Epoch: 3 cost time: 3.3035361766815186
Epoch: 3, Steps: 12 | Train Loss: 2.188 Vali Loss: 1.943 Vali Acc: 0.511 Test Loss: 1.943 Test Acc: 0.511
Validation loss decreased (-0.388866 --> -0.511092).  Saving model ...
Epoch: 4 cost time: 3.08864426612854
Epoch: 4, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.680 Vali Acc: 0.567 Test Loss: 1.680 Test Acc: 0.567
Validation loss decreased (-0.511092 --> -0.566650).  Saving model ...
Epoch: 5 cost time: 3.1499643325805664
Epoch: 5, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.470 Vali Acc: 0.606 Test Loss: 1.470 Test Acc: 0.606
Validation loss decreased (-0.566650 --> -0.605541).  Saving model ...
Epoch: 6 cost time: 3.195141315460205
Epoch: 6, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.273 Vali Acc: 0.689 Test Loss: 1.273 Test Acc: 0.689
Validation loss decreased (-0.605541 --> -0.688876).  Saving model ...
Epoch: 7 cost time: 3.165917158126831
Epoch: 7, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.127 Vali Acc: 0.700 Test Loss: 1.127 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 3.2621827125549316
Epoch: 8, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.002 Vali Acc: 0.711 Test Loss: 1.002 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 9 cost time: 3.5029027462005615
Epoch: 9, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.891 Vali Acc: 0.739 Test Loss: 0.891 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 10 cost time: 3.5217854976654053
Epoch: 10, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.839 Vali Acc: 0.778 Test Loss: 0.839 Test Acc: 0.778
Validation loss decreased (-0.738880 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 3.6117236614227295
Epoch: 11, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788881).  Saving model ...
Epoch: 12 cost time: 3.7798969745635986
Epoch: 12, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.664 Vali Acc: 0.811 Test Loss: 0.664 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 13 cost time: 3.6659505367279053
Epoch: 13, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
Validation loss decreased (-0.811104 --> -0.838883).  Saving model ...
Epoch: 14 cost time: 3.8870747089385986
Epoch: 14, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8972270488739014
Epoch: 15, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 16 cost time: 3.703496217727661
Epoch: 16, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.464 Vali Acc: 0.878 Test Loss: 0.464 Test Acc: 0.878
Validation loss decreased (-0.849995 --> -0.877773).  Saving model ...
Epoch: 17 cost time: 3.3452656269073486
Epoch: 17, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.444 Vali Acc: 0.878 Test Loss: 0.444 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 18 cost time: 3.6229615211486816
Epoch: 18, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.419 Vali Acc: 0.878 Test Loss: 0.419 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877774).  Saving model ...
Epoch: 19 cost time: 3.487947463989258
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 3.884209394454956
Epoch: 20, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.379 Vali Acc: 0.894 Test Loss: 0.379 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 3.813241958618164
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.370 Vali Acc: 0.872 Test Loss: 0.370 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.736269950866699
Epoch: 22, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.373 Vali Acc: 0.883 Test Loss: 0.373 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.161321401596069
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 3.913100242614746
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.353 Vali Acc: 0.906 Test Loss: 0.353 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905552).  Saving model ...
Epoch: 25 cost time: 4.269205808639526
Epoch: 25, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7323272228240967
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 3.756319522857666
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6107630729675293
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7656495571136475
Epoch: 29, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.352 Vali Acc: 0.894 Test Loss: 0.352 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.427574634552002
Epoch: 30, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.5383317470550537
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.441693067550659
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.4528234004974365
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.373 Vali Acc: 0.883 Test Loss: 0.373 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.353450059890747
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.260434150695801
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.545334815979004
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.941576242446899
Epoch: 1, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.663 Vali Acc: 0.089 Test Loss: 2.663 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 3.5221145153045654
Epoch: 2, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.412 Vali Acc: 0.300 Test Loss: 2.412 Test Acc: 0.300
Validation loss decreased (-0.088862 --> -0.299976).  Saving model ...
Epoch: 3 cost time: 3.2618589401245117
Epoch: 3, Steps: 12 | Train Loss: 2.338 Vali Loss: 2.135 Vali Acc: 0.406 Test Loss: 2.135 Test Acc: 0.406
Validation loss decreased (-0.299976 --> -0.405534).  Saving model ...
Epoch: 4 cost time: 3.6719889640808105
Epoch: 4, Steps: 12 | Train Loss: 2.070 Vali Loss: 1.887 Vali Acc: 0.528 Test Loss: 1.887 Test Acc: 0.528
Validation loss decreased (-0.405534 --> -0.527759).  Saving model ...
Epoch: 5 cost time: 3.228337287902832
Epoch: 5, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.685 Vali Acc: 0.550 Test Loss: 1.685 Test Acc: 0.550
Validation loss decreased (-0.527759 --> -0.549983).  Saving model ...
Epoch: 6 cost time: 3.311220169067383
Epoch: 6, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.481 Vali Acc: 0.556 Test Loss: 1.481 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 3.1943392753601074
Epoch: 7, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.322 Vali Acc: 0.606 Test Loss: 1.322 Test Acc: 0.606
Validation loss decreased (-0.555541 --> -0.605542).  Saving model ...
Epoch: 8 cost time: 3.2648160457611084
Epoch: 8, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.202 Vali Acc: 0.644 Test Loss: 1.202 Test Acc: 0.644
Validation loss decreased (-0.605542 --> -0.644432).  Saving model ...
Epoch: 9 cost time: 3.2353286743164062
Epoch: 9, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.065 Vali Acc: 0.678 Test Loss: 1.065 Test Acc: 0.678
Validation loss decreased (-0.644432 --> -0.677767).  Saving model ...
Epoch: 10 cost time: 3.16788387298584
Epoch: 10, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.995 Vali Acc: 0.717 Test Loss: 0.995 Test Acc: 0.717
Validation loss decreased (-0.677767 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 3.1715893745422363
Epoch: 11, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.861 Vali Acc: 0.756 Test Loss: 0.861 Test Acc: 0.756
Validation loss decreased (-0.716657 --> -0.755547).  Saving model ...
Epoch: 12 cost time: 3.258535146713257
Epoch: 12, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.745 Vali Acc: 0.794 Test Loss: 0.745 Test Acc: 0.794
Validation loss decreased (-0.755547 --> -0.794437).  Saving model ...
Epoch: 13 cost time: 3.3629274368286133
Epoch: 13, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
Validation loss decreased (-0.794437 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 3.286186695098877
Epoch: 14, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0715723037719727
Epoch: 15, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 2.8565449714660645
Epoch: 16, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.533 Vali Acc: 0.878 Test Loss: 0.533 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 17 cost time: 2.9967031478881836
Epoch: 17, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.545 Vali Acc: 0.878 Test Loss: 0.545 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.179534673690796
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 19 cost time: 3.234231948852539
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 3.065272569656372
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.487 Vali Acc: 0.883 Test Loss: 0.487 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.3590869903564453
Epoch: 21, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.5454723834991455
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1288950443267822
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 24 cost time: 3.4681801795959473
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4931681156158447
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4291725158691406
Epoch: 26, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 27 cost time: 3.452824115753174
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4042115211486816
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.687795639038086
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.470 Vali Acc: 0.883 Test Loss: 0.470 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.097522020339966
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.9964399337768555
Epoch: 31, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.499 Vali Acc: 0.894 Test Loss: 0.499 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 32 cost time: 3.2831506729125977
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.482 Vali Acc: 0.894 Test Loss: 0.482 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 33 cost time: 3.1322386264801025
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4169998168945312
Epoch: 34, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.480 Vali Acc: 0.894 Test Loss: 0.480 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 35 cost time: 3.187930107116699
Epoch: 35, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.419996500015259
Epoch: 36, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.4355685710906982
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.2429935932159424
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.526 Vali Acc: 0.883 Test Loss: 0.526 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.3684473037719727
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.1206822395324707
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.282970428466797
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.537 Vali Acc: 0.889 Test Loss: 0.537 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.228097677230835
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 43 cost time: 3.2908713817596436
Epoch: 43, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.517 Vali Acc: 0.894 Test Loss: 0.517 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.410970449447632
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.894 Test Loss: 0.514 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.311723232269287
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.535 Vali Acc: 0.894 Test Loss: 0.535 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.585193634033203
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.534 Vali Acc: 0.894 Test Loss: 0.534 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.3900675773620605
Epoch: 47, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.2909023761749268
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.523 Vali Acc: 0.894 Test Loss: 0.523 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.3402018547058105
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.520 Vali Acc: 0.894 Test Loss: 0.520 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.204636812210083
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.536 Vali Acc: 0.894 Test Loss: 0.536 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.2175941467285156
Epoch: 51, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.537 Vali Acc: 0.894 Test Loss: 0.537 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.308950662612915
Epoch: 52, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.552 Vali Acc: 0.894 Test Loss: 0.552 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.755137920379639
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.664 Vali Acc: 0.072 Test Loss: 2.664 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 3.3177809715270996
Epoch: 2, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.475 Vali Acc: 0.222 Test Loss: 2.475 Test Acc: 0.222
Validation loss decreased (-0.072196 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 3.2111475467681885
Epoch: 3, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.267 Vali Acc: 0.344 Test Loss: 2.267 Test Acc: 0.344
Validation loss decreased (-0.222197 --> -0.344422).  Saving model ...
Epoch: 4 cost time: 3.5476067066192627
Epoch: 4, Steps: 12 | Train Loss: 2.247 Vali Loss: 2.082 Vali Acc: 0.433 Test Loss: 2.082 Test Acc: 0.433
Validation loss decreased (-0.344422 --> -0.433313).  Saving model ...
Epoch: 5 cost time: 3.2936208248138428
Epoch: 5, Steps: 12 | Train Loss: 2.066 Vali Loss: 1.923 Vali Acc: 0.478 Test Loss: 1.923 Test Acc: 0.478
Validation loss decreased (-0.433313 --> -0.477759).  Saving model ...
Epoch: 6 cost time: 3.3409390449523926
Epoch: 6, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.749 Vali Acc: 0.522 Test Loss: 1.749 Test Acc: 0.522
Validation loss decreased (-0.477759 --> -0.522205).  Saving model ...
Epoch: 7 cost time: 3.4156806468963623
Epoch: 7, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.604 Vali Acc: 0.578 Test Loss: 1.604 Test Acc: 0.578
Validation loss decreased (-0.522205 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 3.384094715118408
Epoch: 8, Steps: 12 | Train Loss: 1.543 Vali Loss: 1.479 Vali Acc: 0.600 Test Loss: 1.479 Test Acc: 0.600
Validation loss decreased (-0.577762 --> -0.599985).  Saving model ...
Epoch: 9 cost time: 3.3001885414123535
Epoch: 9, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.338 Vali Acc: 0.628 Test Loss: 1.338 Test Acc: 0.628
Validation loss decreased (-0.599985 --> -0.627764).  Saving model ...
Epoch: 10 cost time: 3.4774882793426514
Epoch: 10, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.227 Vali Acc: 0.650 Test Loss: 1.227 Test Acc: 0.650
Validation loss decreased (-0.627764 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 3.19118595123291
Epoch: 11, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.097 Vali Acc: 0.683 Test Loss: 1.097 Test Acc: 0.683
Validation loss decreased (-0.649988 --> -0.683322).  Saving model ...
Epoch: 12 cost time: 3.466020345687866
Epoch: 12, Steps: 12 | Train Loss: 0.900 Vali Loss: 0.984 Vali Acc: 0.706 Test Loss: 0.984 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705546).  Saving model ...
Epoch: 13 cost time: 3.543389081954956
Epoch: 13, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.881 Vali Acc: 0.744 Test Loss: 0.881 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 14 cost time: 3.198627233505249
Epoch: 14, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.830 Vali Acc: 0.744 Test Loss: 0.830 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 15 cost time: 3.224158763885498
Epoch: 15, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.780 Vali Acc: 0.761 Test Loss: 0.780 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 3.48000431060791
Epoch: 16, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 3.3412182331085205
Epoch: 17, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.668 Vali Acc: 0.828 Test Loss: 0.668 Test Acc: 0.828
Validation loss decreased (-0.783326 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 3.467268466949463
Epoch: 18, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 19 cost time: 3.343627691268921
Epoch: 19, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 3.0704078674316406
Epoch: 20, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 21 cost time: 3.294400930404663
Epoch: 21, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.521 Vali Acc: 0.839 Test Loss: 0.521 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.414675712585449
Epoch: 22, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 23 cost time: 3.354278802871704
Epoch: 23, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 24 cost time: 3.161712884902954
Epoch: 24, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 25 cost time: 3.136864423751831
Epoch: 25, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.184070110321045
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 27 cost time: 3.2049660682678223
Epoch: 27, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.245521068572998
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 3.417663097381592
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.466 Vali Acc: 0.856 Test Loss: 0.466 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.364016056060791
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.439829111099243
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.317250967025757
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.5549700260162354
Epoch: 33, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.3781259059906006
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 35 cost time: 3.553959369659424
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.477 Vali Acc: 0.856 Test Loss: 0.477 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3859148025512695
Epoch: 36, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.872 Test Loss: 0.491 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.331113576889038
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.30133318901062
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.487 Vali Acc: 0.872 Test Loss: 0.487 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.2085838317871094
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.475 Vali Acc: 0.883 Test Loss: 0.475 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883329).  Saving model ...
Epoch: 40 cost time: 3.1893115043640137
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.488 Vali Acc: 0.861 Test Loss: 0.488 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4627771377563477
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.521019697189331
Epoch: 42, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.5479650497436523
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.509 Vali Acc: 0.878 Test Loss: 0.509 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.621428966522217
Epoch: 44, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.512 Vali Acc: 0.872 Test Loss: 0.512 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.509484052658081
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.3718881607055664
Epoch: 46, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.5631966590881348
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.481 Vali Acc: 0.883 Test Loss: 0.481 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.4542651176452637
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.515 Vali Acc: 0.872 Test Loss: 0.515 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.54536771774292
Epoch: 49, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.531 Vali Acc: 0.861 Test Loss: 0.531 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.6808435916900635
Epoch: 1, Steps: 12 | Train Loss: 2.822 Vali Loss: 2.642 Vali Acc: 0.094 Test Loss: 2.642 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 3.0887234210968018
Epoch: 2, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.526 Vali Acc: 0.261 Test Loss: 2.526 Test Acc: 0.261
Validation loss decreased (-0.094418 --> -0.261086).  Saving model ...
Epoch: 3 cost time: 3.188716411590576
Epoch: 3, Steps: 12 | Train Loss: 2.577 Vali Loss: 2.389 Vali Acc: 0.283 Test Loss: 2.389 Test Acc: 0.283
Validation loss decreased (-0.261086 --> -0.283309).  Saving model ...
Epoch: 4 cost time: 3.0830655097961426
Epoch: 4, Steps: 12 | Train Loss: 2.385 Vali Loss: 2.261 Vali Acc: 0.289 Test Loss: 2.261 Test Acc: 0.289
Validation loss decreased (-0.283309 --> -0.288866).  Saving model ...
Epoch: 5 cost time: 3.019859552383423
Epoch: 5, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.143 Vali Acc: 0.311 Test Loss: 2.143 Test Acc: 0.311
Validation loss decreased (-0.288866 --> -0.311090).  Saving model ...
Epoch: 6 cost time: 3.2032971382141113
Epoch: 6, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.011 Vali Acc: 0.367 Test Loss: 2.011 Test Acc: 0.367
Validation loss decreased (-0.311090 --> -0.366647).  Saving model ...
Epoch: 7 cost time: 3.3154709339141846
Epoch: 7, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.892 Vali Acc: 0.406 Test Loss: 1.892 Test Acc: 0.406
Validation loss decreased (-0.366647 --> -0.405537).  Saving model ...
Epoch: 8 cost time: 3.1283795833587646
Epoch: 8, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.776 Vali Acc: 0.450 Test Loss: 1.776 Test Acc: 0.450
Validation loss decreased (-0.405537 --> -0.449982).  Saving model ...
Epoch: 9 cost time: 3.0666310787200928
Epoch: 9, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.646 Vali Acc: 0.478 Test Loss: 1.646 Test Acc: 0.478
Validation loss decreased (-0.449982 --> -0.477761).  Saving model ...
Epoch: 10 cost time: 3.027151107788086
Epoch: 10, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.488 Vali Acc: 0.556 Test Loss: 1.488 Test Acc: 0.556
Validation loss decreased (-0.477761 --> -0.555541).  Saving model ...
Epoch: 11 cost time: 3.2067928314208984
Epoch: 11, Steps: 12 | Train Loss: 1.347 Vali Loss: 1.325 Vali Acc: 0.622 Test Loss: 1.325 Test Acc: 0.622
Validation loss decreased (-0.555541 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 3.179523229598999
Epoch: 12, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.207 Vali Acc: 0.661 Test Loss: 1.207 Test Acc: 0.661
Validation loss decreased (-0.622209 --> -0.661099).  Saving model ...
Epoch: 13 cost time: 3.0613486766815186
Epoch: 13, Steps: 12 | Train Loss: 1.000 Vali Loss: 1.061 Vali Acc: 0.683 Test Loss: 1.061 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683323).  Saving model ...
Epoch: 14 cost time: 2.9428508281707764
Epoch: 14, Steps: 12 | Train Loss: 0.854 Vali Loss: 0.991 Vali Acc: 0.722 Test Loss: 0.991 Test Acc: 0.722
Validation loss decreased (-0.683323 --> -0.722212).  Saving model ...
Epoch: 15 cost time: 3.0313949584960938
Epoch: 15, Steps: 12 | Train Loss: 0.773 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 16 cost time: 2.959656000137329
Epoch: 16, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761103).  Saving model ...
Epoch: 17 cost time: 2.9132628440856934
Epoch: 17, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.740 Vali Acc: 0.744 Test Loss: 0.740 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1131200790405273
Epoch: 18, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.699 Vali Acc: 0.767 Test Loss: 0.699 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766660).  Saving model ...
Epoch: 19 cost time: 2.891688823699951
Epoch: 19, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 2.884052276611328
Epoch: 20, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822216).  Saving model ...
Epoch: 21 cost time: 3.223910093307495
Epoch: 21, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 22 cost time: 3.216157913208008
Epoch: 22, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2768380641937256
Epoch: 23, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.160161256790161
Epoch: 24, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.534 Vali Acc: 0.839 Test Loss: 0.534 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 25 cost time: 3.3021914958953857
Epoch: 25, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 3.321491241455078
Epoch: 26, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 3.3076746463775635
Epoch: 27, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2464487552642822
Epoch: 28, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0618107318878174
Epoch: 29, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.9630515575408936
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.944227933883667
Epoch: 31, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.964089870452881
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.9713497161865234
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.986644744873047
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.118476152420044
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.06209397315979
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 37 cost time: 2.970034122467041
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.1979668140411377
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.574 Vali Acc: 0.861 Test Loss: 0.574 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.081467390060425
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.2557857036590576
Epoch: 40, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.3074796199798584
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.594 Vali Acc: 0.861 Test Loss: 0.594 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.30448579788208
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.4114270210266113
Epoch: 43, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.3462471961975098
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.2894980907440186
Epoch: 45, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.3959436416625977
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.576987028121948
Epoch: 1, Steps: 12 | Train Loss: 2.820 Vali Loss: 2.678 Vali Acc: 0.094 Test Loss: 2.678 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 3.4026880264282227
Epoch: 2, Steps: 12 | Train Loss: 2.752 Vali Loss: 2.560 Vali Acc: 0.178 Test Loss: 2.560 Test Acc: 0.178
Validation loss decreased (-0.094418 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 2.967116355895996
Epoch: 3, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.403 Vali Acc: 0.256 Test Loss: 2.403 Test Acc: 0.256
Validation loss decreased (-0.177752 --> -0.255532).  Saving model ...
Epoch: 4 cost time: 3.0270774364471436
Epoch: 4, Steps: 12 | Train Loss: 2.506 Vali Loss: 2.250 Vali Acc: 0.267 Test Loss: 2.250 Test Acc: 0.267
Validation loss decreased (-0.255532 --> -0.266644).  Saving model ...
Epoch: 5 cost time: 3.666375160217285
Epoch: 5, Steps: 12 | Train Loss: 2.423 Vali Loss: 2.120 Vali Acc: 0.283 Test Loss: 2.120 Test Acc: 0.283
Validation loss decreased (-0.266644 --> -0.283312).  Saving model ...
Epoch: 6 cost time: 3.359907627105713
Epoch: 6, Steps: 12 | Train Loss: 2.301 Vali Loss: 1.997 Vali Acc: 0.356 Test Loss: 1.997 Test Acc: 0.356
Validation loss decreased (-0.283312 --> -0.355536).  Saving model ...
Epoch: 7 cost time: 3.4396822452545166
Epoch: 7, Steps: 12 | Train Loss: 2.112 Vali Loss: 1.889 Vali Acc: 0.344 Test Loss: 1.889 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4406650066375732
Epoch: 8, Steps: 12 | Train Loss: 2.040 Vali Loss: 1.805 Vali Acc: 0.411 Test Loss: 1.805 Test Acc: 0.411
Validation loss decreased (-0.355536 --> -0.411093).  Saving model ...
Epoch: 9 cost time: 3.4172964096069336
Epoch: 9, Steps: 12 | Train Loss: 1.842 Vali Loss: 1.698 Vali Acc: 0.444 Test Loss: 1.698 Test Acc: 0.444
Validation loss decreased (-0.411093 --> -0.444427).  Saving model ...
Epoch: 10 cost time: 3.4668140411376953
Epoch: 10, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.539 Vali Acc: 0.517 Test Loss: 1.539 Test Acc: 0.517
Validation loss decreased (-0.444427 --> -0.516651).  Saving model ...
Epoch: 11 cost time: 3.358555555343628
Epoch: 11, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.400 Vali Acc: 0.572 Test Loss: 1.400 Test Acc: 0.572
Validation loss decreased (-0.516651 --> -0.572208).  Saving model ...
Epoch: 12 cost time: 3.332463264465332
Epoch: 12, Steps: 12 | Train Loss: 1.302 Vali Loss: 1.262 Vali Acc: 0.633 Test Loss: 1.262 Test Acc: 0.633
Validation loss decreased (-0.572208 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 3.2892372608184814
Epoch: 13, Steps: 12 | Train Loss: 1.087 Vali Loss: 1.130 Vali Acc: 0.661 Test Loss: 1.130 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 3.2894668579101562
Epoch: 14, Steps: 12 | Train Loss: 1.012 Vali Loss: 1.052 Vali Acc: 0.672 Test Loss: 1.052 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 3.4227285385131836
Epoch: 15, Steps: 12 | Train Loss: 0.874 Vali Loss: 0.962 Vali Acc: 0.717 Test Loss: 0.962 Test Acc: 0.717
Validation loss decreased (-0.672212 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 3.194023609161377
Epoch: 16, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.869 Vali Acc: 0.706 Test Loss: 0.869 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.211198568344116
Epoch: 17, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.818 Vali Acc: 0.744 Test Loss: 0.818 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 3.5796356201171875
Epoch: 18, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.767 Vali Acc: 0.733 Test Loss: 0.767 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5652599334716797
Epoch: 19, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.683 Vali Acc: 0.772 Test Loss: 0.683 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772215).  Saving model ...
Epoch: 20 cost time: 3.5302412509918213
Epoch: 20, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 21 cost time: 3.5647640228271484
Epoch: 21, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.613 Vali Acc: 0.778 Test Loss: 0.613 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777772).  Saving model ...
Epoch: 22 cost time: 3.7211079597473145
Epoch: 22, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.607 Vali Acc: 0.817 Test Loss: 0.607 Test Acc: 0.817
Validation loss decreased (-0.777772 --> -0.816661).  Saving model ...
Epoch: 23 cost time: 3.9288854598999023
Epoch: 23, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 3.533936023712158
Epoch: 24, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 3.9458718299865723
Epoch: 25, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.308556318283081
Epoch: 26, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.561 Vali Acc: 0.839 Test Loss: 0.561 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5757737159729004
Epoch: 27, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 3.259934663772583
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 29 cost time: 3.5277552604675293
Epoch: 29, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1913819313049316
Epoch: 30, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.293198347091675
Epoch: 31, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.2824978828430176
Epoch: 32, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.2969000339508057
Epoch: 33, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4926843643188477
Epoch: 34, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.3677053451538086
Epoch: 35, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.545 Vali Acc: 0.867 Test Loss: 0.545 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 36 cost time: 3.5758309364318848
Epoch: 36, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.555 Vali Acc: 0.839 Test Loss: 0.555 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.4210946559906006
Epoch: 37, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.586 Vali Acc: 0.872 Test Loss: 0.586 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 38 cost time: 3.539715528488159
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.31720232963562
Epoch: 39, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.1681032180786133
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.970475435256958
Epoch: 41, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4646079540252686
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.567 Vali Acc: 0.861 Test Loss: 0.567 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.1241445541381836
Epoch: 43, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.024204969406128
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.595 Vali Acc: 0.850 Test Loss: 0.595 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.227843999862671
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.2073421478271484
Epoch: 46, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.585 Vali Acc: 0.828 Test Loss: 0.585 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.210911989212036
Epoch: 47, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.830722808837891
Epoch: 1, Steps: 12 | Train Loss: 2.858 Vali Loss: 2.644 Vali Acc: 0.117 Test Loss: 2.644 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 3.617675542831421
Epoch: 2, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.466 Vali Acc: 0.217 Test Loss: 2.466 Test Acc: 0.217
Validation loss decreased (-0.116640 --> -0.216642).  Saving model ...
Epoch: 3 cost time: 3.4978129863739014
Epoch: 3, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.296 Vali Acc: 0.261 Test Loss: 2.296 Test Acc: 0.261
Validation loss decreased (-0.216642 --> -0.261088).  Saving model ...
Epoch: 4 cost time: 3.516023874282837
Epoch: 4, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.179 Vali Acc: 0.289 Test Loss: 2.179 Test Acc: 0.289
Validation loss decreased (-0.261088 --> -0.288867).  Saving model ...
Epoch: 5 cost time: 3.4876394271850586
Epoch: 5, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.108 Vali Acc: 0.300 Test Loss: 2.108 Test Acc: 0.300
Validation loss decreased (-0.288867 --> -0.299979).  Saving model ...
Epoch: 6 cost time: 3.3297388553619385
Epoch: 6, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.036 Vali Acc: 0.322 Test Loss: 2.036 Test Acc: 0.322
Validation loss decreased (-0.299979 --> -0.322202).  Saving model ...
Epoch: 7 cost time: 3.3327505588531494
Epoch: 7, Steps: 12 | Train Loss: 2.160 Vali Loss: 1.958 Vali Acc: 0.361 Test Loss: 1.958 Test Acc: 0.361
Validation loss decreased (-0.322202 --> -0.361092).  Saving model ...
Epoch: 8 cost time: 3.1747195720672607
Epoch: 8, Steps: 12 | Train Loss: 2.065 Vali Loss: 1.867 Vali Acc: 0.406 Test Loss: 1.867 Test Acc: 0.406
Validation loss decreased (-0.361092 --> -0.405537).  Saving model ...
Epoch: 9 cost time: 3.3102920055389404
Epoch: 9, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.731 Vali Acc: 0.439 Test Loss: 1.731 Test Acc: 0.439
Validation loss decreased (-0.405537 --> -0.438872).  Saving model ...
Epoch: 10 cost time: 3.216963529586792
Epoch: 10, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.505 Vali Acc: 0.533 Test Loss: 1.505 Test Acc: 0.533
Validation loss decreased (-0.438872 --> -0.533318).  Saving model ...
Epoch: 11 cost time: 3.602216958999634
Epoch: 11, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.365 Vali Acc: 0.556 Test Loss: 1.365 Test Acc: 0.556
Validation loss decreased (-0.533318 --> -0.555542).  Saving model ...
Epoch: 12 cost time: 3.371284008026123
Epoch: 12, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.247 Vali Acc: 0.617 Test Loss: 1.247 Test Acc: 0.617
Validation loss decreased (-0.555542 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 3.7053704261779785
Epoch: 13, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.119 Vali Acc: 0.656 Test Loss: 1.119 Test Acc: 0.656
Validation loss decreased (-0.616654 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 3.57218074798584
Epoch: 14, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.038 Vali Acc: 0.650 Test Loss: 1.038 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6232874393463135
Epoch: 15, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.950 Vali Acc: 0.689 Test Loss: 0.950 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688879).  Saving model ...
Epoch: 16 cost time: 3.7197182178497314
Epoch: 16, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.870 Vali Acc: 0.683 Test Loss: 0.870 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7538363933563232
Epoch: 17, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
Validation loss decreased (-0.688879 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 3.4994468688964844
Epoch: 18, Steps: 12 | Train Loss: 0.545 Vali Loss: 0.772 Vali Acc: 0.717 Test Loss: 0.772 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4919817447662354
Epoch: 19, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 20 cost time: 3.322922706604004
Epoch: 20, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.660 Vali Acc: 0.800 Test Loss: 0.660 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 3.4537105560302734
Epoch: 21, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 3.196124792098999
Epoch: 22, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.096897602081299
Epoch: 23, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.618 Vali Acc: 0.800 Test Loss: 0.618 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1170899868011475
Epoch: 24, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 3.4212327003479004
Epoch: 25, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.575 Vali Acc: 0.828 Test Loss: 0.575 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.621464967727661
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.561 Vali Acc: 0.839 Test Loss: 0.561 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 3.466143846511841
Epoch: 27, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.570 Vali Acc: 0.806 Test Loss: 0.570 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.298748016357422
Epoch: 28, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.536 Vali Acc: 0.839 Test Loss: 0.536 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 29 cost time: 3.4161031246185303
Epoch: 29, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5636560916900635
Epoch: 30, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.433724880218506
Epoch: 31, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
Validation loss decreased (-0.838884 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 3.5801243782043457
Epoch: 32, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.178694486618042
Epoch: 33, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.141753911972046
Epoch: 34, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.175041675567627
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.571 Vali Acc: 0.828 Test Loss: 0.571 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.397383451461792
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.1273131370544434
Epoch: 37, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.565 Vali Acc: 0.833 Test Loss: 0.565 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2001466751098633
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.587 Vali Acc: 0.861 Test Loss: 0.587 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 39 cost time: 3.3314731121063232
Epoch: 39, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3371200561523438
Epoch: 40, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.691606044769287
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.613 Vali Acc: 0.822 Test Loss: 0.613 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.4505059719085693
Epoch: 42, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.570 Vali Acc: 0.817 Test Loss: 0.570 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.821472406387329
Epoch: 43, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.587 Vali Acc: 0.817 Test Loss: 0.587 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.6907944679260254
Epoch: 44, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.3545022010803223
Epoch: 45, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.577 Vali Acc: 0.839 Test Loss: 0.577 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.49052357673645
Epoch: 46, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.4057607650756836
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.563 Vali Acc: 0.856 Test Loss: 0.563 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.4742419719696045
Epoch: 48, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.995471239089966
Epoch: 1, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.744 Vali Acc: 0.089 Test Loss: 2.744 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 3.007798910140991
Epoch: 2, Steps: 12 | Train Loss: 2.710 Vali Loss: 2.619 Vali Acc: 0.150 Test Loss: 2.619 Test Acc: 0.150
Validation loss decreased (-0.088861 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 3.1326470375061035
Epoch: 3, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.454 Vali Acc: 0.233 Test Loss: 2.454 Test Acc: 0.233
Validation loss decreased (-0.149974 --> -0.233309).  Saving model ...
Epoch: 4 cost time: 3.567547559738159
Epoch: 4, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.282 Vali Acc: 0.311 Test Loss: 2.282 Test Acc: 0.311
Validation loss decreased (-0.233309 --> -0.311088).  Saving model ...
Epoch: 5 cost time: 3.369347095489502
Epoch: 5, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.143 Vali Acc: 0.322 Test Loss: 2.143 Test Acc: 0.322
Validation loss decreased (-0.311088 --> -0.322201).  Saving model ...
Epoch: 6 cost time: 3.2341835498809814
Epoch: 6, Steps: 12 | Train Loss: 2.368 Vali Loss: 2.033 Vali Acc: 0.344 Test Loss: 2.033 Test Acc: 0.344
Validation loss decreased (-0.322201 --> -0.344424).  Saving model ...
Epoch: 7 cost time: 3.5033135414123535
Epoch: 7, Steps: 12 | Train Loss: 2.231 Vali Loss: 1.930 Vali Acc: 0.367 Test Loss: 1.930 Test Acc: 0.367
Validation loss decreased (-0.344424 --> -0.366647).  Saving model ...
Epoch: 8 cost time: 3.2737669944763184
Epoch: 8, Steps: 12 | Train Loss: 2.172 Vali Loss: 1.849 Vali Acc: 0.367 Test Loss: 1.849 Test Acc: 0.367
Validation loss decreased (-0.366647 --> -0.366648).  Saving model ...
Epoch: 9 cost time: 3.2488319873809814
Epoch: 9, Steps: 12 | Train Loss: 1.959 Vali Loss: 1.757 Vali Acc: 0.417 Test Loss: 1.757 Test Acc: 0.417
Validation loss decreased (-0.366648 --> -0.416649).  Saving model ...
Epoch: 10 cost time: 3.2186057567596436
Epoch: 10, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.576 Vali Acc: 0.494 Test Loss: 1.576 Test Acc: 0.494
Validation loss decreased (-0.416649 --> -0.494429).  Saving model ...
Epoch: 11 cost time: 3.120307207107544
Epoch: 11, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.433 Vali Acc: 0.528 Test Loss: 1.433 Test Acc: 0.528
Validation loss decreased (-0.494429 --> -0.527763).  Saving model ...
Epoch: 12 cost time: 3.059236526489258
Epoch: 12, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.284 Vali Acc: 0.606 Test Loss: 1.284 Test Acc: 0.606
Validation loss decreased (-0.527763 --> -0.605543).  Saving model ...
Epoch: 13 cost time: 2.938664436340332
Epoch: 13, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.157 Vali Acc: 0.611 Test Loss: 1.157 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611100).  Saving model ...
Epoch: 14 cost time: 2.9895381927490234
Epoch: 14, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.037 Vali Acc: 0.672 Test Loss: 1.037 Test Acc: 0.672
Validation loss decreased (-0.611100 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 2.937227249145508
Epoch: 15, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.923 Vali Acc: 0.717 Test Loss: 0.923 Test Acc: 0.717
Validation loss decreased (-0.672212 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 2.882697105407715
Epoch: 16, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.840 Vali Acc: 0.711 Test Loss: 0.840 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1370413303375244
Epoch: 17, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.787 Vali Acc: 0.733 Test Loss: 0.787 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733325).  Saving model ...
Epoch: 18 cost time: 3.130061388015747
Epoch: 18, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 3.1920173168182373
Epoch: 19, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
Validation loss decreased (-0.749992 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 3.1367604732513428
Epoch: 20, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 21 cost time: 2.981863260269165
Epoch: 21, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 3.0173933506011963
Epoch: 22, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 23 cost time: 3.173727512359619
Epoch: 23, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.590 Vali Acc: 0.817 Test Loss: 0.590 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0737292766571045
Epoch: 24, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.549 Vali Acc: 0.839 Test Loss: 0.549 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 3.2865915298461914
Epoch: 25, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 3.170827865600586
Epoch: 26, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 3.3305530548095703
Epoch: 27, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4362306594848633
Epoch: 28, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.156287431716919
Epoch: 29, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2769784927368164
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.137744426727295
Epoch: 31, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.317291498184204
Epoch: 32, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.3128504753112793
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 34 cost time: 3.3302114009857178
Epoch: 34, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.538 Vali Acc: 0.839 Test Loss: 0.538 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.7930150032043457
Epoch: 35, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0543320178985596
Epoch: 36, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 37 cost time: 3.240621328353882
Epoch: 37, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.037113666534424
Epoch: 38, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.551 Vali Acc: 0.861 Test Loss: 0.551 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 3.004149913787842
Epoch: 39, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.326599359512329
Epoch: 40, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 3.266496419906616
Epoch: 41, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.574 Vali Acc: 0.839 Test Loss: 0.574 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.318190336227417
Epoch: 42, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.2235071659088135
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.2312896251678467
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.3155064582824707
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.586 Vali Acc: 0.844 Test Loss: 0.586 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.241417169570923
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.2563230991363525
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.170381546020508
Epoch: 48, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.0900802612304688
Epoch: 49, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.9995243549346924
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.2000322341918945
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 2.9191243648529053
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 2.937711477279663
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 2.9356372356414795
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.079427719116211
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9691059589385986
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.971648931503296
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.772717237472534
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.041985273361206
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9263827800750732
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9047813415527344
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0449509620666504
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8953440189361572
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.707 Vali Acc: 0.067 Test Loss: 2.707 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 943759
model size : 6.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.789727687835693
Epoch: 1, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.612 Vali Acc: 0.222 Test Loss: 2.612 Test Acc: 0.222
Validation loss decreased (inf --> -0.222196).  Saving model ...
Epoch: 2 cost time: 3.345027446746826
Epoch: 2, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.358 Vali Acc: 0.306 Test Loss: 2.358 Test Acc: 0.306
Validation loss decreased (-0.222196 --> -0.305532).  Saving model ...
Epoch: 3 cost time: 3.190398931503296
Epoch: 3, Steps: 12 | Train Loss: 2.255 Vali Loss: 2.074 Vali Acc: 0.500 Test Loss: 2.074 Test Acc: 0.500
Validation loss decreased (-0.305532 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 3.504843235015869
Epoch: 4, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.832 Vali Acc: 0.583 Test Loss: 1.832 Test Acc: 0.583
Validation loss decreased (-0.499979 --> -0.583315).  Saving model ...
Epoch: 5 cost time: 3.608755588531494
Epoch: 5, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.613 Vali Acc: 0.611 Test Loss: 1.613 Test Acc: 0.611
Validation loss decreased (-0.583315 --> -0.611095).  Saving model ...
Epoch: 6 cost time: 3.59338641166687
Epoch: 6, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.433 Vali Acc: 0.650 Test Loss: 1.433 Test Acc: 0.650
Validation loss decreased (-0.611095 --> -0.649986).  Saving model ...
Epoch: 7 cost time: 3.4927022457122803
Epoch: 7, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.294 Vali Acc: 0.656 Test Loss: 1.294 Test Acc: 0.656
Validation loss decreased (-0.649986 --> -0.655543).  Saving model ...
Epoch: 8 cost time: 3.8949263095855713
Epoch: 8, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.165 Vali Acc: 0.683 Test Loss: 1.165 Test Acc: 0.683
Validation loss decreased (-0.655543 --> -0.683322).  Saving model ...
Epoch: 9 cost time: 3.9082977771759033
Epoch: 9, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.080 Vali Acc: 0.706 Test Loss: 1.080 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705545).  Saving model ...
Epoch: 10 cost time: 3.5809292793273926
Epoch: 10, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.973 Vali Acc: 0.711 Test Loss: 0.973 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711101).  Saving model ...
Epoch: 11 cost time: 3.3801932334899902
Epoch: 11, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.874 Vali Acc: 0.728 Test Loss: 0.874 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 3.369272232055664
Epoch: 12, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 3.300368070602417
Epoch: 13, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.714 Vali Acc: 0.783 Test Loss: 0.714 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 3.3127100467681885
Epoch: 14, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 3.513972759246826
Epoch: 15, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 16 cost time: 3.185307025909424
Epoch: 16, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 17 cost time: 3.442683219909668
Epoch: 17, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.511 Vali Acc: 0.822 Test Loss: 0.511 Test Acc: 0.822
Validation loss decreased (-0.822217 --> -0.822217).  Saving model ...
Epoch: 18 cost time: 3.776235580444336
Epoch: 18, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849995).  Saving model ...
Epoch: 19 cost time: 3.53369140625
Epoch: 19, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.450 Vali Acc: 0.856 Test Loss: 0.450 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 20 cost time: 3.5182111263275146
Epoch: 20, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.423 Vali Acc: 0.861 Test Loss: 0.423 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 21 cost time: 3.798689842224121
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.429 Vali Acc: 0.872 Test Loss: 0.429 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 22 cost time: 3.404106855392456
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.415 Vali Acc: 0.878 Test Loss: 0.415 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 23 cost time: 3.5295848846435547
Epoch: 23, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894440).  Saving model ...
Epoch: 24 cost time: 3.3801698684692383
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.400 Vali Acc: 0.872 Test Loss: 0.400 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3967041969299316
Epoch: 25, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 3.65511417388916
Epoch: 26, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.386 Vali Acc: 0.883 Test Loss: 0.386 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5074045658111572
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.796489715576172
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6079437732696533
Epoch: 29, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.422072410583496
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.6108384132385254
Epoch: 31, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.614017963409424
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 33 cost time: 3.947371244430542
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 3.6204702854156494
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.369 Vali Acc: 0.894 Test Loss: 0.369 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6457366943359375
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.395 Vali Acc: 0.894 Test Loss: 0.395 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.658130407333374
Epoch: 36, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.8969781398773193
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.372 Vali Acc: 0.894 Test Loss: 0.372 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.5894393920898438
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.384 Vali Acc: 0.894 Test Loss: 0.384 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.485741376876831
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.376 Vali Acc: 0.894 Test Loss: 0.376 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.2421226501464844
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.2386128902435303
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.403 Vali Acc: 0.894 Test Loss: 0.403 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.459665536880493
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.408 Vali Acc: 0.894 Test Loss: 0.408 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.366328477859497
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.077897071838379
Epoch: 1, Steps: 12 | Train Loss: 2.720 Vali Loss: 2.644 Vali Acc: 0.239 Test Loss: 2.644 Test Acc: 0.239
Validation loss decreased (inf --> -0.238862).  Saving model ...
Epoch: 2 cost time: 3.193087577819824
Epoch: 2, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.434 Vali Acc: 0.300 Test Loss: 2.434 Test Acc: 0.300
Validation loss decreased (-0.238862 --> -0.299976).  Saving model ...
Epoch: 3 cost time: 3.3860726356506348
Epoch: 3, Steps: 12 | Train Loss: 2.386 Vali Loss: 2.190 Vali Acc: 0.483 Test Loss: 2.190 Test Acc: 0.483
Validation loss decreased (-0.299976 --> -0.483311).  Saving model ...
Epoch: 4 cost time: 3.902559757232666
Epoch: 4, Steps: 12 | Train Loss: 2.171 Vali Loss: 1.973 Vali Acc: 0.550 Test Loss: 1.973 Test Acc: 0.550
Validation loss decreased (-0.483311 --> -0.549980).  Saving model ...
Epoch: 5 cost time: 3.3172338008880615
Epoch: 5, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.769 Vali Acc: 0.594 Test Loss: 1.769 Test Acc: 0.594
Validation loss decreased (-0.549980 --> -0.594427).  Saving model ...
Epoch: 6 cost time: 3.4159841537475586
Epoch: 6, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.592 Vali Acc: 0.600 Test Loss: 1.592 Test Acc: 0.600
Validation loss decreased (-0.594427 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 3.1459827423095703
Epoch: 7, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.448 Vali Acc: 0.606 Test Loss: 1.448 Test Acc: 0.606
Validation loss decreased (-0.599984 --> -0.605541).  Saving model ...
Epoch: 8 cost time: 3.553274393081665
Epoch: 8, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.310 Vali Acc: 0.633 Test Loss: 1.310 Test Acc: 0.633
Validation loss decreased (-0.605541 --> -0.633320).  Saving model ...
Epoch: 9 cost time: 3.336452007293701
Epoch: 9, Steps: 12 | Train Loss: 1.119 Vali Loss: 1.206 Vali Acc: 0.667 Test Loss: 1.206 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 3.3793153762817383
Epoch: 10, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.090 Vali Acc: 0.728 Test Loss: 1.090 Test Acc: 0.728
Validation loss decreased (-0.666655 --> -0.727767).  Saving model ...
Epoch: 11 cost time: 3.1228818893432617
Epoch: 11, Steps: 12 | Train Loss: 0.835 Vali Loss: 0.994 Vali Acc: 0.728 Test Loss: 0.994 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 12 cost time: 3.114471197128296
Epoch: 12, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 3.3491413593292236
Epoch: 13, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.821 Vali Acc: 0.767 Test Loss: 0.821 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766658).  Saving model ...
Epoch: 14 cost time: 3.4898228645324707
Epoch: 14, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788882).  Saving model ...
Epoch: 15 cost time: 3.484783172607422
Epoch: 15, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.647 Vali Acc: 0.806 Test Loss: 0.647 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 3.9839563369750977
Epoch: 16, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.607 Vali Acc: 0.828 Test Loss: 0.607 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 17 cost time: 3.5135746002197266
Epoch: 17, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 18 cost time: 3.355813503265381
Epoch: 18, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
Validation loss decreased (-0.838883 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 3.3036036491394043
Epoch: 19, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5782039165496826
Epoch: 20, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.473 Vali Acc: 0.872 Test Loss: 0.473 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 21 cost time: 3.359522819519043
Epoch: 21, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 22 cost time: 3.2413992881774902
Epoch: 22, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.459 Vali Acc: 0.894 Test Loss: 0.459 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894440).  Saving model ...
Epoch: 23 cost time: 3.4161131381988525
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3299357891082764
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.455 Vali Acc: 0.894 Test Loss: 0.455 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 25 cost time: 3.4754085540771484
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.443 Vali Acc: 0.889 Test Loss: 0.443 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3784115314483643
Epoch: 26, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5122017860412598
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 3.4667835235595703
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.438 Vali Acc: 0.894 Test Loss: 0.438 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6470611095428467
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5545623302459717
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.7751996517181396
Epoch: 31, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.419 Vali Acc: 0.894 Test Loss: 0.419 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.627537488937378
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.423 Vali Acc: 0.906 Test Loss: 0.423 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905551).  Saving model ...
Epoch: 33 cost time: 3.7470223903656006
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.436 Vali Acc: 0.894 Test Loss: 0.436 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.7797131538391113
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.435 Vali Acc: 0.894 Test Loss: 0.435 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.4242208003997803
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.429 Vali Acc: 0.894 Test Loss: 0.429 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.3669707775115967
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.472 Vali Acc: 0.889 Test Loss: 0.472 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.416623115539551
Epoch: 37, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.544975996017456
Epoch: 38, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.253938913345337
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.447 Vali Acc: 0.906 Test Loss: 0.447 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.419647693634033
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.450 Vali Acc: 0.906 Test Loss: 0.450 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.2293941974639893
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.446 Vali Acc: 0.906 Test Loss: 0.446 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.227017879486084
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.460 Vali Acc: 0.906 Test Loss: 0.460 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.52006196975708
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.667 Vali Acc: 0.200 Test Loss: 2.667 Test Acc: 0.200
Validation loss decreased (inf --> -0.199973).  Saving model ...
Epoch: 2 cost time: 2.966012716293335
Epoch: 2, Steps: 12 | Train Loss: 2.597 Vali Loss: 2.500 Vali Acc: 0.244 Test Loss: 2.500 Test Acc: 0.244
Validation loss decreased (-0.199973 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 3.2286977767944336
Epoch: 3, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.305 Vali Acc: 0.356 Test Loss: 2.305 Test Acc: 0.356
Validation loss decreased (-0.244419 --> -0.355533).  Saving model ...
Epoch: 4 cost time: 3.0687835216522217
Epoch: 4, Steps: 12 | Train Loss: 2.311 Vali Loss: 2.132 Vali Acc: 0.411 Test Loss: 2.132 Test Acc: 0.411
Validation loss decreased (-0.355533 --> -0.411090).  Saving model ...
Epoch: 5 cost time: 3.1624274253845215
Epoch: 5, Steps: 12 | Train Loss: 2.079 Vali Loss: 1.970 Vali Acc: 0.472 Test Loss: 1.970 Test Acc: 0.472
Validation loss decreased (-0.411090 --> -0.472203).  Saving model ...
Epoch: 6 cost time: 3.1129019260406494
Epoch: 6, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.817 Vali Acc: 0.494 Test Loss: 1.817 Test Acc: 0.494
Validation loss decreased (-0.472203 --> -0.494426).  Saving model ...
Epoch: 7 cost time: 2.9406309127807617
Epoch: 7, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.693 Vali Acc: 0.556 Test Loss: 1.693 Test Acc: 0.556
Validation loss decreased (-0.494426 --> -0.555539).  Saving model ...
Epoch: 8 cost time: 3.0879569053649902
Epoch: 8, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.562 Vali Acc: 0.567 Test Loss: 1.562 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566651).  Saving model ...
Epoch: 9 cost time: 2.9067134857177734
Epoch: 9, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.433 Vali Acc: 0.622 Test Loss: 1.433 Test Acc: 0.622
Validation loss decreased (-0.566651 --> -0.622208).  Saving model ...
Epoch: 10 cost time: 2.899132490158081
Epoch: 10, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.305 Vali Acc: 0.628 Test Loss: 1.305 Test Acc: 0.628
Validation loss decreased (-0.622208 --> -0.627765).  Saving model ...
Epoch: 11 cost time: 2.8193483352661133
Epoch: 11, Steps: 12 | Train Loss: 1.088 Vali Loss: 1.193 Vali Acc: 0.639 Test Loss: 1.193 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 12 cost time: 2.7189745903015137
Epoch: 12, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.071 Vali Acc: 0.694 Test Loss: 1.071 Test Acc: 0.694
Validation loss decreased (-0.638877 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 2.771089792251587
Epoch: 13, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.984 Vali Acc: 0.700 Test Loss: 0.984 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 3.2283217906951904
Epoch: 14, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.882 Vali Acc: 0.717 Test Loss: 0.882 Test Acc: 0.717
Validation loss decreased (-0.699990 --> -0.716658).  Saving model ...
Epoch: 15 cost time: 2.945906400680542
Epoch: 15, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.829 Vali Acc: 0.750 Test Loss: 0.829 Test Acc: 0.750
Validation loss decreased (-0.716658 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 3.0840837955474854
Epoch: 16, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.756 Vali Acc: 0.794 Test Loss: 0.756 Test Acc: 0.794
Validation loss decreased (-0.749992 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 3.0101373195648193
Epoch: 17, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9829275608062744
Epoch: 18, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.794437 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 3.1280407905578613
Epoch: 19, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 20 cost time: 3.233947515487671
Epoch: 20, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 3.0558998584747314
Epoch: 21, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.560 Vali Acc: 0.839 Test Loss: 0.560 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8996644020080566
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.908710241317749
Epoch: 23, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
Validation loss decreased (-0.849994 --> -0.866662).  Saving model ...
Epoch: 24 cost time: 2.915431261062622
Epoch: 24, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.883639097213745
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.8568670749664307
Epoch: 26, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.157017707824707
Epoch: 27, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.500 Vali Acc: 0.856 Test Loss: 0.500 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.8546135425567627
Epoch: 28, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.295321464538574
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.503 Vali Acc: 0.850 Test Loss: 0.503 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0634753704071045
Epoch: 30, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.495 Vali Acc: 0.867 Test Loss: 0.495 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.9342246055603027
Epoch: 31, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 2.998009443283081
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.480 Vali Acc: 0.883 Test Loss: 0.480 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 33 cost time: 3.2044410705566406
Epoch: 33, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.135855197906494
Epoch: 34, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 35 cost time: 2.9716837406158447
Epoch: 35, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 3.0165348052978516
Epoch: 36, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.884784698486328
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.6710004806518555
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.501 Vali Acc: 0.878 Test Loss: 0.501 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.7674314975738525
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.9211652278900146
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.478 Vali Acc: 0.883 Test Loss: 0.478 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.8073339462280273
Epoch: 41, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.506 Vali Acc: 0.872 Test Loss: 0.506 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.909935712814331
Epoch: 42, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.222118377685547
Epoch: 43, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.372551441192627
Epoch: 44, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.507 Vali Acc: 0.872 Test Loss: 0.507 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.333876609802246
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.684807777404785
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.677 Vali Acc: 0.089 Test Loss: 2.677 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 3.0929508209228516
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.568 Vali Acc: 0.128 Test Loss: 2.568 Test Acc: 0.128
Validation loss decreased (-0.088862 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 3.0421698093414307
Epoch: 3, Steps: 12 | Train Loss: 2.546 Vali Loss: 2.439 Vali Acc: 0.228 Test Loss: 2.439 Test Acc: 0.228
Validation loss decreased (-0.127752 --> -0.227753).  Saving model ...
Epoch: 4 cost time: 2.82881498336792
Epoch: 4, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.323 Vali Acc: 0.267 Test Loss: 2.323 Test Acc: 0.267
Validation loss decreased (-0.227753 --> -0.266643).  Saving model ...
Epoch: 5 cost time: 3.144521951675415
Epoch: 5, Steps: 12 | Train Loss: 2.269 Vali Loss: 2.202 Vali Acc: 0.300 Test Loss: 2.202 Test Acc: 0.300
Validation loss decreased (-0.266643 --> -0.299978).  Saving model ...
Epoch: 6 cost time: 2.9489901065826416
Epoch: 6, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.064 Vali Acc: 0.333 Test Loss: 2.064 Test Acc: 0.333
Validation loss decreased (-0.299978 --> -0.333313).  Saving model ...
Epoch: 7 cost time: 3.1315691471099854
Epoch: 7, Steps: 12 | Train Loss: 1.999 Vali Loss: 1.954 Vali Acc: 0.361 Test Loss: 1.954 Test Acc: 0.361
Validation loss decreased (-0.333313 --> -0.361092).  Saving model ...
Epoch: 8 cost time: 2.937870979309082
Epoch: 8, Steps: 12 | Train Loss: 1.882 Vali Loss: 1.813 Vali Acc: 0.372 Test Loss: 1.813 Test Acc: 0.372
Validation loss decreased (-0.361092 --> -0.372204).  Saving model ...
Epoch: 9 cost time: 2.9279770851135254
Epoch: 9, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.668 Vali Acc: 0.422 Test Loss: 1.668 Test Acc: 0.422
Validation loss decreased (-0.372204 --> -0.422206).  Saving model ...
Epoch: 10 cost time: 2.9563217163085938
Epoch: 10, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.499 Vali Acc: 0.556 Test Loss: 1.499 Test Acc: 0.556
Validation loss decreased (-0.422206 --> -0.555541).  Saving model ...
Epoch: 11 cost time: 3.3212249279022217
Epoch: 11, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.325 Vali Acc: 0.622 Test Loss: 1.325 Test Acc: 0.622
Validation loss decreased (-0.555541 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 3.1911518573760986
Epoch: 12, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.155 Vali Acc: 0.672 Test Loss: 1.155 Test Acc: 0.672
Validation loss decreased (-0.622209 --> -0.672211).  Saving model ...
Epoch: 13 cost time: 3.322756290435791
Epoch: 13, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.052 Vali Acc: 0.706 Test Loss: 1.052 Test Acc: 0.706
Validation loss decreased (-0.672211 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 3.0461111068725586
Epoch: 14, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5624945163726807
Epoch: 15, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716658).  Saving model ...
Epoch: 16 cost time: 3.1719865798950195
Epoch: 16, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 17 cost time: 3.0748541355133057
Epoch: 17, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.781 Vali Acc: 0.756 Test Loss: 0.781 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 18 cost time: 3.2487919330596924
Epoch: 18, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.731 Vali Acc: 0.772 Test Loss: 0.731 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 3.0221991539001465
Epoch: 19, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 3.318352460861206
Epoch: 20, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.659 Vali Acc: 0.806 Test Loss: 0.659 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 21 cost time: 3.3531060218811035
Epoch: 21, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7183480262756348
Epoch: 22, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.623 Vali Acc: 0.811 Test Loss: 0.623 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 3.351973533630371
Epoch: 23, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.572 Vali Acc: 0.817 Test Loss: 0.572 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 24 cost time: 3.625221014022827
Epoch: 24, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.610 Vali Acc: 0.817 Test Loss: 0.610 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.252972364425659
Epoch: 25, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 3.0279572010040283
Epoch: 26, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.539 Vali Acc: 0.839 Test Loss: 0.539 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 27 cost time: 3.752204656600952
Epoch: 27, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4788756370544434
Epoch: 28, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 29 cost time: 3.568230390548706
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.516127586364746
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 31 cost time: 3.175968885421753
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.22110652923584
Epoch: 32, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.431509017944336
Epoch: 33, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 34 cost time: 3.410935163497925
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2786173820495605
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.578 Vali Acc: 0.856 Test Loss: 0.578 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.1588492393493652
Epoch: 36, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.578 Vali Acc: 0.839 Test Loss: 0.578 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.474968671798706
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.533 Vali Acc: 0.867 Test Loss: 0.533 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 38 cost time: 3.534533977508545
Epoch: 38, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.9017906188964844
Epoch: 39, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.546 Vali Acc: 0.856 Test Loss: 0.546 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.1925384998321533
Epoch: 40, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.483336925506592
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.571 Vali Acc: 0.856 Test Loss: 0.571 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.2254278659820557
Epoch: 42, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.155757188796997
Epoch: 43, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.906771421432495
Epoch: 44, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.570 Vali Acc: 0.856 Test Loss: 0.570 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.9775984287261963
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.0692367553710938
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.1897521018981934
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.424333572387695
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.721 Vali Acc: 0.072 Test Loss: 2.721 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 3.397007465362549
Epoch: 2, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.612 Vali Acc: 0.167 Test Loss: 2.612 Test Acc: 0.167
Validation loss decreased (-0.072195 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 2.97189998626709
Epoch: 3, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.469 Vali Acc: 0.233 Test Loss: 2.469 Test Acc: 0.233
Validation loss decreased (-0.166641 --> -0.233309).  Saving model ...
Epoch: 4 cost time: 3.3560149669647217
Epoch: 4, Steps: 12 | Train Loss: 2.584 Vali Loss: 2.323 Vali Acc: 0.289 Test Loss: 2.323 Test Acc: 0.289
Validation loss decreased (-0.233309 --> -0.288866).  Saving model ...
Epoch: 5 cost time: 2.999154806137085
Epoch: 5, Steps: 12 | Train Loss: 2.453 Vali Loss: 2.170 Vali Acc: 0.317 Test Loss: 2.170 Test Acc: 0.317
Validation loss decreased (-0.288866 --> -0.316645).  Saving model ...
Epoch: 6 cost time: 3.4401729106903076
Epoch: 6, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.030 Vali Acc: 0.372 Test Loss: 2.030 Test Acc: 0.372
Validation loss decreased (-0.316645 --> -0.372202).  Saving model ...
Epoch: 7 cost time: 3.1504154205322266
Epoch: 7, Steps: 12 | Train Loss: 2.192 Vali Loss: 1.906 Vali Acc: 0.394 Test Loss: 1.906 Test Acc: 0.394
Validation loss decreased (-0.372202 --> -0.394425).  Saving model ...
Epoch: 8 cost time: 3.454075336456299
Epoch: 8, Steps: 12 | Train Loss: 2.057 Vali Loss: 1.787 Vali Acc: 0.400 Test Loss: 1.787 Test Acc: 0.400
Validation loss decreased (-0.394425 --> -0.399982).  Saving model ...
Epoch: 9 cost time: 3.673313856124878
Epoch: 9, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.676 Vali Acc: 0.456 Test Loss: 1.676 Test Acc: 0.456
Validation loss decreased (-0.399982 --> -0.455539).  Saving model ...
Epoch: 10 cost time: 3.4263126850128174
Epoch: 10, Steps: 12 | Train Loss: 1.657 Vali Loss: 1.551 Vali Acc: 0.483 Test Loss: 1.551 Test Acc: 0.483
Validation loss decreased (-0.455539 --> -0.483318).  Saving model ...
Epoch: 11 cost time: 3.089731454849243
Epoch: 11, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.397 Vali Acc: 0.533 Test Loss: 1.397 Test Acc: 0.533
Validation loss decreased (-0.483318 --> -0.533319).  Saving model ...
Epoch: 12 cost time: 3.2459542751312256
Epoch: 12, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.277 Vali Acc: 0.594 Test Loss: 1.277 Test Acc: 0.594
Validation loss decreased (-0.533319 --> -0.594432).  Saving model ...
Epoch: 13 cost time: 3.162759304046631
Epoch: 13, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.159 Vali Acc: 0.628 Test Loss: 1.159 Test Acc: 0.628
Validation loss decreased (-0.594432 --> -0.627766).  Saving model ...
Epoch: 14 cost time: 2.961517095565796
Epoch: 14, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.032 Vali Acc: 0.650 Test Loss: 1.032 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 3.170992374420166
Epoch: 15, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.969 Vali Acc: 0.683 Test Loss: 0.969 Test Acc: 0.683
Validation loss decreased (-0.649990 --> -0.683324).  Saving model ...
Epoch: 16 cost time: 3.3344836235046387
Epoch: 16, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
Validation loss decreased (-0.683324 --> -0.716658).  Saving model ...
Epoch: 17 cost time: 3.262434244155884
Epoch: 17, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 18 cost time: 3.3802385330200195
Epoch: 18, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.757 Vali Acc: 0.778 Test Loss: 0.757 Test Acc: 0.778
Validation loss decreased (-0.716658 --> -0.777770).  Saving model ...
Epoch: 19 cost time: 3.145665168762207
Epoch: 19, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.284554958343506
Epoch: 20, Steps: 12 | Train Loss: 0.492 Vali Loss: 0.668 Vali Acc: 0.778 Test Loss: 0.668 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 21 cost time: 3.3681814670562744
Epoch: 21, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 22 cost time: 3.3460822105407715
Epoch: 22, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 3.433119058609009
Epoch: 23, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.566 Vali Acc: 0.817 Test Loss: 0.566 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 24 cost time: 3.1255078315734863
Epoch: 24, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.592 Vali Acc: 0.828 Test Loss: 0.592 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 25 cost time: 3.1781222820281982
Epoch: 25, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.561 Vali Acc: 0.844 Test Loss: 0.561 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 3.737171173095703
Epoch: 26, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 3.1005749702453613
Epoch: 27, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.124509572982788
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0194900035858154
Epoch: 29, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1723408699035645
Epoch: 30, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.581 Vali Acc: 0.839 Test Loss: 0.581 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1805355548858643
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 3.202853202819824
Epoch: 32, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2652995586395264
Epoch: 33, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.99249529838562
Epoch: 34, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.192599296569824
Epoch: 35, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.578 Vali Acc: 0.839 Test Loss: 0.578 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.2690865993499756
Epoch: 36, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.2936127185821533
Epoch: 37, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.570 Vali Acc: 0.844 Test Loss: 0.570 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.235987424850464
Epoch: 38, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.575 Vali Acc: 0.833 Test Loss: 0.575 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.1487622261047363
Epoch: 39, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.0691306591033936
Epoch: 40, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.3401951789855957
Epoch: 41, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.623 Vali Acc: 0.839 Test Loss: 0.623 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 5.049703121185303
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.663 Vali Acc: 0.111 Test Loss: 2.663 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 3.120184898376465
Epoch: 2, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.484 Vali Acc: 0.183 Test Loss: 2.484 Test Acc: 0.183
Validation loss decreased (-0.111084 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 3.222926378250122
Epoch: 3, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.319 Vali Acc: 0.278 Test Loss: 2.319 Test Acc: 0.278
Validation loss decreased (-0.183308 --> -0.277755).  Saving model ...
Epoch: 4 cost time: 3.27848482131958
Epoch: 4, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.204 Vali Acc: 0.261 Test Loss: 2.204 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9505531787872314
Epoch: 5, Steps: 12 | Train Loss: 2.524 Vali Loss: 2.109 Vali Acc: 0.278 Test Loss: 2.109 Test Acc: 0.278
Validation loss decreased (-0.277755 --> -0.277757).  Saving model ...
Epoch: 6 cost time: 3.172874927520752
Epoch: 6, Steps: 12 | Train Loss: 2.357 Vali Loss: 2.010 Vali Acc: 0.322 Test Loss: 2.010 Test Acc: 0.322
Validation loss decreased (-0.277757 --> -0.322202).  Saving model ...
Epoch: 7 cost time: 3.1973626613616943
Epoch: 7, Steps: 12 | Train Loss: 2.260 Vali Loss: 1.904 Vali Acc: 0.367 Test Loss: 1.904 Test Acc: 0.367
Validation loss decreased (-0.322202 --> -0.366648).  Saving model ...
Epoch: 8 cost time: 3.192153215408325
Epoch: 8, Steps: 12 | Train Loss: 2.132 Vali Loss: 1.801 Vali Acc: 0.406 Test Loss: 1.801 Test Acc: 0.406
Validation loss decreased (-0.366648 --> -0.405538).  Saving model ...
Epoch: 9 cost time: 3.4379940032958984
Epoch: 9, Steps: 12 | Train Loss: 1.986 Vali Loss: 1.714 Vali Acc: 0.406 Test Loss: 1.714 Test Acc: 0.406
Validation loss decreased (-0.405538 --> -0.405538).  Saving model ...
Epoch: 10 cost time: 3.4789955615997314
Epoch: 10, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.591 Vali Acc: 0.472 Test Loss: 1.591 Test Acc: 0.472
Validation loss decreased (-0.405538 --> -0.472206).  Saving model ...
Epoch: 11 cost time: 3.4085142612457275
Epoch: 11, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.430 Vali Acc: 0.589 Test Loss: 1.430 Test Acc: 0.589
Validation loss decreased (-0.472206 --> -0.588875).  Saving model ...
Epoch: 12 cost time: 3.616377592086792
Epoch: 12, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.273 Vali Acc: 0.633 Test Loss: 1.273 Test Acc: 0.633
Validation loss decreased (-0.588875 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 3.3792223930358887
Epoch: 13, Steps: 12 | Train Loss: 1.165 Vali Loss: 1.147 Vali Acc: 0.650 Test Loss: 1.147 Test Acc: 0.650
Validation loss decreased (-0.633321 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 3.1836366653442383
Epoch: 14, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.031 Vali Acc: 0.694 Test Loss: 1.031 Test Acc: 0.694
Validation loss decreased (-0.649989 --> -0.694434).  Saving model ...
Epoch: 15 cost time: 3.2094383239746094
Epoch: 15, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.970 Vali Acc: 0.706 Test Loss: 0.970 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 16 cost time: 3.1618263721466064
Epoch: 16, Steps: 12 | Train Loss: 0.758 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 17 cost time: 3.1819159984588623
Epoch: 17, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.821 Vali Acc: 0.672 Test Loss: 0.821 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.12392520904541
Epoch: 18, Steps: 12 | Train Loss: 0.576 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 3.2828404903411865
Epoch: 19, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.713 Vali Acc: 0.733 Test Loss: 0.713 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8458333015441895
Epoch: 20, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.630 Vali Acc: 0.794 Test Loss: 0.630 Test Acc: 0.794
Validation loss decreased (-0.749993 --> -0.794438).  Saving model ...
Epoch: 21 cost time: 3.111884117126465
Epoch: 21, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 2.813368320465088
Epoch: 22, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.595 Vali Acc: 0.811 Test Loss: 0.595 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 3.320084810256958
Epoch: 23, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822217).  Saving model ...
Epoch: 24 cost time: 3.159745931625366
Epoch: 24, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.578 Vali Acc: 0.817 Test Loss: 0.578 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.2654073238372803
Epoch: 25, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.204052686691284
Epoch: 26, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.822217 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 3.2097384929656982
Epoch: 27, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.980407476425171
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0061774253845215
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.0700056552886963
Epoch: 30, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.558 Vali Acc: 0.839 Test Loss: 0.558 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.0591061115264893
Epoch: 31, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.2619497776031494
Epoch: 32, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 33 cost time: 3.0588793754577637
Epoch: 33, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 3.2654411792755127
Epoch: 34, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.055750608444214
Epoch: 35, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.4244487285614014
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.3513174057006836
Epoch: 37, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.216698169708252
Epoch: 38, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.558 Vali Acc: 0.861 Test Loss: 0.558 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.1937875747680664
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.573 Vali Acc: 0.856 Test Loss: 0.573 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.1797852516174316
Epoch: 40, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.4779090881347656
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.3876969814300537
Epoch: 42, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.7020130157470703
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.598 Vali Acc: 0.872 Test Loss: 0.598 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872216).  Saving model ...
Epoch: 44 cost time: 3.38793683052063
Epoch: 44, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.595 Vali Acc: 0.856 Test Loss: 0.595 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.377256155014038
Epoch: 45, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.540598154067993
Epoch: 46, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.3005614280700684
Epoch: 47, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.631 Vali Acc: 0.861 Test Loss: 0.631 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.3419806957244873
Epoch: 48, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.3368372917175293
Epoch: 49, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.611 Vali Acc: 0.861 Test Loss: 0.611 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.7117691040039062
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.608 Vali Acc: 0.867 Test Loss: 0.608 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.2854161262512207
Epoch: 51, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.616 Vali Acc: 0.856 Test Loss: 0.616 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.392904043197632
Epoch: 52, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.499152421951294
Epoch: 53, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.396022796630859
Epoch: 1, Steps: 12 | Train Loss: 2.800 Vali Loss: 2.693 Vali Acc: 0.078 Test Loss: 2.693 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 2.9226832389831543
Epoch: 2, Steps: 12 | Train Loss: 2.760 Vali Loss: 2.569 Vali Acc: 0.139 Test Loss: 2.569 Test Acc: 0.139
Validation loss decreased (-0.077751 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 2.927753210067749
Epoch: 3, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.415 Vali Acc: 0.267 Test Loss: 2.415 Test Acc: 0.267
Validation loss decreased (-0.138863 --> -0.266643).  Saving model ...
Epoch: 4 cost time: 2.918238401412964
Epoch: 4, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.262 Vali Acc: 0.306 Test Loss: 2.262 Test Acc: 0.306
Validation loss decreased (-0.266643 --> -0.305533).  Saving model ...
Epoch: 5 cost time: 2.8301711082458496
Epoch: 5, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.122 Vali Acc: 0.333 Test Loss: 2.122 Test Acc: 0.333
Validation loss decreased (-0.305533 --> -0.333312).  Saving model ...
Epoch: 6 cost time: 2.746150255203247
Epoch: 6, Steps: 12 | Train Loss: 2.396 Vali Loss: 2.004 Vali Acc: 0.378 Test Loss: 2.004 Test Acc: 0.378
Validation loss decreased (-0.333312 --> -0.377758).  Saving model ...
Epoch: 7 cost time: 2.7375946044921875
Epoch: 7, Steps: 12 | Train Loss: 2.343 Vali Loss: 1.895 Vali Acc: 0.411 Test Loss: 1.895 Test Acc: 0.411
Validation loss decreased (-0.377758 --> -0.411092).  Saving model ...
Epoch: 8 cost time: 2.7628400325775146
Epoch: 8, Steps: 12 | Train Loss: 2.184 Vali Loss: 1.798 Vali Acc: 0.428 Test Loss: 1.798 Test Acc: 0.428
Validation loss decreased (-0.411092 --> -0.427760).  Saving model ...
Epoch: 9 cost time: 2.8136210441589355
Epoch: 9, Steps: 12 | Train Loss: 2.016 Vali Loss: 1.706 Vali Acc: 0.439 Test Loss: 1.706 Test Acc: 0.439
Validation loss decreased (-0.427760 --> -0.438872).  Saving model ...
Epoch: 10 cost time: 2.770385980606079
Epoch: 10, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.606 Vali Acc: 0.489 Test Loss: 1.606 Test Acc: 0.489
Validation loss decreased (-0.438872 --> -0.488873).  Saving model ...
Epoch: 11 cost time: 2.896634817123413
Epoch: 11, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.451 Vali Acc: 0.550 Test Loss: 1.451 Test Acc: 0.550
Validation loss decreased (-0.488873 --> -0.549985).  Saving model ...
Epoch: 12 cost time: 2.8147149085998535
Epoch: 12, Steps: 12 | Train Loss: 1.343 Vali Loss: 1.299 Vali Acc: 0.594 Test Loss: 1.299 Test Acc: 0.594
Validation loss decreased (-0.549985 --> -0.594431).  Saving model ...
Epoch: 13 cost time: 3.141561985015869
Epoch: 13, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.181 Vali Acc: 0.650 Test Loss: 1.181 Test Acc: 0.650
Validation loss decreased (-0.594431 --> -0.649988).  Saving model ...
Epoch: 14 cost time: 3.0266647338867188
Epoch: 14, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.068 Vali Acc: 0.672 Test Loss: 1.068 Test Acc: 0.672
Validation loss decreased (-0.649988 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 3.1002612113952637
Epoch: 15, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.019 Vali Acc: 0.683 Test Loss: 1.019 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683323).  Saving model ...
Epoch: 16 cost time: 3.0026986598968506
Epoch: 16, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711102).  Saving model ...
Epoch: 17 cost time: 3.2023396492004395
Epoch: 17, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.861 Vali Acc: 0.689 Test Loss: 0.861 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.923663854598999
Epoch: 18, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.784 Vali Acc: 0.711 Test Loss: 0.784 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 19 cost time: 3.005375385284424
Epoch: 19, Steps: 12 | Train Loss: 0.500 Vali Loss: 0.750 Vali Acc: 0.728 Test Loss: 0.750 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 20 cost time: 2.9655070304870605
Epoch: 20, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.674 Vali Acc: 0.767 Test Loss: 0.674 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766660).  Saving model ...
Epoch: 21 cost time: 3.1900272369384766
Epoch: 21, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788882).  Saving model ...
Epoch: 22 cost time: 3.0189452171325684
Epoch: 22, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 3.0810141563415527
Epoch: 23, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.567 Vali Acc: 0.833 Test Loss: 0.567 Test Acc: 0.833
Validation loss decreased (-0.799994 --> -0.833328).  Saving model ...
Epoch: 24 cost time: 2.9846689701080322
Epoch: 24, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.588 Vali Acc: 0.822 Test Loss: 0.588 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.93841290473938
Epoch: 25, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 3.3976082801818848
Epoch: 26, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 2.946948528289795
Epoch: 27, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2393429279327393
Epoch: 28, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.1155049800872803
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.071150541305542
Epoch: 30, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.193708658218384
Epoch: 31, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.198122978210449
Epoch: 32, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.0650641918182373
Epoch: 33, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 34 cost time: 2.9718828201293945
Epoch: 34, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.531 Vali Acc: 0.861 Test Loss: 0.531 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 35 cost time: 2.967621326446533
Epoch: 35, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.0628821849823
Epoch: 36, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.899885654449463
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.003532648086548
Epoch: 38, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.905639410018921
Epoch: 39, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.055664300918579
Epoch: 40, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.567 Vali Acc: 0.856 Test Loss: 0.567 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.3094642162323
Epoch: 41, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.2293691635131836
Epoch: 42, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.570 Vali Acc: 0.867 Test Loss: 0.570 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 43 cost time: 3.303955554962158
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.9341838359832764
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.1818482875823975
Epoch: 45, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.573 Vali Acc: 0.839 Test Loss: 0.573 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.2708609104156494
Epoch: 46, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.595 Vali Acc: 0.861 Test Loss: 0.595 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.455960512161255
Epoch: 47, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.351364850997925
Epoch: 48, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.597 Vali Acc: 0.856 Test Loss: 0.597 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.074065685272217
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.111402750015259
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.136798143386841
Epoch: 51, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.616 Vali Acc: 0.861 Test Loss: 0.616 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.7348508834838867
Epoch: 52, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.571126461029053
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.2006232738494873
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1378278732299805
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.090590238571167
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.201676607131958
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2626240253448486
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2011096477508545
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3266079425811768
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.959622383117676
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0204341411590576
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9544522762298584
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.964327812194824
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.95701003074646
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 550543
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.982958555221558
Epoch: 1, Steps: 12 | Train Loss: 2.727 Vali Loss: 2.637 Vali Acc: 0.089 Test Loss: 2.637 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 3.375459909439087
Epoch: 2, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.406 Vali Acc: 0.217 Test Loss: 2.406 Test Acc: 0.217
Validation loss decreased (-0.088863 --> -0.216643).  Saving model ...
Epoch: 3 cost time: 3.5749642848968506
Epoch: 3, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.146 Vali Acc: 0.494 Test Loss: 2.146 Test Acc: 0.494
Validation loss decreased (-0.216643 --> -0.494423).  Saving model ...
Epoch: 4 cost time: 3.5508689880371094
Epoch: 4, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.887 Vali Acc: 0.600 Test Loss: 1.887 Test Acc: 0.600
Validation loss decreased (-0.494423 --> -0.599981).  Saving model ...
Epoch: 5 cost time: 3.2918004989624023
Epoch: 5, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.669 Vali Acc: 0.578 Test Loss: 1.669 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3866260051727295
Epoch: 6, Steps: 12 | Train Loss: 1.562 Vali Loss: 1.480 Vali Acc: 0.644 Test Loss: 1.480 Test Acc: 0.644
Validation loss decreased (-0.599981 --> -0.644430).  Saving model ...
Epoch: 7 cost time: 3.1940813064575195
Epoch: 7, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.302 Vali Acc: 0.661 Test Loss: 1.302 Test Acc: 0.661
Validation loss decreased (-0.644430 --> -0.661098).  Saving model ...
Epoch: 8 cost time: 2.993511915206909
Epoch: 8, Steps: 12 | Train Loss: 1.129 Vali Loss: 1.190 Vali Acc: 0.661 Test Loss: 1.190 Test Acc: 0.661
Validation loss decreased (-0.661098 --> -0.661099).  Saving model ...
Epoch: 9 cost time: 3.043717861175537
Epoch: 9, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.090 Vali Acc: 0.689 Test Loss: 1.090 Test Acc: 0.689
Validation loss decreased (-0.661099 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 2.8853232860565186
Epoch: 10, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.998 Vali Acc: 0.700 Test Loss: 0.998 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 3.068284273147583
Epoch: 11, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.895 Vali Acc: 0.728 Test Loss: 0.895 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 3.3015401363372803
Epoch: 12, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.802 Vali Acc: 0.756 Test Loss: 0.802 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 3.173738718032837
Epoch: 13, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.709 Vali Acc: 0.800 Test Loss: 0.709 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799993).  Saving model ...
Epoch: 14 cost time: 3.0142760276794434
Epoch: 14, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.654 Vali Acc: 0.811 Test Loss: 0.654 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 15 cost time: 3.287585496902466
Epoch: 15, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 16 cost time: 3.536715507507324
Epoch: 16, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2473080158233643
Epoch: 17, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 3.303978443145752
Epoch: 18, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.479 Vali Acc: 0.856 Test Loss: 0.479 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 19 cost time: 3.204641819000244
Epoch: 19, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.452 Vali Acc: 0.861 Test Loss: 0.452 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 20 cost time: 3.4731786251068115
Epoch: 20, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.427 Vali Acc: 0.878 Test Loss: 0.427 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 21 cost time: 3.045971155166626
Epoch: 21, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.414 Vali Acc: 0.872 Test Loss: 0.414 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3534717559814453
Epoch: 22, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.416 Vali Acc: 0.883 Test Loss: 0.416 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883329).  Saving model ...
Epoch: 23 cost time: 3.0458948612213135
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.403 Vali Acc: 0.883 Test Loss: 0.403 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 24 cost time: 3.3077797889709473
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.376 Vali Acc: 0.878 Test Loss: 0.376 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.141451835632324
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.376 Vali Acc: 0.894 Test Loss: 0.376 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894441).  Saving model ...
Epoch: 26 cost time: 3.1704018115997314
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.293321132659912
Epoch: 27, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 3.245964765548706
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 3.3943302631378174
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.374 Vali Acc: 0.906 Test Loss: 0.374 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905552).  Saving model ...
Epoch: 30 cost time: 3.350922107696533
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.393 Vali Acc: 0.906 Test Loss: 0.393 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.099456310272217
Epoch: 31, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.2376387119293213
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5195250511169434
Epoch: 33, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.168762683868408
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.230454206466675
Epoch: 35, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.384 Vali Acc: 0.906 Test Loss: 0.384 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.134097099304199
Epoch: 36, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.269089460372925
Epoch: 37, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.905700922012329
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.230523109436035
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911107).  Saving model ...
Epoch: 40 cost time: 2.9944400787353516
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.400 Vali Acc: 0.911 Test Loss: 0.400 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 41 cost time: 3.0073633193969727
Epoch: 41, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.198463201522827
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 43 cost time: 3.2417995929718018
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.2845406532287598
Epoch: 44, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.390 Vali Acc: 0.906 Test Loss: 0.390 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.1973743438720703
Epoch: 45, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.389 Vali Acc: 0.917 Test Loss: 0.389 Test Acc: 0.917
Validation loss decreased (-0.911107 --> -0.916663).  Saving model ...
Epoch: 46 cost time: 3.505535840988159
Epoch: 46, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.3423538208007812
Epoch: 47, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.432 Vali Acc: 0.906 Test Loss: 0.432 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.365719795227051
Epoch: 48, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.317605972290039
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.428 Vali Acc: 0.906 Test Loss: 0.428 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.0409774780273438
Epoch: 50, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.0024189949035645
Epoch: 51, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.910149574279785
Epoch: 52, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.417 Vali Acc: 0.911 Test Loss: 0.417 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.073878049850464
Epoch: 53, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.431 Vali Acc: 0.911 Test Loss: 0.431 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.0209031105041504
Epoch: 54, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.429 Vali Acc: 0.906 Test Loss: 0.429 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.978438138961792
Epoch: 55, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.436 Vali Acc: 0.906 Test Loss: 0.436 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.601456165313721
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.652 Vali Acc: 0.111 Test Loss: 2.652 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 3.0981392860412598
Epoch: 2, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.465 Vali Acc: 0.244 Test Loss: 2.465 Test Acc: 0.244
Validation loss decreased (-0.111085 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 3.0904629230499268
Epoch: 3, Steps: 12 | Train Loss: 2.425 Vali Loss: 2.251 Vali Acc: 0.461 Test Loss: 2.251 Test Acc: 0.461
Validation loss decreased (-0.244420 --> -0.461089).  Saving model ...
Epoch: 4 cost time: 3.31886625289917
Epoch: 4, Steps: 12 | Train Loss: 2.156 Vali Loss: 2.033 Vali Acc: 0.583 Test Loss: 2.033 Test Acc: 0.583
Validation loss decreased (-0.461089 --> -0.583313).  Saving model ...
Epoch: 5 cost time: 3.40332293510437
Epoch: 5, Steps: 12 | Train Loss: 1.958 Vali Loss: 1.834 Vali Acc: 0.572 Test Loss: 1.834 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5149667263031006
Epoch: 6, Steps: 12 | Train Loss: 1.781 Vali Loss: 1.648 Vali Acc: 0.600 Test Loss: 1.648 Test Acc: 0.600
Validation loss decreased (-0.583313 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 3.2380974292755127
Epoch: 7, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.465 Vali Acc: 0.633 Test Loss: 1.465 Test Acc: 0.633
Validation loss decreased (-0.599984 --> -0.633319).  Saving model ...
Epoch: 8 cost time: 2.9220080375671387
Epoch: 8, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.343 Vali Acc: 0.633 Test Loss: 1.343 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633320).  Saving model ...
Epoch: 9 cost time: 2.8832530975341797
Epoch: 9, Steps: 12 | Train Loss: 1.207 Vali Loss: 1.225 Vali Acc: 0.661 Test Loss: 1.225 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661099).  Saving model ...
Epoch: 10 cost time: 3.2232794761657715
Epoch: 10, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.108 Vali Acc: 0.706 Test Loss: 1.108 Test Acc: 0.706
Validation loss decreased (-0.661099 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 3.2108609676361084
Epoch: 11, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.984 Vali Acc: 0.728 Test Loss: 0.984 Test Acc: 0.728
Validation loss decreased (-0.705544 --> -0.727768).  Saving model ...
Epoch: 12 cost time: 2.7879741191864014
Epoch: 12, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.898 Vali Acc: 0.728 Test Loss: 0.898 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 13 cost time: 2.989558458328247
Epoch: 13, Steps: 12 | Train Loss: 0.680 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.727769 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 3.117387533187866
Epoch: 14, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.729 Vali Acc: 0.789 Test Loss: 0.729 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.376206159591675
Epoch: 15, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 3.294527530670166
Epoch: 16, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 17 cost time: 3.1007511615753174
Epoch: 17, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.615 Vali Acc: 0.861 Test Loss: 0.615 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861105).  Saving model ...
Epoch: 18 cost time: 3.3072965145111084
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.553 Vali Acc: 0.872 Test Loss: 0.553 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872217).  Saving model ...
Epoch: 19 cost time: 3.1507484912872314
Epoch: 19, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.541 Vali Acc: 0.878 Test Loss: 0.541 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 20 cost time: 2.897697687149048
Epoch: 20, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.527 Vali Acc: 0.878 Test Loss: 0.527 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 2.9950551986694336
Epoch: 21, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.500 Vali Acc: 0.872 Test Loss: 0.500 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.046565532684326
Epoch: 22, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 23 cost time: 2.8087871074676514
Epoch: 23, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 24 cost time: 2.8818769454956055
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1043484210968018
Epoch: 25, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.496 Vali Acc: 0.883 Test Loss: 0.496 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.903130292892456
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.472 Vali Acc: 0.883 Test Loss: 0.472 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.997772693634033
Epoch: 27, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.258615016937256
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.480 Vali Acc: 0.894 Test Loss: 0.480 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 3.143946886062622
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.9199628829956055
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.1600120067596436
Epoch: 31, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.488 Vali Acc: 0.883 Test Loss: 0.488 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.038940668106079
Epoch: 32, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.1186790466308594
Epoch: 33, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.462381362915039
Epoch: 34, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.507 Vali Acc: 0.889 Test Loss: 0.507 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.0542032718658447
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.489 Vali Acc: 0.894 Test Loss: 0.489 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.8548781871795654
Epoch: 36, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.0088465213775635
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.516 Vali Acc: 0.889 Test Loss: 0.516 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.084991693496704
Epoch: 38, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 39 cost time: 2.982057571411133
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.524 Vali Acc: 0.883 Test Loss: 0.524 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.1492691040039062
Epoch: 40, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.8540215492248535
Epoch: 41, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.602999210357666
Epoch: 42, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.289929151535034
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.501744270324707
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.357595205307007
Epoch: 45, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.526 Vali Acc: 0.894 Test Loss: 0.526 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.2484138011932373
Epoch: 46, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.515 Vali Acc: 0.894 Test Loss: 0.515 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.2080888748168945
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.529 Vali Acc: 0.883 Test Loss: 0.529 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.113816261291504
Epoch: 48, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.415100812911987
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.686 Vali Acc: 0.094 Test Loss: 2.686 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 2.9873931407928467
Epoch: 2, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.537 Vali Acc: 0.144 Test Loss: 2.537 Test Acc: 0.144
Validation loss decreased (-0.094418 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 3.377498149871826
Epoch: 3, Steps: 12 | Train Loss: 2.531 Vali Loss: 2.366 Vali Acc: 0.311 Test Loss: 2.366 Test Acc: 0.311
Validation loss decreased (-0.144419 --> -0.311087).  Saving model ...
Epoch: 4 cost time: 2.9790568351745605
Epoch: 4, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.190 Vali Acc: 0.411 Test Loss: 2.190 Test Acc: 0.411
Validation loss decreased (-0.311087 --> -0.411089).  Saving model ...
Epoch: 5 cost time: 3.2626607418060303
Epoch: 5, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.021 Vali Acc: 0.556 Test Loss: 2.021 Test Acc: 0.556
Validation loss decreased (-0.411089 --> -0.555535).  Saving model ...
Epoch: 6 cost time: 3.0541319847106934
Epoch: 6, Steps: 12 | Train Loss: 1.962 Vali Loss: 1.862 Vali Acc: 0.567 Test Loss: 1.862 Test Acc: 0.567
Validation loss decreased (-0.555535 --> -0.566648).  Saving model ...
Epoch: 7 cost time: 3.144368886947632
Epoch: 7, Steps: 12 | Train Loss: 1.783 Vali Loss: 1.702 Vali Acc: 0.611 Test Loss: 1.702 Test Acc: 0.611
Validation loss decreased (-0.566648 --> -0.611094).  Saving model ...
Epoch: 8 cost time: 3.0151984691619873
Epoch: 8, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.579 Vali Acc: 0.611 Test Loss: 1.579 Test Acc: 0.611
Validation loss decreased (-0.611094 --> -0.611095).  Saving model ...
Epoch: 9 cost time: 2.943829298019409
Epoch: 9, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.459 Vali Acc: 0.628 Test Loss: 1.459 Test Acc: 0.628
Validation loss decreased (-0.611095 --> -0.627763).  Saving model ...
Epoch: 10 cost time: 2.953552722930908
Epoch: 10, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.332 Vali Acc: 0.678 Test Loss: 1.332 Test Acc: 0.678
Validation loss decreased (-0.627763 --> -0.677764).  Saving model ...
Epoch: 11 cost time: 3.3063206672668457
Epoch: 11, Steps: 12 | Train Loss: 1.170 Vali Loss: 1.198 Vali Acc: 0.678 Test Loss: 1.198 Test Acc: 0.678
Validation loss decreased (-0.677764 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 3.278475522994995
Epoch: 12, Steps: 12 | Train Loss: 1.006 Vali Loss: 1.107 Vali Acc: 0.683 Test Loss: 1.107 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 13 cost time: 3.292603015899658
Epoch: 13, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.969 Vali Acc: 0.728 Test Loss: 0.969 Test Acc: 0.728
Validation loss decreased (-0.683322 --> -0.727768).  Saving model ...
Epoch: 14 cost time: 3.279144525527954
Epoch: 14, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.909 Vali Acc: 0.733 Test Loss: 0.909 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733324).  Saving model ...
Epoch: 15 cost time: 3.1284737586975098
Epoch: 15, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.794 Vali Acc: 0.789 Test Loss: 0.794 Test Acc: 0.789
Validation loss decreased (-0.733324 --> -0.788881).  Saving model ...
Epoch: 16 cost time: 3.228909492492676
Epoch: 16, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.121034860610962
Epoch: 17, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2041068077087402
Epoch: 18, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
Validation loss decreased (-0.788881 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 2.980104684829712
Epoch: 19, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.971207857131958
Epoch: 20, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
Validation loss decreased (-0.827771 --> -0.838883).  Saving model ...
Epoch: 21 cost time: 2.9591920375823975
Epoch: 21, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 22 cost time: 2.966888666152954
Epoch: 22, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 3.0096969604492188
Epoch: 23, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 3.079512119293213
Epoch: 24, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1345365047454834
Epoch: 25, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.201995849609375
Epoch: 26, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 27 cost time: 3.2223916053771973
Epoch: 27, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.548 Vali Acc: 0.844 Test Loss: 0.548 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.2696821689605713
Epoch: 28, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0545601844787598
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 3.2813985347747803
Epoch: 30, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.502 Vali Acc: 0.861 Test Loss: 0.502 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4599714279174805
Epoch: 31, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.474 Vali Acc: 0.883 Test Loss: 0.474 Test Acc: 0.883
Validation loss decreased (-0.861106 --> -0.883329).  Saving model ...
Epoch: 32 cost time: 3.2146201133728027
Epoch: 32, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.485 Vali Acc: 0.883 Test Loss: 0.485 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.004878282546997
Epoch: 33, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.506 Vali Acc: 0.867 Test Loss: 0.506 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.0685651302337646
Epoch: 34, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.311194896697998
Epoch: 35, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.486 Vali Acc: 0.878 Test Loss: 0.486 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.8614585399627686
Epoch: 36, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.496 Vali Acc: 0.867 Test Loss: 0.496 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.0006260871887207
Epoch: 37, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.178931474685669
Epoch: 38, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.536 Vali Acc: 0.867 Test Loss: 0.536 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.048203468322754
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.2657506465911865
Epoch: 40, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.3385887145996094
Epoch: 41, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.537 Vali Acc: 0.872 Test Loss: 0.537 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.573868036270142
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.640 Vali Acc: 0.072 Test Loss: 2.640 Test Acc: 0.072
Validation loss decreased (inf --> -0.072196).  Saving model ...
Epoch: 2 cost time: 3.225524663925171
Epoch: 2, Steps: 12 | Train Loss: 2.660 Vali Loss: 2.542 Vali Acc: 0.078 Test Loss: 2.542 Test Acc: 0.078
Validation loss decreased (-0.072196 --> -0.077752).  Saving model ...
Epoch: 3 cost time: 2.9611704349517822
Epoch: 3, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.436 Vali Acc: 0.183 Test Loss: 2.436 Test Acc: 0.183
Validation loss decreased (-0.077752 --> -0.183309).  Saving model ...
Epoch: 4 cost time: 3.090634346008301
Epoch: 4, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.320 Vali Acc: 0.261 Test Loss: 2.320 Test Acc: 0.261
Validation loss decreased (-0.183309 --> -0.261088).  Saving model ...
Epoch: 5 cost time: 2.980550765991211
Epoch: 5, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.198 Vali Acc: 0.300 Test Loss: 2.198 Test Acc: 0.300
Validation loss decreased (-0.261088 --> -0.299978).  Saving model ...
Epoch: 6 cost time: 3.101288080215454
Epoch: 6, Steps: 12 | Train Loss: 2.170 Vali Loss: 2.071 Vali Acc: 0.344 Test Loss: 2.071 Test Acc: 0.344
Validation loss decreased (-0.299978 --> -0.344424).  Saving model ...
Epoch: 7 cost time: 3.2372090816497803
Epoch: 7, Steps: 12 | Train Loss: 2.024 Vali Loss: 1.942 Vali Acc: 0.389 Test Loss: 1.942 Test Acc: 0.389
Validation loss decreased (-0.344424 --> -0.388869).  Saving model ...
Epoch: 8 cost time: 2.8288450241088867
Epoch: 8, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.819 Vali Acc: 0.406 Test Loss: 1.819 Test Acc: 0.406
Validation loss decreased (-0.388869 --> -0.405537).  Saving model ...
Epoch: 9 cost time: 3.1054983139038086
Epoch: 9, Steps: 12 | Train Loss: 1.789 Vali Loss: 1.685 Vali Acc: 0.494 Test Loss: 1.685 Test Acc: 0.494
Validation loss decreased (-0.405537 --> -0.494428).  Saving model ...
Epoch: 10 cost time: 3.0753118991851807
Epoch: 10, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.521 Vali Acc: 0.511 Test Loss: 1.521 Test Acc: 0.511
Validation loss decreased (-0.494428 --> -0.511096).  Saving model ...
Epoch: 11 cost time: 3.039365768432617
Epoch: 11, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.333 Vali Acc: 0.617 Test Loss: 1.333 Test Acc: 0.617
Validation loss decreased (-0.511096 --> -0.616653).  Saving model ...
Epoch: 12 cost time: 3.3564212322235107
Epoch: 12, Steps: 12 | Train Loss: 1.235 Vali Loss: 1.193 Vali Acc: 0.694 Test Loss: 1.193 Test Acc: 0.694
Validation loss decreased (-0.616653 --> -0.694433).  Saving model ...
Epoch: 13 cost time: 3.222803831100464
Epoch: 13, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.081 Vali Acc: 0.628 Test Loss: 1.081 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.592864990234375
Epoch: 14, Steps: 12 | Train Loss: 0.932 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716657).  Saving model ...
Epoch: 15 cost time: 3.1732866764068604
Epoch: 15, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.716657 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 3.8086326122283936
Epoch: 16, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.835 Vali Acc: 0.778 Test Loss: 0.835 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 2.985347270965576
Epoch: 17, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4227519035339355
Epoch: 18, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.718 Vali Acc: 0.772 Test Loss: 0.718 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.547663688659668
Epoch: 19, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.706 Vali Acc: 0.806 Test Loss: 0.706 Test Acc: 0.806
Validation loss decreased (-0.777769 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 3.2315495014190674
Epoch: 20, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 21 cost time: 3.011230230331421
Epoch: 21, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.577 Vali Acc: 0.828 Test Loss: 0.577 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 3.2870264053344727
Epoch: 22, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 23 cost time: 3.1148834228515625
Epoch: 23, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.355534076690674
Epoch: 24, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.528 Vali Acc: 0.844 Test Loss: 0.528 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 3.05047345161438
Epoch: 25, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.537 Vali Acc: 0.856 Test Loss: 0.537 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 3.1546757221221924
Epoch: 26, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.254148483276367
Epoch: 27, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.563 Vali Acc: 0.861 Test Loss: 0.563 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 28 cost time: 3.200047254562378
Epoch: 28, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.569058895111084
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.509 Vali Acc: 0.861 Test Loss: 0.509 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 3.2419707775115967
Epoch: 30, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1879658699035645
Epoch: 31, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.497 Vali Acc: 0.867 Test Loss: 0.497 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 32 cost time: 2.985429286956787
Epoch: 32, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.502 Vali Acc: 0.867 Test Loss: 0.502 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.9441373348236084
Epoch: 33, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
Validation loss decreased (-0.866662 --> -0.883328).  Saving model ...
Epoch: 34 cost time: 3.2298672199249268
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.878 Test Loss: 0.509 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1371476650238037
Epoch: 35, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0632340908050537
Epoch: 36, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.525 Vali Acc: 0.872 Test Loss: 0.525 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.240269184112549
Epoch: 37, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.535 Vali Acc: 0.883 Test Loss: 0.535 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.0188117027282715
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.178396224975586
Epoch: 39, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.552 Vali Acc: 0.872 Test Loss: 0.552 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.266272783279419
Epoch: 40, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.1736650466918945
Epoch: 41, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.563 Vali Acc: 0.883 Test Loss: 0.563 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.049024820327759
Epoch: 42, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.1312739849090576
Epoch: 43, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.545 Vali Acc: 0.878 Test Loss: 0.545 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.094104051589966
Epoch: 1, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.731 Vali Acc: 0.061 Test Loss: 2.731 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 2.772749423980713
Epoch: 2, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.625 Vali Acc: 0.078 Test Loss: 2.625 Test Acc: 0.078
Validation loss decreased (-0.061084 --> -0.077752).  Saving model ...
Epoch: 3 cost time: 2.713961601257324
Epoch: 3, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.499 Vali Acc: 0.150 Test Loss: 2.499 Test Acc: 0.150
Validation loss decreased (-0.077752 --> -0.149975).  Saving model ...
Epoch: 4 cost time: 2.817286729812622
Epoch: 4, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.360 Vali Acc: 0.233 Test Loss: 2.360 Test Acc: 0.233
Validation loss decreased (-0.149975 --> -0.233310).  Saving model ...
Epoch: 5 cost time: 2.8193371295928955
Epoch: 5, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.214 Vali Acc: 0.333 Test Loss: 2.214 Test Acc: 0.333
Validation loss decreased (-0.233310 --> -0.333311).  Saving model ...
Epoch: 6 cost time: 3.105895757675171
Epoch: 6, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.080 Vali Acc: 0.339 Test Loss: 2.080 Test Acc: 0.339
Validation loss decreased (-0.333311 --> -0.338868).  Saving model ...
Epoch: 7 cost time: 3.0751583576202393
Epoch: 7, Steps: 12 | Train Loss: 2.174 Vali Loss: 1.968 Vali Acc: 0.356 Test Loss: 1.968 Test Acc: 0.356
Validation loss decreased (-0.338868 --> -0.355536).  Saving model ...
Epoch: 8 cost time: 2.8483364582061768
Epoch: 8, Steps: 12 | Train Loss: 2.049 Vali Loss: 1.856 Vali Acc: 0.389 Test Loss: 1.856 Test Acc: 0.389
Validation loss decreased (-0.355536 --> -0.388870).  Saving model ...
Epoch: 9 cost time: 2.868303060531616
Epoch: 9, Steps: 12 | Train Loss: 1.916 Vali Loss: 1.793 Vali Acc: 0.411 Test Loss: 1.793 Test Acc: 0.411
Validation loss decreased (-0.388870 --> -0.411093).  Saving model ...
Epoch: 10 cost time: 2.956225633621216
Epoch: 10, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.649 Vali Acc: 0.489 Test Loss: 1.649 Test Acc: 0.489
Validation loss decreased (-0.411093 --> -0.488872).  Saving model ...
Epoch: 11 cost time: 2.9243786334991455
Epoch: 11, Steps: 12 | Train Loss: 1.585 Vali Loss: 1.503 Vali Acc: 0.500 Test Loss: 1.503 Test Acc: 0.500
Validation loss decreased (-0.488872 --> -0.499985).  Saving model ...
Epoch: 12 cost time: 3.067899227142334
Epoch: 12, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.362 Vali Acc: 0.572 Test Loss: 1.362 Test Acc: 0.572
Validation loss decreased (-0.499985 --> -0.572209).  Saving model ...
Epoch: 13 cost time: 2.8684048652648926
Epoch: 13, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.254 Vali Acc: 0.578 Test Loss: 1.254 Test Acc: 0.578
Validation loss decreased (-0.572209 --> -0.577765).  Saving model ...
Epoch: 14 cost time: 2.760984420776367
Epoch: 14, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.104 Vali Acc: 0.656 Test Loss: 1.104 Test Acc: 0.656
Validation loss decreased (-0.577765 --> -0.655545).  Saving model ...
Epoch: 15 cost time: 2.8957273960113525
Epoch: 15, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.017 Vali Acc: 0.656 Test Loss: 1.017 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 16 cost time: 2.799468994140625
Epoch: 16, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.940 Vali Acc: 0.689 Test Loss: 0.940 Test Acc: 0.689
Validation loss decreased (-0.655545 --> -0.688879).  Saving model ...
Epoch: 17 cost time: 2.9940483570098877
Epoch: 17, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.899 Vali Acc: 0.706 Test Loss: 0.899 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705547).  Saving model ...
Epoch: 18 cost time: 2.993835926055908
Epoch: 18, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.848 Vali Acc: 0.694 Test Loss: 0.848 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2605719566345215
Epoch: 19, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722214).  Saving model ...
Epoch: 20 cost time: 3.3807857036590576
Epoch: 20, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 3.409991502761841
Epoch: 21, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.699 Vali Acc: 0.744 Test Loss: 0.699 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3452043533325195
Epoch: 22, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.662 Vali Acc: 0.811 Test Loss: 0.662 Test Acc: 0.811
Validation loss decreased (-0.749993 --> -0.811104).  Saving model ...
Epoch: 23 cost time: 3.2027199268341064
Epoch: 23, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1874022483825684
Epoch: 24, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.630 Vali Acc: 0.817 Test Loss: 0.630 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 3.2713463306427
Epoch: 25, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.625 Vali Acc: 0.844 Test Loss: 0.625 Test Acc: 0.844
Validation loss decreased (-0.816660 --> -0.844438).  Saving model ...
Epoch: 26 cost time: 3.024364471435547
Epoch: 26, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.601 Vali Acc: 0.822 Test Loss: 0.601 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.064237117767334
Epoch: 27, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.654 Vali Acc: 0.817 Test Loss: 0.654 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.857705593109131
Epoch: 28, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.619 Vali Acc: 0.828 Test Loss: 0.619 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.9404296875
Epoch: 29, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.612 Vali Acc: 0.839 Test Loss: 0.612 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.890808582305908
Epoch: 30, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8525071144104004
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.614 Vali Acc: 0.822 Test Loss: 0.614 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.9888248443603516
Epoch: 32, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.612 Vali Acc: 0.817 Test Loss: 0.612 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.959550142288208
Epoch: 33, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.144343852996826
Epoch: 34, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.213770627975464
Epoch: 35, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.614 Vali Acc: 0.817 Test Loss: 0.614 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.583547115325928
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.665 Vali Acc: 0.100 Test Loss: 2.665 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 3.293958902359009
Epoch: 2, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.487 Vali Acc: 0.211 Test Loss: 2.487 Test Acc: 0.211
Validation loss decreased (-0.099973 --> -0.211086).  Saving model ...
Epoch: 3 cost time: 3.006713628768921
Epoch: 3, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.321 Vali Acc: 0.333 Test Loss: 2.321 Test Acc: 0.333
Validation loss decreased (-0.211086 --> -0.333310).  Saving model ...
Epoch: 4 cost time: 3.0341320037841797
Epoch: 4, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.197 Vali Acc: 0.344 Test Loss: 2.197 Test Acc: 0.344
Validation loss decreased (-0.333310 --> -0.344422).  Saving model ...
Epoch: 5 cost time: 3.403076171875
Epoch: 5, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.102 Vali Acc: 0.328 Test Loss: 2.102 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.287388801574707
Epoch: 6, Steps: 12 | Train Loss: 2.408 Vali Loss: 2.009 Vali Acc: 0.361 Test Loss: 2.009 Test Acc: 0.361
Validation loss decreased (-0.344422 --> -0.361091).  Saving model ...
Epoch: 7 cost time: 2.960148334503174
Epoch: 7, Steps: 12 | Train Loss: 2.274 Vali Loss: 1.907 Vali Acc: 0.389 Test Loss: 1.907 Test Acc: 0.389
Validation loss decreased (-0.361091 --> -0.388870).  Saving model ...
Epoch: 8 cost time: 2.925379753112793
Epoch: 8, Steps: 12 | Train Loss: 2.124 Vali Loss: 1.812 Vali Acc: 0.378 Test Loss: 1.812 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0464847087860107
Epoch: 9, Steps: 12 | Train Loss: 1.967 Vali Loss: 1.725 Vali Acc: 0.394 Test Loss: 1.725 Test Acc: 0.394
Validation loss decreased (-0.388870 --> -0.394427).  Saving model ...
Epoch: 10 cost time: 3.3133537769317627
Epoch: 10, Steps: 12 | Train Loss: 1.759 Vali Loss: 1.571 Vali Acc: 0.511 Test Loss: 1.571 Test Acc: 0.511
Validation loss decreased (-0.394427 --> -0.511095).  Saving model ...
Epoch: 11 cost time: 3.1773312091827393
Epoch: 11, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.415 Vali Acc: 0.572 Test Loss: 1.415 Test Acc: 0.572
Validation loss decreased (-0.511095 --> -0.572208).  Saving model ...
Epoch: 12 cost time: 3.253138303756714
Epoch: 12, Steps: 12 | Train Loss: 1.293 Vali Loss: 1.268 Vali Acc: 0.589 Test Loss: 1.268 Test Acc: 0.589
Validation loss decreased (-0.572208 --> -0.588876).  Saving model ...
Epoch: 13 cost time: 3.094724178314209
Epoch: 13, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.179 Vali Acc: 0.617 Test Loss: 1.179 Test Acc: 0.617
Validation loss decreased (-0.588876 --> -0.616655).  Saving model ...
Epoch: 14 cost time: 3.6232213973999023
Epoch: 14, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.075 Vali Acc: 0.661 Test Loss: 1.075 Test Acc: 0.661
Validation loss decreased (-0.616655 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 3.391064167022705
Epoch: 15, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.005 Vali Acc: 0.667 Test Loss: 1.005 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 3.4493305683135986
Epoch: 16, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.932 Vali Acc: 0.694 Test Loss: 0.932 Test Acc: 0.694
Validation loss decreased (-0.666657 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 2.927345037460327
Epoch: 17, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.884 Vali Acc: 0.711 Test Loss: 0.884 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 18 cost time: 3.1331307888031006
Epoch: 18, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 19 cost time: 3.1160504817962646
Epoch: 19, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.797 Vali Acc: 0.728 Test Loss: 0.797 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 20 cost time: 3.016019582748413
Epoch: 20, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 21 cost time: 3.007272481918335
Epoch: 21, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.705 Vali Acc: 0.783 Test Loss: 0.705 Test Acc: 0.783
Validation loss decreased (-0.727770 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 3.0070488452911377
Epoch: 22, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 3.2131307125091553
Epoch: 23, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.677 Vali Acc: 0.794 Test Loss: 0.677 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2812283039093018
Epoch: 24, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.646 Vali Acc: 0.817 Test Loss: 0.646 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 25 cost time: 3.4242653846740723
Epoch: 25, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 26 cost time: 3.1302270889282227
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.624 Vali Acc: 0.822 Test Loss: 0.624 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 3.3990132808685303
Epoch: 27, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.660 Vali Acc: 0.828 Test Loss: 0.660 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 28 cost time: 3.134425640106201
Epoch: 28, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.631 Vali Acc: 0.828 Test Loss: 0.631 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 29 cost time: 2.9544365406036377
Epoch: 29, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.624 Vali Acc: 0.828 Test Loss: 0.624 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 30 cost time: 3.0086209774017334
Epoch: 30, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.629 Vali Acc: 0.833 Test Loss: 0.629 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 2.970637321472168
Epoch: 31, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.592 Vali Acc: 0.811 Test Loss: 0.592 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9147706031799316
Epoch: 32, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.587 Vali Acc: 0.839 Test Loss: 0.587 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 3.028998374938965
Epoch: 33, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8684840202331543
Epoch: 34, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 35 cost time: 2.961216449737549
Epoch: 35, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.625 Vali Acc: 0.817 Test Loss: 0.625 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.940582036972046
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.636 Vali Acc: 0.822 Test Loss: 0.636 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.1344704627990723
Epoch: 37, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.3382749557495117
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.5179224014282227
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.652 Vali Acc: 0.822 Test Loss: 0.652 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.585381507873535
Epoch: 40, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.277096748352051
Epoch: 41, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.283510684967041
Epoch: 42, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.636 Vali Acc: 0.828 Test Loss: 0.636 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.1005420684814453
Epoch: 43, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.081857919692993
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.623 Vali Acc: 0.856 Test Loss: 0.623 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 45 cost time: 3.07621693611145
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.0056161880493164
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.639 Vali Acc: 0.856 Test Loss: 0.639 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.023932456970215
Epoch: 47, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.638 Vali Acc: 0.861 Test Loss: 0.638 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 48 cost time: 3.0929648876190186
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.101682424545288
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.649 Vali Acc: 0.856 Test Loss: 0.649 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2518434524536133
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.645 Vali Acc: 0.861 Test Loss: 0.645 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.1776225566864014
Epoch: 51, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.643 Vali Acc: 0.856 Test Loss: 0.643 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.5572385787963867
Epoch: 52, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.135690450668335
Epoch: 53, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.673 Vali Acc: 0.856 Test Loss: 0.673 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.114349365234375
Epoch: 54, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.1731762886047363
Epoch: 55, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.1645588874816895
Epoch: 56, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.0611438751220703
Epoch: 57, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.174394369125366
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.708 Vali Acc: 0.094 Test Loss: 2.708 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 3.2021636962890625
Epoch: 2, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.587 Vali Acc: 0.194 Test Loss: 2.587 Test Acc: 0.194
Validation loss decreased (-0.094417 --> -0.194419).  Saving model ...
Epoch: 3 cost time: 2.8522634506225586
Epoch: 3, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.431 Vali Acc: 0.278 Test Loss: 2.431 Test Acc: 0.278
Validation loss decreased (-0.194419 --> -0.277753).  Saving model ...
Epoch: 4 cost time: 3.2108325958251953
Epoch: 4, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.261 Vali Acc: 0.339 Test Loss: 2.261 Test Acc: 0.339
Validation loss decreased (-0.277753 --> -0.338866).  Saving model ...
Epoch: 5 cost time: 2.985241174697876
Epoch: 5, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.108 Vali Acc: 0.433 Test Loss: 2.108 Test Acc: 0.433
Validation loss decreased (-0.338866 --> -0.433312).  Saving model ...
Epoch: 6 cost time: 3.0874500274658203
Epoch: 6, Steps: 12 | Train Loss: 2.467 Vali Loss: 1.992 Vali Acc: 0.444 Test Loss: 1.992 Test Acc: 0.444
Validation loss decreased (-0.433312 --> -0.444425).  Saving model ...
Epoch: 7 cost time: 2.798460006713867
Epoch: 7, Steps: 12 | Train Loss: 2.278 Vali Loss: 1.883 Vali Acc: 0.472 Test Loss: 1.883 Test Acc: 0.472
Validation loss decreased (-0.444425 --> -0.472203).  Saving model ...
Epoch: 8 cost time: 3.105145215988159
Epoch: 8, Steps: 12 | Train Loss: 2.175 Vali Loss: 1.782 Vali Acc: 0.472 Test Loss: 1.782 Test Acc: 0.472
Validation loss decreased (-0.472203 --> -0.472204).  Saving model ...
Epoch: 9 cost time: 3.175032138824463
Epoch: 9, Steps: 12 | Train Loss: 2.022 Vali Loss: 1.698 Vali Acc: 0.450 Test Loss: 1.698 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1962335109710693
Epoch: 10, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
Validation loss decreased (-0.472204 --> -0.488873).  Saving model ...
Epoch: 11 cost time: 2.9650211334228516
Epoch: 11, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.425 Vali Acc: 0.556 Test Loss: 1.425 Test Acc: 0.556
Validation loss decreased (-0.488873 --> -0.555541).  Saving model ...
Epoch: 12 cost time: 2.8339247703552246
Epoch: 12, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.292 Vali Acc: 0.617 Test Loss: 1.292 Test Acc: 0.617
Validation loss decreased (-0.555541 --> -0.616654).  Saving model ...
Epoch: 13 cost time: 2.808884620666504
Epoch: 13, Steps: 12 | Train Loss: 1.232 Vali Loss: 1.205 Vali Acc: 0.639 Test Loss: 1.205 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 14 cost time: 2.9566941261291504
Epoch: 14, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.094 Vali Acc: 0.683 Test Loss: 1.094 Test Acc: 0.683
Validation loss decreased (-0.638877 --> -0.683322).  Saving model ...
Epoch: 15 cost time: 2.868114471435547
Epoch: 15, Steps: 12 | Train Loss: 0.911 Vali Loss: 1.008 Vali Acc: 0.656 Test Loss: 1.008 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.008798360824585
Epoch: 16, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 2.9360363483428955
Epoch: 17, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.860 Vali Acc: 0.711 Test Loss: 0.860 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711103).  Saving model ...
Epoch: 18 cost time: 3.2738523483276367
Epoch: 18, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.812 Vali Acc: 0.706 Test Loss: 0.812 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2237489223480225
Epoch: 19, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 3.031967878341675
Epoch: 20, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.713 Vali Acc: 0.733 Test Loss: 0.713 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1541686058044434
Epoch: 21, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
Validation loss decreased (-0.749992 --> -0.788882).  Saving model ...
Epoch: 22 cost time: 3.2057578563690186
Epoch: 22, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 3.0929014682769775
Epoch: 23, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 3.3937015533447266
Epoch: 24, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.606 Vali Acc: 0.817 Test Loss: 0.606 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816661).  Saving model ...
Epoch: 25 cost time: 3.1934046745300293
Epoch: 25, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 26 cost time: 3.194465398788452
Epoch: 26, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.600 Vali Acc: 0.822 Test Loss: 0.600 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.216050863265991
Epoch: 27, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.637 Vali Acc: 0.828 Test Loss: 0.637 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1552507877349854
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.608 Vali Acc: 0.817 Test Loss: 0.608 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1657371520996094
Epoch: 29, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.601 Vali Acc: 0.839 Test Loss: 0.601 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 30 cost time: 2.979778528213501
Epoch: 30, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.618 Vali Acc: 0.828 Test Loss: 0.618 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.9762461185455322
Epoch: 31, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.3516340255737305
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.2931127548217773
Epoch: 33, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.596 Vali Acc: 0.839 Test Loss: 0.596 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 34 cost time: 3.4606854915618896
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 35 cost time: 3.2568390369415283
Epoch: 35, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.609 Vali Acc: 0.817 Test Loss: 0.609 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.4679555892944336
Epoch: 36, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.618 Vali Acc: 0.839 Test Loss: 0.618 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.405668258666992
Epoch: 37, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.3339900970458984
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.598 Vali Acc: 0.839 Test Loss: 0.598 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.1729347705841064
Epoch: 39, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855549).  Saving model ...
Epoch: 40 cost time: 2.963848829269409
Epoch: 40, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.996656656265259
Epoch: 41, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.652 Vali Acc: 0.861 Test Loss: 0.652 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 42 cost time: 3.003673791885376
Epoch: 42, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.108067035675049
Epoch: 43, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.3959128856658936
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 45 cost time: 3.443664312362671
Epoch: 45, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.648 Vali Acc: 0.839 Test Loss: 0.648 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.453585386276245
Epoch: 46, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.226478099822998
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.646 Vali Acc: 0.861 Test Loss: 0.646 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.372962236404419
Epoch: 48, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.660 Vali Acc: 0.839 Test Loss: 0.660 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.3371901512145996
Epoch: 49, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.556626319885254
Epoch: 50, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.839 Test Loss: 0.665 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.280210494995117
Epoch: 51, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.060051202774048
Epoch: 52, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.2308638095855713
Epoch: 53, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.9355428218841553
Epoch: 54, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.686 Vali Acc: 0.839 Test Loss: 0.686 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.297909736633301
Epoch: 1, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.4497265815734863
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.1298108100891113
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9411418437957764
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 3.1833438873291016
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 2.943282127380371
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.987480401992798
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.1143085956573486
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 9 cost time: 2.948012351989746
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 10 cost time: 3.05487060546875
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0202529430389404
Epoch: 11, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 12 cost time: 2.954272747039795
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.878627300262451
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.946603775024414
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9236907958984375
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0280203819274902
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.0940346717834473
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.128943920135498
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.178873300552368
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.991506576538086
Epoch: 20, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1033270359039307
Epoch: 21, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 353935
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.137589693069458
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.710 Vali Acc: 0.072 Test Loss: 2.710 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 2.9151062965393066
Epoch: 2, Steps: 12 | Train Loss: 2.588 Vali Loss: 2.493 Vali Acc: 0.233 Test Loss: 2.493 Test Acc: 0.233
Validation loss decreased (-0.072195 --> -0.233308).  Saving model ...
Epoch: 3 cost time: 2.9267771244049072
Epoch: 3, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.244 Vali Acc: 0.456 Test Loss: 2.244 Test Acc: 0.456
Validation loss decreased (-0.233308 --> -0.455533).  Saving model ...
Epoch: 4 cost time: 3.0165417194366455
Epoch: 4, Steps: 12 | Train Loss: 2.120 Vali Loss: 1.999 Vali Acc: 0.506 Test Loss: 1.999 Test Acc: 0.506
Validation loss decreased (-0.455533 --> -0.505536).  Saving model ...
Epoch: 5 cost time: 2.947235345840454
Epoch: 5, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.777 Vali Acc: 0.600 Test Loss: 1.777 Test Acc: 0.600
Validation loss decreased (-0.505536 --> -0.599982).  Saving model ...
Epoch: 6 cost time: 2.978656530380249
Epoch: 6, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.587 Vali Acc: 0.639 Test Loss: 1.587 Test Acc: 0.639
Validation loss decreased (-0.599982 --> -0.638873).  Saving model ...
Epoch: 7 cost time: 3.417100191116333
Epoch: 7, Steps: 12 | Train Loss: 1.351 Vali Loss: 1.414 Vali Acc: 0.656 Test Loss: 1.414 Test Acc: 0.656
Validation loss decreased (-0.638873 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 3.346781015396118
Epoch: 8, Steps: 12 | Train Loss: 1.217 Vali Loss: 1.282 Vali Acc: 0.656 Test Loss: 1.282 Test Acc: 0.656
Validation loss decreased (-0.655541 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 3.066640615463257
Epoch: 9, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.148 Vali Acc: 0.689 Test Loss: 1.148 Test Acc: 0.689
Validation loss decreased (-0.655543 --> -0.688877).  Saving model ...
Epoch: 10 cost time: 3.0861406326293945
Epoch: 10, Steps: 12 | Train Loss: 0.848 Vali Loss: 1.056 Vali Acc: 0.717 Test Loss: 1.056 Test Acc: 0.717
Validation loss decreased (-0.688877 --> -0.716656).  Saving model ...
Epoch: 11 cost time: 3.305514335632324
Epoch: 11, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.965 Vali Acc: 0.733 Test Loss: 0.965 Test Acc: 0.733
Validation loss decreased (-0.716656 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 3.064422369003296
Epoch: 12, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.849 Vali Acc: 0.772 Test Loss: 0.849 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772214).  Saving model ...
Epoch: 13 cost time: 3.196599006652832
Epoch: 13, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 3.007087230682373
Epoch: 14, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.704 Vali Acc: 0.828 Test Loss: 0.704 Test Acc: 0.828
Validation loss decreased (-0.799992 --> -0.827771).  Saving model ...
Epoch: 15 cost time: 2.987194061279297
Epoch: 15, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1090235710144043
Epoch: 16, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 3.0559418201446533
Epoch: 17, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 18 cost time: 2.9976823329925537
Epoch: 18, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.480 Vali Acc: 0.856 Test Loss: 0.480 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 19 cost time: 3.046706199645996
Epoch: 19, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.470 Vali Acc: 0.861 Test Loss: 0.470 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 20 cost time: 3.1907401084899902
Epoch: 20, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 3.320758104324341
Epoch: 21, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.412 Vali Acc: 0.872 Test Loss: 0.412 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 22 cost time: 3.323540210723877
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.407 Vali Acc: 0.883 Test Loss: 0.407 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 23 cost time: 3.1189258098602295
Epoch: 23, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.398 Vali Acc: 0.894 Test Loss: 0.398 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 24 cost time: 3.3382439613342285
Epoch: 24, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 25 cost time: 3.1329989433288574
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3826606273651123
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.198192834854126
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.384 Vali Acc: 0.894 Test Loss: 0.384 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 28 cost time: 3.2509241104125977
Epoch: 28, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2087783813476562
Epoch: 29, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 30 cost time: 3.066528081893921
Epoch: 30, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1183242797851562
Epoch: 31, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.926983594894409
Epoch: 32, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.380 Vali Acc: 0.906 Test Loss: 0.380 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.0749051570892334
Epoch: 33, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.3892431259155273
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.383 Vali Acc: 0.906 Test Loss: 0.383 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.2224013805389404
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.3172831535339355
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.276643991470337
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.4915261268615723
Epoch: 38, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.631697654724121
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.073517560958862
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.701 Vali Acc: 0.039 Test Loss: 2.701 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 3.0397934913635254
Epoch: 2, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.523 Vali Acc: 0.133 Test Loss: 2.523 Test Acc: 0.133
Validation loss decreased (-0.038862 --> -0.133308).  Saving model ...
Epoch: 3 cost time: 3.138148307800293
Epoch: 3, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.319 Vali Acc: 0.389 Test Loss: 2.319 Test Acc: 0.389
Validation loss decreased (-0.133308 --> -0.388866).  Saving model ...
Epoch: 4 cost time: 3.123157024383545
Epoch: 4, Steps: 12 | Train Loss: 2.262 Vali Loss: 2.112 Vali Acc: 0.478 Test Loss: 2.112 Test Acc: 0.478
Validation loss decreased (-0.388866 --> -0.477757).  Saving model ...
Epoch: 5 cost time: 3.236020088195801
Epoch: 5, Steps: 12 | Train Loss: 2.051 Vali Loss: 1.915 Vali Acc: 0.589 Test Loss: 1.915 Test Acc: 0.589
Validation loss decreased (-0.477757 --> -0.588870).  Saving model ...
Epoch: 6 cost time: 3.727062225341797
Epoch: 6, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.737 Vali Acc: 0.611 Test Loss: 1.737 Test Acc: 0.611
Validation loss decreased (-0.588870 --> -0.611094).  Saving model ...
Epoch: 7 cost time: 3.4254813194274902
Epoch: 7, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.568 Vali Acc: 0.611 Test Loss: 1.568 Test Acc: 0.611
Validation loss decreased (-0.611094 --> -0.611095).  Saving model ...
Epoch: 8 cost time: 3.3957958221435547
Epoch: 8, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.431 Vali Acc: 0.622 Test Loss: 1.431 Test Acc: 0.622
Validation loss decreased (-0.611095 --> -0.622208).  Saving model ...
Epoch: 9 cost time: 3.369710922241211
Epoch: 9, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.286 Vali Acc: 0.678 Test Loss: 1.286 Test Acc: 0.678
Validation loss decreased (-0.622208 --> -0.677765).  Saving model ...
Epoch: 10 cost time: 3.6806583404541016
Epoch: 10, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.178 Vali Acc: 0.700 Test Loss: 1.178 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 3.2798783779144287
Epoch: 11, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.076 Vali Acc: 0.744 Test Loss: 1.076 Test Acc: 0.744
Validation loss decreased (-0.699988 --> -0.744434).  Saving model ...
Epoch: 12 cost time: 3.511629819869995
Epoch: 12, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.954 Vali Acc: 0.767 Test Loss: 0.954 Test Acc: 0.767
Validation loss decreased (-0.744434 --> -0.766657).  Saving model ...
Epoch: 13 cost time: 3.2970292568206787
Epoch: 13, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.853 Vali Acc: 0.772 Test Loss: 0.853 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 3.080003261566162
Epoch: 14, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
Validation loss decreased (-0.772214 --> -0.794436).  Saving model ...
Epoch: 15 cost time: 3.1854918003082275
Epoch: 15, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.698 Vali Acc: 0.839 Test Loss: 0.698 Test Acc: 0.839
Validation loss decreased (-0.794436 --> -0.838882).  Saving model ...
Epoch: 16 cost time: 3.227140426635742
Epoch: 16, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.653 Vali Acc: 0.856 Test Loss: 0.653 Test Acc: 0.856
Validation loss decreased (-0.838882 --> -0.855549).  Saving model ...
Epoch: 17 cost time: 3.092240571975708
Epoch: 17, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.592 Vali Acc: 0.856 Test Loss: 0.592 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 3.166316032409668
Epoch: 18, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.531 Vali Acc: 0.867 Test Loss: 0.531 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 19 cost time: 3.4431605339050293
Epoch: 19, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.522 Vali Acc: 0.889 Test Loss: 0.522 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 3.61080265045166
Epoch: 20, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 3.425387382507324
Epoch: 21, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.460 Vali Acc: 0.878 Test Loss: 0.460 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5363996028900146
Epoch: 22, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.456 Vali Acc: 0.894 Test Loss: 0.456 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 23 cost time: 3.4176836013793945
Epoch: 23, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.447 Vali Acc: 0.894 Test Loss: 0.447 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 24 cost time: 3.606719970703125
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.435 Vali Acc: 0.894 Test Loss: 0.435 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 25 cost time: 3.3543896675109863
Epoch: 25, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 3.47370982170105
Epoch: 26, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 3.5397982597351074
Epoch: 27, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.409109354019165
Epoch: 28, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.426 Vali Acc: 0.894 Test Loss: 0.426 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0477516651153564
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.428 Vali Acc: 0.906 Test Loss: 0.428 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905551).  Saving model ...
Epoch: 30 cost time: 3.0513856410980225
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.366391897201538
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.285107135772705
Epoch: 32, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.419 Vali Acc: 0.906 Test Loss: 0.419 Test Acc: 0.906
Validation loss decreased (-0.905551 --> -0.905551).  Saving model ...
Epoch: 33 cost time: 3.0421640872955322
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0603344440460205
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.1418941020965576
Epoch: 35, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.429 Vali Acc: 0.906 Test Loss: 0.429 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.127695322036743
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.455 Vali Acc: 0.906 Test Loss: 0.455 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.048177480697632
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.29508900642395
Epoch: 38, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.450 Vali Acc: 0.906 Test Loss: 0.450 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.3147194385528564
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.6636271476745605
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.3580031394958496
Epoch: 41, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.453 Vali Acc: 0.906 Test Loss: 0.453 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.532954216003418
Epoch: 42, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.452 Vali Acc: 0.906 Test Loss: 0.452 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.7576563358306885
Epoch: 1, Steps: 12 | Train Loss: 2.776 Vali Loss: 2.719 Vali Acc: 0.033 Test Loss: 2.719 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 3.054896354675293
Epoch: 2, Steps: 12 | Train Loss: 2.637 Vali Loss: 2.577 Vali Acc: 0.144 Test Loss: 2.577 Test Acc: 0.144
Validation loss decreased (-0.033306 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 2.9274544715881348
Epoch: 3, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.416 Vali Acc: 0.267 Test Loss: 2.416 Test Acc: 0.267
Validation loss decreased (-0.144419 --> -0.266643).  Saving model ...
Epoch: 4 cost time: 3.0147886276245117
Epoch: 4, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.252 Vali Acc: 0.306 Test Loss: 2.252 Test Acc: 0.306
Validation loss decreased (-0.266643 --> -0.305533).  Saving model ...
Epoch: 5 cost time: 2.9311320781707764
Epoch: 5, Steps: 12 | Train Loss: 2.236 Vali Loss: 2.093 Vali Acc: 0.439 Test Loss: 2.093 Test Acc: 0.439
Validation loss decreased (-0.305533 --> -0.438868).  Saving model ...
Epoch: 6 cost time: 2.871216058731079
Epoch: 6, Steps: 12 | Train Loss: 2.070 Vali Loss: 1.946 Vali Acc: 0.456 Test Loss: 1.946 Test Acc: 0.456
Validation loss decreased (-0.438868 --> -0.455536).  Saving model ...
Epoch: 7 cost time: 3.110214948654175
Epoch: 7, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.799 Vali Acc: 0.506 Test Loss: 1.799 Test Acc: 0.506
Validation loss decreased (-0.455536 --> -0.505538).  Saving model ...
Epoch: 8 cost time: 2.955451488494873
Epoch: 8, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.671 Vali Acc: 0.539 Test Loss: 1.671 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538872).  Saving model ...
Epoch: 9 cost time: 3.1664233207702637
Epoch: 9, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.533 Vali Acc: 0.606 Test Loss: 1.533 Test Acc: 0.606
Validation loss decreased (-0.538872 --> -0.605540).  Saving model ...
Epoch: 10 cost time: 3.252804756164551
Epoch: 10, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.410 Vali Acc: 0.644 Test Loss: 1.410 Test Acc: 0.644
Validation loss decreased (-0.605540 --> -0.644430).  Saving model ...
Epoch: 11 cost time: 3.2718546390533447
Epoch: 11, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.291 Vali Acc: 0.678 Test Loss: 1.291 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 3.099165678024292
Epoch: 12, Steps: 12 | Train Loss: 1.062 Vali Loss: 1.138 Vali Acc: 0.694 Test Loss: 1.138 Test Acc: 0.694
Validation loss decreased (-0.677765 --> -0.694433).  Saving model ...
Epoch: 13 cost time: 3.081852436065674
Epoch: 13, Steps: 12 | Train Loss: 0.936 Vali Loss: 1.045 Vali Acc: 0.711 Test Loss: 1.045 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 3.0349791049957275
Epoch: 14, Steps: 12 | Train Loss: 0.811 Vali Loss: 0.988 Vali Acc: 0.711 Test Loss: 0.988 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 15 cost time: 2.859218120574951
Epoch: 15, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.897 Vali Acc: 0.739 Test Loss: 0.897 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 2.8316650390625
Epoch: 16, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.837 Vali Acc: 0.761 Test Loss: 0.837 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 17 cost time: 3.056159257888794
Epoch: 17, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0190813541412354
Epoch: 18, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.703 Vali Acc: 0.772 Test Loss: 0.703 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 19 cost time: 2.9245517253875732
Epoch: 19, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 3.152963876724243
Epoch: 20, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.679 Vali Acc: 0.794 Test Loss: 0.679 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 21 cost time: 3.186859607696533
Epoch: 21, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
Validation loss decreased (-0.794438 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 3.2420475482940674
Epoch: 22, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.592 Vali Acc: 0.794 Test Loss: 0.592 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3833420276641846
Epoch: 23, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2095823287963867
Epoch: 24, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 2.9685065746307373
Epoch: 25, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.555 Vali Acc: 0.822 Test Loss: 0.555 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.006795883178711
Epoch: 26, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.525 Vali Acc: 0.839 Test Loss: 0.525 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 27 cost time: 3.2867352962493896
Epoch: 27, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1994311809539795
Epoch: 28, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.221597194671631
Epoch: 29, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 3.097147226333618
Epoch: 30, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.9771273136138916
Epoch: 31, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 32 cost time: 2.948126792907715
Epoch: 32, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.507 Vali Acc: 0.844 Test Loss: 0.507 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.07590389251709
Epoch: 33, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.521 Vali Acc: 0.839 Test Loss: 0.521 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.125802993774414
Epoch: 34, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.078467607498169
Epoch: 35, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.247640371322632
Epoch: 36, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.2519922256469727
Epoch: 37, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2511844635009766
Epoch: 38, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 3.062101125717163
Epoch: 39, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.1295058727264404
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.249952793121338
Epoch: 41, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.0731937885284424
Epoch: 42, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.890592098236084
Epoch: 43, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.527 Vali Acc: 0.856 Test Loss: 0.527 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.029289484024048
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.871009111404419
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.547 Vali Acc: 0.856 Test Loss: 0.547 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.927452325820923
Epoch: 46, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.548 Vali Acc: 0.861 Test Loss: 0.548 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.909064292907715
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.8686037063598633
Epoch: 48, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.484631299972534
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.690 Vali Acc: 0.072 Test Loss: 2.690 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 3.3511710166931152
Epoch: 2, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.606 Vali Acc: 0.150 Test Loss: 2.606 Test Acc: 0.150
Validation loss decreased (-0.072195 --> -0.149974).  Saving model ...
Epoch: 3 cost time: 3.2618401050567627
Epoch: 3, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.505 Vali Acc: 0.217 Test Loss: 2.505 Test Acc: 0.217
Validation loss decreased (-0.149974 --> -0.216642).  Saving model ...
Epoch: 4 cost time: 3.285325527191162
Epoch: 4, Steps: 12 | Train Loss: 2.498 Vali Loss: 2.394 Vali Acc: 0.261 Test Loss: 2.394 Test Acc: 0.261
Validation loss decreased (-0.216642 --> -0.261087).  Saving model ...
Epoch: 5 cost time: 3.0699055194854736
Epoch: 5, Steps: 12 | Train Loss: 2.405 Vali Loss: 2.285 Vali Acc: 0.233 Test Loss: 2.285 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.21578049659729
Epoch: 6, Steps: 12 | Train Loss: 2.279 Vali Loss: 2.168 Vali Acc: 0.294 Test Loss: 2.168 Test Acc: 0.294
Validation loss decreased (-0.261087 --> -0.294423).  Saving model ...
Epoch: 7 cost time: 2.919673204421997
Epoch: 7, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.036 Vali Acc: 0.328 Test Loss: 2.036 Test Acc: 0.328
Validation loss decreased (-0.294423 --> -0.327757).  Saving model ...
Epoch: 8 cost time: 3.5304481983184814
Epoch: 8, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.916 Vali Acc: 0.367 Test Loss: 1.916 Test Acc: 0.367
Validation loss decreased (-0.327757 --> -0.366648).  Saving model ...
Epoch: 9 cost time: 2.8941783905029297
Epoch: 9, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.765 Vali Acc: 0.450 Test Loss: 1.765 Test Acc: 0.450
Validation loss decreased (-0.366648 --> -0.449982).  Saving model ...
Epoch: 10 cost time: 3.1009387969970703
Epoch: 10, Steps: 12 | Train Loss: 1.637 Vali Loss: 1.618 Vali Acc: 0.517 Test Loss: 1.618 Test Acc: 0.517
Validation loss decreased (-0.449982 --> -0.516650).  Saving model ...
Epoch: 11 cost time: 3.203217029571533
Epoch: 11, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.479 Vali Acc: 0.567 Test Loss: 1.479 Test Acc: 0.567
Validation loss decreased (-0.516650 --> -0.566652).  Saving model ...
Epoch: 12 cost time: 3.2467188835144043
Epoch: 12, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.297 Vali Acc: 0.633 Test Loss: 1.297 Test Acc: 0.633
Validation loss decreased (-0.566652 --> -0.633320).  Saving model ...
Epoch: 13 cost time: 3.4128503799438477
Epoch: 13, Steps: 12 | Train Loss: 1.173 Vali Loss: 1.166 Vali Acc: 0.667 Test Loss: 1.166 Test Acc: 0.667
Validation loss decreased (-0.633320 --> -0.666655).  Saving model ...
Epoch: 14 cost time: 3.3340723514556885
Epoch: 14, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.071 Vali Acc: 0.672 Test Loss: 1.071 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672212).  Saving model ...
Epoch: 15 cost time: 3.5956974029541016
Epoch: 15, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.944 Vali Acc: 0.756 Test Loss: 0.944 Test Acc: 0.756
Validation loss decreased (-0.672212 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 3.476466655731201
Epoch: 16, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.870 Vali Acc: 0.761 Test Loss: 0.870 Test Acc: 0.761
Validation loss decreased (-0.755546 --> -0.761102).  Saving model ...
Epoch: 17 cost time: 3.2284908294677734
Epoch: 17, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.810 Vali Acc: 0.744 Test Loss: 0.810 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4686849117279053
Epoch: 18, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.735 Vali Acc: 0.783 Test Loss: 0.735 Test Acc: 0.783
Validation loss decreased (-0.761102 --> -0.783326).  Saving model ...
Epoch: 19 cost time: 3.5236270427703857
Epoch: 19, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 20 cost time: 3.2878565788269043
Epoch: 20, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.710 Vali Acc: 0.756 Test Loss: 0.710 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.181504487991333
Epoch: 21, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 22 cost time: 3.1762123107910156
Epoch: 22, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.616 Vali Acc: 0.811 Test Loss: 0.616 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 2.994022846221924
Epoch: 23, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.579 Vali Acc: 0.817 Test Loss: 0.579 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 24 cost time: 3.3407506942749023
Epoch: 24, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.566 Vali Acc: 0.817 Test Loss: 0.566 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 25 cost time: 3.0977087020874023
Epoch: 25, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.544 Vali Acc: 0.817 Test Loss: 0.544 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 26 cost time: 3.154669761657715
Epoch: 26, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 27 cost time: 3.328075885772705
Epoch: 27, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833328).  Saving model ...
Epoch: 28 cost time: 3.4929683208465576
Epoch: 28, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.544 Vali Acc: 0.828 Test Loss: 0.544 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.263056516647339
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 3.275933027267456
Epoch: 30, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.507641553878784
Epoch: 31, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4489424228668213
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.1839258670806885
Epoch: 33, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.1285505294799805
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.564 Vali Acc: 0.844 Test Loss: 0.564 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.067296266555786
Epoch: 35, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.0834145545959473
Epoch: 36, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.1044957637786865
Epoch: 37, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.564 Vali Acc: 0.839 Test Loss: 0.564 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.1596734523773193
Epoch: 38, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.580 Vali Acc: 0.844 Test Loss: 0.580 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.0911905765533447
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.564 Vali Acc: 0.839 Test Loss: 0.564 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.426612377166748
Epoch: 1, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.705 Vali Acc: 0.061 Test Loss: 2.705 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 2.9699015617370605
Epoch: 2, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.619 Vali Acc: 0.111 Test Loss: 2.619 Test Acc: 0.111
Validation loss decreased (-0.061084 --> -0.111085).  Saving model ...
Epoch: 3 cost time: 2.9286162853240967
Epoch: 3, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.501 Vali Acc: 0.206 Test Loss: 2.501 Test Acc: 0.206
Validation loss decreased (-0.111085 --> -0.205531).  Saving model ...
Epoch: 4 cost time: 3.372401714324951
Epoch: 4, Steps: 12 | Train Loss: 2.572 Vali Loss: 2.359 Vali Acc: 0.222 Test Loss: 2.359 Test Acc: 0.222
Validation loss decreased (-0.205531 --> -0.222199).  Saving model ...
Epoch: 5 cost time: 3.317965030670166
Epoch: 5, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.222 Vali Acc: 0.244 Test Loss: 2.222 Test Acc: 0.244
Validation loss decreased (-0.222199 --> -0.244422).  Saving model ...
Epoch: 6 cost time: 2.6386842727661133
Epoch: 6, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.082 Vali Acc: 0.289 Test Loss: 2.082 Test Acc: 0.289
Validation loss decreased (-0.244422 --> -0.288868).  Saving model ...
Epoch: 7 cost time: 2.7563364505767822
Epoch: 7, Steps: 12 | Train Loss: 2.233 Vali Loss: 1.952 Vali Acc: 0.350 Test Loss: 1.952 Test Acc: 0.350
Validation loss decreased (-0.288868 --> -0.349980).  Saving model ...
Epoch: 8 cost time: 2.982276439666748
Epoch: 8, Steps: 12 | Train Loss: 2.116 Vali Loss: 1.835 Vali Acc: 0.372 Test Loss: 1.835 Test Acc: 0.372
Validation loss decreased (-0.349980 --> -0.372204).  Saving model ...
Epoch: 9 cost time: 2.6258506774902344
Epoch: 9, Steps: 12 | Train Loss: 1.984 Vali Loss: 1.720 Vali Acc: 0.406 Test Loss: 1.720 Test Acc: 0.406
Validation loss decreased (-0.372204 --> -0.405538).  Saving model ...
Epoch: 10 cost time: 2.993317127227783
Epoch: 10, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.624 Vali Acc: 0.461 Test Loss: 1.624 Test Acc: 0.461
Validation loss decreased (-0.405538 --> -0.461095).  Saving model ...
Epoch: 11 cost time: 2.8962442874908447
Epoch: 11, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.525 Vali Acc: 0.517 Test Loss: 1.525 Test Acc: 0.517
Validation loss decreased (-0.461095 --> -0.516651).  Saving model ...
Epoch: 12 cost time: 3.2003395557403564
Epoch: 12, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.340 Vali Acc: 0.617 Test Loss: 1.340 Test Acc: 0.617
Validation loss decreased (-0.516651 --> -0.616653).  Saving model ...
Epoch: 13 cost time: 3.542207956314087
Epoch: 13, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.214 Vali Acc: 0.656 Test Loss: 1.214 Test Acc: 0.656
Validation loss decreased (-0.616653 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 3.3154807090759277
Epoch: 14, Steps: 12 | Train Loss: 1.127 Vali Loss: 1.130 Vali Acc: 0.672 Test Loss: 1.130 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672211).  Saving model ...
Epoch: 15 cost time: 3.284078598022461
Epoch: 15, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.039 Vali Acc: 0.683 Test Loss: 1.039 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683323).  Saving model ...
Epoch: 16 cost time: 3.1707603931427
Epoch: 16, Steps: 12 | Train Loss: 0.806 Vali Loss: 0.956 Vali Acc: 0.694 Test Loss: 0.956 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 3.3079919815063477
Epoch: 17, Steps: 12 | Train Loss: 0.717 Vali Loss: 0.886 Vali Acc: 0.683 Test Loss: 0.886 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2621891498565674
Epoch: 18, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.789 Vali Acc: 0.739 Test Loss: 0.789 Test Acc: 0.739
Validation loss decreased (-0.694435 --> -0.738881).  Saving model ...
Epoch: 19 cost time: 3.388106346130371
Epoch: 19, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.739 Vali Acc: 0.733 Test Loss: 0.739 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.098884344100952
Epoch: 20, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 2.8130879402160645
Epoch: 21, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.783327).  Saving model ...
Epoch: 22 cost time: 2.840269088745117
Epoch: 22, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.610 Vali Acc: 0.817 Test Loss: 0.610 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816661).  Saving model ...
Epoch: 23 cost time: 2.904203176498413
Epoch: 23, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.563 Vali Acc: 0.839 Test Loss: 0.563 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838883).  Saving model ...
Epoch: 24 cost time: 3.0138912200927734
Epoch: 24, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.911102056503296
Epoch: 25, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 3.1222007274627686
Epoch: 26, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.556 Vali Acc: 0.828 Test Loss: 0.556 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2258265018463135
Epoch: 27, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.545 Vali Acc: 0.844 Test Loss: 0.545 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 3.1706700325012207
Epoch: 28, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.534 Vali Acc: 0.839 Test Loss: 0.534 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.904071569442749
Epoch: 29, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 3.177306652069092
Epoch: 30, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.146881580352783
Epoch: 31, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.9876880645751953
Epoch: 32, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.795908212661743
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 34 cost time: 3.0251221656799316
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.555 Vali Acc: 0.867 Test Loss: 0.555 Test Acc: 0.867
Validation loss decreased (-0.849995 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 2.8422129154205322
Epoch: 35, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.6282119750976562
Epoch: 36, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.545 Vali Acc: 0.839 Test Loss: 0.545 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.0317327976226807
Epoch: 37, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.80532169342041
Epoch: 38, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.551 Vali Acc: 0.839 Test Loss: 0.551 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.9104416370391846
Epoch: 39, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.011159658432007
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.151390552520752
Epoch: 41, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.2720067501068115
Epoch: 42, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.558 Vali Acc: 0.844 Test Loss: 0.558 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.24284029006958
Epoch: 43, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.561 Vali Acc: 0.856 Test Loss: 0.561 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.0145983695983887
Epoch: 44, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.572 Vali Acc: 0.828 Test Loss: 0.572 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.210760116577148
Epoch: 1, Steps: 12 | Train Loss: 2.793 Vali Loss: 2.666 Vali Acc: 0.144 Test Loss: 2.666 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 2.7775282859802246
Epoch: 2, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.510 Vali Acc: 0.167 Test Loss: 2.510 Test Acc: 0.167
Validation loss decreased (-0.144418 --> -0.166642).  Saving model ...
Epoch: 3 cost time: 3.148770570755005
Epoch: 3, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.348 Vali Acc: 0.194 Test Loss: 2.348 Test Acc: 0.194
Validation loss decreased (-0.166642 --> -0.194421).  Saving model ...
Epoch: 4 cost time: 2.9290969371795654
Epoch: 4, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.229 Vali Acc: 0.289 Test Loss: 2.229 Test Acc: 0.289
Validation loss decreased (-0.194421 --> -0.288867).  Saving model ...
Epoch: 5 cost time: 2.9829084873199463
Epoch: 5, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.137 Vali Acc: 0.317 Test Loss: 2.137 Test Acc: 0.317
Validation loss decreased (-0.288867 --> -0.316645).  Saving model ...
Epoch: 6 cost time: 3.232235908508301
Epoch: 6, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.067 Vali Acc: 0.350 Test Loss: 2.067 Test Acc: 0.350
Validation loss decreased (-0.316645 --> -0.349979).  Saving model ...
Epoch: 7 cost time: 3.0010852813720703
Epoch: 7, Steps: 12 | Train Loss: 2.325 Vali Loss: 1.975 Vali Acc: 0.378 Test Loss: 1.975 Test Acc: 0.378
Validation loss decreased (-0.349979 --> -0.377758).  Saving model ...
Epoch: 8 cost time: 3.083209276199341
Epoch: 8, Steps: 12 | Train Loss: 2.177 Vali Loss: 1.905 Vali Acc: 0.406 Test Loss: 1.905 Test Acc: 0.406
Validation loss decreased (-0.377758 --> -0.405537).  Saving model ...
Epoch: 9 cost time: 3.411566972732544
Epoch: 9, Steps: 12 | Train Loss: 2.011 Vali Loss: 1.822 Vali Acc: 0.406 Test Loss: 1.822 Test Acc: 0.406
Validation loss decreased (-0.405537 --> -0.405537).  Saving model ...
Epoch: 10 cost time: 3.4099812507629395
Epoch: 10, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.725 Vali Acc: 0.389 Test Loss: 1.725 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.15057635307312
Epoch: 11, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.584 Vali Acc: 0.461 Test Loss: 1.584 Test Acc: 0.461
Validation loss decreased (-0.405537 --> -0.461095).  Saving model ...
Epoch: 12 cost time: 3.327242374420166
Epoch: 12, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.385 Vali Acc: 0.578 Test Loss: 1.385 Test Acc: 0.578
Validation loss decreased (-0.461095 --> -0.577764).  Saving model ...
Epoch: 13 cost time: 3.122360944747925
Epoch: 13, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.270 Vali Acc: 0.567 Test Loss: 1.270 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5261690616607666
Epoch: 14, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.202 Vali Acc: 0.617 Test Loss: 1.202 Test Acc: 0.617
Validation loss decreased (-0.577764 --> -0.616655).  Saving model ...
Epoch: 15 cost time: 3.451383352279663
Epoch: 15, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.087 Vali Acc: 0.656 Test Loss: 1.087 Test Acc: 0.656
Validation loss decreased (-0.616655 --> -0.655545).  Saving model ...
Epoch: 16 cost time: 3.0114166736602783
Epoch: 16, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.992 Vali Acc: 0.694 Test Loss: 0.992 Test Acc: 0.694
Validation loss decreased (-0.655545 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 3.140427589416504
Epoch: 17, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.925 Vali Acc: 0.678 Test Loss: 0.925 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0448341369628906
Epoch: 18, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.830 Vali Acc: 0.689 Test Loss: 0.830 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2555878162384033
Epoch: 19, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.773 Vali Acc: 0.706 Test Loss: 0.773 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705548).  Saving model ...
Epoch: 20 cost time: 3.154935359954834
Epoch: 20, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.753 Vali Acc: 0.733 Test Loss: 0.753 Test Acc: 0.733
Validation loss decreased (-0.705548 --> -0.733326).  Saving model ...
Epoch: 21 cost time: 3.184887647628784
Epoch: 21, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755549).  Saving model ...
Epoch: 22 cost time: 3.2472734451293945
Epoch: 22, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783327).  Saving model ...
Epoch: 23 cost time: 3.574406147003174
Epoch: 23, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.594 Vali Acc: 0.817 Test Loss: 0.594 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816661).  Saving model ...
Epoch: 24 cost time: 3.3976268768310547
Epoch: 24, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.603 Vali Acc: 0.800 Test Loss: 0.603 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5001537799835205
Epoch: 25, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.816661 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 3.2844314575195312
Epoch: 26, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.545 Vali Acc: 0.822 Test Loss: 0.545 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3940982818603516
Epoch: 27, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.537 Vali Acc: 0.828 Test Loss: 0.537 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2510297298431396
Epoch: 28, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.513 Vali Acc: 0.839 Test Loss: 0.513 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.146437406539917
Epoch: 29, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.110781669616699
Epoch: 30, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 3.3984735012054443
Epoch: 31, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1621174812316895
Epoch: 32, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.3643460273742676
Epoch: 33, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.487 Vali Acc: 0.839 Test Loss: 0.487 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.132615804672241
Epoch: 34, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.518 Vali Acc: 0.839 Test Loss: 0.518 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.3110527992248535
Epoch: 35, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.504 Vali Acc: 0.822 Test Loss: 0.504 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.325495958328247
Epoch: 36, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.491 Vali Acc: 0.839 Test Loss: 0.491 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.3746330738067627
Epoch: 37, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.496 Vali Acc: 0.839 Test Loss: 0.496 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.4841158390045166
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.499 Vali Acc: 0.839 Test Loss: 0.499 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.361781597137451
Epoch: 39, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.20158052444458
Epoch: 40, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 41 cost time: 3.083528995513916
Epoch: 41, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.321654796600342
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.0487112998962402
Epoch: 43, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.182002544403076
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866661).  Saving model ...
Epoch: 45 cost time: 2.9774563312530518
Epoch: 45, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.011279821395874
Epoch: 46, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.2764699459075928
Epoch: 47, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.499601125717163
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.3553497791290283
Epoch: 49, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.422943115234375
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.269294023513794
Epoch: 51, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.1919050216674805
Epoch: 52, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.2548553943634033
Epoch: 53, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.828 Test Loss: 0.569 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.3818817138671875
Epoch: 54, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9810705184936523
Epoch: 1, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.689 Vali Acc: 0.128 Test Loss: 2.689 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 2.9343745708465576
Epoch: 2, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.578 Vali Acc: 0.156 Test Loss: 2.578 Test Acc: 0.156
Validation loss decreased (-0.127751 --> -0.155530).  Saving model ...
Epoch: 3 cost time: 3.116306781768799
Epoch: 3, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.432 Vali Acc: 0.200 Test Loss: 2.432 Test Acc: 0.200
Validation loss decreased (-0.155530 --> -0.199976).  Saving model ...
Epoch: 4 cost time: 3.0993807315826416
Epoch: 4, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.278 Vali Acc: 0.261 Test Loss: 2.278 Test Acc: 0.261
Validation loss decreased (-0.199976 --> -0.261088).  Saving model ...
Epoch: 5 cost time: 3.077641010284424
Epoch: 5, Steps: 12 | Train Loss: 2.554 Vali Loss: 2.156 Vali Acc: 0.267 Test Loss: 2.156 Test Acc: 0.267
Validation loss decreased (-0.261088 --> -0.266645).  Saving model ...
Epoch: 6 cost time: 3.432947874069214
Epoch: 6, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.067 Vali Acc: 0.317 Test Loss: 2.067 Test Acc: 0.317
Validation loss decreased (-0.266645 --> -0.316646).  Saving model ...
Epoch: 7 cost time: 3.1606740951538086
Epoch: 7, Steps: 12 | Train Loss: 2.391 Vali Loss: 1.973 Vali Acc: 0.389 Test Loss: 1.973 Test Acc: 0.389
Validation loss decreased (-0.316646 --> -0.388869).  Saving model ...
Epoch: 8 cost time: 2.9925055503845215
Epoch: 8, Steps: 12 | Train Loss: 2.268 Vali Loss: 1.894 Vali Acc: 0.400 Test Loss: 1.894 Test Acc: 0.400
Validation loss decreased (-0.388869 --> -0.399981).  Saving model ...
Epoch: 9 cost time: 3.05244517326355
Epoch: 9, Steps: 12 | Train Loss: 2.105 Vali Loss: 1.809 Vali Acc: 0.400 Test Loss: 1.809 Test Acc: 0.400
Validation loss decreased (-0.399981 --> -0.399982).  Saving model ...
Epoch: 10 cost time: 3.024221897125244
Epoch: 10, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.696 Vali Acc: 0.444 Test Loss: 1.696 Test Acc: 0.444
Validation loss decreased (-0.399982 --> -0.444427).  Saving model ...
Epoch: 11 cost time: 2.846055269241333
Epoch: 11, Steps: 12 | Train Loss: 1.702 Vali Loss: 1.557 Vali Acc: 0.511 Test Loss: 1.557 Test Acc: 0.511
Validation loss decreased (-0.444427 --> -0.511096).  Saving model ...
Epoch: 12 cost time: 2.879530668258667
Epoch: 12, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.368 Vali Acc: 0.578 Test Loss: 1.368 Test Acc: 0.578
Validation loss decreased (-0.511096 --> -0.577764).  Saving model ...
Epoch: 13 cost time: 2.94022798538208
Epoch: 13, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.251 Vali Acc: 0.589 Test Loss: 1.251 Test Acc: 0.589
Validation loss decreased (-0.577764 --> -0.588876).  Saving model ...
Epoch: 14 cost time: 3.004699468612671
Epoch: 14, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.187 Vali Acc: 0.628 Test Loss: 1.187 Test Acc: 0.628
Validation loss decreased (-0.588876 --> -0.627766).  Saving model ...
Epoch: 15 cost time: 2.989811897277832
Epoch: 15, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.077 Vali Acc: 0.683 Test Loss: 1.077 Test Acc: 0.683
Validation loss decreased (-0.627766 --> -0.683323).  Saving model ...
Epoch: 16 cost time: 2.9595980644226074
Epoch: 16, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.974 Vali Acc: 0.694 Test Loss: 0.974 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 2.784114122390747
Epoch: 17, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.912 Vali Acc: 0.694 Test Loss: 0.912 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 18 cost time: 2.8608927726745605
Epoch: 18, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.823 Vali Acc: 0.733 Test Loss: 0.823 Test Acc: 0.733
Validation loss decreased (-0.694435 --> -0.733325).  Saving model ...
Epoch: 19 cost time: 3.023205280303955
Epoch: 19, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761104).  Saving model ...
Epoch: 20 cost time: 3.15376615524292
Epoch: 20, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.734 Vali Acc: 0.789 Test Loss: 0.734 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 3.128504991531372
Epoch: 21, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.659 Vali Acc: 0.778 Test Loss: 0.659 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1797850131988525
Epoch: 22, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 3.0835888385772705
Epoch: 23, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.592 Vali Acc: 0.828 Test Loss: 0.592 Test Acc: 0.828
Validation loss decreased (-0.799994 --> -0.827772).  Saving model ...
Epoch: 24 cost time: 3.2090165615081787
Epoch: 24, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.33585524559021
Epoch: 25, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 3.331252098083496
Epoch: 26, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.548 Vali Acc: 0.817 Test Loss: 0.548 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.918475866317749
Epoch: 27, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.549 Vali Acc: 0.856 Test Loss: 0.549 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 28 cost time: 2.8644156455993652
Epoch: 28, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 3.1640639305114746
Epoch: 29, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.413961887359619
Epoch: 30, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.534 Vali Acc: 0.856 Test Loss: 0.534 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.046489953994751
Epoch: 31, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.526 Vali Acc: 0.856 Test Loss: 0.526 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.111708879470825
Epoch: 32, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.3138885498046875
Epoch: 33, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.2804033756256104
Epoch: 34, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.144758939743042
Epoch: 35, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.225188732147217
Epoch: 36, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.1674177646636963
Epoch: 37, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.3986315727233887
Epoch: 38, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.597016334533691
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.061004400253296
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.159213066101074
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.155885934829712
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.844336748123169
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9680988788604736
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.1438868045806885
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.0621979236602783
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 9 cost time: 2.908825635910034
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 10 cost time: 3.0021393299102783
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 11 cost time: 2.9654054641723633
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0734684467315674
Epoch: 12, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0484187602996826
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.911471366882324
Epoch: 14, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0765106678009033
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2549729347229004
Epoch: 16, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.2373392581939697
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.383887767791748
Epoch: 18, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.2185845375061035
Epoch: 19, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 20 cost time: 3.1930673122406006
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 21 cost time: 3.2656781673431396
Epoch: 21, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 22 cost time: 3.0749399662017822
Epoch: 22, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 23 cost time: 3.01242995262146
Epoch: 23, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 24 cost time: 2.7193727493286133
Epoch: 24, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 25 cost time: 2.971237897872925
Epoch: 25, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 26 cost time: 3.149315118789673
Epoch: 26, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0265188217163086
Epoch: 27, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0348103046417236
Epoch: 28, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.99265193939209
Epoch: 29, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.092226982116699
Epoch: 30, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2033777236938477
Epoch: 31, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.1595845222473145
Epoch: 32, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.143853187561035
Epoch: 33, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.033414363861084
Epoch: 34, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.1538076400756836
Epoch: 35, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 255631
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.932739019393921
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.657 Vali Acc: 0.100 Test Loss: 2.657 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 3.0530993938446045
Epoch: 2, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.450 Vali Acc: 0.244 Test Loss: 2.450 Test Acc: 0.244
Validation loss decreased (-0.099973 --> -0.244420).  Saving model ...
Epoch: 3 cost time: 2.8186657428741455
Epoch: 3, Steps: 12 | Train Loss: 2.383 Vali Loss: 2.212 Vali Acc: 0.500 Test Loss: 2.212 Test Acc: 0.500
Validation loss decreased (-0.244420 --> -0.499978).  Saving model ...
Epoch: 4 cost time: 2.870093584060669
Epoch: 4, Steps: 12 | Train Loss: 2.127 Vali Loss: 1.977 Vali Acc: 0.539 Test Loss: 1.977 Test Acc: 0.539
Validation loss decreased (-0.499978 --> -0.538869).  Saving model ...
Epoch: 5 cost time: 3.264622688293457
Epoch: 5, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.774 Vali Acc: 0.539 Test Loss: 1.774 Test Acc: 0.539
Validation loss decreased (-0.538869 --> -0.538871).  Saving model ...
Epoch: 6 cost time: 3.140263557434082
Epoch: 6, Steps: 12 | Train Loss: 1.653 Vali Loss: 1.582 Vali Acc: 0.594 Test Loss: 1.582 Test Acc: 0.594
Validation loss decreased (-0.538871 --> -0.594429).  Saving model ...
Epoch: 7 cost time: 3.2244186401367188
Epoch: 7, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.418 Vali Acc: 0.650 Test Loss: 1.418 Test Acc: 0.650
Validation loss decreased (-0.594429 --> -0.649986).  Saving model ...
Epoch: 8 cost time: 3.1222293376922607
Epoch: 8, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.296 Vali Acc: 0.678 Test Loss: 1.296 Test Acc: 0.678
Validation loss decreased (-0.649986 --> -0.677765).  Saving model ...
Epoch: 9 cost time: 3.1890010833740234
Epoch: 9, Steps: 12 | Train Loss: 1.082 Vali Loss: 1.188 Vali Acc: 0.678 Test Loss: 1.188 Test Acc: 0.678
Validation loss decreased (-0.677765 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 3.1222352981567383
Epoch: 10, Steps: 12 | Train Loss: 0.941 Vali Loss: 1.092 Vali Acc: 0.694 Test Loss: 1.092 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 3.247135639190674
Epoch: 11, Steps: 12 | Train Loss: 0.780 Vali Loss: 1.005 Vali Acc: 0.711 Test Loss: 1.005 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711101).  Saving model ...
Epoch: 12 cost time: 2.923356056213379
Epoch: 12, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.890 Vali Acc: 0.722 Test Loss: 0.890 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 2.994347333908081
Epoch: 13, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.786 Vali Acc: 0.772 Test Loss: 0.786 Test Acc: 0.772
Validation loss decreased (-0.722213 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 2.9560799598693848
Epoch: 14, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.717 Vali Acc: 0.800 Test Loss: 0.717 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 3.0201785564422607
Epoch: 15, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 3.088040351867676
Epoch: 16, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.622 Vali Acc: 0.817 Test Loss: 0.622 Test Acc: 0.817
Validation loss decreased (-0.805549 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 3.0978803634643555
Epoch: 17, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.558 Vali Acc: 0.833 Test Loss: 0.558 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 3.274409055709839
Epoch: 18, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 19 cost time: 3.3626866340637207
Epoch: 19, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.281277894973755
Epoch: 20, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.476 Vali Acc: 0.839 Test Loss: 0.476 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 21 cost time: 3.362532138824463
Epoch: 21, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.452 Vali Acc: 0.867 Test Loss: 0.452 Test Acc: 0.867
Validation loss decreased (-0.838884 --> -0.866662).  Saving model ...
Epoch: 22 cost time: 3.284421443939209
Epoch: 22, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.449 Vali Acc: 0.861 Test Loss: 0.449 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4577383995056152
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.430 Vali Acc: 0.867 Test Loss: 0.430 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 24 cost time: 3.3011250495910645
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.431 Vali Acc: 0.872 Test Loss: 0.431 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 25 cost time: 3.2759251594543457
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.968932867050171
Epoch: 26, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.011990785598755
Epoch: 27, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.402 Vali Acc: 0.872 Test Loss: 0.402 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 28 cost time: 2.8432958126068115
Epoch: 28, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.389 Vali Acc: 0.889 Test Loss: 0.389 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 29 cost time: 3.105271100997925
Epoch: 29, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.381 Vali Acc: 0.894 Test Loss: 0.381 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 30 cost time: 3.168029546737671
Epoch: 30, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894441).  Saving model ...
Epoch: 31 cost time: 2.958810567855835
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
Validation loss decreased (-0.894441 --> -0.916663).  Saving model ...
Epoch: 32 cost time: 3.2842659950256348
Epoch: 32, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.259671926498413
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.173251152038574
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.397 Vali Acc: 0.894 Test Loss: 0.397 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0551443099975586
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.392 Vali Acc: 0.906 Test Loss: 0.392 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.196530818939209
Epoch: 36, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.395 Vali Acc: 0.894 Test Loss: 0.395 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.1323282718658447
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.398 Vali Acc: 0.894 Test Loss: 0.398 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.1710681915283203
Epoch: 38, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.398 Vali Acc: 0.906 Test Loss: 0.398 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.839611291885376
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.396 Vali Acc: 0.894 Test Loss: 0.396 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.8170008659362793
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.386 Vali Acc: 0.894 Test Loss: 0.386 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.8865156173706055
Epoch: 41, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.97173810005188
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.645 Vali Acc: 0.061 Test Loss: 2.645 Test Acc: 0.061
Validation loss decreased (inf --> -0.061085).  Saving model ...
Epoch: 2 cost time: 3.0337748527526855
Epoch: 2, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.478 Vali Acc: 0.222 Test Loss: 2.478 Test Acc: 0.222
Validation loss decreased (-0.061085 --> -0.222197).  Saving model ...
Epoch: 3 cost time: 3.2651710510253906
Epoch: 3, Steps: 12 | Train Loss: 2.451 Vali Loss: 2.287 Vali Acc: 0.439 Test Loss: 2.287 Test Acc: 0.439
Validation loss decreased (-0.222197 --> -0.438866).  Saving model ...
Epoch: 4 cost time: 3.1228811740875244
Epoch: 4, Steps: 12 | Train Loss: 2.242 Vali Loss: 2.093 Vali Acc: 0.506 Test Loss: 2.093 Test Acc: 0.506
Validation loss decreased (-0.438866 --> -0.505535).  Saving model ...
Epoch: 5 cost time: 2.9033827781677246
Epoch: 5, Steps: 12 | Train Loss: 2.077 Vali Loss: 1.911 Vali Acc: 0.528 Test Loss: 1.911 Test Acc: 0.528
Validation loss decreased (-0.505535 --> -0.527759).  Saving model ...
Epoch: 6 cost time: 3.3059566020965576
Epoch: 6, Steps: 12 | Train Loss: 1.852 Vali Loss: 1.733 Vali Acc: 0.561 Test Loss: 1.733 Test Acc: 0.561
Validation loss decreased (-0.527759 --> -0.561094).  Saving model ...
Epoch: 7 cost time: 2.8154854774475098
Epoch: 7, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.570 Vali Acc: 0.561 Test Loss: 1.570 Test Acc: 0.561
Validation loss decreased (-0.561094 --> -0.561095).  Saving model ...
Epoch: 8 cost time: 3.256300687789917
Epoch: 8, Steps: 12 | Train Loss: 1.444 Vali Loss: 1.445 Vali Acc: 0.583 Test Loss: 1.445 Test Acc: 0.583
Validation loss decreased (-0.561095 --> -0.583319).  Saving model ...
Epoch: 9 cost time: 3.1837737560272217
Epoch: 9, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.318 Vali Acc: 0.628 Test Loss: 1.318 Test Acc: 0.628
Validation loss decreased (-0.583319 --> -0.627765).  Saving model ...
Epoch: 10 cost time: 2.9797520637512207
Epoch: 10, Steps: 12 | Train Loss: 1.130 Vali Loss: 1.199 Vali Acc: 0.661 Test Loss: 1.199 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661099).  Saving model ...
Epoch: 11 cost time: 3.1198766231536865
Epoch: 11, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.089 Vali Acc: 0.711 Test Loss: 1.089 Test Acc: 0.711
Validation loss decreased (-0.661099 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 2.9310383796691895
Epoch: 12, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.973 Vali Acc: 0.728 Test Loss: 0.973 Test Acc: 0.728
Validation loss decreased (-0.711100 --> -0.727768).  Saving model ...
Epoch: 13 cost time: 3.1275408267974854
Epoch: 13, Steps: 12 | Train Loss: 0.790 Vali Loss: 0.862 Vali Acc: 0.767 Test Loss: 0.862 Test Acc: 0.767
Validation loss decreased (-0.727768 --> -0.766658).  Saving model ...
Epoch: 14 cost time: 3.1068031787872314
Epoch: 14, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.792 Vali Acc: 0.756 Test Loss: 0.792 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.91658091545105
Epoch: 15, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.734 Vali Acc: 0.806 Test Loss: 0.734 Test Acc: 0.806
Validation loss decreased (-0.766658 --> -0.805548).  Saving model ...
Epoch: 16 cost time: 3.20171856880188
Epoch: 16, Steps: 12 | Train Loss: 0.468 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3201630115509033
Epoch: 17, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
Validation loss decreased (-0.805548 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 3.1870932579040527
Epoch: 18, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.616 Vali Acc: 0.844 Test Loss: 0.616 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 19 cost time: 3.3572583198547363
Epoch: 19, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 3.5462169647216797
Epoch: 20, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 3.2087135314941406
Epoch: 21, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 22 cost time: 3.702550172805786
Epoch: 22, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.500 Vali Acc: 0.878 Test Loss: 0.500 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 23 cost time: 3.352705478668213
Epoch: 23, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.491 Vali Acc: 0.878 Test Loss: 0.491 Test Acc: 0.878
Validation loss decreased (-0.877773 --> -0.877773).  Saving model ...
Epoch: 24 cost time: 3.0420501232147217
Epoch: 24, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888884).  Saving model ...
Epoch: 25 cost time: 3.2056071758270264
Epoch: 25, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.465 Vali Acc: 0.878 Test Loss: 0.465 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2506721019744873
Epoch: 26, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.473 Vali Acc: 0.883 Test Loss: 0.473 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2325079441070557
Epoch: 27, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.450 Vali Acc: 0.883 Test Loss: 0.450 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.260606050491333
Epoch: 28, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.450 Vali Acc: 0.894 Test Loss: 0.450 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 29 cost time: 3.140312671661377
Epoch: 29, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.457 Vali Acc: 0.883 Test Loss: 0.457 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3134660720825195
Epoch: 30, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.200087308883667
Epoch: 31, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 3.337368965148926
Epoch: 32, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.442 Vali Acc: 0.894 Test Loss: 0.442 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4492294788360596
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.141444444656372
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.2981507778167725
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.272142171859741
Epoch: 36, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.473 Vali Acc: 0.894 Test Loss: 0.473 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.2625551223754883
Epoch: 37, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.918445587158203
Epoch: 38, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.8349902629852295
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.0945398807525635
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.473 Vali Acc: 0.894 Test Loss: 0.473 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.0742557048797607
Epoch: 41, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.506 Vali Acc: 0.911 Test Loss: 0.506 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 42 cost time: 2.673929452896118
Epoch: 42, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.871487617492676
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.475 Vali Acc: 0.906 Test Loss: 0.475 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.124643087387085
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.190322160720825
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.203484296798706
Epoch: 46, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.504 Vali Acc: 0.894 Test Loss: 0.504 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.124734401702881
Epoch: 47, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.9719738960266113
Epoch: 48, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.2972145080566406
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.235050916671753
Epoch: 50, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.501 Vali Acc: 0.894 Test Loss: 0.501 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.974290132522583
Epoch: 51, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.500 Vali Acc: 0.894 Test Loss: 0.500 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9111111111111111
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.199524402618408
Epoch: 1, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.658 Vali Acc: 0.039 Test Loss: 2.658 Test Acc: 0.039
Validation loss decreased (inf --> -0.038862).  Saving model ...
Epoch: 2 cost time: 2.8212552070617676
Epoch: 2, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.528 Vali Acc: 0.233 Test Loss: 2.528 Test Acc: 0.233
Validation loss decreased (-0.038862 --> -0.233308).  Saving model ...
Epoch: 3 cost time: 3.258861780166626
Epoch: 3, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.382 Vali Acc: 0.356 Test Loss: 2.382 Test Acc: 0.356
Validation loss decreased (-0.233308 --> -0.355532).  Saving model ...
Epoch: 4 cost time: 3.2338809967041016
Epoch: 4, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.230 Vali Acc: 0.383 Test Loss: 2.230 Test Acc: 0.383
Validation loss decreased (-0.355532 --> -0.383311).  Saving model ...
Epoch: 5 cost time: 3.1417040824890137
Epoch: 5, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.084 Vali Acc: 0.522 Test Loss: 2.084 Test Acc: 0.522
Validation loss decreased (-0.383311 --> -0.522201).  Saving model ...
Epoch: 6 cost time: 3.024580478668213
Epoch: 6, Steps: 12 | Train Loss: 2.051 Vali Loss: 1.933 Vali Acc: 0.478 Test Loss: 1.933 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.07879638671875
Epoch: 7, Steps: 12 | Train Loss: 1.884 Vali Loss: 1.786 Vali Acc: 0.544 Test Loss: 1.786 Test Acc: 0.544
Validation loss decreased (-0.522201 --> -0.544427).  Saving model ...
Epoch: 8 cost time: 3.1814537048339844
Epoch: 8, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.660 Vali Acc: 0.550 Test Loss: 1.660 Test Acc: 0.550
Validation loss decreased (-0.544427 --> -0.549983).  Saving model ...
Epoch: 9 cost time: 3.312223196029663
Epoch: 9, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.529 Vali Acc: 0.622 Test Loss: 1.529 Test Acc: 0.622
Validation loss decreased (-0.549983 --> -0.622207).  Saving model ...
Epoch: 10 cost time: 2.9976744651794434
Epoch: 10, Steps: 12 | Train Loss: 1.375 Vali Loss: 1.394 Vali Acc: 0.628 Test Loss: 1.394 Test Acc: 0.628
Validation loss decreased (-0.622207 --> -0.627764).  Saving model ...
Epoch: 11 cost time: 2.8456878662109375
Epoch: 11, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.272 Vali Acc: 0.650 Test Loss: 1.272 Test Acc: 0.650
Validation loss decreased (-0.627764 --> -0.649987).  Saving model ...
Epoch: 12 cost time: 3.0554511547088623
Epoch: 12, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.145 Vali Acc: 0.683 Test Loss: 1.145 Test Acc: 0.683
Validation loss decreased (-0.649987 --> -0.683322).  Saving model ...
Epoch: 13 cost time: 3.0964889526367188
Epoch: 13, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
Validation loss decreased (-0.683322 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 2.902641773223877
Epoch: 14, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.931 Vali Acc: 0.711 Test Loss: 0.931 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9780290126800537
Epoch: 15, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.872 Vali Acc: 0.728 Test Loss: 0.872 Test Acc: 0.728
Validation loss decreased (-0.722212 --> -0.727769).  Saving model ...
Epoch: 16 cost time: 3.147012233734131
Epoch: 16, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 2.873997688293457
Epoch: 17, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.748 Vali Acc: 0.767 Test Loss: 0.748 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 18 cost time: 3.1761553287506104
Epoch: 18, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.744 Vali Acc: 0.767 Test Loss: 0.744 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 19 cost time: 3.146219253540039
Epoch: 19, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.766659 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 3.0785083770751953
Epoch: 20, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.640 Vali Acc: 0.794 Test Loss: 0.640 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.295545816421509
Epoch: 21, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.606 Vali Acc: 0.828 Test Loss: 0.606 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827772).  Saving model ...
Epoch: 22 cost time: 3.2586727142333984
Epoch: 22, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 23 cost time: 3.058119297027588
Epoch: 23, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.593 Vali Acc: 0.828 Test Loss: 0.593 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 24 cost time: 3.0671603679656982
Epoch: 24, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 2.9256176948547363
Epoch: 25, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 26 cost time: 2.926395893096924
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.561 Vali Acc: 0.839 Test Loss: 0.561 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.079204797744751
Epoch: 27, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.30871844291687
Epoch: 28, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 29 cost time: 3.0643813610076904
Epoch: 29, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.15665864944458
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2431640625
Epoch: 31, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 3.116746425628662
Epoch: 32, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 3.42144775390625
Epoch: 33, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 34 cost time: 3.2226738929748535
Epoch: 34, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1356160640716553
Epoch: 35, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.112297534942627
Epoch: 36, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.268306016921997
Epoch: 37, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.0519025325775146
Epoch: 38, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 39 cost time: 2.9851322174072266
Epoch: 39, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 40 cost time: 3.1046037673950195
Epoch: 40, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.581 Vali Acc: 0.856 Test Loss: 0.581 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.948138952255249
Epoch: 41, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.093379020690918
Epoch: 42, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.152831792831421
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.579 Vali Acc: 0.856 Test Loss: 0.579 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.1129872798919678
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.0508384704589844
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.9900331497192383
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.131422519683838
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.580 Vali Acc: 0.856 Test Loss: 0.580 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.951801061630249
Epoch: 48, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.0660133361816406
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.602 Vali Acc: 0.856 Test Loss: 0.602 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.37885308265686
Epoch: 1, Steps: 12 | Train Loss: 2.758 Vali Loss: 2.682 Vali Acc: 0.011 Test Loss: 2.682 Test Acc: 0.011
Validation loss decreased (inf --> -0.011084).  Saving model ...
Epoch: 2 cost time: 3.0064258575439453
Epoch: 2, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.598 Vali Acc: 0.039 Test Loss: 2.598 Test Acc: 0.039
Validation loss decreased (-0.011084 --> -0.038863).  Saving model ...
Epoch: 3 cost time: 2.9164886474609375
Epoch: 3, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.503 Vali Acc: 0.200 Test Loss: 2.503 Test Acc: 0.200
Validation loss decreased (-0.038863 --> -0.199975).  Saving model ...
Epoch: 4 cost time: 3.156104326248169
Epoch: 4, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.399 Vali Acc: 0.306 Test Loss: 2.399 Test Acc: 0.306
Validation loss decreased (-0.199975 --> -0.305532).  Saving model ...
Epoch: 5 cost time: 3.2070260047912598
Epoch: 5, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.290 Vali Acc: 0.333 Test Loss: 2.290 Test Acc: 0.333
Validation loss decreased (-0.305532 --> -0.333310).  Saving model ...
Epoch: 6 cost time: 3.020627737045288
Epoch: 6, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.170 Vali Acc: 0.300 Test Loss: 2.170 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.324568748474121
Epoch: 7, Steps: 12 | Train Loss: 2.121 Vali Loss: 2.043 Vali Acc: 0.344 Test Loss: 2.043 Test Acc: 0.344
Validation loss decreased (-0.333310 --> -0.344424).  Saving model ...
Epoch: 8 cost time: 3.13783860206604
Epoch: 8, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.909 Vali Acc: 0.394 Test Loss: 1.909 Test Acc: 0.394
Validation loss decreased (-0.344424 --> -0.394425).  Saving model ...
Epoch: 9 cost time: 3.2878689765930176
Epoch: 9, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.760 Vali Acc: 0.450 Test Loss: 1.760 Test Acc: 0.450
Validation loss decreased (-0.394425 --> -0.449982).  Saving model ...
Epoch: 10 cost time: 3.385134220123291
Epoch: 10, Steps: 12 | Train Loss: 1.639 Vali Loss: 1.595 Vali Acc: 0.511 Test Loss: 1.595 Test Acc: 0.511
Validation loss decreased (-0.449982 --> -0.511095).  Saving model ...
Epoch: 11 cost time: 3.6613314151763916
Epoch: 11, Steps: 12 | Train Loss: 1.469 Vali Loss: 1.452 Vali Acc: 0.611 Test Loss: 1.452 Test Acc: 0.611
Validation loss decreased (-0.511095 --> -0.611097).  Saving model ...
Epoch: 12 cost time: 3.418975353240967
Epoch: 12, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.294 Vali Acc: 0.628 Test Loss: 1.294 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627765).  Saving model ...
Epoch: 13 cost time: 3.4417977333068848
Epoch: 13, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.138 Vali Acc: 0.661 Test Loss: 1.138 Test Acc: 0.661
Validation loss decreased (-0.627765 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 2.9865944385528564
Epoch: 14, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.018 Vali Acc: 0.706 Test Loss: 1.018 Test Acc: 0.706
Validation loss decreased (-0.661100 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 3.2254366874694824
Epoch: 15, Steps: 12 | Train Loss: 0.821 Vali Loss: 0.975 Vali Acc: 0.667 Test Loss: 0.975 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.900700092315674
Epoch: 16, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.888 Vali Acc: 0.739 Test Loss: 0.888 Test Acc: 0.739
Validation loss decreased (-0.705545 --> -0.738880).  Saving model ...
Epoch: 17 cost time: 3.110492706298828
Epoch: 17, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1349375247955322
Epoch: 18, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.786 Vali Acc: 0.728 Test Loss: 0.786 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.006946563720703
Epoch: 19, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 20 cost time: 3.3201420307159424
Epoch: 20, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 3.2455430030822754
Epoch: 21, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.637 Vali Acc: 0.817 Test Loss: 0.637 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 22 cost time: 3.0824978351593018
Epoch: 22, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.625 Vali Acc: 0.817 Test Loss: 0.625 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 3.446298122406006
Epoch: 23, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.628 Vali Acc: 0.828 Test Loss: 0.628 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 3.552767038345337
Epoch: 24, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (-0.827771 --> -0.844439).  Saving model ...
Epoch: 25 cost time: 3.1491477489471436
Epoch: 25, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 3.0870559215545654
Epoch: 26, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 3.045083522796631
Epoch: 27, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 28 cost time: 2.915942907333374
Epoch: 28, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.545 Vali Acc: 0.856 Test Loss: 0.545 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 3.0314767360687256
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.9108760356903076
Epoch: 30, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.0822091102600098
Epoch: 31, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.0725269317626953
Epoch: 32, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.9898579120635986
Epoch: 33, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.551 Vali Acc: 0.856 Test Loss: 0.551 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.523679733276367
Epoch: 34, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.085596799850464
Epoch: 35, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.573 Vali Acc: 0.861 Test Loss: 0.573 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861105).  Saving model ...
Epoch: 36 cost time: 3.1100645065307617
Epoch: 36, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.554 Vali Acc: 0.856 Test Loss: 0.554 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.046005964279175
Epoch: 37, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.578 Vali Acc: 0.872 Test Loss: 0.578 Test Acc: 0.872
Validation loss decreased (-0.861105 --> -0.872216).  Saving model ...
Epoch: 38 cost time: 3.176448345184326
Epoch: 38, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.0143017768859863
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.339984178543091
Epoch: 40, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.575 Vali Acc: 0.861 Test Loss: 0.575 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.0393474102020264
Epoch: 41, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.065934419631958
Epoch: 42, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.586 Vali Acc: 0.861 Test Loss: 0.586 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.260012149810791
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.588 Vali Acc: 0.861 Test Loss: 0.588 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.2817301750183105
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.1171059608459473
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.620 Vali Acc: 0.867 Test Loss: 0.620 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.402592658996582
Epoch: 46, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.616 Vali Acc: 0.867 Test Loss: 0.616 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.1913259029388428
Epoch: 47, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.601 Vali Acc: 0.867 Test Loss: 0.601 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.745644569396973
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.675 Vali Acc: 0.072 Test Loss: 2.675 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 3.1762261390686035
Epoch: 2, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.577 Vali Acc: 0.167 Test Loss: 2.577 Test Acc: 0.167
Validation loss decreased (-0.072195 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 2.9737625122070312
Epoch: 3, Steps: 12 | Train Loss: 2.697 Vali Loss: 2.446 Vali Acc: 0.228 Test Loss: 2.446 Test Acc: 0.228
Validation loss decreased (-0.166641 --> -0.227753).  Saving model ...
Epoch: 4 cost time: 2.9292778968811035
Epoch: 4, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.300 Vali Acc: 0.272 Test Loss: 2.300 Test Acc: 0.272
Validation loss decreased (-0.227753 --> -0.272199).  Saving model ...
Epoch: 5 cost time: 2.9713048934936523
Epoch: 5, Steps: 12 | Train Loss: 2.466 Vali Loss: 2.138 Vali Acc: 0.311 Test Loss: 2.138 Test Acc: 0.311
Validation loss decreased (-0.272199 --> -0.311090).  Saving model ...
Epoch: 6 cost time: 3.2296953201293945
Epoch: 6, Steps: 12 | Train Loss: 2.348 Vali Loss: 1.974 Vali Acc: 0.350 Test Loss: 1.974 Test Acc: 0.350
Validation loss decreased (-0.311090 --> -0.349980).  Saving model ...
Epoch: 7 cost time: 3.232795238494873
Epoch: 7, Steps: 12 | Train Loss: 2.224 Vali Loss: 1.833 Vali Acc: 0.422 Test Loss: 1.833 Test Acc: 0.422
Validation loss decreased (-0.349980 --> -0.422204).  Saving model ...
Epoch: 8 cost time: 3.28029203414917
Epoch: 8, Steps: 12 | Train Loss: 2.100 Vali Loss: 1.719 Vali Acc: 0.506 Test Loss: 1.719 Test Acc: 0.506
Validation loss decreased (-0.422204 --> -0.505538).  Saving model ...
Epoch: 9 cost time: 3.6653990745544434
Epoch: 9, Steps: 12 | Train Loss: 1.981 Vali Loss: 1.620 Vali Acc: 0.506 Test Loss: 1.620 Test Acc: 0.506
Validation loss decreased (-0.505538 --> -0.505539).  Saving model ...
Epoch: 10 cost time: 3.3922877311706543
Epoch: 10, Steps: 12 | Train Loss: 1.746 Vali Loss: 1.489 Vali Acc: 0.528 Test Loss: 1.489 Test Acc: 0.528
Validation loss decreased (-0.505539 --> -0.527763).  Saving model ...
Epoch: 11 cost time: 3.073817491531372
Epoch: 11, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.401 Vali Acc: 0.578 Test Loss: 1.401 Test Acc: 0.578
Validation loss decreased (-0.527763 --> -0.577764).  Saving model ...
Epoch: 12 cost time: 3.00813889503479
Epoch: 12, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.298 Vali Acc: 0.656 Test Loss: 1.298 Test Acc: 0.656
Validation loss decreased (-0.577764 --> -0.655543).  Saving model ...
Epoch: 13 cost time: 2.8174898624420166
Epoch: 13, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.179 Vali Acc: 0.633 Test Loss: 1.179 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9427247047424316
Epoch: 14, Steps: 12 | Train Loss: 0.989 Vali Loss: 1.079 Vali Acc: 0.672 Test Loss: 1.079 Test Acc: 0.672
Validation loss decreased (-0.655543 --> -0.672211).  Saving model ...
Epoch: 15 cost time: 2.947288990020752
Epoch: 15, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.040 Vali Acc: 0.628 Test Loss: 1.040 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8613314628601074
Epoch: 16, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.975 Vali Acc: 0.678 Test Loss: 0.975 Test Acc: 0.678
Validation loss decreased (-0.672211 --> -0.677768).  Saving model ...
Epoch: 17 cost time: 2.995798349380493
Epoch: 17, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.902 Vali Acc: 0.661 Test Loss: 0.902 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4364044666290283
Epoch: 18, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.858 Vali Acc: 0.667 Test Loss: 0.858 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0406548976898193
Epoch: 19, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
Validation loss decreased (-0.677768 --> -0.722214).  Saving model ...
Epoch: 20 cost time: 3.126781940460205
Epoch: 20, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.743 Vali Acc: 0.722 Test Loss: 0.743 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722215).  Saving model ...
Epoch: 21 cost time: 3.228510856628418
Epoch: 21, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.701 Vali Acc: 0.750 Test Loss: 0.701 Test Acc: 0.750
Validation loss decreased (-0.722215 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 3.158158540725708
Epoch: 22, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.685 Vali Acc: 0.772 Test Loss: 0.685 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 23 cost time: 3.2295258045196533
Epoch: 23, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.680 Vali Acc: 0.778 Test Loss: 0.680 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 3.4815902709960938
Epoch: 24, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.640 Vali Acc: 0.828 Test Loss: 0.640 Test Acc: 0.828
Validation loss decreased (-0.777771 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 3.325096845626831
Epoch: 25, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.644 Vali Acc: 0.811 Test Loss: 0.644 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9181771278381348
Epoch: 26, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.627 Vali Acc: 0.828 Test Loss: 0.627 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 27 cost time: 2.7819297313690186
Epoch: 27, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 2.9015471935272217
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 3.027235746383667
Epoch: 29, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.613 Vali Acc: 0.839 Test Loss: 0.613 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1606273651123047
Epoch: 30, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2796127796173096
Epoch: 31, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.1629350185394287
Epoch: 32, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.633 Vali Acc: 0.833 Test Loss: 0.633 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.227330446243286
Epoch: 33, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.399489402770996
Epoch: 34, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.638 Vali Acc: 0.839 Test Loss: 0.638 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.3137645721435547
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.613 Vali Acc: 0.856 Test Loss: 0.613 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 36 cost time: 3.181952714920044
Epoch: 36, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.473571538925171
Epoch: 37, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.359069585800171
Epoch: 38, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.10672664642334
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.641 Vali Acc: 0.839 Test Loss: 0.641 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.0930440425872803
Epoch: 40, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.1276133060455322
Epoch: 41, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.650 Vali Acc: 0.839 Test Loss: 0.650 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.213988780975342
Epoch: 42, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.923287868499756
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.1886909008026123
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.3737189769744873
Epoch: 45, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.668908596038818
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.698 Vali Acc: 0.089 Test Loss: 2.698 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 3.353069543838501
Epoch: 2, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.518 Vali Acc: 0.183 Test Loss: 2.518 Test Acc: 0.183
Validation loss decreased (-0.088862 --> -0.183308).  Saving model ...
Epoch: 3 cost time: 3.1923913955688477
Epoch: 3, Steps: 12 | Train Loss: 2.704 Vali Loss: 2.345 Vali Acc: 0.267 Test Loss: 2.345 Test Acc: 0.267
Validation loss decreased (-0.183308 --> -0.266643).  Saving model ...
Epoch: 4 cost time: 3.2156848907470703
Epoch: 4, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.219 Vali Acc: 0.333 Test Loss: 2.219 Test Acc: 0.333
Validation loss decreased (-0.266643 --> -0.333311).  Saving model ...
Epoch: 5 cost time: 3.015028715133667
Epoch: 5, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.131 Vali Acc: 0.311 Test Loss: 2.131 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.148228406906128
Epoch: 6, Steps: 12 | Train Loss: 2.391 Vali Loss: 2.042 Vali Acc: 0.311 Test Loss: 2.042 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.992983102798462
Epoch: 7, Steps: 12 | Train Loss: 2.321 Vali Loss: 1.957 Vali Acc: 0.361 Test Loss: 1.957 Test Acc: 0.361
Validation loss decreased (-0.333311 --> -0.361092).  Saving model ...
Epoch: 8 cost time: 3.1151199340820312
Epoch: 8, Steps: 12 | Train Loss: 2.192 Vali Loss: 1.868 Vali Acc: 0.417 Test Loss: 1.868 Test Acc: 0.417
Validation loss decreased (-0.361092 --> -0.416648).  Saving model ...
Epoch: 9 cost time: 2.9162662029266357
Epoch: 9, Steps: 12 | Train Loss: 2.061 Vali Loss: 1.782 Vali Acc: 0.439 Test Loss: 1.782 Test Acc: 0.439
Validation loss decreased (-0.416648 --> -0.438871).  Saving model ...
Epoch: 10 cost time: 3.088616371154785
Epoch: 10, Steps: 12 | Train Loss: 1.850 Vali Loss: 1.650 Vali Acc: 0.439 Test Loss: 1.650 Test Acc: 0.439
Validation loss decreased (-0.438871 --> -0.438872).  Saving model ...
Epoch: 11 cost time: 2.989863395690918
Epoch: 11, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.546 Vali Acc: 0.467 Test Loss: 1.546 Test Acc: 0.467
Validation loss decreased (-0.438872 --> -0.466651).  Saving model ...
Epoch: 12 cost time: 2.948151111602783
Epoch: 12, Steps: 12 | Train Loss: 1.452 Vali Loss: 1.392 Vali Acc: 0.589 Test Loss: 1.392 Test Acc: 0.589
Validation loss decreased (-0.466651 --> -0.588875).  Saving model ...
Epoch: 13 cost time: 2.8914833068847656
Epoch: 13, Steps: 12 | Train Loss: 1.227 Vali Loss: 1.239 Vali Acc: 0.594 Test Loss: 1.239 Test Acc: 0.594
Validation loss decreased (-0.588875 --> -0.594432).  Saving model ...
Epoch: 14 cost time: 2.9958548545837402
Epoch: 14, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.116 Vali Acc: 0.661 Test Loss: 1.116 Test Acc: 0.661
Validation loss decreased (-0.594432 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 2.947531223297119
Epoch: 15, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.966552734375
Epoch: 16, Steps: 12 | Train Loss: 0.813 Vali Loss: 0.985 Vali Acc: 0.694 Test Loss: 0.985 Test Acc: 0.694
Validation loss decreased (-0.661100 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 3.204388380050659
Epoch: 17, Steps: 12 | Train Loss: 0.777 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 3.2965352535247803
Epoch: 18, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.836 Vali Acc: 0.689 Test Loss: 0.836 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1080100536346436
Epoch: 19, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.782 Vali Acc: 0.728 Test Loss: 0.782 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727770).  Saving model ...
Epoch: 20 cost time: 3.194413423538208
Epoch: 20, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.726 Vali Acc: 0.739 Test Loss: 0.726 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738882).  Saving model ...
Epoch: 21 cost time: 3.089857339859009
Epoch: 21, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.681 Vali Acc: 0.761 Test Loss: 0.681 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761104).  Saving model ...
Epoch: 22 cost time: 2.912684679031372
Epoch: 22, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
Validation loss decreased (-0.761104 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 3.2940425872802734
Epoch: 23, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.624 Vali Acc: 0.811 Test Loss: 0.624 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 24 cost time: 3.495072603225708
Epoch: 24, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.589 Vali Acc: 0.828 Test Loss: 0.589 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 25 cost time: 3.488046884536743
Epoch: 25, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.6514358520507812
Epoch: 26, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 3.480086088180542
Epoch: 27, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.6258621215820312
Epoch: 28, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 3.335578203201294
Epoch: 29, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6376798152923584
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.179098129272461
Epoch: 31, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.543 Vali Acc: 0.839 Test Loss: 0.543 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 32 cost time: 2.951612710952759
Epoch: 32, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.133643388748169
Epoch: 33, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.421571731567383
Epoch: 34, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.182647228240967
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.564 Vali Acc: 0.839 Test Loss: 0.564 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.1757760047912598
Epoch: 36, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.397625207901001
Epoch: 37, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.562 Vali Acc: 0.833 Test Loss: 0.562 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.0773301124572754
Epoch: 38, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.461574077606201
Epoch: 39, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.25179123878479
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 3.7198679447174072
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.1771087646484375
Epoch: 42, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.591 Vali Acc: 0.828 Test Loss: 0.591 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.8781192302703857
Epoch: 43, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.602 Vali Acc: 0.828 Test Loss: 0.602 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.995157241821289
Epoch: 44, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.590 Vali Acc: 0.839 Test Loss: 0.590 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.786789894104004
Epoch: 45, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.343125581741333
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.011817216873169
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 48 cost time: 3.105978012084961
Epoch: 48, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.603 Vali Acc: 0.839 Test Loss: 0.603 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.263077735900879
Epoch: 49, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.1159048080444336
Epoch: 50, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.3872106075286865
Epoch: 51, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.2555465698242188
Epoch: 52, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.2422962188720703
Epoch: 53, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.0845963954925537
Epoch: 54, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.2879183292388916
Epoch: 55, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.609 Vali Acc: 0.856 Test Loss: 0.609 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.4640543460845947
Epoch: 56, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.614 Vali Acc: 0.867 Test Loss: 0.614 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 57 cost time: 2.9679408073425293
Epoch: 57, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.1623127460479736
Epoch: 58, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.2926533222198486
Epoch: 59, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.2007076740264893
Epoch: 60, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.2689480781555176
Epoch: 61, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.081080913543701
Epoch: 62, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.637 Vali Acc: 0.844 Test Loss: 0.637 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.377462148666382
Epoch: 63, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.649 Vali Acc: 0.839 Test Loss: 0.649 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.7209084033966064
Epoch: 64, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.6814181804656982
Epoch: 65, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.633284330368042
Epoch: 66, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.3991217613220215
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.711 Vali Acc: 0.083 Test Loss: 2.711 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 3.23032546043396
Epoch: 2, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.594 Vali Acc: 0.144 Test Loss: 2.594 Test Acc: 0.144
Validation loss decreased (-0.083306 --> -0.144419).  Saving model ...
Epoch: 3 cost time: 3.1277518272399902
Epoch: 3, Steps: 12 | Train Loss: 2.662 Vali Loss: 2.438 Vali Acc: 0.228 Test Loss: 2.438 Test Acc: 0.228
Validation loss decreased (-0.144419 --> -0.227753).  Saving model ...
Epoch: 4 cost time: 3.121197462081909
Epoch: 4, Steps: 12 | Train Loss: 2.630 Vali Loss: 2.279 Vali Acc: 0.306 Test Loss: 2.279 Test Acc: 0.306
Validation loss decreased (-0.227753 --> -0.305533).  Saving model ...
Epoch: 5 cost time: 2.9256486892700195
Epoch: 5, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.146 Vali Acc: 0.322 Test Loss: 2.146 Test Acc: 0.322
Validation loss decreased (-0.305533 --> -0.322201).  Saving model ...
Epoch: 6 cost time: 3.168215274810791
Epoch: 6, Steps: 12 | Train Loss: 2.428 Vali Loss: 2.031 Vali Acc: 0.344 Test Loss: 2.031 Test Acc: 0.344
Validation loss decreased (-0.322201 --> -0.344424).  Saving model ...
Epoch: 7 cost time: 2.879751205444336
Epoch: 7, Steps: 12 | Train Loss: 2.336 Vali Loss: 1.934 Vali Acc: 0.361 Test Loss: 1.934 Test Acc: 0.361
Validation loss decreased (-0.344424 --> -0.361092).  Saving model ...
Epoch: 8 cost time: 3.1012401580810547
Epoch: 8, Steps: 12 | Train Loss: 2.239 Vali Loss: 1.840 Vali Acc: 0.406 Test Loss: 1.840 Test Acc: 0.406
Validation loss decreased (-0.361092 --> -0.405537).  Saving model ...
Epoch: 9 cost time: 3.2555665969848633
Epoch: 9, Steps: 12 | Train Loss: 2.065 Vali Loss: 1.746 Vali Acc: 0.461 Test Loss: 1.746 Test Acc: 0.461
Validation loss decreased (-0.405537 --> -0.461094).  Saving model ...
Epoch: 10 cost time: 3.196305990219116
Epoch: 10, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.620 Vali Acc: 0.506 Test Loss: 1.620 Test Acc: 0.506
Validation loss decreased (-0.461094 --> -0.505539).  Saving model ...
Epoch: 11 cost time: 3.2214858531951904
Epoch: 11, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.530 Vali Acc: 0.506 Test Loss: 1.530 Test Acc: 0.506
Validation loss decreased (-0.505539 --> -0.505540).  Saving model ...
Epoch: 12 cost time: 2.9841015338897705
Epoch: 12, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.370 Vali Acc: 0.589 Test Loss: 1.370 Test Acc: 0.589
Validation loss decreased (-0.505540 --> -0.588875).  Saving model ...
Epoch: 13 cost time: 3.0894582271575928
Epoch: 13, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.226 Vali Acc: 0.622 Test Loss: 1.226 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622210).  Saving model ...
Epoch: 14 cost time: 3.2191739082336426
Epoch: 14, Steps: 12 | Train Loss: 1.077 Vali Loss: 1.112 Vali Acc: 0.644 Test Loss: 1.112 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644433).  Saving model ...
Epoch: 15 cost time: 2.8286983966827393
Epoch: 15, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.057 Vali Acc: 0.617 Test Loss: 1.057 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.019932746887207
Epoch: 16, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.966 Vali Acc: 0.683 Test Loss: 0.966 Test Acc: 0.683
Validation loss decreased (-0.644433 --> -0.683324).  Saving model ...
Epoch: 17 cost time: 3.0493221282958984
Epoch: 17, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.895 Vali Acc: 0.672 Test Loss: 0.895 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.876523494720459
Epoch: 18, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.827 Vali Acc: 0.706 Test Loss: 0.827 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705547).  Saving model ...
Epoch: 19 cost time: 2.751631021499634
Epoch: 19, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.752 Vali Acc: 0.739 Test Loss: 0.752 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738881).  Saving model ...
Epoch: 20 cost time: 2.9596052169799805
Epoch: 20, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.695 Vali Acc: 0.756 Test Loss: 0.695 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755549).  Saving model ...
Epoch: 21 cost time: 3.0871334075927734
Epoch: 21, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783327).  Saving model ...
Epoch: 22 cost time: 3.227818727493286
Epoch: 22, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.626 Vali Acc: 0.817 Test Loss: 0.626 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 3.3543684482574463
Epoch: 23, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.598 Vali Acc: 0.828 Test Loss: 0.598 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827772).  Saving model ...
Epoch: 24 cost time: 3.321328639984131
Epoch: 24, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
Validation loss decreased (-0.827772 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 2.9117393493652344
Epoch: 25, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 3.0316460132598877
Epoch: 26, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 3.254176139831543
Epoch: 27, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.528 Vali Acc: 0.867 Test Loss: 0.528 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.158808946609497
Epoch: 28, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 2.7944958209991455
Epoch: 29, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.523 Vali Acc: 0.867 Test Loss: 0.523 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.95261812210083
Epoch: 30, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.8587570190429688
Epoch: 31, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.504 Vali Acc: 0.867 Test Loss: 0.504 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 32 cost time: 3.136958360671997
Epoch: 32, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.0311334133148193
Epoch: 33, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.505 Vali Acc: 0.844 Test Loss: 0.505 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.889451503753662
Epoch: 34, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0014402866363525
Epoch: 35, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.519 Vali Acc: 0.872 Test Loss: 0.519 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872217).  Saving model ...
Epoch: 36 cost time: 3.2092232704162598
Epoch: 36, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.433884620666504
Epoch: 37, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.371831178665161
Epoch: 38, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.527 Vali Acc: 0.872 Test Loss: 0.527 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3966383934020996
Epoch: 39, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.393932342529297
Epoch: 40, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.544 Vali Acc: 0.872 Test Loss: 0.544 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.3004069328308105
Epoch: 41, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.3571088314056396
Epoch: 42, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.141181468963623
Epoch: 43, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.557 Vali Acc: 0.872 Test Loss: 0.557 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.095472812652588
Epoch: 44, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.540 Vali Acc: 0.872 Test Loss: 0.540 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.1240439414978027
Epoch: 45, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.541 Vali Acc: 0.878 Test Loss: 0.541 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 46 cost time: 2.9779717922210693
Epoch: 46, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.549 Vali Acc: 0.872 Test Loss: 0.549 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.9255943298339844
Epoch: 47, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.556 Vali Acc: 0.872 Test Loss: 0.556 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.209941864013672
Epoch: 48, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.3093478679656982
Epoch: 49, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.5235490798950195
Epoch: 50, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.596630811691284
Epoch: 51, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.872 Test Loss: 0.579 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.315640926361084
Epoch: 52, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 3.3922629356384277
Epoch: 53, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.2883505821228027
Epoch: 54, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.575 Vali Acc: 0.878 Test Loss: 0.575 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.0576589107513428
Epoch: 55, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.585 Vali Acc: 0.872 Test Loss: 0.585 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.403347969055176
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.0573813915252686
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 3.0812175273895264
Epoch: 3, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 4 cost time: 3.2372145652770996
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.244011640548706
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.262615919113159
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2506606578826904
Epoch: 7, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2509329319000244
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.311373472213745
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1981732845306396
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.281766653060913
Epoch: 11, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.1043107509613037
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.1067252159118652
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 206479
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1137683391571045
Epoch: 1, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.700 Vali Acc: 0.100 Test Loss: 2.700 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 3.2430191040039062
Epoch: 2, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.491 Vali Acc: 0.272 Test Loss: 2.491 Test Acc: 0.272
Validation loss decreased (-0.099973 --> -0.272197).  Saving model ...
Epoch: 3 cost time: 3.1684463024139404
Epoch: 3, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.253 Vali Acc: 0.489 Test Loss: 2.253 Test Acc: 0.489
Validation loss decreased (-0.272197 --> -0.488866).  Saving model ...
Epoch: 4 cost time: 3.1484274864196777
Epoch: 4, Steps: 12 | Train Loss: 2.158 Vali Loss: 2.034 Vali Acc: 0.556 Test Loss: 2.034 Test Acc: 0.556
Validation loss decreased (-0.488866 --> -0.555535).  Saving model ...
Epoch: 5 cost time: 3.0801334381103516
Epoch: 5, Steps: 12 | Train Loss: 1.981 Vali Loss: 1.846 Vali Acc: 0.556 Test Loss: 1.846 Test Acc: 0.556
Validation loss decreased (-0.555535 --> -0.555537).  Saving model ...
Epoch: 6 cost time: 3.124647617340088
Epoch: 6, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.661 Vali Acc: 0.606 Test Loss: 1.661 Test Acc: 0.606
Validation loss decreased (-0.555537 --> -0.605539).  Saving model ...
Epoch: 7 cost time: 3.178994655609131
Epoch: 7, Steps: 12 | Train Loss: 1.574 Vali Loss: 1.518 Vali Acc: 0.633 Test Loss: 1.518 Test Acc: 0.633
Validation loss decreased (-0.605539 --> -0.633318).  Saving model ...
Epoch: 8 cost time: 3.2865211963653564
Epoch: 8, Steps: 12 | Train Loss: 1.363 Vali Loss: 1.375 Vali Acc: 0.661 Test Loss: 1.375 Test Acc: 0.661
Validation loss decreased (-0.633318 --> -0.661097).  Saving model ...
Epoch: 9 cost time: 3.1172807216644287
Epoch: 9, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.273 Vali Acc: 0.683 Test Loss: 1.273 Test Acc: 0.683
Validation loss decreased (-0.661097 --> -0.683321).  Saving model ...
Epoch: 10 cost time: 2.9702260494232178
Epoch: 10, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.177 Vali Acc: 0.706 Test Loss: 1.177 Test Acc: 0.706
Validation loss decreased (-0.683321 --> -0.705544).  Saving model ...
Epoch: 11 cost time: 2.784771680831909
Epoch: 11, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8406291007995605
Epoch: 12, Steps: 12 | Train Loss: 0.886 Vali Loss: 1.066 Vali Acc: 0.711 Test Loss: 1.066 Test Acc: 0.711
Validation loss decreased (-0.705544 --> -0.711100).  Saving model ...
Epoch: 13 cost time: 2.72432279586792
Epoch: 13, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.986 Vali Acc: 0.733 Test Loss: 0.986 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 2.795884609222412
Epoch: 14, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.901 Vali Acc: 0.739 Test Loss: 0.901 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 15 cost time: 2.7801926136016846
Epoch: 15, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 2.7711966037750244
Epoch: 16, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.797 Vali Acc: 0.761 Test Loss: 0.797 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 17 cost time: 2.9437427520751953
Epoch: 17, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.745 Vali Acc: 0.778 Test Loss: 0.745 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 18 cost time: 2.9343583583831787
Epoch: 18, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788882).  Saving model ...
Epoch: 19 cost time: 2.906118869781494
Epoch: 19, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 2.9880950450897217
Epoch: 20, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.620 Vali Acc: 0.828 Test Loss: 0.620 Test Acc: 0.828
Validation loss decreased (-0.799993 --> -0.827772).  Saving model ...
Epoch: 21 cost time: 3.1659133434295654
Epoch: 21, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 22 cost time: 3.2029757499694824
Epoch: 22, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.559 Vali Acc: 0.828 Test Loss: 0.559 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7603299617767334
Epoch: 23, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.82305645942688
Epoch: 24, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8202919960021973
Epoch: 25, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.503 Vali Acc: 0.828 Test Loss: 0.503 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.9835925102233887
Epoch: 26, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.470 Vali Acc: 0.839 Test Loss: 0.470 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838884).  Saving model ...
Epoch: 27 cost time: 3.074291229248047
Epoch: 27, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.457 Vali Acc: 0.839 Test Loss: 0.457 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 28 cost time: 3.3565454483032227
Epoch: 28, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 29 cost time: 3.63791823387146
Epoch: 29, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849996).  Saving model ...
Epoch: 30 cost time: 3.517672538757324
Epoch: 30, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4041929244995117
Epoch: 31, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 32 cost time: 3.3344807624816895
Epoch: 32, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.411 Vali Acc: 0.872 Test Loss: 0.411 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 33 cost time: 3.473534345626831
Epoch: 33, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.391 Vali Acc: 0.872 Test Loss: 0.391 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 34 cost time: 3.5077006816864014
Epoch: 34, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.407 Vali Acc: 0.878 Test Loss: 0.407 Test Acc: 0.878
Validation loss decreased (-0.872218 --> -0.877774).  Saving model ...
Epoch: 35 cost time: 3.227993965148926
Epoch: 35, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.405 Vali Acc: 0.867 Test Loss: 0.405 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.9886598587036133
Epoch: 36, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888885).  Saving model ...
Epoch: 37 cost time: 3.118762254714966
Epoch: 37, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 38 cost time: 3.016298770904541
Epoch: 38, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.087106704711914
Epoch: 39, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.415 Vali Acc: 0.878 Test Loss: 0.415 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.2152059078216553
Epoch: 40, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.400 Vali Acc: 0.894 Test Loss: 0.400 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894440).  Saving model ...
Epoch: 41 cost time: 3.0230605602264404
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
Validation loss decreased (-0.894440 --> -0.905552).  Saving model ...
Epoch: 42 cost time: 3.3759262561798096
Epoch: 42, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.2721688747406006
Epoch: 43, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.087398052215576
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.427 Vali Acc: 0.883 Test Loss: 0.427 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.158188819885254
Epoch: 45, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.3034915924072266
Epoch: 46, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.30189847946167
Epoch: 47, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.0514721870422363
Epoch: 48, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.420 Vali Acc: 0.894 Test Loss: 0.420 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.9991233348846436
Epoch: 49, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.425 Vali Acc: 0.889 Test Loss: 0.425 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.062175989151001
Epoch: 50, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.0014431476593018
Epoch: 51, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.219252824783325
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.651 Vali Acc: 0.100 Test Loss: 2.651 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 2.9301679134368896
Epoch: 2, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.494 Vali Acc: 0.217 Test Loss: 2.494 Test Acc: 0.217
Validation loss decreased (-0.099973 --> -0.216642).  Saving model ...
Epoch: 3 cost time: 3.090280771255493
Epoch: 3, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.314 Vali Acc: 0.433 Test Loss: 2.314 Test Acc: 0.433
Validation loss decreased (-0.216642 --> -0.433310).  Saving model ...
Epoch: 4 cost time: 3.0285961627960205
Epoch: 4, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.145 Vali Acc: 0.517 Test Loss: 2.145 Test Acc: 0.517
Validation loss decreased (-0.433310 --> -0.516645).  Saving model ...
Epoch: 5 cost time: 3.1817736625671387
Epoch: 5, Steps: 12 | Train Loss: 2.115 Vali Loss: 1.993 Vali Acc: 0.561 Test Loss: 1.993 Test Acc: 0.561
Validation loss decreased (-0.516645 --> -0.561091).  Saving model ...
Epoch: 6 cost time: 2.9106976985931396
Epoch: 6, Steps: 12 | Train Loss: 1.902 Vali Loss: 1.839 Vali Acc: 0.567 Test Loss: 1.839 Test Acc: 0.567
Validation loss decreased (-0.561091 --> -0.566648).  Saving model ...
Epoch: 7 cost time: 2.8004932403564453
Epoch: 7, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.706 Vali Acc: 0.578 Test Loss: 1.706 Test Acc: 0.578
Validation loss decreased (-0.566648 --> -0.577761).  Saving model ...
Epoch: 8 cost time: 2.590078115463257
Epoch: 8, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.565 Vali Acc: 0.617 Test Loss: 1.565 Test Acc: 0.617
Validation loss decreased (-0.577761 --> -0.616651).  Saving model ...
Epoch: 9 cost time: 3.1867659091949463
Epoch: 9, Steps: 12 | Train Loss: 1.500 Vali Loss: 1.458 Vali Acc: 0.622 Test Loss: 1.458 Test Acc: 0.622
Validation loss decreased (-0.616651 --> -0.622208).  Saving model ...
Epoch: 10 cost time: 3.3337302207946777
Epoch: 10, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.369 Vali Acc: 0.633 Test Loss: 1.369 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633320).  Saving model ...
Epoch: 11 cost time: 2.9572606086730957
Epoch: 11, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.308 Vali Acc: 0.611 Test Loss: 1.308 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1860203742980957
Epoch: 12, Steps: 12 | Train Loss: 1.135 Vali Loss: 1.247 Vali Acc: 0.633 Test Loss: 1.247 Test Acc: 0.633
Validation loss decreased (-0.633320 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 2.9102976322174072
Epoch: 13, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.160 Vali Acc: 0.661 Test Loss: 1.160 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 14 cost time: 3.281862497329712
Epoch: 14, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.086 Vali Acc: 0.661 Test Loss: 1.086 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661100).  Saving model ...
Epoch: 15 cost time: 3.2581276893615723
Epoch: 15, Steps: 12 | Train Loss: 0.891 Vali Loss: 1.016 Vali Acc: 0.700 Test Loss: 1.016 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 3.2875030040740967
Epoch: 16, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.971 Vali Acc: 0.689 Test Loss: 0.971 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.162645101547241
Epoch: 17, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.924 Vali Acc: 0.728 Test Loss: 0.924 Test Acc: 0.728
Validation loss decreased (-0.699990 --> -0.727769).  Saving model ...
Epoch: 18 cost time: 3.2761588096618652
Epoch: 18, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 19 cost time: 3.223113536834717
Epoch: 19, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 3.5052812099456787
Epoch: 20, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.765 Vali Acc: 0.772 Test Loss: 0.765 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772215).  Saving model ...
Epoch: 21 cost time: 2.853902816772461
Epoch: 21, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.717 Vali Acc: 0.800 Test Loss: 0.717 Test Acc: 0.800
Validation loss decreased (-0.772215 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 3.152571439743042
Epoch: 22, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.685 Vali Acc: 0.811 Test Loss: 0.685 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 23 cost time: 3.078960657119751
Epoch: 23, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 3.1356852054595947
Epoch: 24, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.651 Vali Acc: 0.817 Test Loss: 0.651 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9969773292541504
Epoch: 25, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.610 Vali Acc: 0.839 Test Loss: 0.610 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 3.0075721740722656
Epoch: 26, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0962557792663574
Epoch: 27, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.584 Vali Acc: 0.822 Test Loss: 0.584 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.33060884475708
Epoch: 28, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.546 Vali Acc: 0.839 Test Loss: 0.546 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 29 cost time: 3.240001916885376
Epoch: 29, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.2886431217193604
Epoch: 30, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
Validation loss decreased (-0.838883 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 3.1425065994262695
Epoch: 31, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 32 cost time: 3.2703866958618164
Epoch: 32, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 3.2075412273406982
Epoch: 33, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 3.2662298679351807
Epoch: 34, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.024254322052002
Epoch: 35, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.499 Vali Acc: 0.872 Test Loss: 0.499 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.998234510421753
Epoch: 36, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.530 Vali Acc: 0.883 Test Loss: 0.530 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 37 cost time: 3.0454823970794678
Epoch: 37, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 38 cost time: 3.1874327659606934
Epoch: 38, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.477 Vali Acc: 0.878 Test Loss: 0.477 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.0566563606262207
Epoch: 39, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.496 Vali Acc: 0.872 Test Loss: 0.496 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.329716682434082
Epoch: 40, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.489 Vali Acc: 0.883 Test Loss: 0.489 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.2451305389404297
Epoch: 41, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.489 Vali Acc: 0.878 Test Loss: 0.489 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.4305248260498047
Epoch: 42, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.516 Vali Acc: 0.883 Test Loss: 0.516 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.548941135406494
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.512 Vali Acc: 0.894 Test Loss: 0.512 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894439).  Saving model ...
Epoch: 44 cost time: 3.5168254375457764
Epoch: 44, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.5433027744293213
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.564455986022949
Epoch: 46, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.504 Vali Acc: 0.883 Test Loss: 0.504 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.5992515087127686
Epoch: 47, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.517 Vali Acc: 0.883 Test Loss: 0.517 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.2317280769348145
Epoch: 48, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.506 Vali Acc: 0.883 Test Loss: 0.506 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.1852736473083496
Epoch: 49, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.891881227493286
Epoch: 50, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.471 Vali Acc: 0.894 Test Loss: 0.471 Test Acc: 0.894
Validation loss decreased (-0.894439 --> -0.894440).  Saving model ...
Epoch: 51 cost time: 3.0201263427734375
Epoch: 51, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.495 Vali Acc: 0.883 Test Loss: 0.495 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.179114818572998
Epoch: 52, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.116811990737915
Epoch: 53, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.498 Vali Acc: 0.894 Test Loss: 0.498 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.1187620162963867
Epoch: 54, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.489 Vali Acc: 0.894 Test Loss: 0.489 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.1412744522094727
Epoch: 55, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.522 Vali Acc: 0.883 Test Loss: 0.522 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.4263463020324707
Epoch: 56, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.515 Vali Acc: 0.883 Test Loss: 0.515 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.2071406841278076
Epoch: 57, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.253383159637451
Epoch: 58, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.233719825744629
Epoch: 59, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.516 Vali Acc: 0.894 Test Loss: 0.516 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 3.276766777038574
Epoch: 60, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9631917476654053
Epoch: 1, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.637 Vali Acc: 0.100 Test Loss: 2.637 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 2.6671316623687744
Epoch: 2, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.525 Vali Acc: 0.167 Test Loss: 2.525 Test Acc: 0.167
Validation loss decreased (-0.099974 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 2.6108410358428955
Epoch: 3, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.389 Vali Acc: 0.317 Test Loss: 2.389 Test Acc: 0.317
Validation loss decreased (-0.166641 --> -0.316643).  Saving model ...
Epoch: 4 cost time: 2.9014811515808105
Epoch: 4, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.256 Vali Acc: 0.367 Test Loss: 2.256 Test Acc: 0.367
Validation loss decreased (-0.316643 --> -0.366644).  Saving model ...
Epoch: 5 cost time: 2.7995240688323975
Epoch: 5, Steps: 12 | Train Loss: 2.236 Vali Loss: 2.131 Vali Acc: 0.444 Test Loss: 2.131 Test Acc: 0.444
Validation loss decreased (-0.366644 --> -0.444423).  Saving model ...
Epoch: 6 cost time: 2.665982246398926
Epoch: 6, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.009 Vali Acc: 0.439 Test Loss: 2.009 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1034111976623535
Epoch: 7, Steps: 12 | Train Loss: 1.982 Vali Loss: 1.908 Vali Acc: 0.472 Test Loss: 1.908 Test Acc: 0.472
Validation loss decreased (-0.444423 --> -0.472203).  Saving model ...
Epoch: 8 cost time: 2.962491750717163
Epoch: 8, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.797 Vali Acc: 0.456 Test Loss: 1.797 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.934581756591797
Epoch: 9, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.703 Vali Acc: 0.494 Test Loss: 1.703 Test Acc: 0.494
Validation loss decreased (-0.472203 --> -0.494427).  Saving model ...
Epoch: 10 cost time: 2.983276844024658
Epoch: 10, Steps: 12 | Train Loss: 1.610 Vali Loss: 1.614 Vali Acc: 0.561 Test Loss: 1.614 Test Acc: 0.561
Validation loss decreased (-0.494427 --> -0.561095).  Saving model ...
Epoch: 11 cost time: 2.917048215866089
Epoch: 11, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.553 Vali Acc: 0.572 Test Loss: 1.553 Test Acc: 0.572
Validation loss decreased (-0.561095 --> -0.572207).  Saving model ...
Epoch: 12 cost time: 3.036653518676758
Epoch: 12, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.486 Vali Acc: 0.572 Test Loss: 1.486 Test Acc: 0.572
Validation loss decreased (-0.572207 --> -0.572207).  Saving model ...
Epoch: 13 cost time: 3.1574172973632812
Epoch: 13, Steps: 12 | Train Loss: 1.336 Vali Loss: 1.413 Vali Acc: 0.600 Test Loss: 1.413 Test Acc: 0.600
Validation loss decreased (-0.572207 --> -0.599986).  Saving model ...
Epoch: 14 cost time: 3.031521797180176
Epoch: 14, Steps: 12 | Train Loss: 1.175 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 15 cost time: 2.916536808013916
Epoch: 15, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.249 Vali Acc: 0.639 Test Loss: 1.249 Test Acc: 0.639
Validation loss decreased (-0.599987 --> -0.638876).  Saving model ...
Epoch: 16 cost time: 3.16087007522583
Epoch: 16, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.180 Vali Acc: 0.644 Test Loss: 1.180 Test Acc: 0.644
Validation loss decreased (-0.638876 --> -0.644433).  Saving model ...
Epoch: 17 cost time: 3.2076668739318848
Epoch: 17, Steps: 12 | Train Loss: 0.923 Vali Loss: 1.129 Vali Acc: 0.667 Test Loss: 1.129 Test Acc: 0.667
Validation loss decreased (-0.644433 --> -0.666655).  Saving model ...
Epoch: 18 cost time: 2.9646451473236084
Epoch: 18, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.057 Vali Acc: 0.689 Test Loss: 1.057 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 19 cost time: 2.881784677505493
Epoch: 19, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.993 Vali Acc: 0.700 Test Loss: 0.993 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 20 cost time: 3.054612159729004
Epoch: 20, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.938 Vali Acc: 0.733 Test Loss: 0.938 Test Acc: 0.733
Validation loss decreased (-0.699990 --> -0.733324).  Saving model ...
Epoch: 21 cost time: 3.1520509719848633
Epoch: 21, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.879 Vali Acc: 0.744 Test Loss: 0.879 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 22 cost time: 3.167207717895508
Epoch: 22, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.826 Vali Acc: 0.772 Test Loss: 0.826 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772214).  Saving model ...
Epoch: 23 cost time: 2.9490323066711426
Epoch: 23, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.797 Vali Acc: 0.767 Test Loss: 0.797 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.225200891494751
Epoch: 24, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.772214 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 3.063594341278076
Epoch: 25, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 3.2625815868377686
Epoch: 26, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.710 Vali Acc: 0.800 Test Loss: 0.710 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 3.2294957637786865
Epoch: 27, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.697 Vali Acc: 0.789 Test Loss: 0.697 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.051928997039795
Epoch: 28, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
Validation loss decreased (-0.799993 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 3.0607104301452637
Epoch: 29, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.654 Vali Acc: 0.806 Test Loss: 0.654 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.263828992843628
Epoch: 30, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 31 cost time: 2.9300286769866943
Epoch: 31, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.633 Vali Acc: 0.817 Test Loss: 0.633 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.016817569732666
Epoch: 32, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 3.0264687538146973
Epoch: 33, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.118363380432129
Epoch: 34, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 35 cost time: 3.078385353088379
Epoch: 35, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.563 Vali Acc: 0.833 Test Loss: 0.563 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.143439769744873
Epoch: 36, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 37 cost time: 3.053514003753662
Epoch: 37, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.551 Vali Acc: 0.839 Test Loss: 0.551 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.9792420864105225
Epoch: 38, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.094874382019043
Epoch: 39, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.572 Vali Acc: 0.839 Test Loss: 0.572 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.957606792449951
Epoch: 40, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.9841420650482178
Epoch: 41, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.9519219398498535
Epoch: 42, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.908907413482666
Epoch: 43, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 44 cost time: 2.944535493850708
Epoch: 44, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.554 Vali Acc: 0.839 Test Loss: 0.554 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.7110910415649414
Epoch: 45, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.7776176929473877
Epoch: 46, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.555 Vali Acc: 0.844 Test Loss: 0.555 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.8131392002105713
Epoch: 47, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.554 Vali Acc: 0.828 Test Loss: 0.554 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.6366264820098877
Epoch: 48, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.017606258392334
Epoch: 49, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.991018533706665
Epoch: 50, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.546 Vali Acc: 0.839 Test Loss: 0.546 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.2239789962768555
Epoch: 51, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.0850260257720947
Epoch: 52, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.545 Vali Acc: 0.839 Test Loss: 0.545 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.1699728965759277
Epoch: 53, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.047874450683594
Epoch: 1, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.700 Vali Acc: 0.106 Test Loss: 2.700 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 3.157090663909912
Epoch: 2, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.621 Vali Acc: 0.156 Test Loss: 2.621 Test Acc: 0.156
Validation loss decreased (-0.105529 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 3.2151384353637695
Epoch: 3, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.528 Vali Acc: 0.244 Test Loss: 2.528 Test Acc: 0.244
Validation loss decreased (-0.155529 --> -0.244419).  Saving model ...
Epoch: 4 cost time: 3.0398366451263428
Epoch: 4, Steps: 12 | Train Loss: 2.477 Vali Loss: 2.441 Vali Acc: 0.250 Test Loss: 2.441 Test Acc: 0.250
Validation loss decreased (-0.244419 --> -0.249976).  Saving model ...
Epoch: 5 cost time: 2.9974942207336426
Epoch: 5, Steps: 12 | Train Loss: 2.405 Vali Loss: 2.355 Vali Acc: 0.317 Test Loss: 2.355 Test Acc: 0.317
Validation loss decreased (-0.249976 --> -0.316643).  Saving model ...
Epoch: 6 cost time: 3.296736001968384
Epoch: 6, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.265 Vali Acc: 0.361 Test Loss: 2.265 Test Acc: 0.361
Validation loss decreased (-0.316643 --> -0.361088).  Saving model ...
Epoch: 7 cost time: 3.314856767654419
Epoch: 7, Steps: 12 | Train Loss: 2.249 Vali Loss: 2.188 Vali Acc: 0.383 Test Loss: 2.188 Test Acc: 0.383
Validation loss decreased (-0.361088 --> -0.383311).  Saving model ...
Epoch: 8 cost time: 3.281350612640381
Epoch: 8, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.085 Vali Acc: 0.372 Test Loss: 2.085 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2969493865966797
Epoch: 9, Steps: 12 | Train Loss: 2.067 Vali Loss: 1.979 Vali Acc: 0.350 Test Loss: 1.979 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4226527214050293
Epoch: 10, Steps: 12 | Train Loss: 1.937 Vali Loss: 1.876 Vali Acc: 0.428 Test Loss: 1.876 Test Acc: 0.428
Validation loss decreased (-0.383311 --> -0.427759).  Saving model ...
Epoch: 11 cost time: 3.165992021560669
Epoch: 11, Steps: 12 | Train Loss: 1.844 Vali Loss: 1.783 Vali Acc: 0.478 Test Loss: 1.783 Test Acc: 0.478
Validation loss decreased (-0.427759 --> -0.477760).  Saving model ...
Epoch: 12 cost time: 3.183642864227295
Epoch: 12, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.684 Vali Acc: 0.483 Test Loss: 1.684 Test Acc: 0.483
Validation loss decreased (-0.477760 --> -0.483316).  Saving model ...
Epoch: 13 cost time: 3.149024486541748
Epoch: 13, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.555 Vali Acc: 0.517 Test Loss: 1.555 Test Acc: 0.517
Validation loss decreased (-0.483316 --> -0.516651).  Saving model ...
Epoch: 14 cost time: 3.2142670154571533
Epoch: 14, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.417 Vali Acc: 0.561 Test Loss: 1.417 Test Acc: 0.561
Validation loss decreased (-0.516651 --> -0.561097).  Saving model ...
Epoch: 15 cost time: 3.1287364959716797
Epoch: 15, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.306 Vali Acc: 0.617 Test Loss: 1.306 Test Acc: 0.617
Validation loss decreased (-0.561097 --> -0.616654).  Saving model ...
Epoch: 16 cost time: 2.833889961242676
Epoch: 16, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622210).  Saving model ...
Epoch: 17 cost time: 3.0156548023223877
Epoch: 17, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.139 Vali Acc: 0.633 Test Loss: 1.139 Test Acc: 0.633
Validation loss decreased (-0.622210 --> -0.633322).  Saving model ...
Epoch: 18 cost time: 3.1678626537323
Epoch: 18, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.047 Vali Acc: 0.644 Test Loss: 1.047 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644434).  Saving model ...
Epoch: 19 cost time: 2.9073917865753174
Epoch: 19, Steps: 12 | Train Loss: 0.869 Vali Loss: 0.984 Vali Acc: 0.678 Test Loss: 0.984 Test Acc: 0.678
Validation loss decreased (-0.644434 --> -0.677768).  Saving model ...
Epoch: 20 cost time: 3.129575490951538
Epoch: 20, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.929 Vali Acc: 0.689 Test Loss: 0.929 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 21 cost time: 2.9592719078063965
Epoch: 21, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711102).  Saving model ...
Epoch: 22 cost time: 3.2554545402526855
Epoch: 22, Steps: 12 | Train Loss: 0.651 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 23 cost time: 3.17592453956604
Epoch: 23, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.796 Vali Acc: 0.728 Test Loss: 0.796 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 24 cost time: 3.2979376316070557
Epoch: 24, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.749 Vali Acc: 0.733 Test Loss: 0.749 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 25 cost time: 3.4184768199920654
Epoch: 25, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 26 cost time: 3.3743607997894287
Epoch: 26, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.719 Vali Acc: 0.733 Test Loss: 0.719 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.169921636581421
Epoch: 27, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.707 Vali Acc: 0.756 Test Loss: 0.707 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 2.6717047691345215
Epoch: 28, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.680 Vali Acc: 0.772 Test Loss: 0.680 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 29 cost time: 3.0366528034210205
Epoch: 29, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772216).  Saving model ...
Epoch: 30 cost time: 3.022367000579834
Epoch: 30, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.615 Vali Acc: 0.772 Test Loss: 0.615 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 31 cost time: 3.182114601135254
Epoch: 31, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9445507526397705
Epoch: 32, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.610 Vali Acc: 0.794 Test Loss: 0.610 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794438).  Saving model ...
Epoch: 33 cost time: 3.50813889503479
Epoch: 33, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.594 Vali Acc: 0.794 Test Loss: 0.594 Test Acc: 0.794
Validation loss decreased (-0.794438 --> -0.794439).  Saving model ...
Epoch: 34 cost time: 3.504629135131836
Epoch: 34, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.578 Vali Acc: 0.811 Test Loss: 0.578 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811105).  Saving model ...
Epoch: 35 cost time: 3.322467565536499
Epoch: 35, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.556 Vali Acc: 0.806 Test Loss: 0.556 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.4201841354370117
Epoch: 36, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.575 Vali Acc: 0.806 Test Loss: 0.575 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.376272201538086
Epoch: 37, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 38 cost time: 3.223517417907715
Epoch: 38, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.546 Vali Acc: 0.828 Test Loss: 0.546 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.3999483585357666
Epoch: 39, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.551 Vali Acc: 0.811 Test Loss: 0.551 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.156177043914795
Epoch: 40, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.529 Vali Acc: 0.828 Test Loss: 0.529 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 41 cost time: 3.300938844680786
Epoch: 41, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 42 cost time: 3.131335735321045
Epoch: 42, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.542 Vali Acc: 0.828 Test Loss: 0.542 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.3169517517089844
Epoch: 43, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.539 Vali Acc: 0.839 Test Loss: 0.539 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.4277567863464355
Epoch: 44, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 2.9873108863830566
Epoch: 45, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2920055389404297
Epoch: 46, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.520 Vali Acc: 0.828 Test Loss: 0.520 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.4207024574279785
Epoch: 47, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.456573009490967
Epoch: 48, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 49 cost time: 3.3063483238220215
Epoch: 49, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.399202585220337
Epoch: 50, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.521 Vali Acc: 0.867 Test Loss: 0.521 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 51 cost time: 3.3697855472564697
Epoch: 51, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.2169716358184814
Epoch: 52, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.037400484085083
Epoch: 53, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.8662757873535156
Epoch: 54, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.081207275390625
Epoch: 55, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 56 cost time: 3.006760835647583
Epoch: 56, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 57 cost time: 3.044374942779541
Epoch: 57, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.535 Vali Acc: 0.872 Test Loss: 0.535 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.922639846801758
Epoch: 58, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.0954880714416504
Epoch: 59, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.050408124923706
Epoch: 60, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.9926912784576416
Epoch: 61, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.513 Vali Acc: 0.883 Test Loss: 0.513 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 62 cost time: 3.2527565956115723
Epoch: 62, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.531 Vali Acc: 0.883 Test Loss: 0.531 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.1873083114624023
Epoch: 63, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.530 Vali Acc: 0.867 Test Loss: 0.530 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.1333420276641846
Epoch: 64, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.521 Vali Acc: 0.872 Test Loss: 0.521 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.198390483856201
Epoch: 65, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
Validation loss decreased (-0.883328 --> -0.888884).  Saving model ...
Epoch: 66 cost time: 3.3503315448760986
Epoch: 66, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.528 Vali Acc: 0.872 Test Loss: 0.528 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.202302932739258
Epoch: 67, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.2525267601013184
Epoch: 68, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.539 Vali Acc: 0.883 Test Loss: 0.539 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.107032060623169
Epoch: 69, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 70 cost time: 3.342390775680542
Epoch: 70, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 3.287508010864258
Epoch: 71, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.534 Vali Acc: 0.872 Test Loss: 0.534 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 3.1294450759887695
Epoch: 72, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.551 Vali Acc: 0.889 Test Loss: 0.551 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 3.105224370956421
Epoch: 73, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.550 Vali Acc: 0.889 Test Loss: 0.550 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 3.2879745960235596
Epoch: 74, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.568 Vali Acc: 0.889 Test Loss: 0.568 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 3.084136962890625
Epoch: 75, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.538 Vali Acc: 0.883 Test Loss: 0.538 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 3.2411749362945557
Epoch: 76, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.573 Vali Acc: 0.883 Test Loss: 0.573 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 2.996699571609497
Epoch: 77, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 3.22278094291687
Epoch: 78, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 3.310455799102783
Epoch: 79, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.534 Vali Acc: 0.883 Test Loss: 0.534 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.201902151107788
Epoch: 1, Steps: 12 | Train Loss: 2.728 Vali Loss: 2.723 Vali Acc: 0.067 Test Loss: 2.723 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 3.004631757736206
Epoch: 2, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.670 Vali Acc: 0.083 Test Loss: 2.670 Test Acc: 0.083
Validation loss decreased (-0.066639 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 3.0009517669677734
Epoch: 3, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.592 Vali Acc: 0.122 Test Loss: 2.592 Test Acc: 0.122
Validation loss decreased (-0.083307 --> -0.122196).  Saving model ...
Epoch: 4 cost time: 2.958446502685547
Epoch: 4, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.508 Vali Acc: 0.167 Test Loss: 2.508 Test Acc: 0.167
Validation loss decreased (-0.122196 --> -0.166642).  Saving model ...
Epoch: 5 cost time: 3.3087425231933594
Epoch: 5, Steps: 12 | Train Loss: 2.522 Vali Loss: 2.430 Vali Acc: 0.217 Test Loss: 2.430 Test Acc: 0.217
Validation loss decreased (-0.166642 --> -0.216642).  Saving model ...
Epoch: 6 cost time: 3.18149995803833
Epoch: 6, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.349 Vali Acc: 0.278 Test Loss: 2.349 Test Acc: 0.278
Validation loss decreased (-0.216642 --> -0.277754).  Saving model ...
Epoch: 7 cost time: 3.0638015270233154
Epoch: 7, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.275 Vali Acc: 0.333 Test Loss: 2.275 Test Acc: 0.333
Validation loss decreased (-0.277754 --> -0.333311).  Saving model ...
Epoch: 8 cost time: 2.9823250770568848
Epoch: 8, Steps: 12 | Train Loss: 2.323 Vali Loss: 2.189 Vali Acc: 0.333 Test Loss: 2.189 Test Acc: 0.333
Validation loss decreased (-0.333311 --> -0.333311).  Saving model ...
Epoch: 9 cost time: 3.1619277000427246
Epoch: 9, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.101 Vali Acc: 0.333 Test Loss: 2.101 Test Acc: 0.333
Validation loss decreased (-0.333311 --> -0.333312).  Saving model ...
Epoch: 10 cost time: 3.100395679473877
Epoch: 10, Steps: 12 | Train Loss: 2.177 Vali Loss: 2.009 Vali Acc: 0.350 Test Loss: 2.009 Test Acc: 0.350
Validation loss decreased (-0.333312 --> -0.349980).  Saving model ...
Epoch: 11 cost time: 3.1415090560913086
Epoch: 11, Steps: 12 | Train Loss: 2.038 Vali Loss: 1.918 Vali Acc: 0.383 Test Loss: 1.918 Test Acc: 0.383
Validation loss decreased (-0.349980 --> -0.383314).  Saving model ...
Epoch: 12 cost time: 2.9638092517852783
Epoch: 12, Steps: 12 | Train Loss: 1.949 Vali Loss: 1.848 Vali Acc: 0.406 Test Loss: 1.848 Test Acc: 0.406
Validation loss decreased (-0.383314 --> -0.405537).  Saving model ...
Epoch: 13 cost time: 3.118727445602417
Epoch: 13, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.759 Vali Acc: 0.422 Test Loss: 1.759 Test Acc: 0.422
Validation loss decreased (-0.405537 --> -0.422205).  Saving model ...
Epoch: 14 cost time: 3.266089916229248
Epoch: 14, Steps: 12 | Train Loss: 1.687 Vali Loss: 1.632 Vali Acc: 0.483 Test Loss: 1.632 Test Acc: 0.483
Validation loss decreased (-0.422205 --> -0.483317).  Saving model ...
Epoch: 15 cost time: 2.9298040866851807
Epoch: 15, Steps: 12 | Train Loss: 1.677 Vali Loss: 1.532 Vali Acc: 0.533 Test Loss: 1.532 Test Acc: 0.533
Validation loss decreased (-0.483317 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 3.0049822330474854
Epoch: 16, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.440 Vali Acc: 0.611 Test Loss: 1.440 Test Acc: 0.611
Validation loss decreased (-0.533318 --> -0.611097).  Saving model ...
Epoch: 17 cost time: 2.8834919929504395
Epoch: 17, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.058112621307373
Epoch: 18, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.260 Vali Acc: 0.628 Test Loss: 1.260 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627765).  Saving model ...
Epoch: 19 cost time: 3.1700050830841064
Epoch: 19, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.166 Vali Acc: 0.694 Test Loss: 1.166 Test Acc: 0.694
Validation loss decreased (-0.627765 --> -0.694433).  Saving model ...
Epoch: 20 cost time: 3.170276641845703
Epoch: 20, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.078 Vali Acc: 0.694 Test Loss: 1.078 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694434).  Saving model ...
Epoch: 21 cost time: 3.3580496311187744
Epoch: 21, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.012 Vali Acc: 0.678 Test Loss: 1.012 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2120003700256348
Epoch: 22, Steps: 12 | Train Loss: 0.849 Vali Loss: 0.926 Vali Acc: 0.706 Test Loss: 0.926 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705546).  Saving model ...
Epoch: 23 cost time: 3.3613195419311523
Epoch: 23, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 3.348989963531494
Epoch: 24, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.817 Vali Acc: 0.728 Test Loss: 0.817 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727770).  Saving model ...
Epoch: 25 cost time: 3.0590078830718994
Epoch: 25, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.771 Vali Acc: 0.744 Test Loss: 0.771 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 3.0572502613067627
Epoch: 26, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.740 Vali Acc: 0.750 Test Loss: 0.740 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 27 cost time: 3.0543651580810547
Epoch: 27, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.703 Vali Acc: 0.756 Test Loss: 0.703 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 28 cost time: 3.0635695457458496
Epoch: 28, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.683 Vali Acc: 0.761 Test Loss: 0.683 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761104).  Saving model ...
Epoch: 29 cost time: 3.110773801803589
Epoch: 29, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.647 Vali Acc: 0.778 Test Loss: 0.647 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 30 cost time: 3.2014358043670654
Epoch: 30, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.622 Vali Acc: 0.778 Test Loss: 0.622 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777772).  Saving model ...
Epoch: 31 cost time: 3.1639444828033447
Epoch: 31, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.617 Vali Acc: 0.767 Test Loss: 0.617 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1989645957946777
Epoch: 32, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.592 Vali Acc: 0.794 Test Loss: 0.592 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794439).  Saving model ...
Epoch: 33 cost time: 3.2977049350738525
Epoch: 33, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.578 Vali Acc: 0.806 Test Loss: 0.578 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805550).  Saving model ...
Epoch: 34 cost time: 3.2164642810821533
Epoch: 34, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.548 Vali Acc: 0.811 Test Loss: 0.548 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811106).  Saving model ...
Epoch: 35 cost time: 3.3548831939697266
Epoch: 35, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.553 Vali Acc: 0.811 Test Loss: 0.553 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.560213804244995
Epoch: 36, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.543 Vali Acc: 0.794 Test Loss: 0.543 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.215097188949585
Epoch: 37, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.537 Vali Acc: 0.800 Test Loss: 0.537 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.0903244018554688
Epoch: 38, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 39 cost time: 3.0856568813323975
Epoch: 39, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 40 cost time: 3.0128612518310547
Epoch: 40, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 41 cost time: 3.106177806854248
Epoch: 41, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.507 Vali Acc: 0.828 Test Loss: 0.507 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.2080442905426025
Epoch: 42, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.525 Vali Acc: 0.839 Test Loss: 0.525 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.0451042652130127
Epoch: 43, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.503 Vali Acc: 0.828 Test Loss: 0.503 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.2618701457977295
Epoch: 44, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.257242441177368
Epoch: 45, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.3857030868530273
Epoch: 46, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.4596049785614014
Epoch: 47, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.3896915912628174
Epoch: 48, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.058546781539917
Epoch: 49, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.7683846950531006
Epoch: 50, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.150548934936523
Epoch: 1, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.775 Vali Acc: 0.056 Test Loss: 2.775 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 3.140237808227539
Epoch: 2, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.675 Vali Acc: 0.094 Test Loss: 2.675 Test Acc: 0.094
Validation loss decreased (-0.055528 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 3.0591766834259033
Epoch: 3, Steps: 12 | Train Loss: 2.695 Vali Loss: 2.554 Vali Acc: 0.139 Test Loss: 2.554 Test Acc: 0.139
Validation loss decreased (-0.094418 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 3.055675983428955
Epoch: 4, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.439 Vali Acc: 0.211 Test Loss: 2.439 Test Acc: 0.211
Validation loss decreased (-0.138863 --> -0.211087).  Saving model ...
Epoch: 5 cost time: 2.9229304790496826
Epoch: 5, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.341 Vali Acc: 0.250 Test Loss: 2.341 Test Acc: 0.250
Validation loss decreased (-0.211087 --> -0.249977).  Saving model ...
Epoch: 6 cost time: 3.12583327293396
Epoch: 6, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.257 Vali Acc: 0.278 Test Loss: 2.257 Test Acc: 0.278
Validation loss decreased (-0.249977 --> -0.277755).  Saving model ...
Epoch: 7 cost time: 3.124131679534912
Epoch: 7, Steps: 12 | Train Loss: 2.465 Vali Loss: 2.198 Vali Acc: 0.283 Test Loss: 2.198 Test Acc: 0.283
Validation loss decreased (-0.277755 --> -0.283311).  Saving model ...
Epoch: 8 cost time: 3.1412642002105713
Epoch: 8, Steps: 12 | Train Loss: 2.390 Vali Loss: 2.137 Vali Acc: 0.322 Test Loss: 2.137 Test Acc: 0.322
Validation loss decreased (-0.283311 --> -0.322201).  Saving model ...
Epoch: 9 cost time: 3.232896327972412
Epoch: 9, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.082 Vali Acc: 0.300 Test Loss: 2.082 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0484819412231445
Epoch: 10, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.038 Vali Acc: 0.311 Test Loss: 2.038 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0241074562072754
Epoch: 11, Steps: 12 | Train Loss: 2.149 Vali Loss: 1.978 Vali Acc: 0.356 Test Loss: 1.978 Test Acc: 0.356
Validation loss decreased (-0.322201 --> -0.355536).  Saving model ...
Epoch: 12 cost time: 3.1710283756256104
Epoch: 12, Steps: 12 | Train Loss: 2.060 Vali Loss: 1.897 Vali Acc: 0.378 Test Loss: 1.897 Test Acc: 0.378
Validation loss decreased (-0.355536 --> -0.377759).  Saving model ...
Epoch: 13 cost time: 3.020056962966919
Epoch: 13, Steps: 12 | Train Loss: 1.888 Vali Loss: 1.812 Vali Acc: 0.411 Test Loss: 1.812 Test Acc: 0.411
Validation loss decreased (-0.377759 --> -0.411093).  Saving model ...
Epoch: 14 cost time: 3.112405776977539
Epoch: 14, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.716 Vali Acc: 0.428 Test Loss: 1.716 Test Acc: 0.428
Validation loss decreased (-0.411093 --> -0.427761).  Saving model ...
Epoch: 15 cost time: 2.9464364051818848
Epoch: 15, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.617 Vali Acc: 0.511 Test Loss: 1.617 Test Acc: 0.511
Validation loss decreased (-0.427761 --> -0.511095).  Saving model ...
Epoch: 16 cost time: 3.086963415145874
Epoch: 16, Steps: 12 | Train Loss: 1.512 Vali Loss: 1.487 Vali Acc: 0.539 Test Loss: 1.487 Test Acc: 0.539
Validation loss decreased (-0.511095 --> -0.538874).  Saving model ...
Epoch: 17 cost time: 3.2868967056274414
Epoch: 17, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.387 Vali Acc: 0.578 Test Loss: 1.387 Test Acc: 0.578
Validation loss decreased (-0.538874 --> -0.577764).  Saving model ...
Epoch: 18 cost time: 3.15651273727417
Epoch: 18, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
Validation loss decreased (-0.577764 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 3.1884801387786865
Epoch: 19, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.197 Vali Acc: 0.633 Test Loss: 1.197 Test Acc: 0.633
Validation loss decreased (-0.599987 --> -0.633321).  Saving model ...
Epoch: 20 cost time: 3.1619293689727783
Epoch: 20, Steps: 12 | Train Loss: 1.046 Vali Loss: 1.132 Vali Acc: 0.661 Test Loss: 1.132 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661100).  Saving model ...
Epoch: 21 cost time: 3.145282745361328
Epoch: 21, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.068 Vali Acc: 0.672 Test Loss: 1.068 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 22 cost time: 3.259945869445801
Epoch: 22, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.988 Vali Acc: 0.683 Test Loss: 0.988 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683323).  Saving model ...
Epoch: 23 cost time: 2.952186107635498
Epoch: 23, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.951 Vali Acc: 0.678 Test Loss: 0.951 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9334402084350586
Epoch: 24, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699991).  Saving model ...
Epoch: 25 cost time: 2.970668077468872
Epoch: 25, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.837 Vali Acc: 0.728 Test Loss: 0.837 Test Acc: 0.728
Validation loss decreased (-0.699991 --> -0.727769).  Saving model ...
Epoch: 26 cost time: 2.9123001098632812
Epoch: 26, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.095775842666626
Epoch: 27, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.751 Vali Acc: 0.756 Test Loss: 0.751 Test Acc: 0.756
Validation loss decreased (-0.727769 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 3.052797555923462
Epoch: 28, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.750 Vali Acc: 0.744 Test Loss: 0.750 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1001198291778564
Epoch: 29, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.696 Vali Acc: 0.756 Test Loss: 0.696 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 30 cost time: 3.108330249786377
Epoch: 30, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
Validation loss decreased (-0.755549 --> -0.783327).  Saving model ...
Epoch: 31 cost time: 3.2582335472106934
Epoch: 31, Steps: 12 | Train Loss: 0.490 Vali Loss: 0.662 Vali Acc: 0.767 Test Loss: 0.662 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.0998475551605225
Epoch: 32, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.645 Vali Acc: 0.811 Test Loss: 0.645 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811105).  Saving model ...
Epoch: 33 cost time: 3.2987778186798096
Epoch: 33, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.598 Vali Acc: 0.817 Test Loss: 0.598 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 34 cost time: 3.4249210357666016
Epoch: 34, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 35 cost time: 3.237858772277832
Epoch: 35, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.583 Vali Acc: 0.828 Test Loss: 0.583 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 36 cost time: 3.4864025115966797
Epoch: 36, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.423521041870117
Epoch: 37, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.3480560779571533
Epoch: 38, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.827772 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 3.0796000957489014
Epoch: 39, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.562 Vali Acc: 0.839 Test Loss: 0.562 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.050642967224121
Epoch: 40, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.122633457183838
Epoch: 41, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 42 cost time: 3.193730354309082
Epoch: 42, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.992037773132324
Epoch: 43, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.543 Vali Acc: 0.828 Test Loss: 0.543 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.0355024337768555
Epoch: 44, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.532 Vali Acc: 0.844 Test Loss: 0.532 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.023881673812866
Epoch: 45, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.0643537044525146
Epoch: 46, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.536 Vali Acc: 0.839 Test Loss: 0.536 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.078540802001953
Epoch: 47, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.8957934379577637
Epoch: 48, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.9906458854675293
Epoch: 49, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.965425491333008
Epoch: 50, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.2087066173553467
Epoch: 51, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.4439308643341064
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.765 Vali Acc: 0.078 Test Loss: 2.765 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 3.1145846843719482
Epoch: 2, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.698 Vali Acc: 0.106 Test Loss: 2.698 Test Acc: 0.106
Validation loss decreased (-0.077750 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 2.860631227493286
Epoch: 3, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.616 Vali Acc: 0.128 Test Loss: 2.616 Test Acc: 0.128
Validation loss decreased (-0.105529 --> -0.127752).  Saving model ...
Epoch: 4 cost time: 2.8274989128112793
Epoch: 4, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.536 Vali Acc: 0.178 Test Loss: 2.536 Test Acc: 0.178
Validation loss decreased (-0.127752 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 2.746967077255249
Epoch: 5, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.452 Vali Acc: 0.222 Test Loss: 2.452 Test Acc: 0.222
Validation loss decreased (-0.177752 --> -0.222198).  Saving model ...
Epoch: 6 cost time: 2.7747795581817627
Epoch: 6, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.358 Vali Acc: 0.239 Test Loss: 2.358 Test Acc: 0.239
Validation loss decreased (-0.222198 --> -0.238865).  Saving model ...
Epoch: 7 cost time: 3.0160295963287354
Epoch: 7, Steps: 12 | Train Loss: 2.483 Vali Loss: 2.276 Vali Acc: 0.278 Test Loss: 2.276 Test Acc: 0.278
Validation loss decreased (-0.238865 --> -0.277755).  Saving model ...
Epoch: 8 cost time: 2.6104700565338135
Epoch: 8, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.198 Vali Acc: 0.317 Test Loss: 2.198 Test Acc: 0.317
Validation loss decreased (-0.277755 --> -0.316645).  Saving model ...
Epoch: 9 cost time: 2.7326066493988037
Epoch: 9, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.127 Vali Acc: 0.289 Test Loss: 2.127 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8474340438842773
Epoch: 10, Steps: 12 | Train Loss: 2.316 Vali Loss: 2.058 Vali Acc: 0.306 Test Loss: 2.058 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.282406806945801
Epoch: 11, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.002 Vali Acc: 0.328 Test Loss: 2.002 Test Acc: 0.328
Validation loss decreased (-0.316645 --> -0.327758).  Saving model ...
Epoch: 12 cost time: 3.3268508911132812
Epoch: 12, Steps: 12 | Train Loss: 2.150 Vali Loss: 1.933 Vali Acc: 0.361 Test Loss: 1.933 Test Acc: 0.361
Validation loss decreased (-0.327758 --> -0.361092).  Saving model ...
Epoch: 13 cost time: 3.098371982574463
Epoch: 13, Steps: 12 | Train Loss: 1.975 Vali Loss: 1.842 Vali Acc: 0.383 Test Loss: 1.842 Test Acc: 0.383
Validation loss decreased (-0.361092 --> -0.383315).  Saving model ...
Epoch: 14 cost time: 3.220487356185913
Epoch: 14, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.733 Vali Acc: 0.450 Test Loss: 1.733 Test Acc: 0.450
Validation loss decreased (-0.383315 --> -0.449983).  Saving model ...
Epoch: 15 cost time: 3.2891883850097656
Epoch: 15, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.631 Vali Acc: 0.517 Test Loss: 1.631 Test Acc: 0.517
Validation loss decreased (-0.449983 --> -0.516650).  Saving model ...
Epoch: 16 cost time: 3.387869358062744
Epoch: 16, Steps: 12 | Train Loss: 1.550 Vali Loss: 1.521 Vali Acc: 0.517 Test Loss: 1.521 Test Acc: 0.517
Validation loss decreased (-0.516650 --> -0.516651).  Saving model ...
Epoch: 17 cost time: 2.9527361392974854
Epoch: 17, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.416 Vali Acc: 0.572 Test Loss: 1.416 Test Acc: 0.572
Validation loss decreased (-0.516651 --> -0.572208).  Saving model ...
Epoch: 18 cost time: 3.087966203689575
Epoch: 18, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.310 Vali Acc: 0.617 Test Loss: 1.310 Test Acc: 0.617
Validation loss decreased (-0.572208 --> -0.616654).  Saving model ...
Epoch: 19 cost time: 2.7942311763763428
Epoch: 19, Steps: 12 | Train Loss: 1.162 Vali Loss: 1.206 Vali Acc: 0.633 Test Loss: 1.206 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 20 cost time: 2.99127197265625
Epoch: 20, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.133 Vali Acc: 0.667 Test Loss: 1.133 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666655).  Saving model ...
Epoch: 21 cost time: 2.9824302196502686
Epoch: 21, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.045 Vali Acc: 0.733 Test Loss: 1.045 Test Acc: 0.733
Validation loss decreased (-0.666655 --> -0.733323).  Saving model ...
Epoch: 22 cost time: 2.976226329803467
Epoch: 22, Steps: 12 | Train Loss: 0.899 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733324).  Saving model ...
Epoch: 23 cost time: 3.2625668048858643
Epoch: 23, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.927 Vali Acc: 0.728 Test Loss: 0.927 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9499237537384033
Epoch: 24, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.863 Vali Acc: 0.711 Test Loss: 0.863 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.251720428466797
Epoch: 25, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.285024642944336
Epoch: 26, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.766 Vali Acc: 0.744 Test Loss: 0.766 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744437).  Saving model ...
Epoch: 27 cost time: 3.2366766929626465
Epoch: 27, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.718 Vali Acc: 0.739 Test Loss: 0.718 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.106074571609497
Epoch: 28, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.711 Vali Acc: 0.728 Test Loss: 0.711 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.0310986042022705
Epoch: 29, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.659 Vali Acc: 0.756 Test Loss: 0.659 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 30 cost time: 2.7687840461730957
Epoch: 30, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788883).  Saving model ...
Epoch: 31 cost time: 3.03385853767395
Epoch: 31, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.598 Vali Acc: 0.794 Test Loss: 0.598 Test Acc: 0.794
Validation loss decreased (-0.788883 --> -0.794438).  Saving model ...
Epoch: 32 cost time: 3.039458990097046
Epoch: 32, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.576 Vali Acc: 0.817 Test Loss: 0.576 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 33 cost time: 2.8510570526123047
Epoch: 33, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.556 Vali Acc: 0.839 Test Loss: 0.556 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838883).  Saving model ...
Epoch: 34 cost time: 2.70036244392395
Epoch: 34, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.539 Vali Acc: 0.828 Test Loss: 0.539 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.115236759185791
Epoch: 35, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.534 Vali Acc: 0.828 Test Loss: 0.534 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0855722427368164
Epoch: 36, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.527 Vali Acc: 0.828 Test Loss: 0.527 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.097622871398926
Epoch: 37, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.511 Vali Acc: 0.839 Test Loss: 0.511 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 38 cost time: 3.3651678562164307
Epoch: 38, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.512 Vali Acc: 0.822 Test Loss: 0.512 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.9967925548553467
Epoch: 39, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.515 Vali Acc: 0.828 Test Loss: 0.515 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.297489881515503
Epoch: 40, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.2569360733032227
Epoch: 41, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.502 Vali Acc: 0.828 Test Loss: 0.502 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.1391825675964355
Epoch: 42, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.511 Vali Acc: 0.839 Test Loss: 0.511 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 43 cost time: 2.916057586669922
Epoch: 43, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 44 cost time: 3.3423120975494385
Epoch: 44, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.490 Vali Acc: 0.839 Test Loss: 0.490 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.040341854095459
Epoch: 45, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844440).  Saving model ...
Epoch: 46 cost time: 2.9908411502838135
Epoch: 46, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 47 cost time: 3.036081552505493
Epoch: 47, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.511 Vali Acc: 0.856 Test Loss: 0.511 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 48 cost time: 2.9299802780151367
Epoch: 48, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.498 Vali Acc: 0.861 Test Loss: 0.498 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 49 cost time: 3.0515034198760986
Epoch: 49, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.491 Vali Acc: 0.856 Test Loss: 0.491 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.081402063369751
Epoch: 50, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.500 Vali Acc: 0.839 Test Loss: 0.500 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.903320550918579
Epoch: 51, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.483 Vali Acc: 0.861 Test Loss: 0.483 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 52 cost time: 2.9163200855255127
Epoch: 52, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.478 Vali Acc: 0.867 Test Loss: 0.478 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 53 cost time: 3.1700565814971924
Epoch: 53, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.487 Vali Acc: 0.856 Test Loss: 0.487 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.02095627784729
Epoch: 54, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.980527877807617
Epoch: 55, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.499 Vali Acc: 0.856 Test Loss: 0.499 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.0955111980438232
Epoch: 56, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.93552565574646
Epoch: 57, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.9984893798828125
Epoch: 58, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.0693678855895996
Epoch: 59, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.7902519702911377
Epoch: 60, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.504 Vali Acc: 0.844 Test Loss: 0.504 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.758582830429077
Epoch: 61, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 2.951106071472168
Epoch: 62, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.523 Vali Acc: 0.833 Test Loss: 0.523 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.259951591491699
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.105064630508423
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6440823078155518
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9054667949676514
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.864389657974243
Epoch: 5, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7461435794830322
Epoch: 6, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8766605854034424
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.84902024269104
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7995831966400146
Epoch: 9, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1120080947875977
Epoch: 10, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.063457727432251
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 444239
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.295969486236572
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.1215786933898926
Epoch: 2, Steps: 12 | Train Loss: 2.646 Vali Loss: 2.552 Vali Acc: 0.228 Test Loss: 2.552 Test Acc: 0.228
Validation loss decreased (-0.066640 --> -0.227752).  Saving model ...
Epoch: 3 cost time: 2.6183040142059326
Epoch: 3, Steps: 12 | Train Loss: 2.522 Vali Loss: 2.358 Vali Acc: 0.294 Test Loss: 2.358 Test Acc: 0.294
Validation loss decreased (-0.227752 --> -0.294421).  Saving model ...
Epoch: 4 cost time: 2.8675167560577393
Epoch: 4, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.172 Vali Acc: 0.439 Test Loss: 2.172 Test Acc: 0.439
Validation loss decreased (-0.294421 --> -0.438867).  Saving model ...
Epoch: 5 cost time: 2.938136577606201
Epoch: 5, Steps: 12 | Train Loss: 2.115 Vali Loss: 1.986 Vali Acc: 0.511 Test Loss: 1.986 Test Acc: 0.511
Validation loss decreased (-0.438867 --> -0.511091).  Saving model ...
Epoch: 6 cost time: 2.979224920272827
Epoch: 6, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.808 Vali Acc: 0.550 Test Loss: 1.808 Test Acc: 0.550
Validation loss decreased (-0.511091 --> -0.549982).  Saving model ...
Epoch: 7 cost time: 2.8971734046936035
Epoch: 7, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.649 Vali Acc: 0.600 Test Loss: 1.649 Test Acc: 0.600
Validation loss decreased (-0.549982 --> -0.599984).  Saving model ...
Epoch: 8 cost time: 2.9708118438720703
Epoch: 8, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.507 Vali Acc: 0.611 Test Loss: 1.507 Test Acc: 0.611
Validation loss decreased (-0.599984 --> -0.611096).  Saving model ...
Epoch: 9 cost time: 3.0360453128814697
Epoch: 9, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.401 Vali Acc: 0.639 Test Loss: 1.401 Test Acc: 0.639
Validation loss decreased (-0.611096 --> -0.638875).  Saving model ...
Epoch: 10 cost time: 3.0941336154937744
Epoch: 10, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.299 Vali Acc: 0.628 Test Loss: 1.299 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.985177993774414
Epoch: 11, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.215 Vali Acc: 0.678 Test Loss: 1.215 Test Acc: 0.678
Validation loss decreased (-0.638875 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 3.135831594467163
Epoch: 12, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.132 Vali Acc: 0.694 Test Loss: 1.132 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694433).  Saving model ...
Epoch: 13 cost time: 3.184683084487915
Epoch: 13, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
Validation loss decreased (-0.694433 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 3.1017026901245117
Epoch: 14, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.000 Vali Acc: 0.728 Test Loss: 1.000 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 15 cost time: 3.246628999710083
Epoch: 15, Steps: 12 | Train Loss: 0.734 Vali Loss: 0.945 Vali Acc: 0.722 Test Loss: 0.945 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0622973442077637
Epoch: 16, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.878 Vali Acc: 0.744 Test Loss: 0.878 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 3.0347766876220703
Epoch: 17, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.805 Vali Acc: 0.761 Test Loss: 0.805 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 18 cost time: 2.979055643081665
Epoch: 18, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.757 Vali Acc: 0.767 Test Loss: 0.757 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 19 cost time: 2.9885613918304443
Epoch: 19, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 20 cost time: 3.055507183074951
Epoch: 20, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.658 Vali Acc: 0.806 Test Loss: 0.658 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 21 cost time: 2.9149951934814453
Epoch: 21, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.625 Vali Acc: 0.833 Test Loss: 0.625 Test Acc: 0.833
Validation loss decreased (-0.805549 --> -0.833327).  Saving model ...
Epoch: 22 cost time: 2.8835043907165527
Epoch: 22, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.598 Vali Acc: 0.844 Test Loss: 0.598 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 3.1322848796844482
Epoch: 23, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.584 Vali Acc: 0.839 Test Loss: 0.584 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1094186305999756
Epoch: 24, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 3.0916271209716797
Epoch: 25, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 26 cost time: 3.0638725757598877
Epoch: 26, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.510 Vali Acc: 0.861 Test Loss: 0.510 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 27 cost time: 3.107220411300659
Epoch: 27, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.481 Vali Acc: 0.872 Test Loss: 0.481 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 3.130335569381714
Epoch: 28, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.721768379211426
Epoch: 29, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.450620651245117
Epoch: 30, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 2.9582808017730713
Epoch: 31, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.430 Vali Acc: 0.872 Test Loss: 0.430 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.643759250640869
Epoch: 32, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.425 Vali Acc: 0.872 Test Loss: 0.425 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.7340407371520996
Epoch: 33, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.418 Vali Acc: 0.889 Test Loss: 0.418 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 34 cost time: 2.7052714824676514
Epoch: 34, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.406 Vali Acc: 0.878 Test Loss: 0.406 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.694164752960205
Epoch: 35, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.419 Vali Acc: 0.872 Test Loss: 0.419 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.5697450637817383
Epoch: 36, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.760932207107544
Epoch: 37, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.879908323287964
Epoch: 38, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.392 Vali Acc: 0.894 Test Loss: 0.392 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 39 cost time: 3.01183819770813
Epoch: 39, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.393 Vali Acc: 0.889 Test Loss: 0.393 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.818495988845825
Epoch: 40, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 2.7983615398406982
Epoch: 41, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.381 Vali Acc: 0.894 Test Loss: 0.381 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.927563428878784
Epoch: 42, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.378 Vali Acc: 0.872 Test Loss: 0.378 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.536478281021118
Epoch: 43, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.380 Vali Acc: 0.917 Test Loss: 0.380 Test Acc: 0.917
Validation loss decreased (-0.899996 --> -0.916663).  Saving model ...
Epoch: 44 cost time: 2.7269833087921143
Epoch: 44, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.7173080444335938
Epoch: 45, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.7393229007720947
Epoch: 46, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.656090497970581
Epoch: 47, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.892744779586792
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.376 Vali Acc: 0.906 Test Loss: 0.376 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.8120007514953613
Epoch: 49, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.8406403064727783
Epoch: 50, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.377 Vali Acc: 0.906 Test Loss: 0.377 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.909127950668335
Epoch: 51, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.028031349182129
Epoch: 52, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.1512913703918457
Epoch: 53, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.564183473587036
Epoch: 1, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.779 Vali Acc: 0.061 Test Loss: 2.779 Test Acc: 0.061
Validation loss decreased (inf --> -0.061083).  Saving model ...
Epoch: 2 cost time: 2.968878984451294
Epoch: 2, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.645 Vali Acc: 0.156 Test Loss: 2.645 Test Acc: 0.156
Validation loss decreased (-0.061083 --> -0.155529).  Saving model ...
Epoch: 3 cost time: 3.1834969520568848
Epoch: 3, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.480 Vali Acc: 0.261 Test Loss: 2.480 Test Acc: 0.261
Validation loss decreased (-0.155529 --> -0.261086).  Saving model ...
Epoch: 4 cost time: 2.9832041263580322
Epoch: 4, Steps: 12 | Train Loss: 2.412 Vali Loss: 2.317 Vali Acc: 0.444 Test Loss: 2.317 Test Acc: 0.444
Validation loss decreased (-0.261086 --> -0.444421).  Saving model ...
Epoch: 5 cost time: 2.855654001235962
Epoch: 5, Steps: 12 | Train Loss: 2.256 Vali Loss: 2.158 Vali Acc: 0.511 Test Loss: 2.158 Test Acc: 0.511
Validation loss decreased (-0.444421 --> -0.511090).  Saving model ...
Epoch: 6 cost time: 2.9227852821350098
Epoch: 6, Steps: 12 | Train Loss: 2.096 Vali Loss: 1.999 Vali Acc: 0.578 Test Loss: 1.999 Test Acc: 0.578
Validation loss decreased (-0.511090 --> -0.577758).  Saving model ...
Epoch: 7 cost time: 3.3708956241607666
Epoch: 7, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.854 Vali Acc: 0.572 Test Loss: 1.854 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.063629388809204
Epoch: 8, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.713 Vali Acc: 0.600 Test Loss: 1.713 Test Acc: 0.600
Validation loss decreased (-0.577758 --> -0.599983).  Saving model ...
Epoch: 9 cost time: 3.226428270339966
Epoch: 9, Steps: 12 | Train Loss: 1.609 Vali Loss: 1.597 Vali Acc: 0.589 Test Loss: 1.597 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1800954341888428
Epoch: 10, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.485 Vali Acc: 0.594 Test Loss: 1.485 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.280329942703247
Epoch: 11, Steps: 12 | Train Loss: 1.402 Vali Loss: 1.387 Vali Acc: 0.606 Test Loss: 1.387 Test Acc: 0.606
Validation loss decreased (-0.599983 --> -0.605542).  Saving model ...
Epoch: 12 cost time: 3.2602877616882324
Epoch: 12, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.295 Vali Acc: 0.633 Test Loss: 1.295 Test Acc: 0.633
Validation loss decreased (-0.605542 --> -0.633320).  Saving model ...
Epoch: 13 cost time: 3.0394320487976074
Epoch: 13, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.207 Vali Acc: 0.661 Test Loss: 1.207 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661099).  Saving model ...
Epoch: 14 cost time: 2.9208321571350098
Epoch: 14, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.133 Vali Acc: 0.672 Test Loss: 1.133 Test Acc: 0.672
Validation loss decreased (-0.661099 --> -0.672211).  Saving model ...
Epoch: 15 cost time: 2.908524990081787
Epoch: 15, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699989).  Saving model ...
Epoch: 16 cost time: 2.9339258670806885
Epoch: 16, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722212).  Saving model ...
Epoch: 17 cost time: 2.840904712677002
Epoch: 17, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.898 Vali Acc: 0.761 Test Loss: 0.898 Test Acc: 0.761
Validation loss decreased (-0.722212 --> -0.761102).  Saving model ...
Epoch: 18 cost time: 3.372628927230835
Epoch: 18, Steps: 12 | Train Loss: 0.679 Vali Loss: 0.837 Vali Acc: 0.772 Test Loss: 0.837 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 19 cost time: 3.146845817565918
Epoch: 19, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.807 Vali Acc: 0.778 Test Loss: 0.807 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 20 cost time: 3.1883621215820312
Epoch: 20, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.732 Vali Acc: 0.811 Test Loss: 0.732 Test Acc: 0.811
Validation loss decreased (-0.777770 --> -0.811104).  Saving model ...
Epoch: 21 cost time: 3.415844678878784
Epoch: 21, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.703 Vali Acc: 0.806 Test Loss: 0.703 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.235959529876709
Epoch: 22, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.662 Vali Acc: 0.828 Test Loss: 0.662 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 3.290799379348755
Epoch: 23, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 3.3927531242370605
Epoch: 24, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 3.275063991546631
Epoch: 25, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 3.0432400703430176
Epoch: 26, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 27 cost time: 2.8335886001586914
Epoch: 27, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.538 Vali Acc: 0.872 Test Loss: 0.538 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 28 cost time: 2.9273693561553955
Epoch: 28, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9220147132873535
Epoch: 29, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.539 Vali Acc: 0.872 Test Loss: 0.539 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.908367156982422
Epoch: 30, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 31 cost time: 2.8422791957855225
Epoch: 31, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.482 Vali Acc: 0.878 Test Loss: 0.482 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.210869312286377
Epoch: 32, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.1366281509399414
Epoch: 33, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.476 Vali Acc: 0.872 Test Loss: 0.476 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.1409671306610107
Epoch: 34, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.9797189235687256
Epoch: 35, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.466 Vali Acc: 0.889 Test Loss: 0.466 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 36 cost time: 3.329935312271118
Epoch: 36, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.446 Vali Acc: 0.883 Test Loss: 0.446 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.234509229660034
Epoch: 37, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.454 Vali Acc: 0.872 Test Loss: 0.454 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.3344151973724365
Epoch: 38, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.475 Vali Acc: 0.883 Test Loss: 0.475 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.2063636779785156
Epoch: 39, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.468 Vali Acc: 0.878 Test Loss: 0.468 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.0785698890686035
Epoch: 40, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.010617733001709
Epoch: 41, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.1498806476593018
Epoch: 42, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.452 Vali Acc: 0.872 Test Loss: 0.452 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.856175422668457
Epoch: 43, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.673794746398926
Epoch: 44, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.452 Vali Acc: 0.883 Test Loss: 0.452 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.1192383766174316
Epoch: 45, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.461 Vali Acc: 0.883 Test Loss: 0.461 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.450347661972046
Epoch: 1, Steps: 12 | Train Loss: 2.794 Vali Loss: 2.798 Vali Acc: 0.067 Test Loss: 2.798 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 3.0910024642944336
Epoch: 2, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.685 Vali Acc: 0.117 Test Loss: 2.685 Test Acc: 0.117
Validation loss decreased (-0.066639 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 2.7633888721466064
Epoch: 3, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.547 Vali Acc: 0.222 Test Loss: 2.547 Test Acc: 0.222
Validation loss decreased (-0.116640 --> -0.222197).  Saving model ...
Epoch: 4 cost time: 2.7097976207733154
Epoch: 4, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.407 Vali Acc: 0.339 Test Loss: 2.407 Test Acc: 0.339
Validation loss decreased (-0.222197 --> -0.338865).  Saving model ...
Epoch: 5 cost time: 2.875246524810791
Epoch: 5, Steps: 12 | Train Loss: 2.381 Vali Loss: 2.273 Vali Acc: 0.367 Test Loss: 2.273 Test Acc: 0.367
Validation loss decreased (-0.338865 --> -0.366644).  Saving model ...
Epoch: 6 cost time: 2.738401412963867
Epoch: 6, Steps: 12 | Train Loss: 2.226 Vali Loss: 2.138 Vali Acc: 0.489 Test Loss: 2.138 Test Acc: 0.489
Validation loss decreased (-0.366644 --> -0.488868).  Saving model ...
Epoch: 7 cost time: 2.910856246948242
Epoch: 7, Steps: 12 | Train Loss: 2.072 Vali Loss: 2.017 Vali Acc: 0.472 Test Loss: 2.017 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.870952606201172
Epoch: 8, Steps: 12 | Train Loss: 1.934 Vali Loss: 1.906 Vali Acc: 0.506 Test Loss: 1.906 Test Acc: 0.506
Validation loss decreased (-0.488868 --> -0.505536).  Saving model ...
Epoch: 9 cost time: 2.772031307220459
Epoch: 9, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.810 Vali Acc: 0.517 Test Loss: 1.810 Test Acc: 0.517
Validation loss decreased (-0.505536 --> -0.516649).  Saving model ...
Epoch: 10 cost time: 2.8774609565734863
Epoch: 10, Steps: 12 | Train Loss: 1.748 Vali Loss: 1.723 Vali Acc: 0.556 Test Loss: 1.723 Test Acc: 0.556
Validation loss decreased (-0.516649 --> -0.555538).  Saving model ...
Epoch: 11 cost time: 2.9236807823181152
Epoch: 11, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.634 Vali Acc: 0.578 Test Loss: 1.634 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577761).  Saving model ...
Epoch: 12 cost time: 2.8808839321136475
Epoch: 12, Steps: 12 | Train Loss: 1.479 Vali Loss: 1.544 Vali Acc: 0.594 Test Loss: 1.544 Test Acc: 0.594
Validation loss decreased (-0.577761 --> -0.594429).  Saving model ...
Epoch: 13 cost time: 2.956211566925049
Epoch: 13, Steps: 12 | Train Loss: 1.399 Vali Loss: 1.454 Vali Acc: 0.622 Test Loss: 1.454 Test Acc: 0.622
Validation loss decreased (-0.594429 --> -0.622208).  Saving model ...
Epoch: 14 cost time: 3.0877954959869385
Epoch: 14, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.369 Vali Acc: 0.600 Test Loss: 1.369 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.976998805999756
Epoch: 15, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.292 Vali Acc: 0.633 Test Loss: 1.292 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633320).  Saving model ...
Epoch: 16 cost time: 3.029937744140625
Epoch: 16, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.193 Vali Acc: 0.656 Test Loss: 1.193 Test Acc: 0.656
Validation loss decreased (-0.633320 --> -0.655544).  Saving model ...
Epoch: 17 cost time: 2.957606077194214
Epoch: 17, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.085 Vali Acc: 0.722 Test Loss: 1.085 Test Acc: 0.722
Validation loss decreased (-0.655544 --> -0.722211).  Saving model ...
Epoch: 18 cost time: 2.979414701461792
Epoch: 18, Steps: 12 | Train Loss: 0.892 Vali Loss: 1.013 Vali Acc: 0.722 Test Loss: 1.013 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722212).  Saving model ...
Epoch: 19 cost time: 2.7843687534332275
Epoch: 19, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.972 Vali Acc: 0.733 Test Loss: 0.972 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733324).  Saving model ...
Epoch: 20 cost time: 2.8641273975372314
Epoch: 20, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.879 Vali Acc: 0.767 Test Loss: 0.879 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 21 cost time: 2.7518532276153564
Epoch: 21, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.866 Vali Acc: 0.733 Test Loss: 0.866 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7264068126678467
Epoch: 22, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 2.946488380432129
Epoch: 23, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.764 Vali Acc: 0.778 Test Loss: 0.764 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.8475000858306885
Epoch: 24, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.713 Vali Acc: 0.811 Test Loss: 0.713 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 3.015678882598877
Epoch: 25, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.1504781246185303
Epoch: 26, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.666 Vali Acc: 0.811 Test Loss: 0.666 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 27 cost time: 3.1479945182800293
Epoch: 27, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.648 Vali Acc: 0.828 Test Loss: 0.648 Test Acc: 0.828
Validation loss decreased (-0.811104 --> -0.827771).  Saving model ...
Epoch: 28 cost time: 3.1250720024108887
Epoch: 28, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0258030891418457
Epoch: 29, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 30 cost time: 3.0314691066741943
Epoch: 30, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 31 cost time: 2.9127068519592285
Epoch: 31, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.577 Vali Acc: 0.817 Test Loss: 0.577 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.859849691390991
Epoch: 32, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.834906578063965
Epoch: 33, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 34 cost time: 2.8065547943115234
Epoch: 34, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.530 Vali Acc: 0.839 Test Loss: 0.530 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.6818199157714844
Epoch: 35, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 36 cost time: 2.7892849445343018
Epoch: 36, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 37 cost time: 2.8770554065704346
Epoch: 37, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.520 Vali Acc: 0.839 Test Loss: 0.520 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.900068759918213
Epoch: 38, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.047919750213623
Epoch: 39, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.8713901042938232
Epoch: 40, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 2.971465826034546
Epoch: 41, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.8702545166015625
Epoch: 42, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 3.0329647064208984
Epoch: 43, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.890166997909546
Epoch: 44, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.482 Vali Acc: 0.844 Test Loss: 0.482 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.942208766937256
Epoch: 45, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.8428707122802734
Epoch: 46, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.501 Vali Acc: 0.861 Test Loss: 0.501 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 47 cost time: 3.272209882736206
Epoch: 47, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.480 Vali Acc: 0.861 Test Loss: 0.480 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 48 cost time: 2.8338229656219482
Epoch: 48, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.8494083881378174
Epoch: 49, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.510 Vali Acc: 0.844 Test Loss: 0.510 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.9321131706237793
Epoch: 50, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.9417994022369385
Epoch: 51, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.9180941581726074
Epoch: 52, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.948659896850586
Epoch: 53, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.864290475845337
Epoch: 54, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.497 Vali Acc: 0.856 Test Loss: 0.497 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.9344422817230225
Epoch: 55, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 56 cost time: 2.8234307765960693
Epoch: 56, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 57 cost time: 3.0316150188446045
Epoch: 57, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.0096614360809326
Epoch: 58, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.2324979305267334
Epoch: 59, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.1625304222106934
Epoch: 60, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.515 Vali Acc: 0.861 Test Loss: 0.515 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.1385440826416016
Epoch: 61, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.501 Vali Acc: 0.872 Test Loss: 0.501 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.209537982940674
Epoch: 62, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.513 Vali Acc: 0.861 Test Loss: 0.513 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.1141037940979004
Epoch: 63, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.524 Vali Acc: 0.861 Test Loss: 0.524 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.14119815826416
Epoch: 64, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.9399118423461914
Epoch: 65, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 2.7492334842681885
Epoch: 66, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.9613888263702393
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.755 Vali Acc: 0.089 Test Loss: 2.755 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 2.857104778289795
Epoch: 2, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.682 Vali Acc: 0.144 Test Loss: 2.682 Test Acc: 0.144
Validation loss decreased (-0.088861 --> -0.144418).  Saving model ...
Epoch: 3 cost time: 2.8710620403289795
Epoch: 3, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.599 Vali Acc: 0.167 Test Loss: 2.599 Test Acc: 0.167
Validation loss decreased (-0.144418 --> -0.166641).  Saving model ...
Epoch: 4 cost time: 3.0452287197113037
Epoch: 4, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.516 Vali Acc: 0.211 Test Loss: 2.516 Test Acc: 0.211
Validation loss decreased (-0.166641 --> -0.211086).  Saving model ...
Epoch: 5 cost time: 3.043895959854126
Epoch: 5, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.423 Vali Acc: 0.283 Test Loss: 2.423 Test Acc: 0.283
Validation loss decreased (-0.211086 --> -0.283309).  Saving model ...
Epoch: 6 cost time: 3.0885844230651855
Epoch: 6, Steps: 12 | Train Loss: 2.395 Vali Loss: 2.337 Vali Acc: 0.283 Test Loss: 2.337 Test Acc: 0.283
Validation loss decreased (-0.283309 --> -0.283310).  Saving model ...
Epoch: 7 cost time: 2.8559839725494385
Epoch: 7, Steps: 12 | Train Loss: 2.274 Vali Loss: 2.249 Vali Acc: 0.339 Test Loss: 2.249 Test Acc: 0.339
Validation loss decreased (-0.283310 --> -0.338866).  Saving model ...
Epoch: 8 cost time: 3.0353057384490967
Epoch: 8, Steps: 12 | Train Loss: 2.180 Vali Loss: 2.167 Vali Acc: 0.339 Test Loss: 2.167 Test Acc: 0.339
Validation loss decreased (-0.338866 --> -0.338867).  Saving model ...
Epoch: 9 cost time: 2.9072303771972656
Epoch: 9, Steps: 12 | Train Loss: 2.138 Vali Loss: 2.077 Vali Acc: 0.372 Test Loss: 2.077 Test Acc: 0.372
Validation loss decreased (-0.338867 --> -0.372201).  Saving model ...
Epoch: 10 cost time: 3.258080005645752
Epoch: 10, Steps: 12 | Train Loss: 1.994 Vali Loss: 2.002 Vali Acc: 0.372 Test Loss: 2.002 Test Acc: 0.372
Validation loss decreased (-0.372201 --> -0.372202).  Saving model ...
Epoch: 11 cost time: 3.1294121742248535
Epoch: 11, Steps: 12 | Train Loss: 1.955 Vali Loss: 1.919 Vali Acc: 0.394 Test Loss: 1.919 Test Acc: 0.394
Validation loss decreased (-0.372202 --> -0.394425).  Saving model ...
Epoch: 12 cost time: 3.0351059436798096
Epoch: 12, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.814 Vali Acc: 0.433 Test Loss: 1.814 Test Acc: 0.433
Validation loss decreased (-0.394425 --> -0.433315).  Saving model ...
Epoch: 13 cost time: 2.85394549369812
Epoch: 13, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.699 Vali Acc: 0.478 Test Loss: 1.699 Test Acc: 0.478
Validation loss decreased (-0.433315 --> -0.477761).  Saving model ...
Epoch: 14 cost time: 3.0199387073516846
Epoch: 14, Steps: 12 | Train Loss: 1.572 Vali Loss: 1.604 Vali Acc: 0.517 Test Loss: 1.604 Test Acc: 0.517
Validation loss decreased (-0.477761 --> -0.516651).  Saving model ...
Epoch: 15 cost time: 3.13287353515625
Epoch: 15, Steps: 12 | Train Loss: 1.447 Vali Loss: 1.495 Vali Acc: 0.578 Test Loss: 1.495 Test Acc: 0.578
Validation loss decreased (-0.516651 --> -0.577763).  Saving model ...
Epoch: 16 cost time: 3.349841594696045
Epoch: 16, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.374 Vali Acc: 0.617 Test Loss: 1.374 Test Acc: 0.617
Validation loss decreased (-0.577763 --> -0.616653).  Saving model ...
Epoch: 17 cost time: 3.4082109928131104
Epoch: 17, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.249 Vali Acc: 0.661 Test Loss: 1.249 Test Acc: 0.661
Validation loss decreased (-0.616653 --> -0.661099).  Saving model ...
Epoch: 18 cost time: 3.6230499744415283
Epoch: 18, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.156 Vali Acc: 0.694 Test Loss: 1.156 Test Acc: 0.694
Validation loss decreased (-0.661099 --> -0.694433).  Saving model ...
Epoch: 19 cost time: 3.2364628314971924
Epoch: 19, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.068 Vali Acc: 0.694 Test Loss: 1.068 Test Acc: 0.694
Validation loss decreased (-0.694433 --> -0.694434).  Saving model ...
Epoch: 20 cost time: 3.3850090503692627
Epoch: 20, Steps: 12 | Train Loss: 0.887 Vali Loss: 0.974 Vali Acc: 0.722 Test Loss: 0.974 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 3.1622002124786377
Epoch: 21, Steps: 12 | Train Loss: 0.800 Vali Loss: 0.927 Vali Acc: 0.744 Test Loss: 0.927 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744435).  Saving model ...
Epoch: 22 cost time: 3.5862088203430176
Epoch: 22, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749992).  Saving model ...
Epoch: 23 cost time: 3.1733806133270264
Epoch: 23, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 24 cost time: 3.246445894241333
Epoch: 24, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.774 Vali Acc: 0.761 Test Loss: 0.774 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 25 cost time: 3.3423879146575928
Epoch: 25, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.110999822616577
Epoch: 26, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 27 cost time: 3.206777572631836
Epoch: 27, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.678 Vali Acc: 0.778 Test Loss: 0.678 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.1180245876312256
Epoch: 28, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.3351938724517822
Epoch: 29, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.621 Vali Acc: 0.817 Test Loss: 0.621 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816660).  Saving model ...
Epoch: 30 cost time: 3.3725974559783936
Epoch: 30, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.594 Vali Acc: 0.794 Test Loss: 0.594 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.0600011348724365
Epoch: 31, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.591 Vali Acc: 0.806 Test Loss: 0.591 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.205958366394043
Epoch: 32, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.578 Vali Acc: 0.806 Test Loss: 0.578 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.046401023864746
Epoch: 33, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.548 Vali Acc: 0.806 Test Loss: 0.548 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.099332332611084
Epoch: 34, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.535 Vali Acc: 0.817 Test Loss: 0.535 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 35 cost time: 3.1437008380889893
Epoch: 35, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 36 cost time: 2.97031831741333
Epoch: 36, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 37 cost time: 2.93451189994812
Epoch: 37, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.499 Vali Acc: 0.828 Test Loss: 0.499 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.9126803874969482
Epoch: 38, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.514 Vali Acc: 0.822 Test Loss: 0.514 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.850696325302124
Epoch: 39, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.505 Vali Acc: 0.839 Test Loss: 0.505 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 40 cost time: 2.9856557846069336
Epoch: 40, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.483 Vali Acc: 0.839 Test Loss: 0.483 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 41 cost time: 2.951692581176758
Epoch: 41, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.9891517162323
Epoch: 42, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.93416690826416
Epoch: 43, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.2224271297454834
Epoch: 44, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 3.561340093612671
Epoch: 45, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.480 Vali Acc: 0.839 Test Loss: 0.480 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2494664192199707
Epoch: 46, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.2949647903442383
Epoch: 47, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.1635582447052
Epoch: 48, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.8924388885498047
Epoch: 49, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.472 Vali Acc: 0.839 Test Loss: 0.472 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.1110823154449463
Epoch: 50, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.1535067558288574
Epoch: 51, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.512 Vali Acc: 0.833 Test Loss: 0.512 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.9201834201812744
Epoch: 52, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.473 Vali Acc: 0.839 Test Loss: 0.473 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.9207394123077393
Epoch: 53, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.9436962604522705
Epoch: 54, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.478506565093994
Epoch: 1, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.748 Vali Acc: 0.094 Test Loss: 2.748 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 3.2807729244232178
Epoch: 2, Steps: 12 | Train Loss: 2.736 Vali Loss: 2.695 Vali Acc: 0.139 Test Loss: 2.695 Test Acc: 0.139
Validation loss decreased (-0.094417 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 3.190509796142578
Epoch: 3, Steps: 12 | Train Loss: 2.703 Vali Loss: 2.627 Vali Acc: 0.150 Test Loss: 2.627 Test Acc: 0.150
Validation loss decreased (-0.138862 --> -0.149974).  Saving model ...
Epoch: 4 cost time: 3.4107654094696045
Epoch: 4, Steps: 12 | Train Loss: 2.635 Vali Loss: 2.556 Vali Acc: 0.183 Test Loss: 2.556 Test Acc: 0.183
Validation loss decreased (-0.149974 --> -0.183308).  Saving model ...
Epoch: 5 cost time: 3.044010639190674
Epoch: 5, Steps: 12 | Train Loss: 2.550 Vali Loss: 2.474 Vali Acc: 0.233 Test Loss: 2.474 Test Acc: 0.233
Validation loss decreased (-0.183308 --> -0.233309).  Saving model ...
Epoch: 6 cost time: 3.0856947898864746
Epoch: 6, Steps: 12 | Train Loss: 2.503 Vali Loss: 2.389 Vali Acc: 0.294 Test Loss: 2.389 Test Acc: 0.294
Validation loss decreased (-0.233309 --> -0.294421).  Saving model ...
Epoch: 7 cost time: 2.941603899002075
Epoch: 7, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.302 Vali Acc: 0.289 Test Loss: 2.302 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.049891948699951
Epoch: 8, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.224 Vali Acc: 0.317 Test Loss: 2.224 Test Acc: 0.317
Validation loss decreased (-0.294421 --> -0.316644).  Saving model ...
Epoch: 9 cost time: 2.930499792098999
Epoch: 9, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.143 Vali Acc: 0.311 Test Loss: 2.143 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.770501136779785
Epoch: 10, Steps: 12 | Train Loss: 2.145 Vali Loss: 2.075 Vali Acc: 0.311 Test Loss: 2.075 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.088864326477051
Epoch: 11, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.002 Vali Acc: 0.333 Test Loss: 2.002 Test Acc: 0.333
Validation loss decreased (-0.316644 --> -0.333313).  Saving model ...
Epoch: 12 cost time: 2.9938063621520996
Epoch: 12, Steps: 12 | Train Loss: 1.985 Vali Loss: 1.911 Vali Acc: 0.328 Test Loss: 1.911 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1567912101745605
Epoch: 13, Steps: 12 | Train Loss: 1.846 Vali Loss: 1.804 Vali Acc: 0.378 Test Loss: 1.804 Test Acc: 0.378
Validation loss decreased (-0.333313 --> -0.377760).  Saving model ...
Epoch: 14 cost time: 3.1671743392944336
Epoch: 14, Steps: 12 | Train Loss: 1.764 Vali Loss: 1.719 Vali Acc: 0.389 Test Loss: 1.719 Test Acc: 0.389
Validation loss decreased (-0.377760 --> -0.388872).  Saving model ...
Epoch: 15 cost time: 3.285322666168213
Epoch: 15, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.599 Vali Acc: 0.467 Test Loss: 1.599 Test Acc: 0.467
Validation loss decreased (-0.388872 --> -0.466651).  Saving model ...
Epoch: 16 cost time: 3.4232280254364014
Epoch: 16, Steps: 12 | Train Loss: 1.580 Vali Loss: 1.486 Vali Acc: 0.578 Test Loss: 1.486 Test Acc: 0.578
Validation loss decreased (-0.466651 --> -0.577763).  Saving model ...
Epoch: 17 cost time: 3.114666223526001
Epoch: 17, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.389 Vali Acc: 0.572 Test Loss: 1.389 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9454193115234375
Epoch: 18, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.320 Vali Acc: 0.583 Test Loss: 1.320 Test Acc: 0.583
Validation loss decreased (-0.577763 --> -0.583320).  Saving model ...
Epoch: 19 cost time: 3.143010377883911
Epoch: 19, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.234 Vali Acc: 0.644 Test Loss: 1.234 Test Acc: 0.644
Validation loss decreased (-0.583320 --> -0.644432).  Saving model ...
Epoch: 20 cost time: 3.2130982875823975
Epoch: 20, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.138 Vali Acc: 0.656 Test Loss: 1.138 Test Acc: 0.656
Validation loss decreased (-0.644432 --> -0.655544).  Saving model ...
Epoch: 21 cost time: 3.2103655338287354
Epoch: 21, Steps: 12 | Train Loss: 0.965 Vali Loss: 1.089 Vali Acc: 0.683 Test Loss: 1.089 Test Acc: 0.683
Validation loss decreased (-0.655544 --> -0.683322).  Saving model ...
Epoch: 22 cost time: 3.369326591491699
Epoch: 22, Steps: 12 | Train Loss: 0.914 Vali Loss: 1.019 Vali Acc: 0.683 Test Loss: 1.019 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683323).  Saving model ...
Epoch: 23 cost time: 2.921398401260376
Epoch: 23, Steps: 12 | Train Loss: 0.818 Vali Loss: 0.976 Vali Acc: 0.717 Test Loss: 0.976 Test Acc: 0.717
Validation loss decreased (-0.683323 --> -0.716657).  Saving model ...
Epoch: 24 cost time: 3.0582926273345947
Epoch: 24, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.916 Vali Acc: 0.728 Test Loss: 0.916 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 25 cost time: 3.2451364994049072
Epoch: 25, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.870 Vali Acc: 0.761 Test Loss: 0.870 Test Acc: 0.761
Validation loss decreased (-0.727769 --> -0.761102).  Saving model ...
Epoch: 26 cost time: 3.1496431827545166
Epoch: 26, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.828 Vali Acc: 0.761 Test Loss: 0.828 Test Acc: 0.761
Validation loss decreased (-0.761102 --> -0.761103).  Saving model ...
Epoch: 27 cost time: 3.2823662757873535
Epoch: 27, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.784 Vali Acc: 0.750 Test Loss: 0.784 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.212690830230713
Epoch: 28, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.768 Vali Acc: 0.750 Test Loss: 0.768 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.5615787506103516
Epoch: 29, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.722 Vali Acc: 0.767 Test Loss: 0.722 Test Acc: 0.767
Validation loss decreased (-0.761103 --> -0.766659).  Saving model ...
Epoch: 30 cost time: 3.5793116092681885
Epoch: 30, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.694 Vali Acc: 0.744 Test Loss: 0.694 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.24609637260437
Epoch: 31, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.688 Vali Acc: 0.761 Test Loss: 0.688 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.056182861328125
Epoch: 32, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.650 Vali Acc: 0.778 Test Loss: 0.650 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777771).  Saving model ...
Epoch: 33 cost time: 3.197338104248047
Epoch: 33, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788883).  Saving model ...
Epoch: 34 cost time: 3.351257085800171
Epoch: 34, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.597 Vali Acc: 0.806 Test Loss: 0.597 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805550).  Saving model ...
Epoch: 35 cost time: 3.1529455184936523
Epoch: 35, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.579 Vali Acc: 0.817 Test Loss: 0.579 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 36 cost time: 3.016590118408203
Epoch: 36, Steps: 12 | Train Loss: 0.399 Vali Loss: 0.565 Vali Acc: 0.811 Test Loss: 0.565 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.279146909713745
Epoch: 37, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.571 Vali Acc: 0.811 Test Loss: 0.571 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.1633353233337402
Epoch: 38, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.560 Vali Acc: 0.828 Test Loss: 0.560 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 39 cost time: 3.317567825317383
Epoch: 39, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 40 cost time: 3.3229072093963623
Epoch: 40, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.225285768508911
Epoch: 41, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.550 Vali Acc: 0.839 Test Loss: 0.550 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 42 cost time: 3.241973638534546
Epoch: 42, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 43 cost time: 3.0085463523864746
Epoch: 43, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.9406275749206543
Epoch: 44, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 2.9826838970184326
Epoch: 45, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.9253358840942383
Epoch: 46, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.0026371479034424
Epoch: 47, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.537 Vali Acc: 0.839 Test Loss: 0.537 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.919175624847412
Epoch: 48, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861106).  Saving model ...
Epoch: 49 cost time: 3.088512659072876
Epoch: 49, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.9556844234466553
Epoch: 50, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.0173513889312744
Epoch: 51, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.972682237625122
Epoch: 52, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 53 cost time: 3.137113332748413
Epoch: 53, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 54 cost time: 3.077025890350342
Epoch: 54, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.144562244415283
Epoch: 55, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.520 Vali Acc: 0.861 Test Loss: 0.520 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.875523328781128
Epoch: 56, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.954979181289673
Epoch: 57, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.529 Vali Acc: 0.861 Test Loss: 0.529 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.1228363513946533
Epoch: 58, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.543 Vali Acc: 0.856 Test Loss: 0.543 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.011659860610962
Epoch: 59, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.9410507678985596
Epoch: 60, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.539 Vali Acc: 0.867 Test Loss: 0.539 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.813098192214966
Epoch: 61, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.543 Vali Acc: 0.872 Test Loss: 0.543 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 62 cost time: 3.1421210765838623
Epoch: 62, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.3628313541412354
Epoch: 63, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.3286521434783936
Epoch: 64, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.556 Vali Acc: 0.856 Test Loss: 0.556 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.4799132347106934
Epoch: 65, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.375133991241455
Epoch: 66, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 3.3208086490631104
Epoch: 67, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.547 Vali Acc: 0.872 Test Loss: 0.547 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 3.4160428047180176
Epoch: 68, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.546 Vali Acc: 0.878 Test Loss: 0.546 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877772).  Saving model ...
Epoch: 69 cost time: 2.9987845420837402
Epoch: 69, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.0680692195892334
Epoch: 70, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.550 Vali Acc: 0.867 Test Loss: 0.550 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 3.1063082218170166
Epoch: 71, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 3.010938882827759
Epoch: 72, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 2.8920376300811768
Epoch: 73, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.549 Vali Acc: 0.867 Test Loss: 0.549 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 3.130622625350952
Epoch: 74, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 3.1004700660705566
Epoch: 75, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 3.3766891956329346
Epoch: 76, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 3.222585439682007
Epoch: 77, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.582 Vali Acc: 0.861 Test Loss: 0.582 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 3.2627065181732178
Epoch: 78, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.181493759155273
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.688 Vali Acc: 0.072 Test Loss: 2.688 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 3.053797721862793
Epoch: 2, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.609 Vali Acc: 0.122 Test Loss: 2.609 Test Acc: 0.122
Validation loss decreased (-0.072195 --> -0.122196).  Saving model ...
Epoch: 3 cost time: 2.981933832168579
Epoch: 3, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.510 Vali Acc: 0.189 Test Loss: 2.510 Test Acc: 0.189
Validation loss decreased (-0.122196 --> -0.188864).  Saving model ...
Epoch: 4 cost time: 2.998110771179199
Epoch: 4, Steps: 12 | Train Loss: 2.678 Vali Loss: 2.415 Vali Acc: 0.233 Test Loss: 2.415 Test Acc: 0.233
Validation loss decreased (-0.188864 --> -0.233309).  Saving model ...
Epoch: 5 cost time: 3.0100386142730713
Epoch: 5, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.326 Vali Acc: 0.267 Test Loss: 2.326 Test Acc: 0.267
Validation loss decreased (-0.233309 --> -0.266643).  Saving model ...
Epoch: 6 cost time: 2.9265317916870117
Epoch: 6, Steps: 12 | Train Loss: 2.526 Vali Loss: 2.256 Vali Acc: 0.278 Test Loss: 2.256 Test Acc: 0.278
Validation loss decreased (-0.266643 --> -0.277755).  Saving model ...
Epoch: 7 cost time: 3.110006093978882
Epoch: 7, Steps: 12 | Train Loss: 2.460 Vali Loss: 2.192 Vali Acc: 0.283 Test Loss: 2.192 Test Acc: 0.283
Validation loss decreased (-0.277755 --> -0.283311).  Saving model ...
Epoch: 8 cost time: 3.284846305847168
Epoch: 8, Steps: 12 | Train Loss: 2.394 Vali Loss: 2.135 Vali Acc: 0.294 Test Loss: 2.135 Test Acc: 0.294
Validation loss decreased (-0.283311 --> -0.294423).  Saving model ...
Epoch: 9 cost time: 3.187069892883301
Epoch: 9, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.077 Vali Acc: 0.311 Test Loss: 2.077 Test Acc: 0.311
Validation loss decreased (-0.294423 --> -0.311090).  Saving model ...
Epoch: 10 cost time: 3.1293766498565674
Epoch: 10, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.027 Vali Acc: 0.356 Test Loss: 2.027 Test Acc: 0.356
Validation loss decreased (-0.311090 --> -0.355535).  Saving model ...
Epoch: 11 cost time: 3.025810480117798
Epoch: 11, Steps: 12 | Train Loss: 2.190 Vali Loss: 1.982 Vali Acc: 0.367 Test Loss: 1.982 Test Acc: 0.367
Validation loss decreased (-0.355535 --> -0.366647).  Saving model ...
Epoch: 12 cost time: 2.9407668113708496
Epoch: 12, Steps: 12 | Train Loss: 2.080 Vali Loss: 1.907 Vali Acc: 0.383 Test Loss: 1.907 Test Acc: 0.383
Validation loss decreased (-0.366647 --> -0.383314).  Saving model ...
Epoch: 13 cost time: 2.8345634937286377
Epoch: 13, Steps: 12 | Train Loss: 1.891 Vali Loss: 1.819 Vali Acc: 0.394 Test Loss: 1.819 Test Acc: 0.394
Validation loss decreased (-0.383314 --> -0.394426).  Saving model ...
Epoch: 14 cost time: 2.9440500736236572
Epoch: 14, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.744 Vali Acc: 0.389 Test Loss: 1.744 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9544544219970703
Epoch: 15, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.621 Vali Acc: 0.467 Test Loss: 1.621 Test Acc: 0.467
Validation loss decreased (-0.394426 --> -0.466650).  Saving model ...
Epoch: 16 cost time: 3.1683201789855957
Epoch: 16, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.506 Vali Acc: 0.511 Test Loss: 1.506 Test Acc: 0.511
Validation loss decreased (-0.466650 --> -0.511096).  Saving model ...
Epoch: 17 cost time: 3.047389268875122
Epoch: 17, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.392 Vali Acc: 0.539 Test Loss: 1.392 Test Acc: 0.539
Validation loss decreased (-0.511096 --> -0.538875).  Saving model ...
Epoch: 18 cost time: 2.759777784347534
Epoch: 18, Steps: 12 | Train Loss: 1.279 Vali Loss: 1.309 Vali Acc: 0.544 Test Loss: 1.309 Test Acc: 0.544
Validation loss decreased (-0.538875 --> -0.544431).  Saving model ...
Epoch: 19 cost time: 2.837117910385132
Epoch: 19, Steps: 12 | Train Loss: 1.167 Vali Loss: 1.214 Vali Acc: 0.633 Test Loss: 1.214 Test Acc: 0.633
Validation loss decreased (-0.544431 --> -0.633321).  Saving model ...
Epoch: 20 cost time: 2.812387228012085
Epoch: 20, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.120 Vali Acc: 0.639 Test Loss: 1.120 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638878).  Saving model ...
Epoch: 21 cost time: 2.999865770339966
Epoch: 21, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.069 Vali Acc: 0.661 Test Loss: 1.069 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661100).  Saving model ...
Epoch: 22 cost time: 3.0862247943878174
Epoch: 22, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.988 Vali Acc: 0.689 Test Loss: 0.988 Test Acc: 0.689
Validation loss decreased (-0.661100 --> -0.688879).  Saving model ...
Epoch: 23 cost time: 3.1503279209136963
Epoch: 23, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.941 Vali Acc: 0.717 Test Loss: 0.941 Test Acc: 0.717
Validation loss decreased (-0.688879 --> -0.716657).  Saving model ...
Epoch: 24 cost time: 3.0404913425445557
Epoch: 24, Steps: 12 | Train Loss: 0.764 Vali Loss: 0.893 Vali Acc: 0.700 Test Loss: 0.893 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0379045009613037
Epoch: 25, Steps: 12 | Train Loss: 0.742 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716658).  Saving model ...
Epoch: 26 cost time: 3.0139598846435547
Epoch: 26, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.793 Vali Acc: 0.717 Test Loss: 0.793 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716659).  Saving model ...
Epoch: 27 cost time: 2.910728931427002
Epoch: 27, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.752 Vali Acc: 0.733 Test Loss: 0.752 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733326).  Saving model ...
Epoch: 28 cost time: 2.854938507080078
Epoch: 28, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.722 Vali Acc: 0.739 Test Loss: 0.722 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 29 cost time: 2.8386683464050293
Epoch: 29, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.676 Vali Acc: 0.744 Test Loss: 0.676 Test Acc: 0.744
Validation loss decreased (-0.738882 --> -0.744438).  Saving model ...
Epoch: 30 cost time: 3.084650993347168
Epoch: 30, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.640 Vali Acc: 0.767 Test Loss: 0.640 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766660).  Saving model ...
Epoch: 31 cost time: 2.904362201690674
Epoch: 31, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.620 Vali Acc: 0.767 Test Loss: 0.620 Test Acc: 0.767
Validation loss decreased (-0.766660 --> -0.766660).  Saving model ...
Epoch: 32 cost time: 2.6479671001434326
Epoch: 32, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.605 Vali Acc: 0.800 Test Loss: 0.605 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799994).  Saving model ...
Epoch: 33 cost time: 3.139625310897827
Epoch: 33, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822216).  Saving model ...
Epoch: 34 cost time: 3.189141273498535
Epoch: 34, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.567 Vali Acc: 0.811 Test Loss: 0.567 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2469327449798584
Epoch: 35, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838884).  Saving model ...
Epoch: 36 cost time: 2.985330581665039
Epoch: 36, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 37 cost time: 3.252012014389038
Epoch: 37, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 38 cost time: 3.230252981185913
Epoch: 38, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 39 cost time: 2.9907398223876953
Epoch: 39, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855551).  Saving model ...
Epoch: 40 cost time: 2.989640474319458
Epoch: 40, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 3.0060760974884033
Epoch: 41, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.484 Vali Acc: 0.861 Test Loss: 0.484 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 42 cost time: 3.20674729347229
Epoch: 42, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.481 Vali Acc: 0.839 Test Loss: 0.481 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.967343330383301
Epoch: 43, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.114335298538208
Epoch: 44, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.468 Vali Acc: 0.872 Test Loss: 0.468 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872218).  Saving model ...
Epoch: 45 cost time: 2.9843575954437256
Epoch: 45, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.083399534225464
Epoch: 46, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.470440149307251
Epoch: 47, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.465 Vali Acc: 0.861 Test Loss: 0.465 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.133232593536377
Epoch: 48, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.471 Vali Acc: 0.872 Test Loss: 0.471 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.1444168090820312
Epoch: 49, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.456 Vali Acc: 0.867 Test Loss: 0.456 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.3150525093078613
Epoch: 50, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.367154359817505
Epoch: 51, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.1845340728759766
Epoch: 52, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.026418685913086
Epoch: 53, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.485 Vali Acc: 0.861 Test Loss: 0.485 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.0852127075195312
Epoch: 54, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.478 Vali Acc: 0.861 Test Loss: 0.478 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.481340169906616
Epoch: 1, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.764 Vali Acc: 0.094 Test Loss: 2.764 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 3.042695999145508
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.715 Vali Acc: 0.111 Test Loss: 2.715 Test Acc: 0.111
Validation loss decreased (-0.094417 --> -0.111084).  Saving model ...
Epoch: 3 cost time: 3.0113110542297363
Epoch: 3, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.653 Vali Acc: 0.144 Test Loss: 2.653 Test Acc: 0.144
Validation loss decreased (-0.111084 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 3.1699187755584717
Epoch: 4, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.582 Vali Acc: 0.189 Test Loss: 2.582 Test Acc: 0.189
Validation loss decreased (-0.144418 --> -0.188863).  Saving model ...
Epoch: 5 cost time: 3.032572031021118
Epoch: 5, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.502 Vali Acc: 0.217 Test Loss: 2.502 Test Acc: 0.217
Validation loss decreased (-0.188863 --> -0.216642).  Saving model ...
Epoch: 6 cost time: 3.034999132156372
Epoch: 6, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.417 Vali Acc: 0.250 Test Loss: 2.417 Test Acc: 0.250
Validation loss decreased (-0.216642 --> -0.249976).  Saving model ...
Epoch: 7 cost time: 2.8728411197662354
Epoch: 7, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.330 Vali Acc: 0.272 Test Loss: 2.330 Test Acc: 0.272
Validation loss decreased (-0.249976 --> -0.272199).  Saving model ...
Epoch: 8 cost time: 3.0060107707977295
Epoch: 8, Steps: 12 | Train Loss: 2.449 Vali Loss: 2.237 Vali Acc: 0.294 Test Loss: 2.237 Test Acc: 0.294
Validation loss decreased (-0.272199 --> -0.294422).  Saving model ...
Epoch: 9 cost time: 2.7748076915740967
Epoch: 9, Steps: 12 | Train Loss: 2.406 Vali Loss: 2.152 Vali Acc: 0.317 Test Loss: 2.152 Test Acc: 0.317
Validation loss decreased (-0.294422 --> -0.316645).  Saving model ...
Epoch: 10 cost time: 2.5872063636779785
Epoch: 10, Steps: 12 | Train Loss: 2.322 Vali Loss: 2.086 Vali Acc: 0.328 Test Loss: 2.086 Test Acc: 0.328
Validation loss decreased (-0.316645 --> -0.327757).  Saving model ...
Epoch: 11 cost time: 2.8077914714813232
Epoch: 11, Steps: 12 | Train Loss: 2.270 Vali Loss: 2.015 Vali Acc: 0.361 Test Loss: 2.015 Test Acc: 0.361
Validation loss decreased (-0.327757 --> -0.361091).  Saving model ...
Epoch: 12 cost time: 2.6693098545074463
Epoch: 12, Steps: 12 | Train Loss: 2.157 Vali Loss: 1.931 Vali Acc: 0.344 Test Loss: 1.931 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7683112621307373
Epoch: 13, Steps: 12 | Train Loss: 1.998 Vali Loss: 1.858 Vali Acc: 0.389 Test Loss: 1.858 Test Acc: 0.389
Validation loss decreased (-0.361091 --> -0.388870).  Saving model ...
Epoch: 14 cost time: 2.64682674407959
Epoch: 14, Steps: 12 | Train Loss: 1.893 Vali Loss: 1.796 Vali Acc: 0.406 Test Loss: 1.796 Test Acc: 0.406
Validation loss decreased (-0.388870 --> -0.405538).  Saving model ...
Epoch: 15 cost time: 2.7668886184692383
Epoch: 15, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.669 Vali Acc: 0.456 Test Loss: 1.669 Test Acc: 0.456
Validation loss decreased (-0.405538 --> -0.455539).  Saving model ...
Epoch: 16 cost time: 2.981638193130493
Epoch: 16, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.549 Vali Acc: 0.472 Test Loss: 1.549 Test Acc: 0.472
Validation loss decreased (-0.455539 --> -0.472207).  Saving model ...
Epoch: 17 cost time: 3.075423240661621
Epoch: 17, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.424 Vali Acc: 0.539 Test Loss: 1.424 Test Acc: 0.539
Validation loss decreased (-0.472207 --> -0.538875).  Saving model ...
Epoch: 18 cost time: 2.8984484672546387
Epoch: 18, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.342 Vali Acc: 0.556 Test Loss: 1.342 Test Acc: 0.556
Validation loss decreased (-0.538875 --> -0.555542).  Saving model ...
Epoch: 19 cost time: 2.856682777404785
Epoch: 19, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.240 Vali Acc: 0.650 Test Loss: 1.240 Test Acc: 0.650
Validation loss decreased (-0.555542 --> -0.649988).  Saving model ...
Epoch: 20 cost time: 2.9997761249542236
Epoch: 20, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.130 Vali Acc: 0.661 Test Loss: 1.130 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 21 cost time: 3.1610677242279053
Epoch: 21, Steps: 12 | Train Loss: 0.980 Vali Loss: 1.077 Vali Acc: 0.678 Test Loss: 1.077 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 22 cost time: 2.698462724685669
Epoch: 22, Steps: 12 | Train Loss: 0.926 Vali Loss: 0.992 Vali Acc: 0.700 Test Loss: 0.992 Test Acc: 0.700
Validation loss decreased (-0.677767 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 2.9275572299957275
Epoch: 23, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.954 Vali Acc: 0.700 Test Loss: 0.954 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 24 cost time: 2.7734363079071045
Epoch: 24, Steps: 12 | Train Loss: 0.765 Vali Loss: 0.899 Vali Acc: 0.722 Test Loss: 0.899 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 25 cost time: 2.9054129123687744
Epoch: 25, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749991).  Saving model ...
Epoch: 26 cost time: 3.009389638900757
Epoch: 26, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.823 Vali Acc: 0.733 Test Loss: 0.823 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7889564037323
Epoch: 27, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 28 cost time: 2.8582699298858643
Epoch: 28, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.759 Vali Acc: 0.756 Test Loss: 0.759 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 29 cost time: 3.0047690868377686
Epoch: 29, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.712 Vali Acc: 0.767 Test Loss: 0.712 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766660).  Saving model ...
Epoch: 30 cost time: 3.123201847076416
Epoch: 30, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.674 Vali Acc: 0.778 Test Loss: 0.674 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 31 cost time: 3.212519884109497
Epoch: 31, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.271324396133423
Epoch: 32, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.644 Vali Acc: 0.778 Test Loss: 0.644 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 33 cost time: 3.182291030883789
Epoch: 33, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.624 Vali Acc: 0.794 Test Loss: 0.624 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 34 cost time: 3.263695001602173
Epoch: 34, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.614 Vali Acc: 0.772 Test Loss: 0.614 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.8528804779052734
Epoch: 35, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.584 Vali Acc: 0.817 Test Loss: 0.584 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 36 cost time: 2.894246816635132
Epoch: 36, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 37 cost time: 2.7489137649536133
Epoch: 37, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.574 Vali Acc: 0.828 Test Loss: 0.574 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827772).  Saving model ...
Epoch: 38 cost time: 2.8630950450897217
Epoch: 38, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.7136988639831543
Epoch: 39, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.545 Vali Acc: 0.839 Test Loss: 0.545 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 40 cost time: 2.89292573928833
Epoch: 40, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.552 Vali Acc: 0.811 Test Loss: 0.552 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.8063759803771973
Epoch: 41, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.829914093017578
Epoch: 42, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.506 Vali Acc: 0.839 Test Loss: 0.506 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 43 cost time: 2.9791955947875977
Epoch: 43, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 44 cost time: 3.041222333908081
Epoch: 44, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.878620147705078
Epoch: 45, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.8584985733032227
Epoch: 46, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.066577196121216
Epoch: 47, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.727806568145752
Epoch: 48, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.1322593688964844
Epoch: 49, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.999478340148926
Epoch: 50, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.95101261138916
Epoch: 51, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.123058319091797
Epoch: 52, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.019531011581421
Epoch: 53, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.552 Vali Acc: 0.839 Test Loss: 0.552 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.714444160461426
Epoch: 1, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.0870659351348877
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 2.9961869716644287
Epoch: 3, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1683449745178223
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.192490577697754
Epoch: 5, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 2.843951940536499
Epoch: 6, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 7 cost time: 2.9554171562194824
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 3.3086462020874023
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9337897300720215
Epoch: 9, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.269416093826294
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.968043804168701
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2126662731170654
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.108675241470337
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9488978385925293
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9260454177856445
Epoch: 15, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1037983894348145
Epoch: 16, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9323015213012695
Epoch: 17, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 247631
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.1472930908203125
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.770 Vali Acc: 0.017 Test Loss: 2.770 Test Acc: 0.017
Validation loss decreased (inf --> -0.016639).  Saving model ...
Epoch: 2 cost time: 3.0064401626586914
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.626 Vali Acc: 0.094 Test Loss: 2.626 Test Acc: 0.094
Validation loss decreased (-0.016639 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 2.8816816806793213
Epoch: 3, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.449 Vali Acc: 0.317 Test Loss: 2.449 Test Acc: 0.317
Validation loss decreased (-0.094418 --> -0.316642).  Saving model ...
Epoch: 4 cost time: 2.7605910301208496
Epoch: 4, Steps: 12 | Train Loss: 2.395 Vali Loss: 2.255 Vali Acc: 0.472 Test Loss: 2.255 Test Acc: 0.472
Validation loss decreased (-0.316642 --> -0.472200).  Saving model ...
Epoch: 5 cost time: 2.7190921306610107
Epoch: 5, Steps: 12 | Train Loss: 2.147 Vali Loss: 2.054 Vali Acc: 0.567 Test Loss: 2.054 Test Acc: 0.567
Validation loss decreased (-0.472200 --> -0.566646).  Saving model ...
Epoch: 6 cost time: 3.022639513015747
Epoch: 6, Steps: 12 | Train Loss: 1.939 Vali Loss: 1.868 Vali Acc: 0.594 Test Loss: 1.868 Test Acc: 0.594
Validation loss decreased (-0.566646 --> -0.594426).  Saving model ...
Epoch: 7 cost time: 3.105154275894165
Epoch: 7, Steps: 12 | Train Loss: 1.808 Vali Loss: 1.700 Vali Acc: 0.600 Test Loss: 1.700 Test Acc: 0.600
Validation loss decreased (-0.594426 --> -0.599983).  Saving model ...
Epoch: 8 cost time: 2.987981081008911
Epoch: 8, Steps: 12 | Train Loss: 1.626 Vali Loss: 1.568 Vali Acc: 0.650 Test Loss: 1.568 Test Acc: 0.650
Validation loss decreased (-0.599983 --> -0.649984).  Saving model ...
Epoch: 9 cost time: 3.1007773876190186
Epoch: 9, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.444 Vali Acc: 0.644 Test Loss: 1.444 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1469004154205322
Epoch: 10, Steps: 12 | Train Loss: 1.297 Vali Loss: 1.357 Vali Acc: 0.633 Test Loss: 1.357 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2043609619140625
Epoch: 11, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.257 Vali Acc: 0.667 Test Loss: 1.257 Test Acc: 0.667
Validation loss decreased (-0.649984 --> -0.666654).  Saving model ...
Epoch: 12 cost time: 3.3167922496795654
Epoch: 12, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.201 Vali Acc: 0.667 Test Loss: 1.201 Test Acc: 0.667
Validation loss decreased (-0.666654 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 3.0820975303649902
Epoch: 13, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.122 Vali Acc: 0.694 Test Loss: 1.122 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694433).  Saving model ...
Epoch: 14 cost time: 2.9278833866119385
Epoch: 14, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.030 Vali Acc: 0.717 Test Loss: 1.030 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716656).  Saving model ...
Epoch: 15 cost time: 3.1188924312591553
Epoch: 15, Steps: 12 | Train Loss: 0.739 Vali Loss: 0.978 Vali Acc: 0.717 Test Loss: 0.978 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 3.2279083728790283
Epoch: 16, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.928 Vali Acc: 0.728 Test Loss: 0.928 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 17 cost time: 2.783926248550415
Epoch: 17, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.854 Vali Acc: 0.744 Test Loss: 0.854 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 3.0355541706085205
Epoch: 18, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.792 Vali Acc: 0.756 Test Loss: 0.792 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 3.128126382827759
Epoch: 19, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.752 Vali Acc: 0.772 Test Loss: 0.752 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 20 cost time: 3.4060006141662598
Epoch: 20, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.700 Vali Acc: 0.783 Test Loss: 0.700 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 21 cost time: 3.204132556915283
Epoch: 21, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.661 Vali Acc: 0.794 Test Loss: 0.661 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 22 cost time: 3.0493364334106445
Epoch: 22, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2379791736602783
Epoch: 23, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.608 Vali Acc: 0.800 Test Loss: 0.608 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 3.2526047229766846
Epoch: 24, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.575 Vali Acc: 0.822 Test Loss: 0.575 Test Acc: 0.822
Validation loss decreased (-0.799994 --> -0.822216).  Saving model ...
Epoch: 25 cost time: 3.137754201889038
Epoch: 25, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.570 Vali Acc: 0.811 Test Loss: 0.570 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.892491102218628
Epoch: 26, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.536 Vali Acc: 0.828 Test Loss: 0.536 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 27 cost time: 3.1563405990600586
Epoch: 27, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 2.9741973876953125
Epoch: 28, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 2.780259132385254
Epoch: 29, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 2.759733200073242
Epoch: 30, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.469 Vali Acc: 0.839 Test Loss: 0.469 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.9063308238983154
Epoch: 31, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.456 Vali Acc: 0.839 Test Loss: 0.456 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.7501039505004883
Epoch: 32, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.454 Vali Acc: 0.861 Test Loss: 0.454 Test Acc: 0.861
Validation loss decreased (-0.849995 --> -0.861107).  Saving model ...
Epoch: 33 cost time: 3.0881941318511963
Epoch: 33, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.429 Vali Acc: 0.856 Test Loss: 0.429 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.382298231124878
Epoch: 34, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.434 Vali Acc: 0.872 Test Loss: 0.434 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 35 cost time: 3.2080883979797363
Epoch: 35, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.422 Vali Acc: 0.883 Test Loss: 0.422 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 36 cost time: 3.215552806854248
Epoch: 36, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.404 Vali Acc: 0.883 Test Loss: 0.404 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 37 cost time: 3.171705722808838
Epoch: 37, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.413 Vali Acc: 0.894 Test Loss: 0.413 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894440).  Saving model ...
Epoch: 38 cost time: 3.2377023696899414
Epoch: 38, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.404 Vali Acc: 0.878 Test Loss: 0.404 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.839383840560913
Epoch: 39, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.816312789916992
Epoch: 40, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.397 Vali Acc: 0.878 Test Loss: 0.397 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.1020431518554688
Epoch: 41, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.374 Vali Acc: 0.894 Test Loss: 0.374 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894441).  Saving model ...
Epoch: 42 cost time: 3.0129082202911377
Epoch: 42, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.969118118286133
Epoch: 43, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 2.930410623550415
Epoch: 44, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.380 Vali Acc: 0.894 Test Loss: 0.380 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.2677862644195557
Epoch: 45, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.376 Vali Acc: 0.883 Test Loss: 0.376 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.0689749717712402
Epoch: 46, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.372 Vali Acc: 0.883 Test Loss: 0.372 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.281182050704956
Epoch: 47, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.3360464572906494
Epoch: 48, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.365 Vali Acc: 0.894 Test Loss: 0.365 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.5646872520446777
Epoch: 49, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.368 Vali Acc: 0.894 Test Loss: 0.368 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.2286980152130127
Epoch: 50, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.367 Vali Acc: 0.889 Test Loss: 0.367 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.014016628265381
Epoch: 51, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 3.016796827316284
Epoch: 52, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.374 Vali Acc: 0.889 Test Loss: 0.374 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.0081839561462402
Epoch: 53, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.1993930339813232
Epoch: 54, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.018423080444336
Epoch: 55, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.124535083770752
Epoch: 56, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.377 Vali Acc: 0.889 Test Loss: 0.377 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.7799041271209717
Epoch: 57, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.0950236320495605
Epoch: 58, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.1581459045410156
Epoch: 59, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.373 Vali Acc: 0.889 Test Loss: 0.373 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.1875159740448
Epoch: 60, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.360 Vali Acc: 0.894 Test Loss: 0.360 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 2.9275078773498535
Epoch: 61, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.269747495651245
Epoch: 1, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.748 Vali Acc: 0.044 Test Loss: 2.748 Test Acc: 0.044
Validation loss decreased (inf --> -0.044417).  Saving model ...
Epoch: 2 cost time: 3.0019266605377197
Epoch: 2, Steps: 12 | Train Loss: 2.669 Vali Loss: 2.640 Vali Acc: 0.067 Test Loss: 2.640 Test Acc: 0.067
Validation loss decreased (-0.044417 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 2.9467790126800537
Epoch: 3, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.505 Vali Acc: 0.144 Test Loss: 2.505 Test Acc: 0.144
Validation loss decreased (-0.066640 --> -0.144419).  Saving model ...
Epoch: 4 cost time: 3.1389317512512207
Epoch: 4, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.355 Vali Acc: 0.339 Test Loss: 2.355 Test Acc: 0.339
Validation loss decreased (-0.144419 --> -0.338865).  Saving model ...
Epoch: 5 cost time: 3.1895480155944824
Epoch: 5, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.192 Vali Acc: 0.506 Test Loss: 2.192 Test Acc: 0.506
Validation loss decreased (-0.338865 --> -0.505534).  Saving model ...
Epoch: 6 cost time: 2.6448802947998047
Epoch: 6, Steps: 12 | Train Loss: 2.117 Vali Loss: 2.039 Vali Acc: 0.544 Test Loss: 2.039 Test Acc: 0.544
Validation loss decreased (-0.505534 --> -0.544424).  Saving model ...
Epoch: 7 cost time: 2.9065494537353516
Epoch: 7, Steps: 12 | Train Loss: 2.012 Vali Loss: 1.889 Vali Acc: 0.578 Test Loss: 1.889 Test Acc: 0.578
Validation loss decreased (-0.544424 --> -0.577759).  Saving model ...
Epoch: 8 cost time: 3.1052780151367188
Epoch: 8, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.765 Vali Acc: 0.606 Test Loss: 1.765 Test Acc: 0.606
Validation loss decreased (-0.577759 --> -0.605538).  Saving model ...
Epoch: 9 cost time: 3.0170018672943115
Epoch: 9, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.643 Vali Acc: 0.606 Test Loss: 1.643 Test Acc: 0.606
Validation loss decreased (-0.605538 --> -0.605539).  Saving model ...
Epoch: 10 cost time: 3.0723536014556885
Epoch: 10, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.553 Vali Acc: 0.611 Test Loss: 1.553 Test Acc: 0.611
Validation loss decreased (-0.605539 --> -0.611096).  Saving model ...
Epoch: 11 cost time: 3.1796505451202393
Epoch: 11, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.448 Vali Acc: 0.606 Test Loss: 1.448 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.116405487060547
Epoch: 12, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.380 Vali Acc: 0.583 Test Loss: 1.380 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1316494941711426
Epoch: 13, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.292 Vali Acc: 0.622 Test Loss: 1.292 Test Acc: 0.622
Validation loss decreased (-0.611096 --> -0.622209).  Saving model ...
Epoch: 14 cost time: 3.2865347862243652
Epoch: 14, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.197 Vali Acc: 0.656 Test Loss: 1.197 Test Acc: 0.656
Validation loss decreased (-0.622209 --> -0.655544).  Saving model ...
Epoch: 15 cost time: 3.561750650405884
Epoch: 15, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.145 Vali Acc: 0.667 Test Loss: 1.145 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 16 cost time: 3.131469964981079
Epoch: 16, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.092 Vali Acc: 0.667 Test Loss: 1.092 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 17 cost time: 3.276376962661743
Epoch: 17, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.017 Vali Acc: 0.694 Test Loss: 1.017 Test Acc: 0.694
Validation loss decreased (-0.666656 --> -0.694434).  Saving model ...
Epoch: 18 cost time: 3.2429039478302
Epoch: 18, Steps: 12 | Train Loss: 0.736 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
Validation loss decreased (-0.694434 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 3.100674867630005
Epoch: 19, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.892 Vali Acc: 0.728 Test Loss: 0.892 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9742743968963623
Epoch: 20, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.830 Vali Acc: 0.756 Test Loss: 0.830 Test Acc: 0.756
Validation loss decreased (-0.733324 --> -0.755547).  Saving model ...
Epoch: 21 cost time: 3.1205062866210938
Epoch: 21, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.778 Vali Acc: 0.772 Test Loss: 0.778 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 22 cost time: 2.901043653488159
Epoch: 22, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 23 cost time: 3.078669309616089
Epoch: 23, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.708 Vali Acc: 0.817 Test Loss: 0.708 Test Acc: 0.817
Validation loss decreased (-0.783326 --> -0.816660).  Saving model ...
Epoch: 24 cost time: 2.8983089923858643
Epoch: 24, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.668 Vali Acc: 0.811 Test Loss: 0.668 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.982590913772583
Epoch: 25, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.667 Vali Acc: 0.828 Test Loss: 0.667 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 26 cost time: 3.2800192832946777
Epoch: 26, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 3.0943491458892822
Epoch: 27, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.603 Vali Acc: 0.822 Test Loss: 0.603 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.980119466781616
Epoch: 28, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 3.1995511054992676
Epoch: 29, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1482596397399902
Epoch: 30, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 31 cost time: 3.382693290710449
Epoch: 31, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2382991313934326
Epoch: 32, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866661).  Saving model ...
Epoch: 33 cost time: 3.133632183074951
Epoch: 33, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.520 Vali Acc: 0.872 Test Loss: 0.520 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 34 cost time: 3.209986925125122
Epoch: 34, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.519 Vali Acc: 0.883 Test Loss: 0.519 Test Acc: 0.883
Validation loss decreased (-0.872217 --> -0.883328).  Saving model ...
Epoch: 35 cost time: 3.261030912399292
Epoch: 35, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.0382893085479736
Epoch: 36, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883328).  Saving model ...
Epoch: 37 cost time: 3.091550350189209
Epoch: 37, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.478 Vali Acc: 0.883 Test Loss: 0.478 Test Acc: 0.883
Validation loss decreased (-0.883328 --> -0.883329).  Saving model ...
Epoch: 38 cost time: 3.3021111488342285
Epoch: 38, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.475 Vali Acc: 0.883 Test Loss: 0.475 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 39 cost time: 3.0712034702301025
Epoch: 39, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
Validation loss decreased (-0.883329 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 2.994948387145996
Epoch: 40, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.485 Vali Acc: 0.872 Test Loss: 0.485 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.291287422180176
Epoch: 41, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.476 Vali Acc: 0.883 Test Loss: 0.476 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.2866556644439697
Epoch: 42, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.475 Vali Acc: 0.878 Test Loss: 0.475 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.713932991027832
Epoch: 43, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 44 cost time: 3.385983467102051
Epoch: 44, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3616130352020264
Epoch: 45, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.244109630584717
Epoch: 46, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.2258999347686768
Epoch: 47, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.076596260070801
Epoch: 48, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.458 Vali Acc: 0.889 Test Loss: 0.458 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 49 cost time: 2.962357759475708
Epoch: 49, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.463 Vali Acc: 0.883 Test Loss: 0.463 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.283358573913574
Epoch: 50, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.464 Vali Acc: 0.878 Test Loss: 0.464 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.8833236694335938
Epoch: 51, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.459 Vali Acc: 0.883 Test Loss: 0.459 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.9064438343048096
Epoch: 52, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.8262131214141846
Epoch: 53, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.482 Vali Acc: 0.872 Test Loss: 0.482 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.326180934906006
Epoch: 54, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.0741281509399414
Epoch: 55, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.0628745555877686
Epoch: 56, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.479 Vali Acc: 0.883 Test Loss: 0.479 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.164006471633911
Epoch: 57, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.4827420711517334
Epoch: 58, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.492 Vali Acc: 0.883 Test Loss: 0.492 Test Acc: 0.883
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8888888888888888
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.622903347015381
Epoch: 1, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.736 Vali Acc: 0.050 Test Loss: 2.736 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 3.0214731693267822
Epoch: 2, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.651 Vali Acc: 0.094 Test Loss: 2.651 Test Acc: 0.094
Validation loss decreased (-0.049973 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 3.17360782623291
Epoch: 3, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.545 Vali Acc: 0.139 Test Loss: 2.545 Test Acc: 0.139
Validation loss decreased (-0.094418 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 3.0294740200042725
Epoch: 4, Steps: 12 | Train Loss: 2.503 Vali Loss: 2.427 Vali Acc: 0.217 Test Loss: 2.427 Test Acc: 0.217
Validation loss decreased (-0.138863 --> -0.216642).  Saving model ...
Epoch: 5 cost time: 2.96919322013855
Epoch: 5, Steps: 12 | Train Loss: 2.378 Vali Loss: 2.297 Vali Acc: 0.306 Test Loss: 2.297 Test Acc: 0.306
Validation loss decreased (-0.216642 --> -0.305533).  Saving model ...
Epoch: 6 cost time: 3.008096933364868
Epoch: 6, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.174 Vali Acc: 0.306 Test Loss: 2.174 Test Acc: 0.306
Validation loss decreased (-0.305533 --> -0.305534).  Saving model ...
Epoch: 7 cost time: 3.3203070163726807
Epoch: 7, Steps: 12 | Train Loss: 2.151 Vali Loss: 2.055 Vali Acc: 0.394 Test Loss: 2.055 Test Acc: 0.394
Validation loss decreased (-0.305534 --> -0.394424).  Saving model ...
Epoch: 8 cost time: 3.1052780151367188
Epoch: 8, Steps: 12 | Train Loss: 2.038 Vali Loss: 1.957 Vali Acc: 0.411 Test Loss: 1.957 Test Acc: 0.411
Validation loss decreased (-0.394424 --> -0.411092).  Saving model ...
Epoch: 9 cost time: 3.239215135574341
Epoch: 9, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.854 Vali Acc: 0.517 Test Loss: 1.854 Test Acc: 0.517
Validation loss decreased (-0.411092 --> -0.516648).  Saving model ...
Epoch: 10 cost time: 3.0336971282958984
Epoch: 10, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.782 Vali Acc: 0.533 Test Loss: 1.782 Test Acc: 0.533
Validation loss decreased (-0.516648 --> -0.533316).  Saving model ...
Epoch: 11 cost time: 3.121861696243286
Epoch: 11, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.686 Vali Acc: 0.578 Test Loss: 1.686 Test Acc: 0.578
Validation loss decreased (-0.533316 --> -0.577761).  Saving model ...
Epoch: 12 cost time: 3.3805341720581055
Epoch: 12, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.611 Vali Acc: 0.594 Test Loss: 1.611 Test Acc: 0.594
Validation loss decreased (-0.577761 --> -0.594428).  Saving model ...
Epoch: 13 cost time: 2.928220272064209
Epoch: 13, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.520 Vali Acc: 0.622 Test Loss: 1.520 Test Acc: 0.622
Validation loss decreased (-0.594428 --> -0.622207).  Saving model ...
Epoch: 14 cost time: 2.908540964126587
Epoch: 14, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.414 Vali Acc: 0.650 Test Loss: 1.414 Test Acc: 0.650
Validation loss decreased (-0.622207 --> -0.649986).  Saving model ...
Epoch: 15 cost time: 2.7967677116394043
Epoch: 15, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.348 Vali Acc: 0.650 Test Loss: 1.348 Test Acc: 0.650
Validation loss decreased (-0.649986 --> -0.649987).  Saving model ...
Epoch: 16 cost time: 2.818938970565796
Epoch: 16, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.271 Vali Acc: 0.661 Test Loss: 1.271 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 17 cost time: 3.070873260498047
Epoch: 17, Steps: 12 | Train Loss: 0.994 Vali Loss: 1.178 Vali Acc: 0.683 Test Loss: 1.178 Test Acc: 0.683
Validation loss decreased (-0.661098 --> -0.683322).  Saving model ...
Epoch: 18 cost time: 3.0359203815460205
Epoch: 18, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.094 Vali Acc: 0.700 Test Loss: 1.094 Test Acc: 0.700
Validation loss decreased (-0.683322 --> -0.699989).  Saving model ...
Epoch: 19 cost time: 3.251622438430786
Epoch: 19, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.021 Vali Acc: 0.711 Test Loss: 1.021 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711101).  Saving model ...
Epoch: 20 cost time: 3.1599795818328857
Epoch: 20, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.944 Vali Acc: 0.733 Test Loss: 0.944 Test Acc: 0.733
Validation loss decreased (-0.711101 --> -0.733324).  Saving model ...
Epoch: 21 cost time: 3.1055822372436523
Epoch: 21, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.890 Vali Acc: 0.739 Test Loss: 0.890 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 22 cost time: 3.3818118572235107
Epoch: 22, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.849 Vali Acc: 0.739 Test Loss: 0.849 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 23 cost time: 3.234220027923584
Epoch: 23, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.799 Vali Acc: 0.756 Test Loss: 0.799 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755548).  Saving model ...
Epoch: 24 cost time: 3.1164448261260986
Epoch: 24, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.755 Vali Acc: 0.772 Test Loss: 0.755 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 25 cost time: 3.196122884750366
Epoch: 25, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.738 Vali Acc: 0.778 Test Loss: 0.738 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 26 cost time: 2.917630910873413
Epoch: 26, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 2.9447989463806152
Epoch: 27, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.666 Vali Acc: 0.822 Test Loss: 0.666 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 3.176518440246582
Epoch: 28, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.663 Vali Acc: 0.822 Test Loss: 0.663 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 29 cost time: 3.3578312397003174
Epoch: 29, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.622 Vali Acc: 0.811 Test Loss: 0.622 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.013122081756592
Epoch: 30, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.599 Vali Acc: 0.828 Test Loss: 0.599 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827772).  Saving model ...
Epoch: 31 cost time: 3.070359706878662
Epoch: 31, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.569 Vali Acc: 0.822 Test Loss: 0.569 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9903440475463867
Epoch: 32, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.564 Vali Acc: 0.839 Test Loss: 0.564 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 3.3350753784179688
Epoch: 33, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.578 Vali Acc: 0.822 Test Loss: 0.578 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2397003173828125
Epoch: 34, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.559 Vali Acc: 0.839 Test Loss: 0.559 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 35 cost time: 3.1966774463653564
Epoch: 35, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.838883 --> -0.855550).  Saving model ...
Epoch: 36 cost time: 3.4545795917510986
Epoch: 36, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.093914747238159
Epoch: 37, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 38 cost time: 3.2030766010284424
Epoch: 38, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.8595290184020996
Epoch: 39, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.488 Vali Acc: 0.856 Test Loss: 0.488 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.989978551864624
Epoch: 40, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 2.9198362827301025
Epoch: 41, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.490 Vali Acc: 0.861 Test Loss: 0.490 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 42 cost time: 2.9734976291656494
Epoch: 42, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.491 Vali Acc: 0.861 Test Loss: 0.491 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.949559450149536
Epoch: 43, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.476 Vali Acc: 0.867 Test Loss: 0.476 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 44 cost time: 2.787296772003174
Epoch: 44, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.465 Vali Acc: 0.872 Test Loss: 0.465 Test Acc: 0.872
Validation loss decreased (-0.866662 --> -0.872218).  Saving model ...
Epoch: 45 cost time: 3.087100028991699
Epoch: 45, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.3039209842681885
Epoch: 46, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.475 Vali Acc: 0.867 Test Loss: 0.475 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1536037921905518
Epoch: 47, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.457 Vali Acc: 0.872 Test Loss: 0.457 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872218).  Saving model ...
Epoch: 48 cost time: 3.3155367374420166
Epoch: 48, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2554867267608643
Epoch: 49, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.0593700408935547
Epoch: 50, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.477 Vali Acc: 0.883 Test Loss: 0.477 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883329).  Saving model ...
Epoch: 51 cost time: 3.120208740234375
Epoch: 51, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.466 Vali Acc: 0.883 Test Loss: 0.466 Test Acc: 0.883
Validation loss decreased (-0.883329 --> -0.883329).  Saving model ...
Epoch: 52 cost time: 3.1219322681427
Epoch: 52, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.492 Vali Acc: 0.861 Test Loss: 0.492 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.0123136043548584
Epoch: 53, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.481 Vali Acc: 0.867 Test Loss: 0.481 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.8030872344970703
Epoch: 54, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.481 Vali Acc: 0.861 Test Loss: 0.481 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.2811193466186523
Epoch: 55, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.1045050621032715
Epoch: 56, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.466 Vali Acc: 0.872 Test Loss: 0.466 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.080549478530884
Epoch: 57, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.196699619293213
Epoch: 58, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.2519495487213135
Epoch: 59, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.480 Vali Acc: 0.867 Test Loss: 0.480 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.1074094772338867
Epoch: 60, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.490 Vali Acc: 0.878 Test Loss: 0.490 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.0469062328338623
Epoch: 61, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.48373007774353
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.740 Vali Acc: 0.106 Test Loss: 2.740 Test Acc: 0.106
Validation loss decreased (inf --> -0.105528).  Saving model ...
Epoch: 2 cost time: 2.8753278255462646
Epoch: 2, Steps: 12 | Train Loss: 2.711 Vali Loss: 2.682 Vali Acc: 0.139 Test Loss: 2.682 Test Acc: 0.139
Validation loss decreased (-0.105528 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 2.9009640216827393
Epoch: 3, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.608 Vali Acc: 0.133 Test Loss: 2.608 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.275808572769165
Epoch: 4, Steps: 12 | Train Loss: 2.609 Vali Loss: 2.526 Vali Acc: 0.161 Test Loss: 2.526 Test Acc: 0.161
Validation loss decreased (-0.138862 --> -0.161086).  Saving model ...
Epoch: 5 cost time: 2.938152313232422
Epoch: 5, Steps: 12 | Train Loss: 2.514 Vali Loss: 2.437 Vali Acc: 0.233 Test Loss: 2.437 Test Acc: 0.233
Validation loss decreased (-0.161086 --> -0.233309).  Saving model ...
Epoch: 6 cost time: 2.912804126739502
Epoch: 6, Steps: 12 | Train Loss: 2.409 Vali Loss: 2.353 Vali Acc: 0.256 Test Loss: 2.353 Test Acc: 0.256
Validation loss decreased (-0.233309 --> -0.255532).  Saving model ...
Epoch: 7 cost time: 3.0505380630493164
Epoch: 7, Steps: 12 | Train Loss: 2.349 Vali Loss: 2.260 Vali Acc: 0.339 Test Loss: 2.260 Test Acc: 0.339
Validation loss decreased (-0.255532 --> -0.338866).  Saving model ...
Epoch: 8 cost time: 2.8337886333465576
Epoch: 8, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.186 Vali Acc: 0.322 Test Loss: 2.186 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2880465984344482
Epoch: 9, Steps: 12 | Train Loss: 2.129 Vali Loss: 2.092 Vali Acc: 0.350 Test Loss: 2.092 Test Acc: 0.350
Validation loss decreased (-0.338866 --> -0.349979).  Saving model ...
Epoch: 10 cost time: 3.2557168006896973
Epoch: 10, Steps: 12 | Train Loss: 2.099 Vali Loss: 2.019 Vali Acc: 0.367 Test Loss: 2.019 Test Acc: 0.367
Validation loss decreased (-0.349979 --> -0.366646).  Saving model ...
Epoch: 11 cost time: 2.887998342514038
Epoch: 11, Steps: 12 | Train Loss: 1.929 Vali Loss: 1.923 Vali Acc: 0.361 Test Loss: 1.923 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.935734748840332
Epoch: 12, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.838 Vali Acc: 0.439 Test Loss: 1.838 Test Acc: 0.439
Validation loss decreased (-0.366646 --> -0.438871).  Saving model ...
Epoch: 13 cost time: 2.8579022884368896
Epoch: 13, Steps: 12 | Train Loss: 1.725 Vali Loss: 1.745 Vali Acc: 0.456 Test Loss: 1.745 Test Acc: 0.456
Validation loss decreased (-0.438871 --> -0.455538).  Saving model ...
Epoch: 14 cost time: 2.6974868774414062
Epoch: 14, Steps: 12 | Train Loss: 1.581 Vali Loss: 1.628 Vali Acc: 0.483 Test Loss: 1.628 Test Acc: 0.483
Validation loss decreased (-0.455538 --> -0.483317).  Saving model ...
Epoch: 15 cost time: 3.0020036697387695
Epoch: 15, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.517 Vali Acc: 0.572 Test Loss: 1.517 Test Acc: 0.572
Validation loss decreased (-0.483317 --> -0.572207).  Saving model ...
Epoch: 16 cost time: 2.808347225189209
Epoch: 16, Steps: 12 | Train Loss: 1.332 Vali Loss: 1.387 Vali Acc: 0.656 Test Loss: 1.387 Test Acc: 0.656
Validation loss decreased (-0.572207 --> -0.655542).  Saving model ...
Epoch: 17 cost time: 2.8308217525482178
Epoch: 17, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.257 Vali Acc: 0.700 Test Loss: 1.257 Test Acc: 0.700
Validation loss decreased (-0.655542 --> -0.699987).  Saving model ...
Epoch: 18 cost time: 2.7504372596740723
Epoch: 18, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.156 Vali Acc: 0.700 Test Loss: 1.156 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699988).  Saving model ...
Epoch: 19 cost time: 2.888300895690918
Epoch: 19, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.066 Vali Acc: 0.706 Test Loss: 1.066 Test Acc: 0.706
Validation loss decreased (-0.699988 --> -0.705545).  Saving model ...
Epoch: 20 cost time: 2.9123008251190186
Epoch: 20, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.982 Vali Acc: 0.728 Test Loss: 0.982 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727768).  Saving model ...
Epoch: 21 cost time: 2.8425610065460205
Epoch: 21, Steps: 12 | Train Loss: 0.812 Vali Loss: 0.924 Vali Acc: 0.717 Test Loss: 0.924 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.161510467529297
Epoch: 22, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.727768 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 3.370948314666748
Epoch: 23, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.820 Vali Acc: 0.733 Test Loss: 0.820 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.180562734603882
Epoch: 24, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 3.1982243061065674
Epoch: 25, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 26 cost time: 3.1196956634521484
Epoch: 26, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.721 Vali Acc: 0.772 Test Loss: 0.721 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 27 cost time: 3.1811349391937256
Epoch: 27, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.680 Vali Acc: 0.778 Test Loss: 0.680 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 28 cost time: 3.0670063495635986
Epoch: 28, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 29 cost time: 2.768299102783203
Epoch: 29, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.635 Vali Acc: 0.811 Test Loss: 0.635 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 30 cost time: 3.159928321838379
Epoch: 30, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.613 Vali Acc: 0.828 Test Loss: 0.613 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827772).  Saving model ...
Epoch: 31 cost time: 2.982170343399048
Epoch: 31, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.604 Vali Acc: 0.811 Test Loss: 0.604 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.1064672470092773
Epoch: 32, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 33 cost time: 3.0904388427734375
Epoch: 33, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.9636120796203613
Epoch: 34, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.591 Vali Acc: 0.817 Test Loss: 0.591 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.26962947845459
Epoch: 35, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849994).  Saving model ...
Epoch: 36 cost time: 3.1642935276031494
Epoch: 36, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.562 Vali Acc: 0.844 Test Loss: 0.562 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2305939197540283
Epoch: 37, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 38 cost time: 3.3750977516174316
Epoch: 38, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.404043436050415
Epoch: 39, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.543 Vali Acc: 0.861 Test Loss: 0.543 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 40 cost time: 3.4110748767852783
Epoch: 40, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.541 Vali Acc: 0.861 Test Loss: 0.541 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 3.276092290878296
Epoch: 41, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.515 Vali Acc: 0.839 Test Loss: 0.515 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.063760757446289
Epoch: 42, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.1687700748443604
Epoch: 43, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.1634023189544678
Epoch: 44, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.0105204582214355
Epoch: 45, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.522 Vali Acc: 0.856 Test Loss: 0.522 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.0023910999298096
Epoch: 46, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.517 Vali Acc: 0.856 Test Loss: 0.517 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.9986045360565186
Epoch: 47, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.036261796951294
Epoch: 48, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.1350066661834717
Epoch: 49, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.0643019676208496
Epoch: 50, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.518 Vali Acc: 0.861 Test Loss: 0.518 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 51 cost time: 3.260984420776367
Epoch: 51, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.062612295150757
Epoch: 52, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.2787444591522217
Epoch: 53, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.9685654640197754
Epoch: 54, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.8092658519744873
Epoch: 55, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.549 Vali Acc: 0.844 Test Loss: 0.549 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.922436475753784
Epoch: 56, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.9796605110168457
Epoch: 57, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.6605489253997803
Epoch: 58, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.883338689804077
Epoch: 59, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.564 Vali Acc: 0.856 Test Loss: 0.564 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 3.1195406913757324
Epoch: 60, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 61 cost time: 3.133082389831543
Epoch: 61, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.542 Vali Acc: 0.861 Test Loss: 0.542 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.0731899738311768
Epoch: 62, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.1372971534729004
Epoch: 63, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.434647798538208
Epoch: 64, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.264525890350342
Epoch: 65, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 66 cost time: 3.310405731201172
Epoch: 66, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.6259372234344482
Epoch: 67, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.559 Vali Acc: 0.856 Test Loss: 0.559 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.1530606746673584
Epoch: 68, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.570 Vali Acc: 0.861 Test Loss: 0.570 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.1824333667755127
Epoch: 69, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.584 Vali Acc: 0.856 Test Loss: 0.584 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.24287486076355
Epoch: 70, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 2.9345200061798096
Epoch: 71, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.591 Vali Acc: 0.861 Test Loss: 0.591 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 3.0201218128204346
Epoch: 72, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 3.2531282901763916
Epoch: 73, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 3.2167742252349854
Epoch: 74, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.575 Vali Acc: 0.856 Test Loss: 0.575 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 3.2221803665161133
Epoch: 75, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.593 Vali Acc: 0.861 Test Loss: 0.593 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.624797821044922
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.734 Vali Acc: 0.067 Test Loss: 2.734 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 3.068159818649292
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.687 Vali Acc: 0.094 Test Loss: 2.687 Test Acc: 0.094
Validation loss decreased (-0.066639 --> -0.094418).  Saving model ...
Epoch: 3 cost time: 2.630765676498413
Epoch: 3, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.627 Vali Acc: 0.133 Test Loss: 2.627 Test Acc: 0.133
Validation loss decreased (-0.094418 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 2.7534525394439697
Epoch: 4, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.555 Vali Acc: 0.144 Test Loss: 2.555 Test Acc: 0.144
Validation loss decreased (-0.133307 --> -0.144419).  Saving model ...
Epoch: 5 cost time: 2.9855103492736816
Epoch: 5, Steps: 12 | Train Loss: 2.570 Vali Loss: 2.472 Vali Acc: 0.150 Test Loss: 2.472 Test Acc: 0.150
Validation loss decreased (-0.144419 --> -0.149975).  Saving model ...
Epoch: 6 cost time: 2.9565629959106445
Epoch: 6, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.393 Vali Acc: 0.167 Test Loss: 2.393 Test Acc: 0.167
Validation loss decreased (-0.149975 --> -0.166643).  Saving model ...
Epoch: 7 cost time: 2.9140632152557373
Epoch: 7, Steps: 12 | Train Loss: 2.460 Vali Loss: 2.305 Vali Acc: 0.211 Test Loss: 2.305 Test Acc: 0.211
Validation loss decreased (-0.166643 --> -0.211088).  Saving model ...
Epoch: 8 cost time: 2.64823317527771
Epoch: 8, Steps: 12 | Train Loss: 2.405 Vali Loss: 2.234 Vali Acc: 0.244 Test Loss: 2.234 Test Acc: 0.244
Validation loss decreased (-0.211088 --> -0.244422).  Saving model ...
Epoch: 9 cost time: 2.6025779247283936
Epoch: 9, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.151 Vali Acc: 0.244 Test Loss: 2.151 Test Acc: 0.244
Validation loss decreased (-0.244422 --> -0.244423).  Saving model ...
Epoch: 10 cost time: 2.8186874389648438
Epoch: 10, Steps: 12 | Train Loss: 2.259 Vali Loss: 2.085 Vali Acc: 0.300 Test Loss: 2.085 Test Acc: 0.300
Validation loss decreased (-0.244423 --> -0.299979).  Saving model ...
Epoch: 11 cost time: 2.9852263927459717
Epoch: 11, Steps: 12 | Train Loss: 2.121 Vali Loss: 2.008 Vali Acc: 0.306 Test Loss: 2.008 Test Acc: 0.306
Validation loss decreased (-0.299979 --> -0.305535).  Saving model ...
Epoch: 12 cost time: 2.9928884506225586
Epoch: 12, Steps: 12 | Train Loss: 2.051 Vali Loss: 1.925 Vali Acc: 0.350 Test Loss: 1.925 Test Acc: 0.350
Validation loss decreased (-0.305535 --> -0.349981).  Saving model ...
Epoch: 13 cost time: 3.289734125137329
Epoch: 13, Steps: 12 | Train Loss: 1.923 Vali Loss: 1.853 Vali Acc: 0.372 Test Loss: 1.853 Test Acc: 0.372
Validation loss decreased (-0.349981 --> -0.372204).  Saving model ...
Epoch: 14 cost time: 3.144113302230835
Epoch: 14, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.749 Vali Acc: 0.417 Test Loss: 1.749 Test Acc: 0.417
Validation loss decreased (-0.372204 --> -0.416649).  Saving model ...
Epoch: 15 cost time: 3.0216026306152344
Epoch: 15, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.651 Vali Acc: 0.472 Test Loss: 1.651 Test Acc: 0.472
Validation loss decreased (-0.416649 --> -0.472206).  Saving model ...
Epoch: 16 cost time: 3.089632511138916
Epoch: 16, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.544 Vali Acc: 0.506 Test Loss: 1.544 Test Acc: 0.506
Validation loss decreased (-0.472206 --> -0.505540).  Saving model ...
Epoch: 17 cost time: 3.012585163116455
Epoch: 17, Steps: 12 | Train Loss: 1.343 Vali Loss: 1.412 Vali Acc: 0.550 Test Loss: 1.412 Test Acc: 0.550
Validation loss decreased (-0.505540 --> -0.549986).  Saving model ...
Epoch: 18 cost time: 2.9777708053588867
Epoch: 18, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.320 Vali Acc: 0.589 Test Loss: 1.320 Test Acc: 0.589
Validation loss decreased (-0.549986 --> -0.588876).  Saving model ...
Epoch: 19 cost time: 3.0068130493164062
Epoch: 19, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.223 Vali Acc: 0.617 Test Loss: 1.223 Test Acc: 0.617
Validation loss decreased (-0.588876 --> -0.616654).  Saving model ...
Epoch: 20 cost time: 3.1160433292388916
Epoch: 20, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.136 Vali Acc: 0.628 Test Loss: 1.136 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627766).  Saving model ...
Epoch: 21 cost time: 2.970698595046997
Epoch: 21, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.088 Vali Acc: 0.644 Test Loss: 1.088 Test Acc: 0.644
Validation loss decreased (-0.627766 --> -0.644434).  Saving model ...
Epoch: 22 cost time: 3.069617509841919
Epoch: 22, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.017 Vali Acc: 0.689 Test Loss: 1.017 Test Acc: 0.689
Validation loss decreased (-0.644434 --> -0.688879).  Saving model ...
Epoch: 23 cost time: 3.01653790473938
Epoch: 23, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.970 Vali Acc: 0.672 Test Loss: 0.970 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1409733295440674
Epoch: 24, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.915 Vali Acc: 0.694 Test Loss: 0.915 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 25 cost time: 3.1810014247894287
Epoch: 25, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
Validation loss decreased (-0.694435 --> -0.727769).  Saving model ...
Epoch: 26 cost time: 3.2572991847991943
Epoch: 26, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.816 Vali Acc: 0.728 Test Loss: 0.816 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 27 cost time: 2.9904940128326416
Epoch: 27, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.783 Vali Acc: 0.739 Test Loss: 0.783 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 28 cost time: 3.2910940647125244
Epoch: 28, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.763 Vali Acc: 0.744 Test Loss: 0.763 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 29 cost time: 3.2086191177368164
Epoch: 29, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.715 Vali Acc: 0.756 Test Loss: 0.715 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755548).  Saving model ...
Epoch: 30 cost time: 3.1465137004852295
Epoch: 30, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.694 Vali Acc: 0.772 Test Loss: 0.694 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 31 cost time: 2.9231979846954346
Epoch: 31, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.653 Vali Acc: 0.794 Test Loss: 0.653 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794438).  Saving model ...
Epoch: 32 cost time: 3.0551867485046387
Epoch: 32, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.150245189666748
Epoch: 33, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.631 Vali Acc: 0.800 Test Loss: 0.631 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 34 cost time: 2.9915883541107178
Epoch: 34, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 35 cost time: 2.8977339267730713
Epoch: 35, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.582 Vali Acc: 0.806 Test Loss: 0.582 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 36 cost time: 2.9105777740478516
Epoch: 36, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.572 Vali Acc: 0.817 Test Loss: 0.572 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 37 cost time: 3.1174540519714355
Epoch: 37, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 38 cost time: 3.1102986335754395
Epoch: 38, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.554 Vali Acc: 0.811 Test Loss: 0.554 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.0562236309051514
Epoch: 39, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838883).  Saving model ...
Epoch: 40 cost time: 3.0118629932403564
Epoch: 40, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.0870771408081055
Epoch: 41, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.540 Vali Acc: 0.811 Test Loss: 0.540 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.140753984451294
Epoch: 42, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.2702975273132324
Epoch: 43, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.799513816833496
Epoch: 44, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.538 Vali Acc: 0.817 Test Loss: 0.538 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.9610393047332764
Epoch: 45, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.9462342262268066
Epoch: 46, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.530 Vali Acc: 0.822 Test Loss: 0.530 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.0577592849731445
Epoch: 47, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.525 Vali Acc: 0.828 Test Loss: 0.525 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.755282402038574
Epoch: 48, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.8603880405426025
Epoch: 49, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.474964380264282
Epoch: 1, Steps: 12 | Train Loss: 2.843 Vali Loss: 2.784 Vali Acc: 0.083 Test Loss: 2.784 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 2.959400177001953
Epoch: 2, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.703 Vali Acc: 0.122 Test Loss: 2.703 Test Acc: 0.122
Validation loss decreased (-0.083305 --> -0.122195).  Saving model ...
Epoch: 3 cost time: 3.0941450595855713
Epoch: 3, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.607 Vali Acc: 0.156 Test Loss: 2.607 Test Acc: 0.156
Validation loss decreased (-0.122195 --> -0.155529).  Saving model ...
Epoch: 4 cost time: 2.94122052192688
Epoch: 4, Steps: 12 | Train Loss: 2.668 Vali Loss: 2.518 Vali Acc: 0.183 Test Loss: 2.518 Test Acc: 0.183
Validation loss decreased (-0.155529 --> -0.183308).  Saving model ...
Epoch: 5 cost time: 2.993424654006958
Epoch: 5, Steps: 12 | Train Loss: 2.677 Vali Loss: 2.428 Vali Acc: 0.211 Test Loss: 2.428 Test Acc: 0.211
Validation loss decreased (-0.183308 --> -0.211087).  Saving model ...
Epoch: 6 cost time: 2.875587224960327
Epoch: 6, Steps: 12 | Train Loss: 2.592 Vali Loss: 2.354 Vali Acc: 0.244 Test Loss: 2.354 Test Acc: 0.244
Validation loss decreased (-0.211087 --> -0.244421).  Saving model ...
Epoch: 7 cost time: 2.873528480529785
Epoch: 7, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.277 Vali Acc: 0.272 Test Loss: 2.277 Test Acc: 0.272
Validation loss decreased (-0.244421 --> -0.272199).  Saving model ...
Epoch: 8 cost time: 3.0867724418640137
Epoch: 8, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.225 Vali Acc: 0.300 Test Loss: 2.225 Test Acc: 0.300
Validation loss decreased (-0.272199 --> -0.299978).  Saving model ...
Epoch: 9 cost time: 3.0043914318084717
Epoch: 9, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.154 Vali Acc: 0.306 Test Loss: 2.154 Test Acc: 0.306
Validation loss decreased (-0.299978 --> -0.305534).  Saving model ...
Epoch: 10 cost time: 3.126570224761963
Epoch: 10, Steps: 12 | Train Loss: 2.294 Vali Loss: 2.102 Vali Acc: 0.300 Test Loss: 2.102 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1622841358184814
Epoch: 11, Steps: 12 | Train Loss: 2.226 Vali Loss: 2.040 Vali Acc: 0.289 Test Loss: 2.040 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2198550701141357
Epoch: 12, Steps: 12 | Train Loss: 2.108 Vali Loss: 1.967 Vali Acc: 0.339 Test Loss: 1.967 Test Acc: 0.339
Validation loss decreased (-0.305534 --> -0.338869).  Saving model ...
Epoch: 13 cost time: 3.238719940185547
Epoch: 13, Steps: 12 | Train Loss: 1.992 Vali Loss: 1.880 Vali Acc: 0.378 Test Loss: 1.880 Test Acc: 0.378
Validation loss decreased (-0.338869 --> -0.377759).  Saving model ...
Epoch: 14 cost time: 3.103241443634033
Epoch: 14, Steps: 12 | Train Loss: 1.851 Vali Loss: 1.774 Vali Acc: 0.394 Test Loss: 1.774 Test Acc: 0.394
Validation loss decreased (-0.377759 --> -0.394427).  Saving model ...
Epoch: 15 cost time: 3.0109128952026367
Epoch: 15, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.694 Vali Acc: 0.433 Test Loss: 1.694 Test Acc: 0.433
Validation loss decreased (-0.394427 --> -0.433316).  Saving model ...
Epoch: 16 cost time: 3.059361219406128
Epoch: 16, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.592 Vali Acc: 0.439 Test Loss: 1.592 Test Acc: 0.439
Validation loss decreased (-0.433316 --> -0.438873).  Saving model ...
Epoch: 17 cost time: 3.055884599685669
Epoch: 17, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.448 Vali Acc: 0.517 Test Loss: 1.448 Test Acc: 0.517
Validation loss decreased (-0.438873 --> -0.516652).  Saving model ...
Epoch: 18 cost time: 2.978872060775757
Epoch: 18, Steps: 12 | Train Loss: 1.317 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
Validation loss decreased (-0.516652 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 2.9353902339935303
Epoch: 19, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.254 Vali Acc: 0.611 Test Loss: 1.254 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611099).  Saving model ...
Epoch: 20 cost time: 2.9939403533935547
Epoch: 20, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.163 Vali Acc: 0.661 Test Loss: 1.163 Test Acc: 0.661
Validation loss decreased (-0.611099 --> -0.661099).  Saving model ...
Epoch: 21 cost time: 3.1824114322662354
Epoch: 21, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.101 Vali Acc: 0.633 Test Loss: 1.101 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2299482822418213
Epoch: 22, Steps: 12 | Train Loss: 0.868 Vali Loss: 1.016 Vali Acc: 0.694 Test Loss: 1.016 Test Acc: 0.694
Validation loss decreased (-0.661099 --> -0.694434).  Saving model ...
Epoch: 23 cost time: 3.2275404930114746
Epoch: 23, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.955 Vali Acc: 0.683 Test Loss: 0.955 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2553343772888184
Epoch: 24, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.887 Vali Acc: 0.711 Test Loss: 0.887 Test Acc: 0.711
Validation loss decreased (-0.694434 --> -0.711102).  Saving model ...
Epoch: 25 cost time: 3.3327252864837646
Epoch: 25, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 26 cost time: 3.0673022270202637
Epoch: 26, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716659).  Saving model ...
Epoch: 27 cost time: 3.097766637802124
Epoch: 27, Steps: 12 | Train Loss: 0.634 Vali Loss: 0.763 Vali Acc: 0.756 Test Loss: 0.763 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 3.0077762603759766
Epoch: 28, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772215).  Saving model ...
Epoch: 29 cost time: 3.2203359603881836
Epoch: 29, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.685 Vali Acc: 0.761 Test Loss: 0.685 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.988348960876465
Epoch: 30, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788882).  Saving model ...
Epoch: 31 cost time: 3.179762125015259
Epoch: 31, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 32 cost time: 3.4394822120666504
Epoch: 32, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.618 Vali Acc: 0.800 Test Loss: 0.618 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.384277582168579
Epoch: 33, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.601 Vali Acc: 0.811 Test Loss: 0.601 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 34 cost time: 3.357834815979004
Epoch: 34, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.593 Vali Acc: 0.794 Test Loss: 0.593 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.2888665199279785
Epoch: 35, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 36 cost time: 3.5965962409973145
Epoch: 36, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.4268951416015625
Epoch: 37, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.2439093589782715
Epoch: 38, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.550 Vali Acc: 0.833 Test Loss: 0.550 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 39 cost time: 3.0714104175567627
Epoch: 39, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.833328 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 3.150743007659912
Epoch: 40, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.552 Vali Acc: 0.844 Test Loss: 0.552 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2916617393493652
Epoch: 41, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.0416781902313232
Epoch: 42, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.547 Vali Acc: 0.839 Test Loss: 0.547 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.0428109169006348
Epoch: 43, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 44 cost time: 3.3083369731903076
Epoch: 44, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.521 Vali Acc: 0.856 Test Loss: 0.521 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 45 cost time: 3.3183939456939697
Epoch: 45, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.2494542598724365
Epoch: 46, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.165628433227539
Epoch: 47, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.259998321533203
Epoch: 48, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.1872949600219727
Epoch: 49, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.9588425159454346
Epoch: 50, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.8577687740325928
Epoch: 51, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.514 Vali Acc: 0.839 Test Loss: 0.514 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.0542354583740234
Epoch: 52, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.515 Vali Acc: 0.844 Test Loss: 0.515 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.857064723968506
Epoch: 53, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.511 Vali Acc: 0.839 Test Loss: 0.511 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.9726715087890625
Epoch: 54, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.341294765472412
Epoch: 1, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.858 Vali Acc: 0.106 Test Loss: 2.858 Test Acc: 0.106
Validation loss decreased (inf --> -0.105527).  Saving model ...
Epoch: 2 cost time: 3.257504940032959
Epoch: 2, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.809 Vali Acc: 0.128 Test Loss: 2.809 Test Acc: 0.128
Validation loss decreased (-0.105527 --> -0.127750).  Saving model ...
Epoch: 3 cost time: 3.35768985748291
Epoch: 3, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.744 Vali Acc: 0.128 Test Loss: 2.744 Test Acc: 0.128
Validation loss decreased (-0.127750 --> -0.127750).  Saving model ...
Epoch: 4 cost time: 3.369520902633667
Epoch: 4, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.666 Vali Acc: 0.156 Test Loss: 2.666 Test Acc: 0.156
Validation loss decreased (-0.127750 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 3.3198695182800293
Epoch: 5, Steps: 12 | Train Loss: 2.693 Vali Loss: 2.572 Vali Acc: 0.150 Test Loss: 2.572 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.197340965270996
Epoch: 6, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.476 Vali Acc: 0.211 Test Loss: 2.476 Test Acc: 0.211
Validation loss decreased (-0.155529 --> -0.211086).  Saving model ...
Epoch: 7 cost time: 2.9298095703125
Epoch: 7, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.370 Vali Acc: 0.289 Test Loss: 2.370 Test Acc: 0.289
Validation loss decreased (-0.211086 --> -0.288865).  Saving model ...
Epoch: 8 cost time: 3.2385218143463135
Epoch: 8, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.280 Vali Acc: 0.339 Test Loss: 2.280 Test Acc: 0.339
Validation loss decreased (-0.288865 --> -0.338866).  Saving model ...
Epoch: 9 cost time: 3.0368270874023438
Epoch: 9, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.180 Vali Acc: 0.344 Test Loss: 2.180 Test Acc: 0.344
Validation loss decreased (-0.338866 --> -0.344423).  Saving model ...
Epoch: 10 cost time: 2.949154853820801
Epoch: 10, Steps: 12 | Train Loss: 2.360 Vali Loss: 2.104 Vali Acc: 0.344 Test Loss: 2.104 Test Acc: 0.344
Validation loss decreased (-0.344423 --> -0.344423).  Saving model ...
Epoch: 11 cost time: 3.116771697998047
Epoch: 11, Steps: 12 | Train Loss: 2.266 Vali Loss: 2.019 Vali Acc: 0.372 Test Loss: 2.019 Test Acc: 0.372
Validation loss decreased (-0.344423 --> -0.372202).  Saving model ...
Epoch: 12 cost time: 3.046739339828491
Epoch: 12, Steps: 12 | Train Loss: 2.128 Vali Loss: 1.944 Vali Acc: 0.422 Test Loss: 1.944 Test Acc: 0.422
Validation loss decreased (-0.372202 --> -0.422203).  Saving model ...
Epoch: 13 cost time: 3.2499663829803467
Epoch: 13, Steps: 12 | Train Loss: 2.049 Vali Loss: 1.867 Vali Acc: 0.439 Test Loss: 1.867 Test Acc: 0.439
Validation loss decreased (-0.422203 --> -0.438870).  Saving model ...
Epoch: 14 cost time: 3.2244925498962402
Epoch: 14, Steps: 12 | Train Loss: 1.909 Vali Loss: 1.760 Vali Acc: 0.456 Test Loss: 1.760 Test Acc: 0.456
Validation loss decreased (-0.438870 --> -0.455538).  Saving model ...
Epoch: 15 cost time: 3.257579803466797
Epoch: 15, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.670 Vali Acc: 0.489 Test Loss: 1.670 Test Acc: 0.489
Validation loss decreased (-0.455538 --> -0.488872).  Saving model ...
Epoch: 16 cost time: 3.463679790496826
Epoch: 16, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.555 Vali Acc: 0.522 Test Loss: 1.555 Test Acc: 0.522
Validation loss decreased (-0.488872 --> -0.522207).  Saving model ...
Epoch: 17 cost time: 3.4505105018615723
Epoch: 17, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.432 Vali Acc: 0.589 Test Loss: 1.432 Test Acc: 0.589
Validation loss decreased (-0.522207 --> -0.588875).  Saving model ...
Epoch: 18 cost time: 2.993075132369995
Epoch: 18, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.330 Vali Acc: 0.578 Test Loss: 1.330 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.94258189201355
Epoch: 19, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.229 Vali Acc: 0.656 Test Loss: 1.229 Test Acc: 0.656
Validation loss decreased (-0.588875 --> -0.655543).  Saving model ...
Epoch: 20 cost time: 3.0807113647460938
Epoch: 20, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0043909549713135
Epoch: 21, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.063 Vali Acc: 0.667 Test Loss: 1.063 Test Acc: 0.667
Validation loss decreased (-0.655543 --> -0.666656).  Saving model ...
Epoch: 22 cost time: 2.9074270725250244
Epoch: 22, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.987 Vali Acc: 0.706 Test Loss: 0.987 Test Acc: 0.706
Validation loss decreased (-0.666656 --> -0.705546).  Saving model ...
Epoch: 23 cost time: 3.1503069400787354
Epoch: 23, Steps: 12 | Train Loss: 0.917 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9884917736053467
Epoch: 24, Steps: 12 | Train Loss: 0.778 Vali Loss: 0.861 Vali Acc: 0.739 Test Loss: 0.861 Test Acc: 0.739
Validation loss decreased (-0.705546 --> -0.738880).  Saving model ...
Epoch: 25 cost time: 3.3945233821868896
Epoch: 25, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.834 Vali Acc: 0.728 Test Loss: 0.834 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.217036247253418
Epoch: 26, Steps: 12 | Train Loss: 0.656 Vali Loss: 0.783 Vali Acc: 0.728 Test Loss: 0.783 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0898945331573486
Epoch: 27, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.743 Vali Acc: 0.733 Test Loss: 0.743 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.1185379028320312
Epoch: 28, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761104).  Saving model ...
Epoch: 29 cost time: 3.2244949340820312
Epoch: 29, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.661 Vali Acc: 0.767 Test Loss: 0.661 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 30 cost time: 3.616830348968506
Epoch: 30, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788883).  Saving model ...
Epoch: 31 cost time: 3.0390381813049316
Epoch: 31, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9492745399475098
Epoch: 32, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
Validation loss decreased (-0.788883 --> -0.788883).  Saving model ...
Epoch: 33 cost time: 3.0819382667541504
Epoch: 33, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.601 Vali Acc: 0.806 Test Loss: 0.601 Test Acc: 0.806
Validation loss decreased (-0.788883 --> -0.805550).  Saving model ...
Epoch: 34 cost time: 3.179910898208618
Epoch: 34, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
Validation loss decreased (-0.805550 --> -0.822216).  Saving model ...
Epoch: 35 cost time: 3.017435073852539
Epoch: 35, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.547 Vali Acc: 0.817 Test Loss: 0.547 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.304839611053467
Epoch: 36, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.539 Vali Acc: 0.839 Test Loss: 0.539 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 37 cost time: 3.2189478874206543
Epoch: 37, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.524 Vali Acc: 0.817 Test Loss: 0.524 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.2793467044830322
Epoch: 38, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.2691171169281006
Epoch: 39, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.1758151054382324
Epoch: 40, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 41 cost time: 3.247203826904297
Epoch: 41, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.190467357635498
Epoch: 42, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.521 Vali Acc: 0.839 Test Loss: 0.521 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 43 cost time: 3.0048398971557617
Epoch: 43, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.103635787963867
Epoch: 44, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.1506268978118896
Epoch: 45, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.509 Vali Acc: 0.839 Test Loss: 0.509 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 46 cost time: 3.1434953212738037
Epoch: 46, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.094895839691162
Epoch: 47, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.487 Vali Acc: 0.844 Test Loss: 0.487 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 48 cost time: 2.937635898590088
Epoch: 48, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.507 Vali Acc: 0.839 Test Loss: 0.507 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.1520020961761475
Epoch: 49, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.503 Vali Acc: 0.839 Test Loss: 0.503 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.112813949584961
Epoch: 50, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.499 Vali Acc: 0.844 Test Loss: 0.499 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.5125222206115723
Epoch: 51, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.503 Vali Acc: 0.839 Test Loss: 0.503 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.833314895629883
Epoch: 52, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.508 Vali Acc: 0.844 Test Loss: 0.508 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.1281471252441406
Epoch: 53, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.497 Vali Acc: 0.839 Test Loss: 0.497 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.2577037811279297
Epoch: 54, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 55 cost time: 2.9510726928710938
Epoch: 55, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 56 cost time: 2.8276259899139404
Epoch: 56, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.495 Vali Acc: 0.844 Test Loss: 0.495 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.0009264945983887
Epoch: 57, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.9042272567749023
Epoch: 58, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.512 Vali Acc: 0.839 Test Loss: 0.512 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.755852460861206
Epoch: 59, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.7293453216552734
Epoch: 60, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.7859294414520264
Epoch: 61, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.509 Vali Acc: 0.839 Test Loss: 0.509 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 2.654869556427002
Epoch: 62, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.0075886249542236
Epoch: 63, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.129750967025757
Epoch: 64, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.390463352203369
Epoch: 65, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.516 Vali Acc: 0.856 Test Loss: 0.516 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 66 cost time: 3.0767056941986084
Epoch: 66, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.305797815322876
Epoch: 67, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.1255943775177
Epoch: 68, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.3801403045654297
Epoch: 69, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.3944666385650635
Epoch: 70, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 2.9993975162506104
Epoch: 71, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 3.3926007747650146
Epoch: 72, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.550 Vali Acc: 0.856 Test Loss: 0.550 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 3.2804019451141357
Epoch: 73, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 3.0940871238708496
Epoch: 74, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.538 Vali Acc: 0.856 Test Loss: 0.538 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 3.460827589035034
Epoch: 75, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.872 Test Loss: 0.548 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 76 cost time: 3.4762415885925293
Epoch: 76, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.546 Vali Acc: 0.839 Test Loss: 0.546 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.1257212162017822
Epoch: 77, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.552 Vali Acc: 0.861 Test Loss: 0.552 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.174630641937256
Epoch: 78, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.4019696712493896
Epoch: 79, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 3.4404666423797607
Epoch: 80, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.569 Vali Acc: 0.861 Test Loss: 0.569 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 3.3707306385040283
Epoch: 81, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 3.2356560230255127
Epoch: 82, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 3.3396694660186768
Epoch: 83, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.576 Vali Acc: 0.872 Test Loss: 0.576 Test Acc: 0.872
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 3.040743350982666
Epoch: 84, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 3.0288193225860596
Epoch: 85, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.591 Vali Acc: 0.856 Test Loss: 0.591 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.418976306915283
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 3.4856131076812744
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9379656314849854
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.300051689147949
Epoch: 4, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0490641593933105
Epoch: 5, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 6 cost time: 3.109668254852295
Epoch: 6, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 7 cost time: 2.9303505420684814
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 2.8194057941436768
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.954780101776123
Epoch: 9, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.046034812927246
Epoch: 10, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8615591526031494
Epoch: 11, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 12 cost time: 2.985522747039795
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 13 cost time: 3.2154409885406494
Epoch: 13, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 14 cost time: 3.3635776042938232
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 15 cost time: 3.214552402496338
Epoch: 15, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4434690475463867
Epoch: 16, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.312044620513916
Epoch: 17, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 18 cost time: 3.05578875541687
Epoch: 18, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 19 cost time: 3.0300467014312744
Epoch: 19, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.900615930557251
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 21 cost time: 2.9596471786499023
Epoch: 21, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.900578022003174
Epoch: 22, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 23 cost time: 3.1739909648895264
Epoch: 23, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 24 cost time: 2.9619123935699463
Epoch: 24, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7531089782714844
Epoch: 25, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.9569332599639893
Epoch: 26, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 27 cost time: 3.1653523445129395
Epoch: 27, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 28 cost time: 3.2131032943725586
Epoch: 28, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.298942804336548
Epoch: 29, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.98919677734375
Epoch: 30, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 31 cost time: 2.903062343597412
Epoch: 31, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 32 cost time: 3.184354782104492
Epoch: 32, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 33 cost time: 3.2197721004486084
Epoch: 33, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8223721981048584
Epoch: 34, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0400705337524414
Epoch: 35, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.387378215789795
Epoch: 36, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.1729514598846436
Epoch: 37, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.894676685333252
Epoch: 38, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.1556270122528076
Epoch: 39, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.0227885246276855
Epoch: 40, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.9990594387054443
Epoch: 41, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 42 cost time: 3.0115466117858887
Epoch: 42, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 43 cost time: 3.3723132610321045
Epoch: 43, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 44 cost time: 3.3619697093963623
Epoch: 44, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3563272953033447
Epoch: 45, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 46 cost time: 3.268542766571045
Epoch: 46, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.89609956741333
Epoch: 47, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.03342866897583
Epoch: 48, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.387765884399414
Epoch: 49, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 50 cost time: 2.9581310749053955
Epoch: 50, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 51 cost time: 3.5148720741271973
Epoch: 51, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 52 cost time: 3.279343366622925
Epoch: 52, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.2096107006073
Epoch: 53, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 54 cost time: 3.174146890640259
Epoch: 54, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.4334957599639893
Epoch: 55, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.389967918395996
Epoch: 56, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.2298738956451416
Epoch: 57, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.074740409851074
Epoch: 58, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.3325815200805664
Epoch: 59, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.3343000411987305
Epoch: 60, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.3309543132781982
Epoch: 61, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.1846766471862793
Epoch: 62, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.2523257732391357
Epoch: 63, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 64 cost time: 3.3192203044891357
Epoch: 64, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 65 cost time: 3.3276147842407227
Epoch: 65, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.097132444381714
Epoch: 66, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.4726057052612305
Epoch: 67, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 3.334913492202759
Epoch: 68, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 2.7574210166931152
Epoch: 69, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 2.8412411212921143
Epoch: 70, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 2.8350884914398193
Epoch: 71, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 2.819470167160034
Epoch: 72, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 2.6691393852233887
Epoch: 73, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 2.635908842086792
Epoch: 74, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 149327
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.651787757873535
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.674 Vali Acc: 0.050 Test Loss: 2.674 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 3.2798895835876465
Epoch: 2, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.544 Vali Acc: 0.178 Test Loss: 2.544 Test Acc: 0.178
Validation loss decreased (-0.049973 --> -0.177752).  Saving model ...
Epoch: 3 cost time: 3.2230165004730225
Epoch: 3, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.378 Vali Acc: 0.339 Test Loss: 2.378 Test Acc: 0.339
Validation loss decreased (-0.177752 --> -0.338865).  Saving model ...
Epoch: 4 cost time: 3.096597909927368
Epoch: 4, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.206 Vali Acc: 0.394 Test Loss: 2.206 Test Acc: 0.394
Validation loss decreased (-0.338865 --> -0.394422).  Saving model ...
Epoch: 5 cost time: 3.019805669784546
Epoch: 5, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.035 Vali Acc: 0.456 Test Loss: 2.035 Test Acc: 0.456
Validation loss decreased (-0.394422 --> -0.455535).  Saving model ...
Epoch: 6 cost time: 3.0291571617126465
Epoch: 6, Steps: 12 | Train Loss: 1.948 Vali Loss: 1.875 Vali Acc: 0.528 Test Loss: 1.875 Test Acc: 0.528
Validation loss decreased (-0.455535 --> -0.527759).  Saving model ...
Epoch: 7 cost time: 3.2068846225738525
Epoch: 7, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.717 Vali Acc: 0.567 Test Loss: 1.717 Test Acc: 0.567
Validation loss decreased (-0.527759 --> -0.566649).  Saving model ...
Epoch: 8 cost time: 2.8620002269744873
Epoch: 8, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.575 Vali Acc: 0.611 Test Loss: 1.575 Test Acc: 0.611
Validation loss decreased (-0.566649 --> -0.611095).  Saving model ...
Epoch: 9 cost time: 3.527086019515991
Epoch: 9, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.465 Vali Acc: 0.622 Test Loss: 1.465 Test Acc: 0.622
Validation loss decreased (-0.611095 --> -0.622208).  Saving model ...
Epoch: 10 cost time: 3.087897539138794
Epoch: 10, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.365 Vali Acc: 0.633 Test Loss: 1.365 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633320).  Saving model ...
Epoch: 11 cost time: 3.471869945526123
Epoch: 11, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.264 Vali Acc: 0.661 Test Loss: 1.264 Test Acc: 0.661
Validation loss decreased (-0.633320 --> -0.661098).  Saving model ...
Epoch: 12 cost time: 3.3520963191986084
Epoch: 12, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.183 Vali Acc: 0.706 Test Loss: 1.183 Test Acc: 0.706
Validation loss decreased (-0.661098 --> -0.705544).  Saving model ...
Epoch: 13 cost time: 3.413219690322876
Epoch: 13, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.126 Vali Acc: 0.706 Test Loss: 1.126 Test Acc: 0.706
Validation loss decreased (-0.705544 --> -0.705544).  Saving model ...
Epoch: 14 cost time: 3.658644199371338
Epoch: 14, Steps: 12 | Train Loss: 0.841 Vali Loss: 1.057 Vali Acc: 0.717 Test Loss: 1.057 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716656).  Saving model ...
Epoch: 15 cost time: 3.7422869205474854
Epoch: 15, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.000 Vali Acc: 0.717 Test Loss: 1.000 Test Acc: 0.717
Validation loss decreased (-0.716656 --> -0.716657).  Saving model ...
Epoch: 16 cost time: 3.282033681869507
Epoch: 16, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.931 Vali Acc: 0.717 Test Loss: 0.931 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 17 cost time: 3.1889195442199707
Epoch: 17, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 18 cost time: 3.142036199569702
Epoch: 18, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.844 Vali Acc: 0.750 Test Loss: 0.844 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 2.898521900177002
Epoch: 19, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761103).  Saving model ...
Epoch: 20 cost time: 3.057825803756714
Epoch: 20, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.739 Vali Acc: 0.778 Test Loss: 0.739 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 21 cost time: 3.155226945877075
Epoch: 21, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 3.012441396713257
Epoch: 22, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822216).  Saving model ...
Epoch: 23 cost time: 3.863976001739502
Epoch: 23, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.623 Vali Acc: 0.817 Test Loss: 0.623 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3994336128234863
Epoch: 24, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 3.4911012649536133
Epoch: 25, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.557 Vali Acc: 0.839 Test Loss: 0.557 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838883).  Saving model ...
Epoch: 26 cost time: 3.2116787433624268
Epoch: 26, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849995).  Saving model ...
Epoch: 27 cost time: 3.4499826431274414
Epoch: 27, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.504 Vali Acc: 0.856 Test Loss: 0.504 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 28 cost time: 3.142179250717163
Epoch: 28, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
Validation loss decreased (-0.855551 --> -0.866662).  Saving model ...
Epoch: 29 cost time: 2.8980393409729004
Epoch: 29, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 30 cost time: 3.433347225189209
Epoch: 30, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.406822443008423
Epoch: 31, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.434 Vali Acc: 0.878 Test Loss: 0.434 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 32 cost time: 3.338064193725586
Epoch: 32, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.415 Vali Acc: 0.894 Test Loss: 0.415 Test Acc: 0.894
Validation loss decreased (-0.877773 --> -0.894440).  Saving model ...
Epoch: 33 cost time: 3.5322036743164062
Epoch: 33, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.400 Vali Acc: 0.894 Test Loss: 0.400 Test Acc: 0.894
Validation loss decreased (-0.894440 --> -0.894440).  Saving model ...
Epoch: 34 cost time: 3.6090378761291504
Epoch: 34, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.387 Vali Acc: 0.872 Test Loss: 0.387 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3709604740142822
Epoch: 35, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.5878212451934814
Epoch: 36, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.363 Vali Acc: 0.883 Test Loss: 0.363 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.4109959602355957
Epoch: 37, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.383823871612549
Epoch: 38, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
Validation loss decreased (-0.894440 --> -0.911108).  Saving model ...
Epoch: 39 cost time: 3.2668113708496094
Epoch: 39, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.290706157684326
Epoch: 40, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.1287038326263428
Epoch: 41, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.2340729236602783
Epoch: 42, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.370384931564331
Epoch: 43, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.3309762477874756
Epoch: 44, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.327 Vali Acc: 0.883 Test Loss: 0.327 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.8527560234069824
Epoch: 45, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.330 Vali Acc: 0.911 Test Loss: 0.330 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 46 cost time: 3.0659291744232178
Epoch: 46, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 47 cost time: 3.40273380279541
Epoch: 47, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.343414545059204
Epoch: 48, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.1187033653259277
Epoch: 49, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916663).  Saving model ...
Epoch: 50 cost time: 3.126162528991699
Epoch: 50, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.115328788757324
Epoch: 51, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.8255679607391357
Epoch: 52, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.235478401184082
Epoch: 53, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.312 Vali Acc: 0.917 Test Loss: 0.312 Test Acc: 0.917
Validation loss decreased (-0.916663 --> -0.916664).  Saving model ...
Epoch: 54 cost time: 2.954005479812622
Epoch: 54, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.8690695762634277
Epoch: 55, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.338 Vali Acc: 0.906 Test Loss: 0.338 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.026834011077881
Epoch: 56, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.334 Vali Acc: 0.917 Test Loss: 0.334 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.9449198246002197
Epoch: 57, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.0900228023529053
Epoch: 58, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.330 Vali Acc: 0.911 Test Loss: 0.330 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 3.1496291160583496
Epoch: 59, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.107008695602417
Epoch: 60, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.906 Test Loss: 0.332 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.3852155208587646
Epoch: 61, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.380725860595703
Epoch: 62, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.36698055267334
Epoch: 63, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9166666666666666
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.321597576141357
Epoch: 1, Steps: 12 | Train Loss: 2.744 Vali Loss: 2.676 Vali Acc: 0.061 Test Loss: 2.676 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 2.9693081378936768
Epoch: 2, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.577 Vali Acc: 0.128 Test Loss: 2.577 Test Acc: 0.128
Validation loss decreased (-0.061084 --> -0.127752).  Saving model ...
Epoch: 3 cost time: 2.9291417598724365
Epoch: 3, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.448 Vali Acc: 0.233 Test Loss: 2.448 Test Acc: 0.233
Validation loss decreased (-0.127752 --> -0.233309).  Saving model ...
Epoch: 4 cost time: 3.034940242767334
Epoch: 4, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.312 Vali Acc: 0.400 Test Loss: 2.312 Test Acc: 0.400
Validation loss decreased (-0.233309 --> -0.399977).  Saving model ...
Epoch: 5 cost time: 3.0254876613616943
Epoch: 5, Steps: 12 | Train Loss: 2.259 Vali Loss: 2.171 Vali Acc: 0.472 Test Loss: 2.171 Test Acc: 0.472
Validation loss decreased (-0.399977 --> -0.472201).  Saving model ...
Epoch: 6 cost time: 3.03452730178833
Epoch: 6, Steps: 12 | Train Loss: 2.122 Vali Loss: 2.035 Vali Acc: 0.528 Test Loss: 2.035 Test Acc: 0.528
Validation loss decreased (-0.472201 --> -0.527757).  Saving model ...
Epoch: 7 cost time: 3.175259828567505
Epoch: 7, Steps: 12 | Train Loss: 1.988 Vali Loss: 1.894 Vali Acc: 0.550 Test Loss: 1.894 Test Acc: 0.550
Validation loss decreased (-0.527757 --> -0.549981).  Saving model ...
Epoch: 8 cost time: 3.314600706100464
Epoch: 8, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.761 Vali Acc: 0.567 Test Loss: 1.761 Test Acc: 0.567
Validation loss decreased (-0.549981 --> -0.566649).  Saving model ...
Epoch: 9 cost time: 3.3245441913604736
Epoch: 9, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.654 Vali Acc: 0.589 Test Loss: 1.654 Test Acc: 0.589
Validation loss decreased (-0.566649 --> -0.588872).  Saving model ...
Epoch: 10 cost time: 2.986875534057617
Epoch: 10, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.551 Vali Acc: 0.578 Test Loss: 1.551 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.161712646484375
Epoch: 11, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.442 Vali Acc: 0.617 Test Loss: 1.442 Test Acc: 0.617
Validation loss decreased (-0.588872 --> -0.616652).  Saving model ...
Epoch: 12 cost time: 3.158921957015991
Epoch: 12, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.351 Vali Acc: 0.628 Test Loss: 1.351 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627764).  Saving model ...
Epoch: 13 cost time: 3.067042589187622
Epoch: 13, Steps: 12 | Train Loss: 1.201 Vali Loss: 1.282 Vali Acc: 0.656 Test Loss: 1.282 Test Acc: 0.656
Validation loss decreased (-0.627764 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 3.0132288932800293
Epoch: 14, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.203 Vali Acc: 0.683 Test Loss: 1.203 Test Acc: 0.683
Validation loss decreased (-0.655543 --> -0.683321).  Saving model ...
Epoch: 15 cost time: 2.9633190631866455
Epoch: 15, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.136 Vali Acc: 0.683 Test Loss: 1.136 Test Acc: 0.683
Validation loss decreased (-0.683321 --> -0.683322).  Saving model ...
Epoch: 16 cost time: 2.784968376159668
Epoch: 16, Steps: 12 | Train Loss: 0.883 Vali Loss: 1.042 Vali Acc: 0.706 Test Loss: 1.042 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705545).  Saving model ...
Epoch: 17 cost time: 2.9331166744232178
Epoch: 17, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.973 Vali Acc: 0.733 Test Loss: 0.973 Test Acc: 0.733
Validation loss decreased (-0.705545 --> -0.733324).  Saving model ...
Epoch: 18 cost time: 2.7209229469299316
Epoch: 18, Steps: 12 | Train Loss: 0.784 Vali Loss: 0.916 Vali Acc: 0.761 Test Loss: 0.916 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761102).  Saving model ...
Epoch: 19 cost time: 2.742774486541748
Epoch: 19, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.854 Vali Acc: 0.789 Test Loss: 0.854 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788880).  Saving model ...
Epoch: 20 cost time: 3.1022720336914062
Epoch: 20, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.805 Vali Acc: 0.794 Test Loss: 0.805 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794436).  Saving model ...
Epoch: 21 cost time: 3.0599279403686523
Epoch: 21, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.747 Vali Acc: 0.778 Test Loss: 0.747 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.862536907196045
Epoch: 22, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.746 Vali Acc: 0.772 Test Loss: 0.746 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8233680725097656
Epoch: 23, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.687 Vali Acc: 0.806 Test Loss: 0.687 Test Acc: 0.806
Validation loss decreased (-0.794436 --> -0.805549).  Saving model ...
Epoch: 24 cost time: 2.94003963470459
Epoch: 24, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 25 cost time: 2.893575429916382
Epoch: 25, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827772).  Saving model ...
Epoch: 26 cost time: 2.9669337272644043
Epoch: 26, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
Validation loss decreased (-0.827772 --> -0.861105).  Saving model ...
Epoch: 27 cost time: 2.9073739051818848
Epoch: 27, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.576 Vali Acc: 0.856 Test Loss: 0.576 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0836689472198486
Epoch: 28, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.569 Vali Acc: 0.856 Test Loss: 0.569 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2138619422912598
Epoch: 29, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861106).  Saving model ...
Epoch: 30 cost time: 3.1461541652679443
Epoch: 30, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.525 Vali Acc: 0.861 Test Loss: 0.525 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 31 cost time: 3.2165229320526123
Epoch: 31, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.514 Vali Acc: 0.872 Test Loss: 0.514 Test Acc: 0.872
Validation loss decreased (-0.861106 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 3.1086833477020264
Epoch: 32, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
Validation loss decreased (-0.872217 --> -0.888884).  Saving model ...
Epoch: 33 cost time: 3.238309383392334
Epoch: 33, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.478 Vali Acc: 0.872 Test Loss: 0.478 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.210397243499756
Epoch: 34, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.7973544597625732
Epoch: 35, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.7328696250915527
Epoch: 36, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.8064935207366943
Epoch: 37, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.455 Vali Acc: 0.883 Test Loss: 0.455 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.7081191539764404
Epoch: 38, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.464 Vali Acc: 0.894 Test Loss: 0.464 Test Acc: 0.894
Validation loss decreased (-0.888884 --> -0.894440).  Saving model ...
Epoch: 39 cost time: 3.1045870780944824
Epoch: 39, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.905756950378418
Epoch: 40, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.446 Vali Acc: 0.872 Test Loss: 0.446 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.8341922760009766
Epoch: 41, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.0643420219421387
Epoch: 42, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
Validation loss decreased (-0.894440 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 3.0522682666778564
Epoch: 43, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.433 Vali Acc: 0.878 Test Loss: 0.433 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.027918577194214
Epoch: 44, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.431 Vali Acc: 0.867 Test Loss: 0.431 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.012040615081787
Epoch: 45, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.431 Vali Acc: 0.894 Test Loss: 0.431 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.920619010925293
Epoch: 46, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.441 Vali Acc: 0.883 Test Loss: 0.441 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.1276230812072754
Epoch: 47, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.444 Vali Acc: 0.878 Test Loss: 0.444 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.0046353340148926
Epoch: 48, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.447 Vali Acc: 0.872 Test Loss: 0.447 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.9241244792938232
Epoch: 49, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.440 Vali Acc: 0.883 Test Loss: 0.440 Test Acc: 0.883
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.8345377445220947
Epoch: 50, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.7546486854553223
Epoch: 51, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.8175246715545654
Epoch: 52, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.449 Vali Acc: 0.894 Test Loss: 0.449 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.565631628036499
Epoch: 1, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.675 Vali Acc: 0.056 Test Loss: 2.675 Test Acc: 0.056
Validation loss decreased (inf --> -0.055529).  Saving model ...
Epoch: 2 cost time: 2.8735697269439697
Epoch: 2, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.596 Vali Acc: 0.133 Test Loss: 2.596 Test Acc: 0.133
Validation loss decreased (-0.055529 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 2.891516923904419
Epoch: 3, Steps: 12 | Train Loss: 2.631 Vali Loss: 2.494 Vali Acc: 0.211 Test Loss: 2.494 Test Acc: 0.211
Validation loss decreased (-0.133307 --> -0.211086).  Saving model ...
Epoch: 4 cost time: 2.7983481884002686
Epoch: 4, Steps: 12 | Train Loss: 2.488 Vali Loss: 2.384 Vali Acc: 0.344 Test Loss: 2.384 Test Acc: 0.344
Validation loss decreased (-0.211086 --> -0.344421).  Saving model ...
Epoch: 5 cost time: 2.893763303756714
Epoch: 5, Steps: 12 | Train Loss: 2.380 Vali Loss: 2.271 Vali Acc: 0.417 Test Loss: 2.271 Test Acc: 0.417
Validation loss decreased (-0.344421 --> -0.416644).  Saving model ...
Epoch: 6 cost time: 3.0217223167419434
Epoch: 6, Steps: 12 | Train Loss: 2.286 Vali Loss: 2.160 Vali Acc: 0.472 Test Loss: 2.160 Test Acc: 0.472
Validation loss decreased (-0.416644 --> -0.472201).  Saving model ...
Epoch: 7 cost time: 2.806483507156372
Epoch: 7, Steps: 12 | Train Loss: 2.160 Vali Loss: 2.046 Vali Acc: 0.433 Test Loss: 2.046 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5371880531311035
Epoch: 8, Steps: 12 | Train Loss: 2.017 Vali Loss: 1.939 Vali Acc: 0.483 Test Loss: 1.939 Test Acc: 0.483
Validation loss decreased (-0.472201 --> -0.483314).  Saving model ...
Epoch: 9 cost time: 2.5212209224700928
Epoch: 9, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.850 Vali Acc: 0.511 Test Loss: 1.850 Test Acc: 0.511
Validation loss decreased (-0.483314 --> -0.511093).  Saving model ...
Epoch: 10 cost time: 2.4855148792266846
Epoch: 10, Steps: 12 | Train Loss: 1.811 Vali Loss: 1.765 Vali Acc: 0.506 Test Loss: 1.765 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7177276611328125
Epoch: 11, Steps: 12 | Train Loss: 1.669 Vali Loss: 1.673 Vali Acc: 0.533 Test Loss: 1.673 Test Acc: 0.533
Validation loss decreased (-0.511093 --> -0.533317).  Saving model ...
Epoch: 12 cost time: 2.7900938987731934
Epoch: 12, Steps: 12 | Train Loss: 1.573 Vali Loss: 1.591 Vali Acc: 0.567 Test Loss: 1.591 Test Acc: 0.567
Validation loss decreased (-0.533317 --> -0.566651).  Saving model ...
Epoch: 13 cost time: 2.8355305194854736
Epoch: 13, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.523 Vali Acc: 0.583 Test Loss: 1.523 Test Acc: 0.583
Validation loss decreased (-0.566651 --> -0.583318).  Saving model ...
Epoch: 14 cost time: 2.676650285720825
Epoch: 14, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.438 Vali Acc: 0.611 Test Loss: 1.438 Test Acc: 0.611
Validation loss decreased (-0.583318 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 2.940432548522949
Epoch: 15, Steps: 12 | Train Loss: 1.298 Vali Loss: 1.367 Vali Acc: 0.628 Test Loss: 1.367 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627764).  Saving model ...
Epoch: 16 cost time: 2.9347167015075684
Epoch: 16, Steps: 12 | Train Loss: 1.158 Vali Loss: 1.277 Vali Acc: 0.644 Test Loss: 1.277 Test Acc: 0.644
Validation loss decreased (-0.627764 --> -0.644432).  Saving model ...
Epoch: 17 cost time: 2.7730889320373535
Epoch: 17, Steps: 12 | Train Loss: 1.078 Vali Loss: 1.201 Vali Acc: 0.672 Test Loss: 1.201 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672210).  Saving model ...
Epoch: 18 cost time: 2.7992804050445557
Epoch: 18, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.129 Vali Acc: 0.683 Test Loss: 1.129 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683322).  Saving model ...
Epoch: 19 cost time: 2.9389564990997314
Epoch: 19, Steps: 12 | Train Loss: 0.945 Vali Loss: 1.051 Vali Acc: 0.689 Test Loss: 1.051 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 20 cost time: 2.956516742706299
Epoch: 20, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.992 Vali Acc: 0.722 Test Loss: 0.992 Test Acc: 0.722
Validation loss decreased (-0.688878 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 2.9437246322631836
Epoch: 21, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.924 Vali Acc: 0.722 Test Loss: 0.924 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722213).  Saving model ...
Epoch: 22 cost time: 3.0164945125579834
Epoch: 22, Steps: 12 | Train Loss: 0.737 Vali Loss: 0.895 Vali Acc: 0.739 Test Loss: 0.895 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 23 cost time: 2.805025339126587
Epoch: 23, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.845 Vali Acc: 0.750 Test Loss: 0.845 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 2.9075498580932617
Epoch: 24, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.788 Vali Acc: 0.744 Test Loss: 0.788 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7709145545959473
Epoch: 25, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 3.0120298862457275
Epoch: 26, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783326).  Saving model ...
Epoch: 27 cost time: 2.8043882846832275
Epoch: 27, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.722 Vali Acc: 0.772 Test Loss: 0.722 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0987155437469482
Epoch: 28, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 29 cost time: 3.1762449741363525
Epoch: 29, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.138321876525879
Epoch: 30, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.641 Vali Acc: 0.794 Test Loss: 0.641 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 31 cost time: 3.16768217086792
Epoch: 31, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.630 Vali Acc: 0.806 Test Loss: 0.630 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805549).  Saving model ...
Epoch: 32 cost time: 2.9687275886535645
Epoch: 32, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.596 Vali Acc: 0.828 Test Loss: 0.596 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827772).  Saving model ...
Epoch: 33 cost time: 3.1590325832366943
Epoch: 33, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.570 Vali Acc: 0.822 Test Loss: 0.570 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.106907367706299
Epoch: 34, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.577 Vali Acc: 0.822 Test Loss: 0.577 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.9536399841308594
Epoch: 35, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844439).  Saving model ...
Epoch: 36 cost time: 2.97924542427063
Epoch: 36, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.9307894706726074
Epoch: 37, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.561 Vali Acc: 0.822 Test Loss: 0.561 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.8883817195892334
Epoch: 38, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 39 cost time: 2.7294654846191406
Epoch: 39, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.546 Vali Acc: 0.817 Test Loss: 0.546 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.7148139476776123
Epoch: 40, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.519 Vali Acc: 0.856 Test Loss: 0.519 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 41 cost time: 2.6854512691497803
Epoch: 41, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.525 Vali Acc: 0.856 Test Loss: 0.525 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.8729355335235596
Epoch: 42, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.508 Vali Acc: 0.856 Test Loss: 0.508 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 3.0141868591308594
Epoch: 43, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.903717041015625
Epoch: 44, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.948049545288086
Epoch: 45, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.501 Vali Acc: 0.861 Test Loss: 0.501 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 46 cost time: 3.0802597999572754
Epoch: 46, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.015291452407837
Epoch: 47, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.7367074489593506
Epoch: 48, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.641977071762085
Epoch: 49, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.7573585510253906
Epoch: 50, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.937138319015503
Epoch: 51, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.510 Vali Acc: 0.839 Test Loss: 0.510 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.8379933834075928
Epoch: 52, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 53 cost time: 2.920382022857666
Epoch: 53, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.8931827545166016
Epoch: 54, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.821197509765625
Epoch: 55, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.2472383975982666
Epoch: 56, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.519 Vali Acc: 0.861 Test Loss: 0.519 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.9353435039520264
Epoch: 57, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.1720807552337646
Epoch: 58, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.512 Vali Acc: 0.856 Test Loss: 0.512 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.252511739730835
Epoch: 59, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.9734761714935303
Epoch: 60, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.083865165710449
Epoch: 61, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.861 Test Loss: 0.517 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 2.996370792388916
Epoch: 62, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.145120620727539
Epoch: 1, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.770 Vali Acc: 0.067 Test Loss: 2.770 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 2.949092388153076
Epoch: 2, Steps: 12 | Train Loss: 2.699 Vali Loss: 2.712 Vali Acc: 0.100 Test Loss: 2.712 Test Acc: 0.100
Validation loss decreased (-0.066639 --> -0.099973).  Saving model ...
Epoch: 3 cost time: 3.0146381855010986
Epoch: 3, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.638 Vali Acc: 0.167 Test Loss: 2.638 Test Acc: 0.167
Validation loss decreased (-0.099973 --> -0.166640).  Saving model ...
Epoch: 4 cost time: 2.962099552154541
Epoch: 4, Steps: 12 | Train Loss: 2.616 Vali Loss: 2.561 Vali Acc: 0.222 Test Loss: 2.561 Test Acc: 0.222
Validation loss decreased (-0.166640 --> -0.222197).  Saving model ...
Epoch: 5 cost time: 3.1030092239379883
Epoch: 5, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.477 Vali Acc: 0.244 Test Loss: 2.477 Test Acc: 0.244
Validation loss decreased (-0.222197 --> -0.244420).  Saving model ...
Epoch: 6 cost time: 2.94346284866333
Epoch: 6, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.396 Vali Acc: 0.244 Test Loss: 2.396 Test Acc: 0.244
Validation loss decreased (-0.244420 --> -0.244420).  Saving model ...
Epoch: 7 cost time: 3.1954922676086426
Epoch: 7, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.314 Vali Acc: 0.272 Test Loss: 2.314 Test Acc: 0.272
Validation loss decreased (-0.244420 --> -0.272199).  Saving model ...
Epoch: 8 cost time: 3.0808117389678955
Epoch: 8, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.227 Vali Acc: 0.322 Test Loss: 2.227 Test Acc: 0.322
Validation loss decreased (-0.272199 --> -0.322200).  Saving model ...
Epoch: 9 cost time: 2.976250648498535
Epoch: 9, Steps: 12 | Train Loss: 2.199 Vali Loss: 2.148 Vali Acc: 0.300 Test Loss: 2.148 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.033643960952759
Epoch: 10, Steps: 12 | Train Loss: 2.085 Vali Loss: 2.065 Vali Acc: 0.333 Test Loss: 2.065 Test Acc: 0.333
Validation loss decreased (-0.322200 --> -0.333313).  Saving model ...
Epoch: 11 cost time: 2.6690542697906494
Epoch: 11, Steps: 12 | Train Loss: 2.019 Vali Loss: 1.969 Vali Acc: 0.372 Test Loss: 1.969 Test Acc: 0.372
Validation loss decreased (-0.333313 --> -0.372203).  Saving model ...
Epoch: 12 cost time: 2.7400412559509277
Epoch: 12, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.868 Vali Acc: 0.400 Test Loss: 1.868 Test Acc: 0.400
Validation loss decreased (-0.372203 --> -0.399981).  Saving model ...
Epoch: 13 cost time: 2.9225142002105713
Epoch: 13, Steps: 12 | Train Loss: 1.760 Vali Loss: 1.767 Vali Acc: 0.450 Test Loss: 1.767 Test Acc: 0.450
Validation loss decreased (-0.399981 --> -0.449982).  Saving model ...
Epoch: 14 cost time: 3.1381871700286865
Epoch: 14, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.645 Vali Acc: 0.511 Test Loss: 1.645 Test Acc: 0.511
Validation loss decreased (-0.449982 --> -0.511095).  Saving model ...
Epoch: 15 cost time: 3.0965301990509033
Epoch: 15, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.520 Vali Acc: 0.617 Test Loss: 1.520 Test Acc: 0.617
Validation loss decreased (-0.511095 --> -0.616651).  Saving model ...
Epoch: 16 cost time: 3.097233533859253
Epoch: 16, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.393 Vali Acc: 0.656 Test Loss: 1.393 Test Acc: 0.656
Validation loss decreased (-0.616651 --> -0.655542).  Saving model ...
Epoch: 17 cost time: 3.030510425567627
Epoch: 17, Steps: 12 | Train Loss: 1.272 Vali Loss: 1.293 Vali Acc: 0.650 Test Loss: 1.293 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.260547637939453
Epoch: 18, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.194 Vali Acc: 0.667 Test Loss: 1.194 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666655).  Saving model ...
Epoch: 19 cost time: 3.3648757934570312
Epoch: 19, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.098 Vali Acc: 0.694 Test Loss: 1.098 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694433).  Saving model ...
Epoch: 20 cost time: 3.2160990238189697
Epoch: 20, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.014 Vali Acc: 0.717 Test Loss: 1.014 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716657).  Saving model ...
Epoch: 21 cost time: 3.4093804359436035
Epoch: 21, Steps: 12 | Train Loss: 0.862 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.42244291305542
Epoch: 22, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.929 Vali Acc: 0.722 Test Loss: 0.929 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 23 cost time: 3.3020172119140625
Epoch: 23, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.856 Vali Acc: 0.722 Test Loss: 0.856 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 24 cost time: 3.241598606109619
Epoch: 24, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.807 Vali Acc: 0.750 Test Loss: 0.807 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749992).  Saving model ...
Epoch: 25 cost time: 3.305427312850952
Epoch: 25, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.784 Vali Acc: 0.744 Test Loss: 0.784 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0339419841766357
Epoch: 26, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.739 Vali Acc: 0.756 Test Loss: 0.739 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 3.325974464416504
Epoch: 27, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.731 Vali Acc: 0.756 Test Loss: 0.731 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 28 cost time: 3.3224856853485107
Epoch: 28, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.701 Vali Acc: 0.767 Test Loss: 0.701 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766660).  Saving model ...
Epoch: 29 cost time: 3.449831008911133
Epoch: 29, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.689 Vali Acc: 0.761 Test Loss: 0.689 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.646172285079956
Epoch: 30, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.664 Vali Acc: 0.778 Test Loss: 0.664 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 31 cost time: 3.6476693153381348
Epoch: 31, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 32 cost time: 3.5777456760406494
Epoch: 32, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.622 Vali Acc: 0.772 Test Loss: 0.622 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.147869348526001
Epoch: 33, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.598 Vali Acc: 0.794 Test Loss: 0.598 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 34 cost time: 3.4358468055725098
Epoch: 34, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.582 Vali Acc: 0.811 Test Loss: 0.582 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 35 cost time: 3.2108912467956543
Epoch: 35, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.572 Vali Acc: 0.817 Test Loss: 0.572 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 36 cost time: 3.0876827239990234
Epoch: 36, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.552 Vali Acc: 0.822 Test Loss: 0.552 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822217).  Saving model ...
Epoch: 37 cost time: 3.096406936645508
Epoch: 37, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.984259843826294
Epoch: 38, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.541 Vali Acc: 0.844 Test Loss: 0.541 Test Acc: 0.844
Validation loss decreased (-0.822217 --> -0.844439).  Saving model ...
Epoch: 39 cost time: 3.027090072631836
Epoch: 39, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.552 Vali Acc: 0.828 Test Loss: 0.552 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.919220209121704
Epoch: 40, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 41 cost time: 2.983898639678955
Epoch: 41, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 42 cost time: 3.204211473464966
Epoch: 42, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 43 cost time: 3.2041850090026855
Epoch: 43, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.530 Vali Acc: 0.828 Test Loss: 0.530 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.2134008407592773
Epoch: 44, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 45 cost time: 3.3358516693115234
Epoch: 45, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.325164556503296
Epoch: 46, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 47 cost time: 2.8261396884918213
Epoch: 47, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.523 Vali Acc: 0.856 Test Loss: 0.523 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.003114700317383
Epoch: 48, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 49 cost time: 3.0747478008270264
Epoch: 49, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.0897762775421143
Epoch: 50, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.9456303119659424
Epoch: 51, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.961418390274048
Epoch: 52, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.9726500511169434
Epoch: 53, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.06256365776062
Epoch: 54, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.096680164337158
Epoch: 55, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.0147745609283447
Epoch: 56, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.522 Vali Acc: 0.867 Test Loss: 0.522 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 57 cost time: 3.054400682449341
Epoch: 57, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.172595500946045
Epoch: 58, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.186631917953491
Epoch: 59, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.942103624343872
Epoch: 60, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.907876968383789
Epoch: 61, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.538 Vali Acc: 0.861 Test Loss: 0.538 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.8807334899902344
Epoch: 62, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.533 Vali Acc: 0.856 Test Loss: 0.533 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 2.8835854530334473
Epoch: 63, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.542 Vali Acc: 0.856 Test Loss: 0.542 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.745173692703247
Epoch: 64, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.871420383453369
Epoch: 65, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 2.855201005935669
Epoch: 66, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.313998460769653
Epoch: 1, Steps: 12 | Train Loss: 2.778 Vali Loss: 2.769 Vali Acc: 0.072 Test Loss: 2.769 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 2.8469655513763428
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.721 Vali Acc: 0.083 Test Loss: 2.721 Test Acc: 0.083
Validation loss decreased (-0.072195 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 2.869807004928589
Epoch: 3, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.657 Vali Acc: 0.133 Test Loss: 2.657 Test Acc: 0.133
Validation loss decreased (-0.083306 --> -0.133307).  Saving model ...
Epoch: 4 cost time: 2.6643943786621094
Epoch: 4, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.584 Vali Acc: 0.189 Test Loss: 2.584 Test Acc: 0.189
Validation loss decreased (-0.133307 --> -0.188863).  Saving model ...
Epoch: 5 cost time: 2.8099238872528076
Epoch: 5, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.500 Vali Acc: 0.211 Test Loss: 2.500 Test Acc: 0.211
Validation loss decreased (-0.188863 --> -0.211086).  Saving model ...
Epoch: 6 cost time: 2.7108750343322754
Epoch: 6, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.417 Vali Acc: 0.233 Test Loss: 2.417 Test Acc: 0.233
Validation loss decreased (-0.211086 --> -0.233309).  Saving model ...
Epoch: 7 cost time: 2.7127509117126465
Epoch: 7, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.326 Vali Acc: 0.250 Test Loss: 2.326 Test Acc: 0.250
Validation loss decreased (-0.233309 --> -0.249977).  Saving model ...
Epoch: 8 cost time: 2.812460422515869
Epoch: 8, Steps: 12 | Train Loss: 2.364 Vali Loss: 2.229 Vali Acc: 0.239 Test Loss: 2.229 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6439459323883057
Epoch: 9, Steps: 12 | Train Loss: 2.323 Vali Loss: 2.146 Vali Acc: 0.289 Test Loss: 2.146 Test Acc: 0.289
Validation loss decreased (-0.249977 --> -0.288867).  Saving model ...
Epoch: 10 cost time: 2.8856699466705322
Epoch: 10, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.056 Vali Acc: 0.311 Test Loss: 2.056 Test Acc: 0.311
Validation loss decreased (-0.288867 --> -0.311091).  Saving model ...
Epoch: 11 cost time: 3.064382314682007
Epoch: 11, Steps: 12 | Train Loss: 2.131 Vali Loss: 1.966 Vali Acc: 0.372 Test Loss: 1.966 Test Acc: 0.372
Validation loss decreased (-0.311091 --> -0.372203).  Saving model ...
Epoch: 12 cost time: 3.129775285720825
Epoch: 12, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.880 Vali Acc: 0.389 Test Loss: 1.880 Test Acc: 0.389
Validation loss decreased (-0.372203 --> -0.388870).  Saving model ...
Epoch: 13 cost time: 2.9782118797302246
Epoch: 13, Steps: 12 | Train Loss: 1.859 Vali Loss: 1.794 Vali Acc: 0.411 Test Loss: 1.794 Test Acc: 0.411
Validation loss decreased (-0.388870 --> -0.411093).  Saving model ...
Epoch: 14 cost time: 3.0806353092193604
Epoch: 14, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.689 Vali Acc: 0.433 Test Loss: 1.689 Test Acc: 0.433
Validation loss decreased (-0.411093 --> -0.433316).  Saving model ...
Epoch: 15 cost time: 3.1011061668395996
Epoch: 15, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.580 Vali Acc: 0.472 Test Loss: 1.580 Test Acc: 0.472
Validation loss decreased (-0.433316 --> -0.472206).  Saving model ...
Epoch: 16 cost time: 3.018188238143921
Epoch: 16, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.464 Vali Acc: 0.506 Test Loss: 1.464 Test Acc: 0.506
Validation loss decreased (-0.472206 --> -0.505541).  Saving model ...
Epoch: 17 cost time: 3.0724639892578125
Epoch: 17, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.393 Vali Acc: 0.494 Test Loss: 1.393 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9960224628448486
Epoch: 18, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.323 Vali Acc: 0.528 Test Loss: 1.323 Test Acc: 0.528
Validation loss decreased (-0.505541 --> -0.527765).  Saving model ...
Epoch: 19 cost time: 2.7687666416168213
Epoch: 19, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.239 Vali Acc: 0.572 Test Loss: 1.239 Test Acc: 0.572
Validation loss decreased (-0.527765 --> -0.572210).  Saving model ...
Epoch: 20 cost time: 2.891716718673706
Epoch: 20, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.144 Vali Acc: 0.650 Test Loss: 1.144 Test Acc: 0.650
Validation loss decreased (-0.572210 --> -0.649989).  Saving model ...
Epoch: 21 cost time: 2.9586575031280518
Epoch: 21, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.109 Vali Acc: 0.639 Test Loss: 1.109 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9341742992401123
Epoch: 22, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.042 Vali Acc: 0.678 Test Loss: 1.042 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677767).  Saving model ...
Epoch: 23 cost time: 2.996164083480835
Epoch: 23, Steps: 12 | Train Loss: 0.802 Vali Loss: 0.962 Vali Acc: 0.689 Test Loss: 0.962 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 24 cost time: 2.982006072998047
Epoch: 24, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.913 Vali Acc: 0.683 Test Loss: 0.913 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1561810970306396
Epoch: 25, Steps: 12 | Train Loss: 0.745 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 26 cost time: 3.1913270950317383
Epoch: 26, Steps: 12 | Train Loss: 0.652 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
Validation loss decreased (-0.699991 --> -0.733325).  Saving model ...
Epoch: 27 cost time: 3.2832396030426025
Epoch: 27, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.790 Vali Acc: 0.733 Test Loss: 0.790 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733325).  Saving model ...
Epoch: 28 cost time: 3.094496965408325
Epoch: 28, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.730 Vali Acc: 0.761 Test Loss: 0.730 Test Acc: 0.761
Validation loss decreased (-0.733325 --> -0.761104).  Saving model ...
Epoch: 29 cost time: 2.9076216220855713
Epoch: 29, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.703 Vali Acc: 0.744 Test Loss: 0.703 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.993941307067871
Epoch: 30, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.671 Vali Acc: 0.783 Test Loss: 0.671 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783327).  Saving model ...
Epoch: 31 cost time: 2.847719192504883
Epoch: 31, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
Validation loss decreased (-0.783327 --> -0.811105).  Saving model ...
Epoch: 32 cost time: 2.9471583366394043
Epoch: 32, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.625 Vali Acc: 0.817 Test Loss: 0.625 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 33 cost time: 2.850008487701416
Epoch: 33, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.586 Vali Acc: 0.817 Test Loss: 0.586 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816661).  Saving model ...
Epoch: 34 cost time: 2.8291544914245605
Epoch: 34, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.582 Vali Acc: 0.828 Test Loss: 0.582 Test Acc: 0.828
Validation loss decreased (-0.816661 --> -0.827772).  Saving model ...
Epoch: 35 cost time: 2.8018627166748047
Epoch: 35, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.576 Vali Acc: 0.839 Test Loss: 0.576 Test Acc: 0.839
Validation loss decreased (-0.827772 --> -0.838883).  Saving model ...
Epoch: 36 cost time: 2.7527353763580322
Epoch: 36, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.562 Vali Acc: 0.811 Test Loss: 0.562 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.741621732711792
Epoch: 37, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.579 Vali Acc: 0.839 Test Loss: 0.579 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.175330877304077
Epoch: 38, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.195258140563965
Epoch: 39, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 3.306654930114746
Epoch: 40, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2311859130859375
Epoch: 41, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.538 Vali Acc: 0.839 Test Loss: 0.538 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.216916799545288
Epoch: 42, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 43 cost time: 3.3199727535247803
Epoch: 43, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.527 Vali Acc: 0.844 Test Loss: 0.527 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.2928874492645264
Epoch: 44, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.143706798553467
Epoch: 45, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855550).  Saving model ...
Epoch: 46 cost time: 3.5841450691223145
Epoch: 46, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.0480988025665283
Epoch: 47, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.1080565452575684
Epoch: 48, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.544 Vali Acc: 0.839 Test Loss: 0.544 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.023308277130127
Epoch: 49, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.607637643814087
Epoch: 50, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.5353944301605225
Epoch: 51, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.524 Vali Acc: 0.844 Test Loss: 0.524 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.4593446254730225
Epoch: 52, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 53 cost time: 3.192598342895508
Epoch: 53, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.1757659912109375
Epoch: 54, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.526 Vali Acc: 0.844 Test Loss: 0.526 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.634415864944458
Epoch: 55, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.535 Vali Acc: 0.861 Test Loss: 0.535 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 56 cost time: 3.157240867614746
Epoch: 56, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.3988192081451416
Epoch: 57, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.1449923515319824
Epoch: 58, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 59 cost time: 3.83737850189209
Epoch: 59, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.209413766860962
Epoch: 60, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.530 Vali Acc: 0.850 Test Loss: 0.530 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.2477328777313232
Epoch: 61, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.530 Vali Acc: 0.861 Test Loss: 0.530 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.689229965209961
Epoch: 62, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.5014822483062744
Epoch: 63, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.525 Vali Acc: 0.867 Test Loss: 0.525 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 64 cost time: 3.990428924560547
Epoch: 64, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 4.022462368011475
Epoch: 65, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.536 Vali Acc: 0.856 Test Loss: 0.536 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.83025860786438
Epoch: 66, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 4.376607418060303
Epoch: 67, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 4.853729486465454
Epoch: 68, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.544 Vali Acc: 0.861 Test Loss: 0.544 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 4.392573118209839
Epoch: 69, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.553 Vali Acc: 0.856 Test Loss: 0.553 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 4.898086071014404
Epoch: 70, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 4.184889554977417
Epoch: 71, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 4.059291839599609
Epoch: 72, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.573 Vali Acc: 0.867 Test Loss: 0.573 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 4.790099859237671
Epoch: 73, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.576 Vali Acc: 0.867 Test Loss: 0.576 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.029752254486084
Epoch: 1, Steps: 12 | Train Loss: 2.731 Vali Loss: 2.771 Vali Acc: 0.072 Test Loss: 2.771 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 4.289225339889526
Epoch: 2, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.691 Vali Acc: 0.117 Test Loss: 2.691 Test Acc: 0.117
Validation loss decreased (-0.072195 --> -0.116640).  Saving model ...
Epoch: 3 cost time: 3.9765427112579346
Epoch: 3, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.594 Vali Acc: 0.217 Test Loss: 2.594 Test Acc: 0.217
Validation loss decreased (-0.116640 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 3.879957914352417
Epoch: 4, Steps: 12 | Train Loss: 2.675 Vali Loss: 2.504 Vali Acc: 0.244 Test Loss: 2.504 Test Acc: 0.244
Validation loss decreased (-0.216641 --> -0.244419).  Saving model ...
Epoch: 5 cost time: 4.286130428314209
Epoch: 5, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.420 Vali Acc: 0.250 Test Loss: 2.420 Test Acc: 0.250
Validation loss decreased (-0.244419 --> -0.249976).  Saving model ...
Epoch: 6 cost time: 4.254554986953735
Epoch: 6, Steps: 12 | Train Loss: 2.565 Vali Loss: 2.334 Vali Acc: 0.233 Test Loss: 2.334 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9397239685058594
Epoch: 7, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.253 Vali Acc: 0.217 Test Loss: 2.253 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9435551166534424
Epoch: 8, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.175 Vali Acc: 0.211 Test Loss: 2.175 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.947441339492798
Epoch: 9, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.111 Vali Acc: 0.261 Test Loss: 2.111 Test Acc: 0.261
Validation loss decreased (-0.249976 --> -0.261090).  Saving model ...
Epoch: 10 cost time: 4.622814416885376
Epoch: 10, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.041 Vali Acc: 0.306 Test Loss: 2.041 Test Acc: 0.306
Validation loss decreased (-0.261090 --> -0.305535).  Saving model ...
Epoch: 11 cost time: 4.554908514022827
Epoch: 11, Steps: 12 | Train Loss: 2.207 Vali Loss: 1.973 Vali Acc: 0.356 Test Loss: 1.973 Test Acc: 0.356
Validation loss decreased (-0.305535 --> -0.355536).  Saving model ...
Epoch: 12 cost time: 4.448417663574219
Epoch: 12, Steps: 12 | Train Loss: 2.096 Vali Loss: 1.904 Vali Acc: 0.394 Test Loss: 1.904 Test Acc: 0.394
Validation loss decreased (-0.355536 --> -0.394425).  Saving model ...
Epoch: 13 cost time: 4.76766300201416
Epoch: 13, Steps: 12 | Train Loss: 1.990 Vali Loss: 1.844 Vali Acc: 0.406 Test Loss: 1.844 Test Acc: 0.406
Validation loss decreased (-0.394425 --> -0.405537).  Saving model ...
Epoch: 14 cost time: 5.6016011238098145
Epoch: 14, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.764 Vali Acc: 0.400 Test Loss: 1.764 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.893024444580078
Epoch: 15, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.673 Vali Acc: 0.439 Test Loss: 1.673 Test Acc: 0.439
Validation loss decreased (-0.405537 --> -0.438872).  Saving model ...
Epoch: 16 cost time: 4.703939199447632
Epoch: 16, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.550 Vali Acc: 0.528 Test Loss: 1.550 Test Acc: 0.528
Validation loss decreased (-0.438872 --> -0.527762).  Saving model ...
Epoch: 17 cost time: 4.669408559799194
Epoch: 17, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.457 Vali Acc: 0.544 Test Loss: 1.457 Test Acc: 0.544
Validation loss decreased (-0.527762 --> -0.544430).  Saving model ...
Epoch: 18 cost time: 4.751177072525024
Epoch: 18, Steps: 12 | Train Loss: 1.318 Vali Loss: 1.376 Vali Acc: 0.556 Test Loss: 1.376 Test Acc: 0.556
Validation loss decreased (-0.544430 --> -0.555542).  Saving model ...
Epoch: 19 cost time: 4.520268678665161
Epoch: 19, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.288 Vali Acc: 0.617 Test Loss: 1.288 Test Acc: 0.617
Validation loss decreased (-0.555542 --> -0.616654).  Saving model ...
Epoch: 20 cost time: 4.650731563568115
Epoch: 20, Steps: 12 | Train Loss: 1.114 Vali Loss: 1.196 Vali Acc: 0.672 Test Loss: 1.196 Test Acc: 0.672
Validation loss decreased (-0.616654 --> -0.672210).  Saving model ...
Epoch: 21 cost time: 4.632079601287842
Epoch: 21, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.153 Vali Acc: 0.628 Test Loss: 1.153 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.099342584609985
Epoch: 22, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.092 Vali Acc: 0.678 Test Loss: 1.092 Test Acc: 0.678
Validation loss decreased (-0.672210 --> -0.677767).  Saving model ...
Epoch: 23 cost time: 5.052328109741211
Epoch: 23, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.023 Vali Acc: 0.689 Test Loss: 1.023 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 24 cost time: 4.09768009185791
Epoch: 24, Steps: 12 | Train Loss: 0.810 Vali Loss: 0.985 Vali Acc: 0.694 Test Loss: 0.985 Test Acc: 0.694
Validation loss decreased (-0.688879 --> -0.694435).  Saving model ...
Epoch: 25 cost time: 4.462629079818726
Epoch: 25, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 26 cost time: 4.038578271865845
Epoch: 26, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.883 Vali Acc: 0.711 Test Loss: 0.883 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711102).  Saving model ...
Epoch: 27 cost time: 4.470440149307251
Epoch: 27, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.854 Vali Acc: 0.728 Test Loss: 0.854 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727769).  Saving model ...
Epoch: 28 cost time: 3.707357406616211
Epoch: 28, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 29 cost time: 4.490804433822632
Epoch: 29, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.777 Vali Acc: 0.728 Test Loss: 0.777 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 30 cost time: 4.2726149559021
Epoch: 30, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 31 cost time: 5.056641578674316
Epoch: 31, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 32 cost time: 4.004603862762451
Epoch: 32, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.688 Vali Acc: 0.767 Test Loss: 0.688 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766660).  Saving model ...
Epoch: 33 cost time: 4.46073579788208
Epoch: 33, Steps: 12 | Train Loss: 0.463 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.2290332317352295
Epoch: 34, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 35 cost time: 4.258224248886108
Epoch: 35, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.608 Vali Acc: 0.767 Test Loss: 0.608 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.622375965118408
Epoch: 36, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.584 Vali Acc: 0.794 Test Loss: 0.584 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794439).  Saving model ...
Epoch: 37 cost time: 4.181563854217529
Epoch: 37, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.585 Vali Acc: 0.794 Test Loss: 0.585 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.70642352104187
Epoch: 38, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.555 Vali Acc: 0.828 Test Loss: 0.555 Test Acc: 0.828
Validation loss decreased (-0.794439 --> -0.827772).  Saving model ...
Epoch: 39 cost time: 5.381353378295898
Epoch: 39, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.559 Vali Acc: 0.811 Test Loss: 0.559 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.702693462371826
Epoch: 40, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.545 Vali Acc: 0.828 Test Loss: 0.545 Test Acc: 0.828
Validation loss decreased (-0.827772 --> -0.827772).  Saving model ...
Epoch: 41 cost time: 4.7222981452941895
Epoch: 41, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.544 Vali Acc: 0.817 Test Loss: 0.544 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.860067129135132
Epoch: 42, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833328).  Saving model ...
Epoch: 43 cost time: 5.361971378326416
Epoch: 43, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 44 cost time: 4.79788875579834
Epoch: 44, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.530 Vali Acc: 0.833 Test Loss: 0.530 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.205019474029541
Epoch: 45, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.521 Vali Acc: 0.833 Test Loss: 0.521 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.379879713058472
Epoch: 46, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 4.676918029785156
Epoch: 47, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.523 Vali Acc: 0.839 Test Loss: 0.523 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 4.316612720489502
Epoch: 48, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.521 Vali Acc: 0.861 Test Loss: 0.521 Test Acc: 0.861
Validation loss decreased (-0.844439 --> -0.861106).  Saving model ...
Epoch: 49 cost time: 4.619015455245972
Epoch: 49, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.531 Vali Acc: 0.822 Test Loss: 0.531 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 4.399612903594971
Epoch: 50, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 4.741965055465698
Epoch: 51, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 4.691390752792358
Epoch: 52, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 4.405964374542236
Epoch: 53, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.529 Vali Acc: 0.839 Test Loss: 0.529 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 5.348111152648926
Epoch: 54, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.519 Vali Acc: 0.839 Test Loss: 0.519 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 4.987933397293091
Epoch: 55, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.538 Vali Acc: 0.839 Test Loss: 0.538 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 5.53848934173584
Epoch: 56, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 4.93398380279541
Epoch: 57, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.536 Vali Acc: 0.839 Test Loss: 0.536 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 5.034392595291138
Epoch: 58, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.046478509902954
Epoch: 1, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.813 Vali Acc: 0.083 Test Loss: 2.813 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 5.278312683105469
Epoch: 2, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.759 Vali Acc: 0.117 Test Loss: 2.759 Test Acc: 0.117
Validation loss decreased (-0.083305 --> -0.116639).  Saving model ...
Epoch: 3 cost time: 5.0042383670806885
Epoch: 3, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.686 Vali Acc: 0.144 Test Loss: 2.686 Test Acc: 0.144
Validation loss decreased (-0.116639 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 5.163896799087524
Epoch: 4, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.604 Vali Acc: 0.217 Test Loss: 2.604 Test Acc: 0.217
Validation loss decreased (-0.144418 --> -0.216641).  Saving model ...
Epoch: 5 cost time: 5.3372862339019775
Epoch: 5, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.509 Vali Acc: 0.239 Test Loss: 2.509 Test Acc: 0.239
Validation loss decreased (-0.216641 --> -0.238864).  Saving model ...
Epoch: 6 cost time: 4.363134145736694
Epoch: 6, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.409 Vali Acc: 0.233 Test Loss: 2.409 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.675768136978149
Epoch: 7, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.305 Vali Acc: 0.261 Test Loss: 2.305 Test Acc: 0.261
Validation loss decreased (-0.238864 --> -0.261088).  Saving model ...
Epoch: 8 cost time: 5.145756006240845
Epoch: 8, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.211 Vali Acc: 0.306 Test Loss: 2.211 Test Acc: 0.306
Validation loss decreased (-0.261088 --> -0.305533).  Saving model ...
Epoch: 9 cost time: 5.054318189620972
Epoch: 9, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.131 Vali Acc: 0.344 Test Loss: 2.131 Test Acc: 0.344
Validation loss decreased (-0.305533 --> -0.344423).  Saving model ...
Epoch: 10 cost time: 5.499422311782837
Epoch: 10, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.055 Vali Acc: 0.361 Test Loss: 2.055 Test Acc: 0.361
Validation loss decreased (-0.344423 --> -0.361091).  Saving model ...
Epoch: 11 cost time: 4.760293245315552
Epoch: 11, Steps: 12 | Train Loss: 2.277 Vali Loss: 1.993 Vali Acc: 0.389 Test Loss: 1.993 Test Acc: 0.389
Validation loss decreased (-0.361091 --> -0.388869).  Saving model ...
Epoch: 12 cost time: 4.900444507598877
Epoch: 12, Steps: 12 | Train Loss: 2.156 Vali Loss: 1.929 Vali Acc: 0.389 Test Loss: 1.929 Test Acc: 0.389
Validation loss decreased (-0.388869 --> -0.388870).  Saving model ...
Epoch: 13 cost time: 4.255183458328247
Epoch: 13, Steps: 12 | Train Loss: 2.092 Vali Loss: 1.881 Vali Acc: 0.406 Test Loss: 1.881 Test Acc: 0.406
Validation loss decreased (-0.388870 --> -0.405537).  Saving model ...
Epoch: 14 cost time: 4.486207008361816
Epoch: 14, Steps: 12 | Train Loss: 1.910 Vali Loss: 1.825 Vali Acc: 0.417 Test Loss: 1.825 Test Acc: 0.417
Validation loss decreased (-0.405537 --> -0.416648).  Saving model ...
Epoch: 15 cost time: 4.590603828430176
Epoch: 15, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.734 Vali Acc: 0.411 Test Loss: 1.734 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.74690842628479
Epoch: 16, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.613 Vali Acc: 0.439 Test Loss: 1.613 Test Acc: 0.439
Validation loss decreased (-0.416648 --> -0.438873).  Saving model ...
Epoch: 17 cost time: 4.562856912612915
Epoch: 17, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.523 Vali Acc: 0.461 Test Loss: 1.523 Test Acc: 0.461
Validation loss decreased (-0.438873 --> -0.461096).  Saving model ...
Epoch: 18 cost time: 4.709716558456421
Epoch: 18, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.429 Vali Acc: 0.517 Test Loss: 1.429 Test Acc: 0.517
Validation loss decreased (-0.461096 --> -0.516652).  Saving model ...
Epoch: 19 cost time: 4.77471399307251
Epoch: 19, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.326 Vali Acc: 0.578 Test Loss: 1.326 Test Acc: 0.578
Validation loss decreased (-0.516652 --> -0.577765).  Saving model ...
Epoch: 20 cost time: 4.4971396923065186
Epoch: 20, Steps: 12 | Train Loss: 1.203 Vali Loss: 1.211 Vali Acc: 0.656 Test Loss: 1.211 Test Acc: 0.656
Validation loss decreased (-0.577765 --> -0.655543).  Saving model ...
Epoch: 21 cost time: 4.794052362442017
Epoch: 21, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.161 Vali Acc: 0.622 Test Loss: 1.161 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.607694149017334
Epoch: 22, Steps: 12 | Train Loss: 1.002 Vali Loss: 1.090 Vali Acc: 0.689 Test Loss: 1.090 Test Acc: 0.689
Validation loss decreased (-0.655543 --> -0.688878).  Saving model ...
Epoch: 23 cost time: 4.901247024536133
Epoch: 23, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.009 Vali Acc: 0.678 Test Loss: 1.009 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.8316566944122314
Epoch: 24, Steps: 12 | Train Loss: 0.858 Vali Loss: 0.953 Vali Acc: 0.689 Test Loss: 0.953 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688879).  Saving model ...
Epoch: 25 cost time: 4.696805953979492
Epoch: 25, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699991).  Saving model ...
Epoch: 26 cost time: 4.691596031188965
Epoch: 26, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.846 Vali Acc: 0.706 Test Loss: 0.846 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705547).  Saving model ...
Epoch: 27 cost time: 4.807185411453247
Epoch: 27, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.815 Vali Acc: 0.739 Test Loss: 0.815 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738881).  Saving model ...
Epoch: 28 cost time: 4.984065294265747
Epoch: 28, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.768 Vali Acc: 0.761 Test Loss: 0.768 Test Acc: 0.761
Validation loss decreased (-0.738881 --> -0.761103).  Saving model ...
Epoch: 29 cost time: 4.6347692012786865
Epoch: 29, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.419784784317017
Epoch: 30, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.699 Vali Acc: 0.761 Test Loss: 0.699 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761104).  Saving model ...
Epoch: 31 cost time: 4.911389112472534
Epoch: 31, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.667 Vali Acc: 0.767 Test Loss: 0.667 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 32 cost time: 5.73403263092041
Epoch: 32, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.645 Vali Acc: 0.794 Test Loss: 0.645 Test Acc: 0.794
Validation loss decreased (-0.766660 --> -0.794438).  Saving model ...
Epoch: 33 cost time: 4.795676946640015
Epoch: 33, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 34 cost time: 4.9782187938690186
Epoch: 34, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.07697606086731
Epoch: 35, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.589 Vali Acc: 0.806 Test Loss: 0.589 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 36 cost time: 4.817788362503052
Epoch: 36, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.559 Vali Acc: 0.806 Test Loss: 0.559 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805550).  Saving model ...
Epoch: 37 cost time: 4.400962829589844
Epoch: 37, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.565 Vali Acc: 0.800 Test Loss: 0.565 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.864736318588257
Epoch: 38, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.530 Vali Acc: 0.806 Test Loss: 0.530 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805550).  Saving model ...
Epoch: 39 cost time: 4.562533617019653
Epoch: 39, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.528 Vali Acc: 0.811 Test Loss: 0.528 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811106).  Saving model ...
Epoch: 40 cost time: 4.725542068481445
Epoch: 40, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.516 Vali Acc: 0.822 Test Loss: 0.516 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822217).  Saving model ...
Epoch: 41 cost time: 4.7518556118011475
Epoch: 41, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.512 Vali Acc: 0.811 Test Loss: 0.512 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.22800350189209
Epoch: 42, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.504 Vali Acc: 0.828 Test Loss: 0.504 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827773).  Saving model ...
Epoch: 43 cost time: 5.788739442825317
Epoch: 43, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.506 Vali Acc: 0.828 Test Loss: 0.506 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.567448139190674
Epoch: 44, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833328).  Saving model ...
Epoch: 45 cost time: 5.0106799602508545
Epoch: 45, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.499 Vali Acc: 0.822 Test Loss: 0.499 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.506299257278442
Epoch: 46, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.189501523971558
Epoch: 47, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.506 Vali Acc: 0.839 Test Loss: 0.506 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 48 cost time: 4.9603705406188965
Epoch: 48, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.504 Vali Acc: 0.833 Test Loss: 0.504 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.169658422470093
Epoch: 49, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.001160621643066
Epoch: 50, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.496 Vali Acc: 0.822 Test Loss: 0.496 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.015469551086426
Epoch: 51, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.502 Vali Acc: 0.839 Test Loss: 0.502 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 52 cost time: 4.643960237503052
Epoch: 52, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.187533855438232
Epoch: 53, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.522 Vali Acc: 0.811 Test Loss: 0.522 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 4.639721155166626
Epoch: 54, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844439).  Saving model ...
Epoch: 55 cost time: 4.984232664108276
Epoch: 55, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.214102745056152
Epoch: 56, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.516 Vali Acc: 0.833 Test Loss: 0.516 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 5.075887203216553
Epoch: 57, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 4.4173243045806885
Epoch: 58, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 5.137217283248901
Epoch: 59, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.524 Vali Acc: 0.822 Test Loss: 0.524 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 5.146833896636963
Epoch: 60, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.508 Vali Acc: 0.839 Test Loss: 0.508 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 4.235526084899902
Epoch: 61, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.512 Vali Acc: 0.839 Test Loss: 0.512 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 4.966375827789307
Epoch: 62, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.520 Vali Acc: 0.839 Test Loss: 0.520 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 5.08243727684021
Epoch: 63, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 5.027409553527832
Epoch: 64, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.895514011383057
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 4.896434545516968
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 5.893197774887085
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.21533989906311
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.650641441345215
Epoch: 5, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.947854518890381
Epoch: 6, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.798551321029663
Epoch: 7, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.8039984703063965
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.483648777008057
Epoch: 9, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.7928736209869385
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.410951375961304
Epoch: 11, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.28767728805542
Epoch: 12, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.708 Vali Acc: 0.067 Test Loss: 2.708 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 100175
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.751428127288818
Epoch: 1, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.614 Vali Acc: 0.083 Test Loss: 2.614 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 5.01201605796814
Epoch: 2, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.487 Vali Acc: 0.161 Test Loss: 2.487 Test Acc: 0.161
Validation loss decreased (-0.083307 --> -0.161086).  Saving model ...
Epoch: 3 cost time: 4.454605340957642
Epoch: 3, Steps: 12 | Train Loss: 2.456 Vali Loss: 2.338 Vali Acc: 0.311 Test Loss: 2.338 Test Acc: 0.311
Validation loss decreased (-0.161086 --> -0.311088).  Saving model ...
Epoch: 4 cost time: 4.333554029464722
Epoch: 4, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.167 Vali Acc: 0.439 Test Loss: 2.167 Test Acc: 0.439
Validation loss decreased (-0.311088 --> -0.438867).  Saving model ...
Epoch: 5 cost time: 4.836748123168945
Epoch: 5, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.005 Vali Acc: 0.583 Test Loss: 2.005 Test Acc: 0.583
Validation loss decreased (-0.438867 --> -0.583313).  Saving model ...
Epoch: 6 cost time: 4.57644248008728
Epoch: 6, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.853 Vali Acc: 0.611 Test Loss: 1.853 Test Acc: 0.611
Validation loss decreased (-0.583313 --> -0.611093).  Saving model ...
Epoch: 7 cost time: 4.169372320175171
Epoch: 7, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.713 Vali Acc: 0.622 Test Loss: 1.713 Test Acc: 0.622
Validation loss decreased (-0.611093 --> -0.622205).  Saving model ...
Epoch: 8 cost time: 4.534533262252808
Epoch: 8, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.583 Vali Acc: 0.633 Test Loss: 1.583 Test Acc: 0.633
Validation loss decreased (-0.622205 --> -0.633318).  Saving model ...
Epoch: 9 cost time: 5.055843114852905
Epoch: 9, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.477 Vali Acc: 0.644 Test Loss: 1.477 Test Acc: 0.644
Validation loss decreased (-0.633318 --> -0.644430).  Saving model ...
Epoch: 10 cost time: 4.749132394790649
Epoch: 10, Steps: 12 | Train Loss: 1.364 Vali Loss: 1.380 Vali Acc: 0.656 Test Loss: 1.380 Test Acc: 0.656
Validation loss decreased (-0.644430 --> -0.655542).  Saving model ...
Epoch: 11 cost time: 4.848794460296631
Epoch: 11, Steps: 12 | Train Loss: 1.258 Vali Loss: 1.287 Vali Acc: 0.672 Test Loss: 1.287 Test Acc: 0.672
Validation loss decreased (-0.655542 --> -0.672209).  Saving model ...
Epoch: 12 cost time: 5.669724702835083
Epoch: 12, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.213 Vali Acc: 0.700 Test Loss: 1.213 Test Acc: 0.700
Validation loss decreased (-0.672209 --> -0.699988).  Saving model ...
Epoch: 13 cost time: 5.005697250366211
Epoch: 13, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.154 Vali Acc: 0.694 Test Loss: 1.154 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.911492824554443
Epoch: 14, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.096 Vali Acc: 0.683 Test Loss: 1.096 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.814577341079712
Epoch: 15, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.023 Vali Acc: 0.706 Test Loss: 1.023 Test Acc: 0.706
Validation loss decreased (-0.699988 --> -0.705545).  Saving model ...
Epoch: 16 cost time: 5.567838668823242
Epoch: 16, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.948 Vali Acc: 0.706 Test Loss: 0.948 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705546).  Saving model ...
Epoch: 17 cost time: 5.2473344802856445
Epoch: 17, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.888 Vali Acc: 0.744 Test Loss: 0.888 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 18 cost time: 4.701038122177124
Epoch: 18, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.819 Vali Acc: 0.756 Test Loss: 0.819 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 19 cost time: 5.006766319274902
Epoch: 19, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 20 cost time: 4.461761713027954
Epoch: 20, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 21 cost time: 4.700058221817017
Epoch: 21, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.693 Vali Acc: 0.806 Test Loss: 0.693 Test Acc: 0.806
Validation loss decreased (-0.783326 --> -0.805549).  Saving model ...
Epoch: 22 cost time: 5.231248140335083
Epoch: 22, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.664 Vali Acc: 0.828 Test Loss: 0.664 Test Acc: 0.828
Validation loss decreased (-0.805549 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 5.166229009628296
Epoch: 23, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.639 Vali Acc: 0.828 Test Loss: 0.639 Test Acc: 0.828
Validation loss decreased (-0.827771 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 4.685380697250366
Epoch: 24, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.827771 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 5.039824962615967
Epoch: 25, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.586 Vali Acc: 0.856 Test Loss: 0.586 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855550).  Saving model ...
Epoch: 26 cost time: 4.497533321380615
Epoch: 26, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.173300743103027
Epoch: 27, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.293139696121216
Epoch: 28, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.586484909057617
Epoch: 29, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.185555696487427
Epoch: 30, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.484 Vali Acc: 0.872 Test Loss: 0.484 Test Acc: 0.872
Validation loss decreased (-0.855550 --> -0.872217).  Saving model ...
Epoch: 31 cost time: 4.7767415046691895
Epoch: 31, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.472 Vali Acc: 0.872 Test Loss: 0.472 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 32 cost time: 4.573678016662598
Epoch: 32, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.458 Vali Acc: 0.872 Test Loss: 0.458 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872218).  Saving model ...
Epoch: 33 cost time: 5.173790693283081
Epoch: 33, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.452 Vali Acc: 0.889 Test Loss: 0.452 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888884).  Saving model ...
Epoch: 34 cost time: 4.810204029083252
Epoch: 34, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.433 Vali Acc: 0.878 Test Loss: 0.433 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.79781699180603
Epoch: 35, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.438 Vali Acc: 0.872 Test Loss: 0.438 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.003574371337891
Epoch: 36, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 37 cost time: 4.9472174644470215
Epoch: 37, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 4.301438093185425
Epoch: 38, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.197768449783325
Epoch: 39, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.413 Vali Acc: 0.878 Test Loss: 0.413 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 4.966670751571655
Epoch: 40, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.410 Vali Acc: 0.872 Test Loss: 0.410 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.341628313064575
Epoch: 41, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.409 Vali Acc: 0.889 Test Loss: 0.409 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 4.869824171066284
Epoch: 42, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 4.659485816955566
Epoch: 43, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.736719131469727
Epoch: 44, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.587128400802612
Epoch: 45, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.395 Vali Acc: 0.894 Test Loss: 0.395 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.734580993652344
Epoch: 46, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 5.0571982860565186
Epoch: 47, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.394 Vali Acc: 0.883 Test Loss: 0.394 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.659781455993652
Epoch: 48, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.391 Vali Acc: 0.894 Test Loss: 0.391 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.620105743408203
Epoch: 49, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.35408353805542
Epoch: 50, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.400 Vali Acc: 0.883 Test Loss: 0.400 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 6.013023853302002
Epoch: 51, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 5.178417444229126
Epoch: 52, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 4.698781967163086
Epoch: 53, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.401 Vali Acc: 0.906 Test Loss: 0.401 Test Acc: 0.906
Validation loss decreased (-0.899996 --> -0.905552).  Saving model ...
Epoch: 54 cost time: 4.897318124771118
Epoch: 54, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.384 Vali Acc: 0.894 Test Loss: 0.384 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.430710315704346
Epoch: 55, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.441795825958252
Epoch: 56, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.421 Vali Acc: 0.894 Test Loss: 0.421 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.346011161804199
Epoch: 57, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.416 Vali Acc: 0.883 Test Loss: 0.416 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.299782752990723
Epoch: 58, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 5.501228094100952
Epoch: 59, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 5.0061352252960205
Epoch: 60, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.402 Vali Acc: 0.894 Test Loss: 0.402 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 5.0127198696136475
Epoch: 61, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.414 Vali Acc: 0.894 Test Loss: 0.414 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 5.868910312652588
Epoch: 62, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 4.933490514755249
Epoch: 63, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.410 Vali Acc: 0.889 Test Loss: 0.410 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.9055555555555556
model parameter : 75599
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         18                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.403852701187134
Epoch: 1, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.628 Vali Acc: 0.150 Test Loss: 2.628 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 5.254235506057739
Epoch: 2, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.529 Vali Acc: 0.167 Test Loss: 2.529 Test Acc: 0.167
Validation loss decreased (-0.149974 --> -0.166641).  Saving model ...
Epoch: 3 cost time: 5.814047574996948
Epoch: 3, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.412 Vali Acc: 0.311 Test Loss: 2.412 Test Acc: 0.311
Validation loss decreased (-0.166641 --> -0.311087).  Saving model ...
Epoch: 4 cost time: 5.779942274093628
Epoch: 4, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.277 Vali Acc: 0.417 Test Loss: 2.277 Test Acc: 0.417
Validation loss decreased (-0.311087 --> -0.416644).  Saving model ...
Epoch: 5 cost time: 5.598233222961426
Epoch: 5, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.147 Vali Acc: 0.489 Test Loss: 2.147 Test Acc: 0.489
Validation loss decreased (-0.416644 --> -0.488867).  Saving model ...
Epoch: 6 cost time: 5.788360118865967
Epoch: 6, Steps: 12 | Train Loss: 2.091 Vali Loss: 2.021 Vali Acc: 0.489 Test Loss: 2.021 Test Acc: 0.489
Validation loss decreased (-0.488867 --> -0.488869).  Saving model ...
Epoch: 7 cost time: 5.2645018100738525
Epoch: 7, Steps: 12 | Train Loss: 2.035 Vali Loss: 1.902 Vali Acc: 0.533 Test Loss: 1.902 Test Acc: 0.533
Validation loss decreased (-0.488869 --> -0.533314).  Saving model ...
Epoch: 8 cost time: 4.629836082458496
Epoch: 8, Steps: 12 | Train Loss: 1.883 Vali Loss: 1.784 Vali Acc: 0.567 Test Loss: 1.784 Test Acc: 0.567
Validation loss decreased (-0.533314 --> -0.566649).  Saving model ...
Epoch: 9 cost time: 4.411463975906372
Epoch: 9, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.683 Vali Acc: 0.589 Test Loss: 1.683 Test Acc: 0.589
Validation loss decreased (-0.566649 --> -0.588872).  Saving model ...
Epoch: 10 cost time: 5.833544731140137
Epoch: 10, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.588 Vali Acc: 0.578 Test Loss: 1.588 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.621088027954102
Epoch: 11, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.495 Vali Acc: 0.600 Test Loss: 1.495 Test Acc: 0.600
Validation loss decreased (-0.588872 --> -0.599985).  Saving model ...
Epoch: 12 cost time: 4.780341863632202
Epoch: 12, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.416 Vali Acc: 0.622 Test Loss: 1.416 Test Acc: 0.622
Validation loss decreased (-0.599985 --> -0.622208).  Saving model ...
Epoch: 13 cost time: 5.161163568496704
Epoch: 13, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.344 Vali Acc: 0.622 Test Loss: 1.344 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 14 cost time: 5.105336666107178
Epoch: 14, Steps: 12 | Train Loss: 1.192 Vali Loss: 1.277 Vali Acc: 0.639 Test Loss: 1.277 Test Acc: 0.639
Validation loss decreased (-0.622209 --> -0.638876).  Saving model ...
Epoch: 15 cost time: 5.851027965545654
Epoch: 15, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.199 Vali Acc: 0.656 Test Loss: 1.199 Test Acc: 0.656
Validation loss decreased (-0.638876 --> -0.655544).  Saving model ...
Epoch: 16 cost time: 5.531978368759155
Epoch: 16, Steps: 12 | Train Loss: 1.023 Vali Loss: 1.114 Vali Acc: 0.678 Test Loss: 1.114 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677767).  Saving model ...
Epoch: 17 cost time: 6.109285831451416
Epoch: 17, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.044 Vali Acc: 0.728 Test Loss: 1.044 Test Acc: 0.728
Validation loss decreased (-0.677767 --> -0.727767).  Saving model ...
Epoch: 18 cost time: 6.176207542419434
Epoch: 18, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.960 Vali Acc: 0.728 Test Loss: 0.960 Test Acc: 0.728
Validation loss decreased (-0.727767 --> -0.727768).  Saving model ...
Epoch: 19 cost time: 5.345601558685303
Epoch: 19, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.905 Vali Acc: 0.744 Test Loss: 0.905 Test Acc: 0.744
Validation loss decreased (-0.727768 --> -0.744435).  Saving model ...
Epoch: 20 cost time: 6.238168954849243
Epoch: 20, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.853 Vali Acc: 0.767 Test Loss: 0.853 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 21 cost time: 5.291640758514404
Epoch: 21, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.800 Vali Acc: 0.783 Test Loss: 0.800 Test Acc: 0.783
Validation loss decreased (-0.766658 --> -0.783325).  Saving model ...
Epoch: 22 cost time: 5.318210124969482
Epoch: 22, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.762 Vali Acc: 0.794 Test Loss: 0.762 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794437).  Saving model ...
Epoch: 23 cost time: 5.466167688369751
Epoch: 23, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.746 Vali Acc: 0.783 Test Loss: 0.746 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.94403338432312
Epoch: 24, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.697 Vali Acc: 0.811 Test Loss: 0.697 Test Acc: 0.811
Validation loss decreased (-0.794437 --> -0.811104).  Saving model ...
Epoch: 25 cost time: 5.418952226638794
Epoch: 25, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822216).  Saving model ...
Epoch: 26 cost time: 5.214995622634888
Epoch: 26, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.655 Vali Acc: 0.811 Test Loss: 0.655 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.8277037143707275
Epoch: 27, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 4.895996809005737
Epoch: 28, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.611 Vali Acc: 0.833 Test Loss: 0.611 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 29 cost time: 4.651785612106323
Epoch: 29, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.833327 --> -0.849994).  Saving model ...
Epoch: 30 cost time: 5.738725185394287
Epoch: 30, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.549813508987427
Epoch: 31, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.566 Vali Acc: 0.850 Test Loss: 0.566 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 32 cost time: 6.473551034927368
Epoch: 32, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.554 Vali Acc: 0.861 Test Loss: 0.554 Test Acc: 0.861
Validation loss decreased (-0.849994 --> -0.861106).  Saving model ...
Epoch: 33 cost time: 5.424204111099243
Epoch: 33, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.557 Vali Acc: 0.844 Test Loss: 0.557 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.249393939971924
Epoch: 34, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866661).  Saving model ...
Epoch: 35 cost time: 5.6566901206970215
Epoch: 35, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
Validation loss decreased (-0.866661 --> -0.872217).  Saving model ...
Epoch: 36 cost time: 5.512253046035767
Epoch: 36, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.940630912780762
Epoch: 37, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.714366912841797
Epoch: 38, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.529 Vali Acc: 0.872 Test Loss: 0.529 Test Acc: 0.872
Validation loss decreased (-0.872217 --> -0.872217).  Saving model ...
Epoch: 39 cost time: 6.250797510147095
Epoch: 39, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.963856935501099
Epoch: 40, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.509 Vali Acc: 0.867 Test Loss: 0.509 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.646973371505737
Epoch: 41, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.511 Vali Acc: 0.878 Test Loss: 0.511 Test Acc: 0.878
Validation loss decreased (-0.872217 --> -0.877773).  Saving model ...
Epoch: 42 cost time: 6.376803398132324
Epoch: 42, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.506 Vali Acc: 0.861 Test Loss: 0.506 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.855023384094238
Epoch: 43, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.634675979614258
Epoch: 44, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 5.418197154998779
Epoch: 45, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 5.340843677520752
Epoch: 46, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.499 Vali Acc: 0.883 Test Loss: 0.499 Test Acc: 0.883
Validation loss decreased (-0.877773 --> -0.883328).  Saving model ...
Epoch: 47 cost time: 6.840752124786377
Epoch: 47, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.506 Vali Acc: 0.878 Test Loss: 0.506 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.312471866607666
Epoch: 48, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.508 Vali Acc: 0.872 Test Loss: 0.508 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.796514511108398
Epoch: 49, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.8001508712768555
Epoch: 50, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.515 Vali Acc: 0.867 Test Loss: 0.515 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.78686785697937
Epoch: 51, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 5.174057245254517
Epoch: 52, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.524 Vali Acc: 0.878 Test Loss: 0.524 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 5.316027641296387
Epoch: 53, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 4.994448184967041
Epoch: 54, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 5.599423170089722
Epoch: 55, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.530 Vali Acc: 0.872 Test Loss: 0.530 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 5.701988935470581
Epoch: 56, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.525 Vali Acc: 0.878 Test Loss: 0.525 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8833333333333333
model parameter : 75599
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.639765024185181
Epoch: 1, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.676 Vali Acc: 0.156 Test Loss: 2.676 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 5.240460395812988
Epoch: 2, Steps: 12 | Train Loss: 2.726 Vali Loss: 2.593 Vali Acc: 0.211 Test Loss: 2.593 Test Acc: 0.211
Validation loss decreased (-0.155529 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 6.151520013809204
Epoch: 3, Steps: 12 | Train Loss: 2.572 Vali Loss: 2.495 Vali Acc: 0.244 Test Loss: 2.495 Test Acc: 0.244
Validation loss decreased (-0.211085 --> -0.244419).  Saving model ...
Epoch: 4 cost time: 7.9479286670684814
Epoch: 4, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.383 Vali Acc: 0.311 Test Loss: 2.383 Test Acc: 0.311
Validation loss decreased (-0.244419 --> -0.311087).  Saving model ...
Epoch: 5 cost time: 6.371277093887329
Epoch: 5, Steps: 12 | Train Loss: 2.358 Vali Loss: 2.275 Vali Acc: 0.339 Test Loss: 2.275 Test Acc: 0.339
Validation loss decreased (-0.311087 --> -0.338866).  Saving model ...
Epoch: 6 cost time: 7.236046552658081
Epoch: 6, Steps: 12 | Train Loss: 2.228 Vali Loss: 2.168 Vali Acc: 0.367 Test Loss: 2.168 Test Acc: 0.367
Validation loss decreased (-0.338866 --> -0.366645).  Saving model ...
Epoch: 7 cost time: 7.497266530990601
Epoch: 7, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.068 Vali Acc: 0.411 Test Loss: 2.068 Test Acc: 0.411
Validation loss decreased (-0.366645 --> -0.411090).  Saving model ...
Epoch: 8 cost time: 6.2277727127075195
Epoch: 8, Steps: 12 | Train Loss: 2.048 Vali Loss: 1.968 Vali Acc: 0.417 Test Loss: 1.968 Test Acc: 0.417
Validation loss decreased (-0.411090 --> -0.416647).  Saving model ...
Epoch: 9 cost time: 6.964840888977051
Epoch: 9, Steps: 12 | Train Loss: 1.984 Vali Loss: 1.881 Vali Acc: 0.433 Test Loss: 1.881 Test Acc: 0.433
Validation loss decreased (-0.416647 --> -0.433315).  Saving model ...
Epoch: 10 cost time: 7.188566207885742
Epoch: 10, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.795 Vali Acc: 0.494 Test Loss: 1.795 Test Acc: 0.494
Validation loss decreased (-0.433315 --> -0.494426).  Saving model ...
Epoch: 11 cost time: 6.1952009201049805
Epoch: 11, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.709 Vali Acc: 0.517 Test Loss: 1.709 Test Acc: 0.517
Validation loss decreased (-0.494426 --> -0.516650).  Saving model ...
Epoch: 12 cost time: 6.649246692657471
Epoch: 12, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.632 Vali Acc: 0.544 Test Loss: 1.632 Test Acc: 0.544
Validation loss decreased (-0.516650 --> -0.544428).  Saving model ...
Epoch: 13 cost time: 5.910206317901611
Epoch: 13, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.558 Vali Acc: 0.556 Test Loss: 1.558 Test Acc: 0.556
Validation loss decreased (-0.544428 --> -0.555540).  Saving model ...
Epoch: 14 cost time: 6.613202095031738
Epoch: 14, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.490 Vali Acc: 0.572 Test Loss: 1.490 Test Acc: 0.572
Validation loss decreased (-0.555540 --> -0.572207).  Saving model ...
Epoch: 15 cost time: 5.4004716873168945
Epoch: 15, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.409 Vali Acc: 0.589 Test Loss: 1.409 Test Acc: 0.589
Validation loss decreased (-0.572207 --> -0.588875).  Saving model ...
Epoch: 16 cost time: 6.458502769470215
Epoch: 16, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.311 Vali Acc: 0.606 Test Loss: 1.311 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605542).  Saving model ...
Epoch: 17 cost time: 5.621078968048096
Epoch: 17, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.234 Vali Acc: 0.650 Test Loss: 1.234 Test Acc: 0.650
Validation loss decreased (-0.605542 --> -0.649988).  Saving model ...
Epoch: 18 cost time: 6.310600996017456
Epoch: 18, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.134 Vali Acc: 0.661 Test Loss: 1.134 Test Acc: 0.661
Validation loss decreased (-0.649988 --> -0.661100).  Saving model ...
Epoch: 19 cost time: 6.077926158905029
Epoch: 19, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.066 Vali Acc: 0.678 Test Loss: 1.066 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677767).  Saving model ...
Epoch: 20 cost time: 5.767778635025024
Epoch: 20, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
Validation loss decreased (-0.677767 --> -0.722212).  Saving model ...
Epoch: 21 cost time: 6.697960376739502
Epoch: 21, Steps: 12 | Train Loss: 0.763 Vali Loss: 0.934 Vali Acc: 0.739 Test Loss: 0.934 Test Acc: 0.739
Validation loss decreased (-0.722212 --> -0.738880).  Saving model ...
Epoch: 22 cost time: 6.159375429153442
Epoch: 22, Steps: 12 | Train Loss: 0.685 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 23 cost time: 7.018557548522949
Epoch: 23, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.869 Vali Acc: 0.744 Test Loss: 0.869 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 6.530202150344849
Epoch: 24, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.811 Vali Acc: 0.772 Test Loss: 0.811 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772214).  Saving model ...
Epoch: 25 cost time: 6.870474815368652
Epoch: 25, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 26 cost time: 6.729753732681274
Epoch: 26, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.757 Vali Acc: 0.767 Test Loss: 0.757 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.914512634277344
Epoch: 27, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.718 Vali Acc: 0.778 Test Loss: 0.718 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 28 cost time: 5.993588447570801
Epoch: 28, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 29 cost time: 5.932381629943848
Epoch: 29, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.678 Vali Acc: 0.794 Test Loss: 0.678 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 30 cost time: 6.662841081619263
Epoch: 30, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.159408092498779
Epoch: 31, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.628 Vali Acc: 0.811 Test Loss: 0.628 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 32 cost time: 5.641286373138428
Epoch: 32, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.602 Vali Acc: 0.839 Test Loss: 0.602 Test Acc: 0.839
Validation loss decreased (-0.811105 --> -0.838883).  Saving model ...
Epoch: 33 cost time: 6.873379468917847
Epoch: 33, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.402876138687134
Epoch: 34, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.904700040817261
Epoch: 35, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.582 Vali Acc: 0.817 Test Loss: 0.582 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.303363561630249
Epoch: 36, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 37 cost time: 6.097752809524536
Epoch: 37, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.9794158935546875
Epoch: 38, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.2858991622924805
Epoch: 39, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.538 Vali Acc: 0.828 Test Loss: 0.538 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.057217121124268
Epoch: 40, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.514 Vali Acc: 0.856 Test Loss: 0.514 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 41 cost time: 5.8625710010528564
Epoch: 41, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.513 Vali Acc: 0.844 Test Loss: 0.513 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.863268852233887
Epoch: 42, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.516 Vali Acc: 0.839 Test Loss: 0.516 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.619903802871704
Epoch: 43, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 6.015811443328857
Epoch: 44, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.498 Vali Acc: 0.867 Test Loss: 0.498 Test Acc: 0.867
Validation loss decreased (-0.855550 --> -0.866662).  Saving model ...
Epoch: 45 cost time: 6.332702398300171
Epoch: 45, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.975999355316162
Epoch: 46, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.599469423294067
Epoch: 47, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.505 Vali Acc: 0.839 Test Loss: 0.505 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.784336566925049
Epoch: 48, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 5.910395383834839
Epoch: 49, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 6.110445499420166
Epoch: 50, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.524 Vali Acc: 0.839 Test Loss: 0.524 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 5.628804922103882
Epoch: 51, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.506 Vali Acc: 0.839 Test Loss: 0.506 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 6.191033124923706
Epoch: 52, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.493 Vali Acc: 0.861 Test Loss: 0.493 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 6.2265026569366455
Epoch: 53, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 6.771192312240601
Epoch: 54, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 75599
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.661637544631958
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.805 Vali Acc: 0.078 Test Loss: 2.805 Test Acc: 0.078
Validation loss decreased (inf --> -0.077750).  Saving model ...
Epoch: 2 cost time: 6.133024454116821
Epoch: 2, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.733 Vali Acc: 0.078 Test Loss: 2.733 Test Acc: 0.078
Validation loss decreased (-0.077750 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 5.867456436157227
Epoch: 3, Steps: 12 | Train Loss: 2.659 Vali Loss: 2.654 Vali Acc: 0.100 Test Loss: 2.654 Test Acc: 0.100
Validation loss decreased (-0.077750 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 5.597632884979248
Epoch: 4, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.565 Vali Acc: 0.111 Test Loss: 2.565 Test Acc: 0.111
Validation loss decreased (-0.099973 --> -0.111085).  Saving model ...
Epoch: 5 cost time: 6.267335653305054
Epoch: 5, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.479 Vali Acc: 0.200 Test Loss: 2.479 Test Acc: 0.200
Validation loss decreased (-0.111085 --> -0.199975).  Saving model ...
Epoch: 6 cost time: 5.276196241378784
Epoch: 6, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.398 Vali Acc: 0.261 Test Loss: 2.398 Test Acc: 0.261
Validation loss decreased (-0.199975 --> -0.261087).  Saving model ...
Epoch: 7 cost time: 6.53446626663208
Epoch: 7, Steps: 12 | Train Loss: 2.389 Vali Loss: 2.318 Vali Acc: 0.344 Test Loss: 2.318 Test Acc: 0.344
Validation loss decreased (-0.261087 --> -0.344421).  Saving model ...
Epoch: 8 cost time: 6.480607271194458
Epoch: 8, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.236 Vali Acc: 0.339 Test Loss: 2.236 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.717457056045532
Epoch: 9, Steps: 12 | Train Loss: 2.185 Vali Loss: 2.166 Vali Acc: 0.406 Test Loss: 2.166 Test Acc: 0.406
Validation loss decreased (-0.344421 --> -0.405534).  Saving model ...
Epoch: 10 cost time: 7.1190783977508545
Epoch: 10, Steps: 12 | Train Loss: 2.093 Vali Loss: 2.090 Vali Acc: 0.378 Test Loss: 2.090 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.229781627655029
Epoch: 11, Steps: 12 | Train Loss: 1.997 Vali Loss: 2.005 Vali Acc: 0.383 Test Loss: 2.005 Test Acc: 0.383
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.595142841339111
Epoch: 12, Steps: 12 | Train Loss: 1.950 Vali Loss: 1.922 Vali Acc: 0.428 Test Loss: 1.922 Test Acc: 0.428
Validation loss decreased (-0.405534 --> -0.427759).  Saving model ...
Epoch: 13 cost time: 6.300306558609009
Epoch: 13, Steps: 12 | Train Loss: 1.857 Vali Loss: 1.835 Vali Acc: 0.461 Test Loss: 1.835 Test Acc: 0.461
Validation loss decreased (-0.427759 --> -0.461093).  Saving model ...
Epoch: 14 cost time: 5.884145975112915
Epoch: 14, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.746 Vali Acc: 0.500 Test Loss: 1.746 Test Acc: 0.500
Validation loss decreased (-0.461093 --> -0.499983).  Saving model ...
Epoch: 15 cost time: 6.026097059249878
Epoch: 15, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.638 Vali Acc: 0.522 Test Loss: 1.638 Test Acc: 0.522
Validation loss decreased (-0.499983 --> -0.522206).  Saving model ...
Epoch: 16 cost time: 5.882085084915161
Epoch: 16, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.508 Vali Acc: 0.600 Test Loss: 1.508 Test Acc: 0.600
Validation loss decreased (-0.522206 --> -0.599985).  Saving model ...
Epoch: 17 cost time: 5.89713191986084
Epoch: 17, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.393 Vali Acc: 0.611 Test Loss: 1.393 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 18 cost time: 5.932173490524292
Epoch: 18, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.255 Vali Acc: 0.672 Test Loss: 1.255 Test Acc: 0.672
Validation loss decreased (-0.611097 --> -0.672210).  Saving model ...
Epoch: 19 cost time: 5.8299031257629395
Epoch: 19, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.158 Vali Acc: 0.700 Test Loss: 1.158 Test Acc: 0.700
Validation loss decreased (-0.672210 --> -0.699988).  Saving model ...
Epoch: 20 cost time: 5.911750555038452
Epoch: 20, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.063 Vali Acc: 0.678 Test Loss: 1.063 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.2343151569366455
Epoch: 21, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.004 Vali Acc: 0.717 Test Loss: 1.004 Test Acc: 0.717
Validation loss decreased (-0.699988 --> -0.716657).  Saving model ...
Epoch: 22 cost time: 5.9061408042907715
Epoch: 22, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.929 Vali Acc: 0.706 Test Loss: 0.929 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.093288898468018
Epoch: 23, Steps: 12 | Train Loss: 0.756 Vali Loss: 0.893 Vali Acc: 0.744 Test Loss: 0.893 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 7.016062498092651
Epoch: 24, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.826 Vali Acc: 0.733 Test Loss: 0.826 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.92557692527771
Epoch: 25, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.785 Vali Acc: 0.739 Test Loss: 0.785 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.97930121421814
Epoch: 26, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.755 Vali Acc: 0.756 Test Loss: 0.755 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 5.878972053527832
Epoch: 27, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.711 Vali Acc: 0.761 Test Loss: 0.711 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 28 cost time: 5.942526817321777
Epoch: 28, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.673 Vali Acc: 0.794 Test Loss: 0.673 Test Acc: 0.794
Validation loss decreased (-0.761104 --> -0.794438).  Saving model ...
Epoch: 29 cost time: 6.603752136230469
Epoch: 29, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.833901405334473
Epoch: 30, Steps: 12 | Train Loss: 0.451 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 31 cost time: 5.222294330596924
Epoch: 31, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.621 Vali Acc: 0.806 Test Loss: 0.621 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805549).  Saving model ...
Epoch: 32 cost time: 6.713284254074097
Epoch: 32, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.605 Vali Acc: 0.811 Test Loss: 0.605 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 33 cost time: 5.847164630889893
Epoch: 33, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.591 Vali Acc: 0.817 Test Loss: 0.591 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816661).  Saving model ...
Epoch: 34 cost time: 5.576434850692749
Epoch: 34, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.567 Vali Acc: 0.839 Test Loss: 0.567 Test Acc: 0.839
Validation loss decreased (-0.816661 --> -0.838883).  Saving model ...
Epoch: 35 cost time: 7.087027072906494
Epoch: 35, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.053076267242432
Epoch: 36, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844439).  Saving model ...
Epoch: 37 cost time: 5.9192986488342285
Epoch: 37, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.540 Vali Acc: 0.839 Test Loss: 0.540 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.4711387157440186
Epoch: 38, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 39 cost time: 6.340611457824707
Epoch: 39, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.539 Vali Acc: 0.856 Test Loss: 0.539 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 40 cost time: 5.6679253578186035
Epoch: 40, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.537 Vali Acc: 0.861 Test Loss: 0.537 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 41 cost time: 5.807933330535889
Epoch: 41, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.535 Vali Acc: 0.856 Test Loss: 0.535 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.872230768203735
Epoch: 42, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.532 Vali Acc: 0.861 Test Loss: 0.532 Test Acc: 0.861
Validation loss decreased (-0.861106 --> -0.861106).  Saving model ...
Epoch: 43 cost time: 7.390725135803223
Epoch: 43, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.38360595703125
Epoch: 44, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.479422330856323
Epoch: 45, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.629093885421753
Epoch: 46, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 5.3711097240448
Epoch: 47, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 6.246132850646973
Epoch: 48, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 5.1874237060546875
Epoch: 49, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.534 Vali Acc: 0.844 Test Loss: 0.534 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 5.696840047836304
Epoch: 50, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 5.321966648101807
Epoch: 51, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.559 Vali Acc: 0.844 Test Loss: 0.559 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 6.259166717529297
Epoch: 52, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.570 Vali Acc: 0.839 Test Loss: 0.570 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 75599
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.612782716751099
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.872 Vali Acc: 0.039 Test Loss: 2.872 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 6.319511413574219
Epoch: 2, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.821 Vali Acc: 0.039 Test Loss: 2.821 Test Acc: 0.039
Validation loss decreased (-0.038860 --> -0.038861).  Saving model ...
Epoch: 3 cost time: 6.590340852737427
Epoch: 3, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.759 Vali Acc: 0.039 Test Loss: 2.759 Test Acc: 0.039
Validation loss decreased (-0.038861 --> -0.038861).  Saving model ...
Epoch: 4 cost time: 5.547768831253052
Epoch: 4, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.679 Vali Acc: 0.044 Test Loss: 2.679 Test Acc: 0.044
Validation loss decreased (-0.038861 --> -0.044418).  Saving model ...
Epoch: 5 cost time: 5.597850322723389
Epoch: 5, Steps: 12 | Train Loss: 2.621 Vali Loss: 2.589 Vali Acc: 0.067 Test Loss: 2.589 Test Acc: 0.067
Validation loss decreased (-0.044418 --> -0.066641).  Saving model ...
Epoch: 6 cost time: 5.789126873016357
Epoch: 6, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.497 Vali Acc: 0.144 Test Loss: 2.497 Test Acc: 0.144
Validation loss decreased (-0.066641 --> -0.144419).  Saving model ...
Epoch: 7 cost time: 5.681142330169678
Epoch: 7, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.393 Vali Acc: 0.183 Test Loss: 2.393 Test Acc: 0.183
Validation loss decreased (-0.144419 --> -0.183309).  Saving model ...
Epoch: 8 cost time: 6.278319835662842
Epoch: 8, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.281 Vali Acc: 0.244 Test Loss: 2.281 Test Acc: 0.244
Validation loss decreased (-0.183309 --> -0.244422).  Saving model ...
Epoch: 9 cost time: 5.2178802490234375
Epoch: 9, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.180 Vali Acc: 0.300 Test Loss: 2.180 Test Acc: 0.300
Validation loss decreased (-0.244422 --> -0.299978).  Saving model ...
Epoch: 10 cost time: 5.223069429397583
Epoch: 10, Steps: 12 | Train Loss: 2.209 Vali Loss: 2.077 Vali Acc: 0.306 Test Loss: 2.077 Test Acc: 0.306
Validation loss decreased (-0.299978 --> -0.305535).  Saving model ...
Epoch: 11 cost time: 5.919065237045288
Epoch: 11, Steps: 12 | Train Loss: 2.101 Vali Loss: 1.972 Vali Acc: 0.300 Test Loss: 1.972 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.013758897781372
Epoch: 12, Steps: 12 | Train Loss: 2.070 Vali Loss: 1.878 Vali Acc: 0.356 Test Loss: 1.878 Test Acc: 0.356
Validation loss decreased (-0.305535 --> -0.355537).  Saving model ...
Epoch: 13 cost time: 6.472501993179321
Epoch: 13, Steps: 12 | Train Loss: 1.941 Vali Loss: 1.794 Vali Acc: 0.367 Test Loss: 1.794 Test Acc: 0.367
Validation loss decreased (-0.355537 --> -0.366649).  Saving model ...
Epoch: 14 cost time: 5.400278568267822
Epoch: 14, Steps: 12 | Train Loss: 1.849 Vali Loss: 1.723 Vali Acc: 0.422 Test Loss: 1.723 Test Acc: 0.422
Validation loss decreased (-0.366649 --> -0.422205).  Saving model ...
Epoch: 15 cost time: 5.744363307952881
Epoch: 15, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.617 Vali Acc: 0.439 Test Loss: 1.617 Test Acc: 0.439
Validation loss decreased (-0.422205 --> -0.438873).  Saving model ...
Epoch: 16 cost time: 6.202236890792847
Epoch: 16, Steps: 12 | Train Loss: 1.566 Vali Loss: 1.506 Vali Acc: 0.511 Test Loss: 1.506 Test Acc: 0.511
Validation loss decreased (-0.438873 --> -0.511096).  Saving model ...
Epoch: 17 cost time: 4.741144180297852
Epoch: 17, Steps: 12 | Train Loss: 1.409 Vali Loss: 1.414 Vali Acc: 0.567 Test Loss: 1.414 Test Acc: 0.567
Validation loss decreased (-0.511096 --> -0.566653).  Saving model ...
Epoch: 18 cost time: 5.116795063018799
Epoch: 18, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.311 Vali Acc: 0.594 Test Loss: 1.311 Test Acc: 0.594
Validation loss decreased (-0.566653 --> -0.594431).  Saving model ...
Epoch: 19 cost time: 5.2294721603393555
Epoch: 19, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.243 Vali Acc: 0.622 Test Loss: 1.243 Test Acc: 0.622
Validation loss decreased (-0.594431 --> -0.622210).  Saving model ...
Epoch: 20 cost time: 5.0286900997161865
Epoch: 20, Steps: 12 | Train Loss: 1.032 Vali Loss: 1.164 Vali Acc: 0.678 Test Loss: 1.164 Test Acc: 0.678
Validation loss decreased (-0.622210 --> -0.677766).  Saving model ...
Epoch: 21 cost time: 5.827686786651611
Epoch: 21, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.125 Vali Acc: 0.639 Test Loss: 1.125 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.8840296268463135
Epoch: 22, Steps: 12 | Train Loss: 0.903 Vali Loss: 1.070 Vali Acc: 0.639 Test Loss: 1.070 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.898165225982666
Epoch: 23, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.020 Vali Acc: 0.661 Test Loss: 1.020 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.842211723327637
Epoch: 24, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.953 Vali Acc: 0.706 Test Loss: 0.953 Test Acc: 0.706
Validation loss decreased (-0.677766 --> -0.705546).  Saving model ...
Epoch: 25 cost time: 4.863946199417114
Epoch: 25, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.910 Vali Acc: 0.711 Test Loss: 0.910 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711102).  Saving model ...
Epoch: 26 cost time: 5.324554443359375
Epoch: 26, Steps: 12 | Train Loss: 0.659 Vali Loss: 0.867 Vali Acc: 0.694 Test Loss: 0.867 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.646079778671265
Epoch: 27, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
Validation loss decreased (-0.711102 --> -0.727770).  Saving model ...
Epoch: 28 cost time: 5.516453266143799
Epoch: 28, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.789 Vali Acc: 0.733 Test Loss: 0.789 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733325).  Saving model ...
Epoch: 29 cost time: 5.361877202987671
Epoch: 29, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755548).  Saving model ...
Epoch: 30 cost time: 5.296485185623169
Epoch: 30, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.733 Vali Acc: 0.744 Test Loss: 0.733 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.000850200653076
Epoch: 31, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.695 Vali Acc: 0.756 Test Loss: 0.695 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 32 cost time: 5.88717794418335
Epoch: 32, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.681 Vali Acc: 0.756 Test Loss: 0.681 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755549).  Saving model ...
Epoch: 33 cost time: 6.257365942001343
Epoch: 33, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.656 Vali Acc: 0.789 Test Loss: 0.656 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788882).  Saving model ...
Epoch: 34 cost time: 5.8231425285339355
Epoch: 34, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 35 cost time: 5.643674373626709
Epoch: 35, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.972118616104126
Epoch: 36, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.594 Vali Acc: 0.811 Test Loss: 0.594 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 37 cost time: 5.876129865646362
Epoch: 37, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.853367805480957
Epoch: 38, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.580 Vali Acc: 0.822 Test Loss: 0.580 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822216).  Saving model ...
Epoch: 39 cost time: 5.998528003692627
Epoch: 39, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.566 Vali Acc: 0.839 Test Loss: 0.566 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838883).  Saving model ...
Epoch: 40 cost time: 5.232899904251099
Epoch: 40, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.561 Vali Acc: 0.828 Test Loss: 0.561 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.417020797729492
Epoch: 41, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.549 Vali Acc: 0.811 Test Loss: 0.549 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.463664770126343
Epoch: 42, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.549 Vali Acc: 0.817 Test Loss: 0.549 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.951778888702393
Epoch: 43, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.363958358764648
Epoch: 44, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.538 Vali Acc: 0.822 Test Loss: 0.538 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.585612058639526
Epoch: 45, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 6.76352858543396
Epoch: 46, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
Validation loss decreased (-0.838883 --> -0.838884).  Saving model ...
Epoch: 47 cost time: 5.465853214263916
Epoch: 47, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.526 Vali Acc: 0.828 Test Loss: 0.526 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.249535083770752
Epoch: 48, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.107232570648193
Epoch: 49, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.519 Vali Acc: 0.839 Test Loss: 0.519 Test Acc: 0.839
Validation loss decreased (-0.838884 --> -0.838884).  Saving model ...
Epoch: 50 cost time: 6.159217119216919
Epoch: 50, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 6.579322576522827
Epoch: 51, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.457159519195557
Epoch: 52, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.990155458450317
Epoch: 53, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.520 Vali Acc: 0.856 Test Loss: 0.520 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 54 cost time: 6.385010480880737
Epoch: 54, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.525 Vali Acc: 0.844 Test Loss: 0.525 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 6.199615478515625
Epoch: 55, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.77721905708313
Epoch: 56, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.510 Vali Acc: 0.839 Test Loss: 0.510 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.46968674659729
Epoch: 57, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.521 Vali Acc: 0.844 Test Loss: 0.521 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.519442081451416
Epoch: 58, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.529 Vali Acc: 0.856 Test Loss: 0.529 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 5.3685033321380615
Epoch: 59, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.537 Vali Acc: 0.839 Test Loss: 0.537 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 6.117382049560547
Epoch: 60, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.530 Vali Acc: 0.856 Test Loss: 0.530 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 4.607390642166138
Epoch: 61, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.541 Vali Acc: 0.856 Test Loss: 0.541 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 4.832464694976807
Epoch: 62, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.548 Vali Acc: 0.856 Test Loss: 0.548 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 6.441271781921387
Epoch: 63, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.540 Vali Acc: 0.856 Test Loss: 0.540 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 75599
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 6.950652837753296
Epoch: 1, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.839 Vali Acc: 0.067 Test Loss: 2.839 Test Acc: 0.067
Validation loss decreased (inf --> -0.066638).  Saving model ...
Epoch: 2 cost time: 6.4993250370025635
Epoch: 2, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.757 Vali Acc: 0.083 Test Loss: 2.757 Test Acc: 0.083
Validation loss decreased (-0.066638 --> -0.083306).  Saving model ...
Epoch: 3 cost time: 5.7006306648254395
Epoch: 3, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.654 Vali Acc: 0.144 Test Loss: 2.654 Test Acc: 0.144
Validation loss decreased (-0.083306 --> -0.144418).  Saving model ...
Epoch: 4 cost time: 6.552268743515015
Epoch: 4, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.535 Vali Acc: 0.178 Test Loss: 2.535 Test Acc: 0.178
Validation loss decreased (-0.144418 --> -0.177752).  Saving model ...
Epoch: 5 cost time: 5.364965438842773
Epoch: 5, Steps: 12 | Train Loss: 2.653 Vali Loss: 2.425 Vali Acc: 0.239 Test Loss: 2.425 Test Acc: 0.239
Validation loss decreased (-0.177752 --> -0.238865).  Saving model ...
Epoch: 6 cost time: 4.85113525390625
Epoch: 6, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.329 Vali Acc: 0.289 Test Loss: 2.329 Test Acc: 0.289
Validation loss decreased (-0.238865 --> -0.288866).  Saving model ...
Epoch: 7 cost time: 5.825758695602417
Epoch: 7, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.245 Vali Acc: 0.344 Test Loss: 2.245 Test Acc: 0.344
Validation loss decreased (-0.288866 --> -0.344422).  Saving model ...
Epoch: 8 cost time: 6.121668577194214
Epoch: 8, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.163 Vali Acc: 0.333 Test Loss: 2.163 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.229201793670654
Epoch: 9, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.093 Vali Acc: 0.378 Test Loss: 2.093 Test Acc: 0.378
Validation loss decreased (-0.344422 --> -0.377757).  Saving model ...
Epoch: 10 cost time: 5.00680136680603
Epoch: 10, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.016 Vali Acc: 0.361 Test Loss: 2.016 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.307920932769775
Epoch: 11, Steps: 12 | Train Loss: 2.233 Vali Loss: 1.945 Vali Acc: 0.389 Test Loss: 1.945 Test Acc: 0.389
Validation loss decreased (-0.377757 --> -0.388869).  Saving model ...
Epoch: 12 cost time: 5.145528554916382
Epoch: 12, Steps: 12 | Train Loss: 2.117 Vali Loss: 1.870 Vali Acc: 0.389 Test Loss: 1.870 Test Acc: 0.389
Validation loss decreased (-0.388869 --> -0.388870).  Saving model ...
Epoch: 13 cost time: 4.897008895874023
Epoch: 13, Steps: 12 | Train Loss: 1.993 Vali Loss: 1.798 Vali Acc: 0.389 Test Loss: 1.798 Test Acc: 0.389
Validation loss decreased (-0.388870 --> -0.388871).  Saving model ...
Epoch: 14 cost time: 6.122417211532593
Epoch: 14, Steps: 12 | Train Loss: 1.927 Vali Loss: 1.721 Vali Acc: 0.428 Test Loss: 1.721 Test Acc: 0.428
Validation loss decreased (-0.388871 --> -0.427761).  Saving model ...
Epoch: 15 cost time: 4.6721413135528564
Epoch: 15, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.621 Vali Acc: 0.439 Test Loss: 1.621 Test Acc: 0.439
Validation loss decreased (-0.427761 --> -0.438873).  Saving model ...
Epoch: 16 cost time: 5.710202693939209
Epoch: 16, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.512 Vali Acc: 0.494 Test Loss: 1.512 Test Acc: 0.494
Validation loss decreased (-0.438873 --> -0.494429).  Saving model ...
Epoch: 17 cost time: 4.370862722396851
Epoch: 17, Steps: 12 | Train Loss: 1.455 Vali Loss: 1.419 Vali Acc: 0.489 Test Loss: 1.419 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.0516815185546875
Epoch: 18, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.329 Vali Acc: 0.539 Test Loss: 1.329 Test Acc: 0.539
Validation loss decreased (-0.494429 --> -0.538876).  Saving model ...
Epoch: 19 cost time: 5.520582675933838
Epoch: 19, Steps: 12 | Train Loss: 1.177 Vali Loss: 1.245 Vali Acc: 0.561 Test Loss: 1.245 Test Acc: 0.561
Validation loss decreased (-0.538876 --> -0.561099).  Saving model ...
Epoch: 20 cost time: 5.591730117797852
Epoch: 20, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.144 Vali Acc: 0.628 Test Loss: 1.144 Test Acc: 0.628
Validation loss decreased (-0.561099 --> -0.627766).  Saving model ...
Epoch: 21 cost time: 5.413936376571655
Epoch: 21, Steps: 12 | Train Loss: 0.974 Vali Loss: 1.089 Vali Acc: 0.622 Test Loss: 1.089 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.293644905090332
Epoch: 22, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.019 Vali Acc: 0.667 Test Loss: 1.019 Test Acc: 0.667
Validation loss decreased (-0.627766 --> -0.666656).  Saving model ...
Epoch: 23 cost time: 5.13886570930481
Epoch: 23, Steps: 12 | Train Loss: 0.796 Vali Loss: 0.981 Vali Acc: 0.683 Test Loss: 0.981 Test Acc: 0.683
Validation loss decreased (-0.666656 --> -0.683324).  Saving model ...
Epoch: 24 cost time: 4.71518349647522
Epoch: 24, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.916 Vali Acc: 0.694 Test Loss: 0.916 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694435).  Saving model ...
Epoch: 25 cost time: 6.462939262390137
Epoch: 25, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.870 Vali Acc: 0.689 Test Loss: 0.870 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.129469633102417
Epoch: 26, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.818 Vali Acc: 0.728 Test Loss: 0.818 Test Acc: 0.728
Validation loss decreased (-0.694435 --> -0.727770).  Saving model ...
Epoch: 27 cost time: 5.867855548858643
Epoch: 27, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.775 Vali Acc: 0.728 Test Loss: 0.775 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 28 cost time: 6.188626766204834
Epoch: 28, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 5.6890869140625
Epoch: 29, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.694 Vali Acc: 0.756 Test Loss: 0.694 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 30 cost time: 5.944155693054199
Epoch: 30, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.659 Vali Acc: 0.767 Test Loss: 0.659 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766660).  Saving model ...
Epoch: 31 cost time: 5.3495073318481445
Epoch: 31, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
Validation loss decreased (-0.766660 --> -0.788883).  Saving model ...
Epoch: 32 cost time: 4.755246162414551
Epoch: 32, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.608 Vali Acc: 0.817 Test Loss: 0.608 Test Acc: 0.817
Validation loss decreased (-0.788883 --> -0.816661).  Saving model ...
Epoch: 33 cost time: 5.212383270263672
Epoch: 33, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.2674431800842285
Epoch: 34, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.559 Vali Acc: 0.833 Test Loss: 0.559 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 35 cost time: 5.527296304702759
Epoch: 35, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.043835163116455
Epoch: 36, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.966116428375244
Epoch: 37, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838884).  Saving model ...
Epoch: 38 cost time: 4.960271120071411
Epoch: 38, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.535 Vali Acc: 0.839 Test Loss: 0.535 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.569062948226929
Epoch: 39, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.838884 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 4.0917136669158936
Epoch: 40, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 4.316262245178223
Epoch: 41, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.510 Vali Acc: 0.839 Test Loss: 0.510 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.6194281578063965
Epoch: 42, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.522 Vali Acc: 0.839 Test Loss: 0.522 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.12503981590271
Epoch: 43, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 5.29283881187439
Epoch: 44, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.493 Vali Acc: 0.828 Test Loss: 0.493 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 4.992581844329834
Epoch: 45, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 46 cost time: 6.252657890319824
Epoch: 46, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 47 cost time: 6.035639762878418
Epoch: 47, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.490 Vali Acc: 0.856 Test Loss: 0.490 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 48 cost time: 5.867610216140747
Epoch: 48, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 49 cost time: 5.623182058334351
Epoch: 49, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.467 Vali Acc: 0.856 Test Loss: 0.467 Test Acc: 0.856
Validation loss decreased (-0.855551 --> -0.855551).  Saving model ...
Epoch: 50 cost time: 5.740910291671753
Epoch: 50, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 6.2772743701934814
Epoch: 51, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.487 Vali Acc: 0.861 Test Loss: 0.487 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861106).  Saving model ...
Epoch: 52 cost time: 5.434012413024902
Epoch: 52, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.481 Vali Acc: 0.856 Test Loss: 0.481 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.2573347091674805
Epoch: 53, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 54 cost time: 5.121026277542114
Epoch: 54, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.472 Vali Acc: 0.861 Test Loss: 0.472 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.592853784561157
Epoch: 55, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.469 Vali Acc: 0.878 Test Loss: 0.469 Test Acc: 0.878
Validation loss decreased (-0.866662 --> -0.877773).  Saving model ...
Epoch: 56 cost time: 5.06334376335144
Epoch: 56, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.6039581298828125
Epoch: 57, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.473 Vali Acc: 0.856 Test Loss: 0.473 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 5.539598703384399
Epoch: 58, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.477 Vali Acc: 0.872 Test Loss: 0.477 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 6.129895448684692
Epoch: 59, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.473 Vali Acc: 0.867 Test Loss: 0.473 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 5.363656520843506
Epoch: 60, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.465 Vali Acc: 0.839 Test Loss: 0.465 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 5.431832551956177
Epoch: 61, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 5.7430267333984375
Epoch: 62, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.473 Vali Acc: 0.878 Test Loss: 0.473 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 5.27712869644165
Epoch: 63, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 5.458629608154297
Epoch: 64, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.476 Vali Acc: 0.856 Test Loss: 0.476 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 5.306244373321533
Epoch: 65, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.489 Vali Acc: 0.867 Test Loss: 0.489 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 75599
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 8.127529382705688
Epoch: 1, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.782 Vali Acc: 0.083 Test Loss: 2.782 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 6.152474403381348
Epoch: 2, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.740 Vali Acc: 0.117 Test Loss: 2.740 Test Acc: 0.117
Validation loss decreased (-0.083306 --> -0.116639).  Saving model ...
Epoch: 3 cost time: 5.926110506057739
Epoch: 3, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.682 Vali Acc: 0.167 Test Loss: 2.682 Test Acc: 0.167
Validation loss decreased (-0.116639 --> -0.166640).  Saving model ...
Epoch: 4 cost time: 6.414661884307861
Epoch: 4, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.607 Vali Acc: 0.200 Test Loss: 2.607 Test Acc: 0.200
Validation loss decreased (-0.166640 --> -0.199974).  Saving model ...
Epoch: 5 cost time: 5.3150458335876465
Epoch: 5, Steps: 12 | Train Loss: 2.663 Vali Loss: 2.520 Vali Acc: 0.244 Test Loss: 2.520 Test Acc: 0.244
Validation loss decreased (-0.199974 --> -0.244419).  Saving model ...
Epoch: 6 cost time: 5.980726003646851
Epoch: 6, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.428 Vali Acc: 0.272 Test Loss: 2.428 Test Acc: 0.272
Validation loss decreased (-0.244419 --> -0.272198).  Saving model ...
Epoch: 7 cost time: 6.2538228034973145
Epoch: 7, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.326 Vali Acc: 0.317 Test Loss: 2.326 Test Acc: 0.317
Validation loss decreased (-0.272198 --> -0.316643).  Saving model ...
Epoch: 8 cost time: 5.887945175170898
Epoch: 8, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.221 Vali Acc: 0.389 Test Loss: 2.221 Test Acc: 0.389
Validation loss decreased (-0.316643 --> -0.388867).  Saving model ...
Epoch: 9 cost time: 6.080510854721069
Epoch: 9, Steps: 12 | Train Loss: 2.461 Vali Loss: 2.135 Vali Acc: 0.411 Test Loss: 2.135 Test Acc: 0.411
Validation loss decreased (-0.388867 --> -0.411090).  Saving model ...
Epoch: 10 cost time: 6.277401924133301
Epoch: 10, Steps: 12 | Train Loss: 2.378 Vali Loss: 2.050 Vali Acc: 0.406 Test Loss: 2.050 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.464218616485596
Epoch: 11, Steps: 12 | Train Loss: 2.272 Vali Loss: 1.980 Vali Acc: 0.367 Test Loss: 1.980 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.943749904632568
Epoch: 12, Steps: 12 | Train Loss: 2.185 Vali Loss: 1.911 Vali Acc: 0.394 Test Loss: 1.911 Test Acc: 0.394
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.488008499145508
Epoch: 13, Steps: 12 | Train Loss: 2.082 Vali Loss: 1.851 Vali Acc: 0.389 Test Loss: 1.851 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.1330506801605225
Epoch: 14, Steps: 12 | Train Loss: 1.976 Vali Loss: 1.777 Vali Acc: 0.417 Test Loss: 1.777 Test Acc: 0.417
Validation loss decreased (-0.411090 --> -0.416649).  Saving model ...
Epoch: 15 cost time: 5.884942293167114
Epoch: 15, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.678 Vali Acc: 0.439 Test Loss: 1.678 Test Acc: 0.439
Validation loss decreased (-0.416649 --> -0.438872).  Saving model ...
Epoch: 16 cost time: 5.847393274307251
Epoch: 16, Steps: 12 | Train Loss: 1.658 Vali Loss: 1.574 Vali Acc: 0.472 Test Loss: 1.574 Test Acc: 0.472
Validation loss decreased (-0.438872 --> -0.472206).  Saving model ...
Epoch: 17 cost time: 5.3167970180511475
Epoch: 17, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.478 Vali Acc: 0.528 Test Loss: 1.478 Test Acc: 0.528
Validation loss decreased (-0.472206 --> -0.527763).  Saving model ...
Epoch: 18 cost time: 5.46190881729126
Epoch: 18, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.378 Vali Acc: 0.561 Test Loss: 1.378 Test Acc: 0.561
Validation loss decreased (-0.527763 --> -0.561097).  Saving model ...
Epoch: 19 cost time: 4.931625843048096
Epoch: 19, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.289 Vali Acc: 0.611 Test Loss: 1.289 Test Acc: 0.611
Validation loss decreased (-0.561097 --> -0.611098).  Saving model ...
Epoch: 20 cost time: 5.204023361206055
Epoch: 20, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.197 Vali Acc: 0.661 Test Loss: 1.197 Test Acc: 0.661
Validation loss decreased (-0.611098 --> -0.661099).  Saving model ...
Epoch: 21 cost time: 5.207293510437012
Epoch: 21, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.769301176071167
Epoch: 22, Steps: 12 | Train Loss: 0.931 Vali Loss: 1.066 Vali Acc: 0.711 Test Loss: 1.066 Test Acc: 0.711
Validation loss decreased (-0.661099 --> -0.711100).  Saving model ...
Epoch: 23 cost time: 5.343778848648071
Epoch: 23, Steps: 12 | Train Loss: 0.864 Vali Loss: 1.034 Vali Acc: 0.683 Test Loss: 1.034 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.6656599044799805
Epoch: 24, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.967 Vali Acc: 0.700 Test Loss: 0.967 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.123897314071655
Epoch: 25, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.921 Vali Acc: 0.700 Test Loss: 0.921 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.962043523788452
Epoch: 26, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.871 Vali Acc: 0.706 Test Loss: 0.871 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.063588619232178
Epoch: 27, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.826 Vali Acc: 0.711 Test Loss: 0.826 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711103).  Saving model ...
Epoch: 28 cost time: 5.476657152175903
Epoch: 28, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.786 Vali Acc: 0.756 Test Loss: 0.786 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755548).  Saving model ...
Epoch: 29 cost time: 5.534026622772217
Epoch: 29, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.756 Vali Acc: 0.728 Test Loss: 0.756 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.8263819217681885
Epoch: 30, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.716 Vali Acc: 0.756 Test Loss: 0.716 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755548).  Saving model ...
Epoch: 31 cost time: 5.608367681503296
Epoch: 31, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.677 Vali Acc: 0.761 Test Loss: 0.677 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 32 cost time: 5.943098545074463
Epoch: 32, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783327).  Saving model ...
Epoch: 33 cost time: 5.190108776092529
Epoch: 33, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.624 Vali Acc: 0.794 Test Loss: 0.624 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 34 cost time: 5.905399799346924
Epoch: 34, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.597 Vali Acc: 0.817 Test Loss: 0.597 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816661).  Saving model ...
Epoch: 35 cost time: 5.186985015869141
Epoch: 35, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.592 Vali Acc: 0.817 Test Loss: 0.592 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816661).  Saving model ...
Epoch: 36 cost time: 6.370399475097656
Epoch: 36, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.563 Vali Acc: 0.806 Test Loss: 0.563 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.09650182723999
Epoch: 37, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.551 Vali Acc: 0.806 Test Loss: 0.551 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.002949476242065
Epoch: 38, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833328).  Saving model ...
Epoch: 39 cost time: 5.524092435836792
Epoch: 39, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 40 cost time: 6.006396055221558
Epoch: 40, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.532 Vali Acc: 0.839 Test Loss: 0.532 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.258604049682617
Epoch: 41, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 42 cost time: 5.877198696136475
Epoch: 42, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.531 Vali Acc: 0.839 Test Loss: 0.531 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.576749801635742
Epoch: 43, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.530 Vali Acc: 0.844 Test Loss: 0.530 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 44 cost time: 5.5097737312316895
Epoch: 44, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.517 Vali Acc: 0.839 Test Loss: 0.517 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 4.907862663269043
Epoch: 45, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.514 Vali Acc: 0.844 Test Loss: 0.514 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 46 cost time: 6.2567360401153564
Epoch: 46, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.844439 --> -0.849995).  Saving model ...
Epoch: 47 cost time: 5.658789873123169
Epoch: 47, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.509 Vali Acc: 0.856 Test Loss: 0.509 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855550).  Saving model ...
Epoch: 48 cost time: 5.189861297607422
Epoch: 48, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.501 Vali Acc: 0.828 Test Loss: 0.501 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.178374528884888
Epoch: 49, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.498 Vali Acc: 0.839 Test Loss: 0.498 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.381525754928589
Epoch: 50, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.57347559928894
Epoch: 51, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 5.551135540008545
Epoch: 52, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 5.55422043800354
Epoch: 53, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.501 Vali Acc: 0.861 Test Loss: 0.501 Test Acc: 0.861
Validation loss decreased (-0.855550 --> -0.861106).  Saving model ...
Epoch: 54 cost time: 5.233242511749268
Epoch: 54, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.489084720611572
Epoch: 55, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.501 Vali Acc: 0.856 Test Loss: 0.501 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 4.152063369750977
Epoch: 56, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.626403093338013
Epoch: 57, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.493 Vali Acc: 0.856 Test Loss: 0.493 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.088549613952637
Epoch: 58, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
Validation loss decreased (-0.861106 --> -0.866662).  Saving model ...
Epoch: 59 cost time: 5.1395111083984375
Epoch: 59, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.488 Vali Acc: 0.844 Test Loss: 0.488 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.012677431106567
Epoch: 60, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.486 Vali Acc: 0.844 Test Loss: 0.486 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.413828372955322
Epoch: 61, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 62 cost time: 4.855375289916992
Epoch: 62, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.102529048919678
Epoch: 63, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.496 Vali Acc: 0.861 Test Loss: 0.496 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 5.14856481552124
Epoch: 64, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 5.471374750137329
Epoch: 65, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.503 Vali Acc: 0.856 Test Loss: 0.503 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 4.823651552200317
Epoch: 66, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.501 Vali Acc: 0.861 Test Loss: 0.501 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 5.758897304534912
Epoch: 67, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.502 Vali Acc: 0.856 Test Loss: 0.502 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 5.674194812774658
Epoch: 68, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 5.184623718261719
Epoch: 69, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 5.475458860397339
Epoch: 70, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 4.81247353553772
Epoch: 71, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.524 Vali Acc: 0.856 Test Loss: 0.524 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 75599
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
 fourier enhanced cross attention used!
modes_q=11, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
modes_kv=22, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>>>>>>start training : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 7.525551080703735
Epoch: 1, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 5.165987968444824
Epoch: 2, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 4.8421642780303955
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.853612661361694
Epoch: 4, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 5.548996686935425
Epoch: 5, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.164866924285889
Epoch: 6, Steps: 12 | Train Loss: 2.707 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 7 cost time: 5.288706064224243
Epoch: 7, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 8 cost time: 6.008847951889038
Epoch: 8, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 9 cost time: 5.676333665847778
Epoch: 9, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.923717498779297
Epoch: 10, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.167975902557373
Epoch: 11, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 12 cost time: 5.680925607681274
Epoch: 12, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 13 cost time: 5.338905334472656
Epoch: 13, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 14 cost time: 5.5776708126068115
Epoch: 14, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.873225927352905
Epoch: 15, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.710 Vali Acc: 0.067 Test Loss: 2.710 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.287010908126831
Epoch: 16, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.1457459926605225
Epoch: 17, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 18 cost time: 5.067409515380859
Epoch: 18, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 19 cost time: 5.751520156860352
Epoch: 19, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 20 cost time: 5.763795852661133
Epoch: 20, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 21 cost time: 5.2035040855407715
Epoch: 21, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 22 cost time: 5.292518377304077
Epoch: 22, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.5908896923065186
Epoch: 23, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.391165018081665
Epoch: 24, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.4298624992370605
Epoch: 25, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.999438762664795
Epoch: 26, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.594188690185547
Epoch: 27, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.314246892929077
Epoch: 28, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.567765235900879
Epoch: 29, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.809941053390503
Epoch: 30, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.371973991394043
Epoch: 31, Steps: 12 | Train Loss: 2.709 Vali Loss: 2.709 Vali Acc: 0.067 Test Loss: 2.709 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_FEDformer_UEA_ftM_sl45_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.06666666666666667
model parameter : 75599
model size : 1.53MB
