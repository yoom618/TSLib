Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.710691213607788
Epoch: 1, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.401 Vali Acc: 0.300 Test Loss: 1.401 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.3984296321868896
Epoch: 2, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.299986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.3896918296813965
Epoch: 3, Steps: 3 | Train Loss: 0.992 Vali Loss: 0.955 Vali Acc: 0.725 Test Loss: 0.955 Test Acc: 0.725
Validation loss decreased (-0.499987 --> -0.724990).  Saving model ...
Epoch: 4 cost time: 1.5167784690856934
Epoch: 4, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.649 Vali Acc: 0.850 Test Loss: 0.649 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 1.4072411060333252
Epoch: 5, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899996).  Saving model ...
Epoch: 6 cost time: 1.4524121284484863
Epoch: 6, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 7 cost time: 1.4791927337646484
Epoch: 7, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 8 cost time: 1.339339256286621
Epoch: 8, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4770143032073975
Epoch: 9, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.395808458328247
Epoch: 10, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.249864101409912
Epoch: 11, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.143319845199585
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.875 Test Loss: 0.336 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3686656951904297
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5525598526000977
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4833159446716309
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2479779720306396
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.875 Test Loss: 0.345 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3617122173309326
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.088050127029419
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.369 Vali Acc: 0.450 Test Loss: 1.369 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 1.6643319129943848
Epoch: 2, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.2192714214324951
Epoch: 3, Steps: 3 | Train Loss: 0.981 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
Validation loss decreased (-0.499988 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.455221176147461
Epoch: 4, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 1.3168666362762451
Epoch: 5, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874996).  Saving model ...
Epoch: 6 cost time: 1.5102624893188477
Epoch: 6, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 1.297882080078125
Epoch: 7, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 8 cost time: 1.5367612838745117
Epoch: 8, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4376699924468994
Epoch: 9, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3284587860107422
Epoch: 10, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.452474594116211
Epoch: 11, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.437525987625122
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4622821807861328
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3194429874420166
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.352567434310913
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2894573211669922
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3363142013549805
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9528658390045166
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.3273653984069824
Epoch: 2, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.190 Vali Acc: 0.550 Test Loss: 1.190 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 1.4081354141235352
Epoch: 3, Steps: 3 | Train Loss: 0.950 Vali Loss: 0.885 Vali Acc: 0.800 Test Loss: 0.885 Test Acc: 0.800
Validation loss decreased (-0.549988 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 1.4487133026123047
Epoch: 4, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 1.4225056171417236
Epoch: 5, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.447 Vali Acc: 0.950 Test Loss: 0.447 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949996).  Saving model ...
Epoch: 6 cost time: 1.3915753364562988
Epoch: 6, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2796239852905273
Epoch: 7, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 1.3773987293243408
Epoch: 8, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4124736785888672
Epoch: 9, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2899017333984375
Epoch: 10, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1690425872802734
Epoch: 11, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.950 Test Loss: 0.443 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.335946798324585
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.352306842803955
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2928316593170166
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.925 Test Loss: 0.484 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.239952564239502
Epoch: 15, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.256148338317871
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5364923477172852
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.142538547515869
Epoch: 1, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.402 Vali Acc: 0.175 Test Loss: 1.402 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.4153552055358887
Epoch: 2, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.241 Vali Acc: 0.475 Test Loss: 1.241 Test Acc: 0.475
Validation loss decreased (-0.174986 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 1.4960286617279053
Epoch: 3, Steps: 3 | Train Loss: 0.982 Vali Loss: 0.944 Vali Acc: 0.725 Test Loss: 0.944 Test Acc: 0.725
Validation loss decreased (-0.474988 --> -0.724991).  Saving model ...
Epoch: 4 cost time: 1.585515022277832
Epoch: 4, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.4052979946136475
Epoch: 5, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.749993 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.5024385452270508
Epoch: 6, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 1.3265888690948486
Epoch: 7, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2408905029296875
Epoch: 8, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3326807022094727
Epoch: 9, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.825 Test Loss: 0.450 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.297283411026001
Epoch: 10, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.800 Test Loss: 0.477 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.524076223373413
Epoch: 11, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.800 Test Loss: 0.498 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.432349443435669
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.800 Test Loss: 0.513 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2694971561431885
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2803497314453125
Epoch: 14, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.800 Test Loss: 0.529 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.366211175918579
Epoch: 15, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3324377536773682
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.800 Test Loss: 0.537 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3336355686187744
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.375 Vali Acc: 0.300 Test Loss: 1.375 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.1985034942626953
Epoch: 2, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.226 Vali Acc: 0.525 Test Loss: 1.226 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 1.4775757789611816
Epoch: 3, Steps: 3 | Train Loss: 0.983 Vali Loss: 0.958 Vali Acc: 0.750 Test Loss: 0.958 Test Acc: 0.750
Validation loss decreased (-0.524988 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 1.390514612197876
Epoch: 4, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.283456563949585
Epoch: 5, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 6 cost time: 1.3385543823242188
Epoch: 6, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 1.246927261352539
Epoch: 7, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.273897409439087
Epoch: 8, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.529 Vali Acc: 0.850 Test Loss: 0.529 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1621098518371582
Epoch: 9, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0889043807983398
Epoch: 10, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3516392707824707
Epoch: 11, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.635 Vali Acc: 0.825 Test Loss: 0.635 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4387786388397217
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.674 Vali Acc: 0.825 Test Loss: 0.674 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2948668003082275
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3163464069366455
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.263674259185791
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2589542865753174
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0587174892425537
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.427 Vali Acc: 0.325 Test Loss: 1.427 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.3763141632080078
Epoch: 2, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.379 Vali Acc: 0.450 Test Loss: 1.379 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.2718045711517334
Epoch: 3, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.3112523555755615
Epoch: 4, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.171 Vali Acc: 0.575 Test Loss: 1.171 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.363218069076538
Epoch: 5, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.3617546558380127
Epoch: 6, Steps: 3 | Train Loss: 0.388 Vali Loss: 1.000 Vali Acc: 0.675 Test Loss: 1.000 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 1.1757946014404297
Epoch: 7, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.992 Vali Acc: 0.650 Test Loss: 0.992 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4064345359802246
Epoch: 8, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.975 Vali Acc: 0.625 Test Loss: 0.975 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2848303318023682
Epoch: 9, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.949 Vali Acc: 0.650 Test Loss: 0.949 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3132619857788086
Epoch: 10, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.962 Vali Acc: 0.650 Test Loss: 0.962 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4111557006835938
Epoch: 11, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.972 Vali Acc: 0.650 Test Loss: 0.972 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4425008296966553
Epoch: 12, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.964 Vali Acc: 0.650 Test Loss: 0.964 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4831514358520508
Epoch: 13, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.945 Vali Acc: 0.675 Test Loss: 0.945 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 14 cost time: 1.418290138244629
Epoch: 14, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.928 Vali Acc: 0.675 Test Loss: 0.928 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 15 cost time: 1.2606322765350342
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.5146665573120117
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.920 Vali Acc: 0.725 Test Loss: 0.920 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 1.4397869110107422
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 1.3032381534576416
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.725 Test Loss: 0.921 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3024516105651855
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.923 Vali Acc: 0.725 Test Loss: 0.923 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3156166076660156
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.725 Test Loss: 0.927 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3630421161651611
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.725 Test Loss: 0.930 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5384876728057861
Epoch: 22, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3631134033203125
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.377324104309082
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.467085599899292
Epoch: 25, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.725 Test Loss: 0.942 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3956565856933594
Epoch: 26, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.725 Test Loss: 0.947 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3099009990692139
Epoch: 27, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1202900409698486
Epoch: 1, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.4227573871612549
Epoch: 2, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.355 Vali Acc: 0.250 Test Loss: 1.355 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4859530925750732
Epoch: 3, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.298 Vali Acc: 0.325 Test Loss: 1.298 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 1.5571739673614502
Epoch: 4, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.250 Vali Acc: 0.375 Test Loss: 1.250 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 1.4060311317443848
Epoch: 5, Steps: 3 | Train Loss: 0.734 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.4923267364501953
Epoch: 6, Steps: 3 | Train Loss: 0.480 Vali Loss: 1.114 Vali Acc: 0.425 Test Loss: 1.114 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424989).  Saving model ...
Epoch: 7 cost time: 1.3981211185455322
Epoch: 7, Steps: 3 | Train Loss: 0.381 Vali Loss: 1.086 Vali Acc: 0.475 Test Loss: 1.086 Test Acc: 0.475
Validation loss decreased (-0.424989 --> -0.474989).  Saving model ...
Epoch: 8 cost time: 1.4026083946228027
Epoch: 8, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.3170630931854248
Epoch: 9, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1663899421691895
Epoch: 10, Steps: 3 | Train Loss: 0.095 Vali Loss: 1.124 Vali Acc: 0.525 Test Loss: 1.124 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 11 cost time: 1.299185037612915
Epoch: 11, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.259 Vali Acc: 0.475 Test Loss: 1.259 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2431957721710205
Epoch: 12, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.308 Vali Acc: 0.450 Test Loss: 1.308 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2469561100006104
Epoch: 13, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.265 Vali Acc: 0.525 Test Loss: 1.265 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.528918981552124
Epoch: 14, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5257606506347656
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.184 Vali Acc: 0.525 Test Loss: 1.184 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4019520282745361
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.208 Vali Acc: 0.550 Test Loss: 1.208 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549988).  Saving model ...
Epoch: 17 cost time: 1.3885488510131836
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.248 Vali Acc: 0.550 Test Loss: 1.248 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2468452453613281
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.525 Test Loss: 1.291 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5320539474487305
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.332 Vali Acc: 0.550 Test Loss: 1.332 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5937917232513428
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.525 Test Loss: 1.371 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4385137557983398
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.525 Test Loss: 1.402 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5128140449523926
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.525 Test Loss: 1.416 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3310375213623047
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.550 Test Loss: 1.415 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.355987787246704
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.550 Test Loss: 1.397 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4459595680236816
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.575 Test Loss: 1.371 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574986).  Saving model ...
Epoch: 26 cost time: 1.5186066627502441
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.625 Test Loss: 1.343 Test Acc: 0.625
Validation loss decreased (-0.574986 --> -0.624987).  Saving model ...
Epoch: 27 cost time: 1.432419776916504
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.625 Test Loss: 1.317 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 28 cost time: 1.318873405456543
Epoch: 28, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.625 Test Loss: 1.297 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 29 cost time: 1.4907608032226562
Epoch: 29, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.286 Vali Acc: 0.625 Test Loss: 1.286 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 30 cost time: 1.638334035873413
Epoch: 30, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.625 Test Loss: 1.281 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 31 cost time: 1.4219622611999512
Epoch: 31, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.625 Test Loss: 1.279 Test Acc: 0.625
Validation loss decreased (-0.624987 --> -0.624987).  Saving model ...
Epoch: 32 cost time: 1.5946221351623535
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.625 Test Loss: 1.281 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4981296062469482
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.287 Vali Acc: 0.625 Test Loss: 1.287 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5949394702911377
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.625 Test Loss: 1.292 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4152750968933105
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.625 Test Loss: 1.295 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4774577617645264
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.625 Test Loss: 1.301 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.378678798675537
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.625 Test Loss: 1.308 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3624184131622314
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.625 Test Loss: 1.311 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4850940704345703
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.625 Test Loss: 1.312 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.38411283493042
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.625 Test Loss: 1.312 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.5050292015075684
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.625 Test Loss: 1.314 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9496617317199707
Epoch: 1, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.295 Vali Acc: 0.300 Test Loss: 1.295 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 1.379131555557251
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.260 Vali Acc: 0.425 Test Loss: 1.260 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.3109264373779297
Epoch: 3, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.195 Vali Acc: 0.375 Test Loss: 1.195 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4054739475250244
Epoch: 4, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.134 Vali Acc: 0.525 Test Loss: 1.134 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 1.3945446014404297
Epoch: 5, Steps: 3 | Train Loss: 0.772 Vali Loss: 1.052 Vali Acc: 0.575 Test Loss: 1.052 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 1.2330431938171387
Epoch: 6, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.972 Vali Acc: 0.575 Test Loss: 0.972 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 7 cost time: 1.5362212657928467
Epoch: 7, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.967 Vali Acc: 0.575 Test Loss: 0.967 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 8 cost time: 1.5103919506072998
Epoch: 8, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.953 Vali Acc: 0.550 Test Loss: 0.953 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4316883087158203
Epoch: 9, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.935 Vali Acc: 0.575 Test Loss: 0.935 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574991).  Saving model ...
Epoch: 10 cost time: 1.3411240577697754
Epoch: 10, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.934 Vali Acc: 0.550 Test Loss: 0.934 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.327272891998291
Epoch: 11, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.967 Vali Acc: 0.550 Test Loss: 0.967 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.412255048751831
Epoch: 12, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.010 Vali Acc: 0.550 Test Loss: 1.010 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.406489610671997
Epoch: 13, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.024 Vali Acc: 0.550 Test Loss: 1.024 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.324040174484253
Epoch: 14, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.987 Vali Acc: 0.575 Test Loss: 0.987 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2817180156707764
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.968 Vali Acc: 0.575 Test Loss: 0.968 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3942441940307617
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.964 Vali Acc: 0.575 Test Loss: 0.964 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3207662105560303
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.975 Vali Acc: 0.625 Test Loss: 0.975 Test Acc: 0.625
Validation loss decreased (-0.574991 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 1.30741286277771
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4775171279907227
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3250246047973633
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.287125825881958
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4842877388000488
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4480490684509277
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.575 Test Loss: 1.105 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3442461490631104
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4123375415802002
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.625 Test Loss: 1.105 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6394760608673096
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.098 Vali Acc: 0.625 Test Loss: 1.098 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3277795314788818
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.647695779800415
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3082289695739746
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.1916582584381104
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.377241849899292
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3926217555999756
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.5834858417510986
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.3913094997406006
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.5753982067108154
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.4495306015014648
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.3606829643249512
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3433635234832764
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3476040363311768
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4554665088653564
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3634350299835205
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2917959690093994
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4901463985443115
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3650696277618408
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.383974552154541
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3148643970489502
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 16098820
model size : 80.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.099252462387085
Epoch: 1, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.320 Vali Acc: 0.450 Test Loss: 1.320 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.3085179328918457
Epoch: 2, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.181 Vali Acc: 0.550 Test Loss: 1.181 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 1.406506061553955
Epoch: 3, Steps: 3 | Train Loss: 0.864 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.549988 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.260148525238037
Epoch: 4, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.671 Vali Acc: 0.800 Test Loss: 0.671 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.3160934448242188
Epoch: 5, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.2912962436676025
Epoch: 6, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.303530216217041
Epoch: 7, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 8 cost time: 1.4037327766418457
Epoch: 8, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 1.3660554885864258
Epoch: 9, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3622257709503174
Epoch: 10, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5053279399871826
Epoch: 11, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 12 cost time: 1.4835841655731201
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 1.4387061595916748
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 1.456136703491211
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 1.469597339630127
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 1.4278557300567627
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3830056190490723
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3660485744476318
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3247795104980469
Epoch: 19, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3867113590240479
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4162766933441162
Epoch: 21, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6359357833862305
Epoch: 22, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6375019550323486
Epoch: 23, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4692742824554443
Epoch: 24, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.491375207901001
Epoch: 25, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.110490083694458
Epoch: 1, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.585439920425415
Epoch: 2, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.170 Vali Acc: 0.550 Test Loss: 1.170 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 1.461549997329712
Epoch: 3, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
Validation loss decreased (-0.549988 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 1.386469841003418
Epoch: 4, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 1.3553318977355957
Epoch: 5, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.492 Vali Acc: 0.950 Test Loss: 0.492 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 1.3443145751953125
Epoch: 6, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.492652416229248
Epoch: 7, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.360994815826416
Epoch: 8, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3793203830718994
Epoch: 9, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4166884422302246
Epoch: 10, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3778913021087646
Epoch: 11, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2921583652496338
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4642071723937988
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4474296569824219
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4149396419525146
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.068711042404175
Epoch: 1, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.4707705974578857
Epoch: 2, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.399986 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 1.501345157623291
Epoch: 3, Steps: 3 | Train Loss: 0.901 Vali Loss: 0.916 Vali Acc: 0.800 Test Loss: 0.916 Test Acc: 0.800
Validation loss decreased (-0.549988 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 1.240262508392334
Epoch: 4, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.682 Vali Acc: 0.875 Test Loss: 0.682 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 1.4742028713226318
Epoch: 5, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.3864164352416992
Epoch: 6, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 1.3107969760894775
Epoch: 7, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.196342945098877
Epoch: 8, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 1.275536060333252
Epoch: 9, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2785725593566895
Epoch: 10, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3020617961883545
Epoch: 11, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.925 Test Loss: 0.453 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.5356018543243408
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3368945121765137
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.384333848953247
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4923768043518066
Epoch: 15, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.431161642074585
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4214403629302979
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4531605243682861
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 1.3159759044647217
Epoch: 19, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.950 Test Loss: 0.495 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2673394680023193
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3190906047821045
Epoch: 21, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.19618821144104
Epoch: 22, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4475252628326416
Epoch: 23, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5031652450561523
Epoch: 24, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4204216003417969
Epoch: 25, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4655776023864746
Epoch: 26, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5279388427734375
Epoch: 27, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.484429121017456
Epoch: 28, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1210885047912598
Epoch: 1, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.333 Vali Acc: 0.525 Test Loss: 1.333 Test Acc: 0.525
Validation loss decreased (inf --> -0.524987).  Saving model ...
Epoch: 2 cost time: 1.3855247497558594
Epoch: 2, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.181 Vali Acc: 0.550 Test Loss: 1.181 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 1.5394272804260254
Epoch: 3, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.903 Vali Acc: 0.675 Test Loss: 0.903 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674991).  Saving model ...
Epoch: 4 cost time: 1.3633618354797363
Epoch: 4, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.3302016258239746
Epoch: 5, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799994).  Saving model ...
Epoch: 6 cost time: 1.357785701751709
Epoch: 6, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3869781494140625
Epoch: 7, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 1.423388957977295
Epoch: 8, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.546 Vali Acc: 0.800 Test Loss: 0.546 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 9 cost time: 1.3044402599334717
Epoch: 9, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.775 Test Loss: 0.548 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4595139026641846
Epoch: 10, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.775 Test Loss: 0.565 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2913198471069336
Epoch: 11, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.775 Test Loss: 0.576 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2610054016113281
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2509093284606934
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3282113075256348
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3649070262908936
Epoch: 15, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3559937477111816
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.800 Test Loss: 0.591 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3493413925170898
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3410134315490723
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.813065767288208
Epoch: 1, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.467454195022583
Epoch: 2, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.218 Vali Acc: 0.575 Test Loss: 1.218 Test Acc: 0.575
Validation loss decreased (-0.349987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 1.3809947967529297
Epoch: 3, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.966 Vali Acc: 0.700 Test Loss: 0.966 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.4521441459655762
Epoch: 4, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.770 Vali Acc: 0.700 Test Loss: 0.770 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699992).  Saving model ...
Epoch: 5 cost time: 1.3907806873321533
Epoch: 5, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.623 Vali Acc: 0.775 Test Loss: 0.623 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774994).  Saving model ...
Epoch: 6 cost time: 1.2122817039489746
Epoch: 6, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 7 cost time: 1.3045518398284912
Epoch: 7, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2447991371154785
Epoch: 8, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.651 Vali Acc: 0.725 Test Loss: 0.651 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4884440898895264
Epoch: 9, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.658 Vali Acc: 0.725 Test Loss: 0.658 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2980141639709473
Epoch: 10, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4576811790466309
Epoch: 11, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.543973684310913
Epoch: 12, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4179730415344238
Epoch: 13, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4287779331207275
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3838717937469482
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.292689561843872
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.209156036376953
Epoch: 1, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.375 Vali Acc: 0.375 Test Loss: 1.375 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.5561432838439941
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.341 Vali Acc: 0.475 Test Loss: 1.341 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.3963031768798828
Epoch: 3, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 1.500767707824707
Epoch: 4, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.146 Vali Acc: 0.525 Test Loss: 1.146 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 5 cost time: 1.3744075298309326
Epoch: 5, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.071 Vali Acc: 0.525 Test Loss: 1.071 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 1.3579139709472656
Epoch: 6, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.025 Vali Acc: 0.550 Test Loss: 1.025 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549990).  Saving model ...
Epoch: 7 cost time: 1.4977247714996338
Epoch: 7, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.007 Vali Acc: 0.625 Test Loss: 1.007 Test Acc: 0.625
Validation loss decreased (-0.549990 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 1.396615982055664
Epoch: 8, Steps: 3 | Train Loss: 0.171 Vali Loss: 1.008 Vali Acc: 0.625 Test Loss: 1.008 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.308748483657837
Epoch: 9, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.965 Vali Acc: 0.625 Test Loss: 0.965 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 1.3709867000579834
Epoch: 10, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.371412992477417
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.933 Vali Acc: 0.650 Test Loss: 0.933 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 1.3776164054870605
Epoch: 12, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.879 Vali Acc: 0.700 Test Loss: 0.879 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 1.3839671611785889
Epoch: 13, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.875 Vali Acc: 0.700 Test Loss: 0.875 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 1.2902405261993408
Epoch: 14, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.889 Vali Acc: 0.725 Test Loss: 0.889 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.2351148128509521
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.913 Vali Acc: 0.725 Test Loss: 0.913 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4308521747589111
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.725 Test Loss: 0.939 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2971704006195068
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.725 Test Loss: 0.965 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2148714065551758
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.984 Vali Acc: 0.725 Test Loss: 0.984 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3741135597229004
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3116087913513184
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4172117710113525
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.725 Test Loss: 1.012 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2811698913574219
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.725 Test Loss: 1.014 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.315995454788208
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3074522018432617
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2609286308288574
Epoch: 1, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.5843946933746338
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.429 Vali Acc: 0.225 Test Loss: 1.429 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6461999416351318
Epoch: 3, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.356 Vali Acc: 0.325 Test Loss: 1.356 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.444955825805664
Epoch: 4, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.545687198638916
Epoch: 5, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.230 Vali Acc: 0.350 Test Loss: 1.230 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.393329381942749
Epoch: 6, Steps: 3 | Train Loss: 0.643 Vali Loss: 1.237 Vali Acc: 0.350 Test Loss: 1.237 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5759804248809814
Epoch: 7, Steps: 3 | Train Loss: 0.377 Vali Loss: 1.235 Vali Acc: 0.450 Test Loss: 1.235 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 1.4904043674468994
Epoch: 8, Steps: 3 | Train Loss: 0.257 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6400120258331299
Epoch: 9, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.238 Vali Acc: 0.425 Test Loss: 1.238 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.634873390197754
Epoch: 10, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4592068195343018
Epoch: 11, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.2991843223571777
Epoch: 12, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 1.7098591327667236
Epoch: 13, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.251 Vali Acc: 0.575 Test Loss: 1.251 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5115690231323242
Epoch: 14, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.334 Vali Acc: 0.525 Test Loss: 1.334 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3911206722259521
Epoch: 15, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.368 Vali Acc: 0.525 Test Loss: 1.368 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3957738876342773
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.329 Vali Acc: 0.575 Test Loss: 1.329 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5418059825897217
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.298 Vali Acc: 0.575 Test Loss: 1.298 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4180324077606201
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.280 Vali Acc: 0.600 Test Loss: 1.280 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4355120658874512
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.270 Vali Acc: 0.600 Test Loss: 1.270 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5871238708496094
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.265 Vali Acc: 0.600 Test Loss: 1.265 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5170700550079346
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.257 Vali Acc: 0.625 Test Loss: 1.257 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624987).  Saving model ...
Epoch: 22 cost time: 1.3552064895629883
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.265 Vali Acc: 0.625 Test Loss: 1.265 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2450275421142578
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.650 Test Loss: 1.278 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 24 cost time: 1.4069621562957764
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.285 Vali Acc: 0.650 Test Loss: 1.285 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3583424091339111
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.285 Vali Acc: 0.675 Test Loss: 1.285 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674987).  Saving model ...
Epoch: 26 cost time: 1.3417227268218994
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.675 Test Loss: 1.292 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3226819038391113
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.295 Vali Acc: 0.675 Test Loss: 1.295 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3507568836212158
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.650 Test Loss: 1.296 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4216182231903076
Epoch: 29, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.650 Test Loss: 1.298 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5943331718444824
Epoch: 30, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.650 Test Loss: 1.301 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5749461650848389
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.304 Vali Acc: 0.650 Test Loss: 1.304 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.622438669204712
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.650 Test Loss: 1.304 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4437859058380127
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.650 Test Loss: 1.309 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2099032402038574
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.317 Vali Acc: 0.650 Test Loss: 1.317 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4273085594177246
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.313 Vali Acc: 0.650 Test Loss: 1.313 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.995988130569458
Epoch: 1, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 1.3376543521881104
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.329 Vali Acc: 0.325 Test Loss: 1.329 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 1.1902177333831787
Epoch: 3, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.3285863399505615
Epoch: 4, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.221 Vali Acc: 0.475 Test Loss: 1.221 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 1.2848668098449707
Epoch: 5, Steps: 3 | Train Loss: 0.719 Vali Loss: 1.150 Vali Acc: 0.525 Test Loss: 1.150 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 1.4873569011688232
Epoch: 6, Steps: 3 | Train Loss: 0.558 Vali Loss: 1.122 Vali Acc: 0.475 Test Loss: 1.122 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3274426460266113
Epoch: 7, Steps: 3 | Train Loss: 0.355 Vali Loss: 1.112 Vali Acc: 0.475 Test Loss: 1.112 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3211088180541992
Epoch: 8, Steps: 3 | Train Loss: 0.291 Vali Loss: 1.085 Vali Acc: 0.550 Test Loss: 1.085 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 1.221724033355713
Epoch: 9, Steps: 3 | Train Loss: 0.196 Vali Loss: 1.026 Vali Acc: 0.600 Test Loss: 1.026 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 1.2320225238800049
Epoch: 10, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.053 Vali Acc: 0.550 Test Loss: 1.053 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3055334091186523
Epoch: 11, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.036 Vali Acc: 0.525 Test Loss: 1.036 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3606746196746826
Epoch: 12, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.959 Vali Acc: 0.575 Test Loss: 0.959 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4846220016479492
Epoch: 13, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.952 Vali Acc: 0.675 Test Loss: 0.952 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 1.4047596454620361
Epoch: 14, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.976 Vali Acc: 0.675 Test Loss: 0.976 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2356295585632324
Epoch: 15, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.26533842086792
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699989).  Saving model ...
Epoch: 17 cost time: 1.3894822597503662
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.077 Vali Acc: 0.675 Test Loss: 1.077 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3520610332489014
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3400325775146484
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2814691066741943
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.116 Vali Acc: 0.700 Test Loss: 1.116 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2908456325531006
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.111 Vali Acc: 0.725 Test Loss: 1.111 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 22 cost time: 1.4484069347381592
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.725 Test Loss: 1.109 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 23 cost time: 1.466036319732666
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.725 Test Loss: 1.107 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 24 cost time: 1.3801708221435547
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.725 Test Loss: 1.105 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 25 cost time: 1.3446941375732422
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.725 Test Loss: 1.101 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 26 cost time: 1.346601963043213
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.725 Test Loss: 1.099 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 27 cost time: 1.3241138458251953
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.725 Test Loss: 1.100 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2438855171203613
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.725 Test Loss: 1.102 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.382284164428711
Epoch: 29, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.700 Test Loss: 1.105 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5223352909088135
Epoch: 30, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3133785724639893
Epoch: 31, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3061351776123047
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4111483097076416
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.700 Test Loss: 1.108 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2995431423187256
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3078322410583496
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.4027490615844727
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.757981061935425
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.4366943836212158
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3318653106689453
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1787784099578857
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1617414951324463
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2028019428253174
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2174768447875977
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1808605194091797
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3189337253570557
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2600409984588623
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3184175491333008
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 12953092
model size : 68.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9856295585632324
Epoch: 1, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.4502191543579102
Epoch: 2, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.140 Vali Acc: 0.550 Test Loss: 1.140 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 1.4679510593414307
Epoch: 3, Steps: 3 | Train Loss: 0.906 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
Validation loss decreased (-0.549989 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.7079851627349854
Epoch: 4, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824994).  Saving model ...
Epoch: 5 cost time: 1.4877641201019287
Epoch: 5, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
Validation loss decreased (-0.824994 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 1.5036540031433105
Epoch: 6, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 1.3959403038024902
Epoch: 7, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 1.3908329010009766
Epoch: 8, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 9 cost time: 1.44429612159729
Epoch: 9, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 10 cost time: 1.6028590202331543
Epoch: 10, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 11 cost time: 1.5581028461456299
Epoch: 11, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 12 cost time: 1.5484564304351807
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3361444473266602
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3148906230926514
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3170125484466553
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2471609115600586
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2027747631072998
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3965630531311035
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.355006217956543
Epoch: 19, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3024053573608398
Epoch: 20, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4274320602416992
Epoch: 21, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.592355251312256
Epoch: 1, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.3158783912658691
Epoch: 2, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.146 Vali Acc: 0.550 Test Loss: 1.146 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549989).  Saving model ...
Epoch: 3 cost time: 1.3474242687225342
Epoch: 3, Steps: 3 | Train Loss: 0.883 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
Validation loss decreased (-0.549989 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.4379856586456299
Epoch: 4, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.652 Vali Acc: 0.800 Test Loss: 0.652 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.3314247131347656
Epoch: 5, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.329946517944336
Epoch: 6, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.849995 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 1.4681153297424316
Epoch: 7, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3087525367736816
Epoch: 8, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4387543201446533
Epoch: 9, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4759774208068848
Epoch: 10, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.362647294998169
Epoch: 11, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4292776584625244
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.271669864654541
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3669452667236328
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.445204734802246
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.523289680480957
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5374081134796143
Epoch: 1, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.305 Vali Acc: 0.425 Test Loss: 1.305 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.2935192584991455
Epoch: 2, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.4961752891540527
Epoch: 3, Steps: 3 | Train Loss: 0.907 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.499988 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.284881353378296
Epoch: 4, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 5 cost time: 1.2248601913452148
Epoch: 5, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
Validation loss decreased (-0.799993 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.3688633441925049
Epoch: 6, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 1.3099784851074219
Epoch: 7, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 1.489288091659546
Epoch: 8, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.471 Vali Acc: 0.875 Test Loss: 0.471 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5416433811187744
Epoch: 9, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4385857582092285
Epoch: 10, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3952343463897705
Epoch: 11, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6406874656677246
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4182116985321045
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4657139778137207
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.506479263305664
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5198659896850586
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.900 Test Loss: 0.560 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4139518737792969
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.900 Test Loss: 0.564 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0442698001861572
Epoch: 1, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.277 Vali Acc: 0.425 Test Loss: 1.277 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.5928137302398682
Epoch: 2, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.134 Vali Acc: 0.525 Test Loss: 1.134 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524989).  Saving model ...
Epoch: 3 cost time: 1.4766278266906738
Epoch: 3, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
Validation loss decreased (-0.524989 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 1.5104265213012695
Epoch: 4, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.715 Vali Acc: 0.725 Test Loss: 0.715 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724993).  Saving model ...
Epoch: 5 cost time: 1.5861918926239014
Epoch: 5, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (-0.724993 --> -0.799994).  Saving model ...
Epoch: 6 cost time: 1.5624041557312012
Epoch: 6, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.530 Vali Acc: 0.800 Test Loss: 0.530 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 7 cost time: 1.2364447116851807
Epoch: 7, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.528 Vali Acc: 0.800 Test Loss: 0.528 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 1.2991275787353516
Epoch: 8, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 1.3139257431030273
Epoch: 9, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3348524570465088
Epoch: 10, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3327057361602783
Epoch: 11, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.800 Test Loss: 0.544 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3102240562438965
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.800 Test Loss: 0.548 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2720990180969238
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.800 Test Loss: 0.550 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2801783084869385
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4166948795318604
Epoch: 15, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3741309642791748
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3382470607757568
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3695836067199707
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.800 Test Loss: 0.565 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.692776679992676
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.2591521739959717
Epoch: 2, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.218 Vali Acc: 0.475 Test Loss: 1.218 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 1.1776127815246582
Epoch: 3, Steps: 3 | Train Loss: 0.962 Vali Loss: 0.979 Vali Acc: 0.650 Test Loss: 0.979 Test Acc: 0.650
Validation loss decreased (-0.474988 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 1.4399724006652832
Epoch: 4, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.789 Vali Acc: 0.725 Test Loss: 0.789 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724992).  Saving model ...
Epoch: 5 cost time: 1.3886375427246094
Epoch: 5, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.667 Vali Acc: 0.825 Test Loss: 0.667 Test Acc: 0.825
Validation loss decreased (-0.724992 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 1.323775053024292
Epoch: 6, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 1.2999308109283447
Epoch: 7, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 8 cost time: 1.4997870922088623
Epoch: 8, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3528292179107666
Epoch: 9, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.312492847442627
Epoch: 10, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2679388523101807
Epoch: 11, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.825 Test Loss: 0.698 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3590240478515625
Epoch: 12, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.800 Test Loss: 0.724 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.279021978378296
Epoch: 13, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.800 Test Loss: 0.750 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.32602858543396
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.800 Test Loss: 0.772 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3423192501068115
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2987732887268066
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.825 Test Loss: 0.807 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2628588676452637
Epoch: 17, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7897868156433105
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.411 Vali Acc: 0.225 Test Loss: 1.411 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.3278875350952148
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.374 Vali Acc: 0.350 Test Loss: 1.374 Test Acc: 0.350
Validation loss decreased (-0.224986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.4519057273864746
Epoch: 3, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.281 Vali Acc: 0.450 Test Loss: 1.281 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.5638272762298584
Epoch: 4, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.279587745666504
Epoch: 5, Steps: 3 | Train Loss: 0.729 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 1.3148248195648193
Epoch: 6, Steps: 3 | Train Loss: 0.438 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 1.2463746070861816
Epoch: 7, Steps: 3 | Train Loss: 0.290 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 1.3610317707061768
Epoch: 8, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.977 Vali Acc: 0.675 Test Loss: 0.977 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 1.253354787826538
Epoch: 9, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.951 Vali Acc: 0.700 Test Loss: 0.951 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.3318445682525635
Epoch: 10, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.979 Vali Acc: 0.675 Test Loss: 0.979 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.261185646057129
Epoch: 11, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2281241416931152
Epoch: 12, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.984 Vali Acc: 0.700 Test Loss: 0.984 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.445415735244751
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.961 Vali Acc: 0.725 Test Loss: 0.961 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.415654182434082
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.942 Vali Acc: 0.725 Test Loss: 0.942 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.2105937004089355
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.934 Vali Acc: 0.725 Test Loss: 0.934 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 1.4419431686401367
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.932 Vali Acc: 0.725 Test Loss: 0.932 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 1.4274675846099854
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4368748664855957
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.947 Vali Acc: 0.725 Test Loss: 0.947 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3614485263824463
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.335378646850586
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.725 Test Loss: 0.960 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2933411598205566
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3745379447937012
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.411963939666748
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.725 Test Loss: 0.979 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.412938117980957
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.366577386856079
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.725 Test Loss: 0.990 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5132150650024414
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6599314212799072
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.462 Vali Acc: 0.250 Test Loss: 1.462 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.403578758239746
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.444 Vali Acc: 0.275 Test Loss: 1.444 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.31693696975708
Epoch: 3, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.386 Vali Acc: 0.200 Test Loss: 1.386 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3578088283538818
Epoch: 4, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.325 Vali Acc: 0.275 Test Loss: 1.325 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 1.3736457824707031
Epoch: 5, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.3334429264068604
Epoch: 6, Steps: 3 | Train Loss: 0.555 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.432687759399414
Epoch: 7, Steps: 3 | Train Loss: 0.362 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.5651934146881104
Epoch: 8, Steps: 3 | Train Loss: 0.289 Vali Loss: 1.234 Vali Acc: 0.425 Test Loss: 1.234 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4688184261322021
Epoch: 9, Steps: 3 | Train Loss: 0.189 Vali Loss: 1.222 Vali Acc: 0.475 Test Loss: 1.222 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3421776294708252
Epoch: 10, Steps: 3 | Train Loss: 0.100 Vali Loss: 1.225 Vali Acc: 0.450 Test Loss: 1.225 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4159440994262695
Epoch: 11, Steps: 3 | Train Loss: 0.070 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5710785388946533
Epoch: 12, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.298 Vali Acc: 0.475 Test Loss: 1.298 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.418015480041504
Epoch: 13, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.203 Vali Acc: 0.525 Test Loss: 1.203 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.480076789855957
Epoch: 14, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.222 Vali Acc: 0.525 Test Loss: 1.222 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3344383239746094
Epoch: 15, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.312 Vali Acc: 0.575 Test Loss: 1.312 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574987).  Saving model ...
Epoch: 16 cost time: 1.3409006595611572
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.357 Vali Acc: 0.550 Test Loss: 1.357 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.342294692993164
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.376 Vali Acc: 0.550 Test Loss: 1.376 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4653046131134033
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.366 Vali Acc: 0.600 Test Loss: 1.366 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 1.4837048053741455
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.345 Vali Acc: 0.575 Test Loss: 1.345 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5709547996520996
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.319 Vali Acc: 0.600 Test Loss: 1.319 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 21 cost time: 1.540086269378662
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.299 Vali Acc: 0.600 Test Loss: 1.299 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 22 cost time: 1.3575141429901123
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.287 Vali Acc: 0.625 Test Loss: 1.287 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 23 cost time: 1.4696731567382812
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.650 Test Loss: 1.284 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 24 cost time: 1.4642033576965332
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.287 Vali Acc: 0.650 Test Loss: 1.287 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4411137104034424
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.650 Test Loss: 1.293 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4076054096221924
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.650 Test Loss: 1.308 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3964617252349854
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.625 Test Loss: 1.313 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3793883323669434
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.625 Test Loss: 1.309 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3243632316589355
Epoch: 29, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.625 Test Loss: 1.310 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3681082725524902
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.316 Vali Acc: 0.625 Test Loss: 1.316 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.325932264328003
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.600 Test Loss: 1.332 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3543262481689453
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.280411958694458
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.600 Test Loss: 1.363 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8613481521606445
Epoch: 1, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.2494287490844727
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.362 Vali Acc: 0.275 Test Loss: 1.362 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.3128013610839844
Epoch: 3, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.296 Vali Acc: 0.325 Test Loss: 1.296 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 1.2777526378631592
Epoch: 4, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.231 Vali Acc: 0.375 Test Loss: 1.231 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 1.381502628326416
Epoch: 5, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.153 Vali Acc: 0.450 Test Loss: 1.153 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.3047676086425781
Epoch: 6, Steps: 3 | Train Loss: 0.555 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.3652448654174805
Epoch: 7, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.078 Vali Acc: 0.575 Test Loss: 1.078 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 1.2323298454284668
Epoch: 8, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.072 Vali Acc: 0.575 Test Loss: 1.072 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.351231575012207
Epoch: 9, Steps: 3 | Train Loss: 0.165 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 1.3932251930236816
Epoch: 10, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.012 Vali Acc: 0.575 Test Loss: 1.012 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3977558612823486
Epoch: 11, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 12 cost time: 1.4409639835357666
Epoch: 12, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4840490818023682
Epoch: 13, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.42305588722229
Epoch: 14, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.036 Vali Acc: 0.575 Test Loss: 1.036 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2458176612854004
Epoch: 15, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2470109462738037
Epoch: 16, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.073 Vali Acc: 0.625 Test Loss: 1.073 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 1.4637413024902344
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 18 cost time: 1.3560059070587158
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.084 Vali Acc: 0.675 Test Loss: 1.084 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.379321575164795
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.101 Vali Acc: 0.650 Test Loss: 1.101 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4208369255065918
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3535521030426025
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.113 Vali Acc: 0.650 Test Loss: 1.113 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3786828517913818
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.109 Vali Acc: 0.675 Test Loss: 1.109 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.487475872039795
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.675 Test Loss: 1.102 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4019548892974854
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2272119522094727
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4688379764556885
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.650 Test Loss: 1.099 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3078949451446533
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8946657180786133
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1923460960388184
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.3031024932861328
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.281010389328003
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3338346481323242
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4475829601287842
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.399306058883667
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.323516607284546
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5031139850616455
Epoch: 9, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3593425750732422
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4322476387023926
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4717810153961182
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4696784019470215
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.3871777057647705
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.3294801712036133
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.422074317932129
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5683813095092773
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.285097599029541
Epoch: 18, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3276302814483643
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.409416675567627
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3151953220367432
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2267954349517822
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2674918174743652
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.323965072631836
Epoch: 24, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 25 cost time: 1.3369653224945068
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 26 cost time: 1.3624858856201172
Epoch: 26, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4336879253387451
Epoch: 27, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0717298984527588
Epoch: 28, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1975970268249512
Epoch: 29, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2717835903167725
Epoch: 30, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.267866611480713
Epoch: 31, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4390487670898438
Epoch: 32, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4157733917236328
Epoch: 33, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4284186363220215
Epoch: 34, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1709258556365967
Epoch: 35, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 11380228
model size : 62.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9910426139831543
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.311 Vali Acc: 0.425 Test Loss: 1.311 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.3966984748840332
Epoch: 2, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.424987 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 1.6250481605529785
Epoch: 3, Steps: 3 | Train Loss: 0.980 Vali Loss: 0.932 Vali Acc: 0.750 Test Loss: 0.932 Test Acc: 0.750
Validation loss decreased (-0.599989 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 1.4831311702728271
Epoch: 4, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849993).  Saving model ...
Epoch: 5 cost time: 1.5595989227294922
Epoch: 5, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.621093988418579
Epoch: 6, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 7 cost time: 1.4348304271697998
Epoch: 7, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899997).  Saving model ...
Epoch: 8 cost time: 1.4595649242401123
Epoch: 8, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 9 cost time: 1.488518238067627
Epoch: 9, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4552342891693115
Epoch: 10, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.370 Vali Acc: 0.875 Test Loss: 0.370 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5042507648468018
Epoch: 11, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5018398761749268
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.318969488143921
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3157603740692139
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4161350727081299
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.371539831161499
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.323319435119629
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2917201519012451
Epoch: 18, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.640145778656006
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.471013069152832
Epoch: 2, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.176 Vali Acc: 0.575 Test Loss: 1.176 Test Acc: 0.575
Validation loss decreased (-0.399987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 1.3846681118011475
Epoch: 3, Steps: 3 | Train Loss: 0.983 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
Validation loss decreased (-0.574988 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 1.2877223491668701
Epoch: 4, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824993).  Saving model ...
Epoch: 5 cost time: 1.41206955909729
Epoch: 5, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 1.29087495803833
Epoch: 6, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 1.1647160053253174
Epoch: 7, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 1.2116351127624512
Epoch: 8, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3404524326324463
Epoch: 9, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.29178786277771
Epoch: 10, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2109248638153076
Epoch: 11, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2630751132965088
Epoch: 12, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2923779487609863
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2863163948059082
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3420023918151855
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2396438121795654
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2616026401519775
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.972703456878662
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.4532935619354248
Epoch: 2, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.119 Vali Acc: 0.750 Test Loss: 1.119 Test Acc: 0.750
Validation loss decreased (-0.399987 --> -0.749989).  Saving model ...
Epoch: 3 cost time: 1.2567124366760254
Epoch: 3, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.939 Vali Acc: 0.800 Test Loss: 0.939 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 1.2782933712005615
Epoch: 4, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 1.4817829132080078
Epoch: 5, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 1.443390130996704
Epoch: 6, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 1.2442944049835205
Epoch: 7, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 1.3999714851379395
Epoch: 8, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2941129207611084
Epoch: 9, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.484 Vali Acc: 0.925 Test Loss: 0.484 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.478043794631958
Epoch: 10, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.531 Vali Acc: 0.925 Test Loss: 0.531 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4121513366699219
Epoch: 11, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4233589172363281
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3504388332366943
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2673559188842773
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2372832298278809
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.537414789199829
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3218190670013428
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.864732027053833
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.185 Vali Acc: 0.550 Test Loss: 1.185 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 1.4011662006378174
Epoch: 2, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.053 Vali Acc: 0.750 Test Loss: 1.053 Test Acc: 0.750
Validation loss decreased (-0.549988 --> -0.749989).  Saving model ...
Epoch: 3 cost time: 1.3738725185394287
Epoch: 3, Steps: 3 | Train Loss: 0.882 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.488905429840088
Epoch: 4, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849993).  Saving model ...
Epoch: 5 cost time: 1.4182031154632568
Epoch: 5, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849995).  Saving model ...
Epoch: 6 cost time: 1.4099376201629639
Epoch: 6, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.475 Vali Acc: 0.800 Test Loss: 0.475 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4221160411834717
Epoch: 7, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.472 Vali Acc: 0.775 Test Loss: 0.472 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.381368637084961
Epoch: 8, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.506 Vali Acc: 0.750 Test Loss: 0.506 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.269188404083252
Epoch: 9, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3067123889923096
Epoch: 10, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.548 Vali Acc: 0.800 Test Loss: 0.548 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2503581047058105
Epoch: 11, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4561550617218018
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3921911716461182
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3932075500488281
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.305166482925415
Epoch: 15, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.679445505142212
Epoch: 1, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.2152185440063477
Epoch: 2, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.082 Vali Acc: 0.650 Test Loss: 1.082 Test Acc: 0.650
Validation loss decreased (-0.499988 --> -0.649989).  Saving model ...
Epoch: 3 cost time: 1.3208506107330322
Epoch: 3, Steps: 3 | Train Loss: 0.993 Vali Loss: 0.931 Vali Acc: 0.675 Test Loss: 0.931 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674991).  Saving model ...
Epoch: 4 cost time: 1.2997970581054688
Epoch: 4, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.730 Vali Acc: 0.825 Test Loss: 0.730 Test Acc: 0.825
Validation loss decreased (-0.674991 --> -0.824993).  Saving model ...
Epoch: 5 cost time: 1.263847827911377
Epoch: 5, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 1.1962811946868896
Epoch: 6, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.4723000526428223
Epoch: 7, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2461726665496826
Epoch: 8, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.325674057006836
Epoch: 9, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.625 Vali Acc: 0.775 Test Loss: 0.625 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3304839134216309
Epoch: 10, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.669 Vali Acc: 0.775 Test Loss: 0.669 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2326700687408447
Epoch: 11, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3364646434783936
Epoch: 12, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2985777854919434
Epoch: 13, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3939135074615479
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.775 Test Loss: 0.769 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4175302982330322
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3504984378814697
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8410112857818604
Epoch: 1, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.464677095413208
Epoch: 2, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.292 Vali Acc: 0.425 Test Loss: 1.292 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4272305965423584
Epoch: 3, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.3386926651000977
Epoch: 4, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.141 Vali Acc: 0.450 Test Loss: 1.141 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.343010425567627
Epoch: 5, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.058 Vali Acc: 0.550 Test Loss: 1.058 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 1.3620250225067139
Epoch: 6, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.968 Vali Acc: 0.600 Test Loss: 0.968 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 1.4705810546875
Epoch: 7, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.935 Vali Acc: 0.625 Test Loss: 0.935 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624991).  Saving model ...
Epoch: 8 cost time: 1.3454573154449463
Epoch: 8, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.973 Vali Acc: 0.650 Test Loss: 0.973 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 1.4128034114837646
Epoch: 9, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.001 Vali Acc: 0.650 Test Loss: 1.001 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3663139343261719
Epoch: 10, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.990 Vali Acc: 0.675 Test Loss: 0.990 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 1.4283084869384766
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.931 Vali Acc: 0.700 Test Loss: 0.931 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 1.4788298606872559
Epoch: 12, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.898 Vali Acc: 0.700 Test Loss: 0.898 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 1.3936033248901367
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.889 Vali Acc: 0.725 Test Loss: 0.889 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 1.1865289211273193
Epoch: 14, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.886 Vali Acc: 0.725 Test Loss: 0.886 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.2556443214416504
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2902452945709229
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2779805660247803
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.414691686630249
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3258492946624756
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.970 Vali Acc: 0.725 Test Loss: 0.970 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3753063678741455
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.239621877670288
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.725 Test Loss: 1.014 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2400476932525635
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.725 Test Loss: 1.026 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2940483093261719
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.725 Test Loss: 1.038 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3858706951141357
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.725 Test Loss: 1.046 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.707287073135376
Epoch: 1, Steps: 3 | Train Loss: 1.539 Vali Loss: 1.509 Vali Acc: 0.150 Test Loss: 1.509 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.335174560546875
Epoch: 2, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.484 Vali Acc: 0.150 Test Loss: 1.484 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 3 cost time: 1.4502348899841309
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.419 Vali Acc: 0.200 Test Loss: 1.419 Test Acc: 0.200
Validation loss decreased (-0.149985 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 1.3970019817352295
Epoch: 4, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.331 Vali Acc: 0.225 Test Loss: 1.331 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224987).  Saving model ...
Epoch: 5 cost time: 1.3489210605621338
Epoch: 5, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.276 Vali Acc: 0.325 Test Loss: 1.276 Test Acc: 0.325
Validation loss decreased (-0.224987 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 1.3724839687347412
Epoch: 6, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.215 Vali Acc: 0.375 Test Loss: 1.215 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 7 cost time: 1.539433240890503
Epoch: 7, Steps: 3 | Train Loss: 0.405 Vali Loss: 1.193 Vali Acc: 0.350 Test Loss: 1.193 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3322858810424805
Epoch: 8, Steps: 3 | Train Loss: 0.307 Vali Loss: 1.245 Vali Acc: 0.375 Test Loss: 1.245 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4980344772338867
Epoch: 9, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.245 Vali Acc: 0.375 Test Loss: 1.245 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4676775932312012
Epoch: 10, Steps: 3 | Train Loss: 0.126 Vali Loss: 1.200 Vali Acc: 0.425 Test Loss: 1.200 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 1.3078114986419678
Epoch: 11, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.123 Vali Acc: 0.525 Test Loss: 1.123 Test Acc: 0.525
Validation loss decreased (-0.424988 --> -0.524989).  Saving model ...
Epoch: 12 cost time: 1.2990052700042725
Epoch: 12, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.206 Vali Acc: 0.475 Test Loss: 1.206 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2405660152435303
Epoch: 13, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.532 Vali Acc: 0.425 Test Loss: 1.532 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.539060115814209
Epoch: 14, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.462 Vali Acc: 0.475 Test Loss: 1.462 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4949336051940918
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.234 Vali Acc: 0.525 Test Loss: 1.234 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4959471225738525
Epoch: 16, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.150 Vali Acc: 0.550 Test Loss: 1.150 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 1.331146478652954
Epoch: 17, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.176 Vali Acc: 0.575 Test Loss: 1.176 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574988).  Saving model ...
Epoch: 18 cost time: 1.3401703834533691
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.280 Vali Acc: 0.600 Test Loss: 1.280 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599987).  Saving model ...
Epoch: 19 cost time: 1.2664527893066406
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.399 Vali Acc: 0.575 Test Loss: 1.399 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2995786666870117
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.490 Vali Acc: 0.550 Test Loss: 1.490 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3219330310821533
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.545 Vali Acc: 0.550 Test Loss: 1.545 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.436734914779663
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.538 Vali Acc: 0.550 Test Loss: 1.538 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.248586654663086
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.575 Test Loss: 1.524 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3029277324676514
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.575 Test Loss: 1.493 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2635278701782227
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.458 Vali Acc: 0.575 Test Loss: 1.458 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2613725662231445
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.426 Vali Acc: 0.625 Test Loss: 1.426 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624986).  Saving model ...
Epoch: 27 cost time: 1.5037693977355957
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.600 Test Loss: 1.397 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4259955883026123
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.600 Test Loss: 1.365 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3255834579467773
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2980687618255615
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.600 Test Loss: 1.317 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.360271692276001
Epoch: 31, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.625 Test Loss: 1.312 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624987).  Saving model ...
Epoch: 32 cost time: 1.3562862873077393
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.314 Vali Acc: 0.625 Test Loss: 1.314 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3398950099945068
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.625 Test Loss: 1.326 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3925535678863525
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.600 Test Loss: 1.339 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3341341018676758
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.575 Test Loss: 1.359 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4071779251098633
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.575 Test Loss: 1.373 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2771625518798828
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.575 Test Loss: 1.384 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.337784767150879
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.575 Test Loss: 1.389 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3945415019989014
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.575 Test Loss: 1.392 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4841604232788086
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.575 Test Loss: 1.391 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4370121955871582
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.395 Vali Acc: 0.575 Test Loss: 1.395 Test Acc: 0.575
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.896496534347534
Epoch: 1, Steps: 3 | Train Loss: 1.602 Vali Loss: 1.453 Vali Acc: 0.250 Test Loss: 1.453 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.3312454223632812
Epoch: 2, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.424 Vali Acc: 0.250 Test Loss: 1.424 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2510716915130615
Epoch: 3, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.3020482063293457
Epoch: 4, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.259 Vali Acc: 0.425 Test Loss: 1.259 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.2619802951812744
Epoch: 5, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.186 Vali Acc: 0.475 Test Loss: 1.186 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 1.2484469413757324
Epoch: 6, Steps: 3 | Train Loss: 0.646 Vali Loss: 1.132 Vali Acc: 0.475 Test Loss: 1.132 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 7 cost time: 1.251086711883545
Epoch: 7, Steps: 3 | Train Loss: 0.441 Vali Loss: 1.137 Vali Acc: 0.450 Test Loss: 1.137 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3430240154266357
Epoch: 8, Steps: 3 | Train Loss: 0.306 Vali Loss: 1.158 Vali Acc: 0.475 Test Loss: 1.158 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3941805362701416
Epoch: 9, Steps: 3 | Train Loss: 0.180 Vali Loss: 1.103 Vali Acc: 0.525 Test Loss: 1.103 Test Acc: 0.525
Validation loss decreased (-0.474989 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 1.209289312362671
Epoch: 10, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.063 Vali Acc: 0.575 Test Loss: 1.063 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 1.333585262298584
Epoch: 11, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.970 Vali Acc: 0.550 Test Loss: 0.970 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1781136989593506
Epoch: 12, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2424566745758057
Epoch: 13, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.240 Vali Acc: 0.475 Test Loss: 1.240 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.191772222518921
Epoch: 14, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.256695032119751
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.042 Vali Acc: 0.525 Test Loss: 1.042 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1681139469146729
Epoch: 16, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.009 Vali Acc: 0.625 Test Loss: 1.009 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 1.2978606224060059
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.041 Vali Acc: 0.625 Test Loss: 1.041 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2607941627502441
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.092120885848999
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2499191761016846
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.246 Vali Acc: 0.550 Test Loss: 1.246 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3180088996887207
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1548190116882324
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1845624446868896
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.600 Test Loss: 1.296 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1716275215148926
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.274 Vali Acc: 0.575 Test Loss: 1.274 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3307995796203613
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.245 Vali Acc: 0.575 Test Loss: 1.245 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3389947414398193
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.600 Test Loss: 1.220 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.051809072494507
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.4003238677978516
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5374541282653809
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3921308517456055
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3807337284088135
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4540386199951172
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.627556324005127
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.335444688796997
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.595651626586914
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2912933826446533
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3895487785339355
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 10593796
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8195669651031494
Epoch: 1, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.292 Vali Acc: 0.450 Test Loss: 1.292 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.2557809352874756
Epoch: 2, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.2445166110992432
Epoch: 3, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.901 Vali Acc: 0.725 Test Loss: 0.901 Test Acc: 0.725
Validation loss decreased (-0.499988 --> -0.724991).  Saving model ...
Epoch: 4 cost time: 1.3195931911468506
Epoch: 4, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.666 Vali Acc: 0.825 Test Loss: 0.666 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824993).  Saving model ...
Epoch: 5 cost time: 1.3268029689788818
Epoch: 5, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874995).  Saving model ...
Epoch: 6 cost time: 1.3314318656921387
Epoch: 6, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 1.216001033782959
Epoch: 7, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 8 cost time: 1.5293281078338623
Epoch: 8, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2726056575775146
Epoch: 9, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.200514554977417
Epoch: 10, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3343431949615479
Epoch: 11, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3590290546417236
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3157601356506348
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3194663524627686
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.875 Test Loss: 0.438 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.371551513671875
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2834198474884033
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3873608112335205
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.819793701171875
Epoch: 1, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.279 Vali Acc: 0.500 Test Loss: 1.279 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.3221173286437988
Epoch: 2, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.141 Vali Acc: 0.475 Test Loss: 1.141 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.248004674911499
Epoch: 3, Steps: 3 | Train Loss: 0.915 Vali Loss: 0.871 Vali Acc: 0.700 Test Loss: 0.871 Test Acc: 0.700
Validation loss decreased (-0.499987 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 1.3149948120117188
Epoch: 4, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.634 Vali Acc: 0.875 Test Loss: 0.634 Test Acc: 0.875
Validation loss decreased (-0.699991 --> -0.874994).  Saving model ...
Epoch: 5 cost time: 1.1976878643035889
Epoch: 5, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 1.3713469505310059
Epoch: 6, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 1.353407859802246
Epoch: 7, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5082712173461914
Epoch: 8, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.360 Vali Acc: 0.875 Test Loss: 0.360 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4215781688690186
Epoch: 9, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3999271392822266
Epoch: 10, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4000139236450195
Epoch: 11, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.427 Vali Acc: 0.875 Test Loss: 0.427 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.420973777770996
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3891401290893555
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.875 Test Loss: 0.435 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4002153873443604
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.327695608139038
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4495398998260498
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9523847103118896
Epoch: 1, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.329 Vali Acc: 0.375 Test Loss: 1.329 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2009456157684326
Epoch: 2, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.191 Vali Acc: 0.450 Test Loss: 1.191 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 3 cost time: 1.3166892528533936
Epoch: 3, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
Validation loss decreased (-0.449988 --> -0.699991).  Saving model ...
Epoch: 4 cost time: 1.3948872089385986
Epoch: 4, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849993).  Saving model ...
Epoch: 5 cost time: 1.4900133609771729
Epoch: 5, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 6 cost time: 1.4054250717163086
Epoch: 6, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 1.2444169521331787
Epoch: 7, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 1.2525274753570557
Epoch: 8, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3346805572509766
Epoch: 9, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3476943969726562
Epoch: 10, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3256371021270752
Epoch: 11, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3109958171844482
Epoch: 12, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.900 Test Loss: 0.592 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4456896781921387
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.900 Test Loss: 0.598 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3093504905700684
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2630259990692139
Epoch: 15, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.900 Test Loss: 0.604 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.294198989868164
Epoch: 16, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2076694965362549
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9015417098999023
Epoch: 1, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.262 Vali Acc: 0.525 Test Loss: 1.262 Test Acc: 0.525
Validation loss decreased (inf --> -0.524987).  Saving model ...
Epoch: 2 cost time: 1.249251127243042
Epoch: 2, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624989).  Saving model ...
Epoch: 3 cost time: 1.3442764282226562
Epoch: 3, Steps: 3 | Train Loss: 0.877 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 1.3105525970458984
Epoch: 4, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774993).  Saving model ...
Epoch: 5 cost time: 1.2061398029327393
Epoch: 5, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 6 cost time: 1.2332639694213867
Epoch: 6, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.500 Vali Acc: 0.775 Test Loss: 0.500 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774995).  Saving model ...
Epoch: 7 cost time: 1.3028807640075684
Epoch: 7, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.471 Vali Acc: 0.825 Test Loss: 0.471 Test Acc: 0.825
Validation loss decreased (-0.774995 --> -0.824995).  Saving model ...
Epoch: 8 cost time: 1.3633067607879639
Epoch: 8, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.482 Vali Acc: 0.825 Test Loss: 0.482 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4222333431243896
Epoch: 9, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3183717727661133
Epoch: 10, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2534916400909424
Epoch: 11, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4356675148010254
Epoch: 12, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4126989841461182
Epoch: 13, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.340085506439209
Epoch: 14, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.825 Test Loss: 0.602 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2709763050079346
Epoch: 15, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3568847179412842
Epoch: 16, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4710652828216553
Epoch: 17, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0493617057800293
Epoch: 1, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.286 Vali Acc: 0.450 Test Loss: 1.286 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.398756742477417
Epoch: 2, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.3823578357696533
Epoch: 3, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.967 Vali Acc: 0.700 Test Loss: 0.967 Test Acc: 0.700
Validation loss decreased (-0.499988 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.2900691032409668
Epoch: 4, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.802 Vali Acc: 0.825 Test Loss: 0.802 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 1.3118393421173096
Epoch: 5, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3182976245880127
Epoch: 6, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4377505779266357
Epoch: 7, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3625223636627197
Epoch: 8, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.365713357925415
Epoch: 9, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3538262844085693
Epoch: 10, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4108738899230957
Epoch: 11, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4138107299804688
Epoch: 12, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2677395343780518
Epoch: 13, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3242554664611816
Epoch: 14, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6736881732940674
Epoch: 1, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.419 Vali Acc: 0.275 Test Loss: 1.419 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.401343822479248
Epoch: 2, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.382 Vali Acc: 0.275 Test Loss: 1.382 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.3995411396026611
Epoch: 3, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.285 Vali Acc: 0.450 Test Loss: 1.285 Test Acc: 0.450
Validation loss decreased (-0.274986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.4616472721099854
Epoch: 4, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.185 Vali Acc: 0.575 Test Loss: 1.185 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.3952393531799316
Epoch: 5, Steps: 3 | Train Loss: 0.663 Vali Loss: 1.117 Vali Acc: 0.575 Test Loss: 1.117 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 1.4381897449493408
Epoch: 6, Steps: 3 | Train Loss: 0.464 Vali Loss: 1.050 Vali Acc: 0.575 Test Loss: 1.050 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 7 cost time: 1.347578763961792
Epoch: 7, Steps: 3 | Train Loss: 0.280 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 1.4101765155792236
Epoch: 8, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.3980364799499512
Epoch: 9, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4121639728546143
Epoch: 10, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.996 Vali Acc: 0.650 Test Loss: 0.996 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 1.2889022827148438
Epoch: 11, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.970 Vali Acc: 0.650 Test Loss: 0.970 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 1.4246628284454346
Epoch: 12, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.950 Vali Acc: 0.650 Test Loss: 0.950 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 1.3863728046417236
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.962 Vali Acc: 0.675 Test Loss: 0.962 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 1.3180170059204102
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.007 Vali Acc: 0.700 Test Loss: 1.007 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 1.1118063926696777
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.053 Vali Acc: 0.675 Test Loss: 1.053 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1926546096801758
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2071678638458252
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1272854804992676
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.102 Vali Acc: 0.675 Test Loss: 1.102 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2266807556152344
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.107 Vali Acc: 0.700 Test Loss: 1.107 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2910456657409668
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.112 Vali Acc: 0.700 Test Loss: 1.112 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3529202938079834
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.113 Vali Acc: 0.700 Test Loss: 1.113 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3286921977996826
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.113 Vali Acc: 0.725 Test Loss: 1.113 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724989).  Saving model ...
Epoch: 23 cost time: 1.2592339515686035
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.110 Vali Acc: 0.725 Test Loss: 1.110 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 24 cost time: 1.2619471549987793
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.725 Test Loss: 1.108 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 25 cost time: 1.3298883438110352
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.725 Test Loss: 1.103 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 26 cost time: 1.3023638725280762
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.725 Test Loss: 1.099 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 27 cost time: 1.2192776203155518
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.725 Test Loss: 1.095 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 28 cost time: 1.2332756519317627
Epoch: 28, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.725 Test Loss: 1.093 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 29 cost time: 1.3977272510528564
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 30 cost time: 1.438769817352295
Epoch: 30, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 31 cost time: 1.4069492816925049
Epoch: 31, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3408565521240234
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4263041019439697
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4018146991729736
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5446107387542725
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 36 cost time: 1.3965504169464111
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 37 cost time: 1.5018494129180908
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.725 Test Loss: 1.089 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 38 cost time: 1.3758151531219482
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.725 Test Loss: 1.089 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3529181480407715
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3222508430480957
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.725 Test Loss: 1.089 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3952100276947021
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.725 Test Loss: 1.089 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2302942276000977
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4393067359924316
Epoch: 43, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.725 Test Loss: 1.092 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.361466884613037
Epoch: 44, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.095 Vali Acc: 0.725 Test Loss: 1.095 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.3133935928344727
Epoch: 45, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.725 Test Loss: 1.099 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3520443439483643
Epoch: 46, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.725 Test Loss: 1.102 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2054202556610107
Epoch: 47, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.725 Test Loss: 1.106 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8793742656707764
Epoch: 1, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.459 Vali Acc: 0.150 Test Loss: 1.459 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.36226487159729
Epoch: 2, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.427 Vali Acc: 0.175 Test Loss: 1.427 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.343472957611084
Epoch: 3, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.338 Vali Acc: 0.300 Test Loss: 1.338 Test Acc: 0.300
Validation loss decreased (-0.174986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 1.3636045455932617
Epoch: 4, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.262 Vali Acc: 0.375 Test Loss: 1.262 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.2816121578216553
Epoch: 5, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.202 Vali Acc: 0.450 Test Loss: 1.202 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.3896045684814453
Epoch: 6, Steps: 3 | Train Loss: 0.575 Vali Loss: 1.161 Vali Acc: 0.425 Test Loss: 1.161 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.419283390045166
Epoch: 7, Steps: 3 | Train Loss: 0.412 Vali Loss: 1.153 Vali Acc: 0.425 Test Loss: 1.153 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4838306903839111
Epoch: 8, Steps: 3 | Train Loss: 0.272 Vali Loss: 1.134 Vali Acc: 0.450 Test Loss: 1.134 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449989).  Saving model ...
Epoch: 9 cost time: 1.367260456085205
Epoch: 9, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.449989 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.4370548725128174
Epoch: 10, Steps: 3 | Train Loss: 0.147 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5016565322875977
Epoch: 11, Steps: 3 | Train Loss: 0.096 Vali Loss: 1.274 Vali Acc: 0.425 Test Loss: 1.274 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3130531311035156
Epoch: 12, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.178 Vali Acc: 0.475 Test Loss: 1.178 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2719941139221191
Epoch: 13, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.4321775436401367
Epoch: 14, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.210 Vali Acc: 0.525 Test Loss: 1.210 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524988).  Saving model ...
Epoch: 15 cost time: 1.4712181091308594
Epoch: 15, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.314 Vali Acc: 0.525 Test Loss: 1.314 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3904788494110107
Epoch: 16, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.342 Vali Acc: 0.525 Test Loss: 1.342 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.467038869857788
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.356 Vali Acc: 0.500 Test Loss: 1.356 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.606358528137207
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.525 Test Loss: 1.352 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4110543727874756
Epoch: 19, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.321 Vali Acc: 0.575 Test Loss: 1.321 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574987).  Saving model ...
Epoch: 20 cost time: 1.449962854385376
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.303 Vali Acc: 0.600 Test Loss: 1.303 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 21 cost time: 1.408296823501587
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.289 Vali Acc: 0.600 Test Loss: 1.289 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 22 cost time: 1.3884072303771973
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.286 Vali Acc: 0.600 Test Loss: 1.286 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599987).  Saving model ...
Epoch: 23 cost time: 1.4168517589569092
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.600 Test Loss: 1.293 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4891142845153809
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.600 Test Loss: 1.309 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2537517547607422
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.318 Vali Acc: 0.600 Test Loss: 1.318 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1742455959320068
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.600 Test Loss: 1.328 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.300980567932129
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.600 Test Loss: 1.339 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5590393543243408
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.600 Test Loss: 1.352 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3173580169677734
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.360 Vali Acc: 0.625 Test Loss: 1.360 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624986).  Saving model ...
Epoch: 30 cost time: 1.4386403560638428
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.625 Test Loss: 1.367 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2831571102142334
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.374 Vali Acc: 0.625 Test Loss: 1.374 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5177586078643799
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.625 Test Loss: 1.373 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3500046730041504
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.625 Test Loss: 1.367 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3474044799804688
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.625 Test Loss: 1.363 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5491042137145996
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.356 Vali Acc: 0.625 Test Loss: 1.356 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624986).  Saving model ...
Epoch: 36 cost time: 1.6300907135009766
Epoch: 36, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.625 Test Loss: 1.351 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624986).  Saving model ...
Epoch: 37 cost time: 1.3478825092315674
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.600 Test Loss: 1.349 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4272854328155518
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.625 Test Loss: 1.348 Test Acc: 0.625
Validation loss decreased (-0.624986 --> -0.624987).  Saving model ...
Epoch: 39 cost time: 1.4640812873840332
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.625 Test Loss: 1.349 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4775874614715576
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.625 Test Loss: 1.349 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.362424612045288
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.625 Test Loss: 1.352 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3695824146270752
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.625 Test Loss: 1.359 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5583291053771973
Epoch: 43, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.368 Vali Acc: 0.625 Test Loss: 1.368 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3641531467437744
Epoch: 44, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.650 Test Loss: 1.384 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649986).  Saving model ...
Epoch: 45 cost time: 1.5537083148956299
Epoch: 45, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.650 Test Loss: 1.399 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4798624515533447
Epoch: 46, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.650 Test Loss: 1.411 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4582016468048096
Epoch: 47, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.650 Test Loss: 1.419 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.37056565284729
Epoch: 48, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.650 Test Loss: 1.428 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.4920275211334229
Epoch: 49, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.650 Test Loss: 1.429 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.6248011589050293
Epoch: 50, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.650 Test Loss: 1.429 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.4180972576141357
Epoch: 51, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.650 Test Loss: 1.428 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4758222103118896
Epoch: 52, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.650 Test Loss: 1.426 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3852944374084473
Epoch: 53, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.650 Test Loss: 1.426 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.3433763980865479
Epoch: 54, Steps: 3 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.650 Test Loss: 1.429 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.047844409942627
Epoch: 1, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.385 Vali Acc: 0.300 Test Loss: 1.385 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.2772233486175537
Epoch: 2, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.195659875869751
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.277 Vali Acc: 0.375 Test Loss: 1.277 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.2229225635528564
Epoch: 4, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.247100830078125
Epoch: 5, Steps: 3 | Train Loss: 0.785 Vali Loss: 1.118 Vali Acc: 0.425 Test Loss: 1.118 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424989).  Saving model ...
Epoch: 6 cost time: 1.2519643306732178
Epoch: 6, Steps: 3 | Train Loss: 0.573 Vali Loss: 1.061 Vali Acc: 0.475 Test Loss: 1.061 Test Acc: 0.475
Validation loss decreased (-0.424989 --> -0.474989).  Saving model ...
Epoch: 7 cost time: 1.236365795135498
Epoch: 7, Steps: 3 | Train Loss: 0.393 Vali Loss: 1.006 Vali Acc: 0.550 Test Loss: 1.006 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 1.322535753250122
Epoch: 8, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.958 Vali Acc: 0.575 Test Loss: 0.958 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 9 cost time: 1.2543566226959229
Epoch: 9, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.947 Vali Acc: 0.625 Test Loss: 0.947 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624991).  Saving model ...
Epoch: 10 cost time: 1.2215824127197266
Epoch: 10, Steps: 3 | Train Loss: 0.152 Vali Loss: 1.028 Vali Acc: 0.525 Test Loss: 1.028 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2735013961791992
Epoch: 11, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.028 Vali Acc: 0.525 Test Loss: 1.028 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.359086513519287
Epoch: 12, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.949 Vali Acc: 0.575 Test Loss: 0.949 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.289250373840332
Epoch: 13, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.851 Vali Acc: 0.600 Test Loss: 0.851 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2875244617462158
Epoch: 14, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.866 Vali Acc: 0.625 Test Loss: 0.866 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 15 cost time: 1.2501673698425293
Epoch: 15, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
Validation loss decreased (-0.624991 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 1.367124319076538
Epoch: 16, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.945 Vali Acc: 0.675 Test Loss: 0.945 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3045191764831543
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4337193965911865
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3973109722137451
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4551856517791748
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3487505912780762
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3444008827209473
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.986 Vali Acc: 0.650 Test Loss: 0.986 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3701226711273193
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.650 Test Loss: 0.991 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4467897415161133
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.650 Test Loss: 0.999 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5105290412902832
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.935713291168213
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3031353950500488
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.256272554397583
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3260648250579834
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2190778255462646
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2314317226409912
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2650811672210693
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3239378929138184
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2449467182159424
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2498738765716553
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2234632968902588
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 10200580
model size : 58.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6343557834625244
Epoch: 1, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.403 Vali Acc: 0.350 Test Loss: 1.403 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.334165334701538
Epoch: 2, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.295 Vali Acc: 0.475 Test Loss: 1.295 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.363630771636963
Epoch: 3, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.101 Vali Acc: 0.725 Test Loss: 1.101 Test Acc: 0.725
Validation loss decreased (-0.474987 --> -0.724989).  Saving model ...
Epoch: 4 cost time: 1.439096212387085
Epoch: 4, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 1.4543359279632568
Epoch: 5, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.653 Vali Acc: 0.850 Test Loss: 0.653 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849993).  Saving model ...
Epoch: 6 cost time: 1.5143711566925049
Epoch: 6, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 1.5747301578521729
Epoch: 7, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 1.2439496517181396
Epoch: 8, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 1.3107852935791016
Epoch: 9, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 10 cost time: 1.4199213981628418
Epoch: 10, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3364143371582031
Epoch: 11, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3506090641021729
Epoch: 12, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3877160549163818
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2521355152130127
Epoch: 14, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2733232975006104
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 1.3171350955963135
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 1.3362407684326172
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 1.3002150058746338
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 1.2431440353393555
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 1.2437551021575928
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 1.2398269176483154
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 1.3425395488739014
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.3773858547210693
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.3686344623565674
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.265099287033081
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.3340675830841064
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.2951207160949707
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.32029390335083
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.4725284576416016
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.5083458423614502
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 1.5625739097595215
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 1.5469589233398438
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 1.3446695804595947
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 1.426025152206421
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 1.4004967212677002
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.4428138732910156
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.4280922412872314
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.2889750003814697
Epoch: 38, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 1.4704432487487793
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 1.5705666542053223
Epoch: 40, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.597726583480835
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.4486122131347656
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4633302688598633
Epoch: 43, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3453707695007324
Epoch: 44, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.478365182876587
Epoch: 45, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6033072471618652
Epoch: 46, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2883057594299316
Epoch: 47, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3787853717803955
Epoch: 48, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.321732997894287
Epoch: 49, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.3058631420135498
Epoch: 50, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.5420408248901367
Epoch: 51, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.748215675354004
Epoch: 1, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.416 Vali Acc: 0.275 Test Loss: 1.416 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.2562377452850342
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.307 Vali Acc: 0.425 Test Loss: 1.307 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.2085983753204346
Epoch: 3, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.112 Vali Acc: 0.675 Test Loss: 1.112 Test Acc: 0.675
Validation loss decreased (-0.424987 --> -0.674989).  Saving model ...
Epoch: 4 cost time: 1.34035325050354
Epoch: 4, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
Validation loss decreased (-0.674989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 1.186702013015747
Epoch: 5, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 1.291874885559082
Epoch: 6, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1991779804229736
Epoch: 7, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899996).  Saving model ...
Epoch: 8 cost time: 1.300011396408081
Epoch: 8, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 1.4110138416290283
Epoch: 9, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 1.3324975967407227
Epoch: 10, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 1.241607427597046
Epoch: 11, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 12 cost time: 1.162555456161499
Epoch: 12, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 1.244588851928711
Epoch: 13, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 1.392868995666504
Epoch: 14, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 1.2111995220184326
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 1.3167624473571777
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 1.322537899017334
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 1.1798944473266602
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 1.4216268062591553
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 1.478938102722168
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 1.3393669128417969
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 1.3199262619018555
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.2816298007965088
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.2520177364349365
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.3677735328674316
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.355687141418457
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.3809256553649902
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.3949871063232422
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.3564190864562988
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.3144135475158691
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.26058030128479
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2945077419281006
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.1695833206176758
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.3526530265808105
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4448201656341553
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3437035083770752
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3432984352111816
Epoch: 37, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.177586317062378
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2890338897705078
Epoch: 39, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3149614334106445
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3677775859832764
Epoch: 41, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.30332612991333
Epoch: 42, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2614424228668213
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.011422634124756
Epoch: 1, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.387 Vali Acc: 0.350 Test Loss: 1.387 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.297861099243164
Epoch: 2, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.29500150680542
Epoch: 3, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.097 Vali Acc: 0.625 Test Loss: 1.097 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 1.28670334815979
Epoch: 4, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
Validation loss decreased (-0.624989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 1.2837586402893066
Epoch: 5, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849993).  Saving model ...
Epoch: 6 cost time: 1.3178019523620605
Epoch: 6, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.546 Vali Acc: 0.850 Test Loss: 0.546 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849995).  Saving model ...
Epoch: 7 cost time: 1.3912692070007324
Epoch: 7, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 1.4023098945617676
Epoch: 8, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 1.1881377696990967
Epoch: 9, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3187921047210693
Epoch: 10, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4672601222991943
Epoch: 11, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3392438888549805
Epoch: 12, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.253000259399414
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.217827558517456
Epoch: 14, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.490903377532959
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3414316177368164
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.143324613571167
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1566877365112305
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5999271869659424
Epoch: 1, Steps: 3 | Train Loss: 1.580 Vali Loss: 1.423 Vali Acc: 0.350 Test Loss: 1.423 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.2667121887207031
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 1.269731044769287
Epoch: 3, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.399987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 1.2317447662353516
Epoch: 4, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 1.3371498584747314
Epoch: 5, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774993).  Saving model ...
Epoch: 6 cost time: 1.4024851322174072
Epoch: 6, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 7 cost time: 1.418046236038208
Epoch: 7, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.536 Vali Acc: 0.750 Test Loss: 0.536 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.370072603225708
Epoch: 8, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.487 Vali Acc: 0.800 Test Loss: 0.487 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799995).  Saving model ...
Epoch: 9 cost time: 1.3299274444580078
Epoch: 9, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.461 Vali Acc: 0.800 Test Loss: 0.461 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 1.3700034618377686
Epoch: 10, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.465 Vali Acc: 0.825 Test Loss: 0.465 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 11 cost time: 1.3348569869995117
Epoch: 11, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.467 Vali Acc: 0.800 Test Loss: 0.467 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.387622594833374
Epoch: 12, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.471 Vali Acc: 0.800 Test Loss: 0.471 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.315108299255371
Epoch: 13, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.467 Vali Acc: 0.800 Test Loss: 0.467 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3692357540130615
Epoch: 14, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 1.4487645626068115
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.825 Test Loss: 0.449 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 16 cost time: 1.3428847789764404
Epoch: 16, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.825 Test Loss: 0.440 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 17 cost time: 1.3670547008514404
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.825 Test Loss: 0.432 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 18 cost time: 1.2007384300231934
Epoch: 18, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.825 Test Loss: 0.425 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 19 cost time: 1.2918214797973633
Epoch: 19, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.824996 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 1.3922085762023926
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 21 cost time: 1.2057266235351562
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.875 Test Loss: 0.410 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 1.3416469097137451
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 1.4123625755310059
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 24 cost time: 1.3832387924194336
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 25 cost time: 1.4680554866790771
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 26 cost time: 1.3461642265319824
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2632567882537842
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3007874488830566
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2322187423706055
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2957112789154053
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3572542667388916
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2644681930541992
Epoch: 32, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3944742679595947
Epoch: 33, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1830942630767822
Epoch: 34, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1994574069976807
Epoch: 35, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6586403846740723
Epoch: 1, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.382 Vali Acc: 0.175 Test Loss: 1.382 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.2096874713897705
Epoch: 2, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.284 Vali Acc: 0.375 Test Loss: 1.284 Test Acc: 0.375
Validation loss decreased (-0.174986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.2546460628509521
Epoch: 3, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
Validation loss decreased (-0.374987 --> -0.574989).  Saving model ...
Epoch: 4 cost time: 1.2417733669281006
Epoch: 4, Steps: 3 | Train Loss: 0.897 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 1.189206600189209
Epoch: 5, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774993).  Saving model ...
Epoch: 6 cost time: 1.2884202003479004
Epoch: 6, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 1.2486116886138916
Epoch: 7, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.824994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.2828192710876465
Epoch: 8, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.3405449390411377
Epoch: 9, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3049976825714111
Epoch: 10, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 1.1981825828552246
Epoch: 11, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2121708393096924
Epoch: 12, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.503 Vali Acc: 0.825 Test Loss: 0.503 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1886370182037354
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.199798822402954
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.292555809020996
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2980904579162598
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.564 Vali Acc: 0.825 Test Loss: 0.564 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2742242813110352
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2308695316314697
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2705483436584473
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1894996166229248
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8510313034057617
Epoch: 1, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.478 Vali Acc: 0.275 Test Loss: 1.478 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.2412245273590088
Epoch: 2, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.443 Vali Acc: 0.300 Test Loss: 1.443 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.241699457168579
Epoch: 3, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.388 Vali Acc: 0.325 Test Loss: 1.388 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.1995809078216553
Epoch: 4, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.309 Vali Acc: 0.475 Test Loss: 1.309 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 1.3417432308197021
Epoch: 5, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.2655088901519775
Epoch: 6, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.144 Vali Acc: 0.525 Test Loss: 1.144 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 7 cost time: 1.2795922756195068
Epoch: 7, Steps: 3 | Train Loss: 0.577 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.524989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.320774793624878
Epoch: 8, Steps: 3 | Train Loss: 0.430 Vali Loss: 1.083 Vali Acc: 0.625 Test Loss: 1.083 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.3157176971435547
Epoch: 9, Steps: 3 | Train Loss: 0.288 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.3888986110687256
Epoch: 10, Steps: 3 | Train Loss: 0.230 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.383634090423584
Epoch: 11, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.024 Vali Acc: 0.700 Test Loss: 1.024 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.4387624263763428
Epoch: 12, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 1.3129053115844727
Epoch: 13, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.956 Vali Acc: 0.725 Test Loss: 0.956 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 1.423607587814331
Epoch: 14, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5162358283996582
Epoch: 15, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.905 Vali Acc: 0.725 Test Loss: 0.905 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 1.3911926746368408
Epoch: 16, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.264972448348999
Epoch: 17, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2897112369537354
Epoch: 18, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2069365978240967
Epoch: 19, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1952645778656006
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.944 Vali Acc: 0.775 Test Loss: 0.944 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 1.2079553604125977
Epoch: 21, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.934 Vali Acc: 0.775 Test Loss: 0.934 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 1.162062168121338
Epoch: 22, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.928 Vali Acc: 0.775 Test Loss: 0.928 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 1.4270329475402832
Epoch: 23, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 24 cost time: 1.49111008644104
Epoch: 24, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 25 cost time: 1.2196941375732422
Epoch: 25, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 26 cost time: 1.228269100189209
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1468467712402344
Epoch: 27, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1019058227539062
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2729768753051758
Epoch: 29, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.775 Test Loss: 0.922 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2034175395965576
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.32112455368042
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 32 cost time: 1.2411630153656006
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 33 cost time: 1.1592047214508057
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 34 cost time: 1.1231935024261475
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.775 Test Loss: 0.907 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 35 cost time: 1.154405117034912
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 36 cost time: 1.1763873100280762
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.775 Test Loss: 0.902 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 37 cost time: 1.262730598449707
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.900 Vali Acc: 0.775 Test Loss: 0.900 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 38 cost time: 1.3778996467590332
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.326420545578003
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.775 Test Loss: 0.904 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2323083877563477
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.775 Test Loss: 0.906 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2772860527038574
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3912322521209717
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.909 Vali Acc: 0.775 Test Loss: 0.909 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.303926706314087
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3465697765350342
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.3307673931121826
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.250279426574707
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.3066835403442383
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6278510093688965
Epoch: 1, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.496 Vali Acc: 0.325 Test Loss: 1.496 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 1.2512726783752441
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.475 Vali Acc: 0.375 Test Loss: 1.475 Test Acc: 0.375
Validation loss decreased (-0.324985 --> -0.374985).  Saving model ...
Epoch: 3 cost time: 1.249732494354248
Epoch: 3, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.441 Vali Acc: 0.375 Test Loss: 1.441 Test Acc: 0.375
Validation loss decreased (-0.374985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.3719115257263184
Epoch: 4, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2651689052581787
Epoch: 5, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.323 Vali Acc: 0.300 Test Loss: 1.323 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1822552680969238
Epoch: 6, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.1740961074829102
Epoch: 7, Steps: 3 | Train Loss: 0.736 Vali Loss: 1.252 Vali Acc: 0.375 Test Loss: 1.252 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 1.1351053714752197
Epoch: 8, Steps: 3 | Train Loss: 0.610 Vali Loss: 1.221 Vali Acc: 0.425 Test Loss: 1.221 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 1.2252120971679688
Epoch: 9, Steps: 3 | Train Loss: 0.450 Vali Loss: 1.185 Vali Acc: 0.425 Test Loss: 1.185 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 1.2825658321380615
Epoch: 10, Steps: 3 | Train Loss: 0.423 Vali Loss: 1.179 Vali Acc: 0.375 Test Loss: 1.179 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2167184352874756
Epoch: 11, Steps: 3 | Train Loss: 0.271 Vali Loss: 1.173 Vali Acc: 0.375 Test Loss: 1.173 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3756928443908691
Epoch: 12, Steps: 3 | Train Loss: 0.217 Vali Loss: 1.210 Vali Acc: 0.325 Test Loss: 1.210 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2065699100494385
Epoch: 13, Steps: 3 | Train Loss: 0.142 Vali Loss: 1.177 Vali Acc: 0.375 Test Loss: 1.177 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.170424461364746
Epoch: 14, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.135 Vali Acc: 0.450 Test Loss: 1.135 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 15 cost time: 1.1465206146240234
Epoch: 15, Steps: 3 | Train Loss: 0.090 Vali Loss: 1.093 Vali Acc: 0.525 Test Loss: 1.093 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524989).  Saving model ...
Epoch: 16 cost time: 1.1538782119750977
Epoch: 16, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.144 Vali Acc: 0.525 Test Loss: 1.144 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1652464866638184
Epoch: 17, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.236 Vali Acc: 0.525 Test Loss: 1.236 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.20829439163208
Epoch: 18, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.306870937347412
Epoch: 19, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.195 Vali Acc: 0.525 Test Loss: 1.195 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.238577127456665
Epoch: 20, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549988).  Saving model ...
Epoch: 21 cost time: 1.2174839973449707
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.172 Vali Acc: 0.525 Test Loss: 1.172 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2568690776824951
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 23 cost time: 1.2374029159545898
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.167 Vali Acc: 0.600 Test Loss: 1.167 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 1.3081724643707275
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.271569013595581
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.167 Vali Acc: 0.600 Test Loss: 1.167 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2914135456085205
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2560365200042725
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.278606653213501
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.161 Vali Acc: 0.600 Test Loss: 1.161 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 29 cost time: 1.2951037883758545
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.144 Vali Acc: 0.600 Test Loss: 1.144 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 1.263634204864502
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.625 Test Loss: 1.131 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 31 cost time: 1.4123868942260742
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.121 Vali Acc: 0.625 Test Loss: 1.121 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 32 cost time: 1.3647727966308594
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.116 Vali Acc: 0.625 Test Loss: 1.116 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 33 cost time: 1.2694506645202637
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 34 cost time: 1.3671152591705322
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 35 cost time: 1.281604290008545
Epoch: 35, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1904685497283936
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2930493354797363
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.119 Vali Acc: 0.650 Test Loss: 1.119 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.277778148651123
Epoch: 38, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1805808544158936
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.650 Test Loss: 1.130 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1500835418701172
Epoch: 40, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.133 Vali Acc: 0.650 Test Loss: 1.133 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.131676435470581
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.135 Vali Acc: 0.650 Test Loss: 1.135 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1500511169433594
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.138 Vali Acc: 0.650 Test Loss: 1.138 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1992454528808594
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2981646060943604
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.144 Vali Acc: 0.650 Test Loss: 1.144 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9762613773345947
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.501 Vali Acc: 0.250 Test Loss: 1.501 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.4163706302642822
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.479 Vali Acc: 0.200 Test Loss: 1.479 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.228379249572754
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.442 Vali Acc: 0.175 Test Loss: 1.442 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2918553352355957
Epoch: 4, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.2671825885772705
Epoch: 5, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 1.2738304138183594
Epoch: 6, Steps: 3 | Train Loss: 0.852 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.2668471336364746
Epoch: 7, Steps: 3 | Train Loss: 0.707 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.3378844261169434
Epoch: 8, Steps: 3 | Train Loss: 0.619 Vali Loss: 1.170 Vali Acc: 0.425 Test Loss: 1.170 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 1.3420684337615967
Epoch: 9, Steps: 3 | Train Loss: 0.457 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2801299095153809
Epoch: 10, Steps: 3 | Train Loss: 0.393 Vali Loss: 1.139 Vali Acc: 0.475 Test Loss: 1.139 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474989).  Saving model ...
Epoch: 11 cost time: 1.3951385021209717
Epoch: 11, Steps: 3 | Train Loss: 0.286 Vali Loss: 1.108 Vali Acc: 0.475 Test Loss: 1.108 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 12 cost time: 1.2386579513549805
Epoch: 12, Steps: 3 | Train Loss: 0.205 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.2274129390716553
Epoch: 13, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549990).  Saving model ...
Epoch: 14 cost time: 1.2807118892669678
Epoch: 14, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.989 Vali Acc: 0.575 Test Loss: 0.989 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 15 cost time: 1.2439208030700684
Epoch: 15, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.933 Vali Acc: 0.625 Test Loss: 0.933 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624991).  Saving model ...
Epoch: 16 cost time: 1.4708006381988525
Epoch: 16, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.949 Vali Acc: 0.575 Test Loss: 0.949 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2341039180755615
Epoch: 17, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.001 Vali Acc: 0.525 Test Loss: 1.001 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3970844745635986
Epoch: 18, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.012 Vali Acc: 0.525 Test Loss: 1.012 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3132832050323486
Epoch: 19, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.038 Vali Acc: 0.525 Test Loss: 1.038 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3303050994873047
Epoch: 20, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.029 Vali Acc: 0.525 Test Loss: 1.029 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3717291355133057
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.023 Vali Acc: 0.525 Test Loss: 1.023 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4565911293029785
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.006 Vali Acc: 0.550 Test Loss: 1.006 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3772337436676025
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.991 Vali Acc: 0.550 Test Loss: 0.991 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3320703506469727
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.983 Vali Acc: 0.550 Test Loss: 0.983 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.32558274269104
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9648091793060303
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3916003704071045
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2462596893310547
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1960487365722656
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.434051513671875
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3922910690307617
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.241518259048462
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1505913734436035
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.349135398864746
Epoch: 9, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.2580807209014893
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1851084232330322
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1665899753570557
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3108539581298828
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2715301513671875
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.130371332168579
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0702567100524902
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1169517040252686
Epoch: 17, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1494426727294922
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2012617588043213
Epoch: 19, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 5657348
model size : 31.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7370994091033936
Epoch: 1, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (inf --> -0.474988).  Saving model ...
Epoch: 2 cost time: 1.3457260131835938
Epoch: 2, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.148 Vali Acc: 0.650 Test Loss: 1.148 Test Acc: 0.650
Validation loss decreased (-0.474988 --> -0.649989).  Saving model ...
Epoch: 3 cost time: 1.5176024436950684
Epoch: 3, Steps: 3 | Train Loss: 1.086 Vali Loss: 0.965 Vali Acc: 0.775 Test Loss: 0.965 Test Acc: 0.775
Validation loss decreased (-0.649989 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 1.4547314643859863
Epoch: 4, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 1.3376295566558838
Epoch: 5, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.642 Vali Acc: 0.925 Test Loss: 0.642 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924994).  Saving model ...
Epoch: 6 cost time: 1.2922282218933105
Epoch: 6, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2785582542419434
Epoch: 7, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3822181224822998
Epoch: 8, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5580804347991943
Epoch: 9, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5849204063415527
Epoch: 10, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3419854640960693
Epoch: 11, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3526394367218018
Epoch: 12, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.385679006576538
Epoch: 13, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 1.1404740810394287
Epoch: 14, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 1.3134617805480957
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.275048017501831
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2311162948608398
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.900 Test Loss: 0.263 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.244704008102417
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2728188037872314
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 1.23818039894104
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.925 Test Loss: 0.263 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2983293533325195
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.292572259902954
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2905688285827637
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.2512030601501465
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3586571216583252
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2306618690490723
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1826896667480469
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2333269119262695
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3512451648712158
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3319857120513916
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2601628303527832
Epoch: 31, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2177391052246094
Epoch: 32, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3419129848480225
Epoch: 33, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9065616130828857
Epoch: 1, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.245 Vali Acc: 0.425 Test Loss: 1.245 Test Acc: 0.425
Validation loss decreased (inf --> -0.424988).  Saving model ...
Epoch: 2 cost time: 1.3225352764129639
Epoch: 2, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.155 Vali Acc: 0.600 Test Loss: 1.155 Test Acc: 0.600
Validation loss decreased (-0.424988 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.280935525894165
Epoch: 3, Steps: 3 | Train Loss: 1.079 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 1.449394941329956
Epoch: 4, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.649990 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 1.4104042053222656
Epoch: 5, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.664 Vali Acc: 0.800 Test Loss: 0.664 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4265265464782715
Epoch: 6, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.367039442062378
Epoch: 7, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.3222968578338623
Epoch: 8, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 1.278027057647705
Epoch: 9, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 1.3042807579040527
Epoch: 10, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 1.2529828548431396
Epoch: 11, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.3770689964294434
Epoch: 12, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 1.197087287902832
Epoch: 13, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3213458061218262
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1987276077270508
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 1.3142178058624268
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4172673225402832
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3352768421173096
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.3204383850097656
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3169093132019043
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4082164764404297
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4409844875335693
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2710504531860352
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5679681301116943
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5561511516571045
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2683348655700684
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2929418087005615
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.319748878479004
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.910282850265503
Epoch: 1, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.213 Vali Acc: 0.475 Test Loss: 1.213 Test Acc: 0.475
Validation loss decreased (inf --> -0.474988).  Saving model ...
Epoch: 2 cost time: 1.2770109176635742
Epoch: 2, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.130 Vali Acc: 0.525 Test Loss: 1.130 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524989).  Saving model ...
Epoch: 3 cost time: 1.2753589153289795
Epoch: 3, Steps: 3 | Train Loss: 1.056 Vali Loss: 0.961 Vali Acc: 0.675 Test Loss: 0.961 Test Acc: 0.675
Validation loss decreased (-0.524989 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 1.306248426437378
Epoch: 4, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.802 Vali Acc: 0.875 Test Loss: 0.802 Test Acc: 0.875
Validation loss decreased (-0.674990 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 1.3844354152679443
Epoch: 5, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.659 Vali Acc: 0.900 Test Loss: 0.659 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 1.3521583080291748
Epoch: 6, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.566 Vali Acc: 0.925 Test Loss: 0.566 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 1.2780160903930664
Epoch: 7, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 1.2745654582977295
Epoch: 8, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 1.3165407180786133
Epoch: 9, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.435 Vali Acc: 0.950 Test Loss: 0.435 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 1.319171667098999
Epoch: 10, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3436555862426758
Epoch: 11, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3315634727478027
Epoch: 12, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2248477935791016
Epoch: 13, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1159660816192627
Epoch: 14, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2157588005065918
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.285846471786499
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2339529991149902
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2215917110443115
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2632672786712646
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.566941499710083
Epoch: 1, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.253 Vali Acc: 0.600 Test Loss: 1.253 Test Acc: 0.600
Validation loss decreased (inf --> -0.599987).  Saving model ...
Epoch: 2 cost time: 1.217534065246582
Epoch: 2, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.157 Vali Acc: 0.625 Test Loss: 1.157 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 1.2423434257507324
Epoch: 3, Steps: 3 | Train Loss: 1.102 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
Validation loss decreased (-0.624988 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 1.097580909729004
Epoch: 4, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 1.291311264038086
Epoch: 5, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.682 Vali Acc: 0.825 Test Loss: 0.682 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 1.2148826122283936
Epoch: 6, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 7 cost time: 1.424830436706543
Epoch: 7, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.431614875793457
Epoch: 8, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.497 Vali Acc: 0.800 Test Loss: 0.497 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4085040092468262
Epoch: 9, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.479 Vali Acc: 0.775 Test Loss: 0.479 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2756149768829346
Epoch: 10, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.471 Vali Acc: 0.775 Test Loss: 0.471 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3833589553833008
Epoch: 11, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.454 Vali Acc: 0.775 Test Loss: 0.454 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4494209289550781
Epoch: 12, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.434 Vali Acc: 0.825 Test Loss: 0.434 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824996).  Saving model ...
Epoch: 13 cost time: 1.2724530696868896
Epoch: 13, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.421 Vali Acc: 0.825 Test Loss: 0.421 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 14 cost time: 1.4584898948669434
Epoch: 14, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.413 Vali Acc: 0.825 Test Loss: 0.413 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 15 cost time: 1.6991946697235107
Epoch: 15, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.406 Vali Acc: 0.825 Test Loss: 0.406 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 16 cost time: 1.6210968494415283
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.402 Vali Acc: 0.825 Test Loss: 0.402 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 17 cost time: 1.5376412868499756
Epoch: 17, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.825 Test Loss: 0.399 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 18 cost time: 1.453700065612793
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
Validation loss decreased (-0.824996 --> -0.849996).  Saving model ...
Epoch: 19 cost time: 1.3180832862854004
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 20 cost time: 1.4409794807434082
Epoch: 20, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4424595832824707
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3434178829193115
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3910741806030273
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3036134243011475
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.364583969116211
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3037946224212646
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.404775619506836
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2977538108825684
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2900879383087158
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9478960037231445
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.235 Vali Acc: 0.425 Test Loss: 1.235 Test Acc: 0.425
Validation loss decreased (inf --> -0.424988).  Saving model ...
Epoch: 2 cost time: 1.418976068496704
Epoch: 2, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.154 Vali Acc: 0.575 Test Loss: 1.154 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 1.2285573482513428
Epoch: 3, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.3272380828857422
Epoch: 4, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.868 Vali Acc: 0.850 Test Loss: 0.868 Test Acc: 0.850
Validation loss decreased (-0.699990 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 1.3602125644683838
Epoch: 5, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849993).  Saving model ...
Epoch: 6 cost time: 1.385263204574585
Epoch: 6, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.648 Vali Acc: 0.825 Test Loss: 0.648 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3342690467834473
Epoch: 7, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3229460716247559
Epoch: 8, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2837133407592773
Epoch: 9, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.539 Vali Acc: 0.800 Test Loss: 0.539 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3336575031280518
Epoch: 10, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.531 Vali Acc: 0.800 Test Loss: 0.531 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2766470909118652
Epoch: 11, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3167705535888672
Epoch: 12, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.435636043548584
Epoch: 13, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.536 Vali Acc: 0.775 Test Loss: 0.536 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2836921215057373
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.542 Vali Acc: 0.775 Test Loss: 0.542 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3835184574127197
Epoch: 15, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5620224475860596
Epoch: 1, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.2333729267120361
Epoch: 2, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 1.126192331314087
Epoch: 3, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.248 Vali Acc: 0.475 Test Loss: 1.248 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 1.1485264301300049
Epoch: 4, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.186 Vali Acc: 0.525 Test Loss: 1.186 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.0656743049621582
Epoch: 5, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.122584581375122
Epoch: 6, Steps: 3 | Train Loss: 0.745 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 1.1240785121917725
Epoch: 7, Steps: 3 | Train Loss: 0.568 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1723995208740234
Epoch: 8, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.995 Vali Acc: 0.675 Test Loss: 0.995 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1860170364379883
Epoch: 9, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.972 Vali Acc: 0.650 Test Loss: 0.972 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1769373416900635
Epoch: 10, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.943 Vali Acc: 0.675 Test Loss: 0.943 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0918681621551514
Epoch: 11, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 1.2075891494750977
Epoch: 12, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.854 Vali Acc: 0.725 Test Loss: 0.854 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 1.1582908630371094
Epoch: 13, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.851 Vali Acc: 0.725 Test Loss: 0.851 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 1.3558127880096436
Epoch: 14, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 1.175020694732666
Epoch: 15, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 1.2500555515289307
Epoch: 16, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 1.1308073997497559
Epoch: 17, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.823 Vali Acc: 0.775 Test Loss: 0.823 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 18 cost time: 1.2181642055511475
Epoch: 18, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 1.1613764762878418
Epoch: 19, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 1.1680762767791748
Epoch: 20, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.297720193862915
Epoch: 21, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.2245862483978271
Epoch: 22, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 23 cost time: 1.2812159061431885
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 24 cost time: 1.2260127067565918
Epoch: 24, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2469696998596191
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 26 cost time: 1.3169434070587158
Epoch: 26, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 27 cost time: 1.363917350769043
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 28 cost time: 1.2443957328796387
Epoch: 28, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 29 cost time: 1.2746829986572266
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.775 Test Loss: 0.806 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3558752536773682
Epoch: 30, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2495465278625488
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.189032793045044
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3909733295440674
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2814390659332275
Epoch: 34, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4004619121551514
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.830 Vali Acc: 0.775 Test Loss: 0.830 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2583949565887451
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2624733448028564
Epoch: 37, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1987102031707764
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4705028533935547
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.396 Vali Acc: 0.300 Test Loss: 1.396 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.2035224437713623
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.376 Vali Acc: 0.300 Test Loss: 1.376 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.3068418502807617
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.323 Vali Acc: 0.275 Test Loss: 1.323 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1181907653808594
Epoch: 4, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.287 Vali Acc: 0.275 Test Loss: 1.287 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1536688804626465
Epoch: 5, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.244 Vali Acc: 0.375 Test Loss: 1.244 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 1.1690218448638916
Epoch: 6, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.209 Vali Acc: 0.425 Test Loss: 1.209 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 1.1537134647369385
Epoch: 7, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.172 Vali Acc: 0.425 Test Loss: 1.172 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.1311562061309814
Epoch: 8, Steps: 3 | Train Loss: 0.633 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.1520819664001465
Epoch: 9, Steps: 3 | Train Loss: 0.472 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.220823049545288
Epoch: 10, Steps: 3 | Train Loss: 0.385 Vali Loss: 1.100 Vali Acc: 0.475 Test Loss: 1.100 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2223336696624756
Epoch: 11, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.083 Vali Acc: 0.475 Test Loss: 1.083 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1755943298339844
Epoch: 12, Steps: 3 | Train Loss: 0.230 Vali Loss: 1.055 Vali Acc: 0.525 Test Loss: 1.055 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 13 cost time: 1.2213332653045654
Epoch: 13, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1017754077911377
Epoch: 14, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.056 Vali Acc: 0.500 Test Loss: 1.056 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2106688022613525
Epoch: 15, Steps: 3 | Train Loss: 0.093 Vali Loss: 1.059 Vali Acc: 0.525 Test Loss: 1.059 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1854393482208252
Epoch: 16, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 1.1966307163238525
Epoch: 17, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.078 Vali Acc: 0.525 Test Loss: 1.078 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3175585269927979
Epoch: 18, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.085 Vali Acc: 0.525 Test Loss: 1.085 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3174021244049072
Epoch: 19, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.055 Vali Acc: 0.550 Test Loss: 1.055 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 1.3439748287200928
Epoch: 20, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.003 Vali Acc: 0.575 Test Loss: 1.003 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574990).  Saving model ...
Epoch: 21 cost time: 1.2092597484588623
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.974 Vali Acc: 0.600 Test Loss: 0.974 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 1.2062931060791016
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.960 Vali Acc: 0.600 Test Loss: 0.960 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 1.287872552871704
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.970 Vali Acc: 0.625 Test Loss: 0.970 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 1.306713342666626
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 25 cost time: 1.2812576293945312
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.042 Vali Acc: 0.650 Test Loss: 1.042 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.324690341949463
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.067 Vali Acc: 0.650 Test Loss: 1.067 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2822973728179932
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3528149127960205
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.091 Vali Acc: 0.575 Test Loss: 1.091 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2779426574707031
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.080 Vali Acc: 0.625 Test Loss: 1.080 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4577760696411133
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3493866920471191
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 32 cost time: 1.2823691368103027
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 33 cost time: 1.285060167312622
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 34 cost time: 1.1903390884399414
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.995 Vali Acc: 0.700 Test Loss: 0.995 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 35 cost time: 1.3238372802734375
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.996 Vali Acc: 0.700 Test Loss: 0.996 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3347618579864502
Epoch: 36, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3144526481628418
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.700 Test Loss: 1.006 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3600564002990723
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3246088027954102
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.232947587966919
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.050 Vali Acc: 0.700 Test Loss: 1.050 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2049884796142578
Epoch: 41, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2592012882232666
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.069 Vali Acc: 0.700 Test Loss: 1.069 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2346904277801514
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.240668535232544
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.700 Test Loss: 1.074 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6024343967437744
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.389 Vali Acc: 0.300 Test Loss: 1.389 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.2380263805389404
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.372 Vali Acc: 0.250 Test Loss: 1.372 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3031141757965088
Epoch: 3, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.3390552997589111
Epoch: 4, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.290 Vali Acc: 0.450 Test Loss: 1.290 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.2612626552581787
Epoch: 5, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3419890403747559
Epoch: 6, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.306565523147583
Epoch: 7, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.2103590965270996
Epoch: 8, Steps: 3 | Train Loss: 0.603 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 1.3527989387512207
Epoch: 9, Steps: 3 | Train Loss: 0.466 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 1.2342259883880615
Epoch: 10, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.3016762733459473
Epoch: 11, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.030 Vali Acc: 0.575 Test Loss: 1.030 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2601799964904785
Epoch: 12, Steps: 3 | Train Loss: 0.197 Vali Loss: 1.014 Vali Acc: 0.575 Test Loss: 1.014 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.23773193359375
Epoch: 13, Steps: 3 | Train Loss: 0.149 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.2616546154022217
Epoch: 14, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 1.2384848594665527
Epoch: 15, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.948 Vali Acc: 0.600 Test Loss: 0.948 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599991).  Saving model ...
Epoch: 16 cost time: 1.3642263412475586
Epoch: 16, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 17 cost time: 1.311661958694458
Epoch: 17, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.599991 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 1.1867046356201172
Epoch: 18, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.155543327331543
Epoch: 19, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1799850463867188
Epoch: 20, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.988 Vali Acc: 0.625 Test Loss: 0.988 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2250068187713623
Epoch: 21, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.948 Vali Acc: 0.650 Test Loss: 0.948 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 22 cost time: 1.2763302326202393
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.903 Vali Acc: 0.650 Test Loss: 0.903 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 23 cost time: 1.1717097759246826
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.890 Vali Acc: 0.725 Test Loss: 0.890 Test Acc: 0.725
Validation loss decreased (-0.649991 --> -0.724991).  Saving model ...
Epoch: 24 cost time: 1.1786799430847168
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.894 Vali Acc: 0.700 Test Loss: 0.894 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1823649406433105
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.700 Test Loss: 0.904 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1958627700805664
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.193786382675171
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.936 Vali Acc: 0.700 Test Loss: 0.936 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2235209941864014
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.955 Vali Acc: 0.700 Test Loss: 0.955 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.263326644897461
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.968 Vali Acc: 0.700 Test Loss: 0.968 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2863671779632568
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.971 Vali Acc: 0.700 Test Loss: 0.971 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.321491003036499
Epoch: 31, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1420190334320068
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2078347206115723
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0649611949920654
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.506152868270874
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.3251869678497314
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.3564631938934326
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.2816646099090576
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.451369047164917
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.4526710510253906
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.513678789138794
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.4511218070983887
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3319413661956787
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2717337608337402
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3453502655029297
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5315797328948975
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1823325157165527
Epoch: 14, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2137761116027832
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.3645927906036377
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 17 cost time: 1.2583205699920654
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 18 cost time: 1.370495319366455
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 19 cost time: 1.3419020175933838
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 20 cost time: 1.249119758605957
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 21 cost time: 1.2357230186462402
Epoch: 21, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 22 cost time: 1.2537050247192383
Epoch: 22, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2531657218933105
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.4885509014129639
Epoch: 24, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 25 cost time: 1.4272234439849854
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 26 cost time: 1.4401490688323975
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2591400146484375
Epoch: 27, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3181171417236328
Epoch: 28, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3182787895202637
Epoch: 29, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3192975521087646
Epoch: 30, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6483075618743896
Epoch: 31, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4844722747802734
Epoch: 32, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5430283546447754
Epoch: 33, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3309822082519531
Epoch: 34, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2677080631256104
Epoch: 35, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 4084484
model size : 25.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7102882862091064
Epoch: 1, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.215 Vali Acc: 0.525 Test Loss: 1.215 Test Acc: 0.525
Validation loss decreased (inf --> -0.524988).  Saving model ...
Epoch: 2 cost time: 1.2458200454711914
Epoch: 2, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
Validation loss decreased (-0.524988 --> -0.674989).  Saving model ...
Epoch: 3 cost time: 1.240706443786621
Epoch: 3, Steps: 3 | Train Loss: 1.077 Vali Loss: 0.971 Vali Acc: 0.825 Test Loss: 0.971 Test Acc: 0.825
Validation loss decreased (-0.674989 --> -0.824990).  Saving model ...
Epoch: 4 cost time: 1.1246256828308105
Epoch: 4, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.800 Vali Acc: 0.900 Test Loss: 0.800 Test Acc: 0.900
Validation loss decreased (-0.824990 --> -0.899992).  Saving model ...
Epoch: 5 cost time: 1.2364215850830078
Epoch: 5, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899994).  Saving model ...
Epoch: 6 cost time: 1.1877870559692383
Epoch: 6, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.507 Vali Acc: 0.925 Test Loss: 0.507 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 7 cost time: 1.2870101928710938
Epoch: 7, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 1.126612663269043
Epoch: 8, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 1.2066636085510254
Epoch: 9, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 1.2169764041900635
Epoch: 10, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 1.1552248001098633
Epoch: 11, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 1.2564492225646973
Epoch: 12, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 1.2171344757080078
Epoch: 13, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 1.2363402843475342
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 1.218151569366455
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 1.1974918842315674
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 1.2480595111846924
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 1.2380008697509766
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 1.3497250080108643
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2498226165771484
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1335594654083252
Epoch: 21, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1868598461151123
Epoch: 22, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.172926902770996
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1151866912841797
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1842763423919678
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3443138599395752
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3097670078277588
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3519816398620605
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7040140628814697
Epoch: 1, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.186 Vali Acc: 0.625 Test Loss: 1.186 Test Acc: 0.625
Validation loss decreased (inf --> -0.624988).  Saving model ...
Epoch: 2 cost time: 1.3222975730895996
Epoch: 2, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.098 Vali Acc: 0.675 Test Loss: 1.098 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 3 cost time: 1.3381404876708984
Epoch: 3, Steps: 3 | Train Loss: 1.052 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774991).  Saving model ...
Epoch: 4 cost time: 1.3040800094604492
Epoch: 4, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.779 Vali Acc: 0.875 Test Loss: 0.779 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 1.3692374229431152
Epoch: 5, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.629 Vali Acc: 0.925 Test Loss: 0.629 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924994).  Saving model ...
Epoch: 6 cost time: 1.3438022136688232
Epoch: 6, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.505 Vali Acc: 0.925 Test Loss: 0.505 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 7 cost time: 1.3091211318969727
Epoch: 7, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 8 cost time: 1.3514387607574463
Epoch: 8, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 1.195573329925537
Epoch: 9, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 1.2612926959991455
Epoch: 10, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 1.243788480758667
Epoch: 11, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 1.2861573696136475
Epoch: 12, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3343186378479004
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.175229787826538
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2722642421722412
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1384804248809814
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1559531688690186
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1709511280059814
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2758991718292236
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2467608451843262
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.305145025253296
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.307032346725464
Epoch: 1, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 1.1458275318145752
Epoch: 2, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.087 Vali Acc: 0.575 Test Loss: 1.087 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 3 cost time: 1.1751611232757568
Epoch: 3, Steps: 3 | Train Loss: 1.016 Vali Loss: 0.944 Vali Acc: 0.800 Test Loss: 0.944 Test Acc: 0.800
Validation loss decreased (-0.574989 --> -0.799991).  Saving model ...
Epoch: 4 cost time: 1.1952579021453857
Epoch: 4, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 1.1491897106170654
Epoch: 5, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.648 Vali Acc: 0.925 Test Loss: 0.648 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924994).  Saving model ...
Epoch: 6 cost time: 1.175008773803711
Epoch: 6, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.531 Vali Acc: 0.925 Test Loss: 0.531 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 7 cost time: 1.1870183944702148
Epoch: 7, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.453 Vali Acc: 0.950 Test Loss: 0.453 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 1.269151210784912
Epoch: 8, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 1.253126621246338
Epoch: 9, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 1.3314855098724365
Epoch: 10, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 1.27602219581604
Epoch: 11, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2354273796081543
Epoch: 12, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3547148704528809
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2292609214782715
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.320723056793213
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2695002555847168
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.262627124786377
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2753982543945312
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2187881469726562
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1352877616882324
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.565697431564331
Epoch: 1, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.148 Vali Acc: 0.650 Test Loss: 1.148 Test Acc: 0.650
Validation loss decreased (inf --> -0.649989).  Saving model ...
Epoch: 2 cost time: 1.3264546394348145
Epoch: 2, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.058 Vali Acc: 0.725 Test Loss: 1.058 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724989).  Saving model ...
Epoch: 3 cost time: 1.1586649417877197
Epoch: 3, Steps: 3 | Train Loss: 1.057 Vali Loss: 0.913 Vali Acc: 0.825 Test Loss: 0.913 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824991).  Saving model ...
Epoch: 4 cost time: 1.193957805633545
Epoch: 4, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 1.3088250160217285
Epoch: 5, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 6 cost time: 1.2988600730895996
Epoch: 6, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.2086074352264404
Epoch: 7, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.374241828918457
Epoch: 8, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 1.2558493614196777
Epoch: 9, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 1.3454883098602295
Epoch: 10, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.204218864440918
Epoch: 11, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.377 Vali Acc: 0.825 Test Loss: 0.377 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3564350605010986
Epoch: 12, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.372 Vali Acc: 0.800 Test Loss: 0.372 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4706692695617676
Epoch: 13, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.366 Vali Acc: 0.800 Test Loss: 0.366 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2237732410430908
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.363 Vali Acc: 0.825 Test Loss: 0.363 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2064080238342285
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.364 Vali Acc: 0.800 Test Loss: 0.364 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3643312454223633
Epoch: 16, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.800 Test Loss: 0.363 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3823003768920898
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.359 Vali Acc: 0.800 Test Loss: 0.359 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4022231101989746
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.357 Vali Acc: 0.825 Test Loss: 0.357 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4363071918487549
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.825 Test Loss: 0.355 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.722003698348999
Epoch: 1, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.177 Vali Acc: 0.600 Test Loss: 1.177 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 1.2577009201049805
Epoch: 2, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 3 cost time: 1.1819744110107422
Epoch: 3, Steps: 3 | Train Loss: 1.058 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 1.1936278343200684
Epoch: 4, Steps: 3 | Train Loss: 0.866 Vali Loss: 0.843 Vali Acc: 0.825 Test Loss: 0.843 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 1.2055275440216064
Epoch: 5, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.725 Vali Acc: 0.825 Test Loss: 0.725 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 1.304072618484497
Epoch: 6, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.1221575736999512
Epoch: 7, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 1.182053565979004
Epoch: 8, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.156721830368042
Epoch: 9, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1459054946899414
Epoch: 10, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.145745038986206
Epoch: 11, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.153106451034546
Epoch: 12, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.484 Vali Acc: 0.800 Test Loss: 0.484 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2214035987854004
Epoch: 13, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.503 Vali Acc: 0.775 Test Loss: 0.503 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2495148181915283
Epoch: 14, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.496 Vali Acc: 0.800 Test Loss: 0.496 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3176743984222412
Epoch: 15, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.491 Vali Acc: 0.800 Test Loss: 0.491 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2433807849884033
Epoch: 16, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.800 Test Loss: 0.492 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.280259370803833
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.491 Vali Acc: 0.825 Test Loss: 0.491 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3366336822509766
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.494 Vali Acc: 0.825 Test Loss: 0.494 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7654225826263428
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.3489797115325928
Epoch: 2, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 1.2909226417541504
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.270 Vali Acc: 0.425 Test Loss: 1.270 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.3077757358551025
Epoch: 4, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.216 Vali Acc: 0.475 Test Loss: 1.216 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 1.4077937602996826
Epoch: 5, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.160 Vali Acc: 0.525 Test Loss: 1.160 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 1.2344224452972412
Epoch: 6, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.113 Vali Acc: 0.575 Test Loss: 1.113 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 1.2009506225585938
Epoch: 7, Steps: 3 | Train Loss: 0.614 Vali Loss: 1.061 Vali Acc: 0.625 Test Loss: 1.061 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.6295793056488037
Epoch: 8, Steps: 3 | Train Loss: 0.510 Vali Loss: 1.016 Vali Acc: 0.675 Test Loss: 1.016 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 1.139676570892334
Epoch: 9, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.972 Vali Acc: 0.725 Test Loss: 0.972 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 1.3419456481933594
Epoch: 10, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.418196201324463
Epoch: 11, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.2946417331695557
Epoch: 12, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3571112155914307
Epoch: 13, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 1.2977559566497803
Epoch: 14, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.853 Vali Acc: 0.800 Test Loss: 0.853 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 1.2120108604431152
Epoch: 15, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2378947734832764
Epoch: 16, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.839 Vali Acc: 0.775 Test Loss: 0.839 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2802600860595703
Epoch: 17, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.3964197635650635
Epoch: 18, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.790 Vali Acc: 0.800 Test Loss: 0.790 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.2341828346252441
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4520025253295898
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.799 Vali Acc: 0.775 Test Loss: 0.799 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2929441928863525
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2799222469329834
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.488281488418579
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2212412357330322
Epoch: 24, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.109687328338623
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1964802742004395
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2206220626831055
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1510112285614014
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5874598026275635
Epoch: 1, Steps: 3 | Train Loss: 1.489 Vali Loss: 1.371 Vali Acc: 0.350 Test Loss: 1.371 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.193248987197876
Epoch: 2, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.353 Vali Acc: 0.375 Test Loss: 1.353 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.2515344619750977
Epoch: 3, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.3327701091766357
Epoch: 4, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.273 Vali Acc: 0.450 Test Loss: 1.273 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.2097718715667725
Epoch: 5, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.2323572635650635
Epoch: 6, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.204 Vali Acc: 0.525 Test Loss: 1.204 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.2500412464141846
Epoch: 7, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.163 Vali Acc: 0.525 Test Loss: 1.163 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 1.3252153396606445
Epoch: 8, Steps: 3 | Train Loss: 0.650 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.2612898349761963
Epoch: 9, Steps: 3 | Train Loss: 0.548 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.2294883728027344
Epoch: 10, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.050 Vali Acc: 0.500 Test Loss: 1.050 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3121073246002197
Epoch: 11, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.051 Vali Acc: 0.475 Test Loss: 1.051 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2103111743927002
Epoch: 12, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2378880977630615
Epoch: 13, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.033 Vali Acc: 0.500 Test Loss: 1.033 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3557891845703125
Epoch: 14, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1980676651000977
Epoch: 15, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2996742725372314
Epoch: 16, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.050 Vali Acc: 0.575 Test Loss: 1.050 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5352740287780762
Epoch: 17, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.365917682647705
Epoch: 18, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3132851123809814
Epoch: 19, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.997 Vali Acc: 0.625 Test Loss: 0.997 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 20 cost time: 1.3217246532440186
Epoch: 20, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2300705909729004
Epoch: 21, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.061 Vali Acc: 0.650 Test Loss: 1.061 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649989).  Saving model ...
Epoch: 22 cost time: 1.2193963527679443
Epoch: 22, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 23 cost time: 1.1793229579925537
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.027 Vali Acc: 0.650 Test Loss: 1.027 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 24 cost time: 1.276474952697754
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 25 cost time: 1.193345546722412
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.008 Vali Acc: 0.675 Test Loss: 1.008 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.251084566116333
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.016 Vali Acc: 0.675 Test Loss: 1.016 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.185962200164795
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.031 Vali Acc: 0.675 Test Loss: 1.031 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1861586570739746
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 29 cost time: 1.2403068542480469
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.060 Vali Acc: 0.700 Test Loss: 1.060 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4575259685516357
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.700 Test Loss: 1.049 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2367804050445557
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 32 cost time: 1.1796441078186035
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.020 Vali Acc: 0.725 Test Loss: 1.020 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 33 cost time: 1.133634328842163
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1850690841674805
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.987 Vali Acc: 0.725 Test Loss: 0.987 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 35 cost time: 1.173232078552246
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 36 cost time: 1.2975597381591797
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2078258991241455
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2065656185150146
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.725 Test Loss: 1.011 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1607463359832764
Epoch: 39, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.025 Vali Acc: 0.750 Test Loss: 1.025 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 40 cost time: 1.170778751373291
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.775 Test Loss: 1.039 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 41 cost time: 1.1621105670928955
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.725 Test Loss: 1.055 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2775969505310059
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.725 Test Loss: 1.068 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3930690288543701
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.700 Test Loss: 1.075 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.354133129119873
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.700 Test Loss: 1.082 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3544137477874756
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.700 Test Loss: 1.091 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3430438041687012
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2068936824798584
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.700 Test Loss: 1.100 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2816948890686035
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.700 Test Loss: 1.104 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2435972690582275
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.2422428131103516
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.115 Vali Acc: 0.725 Test Loss: 1.115 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5509815216064453
Epoch: 1, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.417 Vali Acc: 0.275 Test Loss: 1.417 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.3288168907165527
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.393 Vali Acc: 0.325 Test Loss: 1.393 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.2597570419311523
Epoch: 3, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.344 Vali Acc: 0.375 Test Loss: 1.344 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.3132898807525635
Epoch: 4, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.1246919631958008
Epoch: 5, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.2199759483337402
Epoch: 6, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.192 Vali Acc: 0.525 Test Loss: 1.192 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.3947358131408691
Epoch: 7, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 1.3210318088531494
Epoch: 8, Steps: 3 | Train Loss: 0.576 Vali Loss: 1.093 Vali Acc: 0.575 Test Loss: 1.093 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.1648533344268799
Epoch: 9, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.067 Vali Acc: 0.625 Test Loss: 1.067 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.2892913818359375
Epoch: 10, Steps: 3 | Train Loss: 0.365 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2675390243530273
Epoch: 11, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.017 Vali Acc: 0.575 Test Loss: 1.017 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2382786273956299
Epoch: 12, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.247023105621338
Epoch: 13, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.941 Vali Acc: 0.600 Test Loss: 0.941 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.118121862411499
Epoch: 14, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.944 Vali Acc: 0.600 Test Loss: 0.944 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.290173053741455
Epoch: 15, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.988 Vali Acc: 0.575 Test Loss: 0.988 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2442655563354492
Epoch: 16, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3386924266815186
Epoch: 17, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.930 Vali Acc: 0.575 Test Loss: 0.930 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2265024185180664
Epoch: 18, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.893 Vali Acc: 0.625 Test Loss: 0.893 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624991).  Saving model ...
Epoch: 19 cost time: 1.1923794746398926
Epoch: 19, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.877 Vali Acc: 0.650 Test Loss: 0.877 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 20 cost time: 1.261857271194458
Epoch: 20, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.883 Vali Acc: 0.675 Test Loss: 0.883 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 21 cost time: 1.399043083190918
Epoch: 21, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.915 Vali Acc: 0.675 Test Loss: 0.915 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4413812160491943
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.931 Vali Acc: 0.650 Test Loss: 0.931 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4611234664916992
Epoch: 23, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.942 Vali Acc: 0.625 Test Loss: 0.942 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4510300159454346
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3421311378479004
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.938 Vali Acc: 0.625 Test Loss: 0.938 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2330801486968994
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.941 Vali Acc: 0.625 Test Loss: 0.941 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5903632640838623
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.951 Vali Acc: 0.625 Test Loss: 0.951 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5660855770111084
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.965 Vali Acc: 0.650 Test Loss: 0.965 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4515869617462158
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.464482069015503
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.974 Vali Acc: 0.650 Test Loss: 0.974 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6229355335235596
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1809768676757812
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2039093971252441
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.3692779541015625
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.2226781845092773
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.2055418491363525
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.1705527305603027
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.186166524887085
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.1044111251831055
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.1363792419433594
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 1.1041686534881592
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.077240228652954
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.216015338897705
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.224005937576294
Epoch: 14, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.1054103374481201
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0781073570251465
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2046833038330078
Epoch: 17, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0739991664886475
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1031544208526611
Epoch: 19, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1776738166809082
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1134955883026123
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2265803813934326
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1911885738372803
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2334864139556885
Epoch: 24, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 3298052
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.73142409324646
Epoch: 1, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.231 Vali Acc: 0.425 Test Loss: 1.231 Test Acc: 0.425
Validation loss decreased (inf --> -0.424988).  Saving model ...
Epoch: 2 cost time: 1.2752842903137207
Epoch: 2, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.136 Vali Acc: 0.575 Test Loss: 1.136 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574989).  Saving model ...
Epoch: 3 cost time: 1.2771873474121094
Epoch: 3, Steps: 3 | Train Loss: 1.078 Vali Loss: 0.960 Vali Acc: 0.850 Test Loss: 0.960 Test Acc: 0.850
Validation loss decreased (-0.574989 --> -0.849990).  Saving model ...
Epoch: 4 cost time: 1.4749436378479004
Epoch: 4, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.782 Vali Acc: 0.875 Test Loss: 0.782 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 1.3296465873718262
Epoch: 5, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874994).  Saving model ...
Epoch: 6 cost time: 1.3071496486663818
Epoch: 6, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 7 cost time: 1.4809188842773438
Epoch: 7, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.874995 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 1.3177897930145264
Epoch: 8, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 1.2774510383605957
Epoch: 9, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 1.30936861038208
Epoch: 10, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 11 cost time: 1.27028226852417
Epoch: 11, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 12 cost time: 1.4058387279510498
Epoch: 12, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3244295120239258
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.327604055404663
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.306415319442749
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3150269985198975
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 1.4912207126617432
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 1.2818403244018555
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.353226661682129
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3283748626708984
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.213059425354004
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2995176315307617
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3358190059661865
Epoch: 23, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4639556407928467
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.269148349761963
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.494842529296875
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.673039197921753
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3739333152770996
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3994228839874268
Epoch: 29, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5726029872894287
Epoch: 30, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0472583770751953
Epoch: 1, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.241 Vali Acc: 0.450 Test Loss: 1.241 Test Acc: 0.450
Validation loss decreased (inf --> -0.449988).  Saving model ...
Epoch: 2 cost time: 1.4702391624450684
Epoch: 2, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.148 Vali Acc: 0.525 Test Loss: 1.148 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 3 cost time: 1.485386848449707
Epoch: 3, Steps: 3 | Train Loss: 1.072 Vali Loss: 0.976 Vali Acc: 0.775 Test Loss: 0.976 Test Acc: 0.775
Validation loss decreased (-0.524989 --> -0.774990).  Saving model ...
Epoch: 4 cost time: 1.5621302127838135
Epoch: 4, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.803 Vali Acc: 0.850 Test Loss: 0.803 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849992).  Saving model ...
Epoch: 5 cost time: 1.223865270614624
Epoch: 5, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.668 Vali Acc: 0.925 Test Loss: 0.668 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 6 cost time: 1.2350006103515625
Epoch: 6, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 1.3845319747924805
Epoch: 7, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1764702796936035
Epoch: 8, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 9 cost time: 1.370224952697754
Epoch: 9, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 1.2599756717681885
Epoch: 10, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 1.3652594089508057
Epoch: 11, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 1.1946971416473389
Epoch: 12, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 1.4488661289215088
Epoch: 13, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1558094024658203
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2655525207519531
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2395298480987549
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.376591682434082
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1680564880371094
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 1.283250331878662
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2191195487976074
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5227065086364746
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2680208683013916
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3856205940246582
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2962596416473389
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3427338600158691
Epoch: 25, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3920109272003174
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3761780261993408
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4377186298370361
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.936807155609131
Epoch: 1, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (inf --> -0.549988).  Saving model ...
Epoch: 2 cost time: 1.3339171409606934
Epoch: 2, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.127 Vali Acc: 0.600 Test Loss: 1.127 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 1.3783211708068848
Epoch: 3, Steps: 3 | Train Loss: 1.056 Vali Loss: 0.957 Vali Acc: 0.800 Test Loss: 0.957 Test Acc: 0.800
Validation loss decreased (-0.599989 --> -0.799990).  Saving model ...
Epoch: 4 cost time: 1.3218483924865723
Epoch: 4, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.782 Vali Acc: 0.900 Test Loss: 0.782 Test Acc: 0.900
Validation loss decreased (-0.799990 --> -0.899992).  Saving model ...
Epoch: 5 cost time: 1.2778222560882568
Epoch: 5, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924994).  Saving model ...
Epoch: 6 cost time: 1.25083589553833
Epoch: 6, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.550 Vali Acc: 0.950 Test Loss: 0.550 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 1.1758265495300293
Epoch: 7, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.480 Vali Acc: 0.950 Test Loss: 0.480 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 1.228597640991211
Epoch: 8, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2945027351379395
Epoch: 9, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 1.364349365234375
Epoch: 10, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 1.1377577781677246
Epoch: 11, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.187835931777954
Epoch: 12, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2121827602386475
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2171027660369873
Epoch: 14, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2406492233276367
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1944925785064697
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2465689182281494
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.407 Vali Acc: 0.950 Test Loss: 0.407 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2601406574249268
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3188908100128174
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2378795146942139
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.91666316986084
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.3570027351379395
Epoch: 2, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.187 Vali Acc: 0.550 Test Loss: 1.187 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 1.323765754699707
Epoch: 3, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 1.434257984161377
Epoch: 4, Steps: 3 | Train Loss: 0.838 Vali Loss: 0.861 Vali Acc: 0.775 Test Loss: 0.861 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 1.343169927597046
Epoch: 5, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.336076021194458
Epoch: 6, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.653 Vali Acc: 0.775 Test Loss: 0.653 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.25205659866333
Epoch: 7, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.570 Vali Acc: 0.800 Test Loss: 0.570 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 8 cost time: 1.300560712814331
Epoch: 8, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.512 Vali Acc: 0.825 Test Loss: 0.512 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 1.232529640197754
Epoch: 9, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 10 cost time: 1.173705816268921
Epoch: 10, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.488 Vali Acc: 0.775 Test Loss: 0.488 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6195476055145264
Epoch: 11, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.496 Vali Acc: 0.775 Test Loss: 0.496 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3698737621307373
Epoch: 12, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.498 Vali Acc: 0.825 Test Loss: 0.498 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2528364658355713
Epoch: 13, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.825 Test Loss: 0.493 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1782970428466797
Epoch: 14, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2097430229187012
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.825 Test Loss: 0.487 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0905840396881104
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2055423259735107
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1399717330932617
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.825 Test Loss: 0.480 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1669807434082031
Epoch: 19, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.800 Test Loss: 0.477 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5410642623901367
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.2483007907867432
Epoch: 2, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.175 Vali Acc: 0.525 Test Loss: 1.175 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 1.205528736114502
Epoch: 3, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.034 Vali Acc: 0.700 Test Loss: 1.034 Test Acc: 0.700
Validation loss decreased (-0.524988 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 1.2002222537994385
Epoch: 4, Steps: 3 | Train Loss: 0.913 Vali Loss: 0.881 Vali Acc: 0.800 Test Loss: 0.881 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 1.2499892711639404
Epoch: 5, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.757 Vali Acc: 0.825 Test Loss: 0.757 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 1.4811055660247803
Epoch: 6, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.666 Vali Acc: 0.875 Test Loss: 0.666 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 7 cost time: 1.3093807697296143
Epoch: 7, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 1.4700777530670166
Epoch: 8, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.4184024333953857
Epoch: 9, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.522 Vali Acc: 0.800 Test Loss: 0.522 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3084826469421387
Epoch: 10, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3505723476409912
Epoch: 11, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2559478282928467
Epoch: 12, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4269471168518066
Epoch: 13, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2993714809417725
Epoch: 14, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2180218696594238
Epoch: 15, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2710847854614258
Epoch: 16, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.531 Vali Acc: 0.825 Test Loss: 0.531 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1412184238433838
Epoch: 17, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.27620530128479
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.658399820327759
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.396 Vali Acc: 0.200 Test Loss: 1.396 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.2630021572113037
Epoch: 2, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.373 Vali Acc: 0.250 Test Loss: 1.373 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.273132085800171
Epoch: 3, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.4395368099212646
Epoch: 4, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.260 Vali Acc: 0.450 Test Loss: 1.260 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.3465092182159424
Epoch: 5, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.202 Vali Acc: 0.450 Test Loss: 1.202 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.2346808910369873
Epoch: 6, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.209404706954956
Epoch: 7, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.090 Vali Acc: 0.525 Test Loss: 1.090 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 1.2306807041168213
Epoch: 8, Steps: 3 | Train Loss: 0.482 Vali Loss: 1.047 Vali Acc: 0.575 Test Loss: 1.047 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 9 cost time: 1.2434041500091553
Epoch: 9, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 1.2354984283447266
Epoch: 10, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.954 Vali Acc: 0.625 Test Loss: 0.954 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 1.2548558712005615
Epoch: 11, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.935 Vali Acc: 0.650 Test Loss: 0.935 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 12 cost time: 1.2256724834442139
Epoch: 12, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.927 Vali Acc: 0.675 Test Loss: 0.927 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 13 cost time: 1.288759469985962
Epoch: 13, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.913 Vali Acc: 0.700 Test Loss: 0.913 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 1.2097618579864502
Epoch: 14, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.911 Vali Acc: 0.725 Test Loss: 0.911 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.2082068920135498
Epoch: 15, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.923 Vali Acc: 0.725 Test Loss: 0.923 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2405681610107422
Epoch: 16, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.919 Vali Acc: 0.725 Test Loss: 0.919 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2335143089294434
Epoch: 17, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 18 cost time: 1.1398706436157227
Epoch: 18, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 1.1401023864746094
Epoch: 19, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 1.1655428409576416
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.832 Vali Acc: 0.750 Test Loss: 0.832 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 21 cost time: 1.234327793121338
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 22 cost time: 1.237260341644287
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 23 cost time: 1.3702168464660645
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.115236759185791
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1612803936004639
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1865947246551514
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1625235080718994
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.775 Test Loss: 0.857 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1629555225372314
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3036808967590332
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.750 Test Loss: 0.873 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3372883796691895
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.750 Test Loss: 0.879 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2790801525115967
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.750 Test Loss: 0.886 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1770522594451904
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8730716705322266
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.392 Vali Acc: 0.300 Test Loss: 1.392 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.3935425281524658
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.380 Vali Acc: 0.325 Test Loss: 1.380 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.3961536884307861
Epoch: 3, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.351 Vali Acc: 0.325 Test Loss: 1.351 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.366868257522583
Epoch: 4, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.330 Vali Acc: 0.300 Test Loss: 1.330 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2447185516357422
Epoch: 5, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.2994158267974854
Epoch: 6, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.273 Vali Acc: 0.350 Test Loss: 1.273 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2838547229766846
Epoch: 7, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.238 Vali Acc: 0.350 Test Loss: 1.238 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3069884777069092
Epoch: 8, Steps: 3 | Train Loss: 0.653 Vali Loss: 1.194 Vali Acc: 0.375 Test Loss: 1.194 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 9 cost time: 1.3881425857543945
Epoch: 9, Steps: 3 | Train Loss: 0.510 Vali Loss: 1.147 Vali Acc: 0.375 Test Loss: 1.147 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374989).  Saving model ...
Epoch: 10 cost time: 1.4938907623291016
Epoch: 10, Steps: 3 | Train Loss: 0.393 Vali Loss: 1.121 Vali Acc: 0.425 Test Loss: 1.121 Test Acc: 0.425
Validation loss decreased (-0.374989 --> -0.424989).  Saving model ...
Epoch: 11 cost time: 1.265214204788208
Epoch: 11, Steps: 3 | Train Loss: 0.328 Vali Loss: 1.113 Vali Acc: 0.375 Test Loss: 1.113 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1544196605682373
Epoch: 12, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1541728973388672
Epoch: 13, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.176 Vali Acc: 0.350 Test Loss: 1.176 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.300593376159668
Epoch: 14, Steps: 3 | Train Loss: 0.150 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3557851314544678
Epoch: 15, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.211 Vali Acc: 0.450 Test Loss: 1.211 Test Acc: 0.450
Validation loss decreased (-0.424989 --> -0.449988).  Saving model ...
Epoch: 16 cost time: 1.3756318092346191
Epoch: 16, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 1.3104808330535889
Epoch: 17, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.138 Vali Acc: 0.525 Test Loss: 1.138 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 18 cost time: 1.3960225582122803
Epoch: 18, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.246 Vali Acc: 0.475 Test Loss: 1.246 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3134372234344482
Epoch: 19, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.301 Vali Acc: 0.475 Test Loss: 1.301 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3877983093261719
Epoch: 20, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2507350444793701
Epoch: 21, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3497810363769531
Epoch: 22, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.335042953491211
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.207 Vali Acc: 0.525 Test Loss: 1.207 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4391758441925049
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.211 Vali Acc: 0.525 Test Loss: 1.211 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2889025211334229
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.217 Vali Acc: 0.550 Test Loss: 1.217 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549988).  Saving model ...
Epoch: 26 cost time: 1.27433180809021
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.231 Vali Acc: 0.575 Test Loss: 1.231 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 27 cost time: 1.3876111507415771
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.255 Vali Acc: 0.550 Test Loss: 1.255 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.28009033203125
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.269 Vali Acc: 0.575 Test Loss: 1.269 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2877957820892334
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.263 Vali Acc: 0.600 Test Loss: 1.263 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599987).  Saving model ...
Epoch: 30 cost time: 1.3030486106872559
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.249 Vali Acc: 0.600 Test Loss: 1.249 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 31 cost time: 1.2768974304199219
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 32 cost time: 1.375246524810791
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4906859397888184
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.275 Vali Acc: 0.600 Test Loss: 1.275 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.61445951461792
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.289 Vali Acc: 0.550 Test Loss: 1.289 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.483048439025879
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.291 Vali Acc: 0.550 Test Loss: 1.291 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.3393714427947998
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.280 Vali Acc: 0.575 Test Loss: 1.280 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2906885147094727
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.257 Vali Acc: 0.575 Test Loss: 1.257 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.268934965133667
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.240 Vali Acc: 0.625 Test Loss: 1.240 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 39 cost time: 1.2632315158843994
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.228 Vali Acc: 0.625 Test Loss: 1.228 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 40 cost time: 1.3906092643737793
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.219 Vali Acc: 0.650 Test Loss: 1.219 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 41 cost time: 1.3294715881347656
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.219 Vali Acc: 0.625 Test Loss: 1.219 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2677035331726074
Epoch: 42, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.625 Test Loss: 1.220 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.519538402557373
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.225 Vali Acc: 0.625 Test Loss: 1.225 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4232733249664307
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.238 Vali Acc: 0.625 Test Loss: 1.238 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3317644596099854
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.625 Test Loss: 1.250 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1511015892028809
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.261 Vali Acc: 0.625 Test Loss: 1.261 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2657299041748047
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.271 Vali Acc: 0.625 Test Loss: 1.271 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.176196575164795
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.625 Test Loss: 1.279 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2924613952636719
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.625 Test Loss: 1.284 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3072426319122314
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.290 Vali Acc: 0.650 Test Loss: 1.290 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.711085796356201
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.516 Vali Acc: 0.175 Test Loss: 1.516 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 1.3117952346801758
Epoch: 2, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.505 Vali Acc: 0.175 Test Loss: 1.505 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 1.2504053115844727
Epoch: 3, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.473 Vali Acc: 0.175 Test Loss: 1.473 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 1.2099440097808838
Epoch: 4, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.443 Vali Acc: 0.250 Test Loss: 1.443 Test Acc: 0.250
Validation loss decreased (-0.174985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.2897021770477295
Epoch: 5, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.406 Vali Acc: 0.300 Test Loss: 1.406 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 1.3109076023101807
Epoch: 6, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.367 Vali Acc: 0.325 Test Loss: 1.367 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 7 cost time: 1.352712631225586
Epoch: 7, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.310 Vali Acc: 0.350 Test Loss: 1.310 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 1.423158884048462
Epoch: 8, Steps: 3 | Train Loss: 0.646 Vali Loss: 1.257 Vali Acc: 0.425 Test Loss: 1.257 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 9 cost time: 1.2144241333007812
Epoch: 9, Steps: 3 | Train Loss: 0.500 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3083019256591797
Epoch: 10, Steps: 3 | Train Loss: 0.387 Vali Loss: 1.182 Vali Acc: 0.450 Test Loss: 1.182 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 1.3711869716644287
Epoch: 11, Steps: 3 | Train Loss: 0.307 Vali Loss: 1.167 Vali Acc: 0.525 Test Loss: 1.167 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 12 cost time: 1.3035404682159424
Epoch: 12, Steps: 3 | Train Loss: 0.257 Vali Loss: 1.181 Vali Acc: 0.475 Test Loss: 1.181 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.337329626083374
Epoch: 13, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4045264720916748
Epoch: 14, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.235 Vali Acc: 0.475 Test Loss: 1.235 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5000333786010742
Epoch: 15, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.188 Vali Acc: 0.525 Test Loss: 1.188 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4588901996612549
Epoch: 16, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.112 Vali Acc: 0.625 Test Loss: 1.112 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 1.4054229259490967
Epoch: 17, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3470377922058105
Epoch: 18, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.447380542755127
Epoch: 19, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.145 Vali Acc: 0.525 Test Loss: 1.145 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5159575939178467
Epoch: 20, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.170 Vali Acc: 0.450 Test Loss: 1.170 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4651484489440918
Epoch: 21, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.190 Vali Acc: 0.450 Test Loss: 1.190 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4278576374053955
Epoch: 22, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.183 Vali Acc: 0.475 Test Loss: 1.183 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4044620990753174
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2841160297393799
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3555934429168701
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.357445478439331
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.125 Vali Acc: 0.575 Test Loss: 1.125 Test Acc: 0.575
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7960474491119385
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3229522705078125
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2584171295166016
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2375679016113281
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.1789422035217285
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1826927661895752
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1280527114868164
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3812291622161865
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2570338249206543
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3625845909118652
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.237043857574463
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1992876529693604
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1921634674072266
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2437584400177002
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 2904836
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6071488857269287
Epoch: 1, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.347 Vali Acc: 0.375 Test Loss: 1.347 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2285382747650146
Epoch: 2, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.238 Vali Acc: 0.550 Test Loss: 1.238 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 1.2926850318908691
Epoch: 3, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 1.317978858947754
Epoch: 4, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.882 Vali Acc: 0.700 Test Loss: 0.882 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 1.24113130569458
Epoch: 5, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.699991 --> -0.799993).  Saving model ...
Epoch: 6 cost time: 1.3563709259033203
Epoch: 6, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 1.3717827796936035
Epoch: 7, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 8 cost time: 1.2434778213500977
Epoch: 8, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.424 Vali Acc: 0.875 Test Loss: 0.424 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874996).  Saving model ...
Epoch: 9 cost time: 1.2362298965454102
Epoch: 9, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 10 cost time: 1.246415615081787
Epoch: 10, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 11 cost time: 1.29795241355896
Epoch: 11, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.2769479751586914
Epoch: 12, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 1.1770474910736084
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 1.2204997539520264
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2124338150024414
Epoch: 15, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.875 Test Loss: 0.323 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3217575550079346
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 1.3019568920135498
Epoch: 17, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 1.2045645713806152
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.1598773002624512
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1554408073425293
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2217342853546143
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.24674654006958
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.322948932647705
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3897430896759033
Epoch: 24, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1904950141906738
Epoch: 25, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1855113506317139
Epoch: 26, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.213158369064331
Epoch: 27, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4021310806274414
Epoch: 28, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6430439949035645
Epoch: 1, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 1.305201768875122
Epoch: 2, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.214 Vali Acc: 0.525 Test Loss: 1.214 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 1.2811675071716309
Epoch: 3, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.039 Vali Acc: 0.750 Test Loss: 1.039 Test Acc: 0.750
Validation loss decreased (-0.524988 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 1.2938780784606934
Epoch: 4, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.857 Vali Acc: 0.800 Test Loss: 0.857 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 1.3650121688842773
Epoch: 5, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 1.2193939685821533
Epoch: 6, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.579 Vali Acc: 0.875 Test Loss: 0.579 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.282273292541504
Epoch: 7, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 1.3844361305236816
Epoch: 8, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 9 cost time: 1.2654738426208496
Epoch: 9, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 1.2699275016784668
Epoch: 10, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 1.2487623691558838
Epoch: 11, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2425365447998047
Epoch: 12, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1879889965057373
Epoch: 13, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.2405681610107422
Epoch: 14, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 1.1889045238494873
Epoch: 15, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2249763011932373
Epoch: 16, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2784078121185303
Epoch: 17, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3021349906921387
Epoch: 18, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2655940055847168
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1884949207305908
Epoch: 20, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1849350929260254
Epoch: 21, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1353545188903809
Epoch: 22, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.190295696258545
Epoch: 23, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2937750816345215
Epoch: 24, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7055294513702393
Epoch: 1, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.280 Vali Acc: 0.475 Test Loss: 1.280 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 1.4428479671478271
Epoch: 2, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.173 Vali Acc: 0.625 Test Loss: 1.173 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 1.3184380531311035
Epoch: 3, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 1.4061839580535889
Epoch: 4, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 1.5243034362792969
Epoch: 5, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.698 Vali Acc: 0.875 Test Loss: 0.698 Test Acc: 0.875
Validation loss decreased (-0.799992 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 1.3466968536376953
Epoch: 6, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.5048458576202393
Epoch: 7, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 8 cost time: 1.5386991500854492
Epoch: 8, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 1.5104303359985352
Epoch: 9, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.435 Vali Acc: 0.900 Test Loss: 0.435 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 1.4953670501708984
Epoch: 10, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 1.4236035346984863
Epoch: 11, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.437 Vali Acc: 0.875 Test Loss: 0.437 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3970563411712646
Epoch: 12, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6563165187835693
Epoch: 13, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3330645561218262
Epoch: 14, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.324702262878418
Epoch: 15, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3859832286834717
Epoch: 16, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3932685852050781
Epoch: 17, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4138522148132324
Epoch: 18, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3140525817871094
Epoch: 19, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5169665813446045
Epoch: 20, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6861159801483154
Epoch: 1, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.3065285682678223
Epoch: 2, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.196 Vali Acc: 0.575 Test Loss: 1.196 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 1.3100967407226562
Epoch: 3, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.024 Vali Acc: 0.650 Test Loss: 1.024 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 1.2572181224822998
Epoch: 4, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
Validation loss decreased (-0.649990 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 1.1705656051635742
Epoch: 5, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824993).  Saving model ...
Epoch: 6 cost time: 1.2134864330291748
Epoch: 6, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.621 Vali Acc: 0.875 Test Loss: 0.621 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 7 cost time: 1.3779678344726562
Epoch: 7, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3454926013946533
Epoch: 8, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 1.2944676876068115
Epoch: 9, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.504 Vali Acc: 0.800 Test Loss: 0.504 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3700556755065918
Epoch: 10, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.500 Vali Acc: 0.800 Test Loss: 0.500 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4107098579406738
Epoch: 11, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3511078357696533
Epoch: 12, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.518 Vali Acc: 0.775 Test Loss: 0.518 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2388801574707031
Epoch: 13, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.504 Vali Acc: 0.800 Test Loss: 0.504 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2302072048187256
Epoch: 14, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.486 Vali Acc: 0.825 Test Loss: 0.486 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3000526428222656
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.468 Vali Acc: 0.825 Test Loss: 0.468 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4044945240020752
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.452 Vali Acc: 0.825 Test Loss: 0.452 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4069890975952148
Epoch: 17, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3258163928985596
Epoch: 18, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.800 Test Loss: 0.438 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.581022262573242
Epoch: 1, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.302 Vali Acc: 0.275 Test Loss: 1.302 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 1.2324073314666748
Epoch: 2, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.202 Vali Acc: 0.475 Test Loss: 1.202 Test Acc: 0.475
Validation loss decreased (-0.274987 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 1.3051631450653076
Epoch: 3, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.054 Vali Acc: 0.650 Test Loss: 1.054 Test Acc: 0.650
Validation loss decreased (-0.474988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 1.270294189453125
Epoch: 4, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.903 Vali Acc: 0.725 Test Loss: 0.903 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724991).  Saving model ...
Epoch: 5 cost time: 1.3391327857971191
Epoch: 5, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 1.2360475063323975
Epoch: 6, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.675 Vali Acc: 0.825 Test Loss: 0.675 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 1.3385608196258545
Epoch: 7, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.611 Vali Acc: 0.800 Test Loss: 0.611 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1950721740722656
Epoch: 8, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.261523962020874
Epoch: 9, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.2171375751495361
Epoch: 10, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2061285972595215
Epoch: 11, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2895305156707764
Epoch: 12, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.375077247619629
Epoch: 13, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.571 Vali Acc: 0.800 Test Loss: 0.571 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3248717784881592
Epoch: 14, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.592 Vali Acc: 0.800 Test Loss: 0.592 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2748773097991943
Epoch: 15, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2059259414672852
Epoch: 16, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3041236400604248
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.800 Test Loss: 0.598 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2361900806427002
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.800 Test Loss: 0.596 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3543391227722168
Epoch: 19, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.598 Vali Acc: 0.825 Test Loss: 0.598 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.037202835083008
Epoch: 1, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.434 Vali Acc: 0.250 Test Loss: 1.434 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3467350006103516
Epoch: 2, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.403 Vali Acc: 0.300 Test Loss: 1.403 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.3183507919311523
Epoch: 3, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.336249828338623
Epoch: 4, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.283 Vali Acc: 0.425 Test Loss: 1.283 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.3684580326080322
Epoch: 5, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.3387832641601562
Epoch: 6, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.148 Vali Acc: 0.600 Test Loss: 1.148 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 1.2994303703308105
Epoch: 7, Steps: 3 | Train Loss: 0.618 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 1.361696481704712
Epoch: 8, Steps: 3 | Train Loss: 0.534 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.3362562656402588
Epoch: 9, Steps: 3 | Train Loss: 0.408 Vali Loss: 1.028 Vali Acc: 0.625 Test Loss: 1.028 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 1.1584887504577637
Epoch: 10, Steps: 3 | Train Loss: 0.336 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.360600471496582
Epoch: 11, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.994 Vali Acc: 0.650 Test Loss: 0.994 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 1.2419896125793457
Epoch: 12, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 1.2698101997375488
Epoch: 13, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.922 Vali Acc: 0.675 Test Loss: 0.922 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 14 cost time: 1.259596824645996
Epoch: 14, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.897 Vali Acc: 0.700 Test Loss: 0.897 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 1.3013300895690918
Epoch: 15, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3020434379577637
Epoch: 16, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.906 Vali Acc: 0.725 Test Loss: 0.906 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 1.2659108638763428
Epoch: 17, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.929 Vali Acc: 0.725 Test Loss: 0.929 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.185192346572876
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.952 Vali Acc: 0.725 Test Loss: 0.952 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.288461446762085
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2685050964355469
Epoch: 20, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.243652582168579
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3249402046203613
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.986 Vali Acc: 0.725 Test Loss: 0.986 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2686724662780762
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1684627532958984
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.990 Vali Acc: 0.725 Test Loss: 0.990 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.086728572845459
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.218536376953125
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.989 Vali Acc: 0.725 Test Loss: 0.989 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8079726696014404
Epoch: 1, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.459 Vali Acc: 0.150 Test Loss: 1.459 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.4315826892852783
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.439 Vali Acc: 0.175 Test Loss: 1.439 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.5526154041290283
Epoch: 3, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.401 Vali Acc: 0.225 Test Loss: 1.401 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 1.2611730098724365
Epoch: 4, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.358 Vali Acc: 0.325 Test Loss: 1.358 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.3358869552612305
Epoch: 5, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.4230387210845947
Epoch: 6, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.262 Vali Acc: 0.425 Test Loss: 1.262 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.4301493167877197
Epoch: 7, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.212 Vali Acc: 0.425 Test Loss: 1.212 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.3092517852783203
Epoch: 8, Steps: 3 | Train Loss: 0.725 Vali Loss: 1.164 Vali Acc: 0.450 Test Loss: 1.164 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 1.4288580417633057
Epoch: 9, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.3311803340911865
Epoch: 10, Steps: 3 | Train Loss: 0.487 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 1.4175395965576172
Epoch: 11, Steps: 3 | Train Loss: 0.368 Vali Loss: 1.162 Vali Acc: 0.425 Test Loss: 1.162 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3784229755401611
Epoch: 12, Steps: 3 | Train Loss: 0.302 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.2181220054626465
Epoch: 13, Steps: 3 | Train Loss: 0.239 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.3662950992584229
Epoch: 14, Steps: 3 | Train Loss: 0.187 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.1965479850769043
Epoch: 15, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.088 Vali Acc: 0.450 Test Loss: 1.088 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1762886047363281
Epoch: 16, Steps: 3 | Train Loss: 0.111 Vali Loss: 1.081 Vali Acc: 0.500 Test Loss: 1.081 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3299922943115234
Epoch: 17, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.104 Vali Acc: 0.525 Test Loss: 1.104 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 18 cost time: 1.2387142181396484
Epoch: 18, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2007372379302979
Epoch: 19, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 1.127739667892456
Epoch: 20, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.183 Vali Acc: 0.550 Test Loss: 1.183 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2815868854522705
Epoch: 21, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.243 Vali Acc: 0.550 Test Loss: 1.243 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2391369342803955
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.259 Vali Acc: 0.550 Test Loss: 1.259 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1108076572418213
Epoch: 23, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.227 Vali Acc: 0.550 Test Loss: 1.227 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2958283424377441
Epoch: 24, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.218 Vali Acc: 0.550 Test Loss: 1.218 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3259389400482178
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.173 Vali Acc: 0.575 Test Loss: 1.173 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 26 cost time: 1.2420103549957275
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.149 Vali Acc: 0.575 Test Loss: 1.149 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 27 cost time: 1.4267492294311523
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 1.2225582599639893
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 1.3009655475616455
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.130 Vali Acc: 0.625 Test Loss: 1.130 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 30 cost time: 1.3006508350372314
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 31 cost time: 1.479419469833374
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.137 Vali Acc: 0.625 Test Loss: 1.137 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.293055534362793
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2986102104187012
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.158 Vali Acc: 0.625 Test Loss: 1.158 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3436064720153809
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3609404563903809
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.185 Vali Acc: 0.650 Test Loss: 1.185 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649988).  Saving model ...
Epoch: 36 cost time: 1.3888475894927979
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.202 Vali Acc: 0.650 Test Loss: 1.202 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2955985069274902
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.217 Vali Acc: 0.650 Test Loss: 1.217 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3617491722106934
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.224 Vali Acc: 0.650 Test Loss: 1.224 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3295953273773193
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.232 Vali Acc: 0.650 Test Loss: 1.232 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2035844326019287
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.231 Vali Acc: 0.650 Test Loss: 1.231 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2372674942016602
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.219 Vali Acc: 0.650 Test Loss: 1.219 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3194539546966553
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.210 Vali Acc: 0.650 Test Loss: 1.210 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3426527976989746
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.206 Vali Acc: 0.650 Test Loss: 1.206 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.3001112937927246
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.650 Test Loss: 1.204 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3469188213348389
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.212 Vali Acc: 0.650 Test Loss: 1.212 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7458410263061523
Epoch: 1, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.515 Vali Acc: 0.275 Test Loss: 1.515 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.2187438011169434
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.496 Vali Acc: 0.250 Test Loss: 1.496 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3479368686676025
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.456 Vali Acc: 0.250 Test Loss: 1.456 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.147005558013916
Epoch: 4, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.412 Vali Acc: 0.325 Test Loss: 1.412 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.2740044593811035
Epoch: 5, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.1403555870056152
Epoch: 6, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.307 Vali Acc: 0.350 Test Loss: 1.307 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 1.2940876483917236
Epoch: 7, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.250 Vali Acc: 0.475 Test Loss: 1.250 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 1.3240337371826172
Epoch: 8, Steps: 3 | Train Loss: 0.723 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 1.480156421661377
Epoch: 9, Steps: 3 | Train Loss: 0.544 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 1.3766465187072754
Epoch: 10, Steps: 3 | Train Loss: 0.466 Vali Loss: 1.166 Vali Acc: 0.525 Test Loss: 1.166 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.248476266860962
Epoch: 11, Steps: 3 | Train Loss: 0.346 Vali Loss: 1.169 Vali Acc: 0.450 Test Loss: 1.169 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.320235013961792
Epoch: 12, Steps: 3 | Train Loss: 0.266 Vali Loss: 1.137 Vali Acc: 0.475 Test Loss: 1.137 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.439668893814087
Epoch: 13, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.068 Vali Acc: 0.475 Test Loss: 1.068 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3319756984710693
Epoch: 14, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.032 Vali Acc: 0.450 Test Loss: 1.032 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3456861972808838
Epoch: 15, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4967224597930908
Epoch: 16, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.039 Vali Acc: 0.475 Test Loss: 1.039 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3986294269561768
Epoch: 17, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.053 Vali Acc: 0.575 Test Loss: 1.053 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 1.4037771224975586
Epoch: 18, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.103 Vali Acc: 0.575 Test Loss: 1.103 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.337744951248169
Epoch: 19, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 1.2605915069580078
Epoch: 20, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4040944576263428
Epoch: 21, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.122 Vali Acc: 0.600 Test Loss: 1.122 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.492809534072876
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.130 Vali Acc: 0.625 Test Loss: 1.130 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 1.4493083953857422
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.124 Vali Acc: 0.625 Test Loss: 1.124 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 24 cost time: 1.2376956939697266
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 25 cost time: 1.391371488571167
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.102 Vali Acc: 0.625 Test Loss: 1.102 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 26 cost time: 1.325204849243164
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.093 Vali Acc: 0.650 Test Loss: 1.093 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 27 cost time: 1.3175632953643799
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.329005241394043
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.302175760269165
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.097 Vali Acc: 0.650 Test Loss: 1.097 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2713937759399414
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2956993579864502
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.088 Vali Acc: 0.650 Test Loss: 1.088 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 32 cost time: 1.2367761135101318
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 33 cost time: 1.273653507232666
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.650 Test Loss: 1.090 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2357256412506104
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.258371114730835
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.094 Vali Acc: 0.650 Test Loss: 1.094 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.241724967956543
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 37 cost time: 1.163667917251587
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.118 Vali Acc: 0.675 Test Loss: 1.118 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2231757640838623
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.129 Vali Acc: 0.675 Test Loss: 1.129 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.211895227432251
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.146 Vali Acc: 0.675 Test Loss: 1.146 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2782576084136963
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.159 Vali Acc: 0.700 Test Loss: 1.159 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699988).  Saving model ...
Epoch: 41 cost time: 1.2817699909210205
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.164 Vali Acc: 0.700 Test Loss: 1.164 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2721076011657715
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.164 Vali Acc: 0.700 Test Loss: 1.164 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.261685848236084
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.167 Vali Acc: 0.700 Test Loss: 1.167 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2214412689208984
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.174 Vali Acc: 0.700 Test Loss: 1.174 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2151906490325928
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.181 Vali Acc: 0.700 Test Loss: 1.181 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3128910064697266
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.188 Vali Acc: 0.700 Test Loss: 1.188 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3358383178710938
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.435596227645874
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.213 Vali Acc: 0.675 Test Loss: 1.213 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.3329367637634277
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.675 Test Loss: 1.220 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4347543716430664
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.225 Vali Acc: 0.675 Test Loss: 1.225 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9902541637420654
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3043310642242432
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2515485286712646
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.2464756965637207
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.3430800437927246
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2222027778625488
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.448904037475586
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2529468536376953
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.3351953029632568
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3825263977050781
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2690329551696777
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.275413990020752
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2557718753814697
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.302483081817627
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.354701280593872
Epoch: 15, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.3027138710021973
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 17 cost time: 1.2810239791870117
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4627015590667725
Epoch: 18, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3021550178527832
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.385582685470581
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3815956115722656
Epoch: 21, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3317151069641113
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3088188171386719
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2947289943695068
Epoch: 24, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3187103271484375
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3028159141540527
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 2708228
model size : 20.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.692113161087036
Epoch: 1, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.338 Vali Acc: 0.450 Test Loss: 1.338 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.2321319580078125
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.282 Vali Acc: 0.475 Test Loss: 1.282 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.2432212829589844
Epoch: 3, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.173 Vali Acc: 0.575 Test Loss: 1.173 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.2268660068511963
Epoch: 4, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.038 Vali Acc: 0.725 Test Loss: 1.038 Test Acc: 0.725
Validation loss decreased (-0.574988 --> -0.724990).  Saving model ...
Epoch: 5 cost time: 1.4244413375854492
Epoch: 5, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 1.3134684562683105
Epoch: 6, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.24965238571167
Epoch: 7, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 1.2290167808532715
Epoch: 8, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.578 Vali Acc: 0.825 Test Loss: 0.578 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.0961921215057373
Epoch: 9, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2551696300506592
Epoch: 10, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 1.1653876304626465
Epoch: 11, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 12 cost time: 1.232680320739746
Epoch: 12, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 13 cost time: 1.263789415359497
Epoch: 13, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874997).  Saving model ...
Epoch: 14 cost time: 1.1379468441009521
Epoch: 14, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 1.1437082290649414
Epoch: 15, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 1.1589953899383545
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 1.1743969917297363
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 1.1794483661651611
Epoch: 18, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 1.1662068367004395
Epoch: 19, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 1.18149995803833
Epoch: 20, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.1773760318756104
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.2052125930786133
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.137058973312378
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.307171106338501
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 1.2015666961669922
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 1.161804437637329
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.1467375755310059
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.1458032131195068
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 1.1861944198608398
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 1.1715834140777588
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 1.3643734455108643
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 1.387296199798584
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 1.3353285789489746
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 1.2338316440582275
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 1.3098278045654297
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 1.3019936084747314
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.373680830001831
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3521337509155273
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4063646793365479
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3017375469207764
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3441998958587646
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2271003723144531
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3108248710632324
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2993059158325195
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.3563084602355957
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5088682174682617
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.2579848766326904
Epoch: 2, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.301 Vali Acc: 0.450 Test Loss: 1.301 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.3550631999969482
Epoch: 3, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2249348163604736
Epoch: 4, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.058 Vali Acc: 0.675 Test Loss: 1.058 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 1.1851212978363037
Epoch: 5, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.674989 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 1.562610149383545
Epoch: 6, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.783 Vali Acc: 0.825 Test Loss: 0.783 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 7 cost time: 1.2558269500732422
Epoch: 7, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 8 cost time: 1.2915139198303223
Epoch: 8, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 9 cost time: 1.28694748878479
Epoch: 9, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 1.2535367012023926
Epoch: 10, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 1.3185617923736572
Epoch: 11, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.2062344551086426
Epoch: 12, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 1.2262272834777832
Epoch: 13, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 1.315737247467041
Epoch: 14, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 1.341447114944458
Epoch: 15, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 1.317185401916504
Epoch: 16, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 1.2262284755706787
Epoch: 17, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 1.3372867107391357
Epoch: 18, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 19 cost time: 1.351513385772705
Epoch: 19, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 1.4109447002410889
Epoch: 20, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 1.3416447639465332
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 1.3179292678833008
Epoch: 22, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.2396409511566162
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.2987678050994873
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.314141035079956
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.3966081142425537
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.3867731094360352
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.2834327220916748
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2555413246154785
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.2656748294830322
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 1.3548665046691895
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 1.1638076305389404
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.2018322944641113
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.2960944175720215
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 1.196171522140503
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 1.2104403972625732
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 1.2811248302459717
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2716259956359863
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2453041076660156
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3362634181976318
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2938816547393799
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.3579258918762207
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.2446343898773193
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.2751672267913818
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.3188798427581787
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.4278545379638672
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.300699234008789
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.2167274951934814
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.2465405464172363
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.2912967205047607
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.275550365447998
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 1.421142339706421
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.311448097229004
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3575737476348877
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.2306997776031494
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 1.2513153553009033
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 1.3658883571624756
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 1.375035047531128
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 59 cost time: 1.254819631576538
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 60 cost time: 1.297175407409668
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.3686912059783936
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.3091700077056885
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.4429762363433838
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.2322213649749756
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.388035535812378
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.3266191482543945
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.2468371391296387
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.1669189929962158
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.2181756496429443
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.71301531791687
Epoch: 1, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.373 Vali Acc: 0.450 Test Loss: 1.373 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 1.1733427047729492
Epoch: 2, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.268437385559082
Epoch: 3, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.2927308082580566
Epoch: 4, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.064 Vali Acc: 0.700 Test Loss: 1.064 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 1.2921185493469238
Epoch: 5, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.922 Vali Acc: 0.825 Test Loss: 0.922 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824991).  Saving model ...
Epoch: 6 cost time: 1.195366621017456
Epoch: 6, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.798 Vali Acc: 0.900 Test Loss: 0.798 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 1.3655588626861572
Epoch: 7, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 1.1084041595458984
Epoch: 8, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.621 Vali Acc: 0.900 Test Loss: 0.621 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 1.2736616134643555
Epoch: 9, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.2829663753509521
Epoch: 10, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 1.254542589187622
Epoch: 11, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 1.2434852123260498
Epoch: 12, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 1.2253832817077637
Epoch: 13, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 1.217031478881836
Epoch: 14, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 15 cost time: 1.413334846496582
Epoch: 15, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2297871112823486
Epoch: 16, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2365236282348633
Epoch: 17, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3835530281066895
Epoch: 18, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.3400921821594238
Epoch: 19, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 1.3097054958343506
Epoch: 20, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.2476253509521484
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.3055009841918945
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.273212194442749
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 1.383873462677002
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 1.3351595401763916
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 1.2500641345977783
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 1.222780466079712
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 1.3415865898132324
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 1.272723913192749
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.2757751941680908
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 1.2751829624176025
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 1.2489590644836426
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 1.2036819458007812
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 1.2515206336975098
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 1.2589948177337646
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 1.2877476215362549
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 1.3079423904418945
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2928366661071777
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1804816722869873
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3552963733673096
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2620415687561035
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3936066627502441
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3802556991577148
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 1.36659836769104
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 1.201296091079712
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 1.1855659484863281
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 1.253666639328003
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 1.2976341247558594
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 1.3224127292633057
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 1.3944861888885498
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 1.3370766639709473
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 1.4342362880706787
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 1.342665433883667
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 1.5490741729736328
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 1.5833842754364014
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 1.408571481704712
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 57 cost time: 1.3642253875732422
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 1.3927628993988037
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3555302619934082
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.3421990871429443
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.3693664073944092
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.422929048538208
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.290234088897705
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.442814588546753
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.4330787658691406
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.4208500385284424
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.3230676651000977
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6292479038238525
Epoch: 1, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.246 Vali Acc: 0.575 Test Loss: 1.246 Test Acc: 0.575
Validation loss decreased (inf --> -0.574988).  Saving model ...
Epoch: 2 cost time: 1.4117422103881836
Epoch: 2, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.2782349586486816
Epoch: 3, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 4 cost time: 1.1466560363769531
Epoch: 4, Steps: 3 | Train Loss: 0.940 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 1.1556973457336426
Epoch: 5, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.828 Vali Acc: 0.775 Test Loss: 0.828 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774992).  Saving model ...
Epoch: 6 cost time: 1.1136913299560547
Epoch: 6, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 1.330575704574585
Epoch: 7, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 1.1913883686065674
Epoch: 8, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.590 Vali Acc: 0.825 Test Loss: 0.590 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 9 cost time: 1.1911802291870117
Epoch: 9, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 10 cost time: 1.3029675483703613
Epoch: 10, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.504 Vali Acc: 0.800 Test Loss: 0.504 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3903717994689941
Epoch: 11, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.473 Vali Acc: 0.800 Test Loss: 0.473 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1678757667541504
Epoch: 12, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.458 Vali Acc: 0.800 Test Loss: 0.458 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.087320327758789
Epoch: 13, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.447 Vali Acc: 0.800 Test Loss: 0.447 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2272953987121582
Epoch: 14, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.435 Vali Acc: 0.800 Test Loss: 0.435 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1647436618804932
Epoch: 15, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.425 Vali Acc: 0.800 Test Loss: 0.425 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2536492347717285
Epoch: 16, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.414 Vali Acc: 0.800 Test Loss: 0.414 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3501253128051758
Epoch: 17, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.402 Vali Acc: 0.800 Test Loss: 0.402 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.381248950958252
Epoch: 18, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.392 Vali Acc: 0.800 Test Loss: 0.392 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2248568534851074
Epoch: 19, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.385 Vali Acc: 0.825 Test Loss: 0.385 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 20 cost time: 1.3401601314544678
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.379 Vali Acc: 0.825 Test Loss: 0.379 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 21 cost time: 1.3859684467315674
Epoch: 21, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.374 Vali Acc: 0.825 Test Loss: 0.374 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 22 cost time: 1.2390689849853516
Epoch: 22, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.825 Test Loss: 0.369 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 23 cost time: 1.1608572006225586
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.365 Vali Acc: 0.825 Test Loss: 0.365 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 24 cost time: 1.1890370845794678
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.363 Vali Acc: 0.825 Test Loss: 0.363 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 25 cost time: 1.2971088886260986
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.825 Test Loss: 0.360 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 26 cost time: 1.132025957107544
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.800 Test Loss: 0.358 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7256436347961426
Epoch: 27, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.800 Test Loss: 0.356 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5650873184204102
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.353 Vali Acc: 0.800 Test Loss: 0.353 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.245025873184204
Epoch: 29, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.349 Vali Acc: 0.800 Test Loss: 0.349 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2045917510986328
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.346 Vali Acc: 0.825 Test Loss: 0.346 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824997).  Saving model ...
Epoch: 31 cost time: 1.3062856197357178
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.825 Test Loss: 0.342 Test Acc: 0.825
Validation loss decreased (-0.824997 --> -0.824997).  Saving model ...
Epoch: 32 cost time: 1.2276771068572998
Epoch: 32, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.339 Vali Acc: 0.825 Test Loss: 0.339 Test Acc: 0.825
Validation loss decreased (-0.824997 --> -0.824997).  Saving model ...
Epoch: 33 cost time: 1.4344913959503174
Epoch: 33, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.825 Test Loss: 0.335 Test Acc: 0.825
Validation loss decreased (-0.824997 --> -0.824997).  Saving model ...
Epoch: 34 cost time: 1.3894424438476562
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
Validation loss decreased (-0.824997 --> -0.849997).  Saving model ...
Epoch: 35 cost time: 1.3753337860107422
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 36 cost time: 1.2908689975738525
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.850 Test Loss: 0.325 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 37 cost time: 1.235020399093628
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.850 Test Loss: 0.323 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 38 cost time: 1.315079927444458
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 39 cost time: 1.2599072456359863
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.850 Test Loss: 0.320 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 40 cost time: 1.3158535957336426
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.850 Test Loss: 0.318 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 41 cost time: 1.4173381328582764
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.850 Test Loss: 0.317 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 42 cost time: 1.2184066772460938
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.315 Vali Acc: 0.850 Test Loss: 0.315 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 43 cost time: 1.2492122650146484
Epoch: 43, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 44 cost time: 1.2250211238861084
Epoch: 44, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 45 cost time: 1.175847053527832
Epoch: 45, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.311 Vali Acc: 0.850 Test Loss: 0.311 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 46 cost time: 1.2186801433563232
Epoch: 46, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.850 Test Loss: 0.310 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 47 cost time: 1.1950972080230713
Epoch: 47, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.850 Test Loss: 0.309 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 48 cost time: 1.1734964847564697
Epoch: 48, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.850 Test Loss: 0.308 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 49 cost time: 1.2585930824279785
Epoch: 49, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.850 Test Loss: 0.307 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 50 cost time: 1.2502810955047607
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.850 Test Loss: 0.306 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 51 cost time: 1.2798819541931152
Epoch: 51, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.850 Test Loss: 0.305 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 52 cost time: 1.3738024234771729
Epoch: 52, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 53 cost time: 1.2754955291748047
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.850 Test Loss: 0.304 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 54 cost time: 1.2307579517364502
Epoch: 54, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.850 Test Loss: 0.302 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 55 cost time: 1.1525342464447021
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.850 Test Loss: 0.301 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 56 cost time: 1.1645798683166504
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 57 cost time: 1.2639214992523193
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.850 Test Loss: 0.300 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 58 cost time: 1.2196240425109863
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 59 cost time: 1.2149109840393066
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 60 cost time: 1.2202112674713135
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.850 Test Loss: 0.299 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 61 cost time: 1.2694454193115234
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 62 cost time: 1.233853816986084
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.850 Test Loss: 0.298 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 63 cost time: 1.4617300033569336
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.850 Test Loss: 0.296 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 64 cost time: 1.2991180419921875
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.849997 --> -0.874997).  Saving model ...
Epoch: 65 cost time: 1.408172845840454
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 66 cost time: 1.3857083320617676
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 67 cost time: 1.36171293258667
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 68 cost time: 1.3054823875427246
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 69 cost time: 1.2611761093139648
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 70 cost time: 1.2577924728393555
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 71 cost time: 1.363436222076416
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 72 cost time: 1.356637954711914
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 73 cost time: 1.2730400562286377
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 74 cost time: 1.1989893913269043
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 75 cost time: 1.1897616386413574
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.875 Test Loss: 0.290 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 76 cost time: 1.1899094581604004
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.875 Test Loss: 0.289 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 77 cost time: 1.2046682834625244
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
Validation loss decreased (-0.874997 --> -0.899997).  Saving model ...
Epoch: 78 cost time: 1.241997480392456
Epoch: 78, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 79 cost time: 1.257333517074585
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 80 cost time: 1.1770493984222412
Epoch: 80, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 81 cost time: 1.1714391708374023
Epoch: 81, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 82 cost time: 1.2956297397613525
Epoch: 82, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 83 cost time: 1.3683576583862305
Epoch: 83, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 84 cost time: 1.3845713138580322
Epoch: 84, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 85 cost time: 1.3632941246032715
Epoch: 85, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 86 cost time: 1.217848777770996
Epoch: 86, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 87 cost time: 1.202991247177124
Epoch: 87, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 88 cost time: 1.2804045677185059
Epoch: 88, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 89 cost time: 1.3239567279815674
Epoch: 89, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 90 cost time: 1.324524164199829
Epoch: 90, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 91 cost time: 1.5586371421813965
Epoch: 91, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 92 cost time: 1.3690776824951172
Epoch: 92, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 93 cost time: 1.334463119506836
Epoch: 93, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 94 cost time: 1.283076524734497
Epoch: 94, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 95 cost time: 1.3388020992279053
Epoch: 95, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 96 cost time: 1.3436126708984375
Epoch: 96, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 97 cost time: 1.3992302417755127
Epoch: 97, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 98 cost time: 1.4212493896484375
Epoch: 98, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 99 cost time: 1.4015309810638428
Epoch: 99, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 100 cost time: 1.3348569869995117
Epoch: 100, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.960003137588501
Epoch: 1, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.470519781112671
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.194 Vali Acc: 0.525 Test Loss: 1.194 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 3 cost time: 1.3085787296295166
Epoch: 3, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 1.22117280960083
Epoch: 4, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.010 Vali Acc: 0.700 Test Loss: 1.010 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 1.2313096523284912
Epoch: 5, Steps: 3 | Train Loss: 0.843 Vali Loss: 0.906 Vali Acc: 0.775 Test Loss: 0.906 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 1.2177965641021729
Epoch: 6, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.813 Vali Acc: 0.800 Test Loss: 0.813 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 1.2749297618865967
Epoch: 7, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.736 Vali Acc: 0.825 Test Loss: 0.736 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 1.344101905822754
Epoch: 8, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 1.3117201328277588
Epoch: 9, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4246363639831543
Epoch: 10, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2457630634307861
Epoch: 11, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 1.2715210914611816
Epoch: 12, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2058517932891846
Epoch: 13, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.154468297958374
Epoch: 14, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2851366996765137
Epoch: 15, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.276280403137207
Epoch: 16, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.567 Vali Acc: 0.800 Test Loss: 0.567 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3039581775665283
Epoch: 17, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4244940280914307
Epoch: 18, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.554 Vali Acc: 0.825 Test Loss: 0.554 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2447283267974854
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2136282920837402
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.528 Vali Acc: 0.825 Test Loss: 0.528 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2395987510681152
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.523 Vali Acc: 0.825 Test Loss: 0.523 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.699131488800049
Epoch: 1, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.383 Vali Acc: 0.375 Test Loss: 1.383 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.41037917137146
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.371 Vali Acc: 0.425 Test Loss: 1.371 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 1.4324488639831543
Epoch: 3, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.346 Vali Acc: 0.450 Test Loss: 1.346 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.3126938343048096
Epoch: 4, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.312 Vali Acc: 0.450 Test Loss: 1.312 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.4478795528411865
Epoch: 5, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.3060417175292969
Epoch: 6, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.234 Vali Acc: 0.525 Test Loss: 1.234 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.3078742027282715
Epoch: 7, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.3990461826324463
Epoch: 8, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 1.345832347869873
Epoch: 9, Steps: 3 | Train Loss: 0.690 Vali Loss: 1.119 Vali Acc: 0.625 Test Loss: 1.119 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.324369192123413
Epoch: 10, Steps: 3 | Train Loss: 0.524 Vali Loss: 1.090 Vali Acc: 0.675 Test Loss: 1.090 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 1.2868092060089111
Epoch: 11, Steps: 3 | Train Loss: 0.407 Vali Loss: 1.061 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 1.2062797546386719
Epoch: 12, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.031 Vali Acc: 0.700 Test Loss: 1.031 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 13 cost time: 1.2818045616149902
Epoch: 13, Steps: 3 | Train Loss: 0.291 Vali Loss: 1.004 Vali Acc: 0.700 Test Loss: 1.004 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.2244181632995605
Epoch: 14, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.970 Vali Acc: 0.700 Test Loss: 0.970 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 1.353987455368042
Epoch: 15, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.957 Vali Acc: 0.700 Test Loss: 0.957 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 1.2910339832305908
Epoch: 16, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.941 Vali Acc: 0.700 Test Loss: 0.941 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 1.2531328201293945
Epoch: 17, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.923 Vali Acc: 0.700 Test Loss: 0.923 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 1.358069658279419
Epoch: 18, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 19 cost time: 1.2397103309631348
Epoch: 19, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 1.1898763179779053
Epoch: 20, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.852 Vali Acc: 0.700 Test Loss: 0.852 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 1.1976995468139648
Epoch: 21, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.836 Vali Acc: 0.700 Test Loss: 0.836 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 22 cost time: 1.1922097206115723
Epoch: 22, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.826 Vali Acc: 0.700 Test Loss: 0.826 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 23 cost time: 1.3188607692718506
Epoch: 23, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.815 Vali Acc: 0.700 Test Loss: 0.815 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 1.565692663192749
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.810 Vali Acc: 0.700 Test Loss: 0.810 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 25 cost time: 1.3166782855987549
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.805 Vali Acc: 0.700 Test Loss: 0.805 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 26 cost time: 1.2014782428741455
Epoch: 26, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.803 Vali Acc: 0.700 Test Loss: 0.803 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 27 cost time: 1.1794898509979248
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.802 Vali Acc: 0.700 Test Loss: 0.802 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 28 cost time: 1.22395658493042
Epoch: 28, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.802 Vali Acc: 0.700 Test Loss: 0.802 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 29 cost time: 1.2800819873809814
Epoch: 29, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.796 Vali Acc: 0.700 Test Loss: 0.796 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 30 cost time: 1.2189507484436035
Epoch: 30, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.792 Vali Acc: 0.700 Test Loss: 0.792 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 31 cost time: 1.468846082687378
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.784 Vali Acc: 0.700 Test Loss: 0.784 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 32 cost time: 1.2566757202148438
Epoch: 32, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.776 Vali Acc: 0.700 Test Loss: 0.776 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 33 cost time: 1.2995851039886475
Epoch: 33, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.769 Vali Acc: 0.725 Test Loss: 0.769 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 34 cost time: 1.2820451259613037
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.761 Vali Acc: 0.725 Test Loss: 0.761 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 35 cost time: 1.3243281841278076
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.753 Vali Acc: 0.725 Test Loss: 0.753 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 36 cost time: 1.2371091842651367
Epoch: 36, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.746 Vali Acc: 0.725 Test Loss: 0.746 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724993).  Saving model ...
Epoch: 37 cost time: 1.2779619693756104
Epoch: 37, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.744 Vali Acc: 0.725 Test Loss: 0.744 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 38 cost time: 1.3081698417663574
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.741 Vali Acc: 0.725 Test Loss: 0.741 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 39 cost time: 1.3367176055908203
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.725 Test Loss: 0.740 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 40 cost time: 1.2021608352661133
Epoch: 40, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.725 Test Loss: 0.738 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 41 cost time: 1.2302830219268799
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.737 Vali Acc: 0.725 Test Loss: 0.737 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 42 cost time: 1.2193210124969482
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.734 Vali Acc: 0.725 Test Loss: 0.734 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 43 cost time: 1.3316075801849365
Epoch: 43, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.733 Vali Acc: 0.725 Test Loss: 0.733 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 44 cost time: 1.2668695449829102
Epoch: 44, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.725 Test Loss: 0.732 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 45 cost time: 1.2188830375671387
Epoch: 45, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.725 Test Loss: 0.732 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 46 cost time: 1.1659235954284668
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.725 Test Loss: 0.730 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 47 cost time: 1.1448352336883545
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.725 Test Loss: 0.729 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 48 cost time: 1.2291607856750488
Epoch: 48, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.725 Test Loss: 0.729 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2442371845245361
Epoch: 49, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.725 Test Loss: 0.728 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 50 cost time: 1.2744357585906982
Epoch: 50, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.725 Test Loss: 0.724 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 51 cost time: 1.260819911956787
Epoch: 51, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.725 Test Loss: 0.720 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 52 cost time: 1.1053237915039062
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.725 Test Loss: 0.717 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 53 cost time: 1.0440216064453125
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.725 Test Loss: 0.714 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 54 cost time: 1.1532847881317139
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.725 Test Loss: 0.710 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 55 cost time: 1.1144752502441406
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.725 Test Loss: 0.706 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 56 cost time: 1.3762681484222412
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.725 Test Loss: 0.704 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 57 cost time: 1.192018985748291
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.725 Test Loss: 0.703 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 58 cost time: 1.1850414276123047
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.702 Vali Acc: 0.725 Test Loss: 0.702 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 59 cost time: 1.1013288497924805
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.725 Test Loss: 0.701 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 60 cost time: 1.1444716453552246
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.725 Test Loss: 0.699 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 61 cost time: 1.1657910346984863
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 62 cost time: 1.13912034034729
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2707717418670654
Epoch: 63, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 64 cost time: 1.2863798141479492
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 65 cost time: 1.3095533847808838
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 66 cost time: 1.2599058151245117
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2613952159881592
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.725 Test Loss: 0.699 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3401291370391846
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.725 Test Loss: 0.700 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.356407642364502
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.725 Test Loss: 0.701 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.5635590553283691
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.725 Test Loss: 0.700 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.4631834030151367
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.725 Test Loss: 0.699 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.3260705471038818
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.3035836219787598
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.725 Test Loss: 0.699 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.3665809631347656
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.725 Test Loss: 0.699 Test Acc: 0.725
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.330007553100586
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.725 Test Loss: 0.701 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.725
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4982640743255615
Epoch: 1, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.402 Vali Acc: 0.225 Test Loss: 1.402 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.3402385711669922
Epoch: 2, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.399 Vali Acc: 0.225 Test Loss: 1.399 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.3917460441589355
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.388 Vali Acc: 0.300 Test Loss: 1.388 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.3925726413726807
Epoch: 4, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.2014894485473633
Epoch: 5, Steps: 3 | Train Loss: 1.227 Vali Loss: 1.365 Vali Acc: 0.275 Test Loss: 1.365 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4475843906402588
Epoch: 6, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.357 Vali Acc: 0.300 Test Loss: 1.357 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3869729042053223
Epoch: 7, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.346 Vali Acc: 0.300 Test Loss: 1.346 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2016315460205078
Epoch: 8, Steps: 3 | Train Loss: 0.924 Vali Loss: 1.333 Vali Acc: 0.300 Test Loss: 1.333 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3054282665252686
Epoch: 9, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 10 cost time: 1.4191312789916992
Epoch: 10, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.288 Vali Acc: 0.350 Test Loss: 1.288 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 11 cost time: 1.356562614440918
Epoch: 11, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.272 Vali Acc: 0.350 Test Loss: 1.272 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 12 cost time: 1.1581740379333496
Epoch: 12, Steps: 3 | Train Loss: 0.558 Vali Loss: 1.278 Vali Acc: 0.325 Test Loss: 1.278 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2266297340393066
Epoch: 13, Steps: 3 | Train Loss: 0.454 Vali Loss: 1.285 Vali Acc: 0.275 Test Loss: 1.285 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.140587568283081
Epoch: 14, Steps: 3 | Train Loss: 0.402 Vali Loss: 1.279 Vali Acc: 0.350 Test Loss: 1.279 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2295951843261719
Epoch: 15, Steps: 3 | Train Loss: 0.347 Vali Loss: 1.287 Vali Acc: 0.325 Test Loss: 1.287 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2668352127075195
Epoch: 16, Steps: 3 | Train Loss: 0.311 Vali Loss: 1.291 Vali Acc: 0.325 Test Loss: 1.291 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2257087230682373
Epoch: 17, Steps: 3 | Train Loss: 0.248 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 18 cost time: 1.3629076480865479
Epoch: 18, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 19 cost time: 1.3128721714019775
Epoch: 19, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 1.2069268226623535
Epoch: 20, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.236 Vali Acc: 0.425 Test Loss: 1.236 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 21 cost time: 1.1748764514923096
Epoch: 21, Steps: 3 | Train Loss: 0.089 Vali Loss: 1.251 Vali Acc: 0.425 Test Loss: 1.251 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2441797256469727
Epoch: 22, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.398843765258789
Epoch: 23, Steps: 3 | Train Loss: 0.083 Vali Loss: 1.281 Vali Acc: 0.375 Test Loss: 1.281 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6531791687011719
Epoch: 24, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.309671401977539
Epoch: 25, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.207 Vali Acc: 0.425 Test Loss: 1.207 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 26 cost time: 1.1979525089263916
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.190 Vali Acc: 0.450 Test Loss: 1.190 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 27 cost time: 1.3367667198181152
Epoch: 27, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 28 cost time: 1.200789451599121
Epoch: 28, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.135 Vali Acc: 0.525 Test Loss: 1.135 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 29 cost time: 1.3550655841827393
Epoch: 29, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.129 Vali Acc: 0.525 Test Loss: 1.129 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 30 cost time: 1.296879529953003
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3674588203430176
Epoch: 31, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2874481678009033
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1965622901916504
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.345909595489502
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.126 Vali Acc: 0.550 Test Loss: 1.126 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 35 cost time: 1.3009328842163086
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.113 Vali Acc: 0.550 Test Loss: 1.113 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 36 cost time: 1.298039197921753
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 37 cost time: 1.1793444156646729
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.096 Vali Acc: 0.550 Test Loss: 1.096 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 38 cost time: 1.2042515277862549
Epoch: 38, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.092 Vali Acc: 0.550 Test Loss: 1.092 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 39 cost time: 1.1295666694641113
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.091 Vali Acc: 0.550 Test Loss: 1.091 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 40 cost time: 1.1242921352386475
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.090 Vali Acc: 0.550 Test Loss: 1.090 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 41 cost time: 1.2198054790496826
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.088 Vali Acc: 0.550 Test Loss: 1.088 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 42 cost time: 1.333350419998169
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.087 Vali Acc: 0.550 Test Loss: 1.087 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 43 cost time: 1.37496018409729
Epoch: 43, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.087 Vali Acc: 0.550 Test Loss: 1.087 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 44 cost time: 1.3141939640045166
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.575 Test Loss: 1.090 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 45 cost time: 1.2621169090270996
Epoch: 45, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.092 Vali Acc: 0.575 Test Loss: 1.092 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3582756519317627
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.094 Vali Acc: 0.575 Test Loss: 1.094 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2341597080230713
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.092 Vali Acc: 0.575 Test Loss: 1.092 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.371530294418335
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.095 Vali Acc: 0.575 Test Loss: 1.095 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3242876529693604
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.098 Vali Acc: 0.575 Test Loss: 1.098 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2967290878295898
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.104 Vali Acc: 0.575 Test Loss: 1.104 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.3717436790466309
Epoch: 51, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.575 Test Loss: 1.111 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2301833629608154
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.109 Vali Acc: 0.575 Test Loss: 1.109 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3337574005126953
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.105 Vali Acc: 0.575 Test Loss: 1.105 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.3557565212249756
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.103 Vali Acc: 0.575 Test Loss: 1.103 Test Acc: 0.575
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.575
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.242586851119995
Epoch: 1, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.459 Vali Acc: 0.225 Test Loss: 1.459 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 1.2953460216522217
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.452 Vali Acc: 0.225 Test Loss: 1.452 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 1.2845792770385742
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.434 Vali Acc: 0.225 Test Loss: 1.434 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 1.2834572792053223
Epoch: 4, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.414 Vali Acc: 0.225 Test Loss: 1.414 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 1.2994823455810547
Epoch: 5, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.391 Vali Acc: 0.250 Test Loss: 1.391 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.2789783477783203
Epoch: 6, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.368 Vali Acc: 0.225 Test Loss: 1.368 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3327746391296387
Epoch: 7, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.345 Vali Acc: 0.275 Test Loss: 1.345 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 8 cost time: 1.3482980728149414
Epoch: 8, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 1.4472622871398926
Epoch: 9, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.291 Vali Acc: 0.375 Test Loss: 1.291 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 1.30318021774292
Epoch: 10, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.267 Vali Acc: 0.475 Test Loss: 1.267 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 1.3371784687042236
Epoch: 11, Steps: 3 | Train Loss: 0.657 Vali Loss: 1.245 Vali Acc: 0.450 Test Loss: 1.245 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1790547370910645
Epoch: 12, Steps: 3 | Train Loss: 0.503 Vali Loss: 1.239 Vali Acc: 0.375 Test Loss: 1.239 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1914033889770508
Epoch: 13, Steps: 3 | Train Loss: 0.447 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.202124834060669
Epoch: 14, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3338656425476074
Epoch: 15, Steps: 3 | Train Loss: 0.299 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3029029369354248
Epoch: 16, Steps: 3 | Train Loss: 0.292 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.49232816696167
Epoch: 17, Steps: 3 | Train Loss: 0.213 Vali Loss: 1.167 Vali Acc: 0.425 Test Loss: 1.167 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3216874599456787
Epoch: 18, Steps: 3 | Train Loss: 0.152 Vali Loss: 1.145 Vali Acc: 0.450 Test Loss: 1.145 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2668967247009277
Epoch: 19, Steps: 3 | Train Loss: 0.157 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 1.1398568153381348
Epoch: 20, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.108 Vali Acc: 0.525 Test Loss: 1.108 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 21 cost time: 1.2217657566070557
Epoch: 21, Steps: 3 | Train Loss: 0.094 Vali Loss: 1.109 Vali Acc: 0.525 Test Loss: 1.109 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0967955589294434
Epoch: 22, Steps: 3 | Train Loss: 0.082 Vali Loss: 1.095 Vali Acc: 0.525 Test Loss: 1.095 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 23 cost time: 1.2518887519836426
Epoch: 23, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.074 Vali Acc: 0.525 Test Loss: 1.074 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 24 cost time: 1.1847398281097412
Epoch: 24, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.052 Vali Acc: 0.525 Test Loss: 1.052 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 25 cost time: 1.276313066482544
Epoch: 25, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.040 Vali Acc: 0.525 Test Loss: 1.040 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524990).  Saving model ...
Epoch: 26 cost time: 1.1326978206634521
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.053 Vali Acc: 0.500 Test Loss: 1.053 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.264115571975708
Epoch: 27, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.039 Vali Acc: 0.525 Test Loss: 1.039 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 28 cost time: 1.1529583930969238
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.014 Vali Acc: 0.525 Test Loss: 1.014 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 29 cost time: 1.292959451675415
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.989 Vali Acc: 0.525 Test Loss: 0.989 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 30 cost time: 1.3442189693450928
Epoch: 30, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.979 Vali Acc: 0.525 Test Loss: 0.979 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 31 cost time: 1.2091262340545654
Epoch: 31, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.972 Vali Acc: 0.525 Test Loss: 0.972 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 32 cost time: 1.256788969039917
Epoch: 32, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.966 Vali Acc: 0.525 Test Loss: 0.966 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 33 cost time: 1.3341424465179443
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.960 Vali Acc: 0.550 Test Loss: 0.960 Test Acc: 0.550
Validation loss decreased (-0.524990 --> -0.549990).  Saving model ...
Epoch: 34 cost time: 1.2619283199310303
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.959 Vali Acc: 0.575 Test Loss: 0.959 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 35 cost time: 1.3595833778381348
Epoch: 35, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.954 Vali Acc: 0.575 Test Loss: 0.954 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 36 cost time: 1.4014813899993896
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.947 Vali Acc: 0.575 Test Loss: 0.947 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574991).  Saving model ...
Epoch: 37 cost time: 1.217893123626709
Epoch: 37, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.940 Vali Acc: 0.575 Test Loss: 0.940 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 38 cost time: 1.4703996181488037
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.927 Vali Acc: 0.575 Test Loss: 0.927 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 39 cost time: 1.3183350563049316
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.923 Vali Acc: 0.600 Test Loss: 0.923 Test Acc: 0.600
Validation loss decreased (-0.574991 --> -0.599991).  Saving model ...
Epoch: 40 cost time: 1.2555301189422607
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.600 Test Loss: 0.924 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2855191230773926
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.600 Test Loss: 0.924 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.190230131149292
Epoch: 42, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.923 Vali Acc: 0.600 Test Loss: 0.923 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 43 cost time: 1.2511703968048096
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.923 Vali Acc: 0.600 Test Loss: 0.923 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 44 cost time: 1.4117918014526367
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.924 Vali Acc: 0.600 Test Loss: 0.924 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3101999759674072
Epoch: 45, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.923 Vali Acc: 0.575 Test Loss: 0.923 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.278223991394043
Epoch: 46, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.921 Vali Acc: 0.575 Test Loss: 0.921 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2878198623657227
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.916 Vali Acc: 0.575 Test Loss: 0.916 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1741807460784912
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.915 Vali Acc: 0.575 Test Loss: 0.915 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2656786441802979
Epoch: 49, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.915 Vali Acc: 0.575 Test Loss: 0.915 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2804248332977295
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.917 Vali Acc: 0.575 Test Loss: 0.917 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.3603572845458984
Epoch: 51, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.919 Vali Acc: 0.575 Test Loss: 0.919 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.1307568550109863
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.920 Vali Acc: 0.575 Test Loss: 0.920 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.1633002758026123
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.921 Vali Acc: 0.575 Test Loss: 0.921 Test Acc: 0.575
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5858688354492188
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1694984436035156
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.1779463291168213
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.2503974437713623
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.371727705001831
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.41398286819458
Epoch: 6, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.4550440311431885
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3687779903411865
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.268425703048706
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.2886979579925537
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3509697914123535
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.414560317993164
Epoch: 12, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.3507201671600342
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3757710456848145
Epoch: 14, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5109755992889404
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3253684043884277
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3547239303588867
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.373504638671875
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.337965488433838
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1760330200195312
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1259584426879883
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1018791198730469
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 2230660
model size : 13.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7961182594299316
Epoch: 1, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.496 Vali Acc: 0.200 Test Loss: 1.496 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.2903838157653809
Epoch: 2, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.417 Vali Acc: 0.375 Test Loss: 1.417 Test Acc: 0.375
Validation loss decreased (-0.199985 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.3645272254943848
Epoch: 3, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.303 Vali Acc: 0.550 Test Loss: 1.303 Test Acc: 0.550
Validation loss decreased (-0.374986 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 1.350374460220337
Epoch: 4, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.175 Vali Acc: 0.625 Test Loss: 1.175 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 1.2334685325622559
Epoch: 5, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.047 Vali Acc: 0.650 Test Loss: 1.047 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 1.4262151718139648
Epoch: 6, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.480423927307129
Epoch: 7, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.766 Vali Acc: 0.850 Test Loss: 0.766 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.40690279006958
Epoch: 8, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.1376943588256836
Epoch: 9, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 1.2238092422485352
Epoch: 10, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.2624566555023193
Epoch: 11, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 1.3242437839508057
Epoch: 12, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 1.390049934387207
Epoch: 13, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 1.4516503810882568
Epoch: 14, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 1.3714971542358398
Epoch: 15, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 1.2922029495239258
Epoch: 16, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 1.1982238292694092
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 1.2376883029937744
Epoch: 18, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 1.4273786544799805
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 1.3660101890563965
Epoch: 20, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.5255844593048096
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.4034531116485596
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.2547705173492432
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.378486156463623
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 1.3898298740386963
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 1.3256800174713135
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.2935268878936768
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.3910932540893555
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 1.2359681129455566
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 1.465101718902588
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 1.370516061782837
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 1.229907512664795
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 1.2456822395324707
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 1.2892417907714844
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 1.2655527591705322
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 1.1594123840332031
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 1.297593593597412
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 1.3029251098632812
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 1.4203200340270996
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 1.3575828075408936
Epoch: 40, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 1.4846913814544678
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 1.1465034484863281
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 1.2404279708862305
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 1.332263469696045
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 1.365142822265625
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 1.4726545810699463
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 1.4371306896209717
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 1.3231117725372314
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 1.2905933856964111
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2767305374145508
Epoch: 50, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2514228820800781
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 1.4001708030700684
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 1.4118149280548096
Epoch: 53, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 1.2913968563079834
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 55 cost time: 1.3901522159576416
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 1.3526535034179688
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 1.2580816745758057
Epoch: 57, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 1.338491678237915
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 1.2127747535705566
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 1.1829149723052979
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 61 cost time: 1.0959291458129883
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 62 cost time: 1.3826994895935059
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 63 cost time: 1.2321021556854248
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 64 cost time: 1.3224449157714844
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 65 cost time: 1.5277180671691895
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 66 cost time: 1.5322072505950928
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 67 cost time: 1.2882649898529053
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 1.2841346263885498
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 1.2616469860076904
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 70 cost time: 1.1791300773620605
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 71 cost time: 1.3359909057617188
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 1.261098861694336
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 73 cost time: 1.1953365802764893
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 1.2734100818634033
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 75 cost time: 1.1619393825531006
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 76 cost time: 1.3029024600982666
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 77 cost time: 1.423140287399292
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 78 cost time: 1.4003159999847412
Epoch: 78, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 79 cost time: 1.4515392780303955
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 80 cost time: 1.3277404308319092
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 81 cost time: 1.3549473285675049
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 82 cost time: 1.3404829502105713
Epoch: 82, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 83 cost time: 1.3470072746276855
Epoch: 83, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 84 cost time: 1.506528615951538
Epoch: 84, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 85 cost time: 1.3830029964447021
Epoch: 85, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 86 cost time: 1.5804731845855713
Epoch: 86, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 87 cost time: 1.6248040199279785
Epoch: 87, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.4284265041351318
Epoch: 88, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.3736493587493896
Epoch: 89, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.43605637550354
Epoch: 90, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.356658697128296
Epoch: 91, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.254495620727539
Epoch: 92, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.2682008743286133
Epoch: 93, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.3265130519866943
Epoch: 94, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.2754926681518555
Epoch: 95, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 1.4015452861785889
Epoch: 96, Steps: 3 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.65989351272583
Epoch: 1, Steps: 3 | Train Loss: 1.565 Vali Loss: 1.515 Vali Acc: 0.175 Test Loss: 1.515 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 1.307901382446289
Epoch: 2, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.432 Vali Acc: 0.300 Test Loss: 1.432 Test Acc: 0.300
Validation loss decreased (-0.174985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.2527143955230713
Epoch: 3, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.318 Vali Acc: 0.525 Test Loss: 1.318 Test Acc: 0.525
Validation loss decreased (-0.299986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 1.2893757820129395
Epoch: 4, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.190 Vali Acc: 0.650 Test Loss: 1.190 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 1.2643582820892334
Epoch: 5, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.062 Vali Acc: 0.675 Test Loss: 1.062 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 1.297257661819458
Epoch: 6, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.925 Vali Acc: 0.750 Test Loss: 0.925 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.2411763668060303
Epoch: 7, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.2149386405944824
Epoch: 8, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.666 Vali Acc: 0.900 Test Loss: 0.666 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 1.3783037662506104
Epoch: 9, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 1.408224105834961
Epoch: 10, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.428816795349121
Epoch: 11, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.3935039043426514
Epoch: 12, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 1.2974638938903809
Epoch: 13, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.2923989295959473
Epoch: 14, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2569561004638672
Epoch: 15, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 1.287998914718628
Epoch: 16, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 1.2912647724151611
Epoch: 17, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 1.2131400108337402
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 1.2504675388336182
Epoch: 19, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.2750630378723145
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 1.2523701190948486
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 1.2617006301879883
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.2808048725128174
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.3854124546051025
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.1334612369537354
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.275714635848999
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.2333145141601562
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.2542459964752197
Epoch: 28, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 1.513970136642456
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 1.4944286346435547
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 1.3364965915679932
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 1.360802412033081
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 1.1882052421569824
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 1.3143048286437988
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 1.367335557937622
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.4057843685150146
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.2893893718719482
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.3107531070709229
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 1.2639610767364502
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 1.2665283679962158
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.2597007751464844
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.2992222309112549
Epoch: 42, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.320868730545044
Epoch: 43, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2904136180877686
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3795785903930664
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2894692420959473
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2363440990447998
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.3719768524169922
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.4437484741210938
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3947789669036865
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.370509386062622
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.37380051612854
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.752699136734009
Epoch: 1, Steps: 3 | Train Loss: 1.575 Vali Loss: 1.539 Vali Acc: 0.200 Test Loss: 1.539 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.1466662883758545
Epoch: 2, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.453 Vali Acc: 0.275 Test Loss: 1.453 Test Acc: 0.275
Validation loss decreased (-0.199985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 1.2361996173858643
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
Validation loss decreased (-0.274985 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.332685947418213
Epoch: 4, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.221 Vali Acc: 0.650 Test Loss: 1.221 Test Acc: 0.650
Validation loss decreased (-0.499987 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 1.2858011722564697
Epoch: 5, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.098 Vali Acc: 0.700 Test Loss: 1.098 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 1.1880362033843994
Epoch: 6, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.964 Vali Acc: 0.775 Test Loss: 0.964 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 1.1920480728149414
Epoch: 7, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 1.2102577686309814
Epoch: 8, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.715 Vali Acc: 0.875 Test Loss: 0.715 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.1721458435058594
Epoch: 9, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.625 Vali Acc: 0.925 Test Loss: 0.625 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 1.1801564693450928
Epoch: 10, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.558 Vali Acc: 0.925 Test Loss: 0.558 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 1.1523847579956055
Epoch: 11, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.511 Vali Acc: 0.925 Test Loss: 0.511 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.1723277568817139
Epoch: 12, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.477 Vali Acc: 0.925 Test Loss: 0.477 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 1.1997597217559814
Epoch: 13, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.182572603225708
Epoch: 14, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0379118919372559
Epoch: 15, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2065086364746094
Epoch: 16, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1372432708740234
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2927091121673584
Epoch: 18, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2378692626953125
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2613513469696045
Epoch: 20, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.275984764099121
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2764561176300049
Epoch: 22, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.823333978652954
Epoch: 1, Steps: 3 | Train Loss: 1.535 Vali Loss: 1.504 Vali Acc: 0.175 Test Loss: 1.504 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 1.3495068550109863
Epoch: 2, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.423 Vali Acc: 0.300 Test Loss: 1.423 Test Acc: 0.300
Validation loss decreased (-0.174985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.3797519207000732
Epoch: 3, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.314 Vali Acc: 0.600 Test Loss: 1.314 Test Acc: 0.600
Validation loss decreased (-0.299986 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 1.2677206993103027
Epoch: 4, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.189 Vali Acc: 0.675 Test Loss: 1.189 Test Acc: 0.675
Validation loss decreased (-0.599987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 1.3863039016723633
Epoch: 5, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.064 Vali Acc: 0.675 Test Loss: 1.064 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 1.4637386798858643
Epoch: 6, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.935 Vali Acc: 0.725 Test Loss: 0.935 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 1.1535344123840332
Epoch: 7, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.812 Vali Acc: 0.725 Test Loss: 0.812 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 8 cost time: 1.292245864868164
Epoch: 8, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.707 Vali Acc: 0.800 Test Loss: 0.707 Test Acc: 0.800
Validation loss decreased (-0.724992 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.1783702373504639
Epoch: 9, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.629 Vali Acc: 0.800 Test Loss: 0.629 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.1532814502716064
Epoch: 10, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 1.2589335441589355
Epoch: 11, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.524 Vali Acc: 0.800 Test Loss: 0.524 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 12 cost time: 1.1858539581298828
Epoch: 12, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.497 Vali Acc: 0.800 Test Loss: 0.497 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 1.2053651809692383
Epoch: 13, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.482 Vali Acc: 0.800 Test Loss: 0.482 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 1.2580375671386719
Epoch: 14, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.485 Vali Acc: 0.775 Test Loss: 0.485 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4879586696624756
Epoch: 15, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.800 Test Loss: 0.489 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4291799068450928
Epoch: 16, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.486 Vali Acc: 0.775 Test Loss: 0.486 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2051324844360352
Epoch: 17, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.775 Test Loss: 0.480 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1933536529541016
Epoch: 18, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.470 Vali Acc: 0.775 Test Loss: 0.470 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3230085372924805
Epoch: 19, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.459 Vali Acc: 0.775 Test Loss: 0.459 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.258908748626709
Epoch: 20, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.775 Test Loss: 0.450 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3373103141784668
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.442 Vali Acc: 0.775 Test Loss: 0.442 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3667001724243164
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.438 Vali Acc: 0.775 Test Loss: 0.438 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.406045913696289
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.434 Vali Acc: 0.800 Test Loss: 0.434 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 24 cost time: 1.4276056289672852
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.430 Vali Acc: 0.800 Test Loss: 0.430 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 25 cost time: 1.3897995948791504
Epoch: 25, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.426 Vali Acc: 0.800 Test Loss: 0.426 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 26 cost time: 1.3022713661193848
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.421 Vali Acc: 0.800 Test Loss: 0.421 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 27 cost time: 1.3449182510375977
Epoch: 27, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.800 Test Loss: 0.417 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 28 cost time: 1.2921783924102783
Epoch: 28, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.413 Vali Acc: 0.800 Test Loss: 0.413 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 29 cost time: 1.4369146823883057
Epoch: 29, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.409 Vali Acc: 0.800 Test Loss: 0.409 Test Acc: 0.800
Validation loss decreased (-0.799996 --> -0.799996).  Saving model ...
Epoch: 30 cost time: 1.3721046447753906
Epoch: 30, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.405 Vali Acc: 0.775 Test Loss: 0.405 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3564062118530273
Epoch: 31, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.400 Vali Acc: 0.775 Test Loss: 0.400 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1741693019866943
Epoch: 32, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.394 Vali Acc: 0.775 Test Loss: 0.394 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3003332614898682
Epoch: 33, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.390 Vali Acc: 0.775 Test Loss: 0.390 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.433368444442749
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.775 Test Loss: 0.385 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.297037124633789
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.775 Test Loss: 0.382 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.353693962097168
Epoch: 36, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.775 Test Loss: 0.380 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4535856246948242
Epoch: 37, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.775 Test Loss: 0.377 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4913485050201416
Epoch: 38, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.775 Test Loss: 0.375 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.315932035446167
Epoch: 39, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.775 Test Loss: 0.372 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.0016367435455322
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.421 Vali Acc: 0.450 Test Loss: 1.421 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 1.3821406364440918
Epoch: 2, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.352 Vali Acc: 0.475 Test Loss: 1.352 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 3 cost time: 1.3381555080413818
Epoch: 3, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.262 Vali Acc: 0.550 Test Loss: 1.262 Test Acc: 0.550
Validation loss decreased (-0.474986 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 1.2571742534637451
Epoch: 4, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.157 Vali Acc: 0.550 Test Loss: 1.157 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 1.2989397048950195
Epoch: 5, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.049 Vali Acc: 0.650 Test Loss: 1.049 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 1.252772569656372
Epoch: 6, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.941 Vali Acc: 0.725 Test Loss: 0.941 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 1.1765835285186768
Epoch: 7, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.3116099834442139
Epoch: 8, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 1.271895170211792
Epoch: 9, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 1.2722554206848145
Epoch: 10, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.669 Vali Acc: 0.800 Test Loss: 0.669 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.191413164138794
Epoch: 11, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 12 cost time: 1.2465224266052246
Epoch: 12, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 13 cost time: 1.2634620666503906
Epoch: 13, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 14 cost time: 1.2071125507354736
Epoch: 14, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.277855396270752
Epoch: 15, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 1.300295114517212
Epoch: 16, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 1.3817148208618164
Epoch: 17, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.546 Vali Acc: 0.800 Test Loss: 0.546 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 1.2245540618896484
Epoch: 18, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 1.2451057434082031
Epoch: 19, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 20 cost time: 1.2281982898712158
Epoch: 20, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 1.2213795185089111
Epoch: 21, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 1.327622413635254
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3677525520324707
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4103097915649414
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.544 Vali Acc: 0.800 Test Loss: 0.544 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.508274793624878
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.549 Vali Acc: 0.800 Test Loss: 0.549 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3398706912994385
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3486912250518799
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.313432216644287
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.567 Vali Acc: 0.825 Test Loss: 0.567 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3898167610168457
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3060479164123535
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4224634170532227
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.574 Vali Acc: 0.825 Test Loss: 0.574 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8215854167938232
Epoch: 1, Steps: 3 | Train Loss: 1.547 Vali Loss: 1.419 Vali Acc: 0.350 Test Loss: 1.419 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.3015081882476807
Epoch: 2, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.396 Vali Acc: 0.375 Test Loss: 1.396 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.3185086250305176
Epoch: 3, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 1.2637948989868164
Epoch: 4, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.284522294998169
Epoch: 5, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.268 Vali Acc: 0.425 Test Loss: 1.268 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 1.285297155380249
Epoch: 6, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.177187442779541
Epoch: 7, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.174 Vali Acc: 0.450 Test Loss: 1.174 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 1.3105547428131104
Epoch: 8, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.2821264266967773
Epoch: 9, Steps: 3 | Train Loss: 0.761 Vali Loss: 1.105 Vali Acc: 0.525 Test Loss: 1.105 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 10 cost time: 1.3899343013763428
Epoch: 10, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.069 Vali Acc: 0.550 Test Loss: 1.069 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 1.3545360565185547
Epoch: 11, Steps: 3 | Train Loss: 0.522 Vali Loss: 1.035 Vali Acc: 0.575 Test Loss: 1.035 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574990).  Saving model ...
Epoch: 12 cost time: 1.2199890613555908
Epoch: 12, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.997 Vali Acc: 0.575 Test Loss: 0.997 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 13 cost time: 1.2208361625671387
Epoch: 13, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.952 Vali Acc: 0.600 Test Loss: 0.952 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.428144931793213
Epoch: 14, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.911 Vali Acc: 0.625 Test Loss: 0.911 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624991).  Saving model ...
Epoch: 15 cost time: 1.5025522708892822
Epoch: 15, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.883 Vali Acc: 0.650 Test Loss: 0.883 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 16 cost time: 1.2880706787109375
Epoch: 16, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.854 Vali Acc: 0.650 Test Loss: 0.854 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 17 cost time: 1.2160718441009521
Epoch: 17, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.819 Vali Acc: 0.700 Test Loss: 0.819 Test Acc: 0.700
Validation loss decreased (-0.649991 --> -0.699992).  Saving model ...
Epoch: 18 cost time: 1.4919202327728271
Epoch: 18, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.792 Vali Acc: 0.700 Test Loss: 0.792 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 19 cost time: 1.3059427738189697
Epoch: 19, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.773 Vali Acc: 0.700 Test Loss: 0.773 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 20 cost time: 1.2882344722747803
Epoch: 20, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.768 Vali Acc: 0.700 Test Loss: 0.768 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 21 cost time: 1.3703632354736328
Epoch: 21, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.770 Vali Acc: 0.700 Test Loss: 0.770 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.335303783416748
Epoch: 22, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.774 Vali Acc: 0.700 Test Loss: 0.774 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.384131908416748
Epoch: 23, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.764 Vali Acc: 0.700 Test Loss: 0.764 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 1.5025715827941895
Epoch: 24, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.749 Vali Acc: 0.700 Test Loss: 0.749 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699993).  Saving model ...
Epoch: 25 cost time: 1.409531831741333
Epoch: 25, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.733 Vali Acc: 0.700 Test Loss: 0.733 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 26 cost time: 1.3918612003326416
Epoch: 26, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.712 Vali Acc: 0.700 Test Loss: 0.712 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 27 cost time: 1.465362310409546
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.698 Vali Acc: 0.700 Test Loss: 0.698 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 28 cost time: 1.5540120601654053
Epoch: 28, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.685 Vali Acc: 0.725 Test Loss: 0.685 Test Acc: 0.725
Validation loss decreased (-0.699993 --> -0.724993).  Saving model ...
Epoch: 29 cost time: 1.4241654872894287
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.676 Vali Acc: 0.725 Test Loss: 0.676 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 30 cost time: 1.3339169025421143
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.670 Vali Acc: 0.725 Test Loss: 0.670 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 31 cost time: 1.4961941242218018
Epoch: 31, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 32 cost time: 1.5481369495391846
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.655 Vali Acc: 0.725 Test Loss: 0.655 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 33 cost time: 1.3350317478179932
Epoch: 33, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.651 Vali Acc: 0.725 Test Loss: 0.651 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 34 cost time: 1.359372615814209
Epoch: 34, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.649 Vali Acc: 0.725 Test Loss: 0.649 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724994).  Saving model ...
Epoch: 35 cost time: 1.3769614696502686
Epoch: 35, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.648 Vali Acc: 0.725 Test Loss: 0.648 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 36 cost time: 1.3162932395935059
Epoch: 36, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.647 Vali Acc: 0.725 Test Loss: 0.647 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 37 cost time: 1.3391406536102295
Epoch: 37, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.725 Test Loss: 0.646 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 38 cost time: 1.2669305801391602
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.642 Vali Acc: 0.725 Test Loss: 0.642 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 39 cost time: 1.3325412273406982
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.725 Test Loss: 0.638 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 40 cost time: 1.278285026550293
Epoch: 40, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.637 Vali Acc: 0.725 Test Loss: 0.637 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 41 cost time: 1.3396151065826416
Epoch: 41, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.725 Test Loss: 0.634 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 42 cost time: 1.308295726776123
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.725 Test Loss: 0.633 Test Acc: 0.725
Validation loss decreased (-0.724994 --> -0.724994).  Saving model ...
Epoch: 43 cost time: 1.2163548469543457
Epoch: 43, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.725 Test Loss: 0.634 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.297821044921875
Epoch: 44, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.634 Vali Acc: 0.725 Test Loss: 0.634 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3120386600494385
Epoch: 45, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.725 Test Loss: 0.633 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.4477827548980713
Epoch: 46, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.633 Vali Acc: 0.725 Test Loss: 0.633 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.3834559917449951
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.725 Test Loss: 0.633 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.456477165222168
Epoch: 48, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
Validation loss decreased (-0.724994 --> -0.749994).  Saving model ...
Epoch: 49 cost time: 1.3688786029815674
Epoch: 49, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.3501794338226318
Epoch: 50, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.34633207321167
Epoch: 51, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.632 Vali Acc: 0.750 Test Loss: 0.632 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 52 cost time: 1.2770228385925293
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 53 cost time: 1.367121696472168
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 54 cost time: 1.4463787078857422
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.750 Test Loss: 0.629 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 55 cost time: 1.1745831966400146
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
Validation loss decreased (-0.749994 --> -0.774994).  Saving model ...
Epoch: 56 cost time: 1.239964485168457
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.2646214962005615
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.259903907775879
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 59 cost time: 1.2873194217681885
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 60 cost time: 1.348022222518921
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.775 Test Loss: 0.627 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 61 cost time: 1.5383610725402832
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.775 Test Loss: 0.627 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 62 cost time: 1.3442344665527344
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.775 Test Loss: 0.627 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 63 cost time: 1.3845205307006836
Epoch: 63, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2860028743743896
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.338397741317749
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.775 Test Loss: 0.632 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.4364209175109863
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.775 Test Loss: 0.632 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.2808477878570557
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.775 Test Loss: 0.633 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.3259494304656982
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.775 Test Loss: 0.634 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.4497520923614502
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.775 Test Loss: 0.634 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.273923635482788
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.775 Test Loss: 0.633 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.534273624420166
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.775 Test Loss: 0.632 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.368037223815918
Epoch: 72, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5298614501953125
Epoch: 1, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.515 Vali Acc: 0.200 Test Loss: 1.515 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.275892972946167
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.501 Vali Acc: 0.175 Test Loss: 1.501 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2619884014129639
Epoch: 3, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.482 Vali Acc: 0.250 Test Loss: 1.482 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 1.2879095077514648
Epoch: 4, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.458 Vali Acc: 0.225 Test Loss: 1.458 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3010742664337158
Epoch: 5, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.431 Vali Acc: 0.250 Test Loss: 1.431 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.2528960704803467
Epoch: 6, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.405 Vali Acc: 0.300 Test Loss: 1.405 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 1.1241297721862793
Epoch: 7, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.382 Vali Acc: 0.300 Test Loss: 1.382 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 1.2802443504333496
Epoch: 8, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.361 Vali Acc: 0.350 Test Loss: 1.361 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 1.2970521450042725
Epoch: 9, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1796813011169434
Epoch: 10, Steps: 3 | Train Loss: 0.741 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 11 cost time: 1.179171085357666
Epoch: 11, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.312 Vali Acc: 0.375 Test Loss: 1.312 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 1.3018927574157715
Epoch: 12, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.313 Vali Acc: 0.350 Test Loss: 1.313 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.236295461654663
Epoch: 13, Steps: 3 | Train Loss: 0.480 Vali Loss: 1.304 Vali Acc: 0.350 Test Loss: 1.304 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2235841751098633
Epoch: 14, Steps: 3 | Train Loss: 0.416 Vali Loss: 1.306 Vali Acc: 0.325 Test Loss: 1.306 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1861143112182617
Epoch: 15, Steps: 3 | Train Loss: 0.376 Vali Loss: 1.316 Vali Acc: 0.375 Test Loss: 1.316 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1123390197753906
Epoch: 16, Steps: 3 | Train Loss: 0.321 Vali Loss: 1.319 Vali Acc: 0.350 Test Loss: 1.319 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2056188583374023
Epoch: 17, Steps: 3 | Train Loss: 0.274 Vali Loss: 1.314 Vali Acc: 0.325 Test Loss: 1.314 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2013959884643555
Epoch: 18, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.305 Vali Acc: 0.350 Test Loss: 1.305 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.261051893234253
Epoch: 19, Steps: 3 | Train Loss: 0.224 Vali Loss: 1.291 Vali Acc: 0.350 Test Loss: 1.291 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2928409576416016
Epoch: 20, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.302 Vali Acc: 0.350 Test Loss: 1.302 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3798351287841797
Epoch: 21, Steps: 3 | Train Loss: 0.125 Vali Loss: 1.304 Vali Acc: 0.350 Test Loss: 1.304 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.375
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.952449083328247
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.3917255401611328
Epoch: 2, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.327 Vali Acc: 0.325 Test Loss: 1.327 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2908930778503418
Epoch: 3, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.309 Vali Acc: 0.325 Test Loss: 1.309 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2400257587432861
Epoch: 4, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.287 Vali Acc: 0.325 Test Loss: 1.287 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.192199468612671
Epoch: 5, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.260 Vali Acc: 0.350 Test Loss: 1.260 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 1.3217356204986572
Epoch: 6, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.232 Vali Acc: 0.350 Test Loss: 1.232 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 7 cost time: 1.2798080444335938
Epoch: 7, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.208 Vali Acc: 0.375 Test Loss: 1.208 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 8 cost time: 1.3267982006072998
Epoch: 8, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.296957015991211
Epoch: 9, Steps: 3 | Train Loss: 0.848 Vali Loss: 1.165 Vali Acc: 0.425 Test Loss: 1.165 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 1.3451805114746094
Epoch: 10, Steps: 3 | Train Loss: 0.707 Vali Loss: 1.138 Vali Acc: 0.450 Test Loss: 1.138 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 11 cost time: 1.1639492511749268
Epoch: 11, Steps: 3 | Train Loss: 0.587 Vali Loss: 1.115 Vali Acc: 0.475 Test Loss: 1.115 Test Acc: 0.475
Validation loss decreased (-0.449989 --> -0.474989).  Saving model ...
Epoch: 12 cost time: 1.2874009609222412
Epoch: 12, Steps: 3 | Train Loss: 0.560 Vali Loss: 1.102 Vali Acc: 0.450 Test Loss: 1.102 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2147822380065918
Epoch: 13, Steps: 3 | Train Loss: 0.506 Vali Loss: 1.084 Vali Acc: 0.475 Test Loss: 1.084 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 14 cost time: 1.1868417263031006
Epoch: 14, Steps: 3 | Train Loss: 0.384 Vali Loss: 1.077 Vali Acc: 0.500 Test Loss: 1.077 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.220860481262207
Epoch: 15, Steps: 3 | Train Loss: 0.371 Vali Loss: 1.071 Vali Acc: 0.550 Test Loss: 1.071 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 1.1803042888641357
Epoch: 16, Steps: 3 | Train Loss: 0.324 Vali Loss: 1.057 Vali Acc: 0.550 Test Loss: 1.057 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 1.2905340194702148
Epoch: 17, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.047 Vali Acc: 0.525 Test Loss: 1.047 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.208238124847412
Epoch: 18, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.044 Vali Acc: 0.525 Test Loss: 1.044 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2509539127349854
Epoch: 19, Steps: 3 | Train Loss: 0.202 Vali Loss: 1.021 Vali Acc: 0.525 Test Loss: 1.021 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.262347936630249
Epoch: 20, Steps: 3 | Train Loss: 0.144 Vali Loss: 1.013 Vali Acc: 0.525 Test Loss: 1.013 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1685385704040527
Epoch: 21, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.005 Vali Acc: 0.550 Test Loss: 1.005 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 22 cost time: 1.3190977573394775
Epoch: 22, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.008 Vali Acc: 0.550 Test Loss: 1.008 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2158780097961426
Epoch: 23, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.993 Vali Acc: 0.575 Test Loss: 0.993 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 24 cost time: 1.2963509559631348
Epoch: 24, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.998 Vali Acc: 0.575 Test Loss: 0.998 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.251394510269165
Epoch: 25, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.012 Vali Acc: 0.525 Test Loss: 1.012 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2135958671569824
Epoch: 26, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.984 Vali Acc: 0.575 Test Loss: 0.984 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 27 cost time: 1.2250936031341553
Epoch: 27, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.969 Vali Acc: 0.575 Test Loss: 0.969 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 28 cost time: 1.1844453811645508
Epoch: 28, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.949 Vali Acc: 0.575 Test Loss: 0.949 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574991).  Saving model ...
Epoch: 29 cost time: 1.1013879776000977
Epoch: 29, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.947 Vali Acc: 0.575 Test Loss: 0.947 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 30 cost time: 1.2464468479156494
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.946 Vali Acc: 0.575 Test Loss: 0.946 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 31 cost time: 1.3609139919281006
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.926 Vali Acc: 0.575 Test Loss: 0.926 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 32 cost time: 1.255136489868164
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.912 Vali Acc: 0.575 Test Loss: 0.912 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 33 cost time: 1.201087236404419
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.896 Vali Acc: 0.575 Test Loss: 0.896 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 34 cost time: 1.1130683422088623
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.883 Vali Acc: 0.575 Test Loss: 0.883 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 35 cost time: 1.1007773876190186
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.875 Vali Acc: 0.575 Test Loss: 0.875 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 36 cost time: 1.1601498126983643
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.867 Vali Acc: 0.575 Test Loss: 0.867 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 37 cost time: 1.1725661754608154
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.861 Vali Acc: 0.575 Test Loss: 0.861 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 38 cost time: 1.1764695644378662
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.856 Vali Acc: 0.575 Test Loss: 0.856 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 39 cost time: 1.2820727825164795
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.852 Vali Acc: 0.575 Test Loss: 0.852 Test Acc: 0.575
Validation loss decreased (-0.574991 --> -0.574991).  Saving model ...
Epoch: 40 cost time: 1.3071670532226562
Epoch: 40, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.854 Vali Acc: 0.600 Test Loss: 0.854 Test Acc: 0.600
Validation loss decreased (-0.574991 --> -0.599991).  Saving model ...
Epoch: 41 cost time: 1.2465472221374512
Epoch: 41, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.854 Vali Acc: 0.600 Test Loss: 0.854 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4312841892242432
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.858 Vali Acc: 0.600 Test Loss: 0.858 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1306211948394775
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.864 Vali Acc: 0.600 Test Loss: 0.864 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2478604316711426
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.868 Vali Acc: 0.600 Test Loss: 0.868 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.34053373336792
Epoch: 45, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.873 Vali Acc: 0.600 Test Loss: 0.873 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.368290662765503
Epoch: 46, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.875 Vali Acc: 0.600 Test Loss: 0.875 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3155574798583984
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.877 Vali Acc: 0.600 Test Loss: 0.877 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.361689805984497
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.881 Vali Acc: 0.600 Test Loss: 0.881 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.3926501274108887
Epoch: 49, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.886 Vali Acc: 0.600 Test Loss: 0.886 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.333829402923584
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.887 Vali Acc: 0.600 Test Loss: 0.887 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.731707811355591
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.4519705772399902
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.3183393478393555
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2848339080810547
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2293214797973633
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.328031063079834
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3487398624420166
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1749951839447021
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2124812602996826
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.533240556716919
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2206242084503174
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.303079605102539
Epoch: 12, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 1444228
model size : 10.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6586742401123047
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.421 Vali Acc: 0.325 Test Loss: 1.421 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.188560962677002
Epoch: 2, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.354 Vali Acc: 0.450 Test Loss: 1.354 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.3325307369232178
Epoch: 3, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.254 Vali Acc: 0.525 Test Loss: 1.254 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 1.230952501296997
Epoch: 4, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 1.250539779663086
Epoch: 5, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.006 Vali Acc: 0.750 Test Loss: 1.006 Test Acc: 0.750
Validation loss decreased (-0.599989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 1.2020158767700195
Epoch: 6, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.873 Vali Acc: 0.825 Test Loss: 0.873 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 1.3210697174072266
Epoch: 7, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824993).  Saving model ...
Epoch: 8 cost time: 1.3525450229644775
Epoch: 8, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 1.1712610721588135
Epoch: 9, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 1.3137750625610352
Epoch: 10, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 1.2806313037872314
Epoch: 11, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 1.2481203079223633
Epoch: 12, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 1.5640506744384766
Epoch: 13, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.5008587837219238
Epoch: 14, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 1.3532631397247314
Epoch: 15, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 1.3409018516540527
Epoch: 16, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 1.2009472846984863
Epoch: 17, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3589849472045898
Epoch: 18, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 1.3335683345794678
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 1.5477712154388428
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.447563886642456
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.380932331085205
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.2456490993499756
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.1919426918029785
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 1.302830696105957
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 1.2577283382415771
Epoch: 26, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 1.19053053855896
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 1.42604660987854
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 1.2868528366088867
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 1.1878597736358643
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 1.160292387008667
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 1.216552495956421
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 1.2944283485412598
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 1.1894025802612305
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 1.2302422523498535
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 1.2517006397247314
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 1.378105878829956
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 1.3327603340148926
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 1.2307894229888916
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 1.1681950092315674
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 1.2259106636047363
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 1.2582693099975586
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 1.297879934310913
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 1.197007656097412
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 1.3007750511169434
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 1.2497093677520752
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 1.2929980754852295
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 1.282235860824585
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 1.371286153793335
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 1.3990700244903564
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 51 cost time: 1.2966933250427246
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 1.349855661392212
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 53 cost time: 1.2714924812316895
Epoch: 53, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 54 cost time: 1.4581348896026611
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 55 cost time: 1.3473031520843506
Epoch: 55, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 1.314514398574829
Epoch: 56, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 1.5591576099395752
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 1.4846632480621338
Epoch: 58, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 59 cost time: 1.3210318088531494
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 60 cost time: 1.3034813404083252
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 61 cost time: 1.2146613597869873
Epoch: 61, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 62 cost time: 1.2242274284362793
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 63 cost time: 1.3265712261199951
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2808222770690918
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 65 cost time: 1.3528928756713867
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.1532931327819824
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.2280542850494385
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 68 cost time: 1.1863880157470703
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 1.1542274951934814
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 70 cost time: 1.1789777278900146
Epoch: 70, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.2606730461120605
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 72 cost time: 1.267418622970581
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 73 cost time: 1.164766788482666
Epoch: 73, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 1.2730724811553955
Epoch: 74, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 75 cost time: 1.1498010158538818
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.24186372756958
Epoch: 76, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.192147970199585
Epoch: 77, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.2146503925323486
Epoch: 78, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.1969213485717773
Epoch: 79, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.2112550735473633
Epoch: 80, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.2426319122314453
Epoch: 81, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.2089757919311523
Epoch: 82, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.314530372619629
Epoch: 83, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 1.303335428237915
Epoch: 84, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6822211742401123
Epoch: 1, Steps: 3 | Train Loss: 1.518 Vali Loss: 1.463 Vali Acc: 0.250 Test Loss: 1.463 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2623097896575928
Epoch: 2, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (-0.249985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.2948429584503174
Epoch: 3, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.294 Vali Acc: 0.450 Test Loss: 1.294 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.3504772186279297
Epoch: 4, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.177 Vali Acc: 0.575 Test Loss: 1.177 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.2729334831237793
Epoch: 5, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 1.2967734336853027
Epoch: 6, Steps: 3 | Train Loss: 0.810 Vali Loss: 0.907 Vali Acc: 0.700 Test Loss: 0.907 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 7 cost time: 1.2636516094207764
Epoch: 7, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.3122003078460693
Epoch: 8, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 1.2515678405761719
Epoch: 9, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.252082347869873
Epoch: 10, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 1.237666130065918
Epoch: 11, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.1025149822235107
Epoch: 12, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 1.2719645500183105
Epoch: 13, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.2687098979949951
Epoch: 14, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 1.4615497589111328
Epoch: 15, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 1.3456575870513916
Epoch: 16, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 1.38197660446167
Epoch: 17, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 1.3585734367370605
Epoch: 18, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 1.3313920497894287
Epoch: 19, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2670564651489258
Epoch: 20, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 1.2034831047058105
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 1.1781561374664307
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.3832464218139648
Epoch: 23, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.2420635223388672
Epoch: 24, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.2847423553466797
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.2081489562988281
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.484304428100586
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.2779779434204102
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.205341100692749
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2647008895874023
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3544285297393799
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4690215587615967
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2493813037872314
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3546860218048096
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3550519943237305
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.615039587020874
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.3929622173309326
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7704715728759766
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.401 Vali Acc: 0.400 Test Loss: 1.401 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.3064000606536865
Epoch: 2, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.335 Vali Acc: 0.475 Test Loss: 1.335 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.292184829711914
Epoch: 3, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.3120834827423096
Epoch: 4, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.131 Vali Acc: 0.675 Test Loss: 1.131 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 1.3802263736724854
Epoch: 5, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.2158539295196533
Epoch: 6, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.1970810890197754
Epoch: 7, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.228102684020996
Epoch: 8, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.656 Vali Acc: 0.825 Test Loss: 0.656 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 1.2877895832061768
Epoch: 9, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.574 Vali Acc: 0.925 Test Loss: 0.574 Test Acc: 0.925
Validation loss decreased (-0.824993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 1.3058350086212158
Epoch: 10, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.516 Vali Acc: 0.925 Test Loss: 0.516 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.2277109622955322
Epoch: 11, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.379784107208252
Epoch: 12, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 1.2064530849456787
Epoch: 13, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.255958080291748
Epoch: 14, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 1.272902011871338
Epoch: 15, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 1.27095365524292
Epoch: 16, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3069405555725098
Epoch: 17, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2341697216033936
Epoch: 18, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3733949661254883
Epoch: 19, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 1.3486599922180176
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 1.2025163173675537
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 1.2660236358642578
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 1.283073902130127
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 1.2461700439453125
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 1.3349242210388184
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.1437954902648926
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.2950108051300049
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.3008103370666504
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.2098109722137451
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 1.2643165588378906
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 1.3472402095794678
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 1.2430195808410645
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.353259801864624
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2602274417877197
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2010576725006104
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2855169773101807
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2359845638275146
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2845244407653809
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3853516578674316
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.3520076274871826
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4528980255126953
Epoch: 41, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7716116905212402
Epoch: 1, Steps: 3 | Train Loss: 1.509 Vali Loss: 1.428 Vali Acc: 0.250 Test Loss: 1.428 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.259979009628296
Epoch: 2, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.358 Vali Acc: 0.350 Test Loss: 1.358 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.1666905879974365
Epoch: 3, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.258 Vali Acc: 0.450 Test Loss: 1.258 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.1304714679718018
Epoch: 4, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.263120412826538
Epoch: 5, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 1.2087516784667969
Epoch: 6, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.902 Vali Acc: 0.775 Test Loss: 0.902 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 1.2355775833129883
Epoch: 7, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.800 Vali Acc: 0.800 Test Loss: 0.800 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 1.092332363128662
Epoch: 8, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.706 Vali Acc: 0.850 Test Loss: 0.706 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 1.296428918838501
Epoch: 9, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2155494689941406
Epoch: 10, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.582 Vali Acc: 0.825 Test Loss: 0.582 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.187093734741211
Epoch: 11, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1784937381744385
Epoch: 12, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1584813594818115
Epoch: 13, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.517 Vali Acc: 0.750 Test Loss: 0.517 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1728990077972412
Epoch: 14, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.515 Vali Acc: 0.775 Test Loss: 0.515 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3168702125549316
Epoch: 15, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.504 Vali Acc: 0.775 Test Loss: 0.504 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1864304542541504
Epoch: 16, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.477 Vali Acc: 0.800 Test Loss: 0.477 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2155404090881348
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.452 Vali Acc: 0.825 Test Loss: 0.452 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1912381649017334
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.433 Vali Acc: 0.800 Test Loss: 0.433 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9587507247924805
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.385812520980835
Epoch: 2, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.311 Vali Acc: 0.425 Test Loss: 1.311 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.3392224311828613
Epoch: 3, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.239 Vali Acc: 0.475 Test Loss: 1.239 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 1.316211223602295
Epoch: 4, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.2905232906341553
Epoch: 5, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.052 Vali Acc: 0.675 Test Loss: 1.052 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 1.4287025928497314
Epoch: 6, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 1.4660451412200928
Epoch: 7, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 1.299872875213623
Epoch: 8, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 1.3935730457305908
Epoch: 9, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 10 cost time: 1.4024178981781006
Epoch: 10, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2571876049041748
Epoch: 11, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.617 Vali Acc: 0.800 Test Loss: 0.617 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.254272699356079
Epoch: 12, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.592 Vali Acc: 0.825 Test Loss: 0.592 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.343658208847046
Epoch: 13, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.2973992824554443
Epoch: 14, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 15 cost time: 1.2702713012695312
Epoch: 15, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 16 cost time: 1.227081537246704
Epoch: 16, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.547 Vali Acc: 0.800 Test Loss: 0.547 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.27366042137146
Epoch: 17, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2963793277740479
Epoch: 18, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.549 Vali Acc: 0.800 Test Loss: 0.549 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2773058414459229
Epoch: 19, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2211976051330566
Epoch: 20, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.230363368988037
Epoch: 21, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.517 Vali Acc: 0.800 Test Loss: 0.517 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.297651767730713
Epoch: 22, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 23 cost time: 1.3896667957305908
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.522 Vali Acc: 0.825 Test Loss: 0.522 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1392335891723633
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.526 Vali Acc: 0.825 Test Loss: 0.526 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2987160682678223
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.241062879562378
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.200404405593872
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2719395160675049
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.555 Vali Acc: 0.800 Test Loss: 0.555 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2210445404052734
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1910011768341064
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2308459281921387
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3053545951843262
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.800 Test Loss: 0.569 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7853195667266846
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.441 Vali Acc: 0.225 Test Loss: 1.441 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.590169906616211
Epoch: 2, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.424 Vali Acc: 0.250 Test Loss: 1.424 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.3486948013305664
Epoch: 3, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.396 Vali Acc: 0.275 Test Loss: 1.396 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.2372338771820068
Epoch: 4, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.364 Vali Acc: 0.350 Test Loss: 1.364 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.1921203136444092
Epoch: 5, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.326 Vali Acc: 0.375 Test Loss: 1.326 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.2873613834381104
Epoch: 6, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.282 Vali Acc: 0.350 Test Loss: 1.282 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2135868072509766
Epoch: 7, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.227449893951416
Epoch: 8, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.192 Vali Acc: 0.475 Test Loss: 1.192 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 1.3972806930541992
Epoch: 9, Steps: 3 | Train Loss: 0.753 Vali Loss: 1.143 Vali Acc: 0.475 Test Loss: 1.143 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474989).  Saving model ...
Epoch: 10 cost time: 1.2972934246063232
Epoch: 10, Steps: 3 | Train Loss: 0.713 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
Validation loss decreased (-0.474989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.3247108459472656
Epoch: 11, Steps: 3 | Train Loss: 0.503 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 1.1329271793365479
Epoch: 12, Steps: 3 | Train Loss: 0.451 Vali Loss: 1.033 Vali Acc: 0.650 Test Loss: 1.033 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 1.1812143325805664
Epoch: 13, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.017 Vali Acc: 0.700 Test Loss: 1.017 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.2367877960205078
Epoch: 14, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.999 Vali Acc: 0.700 Test Loss: 0.999 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 1.16530442237854
Epoch: 15, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.968 Vali Acc: 0.700 Test Loss: 0.968 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 1.349025011062622
Epoch: 16, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.909 Vali Acc: 0.675 Test Loss: 0.909 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5898363590240479
Epoch: 17, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.855 Vali Acc: 0.675 Test Loss: 0.855 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3474762439727783
Epoch: 18, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.812 Vali Acc: 0.725 Test Loss: 0.812 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724992).  Saving model ...
Epoch: 19 cost time: 1.2623450756072998
Epoch: 19, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.789 Vali Acc: 0.725 Test Loss: 0.789 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 20 cost time: 1.309314489364624
Epoch: 20, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.780 Vali Acc: 0.700 Test Loss: 0.780 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3307504653930664
Epoch: 21, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 22 cost time: 1.2441506385803223
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2394609451293945
Epoch: 23, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.776 Vali Acc: 0.700 Test Loss: 0.776 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3060152530670166
Epoch: 24, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.768 Vali Acc: 0.700 Test Loss: 0.768 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.229421615600586
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.743 Vali Acc: 0.700 Test Loss: 0.743 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2341973781585693
Epoch: 26, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.719 Vali Acc: 0.725 Test Loss: 0.719 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724993).  Saving model ...
Epoch: 27 cost time: 1.2968738079071045
Epoch: 27, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
Validation loss decreased (-0.724993 --> -0.749993).  Saving model ...
Epoch: 28 cost time: 1.2328674793243408
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 1.4213907718658447
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 30 cost time: 1.372389316558838
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 31 cost time: 1.1896600723266602
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.653 Vali Acc: 0.750 Test Loss: 0.653 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 32 cost time: 1.4704902172088623
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774994).  Saving model ...
Epoch: 33 cost time: 1.4069197177886963
Epoch: 33, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.639 Vali Acc: 0.800 Test Loss: 0.639 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799994).  Saving model ...
Epoch: 34 cost time: 1.3100743293762207
Epoch: 34, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.800 Test Loss: 0.634 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 35 cost time: 1.3903491497039795
Epoch: 35, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 36 cost time: 1.315882682800293
Epoch: 36, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 37 cost time: 1.2696466445922852
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 38 cost time: 1.3026721477508545
Epoch: 38, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 39 cost time: 1.4462683200836182
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 40 cost time: 1.350407600402832
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 41 cost time: 1.2881507873535156
Epoch: 41, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 42 cost time: 1.2637429237365723
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 43 cost time: 1.4439544677734375
Epoch: 43, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.825 Test Loss: 0.616 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 44 cost time: 1.3344078063964844
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.825 Test Loss: 0.613 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 45 cost time: 1.2913148403167725
Epoch: 45, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 46 cost time: 1.3216242790222168
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 47 cost time: 1.4869050979614258
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2975125312805176
Epoch: 48, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.279461145401001
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 50 cost time: 1.2808234691619873
Epoch: 50, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 51 cost time: 1.3206443786621094
Epoch: 51, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 52 cost time: 1.2887134552001953
Epoch: 52, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.825 Test Loss: 0.599 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 53 cost time: 1.2775564193725586
Epoch: 53, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 54 cost time: 1.2469675540924072
Epoch: 54, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 55 cost time: 1.6006834506988525
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.825 Test Loss: 0.593 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 56 cost time: 1.2110576629638672
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.825 Test Loss: 0.591 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 57 cost time: 1.1758718490600586
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 58 cost time: 1.189568281173706
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 59 cost time: 1.2843413352966309
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 60 cost time: 1.225757360458374
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.825 Test Loss: 0.587 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 61 cost time: 1.1875009536743164
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.2289786338806152
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.825 Test Loss: 0.588 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.3129971027374268
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.800 Test Loss: 0.589 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.1320326328277588
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.1723783016204834
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.800 Test Loss: 0.586 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.1765563488006592
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.800 Test Loss: 0.585 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.1785364151000977
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.800 Test Loss: 0.584 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.32021164894104
Epoch: 68, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.800 Test Loss: 0.584 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.3079912662506104
Epoch: 69, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.4101593494415283
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.721895456314087
Epoch: 1, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.452 Vali Acc: 0.250 Test Loss: 1.452 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.4069244861602783
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.440 Vali Acc: 0.250 Test Loss: 1.440 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.3576688766479492
Epoch: 3, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.426 Vali Acc: 0.250 Test Loss: 1.426 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.3515064716339111
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.409 Vali Acc: 0.275 Test Loss: 1.409 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.295450210571289
Epoch: 5, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.388 Vali Acc: 0.225 Test Loss: 1.388 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2668700218200684
Epoch: 6, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.369 Vali Acc: 0.275 Test Loss: 1.369 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 1.2306678295135498
Epoch: 7, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 1.2499990463256836
Epoch: 8, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.342 Vali Acc: 0.275 Test Loss: 1.342 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3770966529846191
Epoch: 9, Steps: 3 | Train Loss: 0.856 Vali Loss: 1.322 Vali Acc: 0.250 Test Loss: 1.322 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.639326810836792
Epoch: 10, Steps: 3 | Train Loss: 0.776 Vali Loss: 1.309 Vali Acc: 0.225 Test Loss: 1.309 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1690874099731445
Epoch: 11, Steps: 3 | Train Loss: 0.688 Vali Loss: 1.291 Vali Acc: 0.275 Test Loss: 1.291 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1944191455841064
Epoch: 12, Steps: 3 | Train Loss: 0.590 Vali Loss: 1.276 Vali Acc: 0.275 Test Loss: 1.276 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2685964107513428
Epoch: 13, Steps: 3 | Train Loss: 0.524 Vali Loss: 1.267 Vali Acc: 0.250 Test Loss: 1.267 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1202211380004883
Epoch: 14, Steps: 3 | Train Loss: 0.497 Vali Loss: 1.283 Vali Acc: 0.275 Test Loss: 1.283 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.27109956741333
Epoch: 15, Steps: 3 | Train Loss: 0.397 Vali Loss: 1.280 Vali Acc: 0.275 Test Loss: 1.280 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3311562538146973
Epoch: 16, Steps: 3 | Train Loss: 0.326 Vali Loss: 1.244 Vali Acc: 0.300 Test Loss: 1.244 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299988).  Saving model ...
Epoch: 17 cost time: 1.320509910583496
Epoch: 17, Steps: 3 | Train Loss: 0.277 Vali Loss: 1.215 Vali Acc: 0.300 Test Loss: 1.215 Test Acc: 0.300
Validation loss decreased (-0.299988 --> -0.299988).  Saving model ...
Epoch: 18 cost time: 1.1626672744750977
Epoch: 18, Steps: 3 | Train Loss: 0.244 Vali Loss: 1.199 Vali Acc: 0.325 Test Loss: 1.199 Test Acc: 0.325
Validation loss decreased (-0.299988 --> -0.324988).  Saving model ...
Epoch: 19 cost time: 1.162440538406372
Epoch: 19, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.217 Vali Acc: 0.325 Test Loss: 1.217 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3510551452636719
Epoch: 20, Steps: 3 | Train Loss: 0.182 Vali Loss: 1.210 Vali Acc: 0.325 Test Loss: 1.210 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1718130111694336
Epoch: 21, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.223 Vali Acc: 0.350 Test Loss: 1.223 Test Acc: 0.350
Validation loss decreased (-0.324988 --> -0.349988).  Saving model ...
Epoch: 22 cost time: 1.2471871376037598
Epoch: 22, Steps: 3 | Train Loss: 0.132 Vali Loss: 1.234 Vali Acc: 0.375 Test Loss: 1.234 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 23 cost time: 1.3483400344848633
Epoch: 23, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.226 Vali Acc: 0.375 Test Loss: 1.226 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374988).  Saving model ...
Epoch: 24 cost time: 1.5144743919372559
Epoch: 24, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.242 Vali Acc: 0.400 Test Loss: 1.242 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 1.2275478839874268
Epoch: 25, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 26 cost time: 1.2588613033294678
Epoch: 26, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.159 Vali Acc: 0.475 Test Loss: 1.159 Test Acc: 0.475
Validation loss decreased (-0.399988 --> -0.474988).  Saving model ...
Epoch: 27 cost time: 1.1756858825683594
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 28 cost time: 1.3581085205078125
Epoch: 28, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2364552021026611
Epoch: 29, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.106 Vali Acc: 0.525 Test Loss: 1.106 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 30 cost time: 1.213850736618042
Epoch: 30, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2597808837890625
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.106 Vali Acc: 0.525 Test Loss: 1.106 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 32 cost time: 1.5907607078552246
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.087 Vali Acc: 0.525 Test Loss: 1.087 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 33 cost time: 1.353283166885376
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.067 Vali Acc: 0.575 Test Loss: 1.067 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 34 cost time: 1.3811025619506836
Epoch: 34, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.068 Vali Acc: 0.575 Test Loss: 1.068 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.445617437362671
Epoch: 35, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3698232173919678
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.100 Vali Acc: 0.575 Test Loss: 1.100 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.210676670074463
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.099 Vali Acc: 0.575 Test Loss: 1.099 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3283212184906006
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.104 Vali Acc: 0.575 Test Loss: 1.104 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2566232681274414
Epoch: 39, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.102 Vali Acc: 0.575 Test Loss: 1.102 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3800792694091797
Epoch: 40, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.087 Vali Acc: 0.575 Test Loss: 1.087 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3728632926940918
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.070 Vali Acc: 0.575 Test Loss: 1.070 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.3032164573669434
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 43 cost time: 1.3502302169799805
Epoch: 43, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 44 cost time: 1.2979366779327393
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 45 cost time: 1.2528142929077148
Epoch: 45, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2853868007659912
Epoch: 46, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3965704441070557
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.334977626800537
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3005728721618652
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.097 Vali Acc: 0.600 Test Loss: 1.097 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3196945190429688
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2606291770935059
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.3194940090179443
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 53 cost time: 1.1772871017456055
Epoch: 53, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.049 Vali Acc: 0.625 Test Loss: 1.049 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 54 cost time: 1.2019891738891602
Epoch: 54, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 55 cost time: 1.305068016052246
Epoch: 55, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 56 cost time: 1.3561770915985107
Epoch: 56, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.044 Vali Acc: 0.650 Test Loss: 1.044 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1853296756744385
Epoch: 57, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.050 Vali Acc: 0.625 Test Loss: 1.050 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2751133441925049
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2212677001953125
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.060 Vali Acc: 0.625 Test Loss: 1.060 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.3034412860870361
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.061 Vali Acc: 0.625 Test Loss: 1.061 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.2904760837554932
Epoch: 61, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.3593971729278564
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.3019087314605713
Epoch: 63, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.074 Vali Acc: 0.650 Test Loss: 1.074 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.33036208152771
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.078 Vali Acc: 0.675 Test Loss: 1.078 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674989).  Saving model ...
Epoch: 65 cost time: 1.2386484146118164
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.082 Vali Acc: 0.675 Test Loss: 1.082 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.1540427207946777
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.242095947265625
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.3107361793518066
Epoch: 68, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.3626620769500732
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.2263126373291016
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.100 Vali Acc: 0.675 Test Loss: 1.100 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.2098565101623535
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.675 Test Loss: 1.105 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.2408978939056396
Epoch: 72, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.110 Vali Acc: 0.675 Test Loss: 1.110 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.2526345252990723
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.116 Vali Acc: 0.675 Test Loss: 1.116 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.2481420040130615
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.122 Vali Acc: 0.675 Test Loss: 1.122 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.690319299697876
Epoch: 1, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.548 Vali Acc: 0.125 Test Loss: 1.548 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.4081621170043945
Epoch: 2, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.536 Vali Acc: 0.125 Test Loss: 1.536 Test Acc: 0.125
Validation loss decreased (-0.124985 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 1.331002950668335
Epoch: 3, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.517 Vali Acc: 0.150 Test Loss: 1.517 Test Acc: 0.150
Validation loss decreased (-0.124985 --> -0.149985).  Saving model ...
Epoch: 4 cost time: 1.402442455291748
Epoch: 4, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.496 Vali Acc: 0.150 Test Loss: 1.496 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149985).  Saving model ...
Epoch: 5 cost time: 1.4051527976989746
Epoch: 5, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.468 Vali Acc: 0.200 Test Loss: 1.468 Test Acc: 0.200
Validation loss decreased (-0.149985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 1.4570338726043701
Epoch: 6, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.443 Vali Acc: 0.275 Test Loss: 1.443 Test Acc: 0.275
Validation loss decreased (-0.199985 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 1.2468743324279785
Epoch: 7, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.426 Vali Acc: 0.275 Test Loss: 1.426 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 8 cost time: 1.2990484237670898
Epoch: 8, Steps: 3 | Train Loss: 0.930 Vali Loss: 1.406 Vali Acc: 0.275 Test Loss: 1.406 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 9 cost time: 1.2930586338043213
Epoch: 9, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 10 cost time: 1.3877768516540527
Epoch: 10, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 1.3202674388885498
Epoch: 11, Steps: 3 | Train Loss: 0.705 Vali Loss: 1.333 Vali Acc: 0.300 Test Loss: 1.333 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 12 cost time: 1.3445355892181396
Epoch: 12, Steps: 3 | Train Loss: 0.641 Vali Loss: 1.311 Vali Acc: 0.300 Test Loss: 1.311 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 13 cost time: 1.3156297206878662
Epoch: 13, Steps: 3 | Train Loss: 0.471 Vali Loss: 1.297 Vali Acc: 0.275 Test Loss: 1.297 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2878785133361816
Epoch: 14, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.292 Vali Acc: 0.300 Test Loss: 1.292 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 15 cost time: 1.2863774299621582
Epoch: 15, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.271 Vali Acc: 0.275 Test Loss: 1.271 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3600645065307617
Epoch: 16, Steps: 3 | Train Loss: 0.378 Vali Loss: 1.227 Vali Acc: 0.350 Test Loss: 1.227 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349988).  Saving model ...
Epoch: 17 cost time: 1.3259103298187256
Epoch: 17, Steps: 3 | Train Loss: 0.281 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
Validation loss decreased (-0.349988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.3156511783599854
Epoch: 18, Steps: 3 | Train Loss: 0.238 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 1.4265213012695312
Epoch: 19, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.190 Vali Acc: 0.375 Test Loss: 1.190 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3234913349151611
Epoch: 20, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.166 Vali Acc: 0.425 Test Loss: 1.166 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 21 cost time: 1.3052997589111328
Epoch: 21, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.161 Vali Acc: 0.450 Test Loss: 1.161 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 22 cost time: 1.3562748432159424
Epoch: 22, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.161 Vali Acc: 0.450 Test Loss: 1.161 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2743666172027588
Epoch: 23, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.161 Vali Acc: 0.450 Test Loss: 1.161 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 24 cost time: 1.4748752117156982
Epoch: 24, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.173 Vali Acc: 0.425 Test Loss: 1.173 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2978808879852295
Epoch: 25, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.153 Vali Acc: 0.425 Test Loss: 1.153 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4344727993011475
Epoch: 26, Steps: 3 | Train Loss: 0.069 Vali Loss: 1.103 Vali Acc: 0.475 Test Loss: 1.103 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474989).  Saving model ...
Epoch: 27 cost time: 1.4044759273529053
Epoch: 27, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.063 Vali Acc: 0.500 Test Loss: 1.063 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 28 cost time: 1.5452070236206055
Epoch: 28, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 29 cost time: 1.398399829864502
Epoch: 29, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.030 Vali Acc: 0.500 Test Loss: 1.030 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499990).  Saving model ...
Epoch: 30 cost time: 1.5709373950958252
Epoch: 30, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.028 Vali Acc: 0.500 Test Loss: 1.028 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499990).  Saving model ...
Epoch: 31 cost time: 1.4022727012634277
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.029 Vali Acc: 0.525 Test Loss: 1.029 Test Acc: 0.525
Validation loss decreased (-0.499990 --> -0.524990).  Saving model ...
Epoch: 32 cost time: 1.5096046924591064
Epoch: 32, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.030 Vali Acc: 0.550 Test Loss: 1.030 Test Acc: 0.550
Validation loss decreased (-0.524990 --> -0.549990).  Saving model ...
Epoch: 33 cost time: 1.4793150424957275
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.029 Vali Acc: 0.550 Test Loss: 1.029 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 34 cost time: 1.4137051105499268
Epoch: 34, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4838974475860596
Epoch: 35, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3466143608093262
Epoch: 36, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.038 Vali Acc: 0.550 Test Loss: 1.038 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3424701690673828
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 38 cost time: 1.3544199466705322
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.025 Vali Acc: 0.550 Test Loss: 1.025 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 39 cost time: 1.2895545959472656
Epoch: 39, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.016 Vali Acc: 0.575 Test Loss: 1.016 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 40 cost time: 1.3731074333190918
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.001 Vali Acc: 0.575 Test Loss: 1.001 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 41 cost time: 1.3726778030395508
Epoch: 41, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.993 Vali Acc: 0.575 Test Loss: 0.993 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 42 cost time: 1.3780202865600586
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.989 Vali Acc: 0.600 Test Loss: 0.989 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 43 cost time: 1.2887275218963623
Epoch: 43, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2120063304901123
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2294771671295166
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3245735168457031
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.997 Vali Acc: 0.600 Test Loss: 0.997 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2852351665496826
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.4119741916656494
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3193082809448242
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.351029634475708
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.2444629669189453
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.193084478378296
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.766045331954956
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1819193363189697
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.1459388732910156
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2547883987426758
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2135658264160156
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3034193515777588
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2667450904846191
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2454802989959717
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.174837589263916
Epoch: 9, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1513597965240479
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2060682773590088
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2759933471679688
Epoch: 12, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 1051012
model size : 8.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.627154588699341
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.323 Vali Acc: 0.325 Test Loss: 1.323 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 1.2710247039794922
Epoch: 2, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.261 Vali Acc: 0.475 Test Loss: 1.261 Test Acc: 0.475
Validation loss decreased (-0.324987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.4165329933166504
Epoch: 3, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.175 Vali Acc: 0.600 Test Loss: 1.175 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 1.3915560245513916
Epoch: 4, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.071 Vali Acc: 0.750 Test Loss: 1.071 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 1.1406445503234863
Epoch: 5, Steps: 3 | Train Loss: 0.952 Vali Loss: 0.963 Vali Acc: 0.800 Test Loss: 0.963 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 1.3218574523925781
Epoch: 6, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.854 Vali Acc: 0.825 Test Loss: 0.854 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 1.2712688446044922
Epoch: 7, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 1.1482691764831543
Epoch: 8, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.647 Vali Acc: 0.875 Test Loss: 0.647 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 1.228714942932129
Epoch: 9, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.3102014064788818
Epoch: 10, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 1.3419179916381836
Epoch: 11, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.2482719421386719
Epoch: 12, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 1.2496695518493652
Epoch: 13, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.3394296169281006
Epoch: 14, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 1.5299203395843506
Epoch: 15, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 1.3916316032409668
Epoch: 16, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 1.262364387512207
Epoch: 17, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 1.235196590423584
Epoch: 18, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 1.2213661670684814
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 1.2019438743591309
Epoch: 20, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 1.2491869926452637
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.2200002670288086
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.3837699890136719
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.3781869411468506
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 1.3798255920410156
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 1.3537728786468506
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.4538748264312744
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.398900032043457
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 1.2563374042510986
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 1.370849370956421
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 1.3122773170471191
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2697598934173584
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2751359939575195
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 1.3901188373565674
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 1.325371265411377
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.2946879863739014
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2441773414611816
Epoch: 37, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.231513261795044
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2388205528259277
Epoch: 39, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 1.1175353527069092
Epoch: 40, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.20961332321167
Epoch: 41, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.4344141483306885
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.5030882358551025
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.355846643447876
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.3428895473480225
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.3324151039123535
Epoch: 46, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.1646437644958496
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.2900395393371582
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.322537899017334
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.2078566551208496
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.19343900680542
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 1.13498854637146
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 1.1914219856262207
Epoch: 53, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 1.139723300933838
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.2107956409454346
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2425761222839355
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1207664012908936
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.166630744934082
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.131653070449829
Epoch: 59, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.2682383060455322
Epoch: 60, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.2835865020751953
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.279393196105957
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.3320610523223877
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.3407046794891357
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.639467477798462
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.293 Vali Acc: 0.475 Test Loss: 1.293 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 1.2734284400939941
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.311532735824585
Epoch: 3, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.151 Vali Acc: 0.575 Test Loss: 1.151 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 1.2844374179840088
Epoch: 4, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 1.169487714767456
Epoch: 5, Steps: 3 | Train Loss: 0.955 Vali Loss: 0.940 Vali Acc: 0.800 Test Loss: 0.940 Test Acc: 0.800
Validation loss decreased (-0.649990 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 1.1689350605010986
Epoch: 6, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 1.2385022640228271
Epoch: 7, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.723 Vali Acc: 0.875 Test Loss: 0.723 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 1.2425806522369385
Epoch: 8, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 1.1560649871826172
Epoch: 9, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.1956708431243896
Epoch: 10, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 1.234973430633545
Epoch: 11, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 1.1520636081695557
Epoch: 12, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 1.2547521591186523
Epoch: 13, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 1.2098500728607178
Epoch: 14, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 1.2152905464172363
Epoch: 15, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 1.2521069049835205
Epoch: 16, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 1.217344045639038
Epoch: 17, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2548820972442627
Epoch: 18, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.275510549545288
Epoch: 19, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2220377922058105
Epoch: 20, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 1.2219769954681396
Epoch: 21, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 1.1555805206298828
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.2641205787658691
Epoch: 23, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.1924583911895752
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.3551063537597656
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.1570346355438232
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.2409605979919434
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1292822360992432
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1862192153930664
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.166062831878662
Epoch: 30, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0624079704284668
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1492490768432617
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0371122360229492
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1306629180908203
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1317710876464844
Epoch: 35, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1476867198944092
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.478884220123291
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.286 Vali Acc: 0.425 Test Loss: 1.286 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.194488525390625
Epoch: 2, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.230 Vali Acc: 0.475 Test Loss: 1.230 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 1.1828587055206299
Epoch: 3, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.153 Vali Acc: 0.625 Test Loss: 1.153 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 1.3046350479125977
Epoch: 4, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
Validation loss decreased (-0.624988 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 1.327408790588379
Epoch: 5, Steps: 3 | Train Loss: 0.941 Vali Loss: 0.964 Vali Acc: 0.850 Test Loss: 0.964 Test Acc: 0.850
Validation loss decreased (-0.749989 --> -0.849990).  Saving model ...
Epoch: 6 cost time: 1.3040735721588135
Epoch: 6, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.865 Vali Acc: 0.825 Test Loss: 0.865 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4385762214660645
Epoch: 7, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.2629356384277344
Epoch: 8, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.680 Vali Acc: 0.875 Test Loss: 0.680 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 1.2279014587402344
Epoch: 9, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.600 Vali Acc: 0.900 Test Loss: 0.600 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 1.1888957023620605
Epoch: 10, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.529 Vali Acc: 0.925 Test Loss: 0.529 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.221980094909668
Epoch: 11, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.3527462482452393
Epoch: 12, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.442 Vali Acc: 0.900 Test Loss: 0.442 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3189542293548584
Epoch: 13, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2883844375610352
Epoch: 14, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 1.246168851852417
Epoch: 15, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1570124626159668
Epoch: 16, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0965826511383057
Epoch: 17, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.140026569366455
Epoch: 18, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1265056133270264
Epoch: 19, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2984654903411865
Epoch: 20, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2730293273925781
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2716891765594482
Epoch: 22, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.2795870304107666
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 1.1356134414672852
Epoch: 24, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.2543740272521973
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.1402840614318848
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2083535194396973
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2922866344451904
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2202491760253906
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1817967891693115
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1853621006011963
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.228081464767456
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1909797191619873
Epoch: 33, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.295569658279419
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.304718017578125
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.889847755432129
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.330 Vali Acc: 0.300 Test Loss: 1.330 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 1.2794697284698486
Epoch: 2, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.270 Vali Acc: 0.525 Test Loss: 1.270 Test Acc: 0.525
Validation loss decreased (-0.299987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 1.5611364841461182
Epoch: 3, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.187 Vali Acc: 0.600 Test Loss: 1.187 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 1.339493989944458
Epoch: 4, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.087 Vali Acc: 0.625 Test Loss: 1.087 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.3606829643249512
Epoch: 5, Steps: 3 | Train Loss: 0.931 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.2520062923431396
Epoch: 6, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.893 Vali Acc: 0.800 Test Loss: 0.893 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.2739808559417725
Epoch: 7, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.796 Vali Acc: 0.800 Test Loss: 0.796 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 1.2680089473724365
Epoch: 8, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.3417370319366455
Epoch: 9, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 10 cost time: 1.226808786392212
Epoch: 10, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.577 Vali Acc: 0.800 Test Loss: 0.577 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 1.2093043327331543
Epoch: 11, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 12 cost time: 1.3413093090057373
Epoch: 12, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.509 Vali Acc: 0.800 Test Loss: 0.509 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3342323303222656
Epoch: 13, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.504 Vali Acc: 0.800 Test Loss: 0.504 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.256711483001709
Epoch: 14, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1431167125701904
Epoch: 15, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2866404056549072
Epoch: 16, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.503 Vali Acc: 0.800 Test Loss: 0.503 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1911132335662842
Epoch: 17, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.493 Vali Acc: 0.800 Test Loss: 0.493 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0694758892059326
Epoch: 18, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.485 Vali Acc: 0.825 Test Loss: 0.485 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 1.228532314300537
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.477 Vali Acc: 0.825 Test Loss: 0.477 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 20 cost time: 1.1287717819213867
Epoch: 20, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.470 Vali Acc: 0.825 Test Loss: 0.470 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 1.2006971836090088
Epoch: 21, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.462 Vali Acc: 0.825 Test Loss: 0.462 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 1.2068614959716797
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.456 Vali Acc: 0.825 Test Loss: 0.456 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 23 cost time: 1.1628444194793701
Epoch: 23, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.825 Test Loss: 0.450 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 24 cost time: 1.1795215606689453
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.447 Vali Acc: 0.825 Test Loss: 0.447 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 25 cost time: 1.2134120464324951
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.445 Vali Acc: 0.825 Test Loss: 0.445 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 26 cost time: 1.1758732795715332
Epoch: 26, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.825 Test Loss: 0.443 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 27 cost time: 1.2252423763275146
Epoch: 27, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2524003982543945
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.195246934890747
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1331408023834229
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2512116432189941
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1709494590759277
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3756709098815918
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1327242851257324
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2180085182189941
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3474993705749512
Epoch: 36, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.672400712966919
Epoch: 1, Steps: 3 | Train Loss: 1.531 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.1937804222106934
Epoch: 2, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.239 Vali Acc: 0.600 Test Loss: 1.239 Test Acc: 0.600
Validation loss decreased (-0.374987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 1.2824013233184814
Epoch: 3, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.171 Vali Acc: 0.625 Test Loss: 1.171 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 1.3193187713623047
Epoch: 4, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.087 Vali Acc: 0.675 Test Loss: 1.087 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 1.2602300643920898
Epoch: 5, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.2584235668182373
Epoch: 6, Steps: 3 | Train Loss: 0.883 Vali Loss: 0.916 Vali Acc: 0.800 Test Loss: 0.916 Test Acc: 0.800
Validation loss decreased (-0.699990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 1.2379844188690186
Epoch: 7, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.827 Vali Acc: 0.850 Test Loss: 0.827 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.1435723304748535
Epoch: 8, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1642265319824219
Epoch: 9, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 10 cost time: 1.2330574989318848
Epoch: 10, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.2327277660369873
Epoch: 11, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 1.3531997203826904
Epoch: 12, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 1.1903390884399414
Epoch: 13, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2013158798217773
Epoch: 14, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2611920833587646
Epoch: 15, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.230294942855835
Epoch: 16, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2543106079101562
Epoch: 17, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2308244705200195
Epoch: 18, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2666878700256348
Epoch: 19, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2055516242980957
Epoch: 20, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1578116416931152
Epoch: 21, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1194977760314941
Epoch: 22, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7635715007781982
Epoch: 1, Steps: 3 | Train Loss: 1.544 Vali Loss: 1.419 Vali Acc: 0.250 Test Loss: 1.419 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2978553771972656
Epoch: 2, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.408 Vali Acc: 0.250 Test Loss: 1.408 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2439041137695312
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.384 Vali Acc: 0.325 Test Loss: 1.384 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.3190569877624512
Epoch: 4, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.352 Vali Acc: 0.325 Test Loss: 1.352 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.3305490016937256
Epoch: 5, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.3420441150665283
Epoch: 6, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.285 Vali Acc: 0.425 Test Loss: 1.285 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.2920558452606201
Epoch: 7, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.2512235641479492
Epoch: 8, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.206 Vali Acc: 0.475 Test Loss: 1.206 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 1.2970528602600098
Epoch: 9, Steps: 3 | Train Loss: 0.733 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.42950439453125
Epoch: 10, Steps: 3 | Train Loss: 0.617 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 1.2202305793762207
Epoch: 11, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.069 Vali Acc: 0.650 Test Loss: 1.069 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 1.3727993965148926
Epoch: 12, Steps: 3 | Train Loss: 0.457 Vali Loss: 1.034 Vali Acc: 0.650 Test Loss: 1.034 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 1.2210209369659424
Epoch: 13, Steps: 3 | Train Loss: 0.422 Vali Loss: 1.003 Vali Acc: 0.650 Test Loss: 1.003 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 1.2974817752838135
Epoch: 14, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.986 Vali Acc: 0.625 Test Loss: 0.986 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.269911766052246
Epoch: 15, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.958 Vali Acc: 0.650 Test Loss: 0.958 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 1.23616623878479
Epoch: 16, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.937 Vali Acc: 0.625 Test Loss: 0.937 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2736046314239502
Epoch: 17, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.910 Vali Acc: 0.650 Test Loss: 0.910 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 18 cost time: 1.2500584125518799
Epoch: 18, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.884 Vali Acc: 0.650 Test Loss: 0.884 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 19 cost time: 1.357276201248169
Epoch: 19, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.862 Vali Acc: 0.650 Test Loss: 0.862 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 20 cost time: 1.249866008758545
Epoch: 20, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.853 Vali Acc: 0.650 Test Loss: 0.853 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 21 cost time: 1.31119704246521
Epoch: 21, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.846 Vali Acc: 0.650 Test Loss: 0.846 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649992).  Saving model ...
Epoch: 22 cost time: 1.3141822814941406
Epoch: 22, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.843 Vali Acc: 0.650 Test Loss: 0.843 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 23 cost time: 1.291189193725586
Epoch: 23, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.841 Vali Acc: 0.650 Test Loss: 0.841 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 24 cost time: 1.2487647533416748
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.838 Vali Acc: 0.650 Test Loss: 0.838 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 25 cost time: 1.3517286777496338
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.824 Vali Acc: 0.650 Test Loss: 0.824 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 26 cost time: 1.2432103157043457
Epoch: 26, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.807 Vali Acc: 0.675 Test Loss: 0.807 Test Acc: 0.675
Validation loss decreased (-0.649992 --> -0.674992).  Saving model ...
Epoch: 27 cost time: 1.2577035427093506
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.794 Vali Acc: 0.700 Test Loss: 0.794 Test Acc: 0.700
Validation loss decreased (-0.674992 --> -0.699992).  Saving model ...
Epoch: 28 cost time: 1.2746448516845703
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.786 Vali Acc: 0.700 Test Loss: 0.786 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 29 cost time: 1.2923505306243896
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 30 cost time: 1.239926815032959
Epoch: 30, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.773 Vali Acc: 0.725 Test Loss: 0.773 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 31 cost time: 1.2615838050842285
Epoch: 31, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.772 Vali Acc: 0.725 Test Loss: 0.772 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 32 cost time: 1.3014614582061768
Epoch: 32, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.768 Vali Acc: 0.725 Test Loss: 0.768 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 33 cost time: 1.1771795749664307
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2344059944152832
Epoch: 34, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.765 Vali Acc: 0.725 Test Loss: 0.765 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 35 cost time: 1.2956821918487549
Epoch: 35, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.760 Vali Acc: 0.725 Test Loss: 0.760 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 36 cost time: 1.254514455795288
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.753 Vali Acc: 0.725 Test Loss: 0.753 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 37 cost time: 1.163081407546997
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.749 Vali Acc: 0.725 Test Loss: 0.749 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724993).  Saving model ...
Epoch: 38 cost time: 1.3474185466766357
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.725 Test Loss: 0.743 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 39 cost time: 1.2985775470733643
Epoch: 39, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.732 Vali Acc: 0.725 Test Loss: 0.732 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 40 cost time: 1.4352810382843018
Epoch: 40, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.724 Vali Acc: 0.725 Test Loss: 0.724 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 41 cost time: 1.3821940422058105
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.720 Vali Acc: 0.725 Test Loss: 0.720 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 42 cost time: 1.182924747467041
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.716 Vali Acc: 0.725 Test Loss: 0.716 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 43 cost time: 1.2250020503997803
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.714 Vali Acc: 0.725 Test Loss: 0.714 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 44 cost time: 1.1639487743377686
Epoch: 44, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
Validation loss decreased (-0.724993 --> -0.749993).  Saving model ...
Epoch: 45 cost time: 1.279033899307251
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.709 Vali Acc: 0.750 Test Loss: 0.709 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 46 cost time: 1.2851142883300781
Epoch: 46, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 47 cost time: 1.405076265335083
Epoch: 47, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 48 cost time: 1.4371967315673828
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 49 cost time: 1.215921401977539
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2249431610107422
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.3909568786621094
Epoch: 51, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.4205148220062256
Epoch: 52, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.2822041511535645
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 54 cost time: 1.508885145187378
Epoch: 54, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 55 cost time: 1.3246371746063232
Epoch: 55, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.698 Vali Acc: 0.775 Test Loss: 0.698 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 56 cost time: 1.1584043502807617
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 57 cost time: 1.3054540157318115
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 58 cost time: 1.1994588375091553
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 59 cost time: 1.227144479751587
Epoch: 59, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.775 Test Loss: 0.688 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 60 cost time: 1.2556908130645752
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 61 cost time: 1.3682591915130615
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 62 cost time: 1.3332247734069824
Epoch: 62, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1734659671783447
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.1916074752807617
Epoch: 64, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.2780399322509766
Epoch: 65, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.693 Vali Acc: 0.800 Test Loss: 0.693 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.2540161609649658
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.2836928367614746
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.2164716720581055
Epoch: 68, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.366227149963379
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.2965233325958252
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.297553300857544
Epoch: 71, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.800 Test Loss: 0.695 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.685454845428467
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.415 Vali Acc: 0.200 Test Loss: 1.415 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.2860817909240723
Epoch: 2, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.413 Vali Acc: 0.225 Test Loss: 1.413 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.232952356338501
Epoch: 3, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.400 Vali Acc: 0.250 Test Loss: 1.400 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.1502671241760254
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.1560442447662354
Epoch: 5, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.365 Vali Acc: 0.250 Test Loss: 1.365 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2025506496429443
Epoch: 6, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.343 Vali Acc: 0.275 Test Loss: 1.343 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 1.250093698501587
Epoch: 7, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.315 Vali Acc: 0.275 Test Loss: 1.315 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 8 cost time: 1.2399563789367676
Epoch: 8, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.298 Vali Acc: 0.325 Test Loss: 1.298 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 1.254868507385254
Epoch: 9, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.276 Vali Acc: 0.300 Test Loss: 1.276 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1565656661987305
Epoch: 10, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.252 Vali Acc: 0.300 Test Loss: 1.252 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1290321350097656
Epoch: 11, Steps: 3 | Train Loss: 0.738 Vali Loss: 1.223 Vali Acc: 0.275 Test Loss: 1.223 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0574150085449219
Epoch: 12, Steps: 3 | Train Loss: 0.593 Vali Loss: 1.211 Vali Acc: 0.275 Test Loss: 1.211 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0782194137573242
Epoch: 13, Steps: 3 | Train Loss: 0.577 Vali Loss: 1.193 Vali Acc: 0.325 Test Loss: 1.193 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324988).  Saving model ...
Epoch: 14 cost time: 1.0832781791687012
Epoch: 14, Steps: 3 | Train Loss: 0.454 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.324988 --> -0.399988).  Saving model ...
Epoch: 15 cost time: 1.1235675811767578
Epoch: 15, Steps: 3 | Train Loss: 0.434 Vali Loss: 1.185 Vali Acc: 0.425 Test Loss: 1.185 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 16 cost time: 1.1619861125946045
Epoch: 16, Steps: 3 | Train Loss: 0.328 Vali Loss: 1.167 Vali Acc: 0.425 Test Loss: 1.167 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 17 cost time: 1.1718132495880127
Epoch: 17, Steps: 3 | Train Loss: 0.298 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1744885444641113
Epoch: 18, Steps: 3 | Train Loss: 0.259 Vali Loss: 1.127 Vali Acc: 0.475 Test Loss: 1.127 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474989).  Saving model ...
Epoch: 19 cost time: 1.1724655628204346
Epoch: 19, Steps: 3 | Train Loss: 0.225 Vali Loss: 1.099 Vali Acc: 0.475 Test Loss: 1.099 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 20 cost time: 1.1654260158538818
Epoch: 20, Steps: 3 | Train Loss: 0.179 Vali Loss: 1.112 Vali Acc: 0.450 Test Loss: 1.112 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0729568004608154
Epoch: 21, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.150 Vali Acc: 0.425 Test Loss: 1.150 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.074716567993164
Epoch: 22, Steps: 3 | Train Loss: 0.133 Vali Loss: 1.174 Vali Acc: 0.475 Test Loss: 1.174 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1323084831237793
Epoch: 23, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.175 Vali Acc: 0.450 Test Loss: 1.175 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1732304096221924
Epoch: 24, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.187 Vali Acc: 0.475 Test Loss: 1.187 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1455607414245605
Epoch: 25, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499988).  Saving model ...
Epoch: 26 cost time: 1.2032928466796875
Epoch: 26, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.115 Vali Acc: 0.525 Test Loss: 1.115 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 27 cost time: 1.1147043704986572
Epoch: 27, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.076 Vali Acc: 0.525 Test Loss: 1.076 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 28 cost time: 1.0674245357513428
Epoch: 28, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.062 Vali Acc: 0.525 Test Loss: 1.062 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 29 cost time: 1.1807167530059814
Epoch: 29, Steps: 3 | Train Loss: 0.046 Vali Loss: 1.085 Vali Acc: 0.550 Test Loss: 1.085 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 30 cost time: 1.1549789905548096
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0942623615264893
Epoch: 31, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1612489223480225
Epoch: 32, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.195 Vali Acc: 0.475 Test Loss: 1.195 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2533447742462158
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.217 Vali Acc: 0.475 Test Loss: 1.217 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2877955436706543
Epoch: 34, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.232983112335205
Epoch: 35, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.172 Vali Acc: 0.525 Test Loss: 1.172 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1397407054901123
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.138 Vali Acc: 0.525 Test Loss: 1.138 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.199690580368042
Epoch: 37, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.186100959777832
Epoch: 38, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.112 Vali Acc: 0.550 Test Loss: 1.112 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2492034435272217
Epoch: 39, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.102 Vali Acc: 0.575 Test Loss: 1.102 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 40 cost time: 1.2865431308746338
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.089 Vali Acc: 0.575 Test Loss: 1.089 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 41 cost time: 1.3292806148529053
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 42 cost time: 1.3140556812286377
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2049376964569092
Epoch: 43, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.213707447052002
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.117 Vali Acc: 0.575 Test Loss: 1.117 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2657561302185059
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 1.133 Vali Acc: 0.575 Test Loss: 1.133 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2154500484466553
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.437251329421997
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.121 Vali Acc: 0.625 Test Loss: 1.121 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 48 cost time: 1.3270959854125977
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.126 Vali Acc: 0.625 Test Loss: 1.126 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4423062801361084
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1412296295166016
Epoch: 50, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.179 Vali Acc: 0.550 Test Loss: 1.179 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1723248958587646
Epoch: 51, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.224269151687622
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.198 Vali Acc: 0.550 Test Loss: 1.198 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2294986248016357
Epoch: 53, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.2513995170593262
Epoch: 54, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.194 Vali Acc: 0.575 Test Loss: 1.194 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.3707389831542969
Epoch: 55, Steps: 3 | Train Loss: 0.004 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.3394408226013184
Epoch: 56, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.224752426147461
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.769331693649292
Epoch: 1, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.474 Vali Acc: 0.250 Test Loss: 1.474 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2355546951293945
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.469 Vali Acc: 0.250 Test Loss: 1.469 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.2727711200714111
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.452 Vali Acc: 0.250 Test Loss: 1.452 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 1.2176134586334229
Epoch: 4, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.426 Vali Acc: 0.275 Test Loss: 1.426 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.2931721210479736
Epoch: 5, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.406 Vali Acc: 0.275 Test Loss: 1.406 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.1903526782989502
Epoch: 6, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.383 Vali Acc: 0.300 Test Loss: 1.383 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 1.1879897117614746
Epoch: 7, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.354 Vali Acc: 0.350 Test Loss: 1.354 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 1.1402974128723145
Epoch: 8, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.330 Vali Acc: 0.300 Test Loss: 1.330 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2608425617218018
Epoch: 9, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.300 Vali Acc: 0.300 Test Loss: 1.300 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2430646419525146
Epoch: 10, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.269 Vali Acc: 0.325 Test Loss: 1.269 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1991779804229736
Epoch: 11, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.231 Vali Acc: 0.350 Test Loss: 1.231 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349988).  Saving model ...
Epoch: 12 cost time: 1.2632372379302979
Epoch: 12, Steps: 3 | Train Loss: 0.622 Vali Loss: 1.204 Vali Acc: 0.375 Test Loss: 1.204 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 13 cost time: 1.256627082824707
Epoch: 13, Steps: 3 | Train Loss: 0.553 Vali Loss: 1.177 Vali Acc: 0.475 Test Loss: 1.177 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474988).  Saving model ...
Epoch: 14 cost time: 1.4173784255981445
Epoch: 14, Steps: 3 | Train Loss: 0.451 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.3724815845489502
Epoch: 15, Steps: 3 | Train Loss: 0.438 Vali Loss: 1.143 Vali Acc: 0.550 Test Loss: 1.143 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 16 cost time: 1.1931426525115967
Epoch: 16, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.122 Vali Acc: 0.575 Test Loss: 1.122 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 1.2493090629577637
Epoch: 17, Steps: 3 | Train Loss: 0.297 Vali Loss: 1.110 Vali Acc: 0.575 Test Loss: 1.110 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 1.3566851615905762
Epoch: 18, Steps: 3 | Train Loss: 0.221 Vali Loss: 1.098 Vali Acc: 0.575 Test Loss: 1.098 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 19 cost time: 1.2623071670532227
Epoch: 19, Steps: 3 | Train Loss: 0.234 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 20 cost time: 1.3489234447479248
Epoch: 20, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.052 Vali Acc: 0.575 Test Loss: 1.052 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 1.1805591583251953
Epoch: 21, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 1.147007703781128
Epoch: 22, Steps: 3 | Train Loss: 0.120 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 1.2431740760803223
Epoch: 23, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.024 Vali Acc: 0.550 Test Loss: 1.024 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.214167594909668
Epoch: 24, Steps: 3 | Train Loss: 0.094 Vali Loss: 1.033 Vali Acc: 0.575 Test Loss: 1.033 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1768715381622314
Epoch: 25, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.021 Vali Acc: 0.575 Test Loss: 1.021 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2625386714935303
Epoch: 26, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.003 Vali Acc: 0.575 Test Loss: 1.003 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0969758033752441
Epoch: 27, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 1.1723096370697021
Epoch: 28, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.974 Vali Acc: 0.650 Test Loss: 0.974 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 29 cost time: 1.2684435844421387
Epoch: 29, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.973 Vali Acc: 0.650 Test Loss: 0.973 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 1.235625982284546
Epoch: 30, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.979 Vali Acc: 0.650 Test Loss: 0.979 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.137664794921875
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.136228322982788
Epoch: 32, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.998 Vali Acc: 0.625 Test Loss: 0.998 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3222804069519043
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2701122760772705
Epoch: 34, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2318367958068848
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.979 Vali Acc: 0.625 Test Loss: 0.979 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0244803428649902
Epoch: 36, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.966 Vali Acc: 0.625 Test Loss: 0.966 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.19881010055542
Epoch: 37, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.967 Vali Acc: 0.625 Test Loss: 0.967 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.115027904510498
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.976 Vali Acc: 0.625 Test Loss: 0.976 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.216541051864624
Epoch: 39, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.980 Vali Acc: 0.625 Test Loss: 0.980 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3842456340789795
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2976281642913818
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0902941226959229
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2913148403167725
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.23923659324646
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2485718727111816
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2820136547088623
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2638778686523438
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.260460615158081
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3648767471313477
Epoch: 10, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 1.267571210861206
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.3202111721038818
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.3217110633850098
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.2166941165924072
Epoch: 14, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2211637496948242
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2122094631195068
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2202479839324951
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.251103162765503
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.243645429611206
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4336388111114502
Epoch: 20, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.106100082397461
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.27614426612854
Epoch: 22, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 23 cost time: 1.136413335800171
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.2190053462982178
Epoch: 24, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 25 cost time: 1.197493076324463
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1923844814300537
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.139434814453125
Epoch: 27, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.293018102645874
Epoch: 28, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1877753734588623
Epoch: 29, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1727321147918701
Epoch: 30, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1472516059875488
Epoch: 31, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1721646785736084
Epoch: 32, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1903135776519775
Epoch: 33, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1110589504241943
Epoch: 34, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 854404
model size : 8.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.597724676132202
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.421 Vali Acc: 0.275 Test Loss: 1.421 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.3405871391296387
Epoch: 2, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.2994561195373535
Epoch: 3, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.255 Vali Acc: 0.425 Test Loss: 1.255 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.3169338703155518
Epoch: 4, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.424987 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.4321556091308594
Epoch: 5, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 1.4571216106414795
Epoch: 6, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.887 Vali Acc: 0.750 Test Loss: 0.887 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.4442343711853027
Epoch: 7, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.770 Vali Acc: 0.800 Test Loss: 0.770 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 1.2719991207122803
Epoch: 8, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.671 Vali Acc: 0.825 Test Loss: 0.671 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 1.3254821300506592
Epoch: 9, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 1.2762267589569092
Epoch: 10, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.527 Vali Acc: 0.925 Test Loss: 0.527 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 1.2329223155975342
Epoch: 11, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 1.2447998523712158
Epoch: 12, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 1.3314096927642822
Epoch: 13, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 1.3818094730377197
Epoch: 14, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 1.312169075012207
Epoch: 15, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2859632968902588
Epoch: 16, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2347369194030762
Epoch: 17, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2007670402526855
Epoch: 18, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.212803840637207
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2981460094451904
Epoch: 20, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1561622619628906
Epoch: 21, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 1.2433829307556152
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.2254419326782227
Epoch: 23, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.1675212383270264
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 1.1752521991729736
Epoch: 25, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 1.305351734161377
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.2070515155792236
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.267183780670166
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 1.2713990211486816
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 1.3291981220245361
Epoch: 30, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 1.1585807800292969
Epoch: 31, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 1.2672827243804932
Epoch: 32, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 1.3077118396759033
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 1.1380727291107178
Epoch: 34, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 1.2912952899932861
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.323216199874878
Epoch: 36, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.3872675895690918
Epoch: 37, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.3040878772735596
Epoch: 38, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 1.1860191822052002
Epoch: 39, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 1.2403604984283447
Epoch: 40, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.2240092754364014
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.3832406997680664
Epoch: 42, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.3669676780700684
Epoch: 43, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.3806867599487305
Epoch: 44, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3068974018096924
Epoch: 45, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1321971416473389
Epoch: 46, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.2283415794372559
Epoch: 47, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.3763220310211182
Epoch: 48, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.279068946838379
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.3115360736846924
Epoch: 50, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.425321340560913
Epoch: 51, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 1.4467754364013672
Epoch: 52, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 1.2191212177276611
Epoch: 53, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 1.1389718055725098
Epoch: 54, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.1254651546478271
Epoch: 55, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 1.1549456119537354
Epoch: 56, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 1.2228455543518066
Epoch: 57, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 1.2581517696380615
Epoch: 58, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.250556468963623
Epoch: 59, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1419847011566162
Epoch: 60, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2657604217529297
Epoch: 61, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.295332908630371
Epoch: 62, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.189483642578125
Epoch: 63, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.165700912475586
Epoch: 64, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.2617993354797363
Epoch: 65, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.2695837020874023
Epoch: 66, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2392280101776123
Epoch: 67, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4955124855041504
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.433 Vali Acc: 0.125 Test Loss: 1.433 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 1.241828203201294
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.362 Vali Acc: 0.300 Test Loss: 1.362 Test Acc: 0.300
Validation loss decreased (-0.124986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.2873218059539795
Epoch: 3, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.299986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.1998519897460938
Epoch: 4, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.142 Vali Acc: 0.650 Test Loss: 1.142 Test Acc: 0.650
Validation loss decreased (-0.499987 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.222357988357544
Epoch: 5, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.019 Vali Acc: 0.725 Test Loss: 1.019 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 1.2222566604614258
Epoch: 6, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 1.2853057384490967
Epoch: 7, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.337590217590332
Epoch: 8, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.2569072246551514
Epoch: 9, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 1.3719704151153564
Epoch: 10, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.3074252605438232
Epoch: 11, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 1.3952157497406006
Epoch: 12, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 1.306199073791504
Epoch: 13, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.440 Vali Acc: 0.925 Test Loss: 0.440 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4291346073150635
Epoch: 14, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2665581703186035
Epoch: 15, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.294497013092041
Epoch: 16, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2085602283477783
Epoch: 17, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2990155220031738
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2149605751037598
Epoch: 19, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3097965717315674
Epoch: 20, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.344280481338501
Epoch: 21, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2290499210357666
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.450413703918457
Epoch: 1, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.439 Vali Acc: 0.150 Test Loss: 1.439 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.152369499206543
Epoch: 2, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.363 Vali Acc: 0.350 Test Loss: 1.363 Test Acc: 0.350
Validation loss decreased (-0.149986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.224942684173584
Epoch: 3, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.268 Vali Acc: 0.525 Test Loss: 1.268 Test Acc: 0.525
Validation loss decreased (-0.349986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 1.1827163696289062
Epoch: 4, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.149 Vali Acc: 0.650 Test Loss: 1.149 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 1.1860485076904297
Epoch: 5, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.030 Vali Acc: 0.775 Test Loss: 1.030 Test Acc: 0.775
Validation loss decreased (-0.649989 --> -0.774990).  Saving model ...
Epoch: 6 cost time: 1.1970198154449463
Epoch: 6, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.924 Vali Acc: 0.825 Test Loss: 0.924 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 1.2018537521362305
Epoch: 7, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 1.372859001159668
Epoch: 8, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 1.1245248317718506
Epoch: 9, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.653 Vali Acc: 0.875 Test Loss: 0.653 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 1.1592535972595215
Epoch: 10, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.604 Vali Acc: 0.950 Test Loss: 0.604 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 1.266540765762329
Epoch: 11, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 1.3359577655792236
Epoch: 12, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.533 Vali Acc: 0.925 Test Loss: 0.533 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4004733562469482
Epoch: 13, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.506 Vali Acc: 0.950 Test Loss: 0.506 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 1.286611557006836
Epoch: 14, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 1.320702314376831
Epoch: 15, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.479 Vali Acc: 0.950 Test Loss: 0.479 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 1.2129404544830322
Epoch: 16, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.467 Vali Acc: 0.950 Test Loss: 0.467 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 1.174335241317749
Epoch: 17, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.462 Vali Acc: 0.950 Test Loss: 0.462 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 1.2560553550720215
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 1.2204136848449707
Epoch: 19, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 1.280470371246338
Epoch: 20, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3832387924194336
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3476505279541016
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1959176063537598
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2011771202087402
Epoch: 24, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2218842506408691
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.327989101409912
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2554740905761719
Epoch: 27, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1512830257415771
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2675230503082275
Epoch: 29, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.754298210144043
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.459 Vali Acc: 0.200 Test Loss: 1.459 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.2402245998382568
Epoch: 2, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
Validation loss decreased (-0.199985 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.2573838233947754
Epoch: 3, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
Validation loss decreased (-0.324986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.253382921218872
Epoch: 4, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.163 Vali Acc: 0.575 Test Loss: 1.163 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.1206443309783936
Epoch: 5, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 1.2341728210449219
Epoch: 6, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.930 Vali Acc: 0.725 Test Loss: 0.930 Test Acc: 0.725
Validation loss decreased (-0.599990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 1.3042547702789307
Epoch: 7, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.828 Vali Acc: 0.775 Test Loss: 0.828 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 8 cost time: 1.2494089603424072
Epoch: 8, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 1.209892988204956
Epoch: 9, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 10 cost time: 1.2821178436279297
Epoch: 10, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 11 cost time: 1.1981816291809082
Epoch: 11, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.603 Vali Acc: 0.825 Test Loss: 0.603 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 12 cost time: 1.2509887218475342
Epoch: 12, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 13 cost time: 1.2850875854492188
Epoch: 13, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.283522129058838
Epoch: 14, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.292273998260498
Epoch: 15, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.528 Vali Acc: 0.750 Test Loss: 0.528 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3563320636749268
Epoch: 16, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.505 Vali Acc: 0.775 Test Loss: 0.505 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2762455940246582
Epoch: 17, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.490 Vali Acc: 0.800 Test Loss: 0.490 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2878365516662598
Epoch: 18, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.483 Vali Acc: 0.825 Test Loss: 0.483 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 1.2042405605316162
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.478 Vali Acc: 0.825 Test Loss: 0.478 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 20 cost time: 1.1844305992126465
Epoch: 20, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.288719654083252
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 1.3050312995910645
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 1.2927658557891846
Epoch: 23, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.3470642566680908
Epoch: 24, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.369875431060791
Epoch: 25, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 1.2309622764587402
Epoch: 26, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2398796081542969
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2624993324279785
Epoch: 28, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.775 Test Loss: 0.466 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1343984603881836
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.775 Test Loss: 0.466 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.260197639465332
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.775 Test Loss: 0.466 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2316229343414307
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.800 Test Loss: 0.466 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1711513996124268
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.464 Vali Acc: 0.800 Test Loss: 0.464 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.164846420288086
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.825 Test Loss: 0.462 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1932029724121094
Epoch: 34, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2146949768066406
Epoch: 35, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.825 Test Loss: 0.458 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6366896629333496
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.424 Vali Acc: 0.300 Test Loss: 1.424 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.143993616104126
Epoch: 2, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.368 Vali Acc: 0.325 Test Loss: 1.368 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.2946631908416748
Epoch: 3, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.1667301654815674
Epoch: 4, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 1.2148101329803467
Epoch: 5, Steps: 3 | Train Loss: 0.952 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 1.2212145328521729
Epoch: 6, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.996 Vali Acc: 0.650 Test Loss: 0.996 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 1.1932885646820068
Epoch: 7, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.898 Vali Acc: 0.725 Test Loss: 0.898 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 1.2912228107452393
Epoch: 8, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.816 Vali Acc: 0.750 Test Loss: 0.816 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 9 cost time: 1.1681041717529297
Epoch: 9, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 10 cost time: 1.1430010795593262
Epoch: 10, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.703 Vali Acc: 0.800 Test Loss: 0.703 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.1438987255096436
Epoch: 11, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2506322860717773
Epoch: 12, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2048110961914062
Epoch: 13, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2135884761810303
Epoch: 14, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.2575078010559082
Epoch: 15, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 1.3468046188354492
Epoch: 16, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 17 cost time: 1.2910819053649902
Epoch: 17, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 18 cost time: 1.2878921031951904
Epoch: 18, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1769471168518066
Epoch: 19, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.556 Vali Acc: 0.825 Test Loss: 0.556 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.260789394378662
Epoch: 20, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.561 Vali Acc: 0.800 Test Loss: 0.561 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3376867771148682
Epoch: 21, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.564 Vali Acc: 0.800 Test Loss: 0.564 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5375490188598633
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4168288707733154
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.574 Vali Acc: 0.800 Test Loss: 0.574 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.298306941986084
Epoch: 24, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2799878120422363
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.586 Vali Acc: 0.825 Test Loss: 0.586 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.305082082748413
Epoch: 26, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.216076135635376
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.587 Vali Acc: 0.825 Test Loss: 0.587 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6778035163879395
Epoch: 1, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.523 Vali Acc: 0.275 Test Loss: 1.523 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.27604079246521
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.503 Vali Acc: 0.300 Test Loss: 1.503 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.2319047451019287
Epoch: 3, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.466 Vali Acc: 0.300 Test Loss: 1.466 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.1702165603637695
Epoch: 4, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.419 Vali Acc: 0.275 Test Loss: 1.419 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3125040531158447
Epoch: 5, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.374 Vali Acc: 0.325 Test Loss: 1.374 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.249274730682373
Epoch: 6, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.328 Vali Acc: 0.375 Test Loss: 1.328 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.2279462814331055
Epoch: 7, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.1346845626831055
Epoch: 8, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.228 Vali Acc: 0.475 Test Loss: 1.228 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 1.1568126678466797
Epoch: 9, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.2734408378601074
Epoch: 10, Steps: 3 | Train Loss: 0.655 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.3293371200561523
Epoch: 11, Steps: 3 | Train Loss: 0.583 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.2298521995544434
Epoch: 12, Steps: 3 | Train Loss: 0.523 Vali Loss: 1.102 Vali Acc: 0.575 Test Loss: 1.102 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 1.2288942337036133
Epoch: 13, Steps: 3 | Train Loss: 0.441 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 1.264460563659668
Epoch: 14, Steps: 3 | Train Loss: 0.395 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3412177562713623
Epoch: 15, Steps: 3 | Train Loss: 0.285 Vali Loss: 1.031 Vali Acc: 0.650 Test Loss: 1.031 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 16 cost time: 1.2539236545562744
Epoch: 16, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.983 Vali Acc: 0.650 Test Loss: 0.983 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 17 cost time: 1.3310201168060303
Epoch: 17, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.948 Vali Acc: 0.650 Test Loss: 0.948 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 18 cost time: 1.4544782638549805
Epoch: 18, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.921 Vali Acc: 0.650 Test Loss: 0.921 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 19 cost time: 1.3810513019561768
Epoch: 19, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.896 Vali Acc: 0.650 Test Loss: 0.896 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 20 cost time: 1.4014341831207275
Epoch: 20, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.887 Vali Acc: 0.650 Test Loss: 0.887 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 21 cost time: 1.3536763191223145
Epoch: 21, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.878 Vali Acc: 0.650 Test Loss: 0.878 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 22 cost time: 1.2532591819763184
Epoch: 22, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.869 Vali Acc: 0.675 Test Loss: 0.869 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 23 cost time: 1.3326146602630615
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.840 Vali Acc: 0.700 Test Loss: 0.840 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699992).  Saving model ...
Epoch: 24 cost time: 1.438101053237915
Epoch: 24, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.813 Vali Acc: 0.675 Test Loss: 0.813 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.290273666381836
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.794 Vali Acc: 0.675 Test Loss: 0.794 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3261559009552002
Epoch: 26, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.787 Vali Acc: 0.700 Test Loss: 0.787 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 27 cost time: 1.3989477157592773
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.791 Vali Acc: 0.700 Test Loss: 0.791 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2713806629180908
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.804 Vali Acc: 0.675 Test Loss: 0.804 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3440454006195068
Epoch: 29, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.808 Vali Acc: 0.675 Test Loss: 0.808 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2864091396331787
Epoch: 30, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.805 Vali Acc: 0.675 Test Loss: 0.805 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3589560985565186
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.792 Vali Acc: 0.675 Test Loss: 0.792 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3360488414764404
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.778 Vali Acc: 0.675 Test Loss: 0.778 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2988085746765137
Epoch: 33, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.765 Vali Acc: 0.675 Test Loss: 0.765 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.293144702911377
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.756 Vali Acc: 0.675 Test Loss: 0.756 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2253668308258057
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.747 Vali Acc: 0.700 Test Loss: 0.747 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699993).  Saving model ...
Epoch: 36 cost time: 1.3331356048583984
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.739 Vali Acc: 0.700 Test Loss: 0.739 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 37 cost time: 1.328462839126587
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.734 Vali Acc: 0.700 Test Loss: 0.734 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 38 cost time: 1.2204599380493164
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.731 Vali Acc: 0.675 Test Loss: 0.731 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2073993682861328
Epoch: 39, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.730 Vali Acc: 0.700 Test Loss: 0.730 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 40 cost time: 1.1967060565948486
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.725 Vali Acc: 0.700 Test Loss: 0.725 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 41 cost time: 1.2128679752349854
Epoch: 41, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.721 Vali Acc: 0.700 Test Loss: 0.721 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 42 cost time: 1.2123651504516602
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.718 Vali Acc: 0.725 Test Loss: 0.718 Test Acc: 0.725
Validation loss decreased (-0.699993 --> -0.724993).  Saving model ...
Epoch: 43 cost time: 1.3473544120788574
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.715 Vali Acc: 0.725 Test Loss: 0.715 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 44 cost time: 1.2602169513702393
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.724993 --> -0.749993).  Saving model ...
Epoch: 45 cost time: 1.1955549716949463
Epoch: 45, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 46 cost time: 1.2419044971466064
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 47 cost time: 1.0919339656829834
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1635770797729492
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3071200847625732
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.159590482711792
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 51 cost time: 1.114518404006958
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 52 cost time: 1.1771013736724854
Epoch: 52, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 53 cost time: 1.1751587390899658
Epoch: 53, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 54 cost time: 1.2044074535369873
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2506942749023438
Epoch: 55, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.725 Test Loss: 0.709 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2754292488098145
Epoch: 56, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.725 Test Loss: 0.709 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.2980244159698486
Epoch: 57, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.725 Test Loss: 0.708 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.3378446102142334
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.725 Test Loss: 0.708 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.234504222869873
Epoch: 59, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.725 Test Loss: 0.707 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.2449839115142822
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.750 Test Loss: 0.706 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.3967781066894531
Epoch: 61, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.322322130203247
Epoch: 62, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.1399800777435303
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 64 cost time: 1.3201844692230225
Epoch: 64, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 65 cost time: 1.3248209953308105
Epoch: 65, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 66 cost time: 1.3164358139038086
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1743388175964355
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1463046073913574
Epoch: 68, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.2232122421264648
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1462926864624023
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.775 Test Loss: 0.708 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.2290740013122559
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.750 Test Loss: 0.710 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.266794204711914
Epoch: 72, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.1587588787078857
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.2551188468933105
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.1747674942016602
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7729456424713135
Epoch: 1, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.541 Vali Acc: 0.100 Test Loss: 1.541 Test Acc: 0.100
Validation loss decreased (inf --> -0.099985).  Saving model ...
Epoch: 2 cost time: 1.2328624725341797
Epoch: 2, Steps: 3 | Train Loss: 1.502 Vali Loss: 1.528 Vali Acc: 0.100 Test Loss: 1.528 Test Acc: 0.100
Validation loss decreased (-0.099985 --> -0.099985).  Saving model ...
Epoch: 3 cost time: 1.238914966583252
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.503 Vali Acc: 0.125 Test Loss: 1.503 Test Acc: 0.125
Validation loss decreased (-0.099985 --> -0.124985).  Saving model ...
Epoch: 4 cost time: 1.2886946201324463
Epoch: 4, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.473 Vali Acc: 0.175 Test Loss: 1.473 Test Acc: 0.175
Validation loss decreased (-0.124985 --> -0.174985).  Saving model ...
Epoch: 5 cost time: 1.2906639575958252
Epoch: 5, Steps: 3 | Train Loss: 1.260 Vali Loss: 1.443 Vali Acc: 0.175 Test Loss: 1.443 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 1.2198805809020996
Epoch: 6, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.417 Vali Acc: 0.225 Test Loss: 1.417 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 7 cost time: 1.277902364730835
Epoch: 7, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 8 cost time: 1.25531005859375
Epoch: 8, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.368 Vali Acc: 0.350 Test Loss: 1.368 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 1.3053257465362549
Epoch: 9, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.355 Vali Acc: 0.325 Test Loss: 1.355 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2453062534332275
Epoch: 10, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.342 Vali Acc: 0.275 Test Loss: 1.342 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2909660339355469
Epoch: 11, Steps: 3 | Train Loss: 0.702 Vali Loss: 1.333 Vali Acc: 0.275 Test Loss: 1.333 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3073492050170898
Epoch: 12, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.329 Vali Acc: 0.275 Test Loss: 1.329 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3004138469696045
Epoch: 13, Steps: 3 | Train Loss: 0.594 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2062337398529053
Epoch: 14, Steps: 3 | Train Loss: 0.491 Vali Loss: 1.311 Vali Acc: 0.325 Test Loss: 1.311 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2990543842315674
Epoch: 15, Steps: 3 | Train Loss: 0.419 Vali Loss: 1.295 Vali Acc: 0.300 Test Loss: 1.295 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2897651195526123
Epoch: 16, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.272 Vali Acc: 0.300 Test Loss: 1.272 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.289785623550415
Epoch: 17, Steps: 3 | Train Loss: 0.329 Vali Loss: 1.265 Vali Acc: 0.325 Test Loss: 1.265 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3749630451202393
Epoch: 18, Steps: 3 | Train Loss: 0.293 Vali Loss: 1.278 Vali Acc: 0.350 Test Loss: 1.278 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 19 cost time: 1.3581562042236328
Epoch: 19, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.297 Vali Acc: 0.350 Test Loss: 1.297 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2957770824432373
Epoch: 20, Steps: 3 | Train Loss: 0.187 Vali Loss: 1.304 Vali Acc: 0.350 Test Loss: 1.304 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2990846633911133
Epoch: 21, Steps: 3 | Train Loss: 0.176 Vali Loss: 1.304 Vali Acc: 0.375 Test Loss: 1.304 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 22 cost time: 1.335087537765503
Epoch: 22, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2679316997528076
Epoch: 23, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.266 Vali Acc: 0.425 Test Loss: 1.266 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 24 cost time: 1.1346473693847656
Epoch: 24, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.240 Vali Acc: 0.425 Test Loss: 1.240 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 25 cost time: 1.2440264225006104
Epoch: 25, Steps: 3 | Train Loss: 0.094 Vali Loss: 1.253 Vali Acc: 0.450 Test Loss: 1.253 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449987).  Saving model ...
Epoch: 26 cost time: 1.1260066032409668
Epoch: 26, Steps: 3 | Train Loss: 0.086 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1588923931121826
Epoch: 27, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.187225580215454
Epoch: 28, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.370 Vali Acc: 0.425 Test Loss: 1.370 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2707550525665283
Epoch: 29, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4617254734039307
Epoch: 30, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.301 Vali Acc: 0.450 Test Loss: 1.301 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.396655559539795
Epoch: 31, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.267 Vali Acc: 0.475 Test Loss: 1.267 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 32 cost time: 1.273458480834961
Epoch: 32, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 33 cost time: 1.2151575088500977
Epoch: 33, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 34 cost time: 1.2746124267578125
Epoch: 34, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2309012413024902
Epoch: 35, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2128517627716064
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2328379154205322
Epoch: 37, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.295 Vali Acc: 0.475 Test Loss: 1.295 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2111008167266846
Epoch: 38, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.329 Vali Acc: 0.475 Test Loss: 1.329 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2711448669433594
Epoch: 39, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1251006126403809
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1104929447174072
Epoch: 41, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.307 Vali Acc: 0.525 Test Loss: 1.307 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524987).  Saving model ...
Epoch: 42 cost time: 1.2232279777526855
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.281 Vali Acc: 0.525 Test Loss: 1.281 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 43 cost time: 1.186067819595337
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.255 Vali Acc: 0.525 Test Loss: 1.255 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 44 cost time: 1.2325098514556885
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.241 Vali Acc: 0.525 Test Loss: 1.241 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524988).  Saving model ...
Epoch: 45 cost time: 1.3530616760253906
Epoch: 45, Steps: 3 | Train Loss: 0.008 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 46 cost time: 1.494441270828247
Epoch: 46, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.228 Vali Acc: 0.550 Test Loss: 1.228 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 47 cost time: 1.2843809127807617
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.224 Vali Acc: 0.550 Test Loss: 1.224 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 48 cost time: 1.3107883930206299
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.222 Vali Acc: 0.575 Test Loss: 1.222 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 49 cost time: 1.3682055473327637
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 1.216 Vali Acc: 0.600 Test Loss: 1.216 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 50 cost time: 1.371297836303711
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.205 Vali Acc: 0.600 Test Loss: 1.205 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 51 cost time: 1.2913908958435059
Epoch: 51, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.205 Vali Acc: 0.600 Test Loss: 1.205 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.243605613708496
Epoch: 52, Steps: 3 | Train Loss: 0.006 Vali Loss: 1.217 Vali Acc: 0.575 Test Loss: 1.217 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3735630512237549
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.228 Vali Acc: 0.575 Test Loss: 1.228 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.3637161254882812
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.243 Vali Acc: 0.550 Test Loss: 1.243 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2344450950622559
Epoch: 55, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.251 Vali Acc: 0.550 Test Loss: 1.251 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2363801002502441
Epoch: 56, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.250 Vali Acc: 0.550 Test Loss: 1.250 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.3459479808807373
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.252 Vali Acc: 0.550 Test Loss: 1.252 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.4895215034484863
Epoch: 58, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.258 Vali Acc: 0.550 Test Loss: 1.258 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.3400564193725586
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 1.256 Vali Acc: 0.600 Test Loss: 1.256 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.3437726497650146
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.260 Vali Acc: 0.625 Test Loss: 1.260 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624987).  Saving model ...
Epoch: 61 cost time: 1.231123447418213
Epoch: 61, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.265 Vali Acc: 0.650 Test Loss: 1.265 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 62 cost time: 1.2290534973144531
Epoch: 62, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.267 Vali Acc: 0.675 Test Loss: 1.267 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674987).  Saving model ...
Epoch: 63 cost time: 1.1766164302825928
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.270 Vali Acc: 0.675 Test Loss: 1.270 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2218289375305176
Epoch: 64, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.271 Vali Acc: 0.675 Test Loss: 1.271 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.217101812362671
Epoch: 65, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.266 Vali Acc: 0.675 Test Loss: 1.266 Test Acc: 0.675
Validation loss decreased (-0.674987 --> -0.674987).  Saving model ...
Epoch: 66 cost time: 1.2056481838226318
Epoch: 66, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.267 Vali Acc: 0.675 Test Loss: 1.267 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2151424884796143
Epoch: 67, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.268 Vali Acc: 0.675 Test Loss: 1.268 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1359257698059082
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 1.272 Vali Acc: 0.675 Test Loss: 1.272 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1517119407653809
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.281 Vali Acc: 0.675 Test Loss: 1.281 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.246434211730957
Epoch: 70, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.675 Test Loss: 1.293 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.1892750263214111
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.302 Vali Acc: 0.675 Test Loss: 1.302 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.2575345039367676
Epoch: 72, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.313 Vali Acc: 0.675 Test Loss: 1.313 Test Acc: 0.675
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.2503061294555664
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.318 Vali Acc: 0.675 Test Loss: 1.318 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.2557830810546875
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 1.318 Vali Acc: 0.675 Test Loss: 1.318 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.2481062412261963
Epoch: 75, Steps: 3 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.675 Test Loss: 1.320 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.675
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5932068824768066
Epoch: 1, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.409 Vali Acc: 0.275 Test Loss: 1.409 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.2646832466125488
Epoch: 2, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.168428897857666
Epoch: 3, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.369 Vali Acc: 0.300 Test Loss: 1.369 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.4232308864593506
Epoch: 4, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.338 Vali Acc: 0.325 Test Loss: 1.338 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 1.22139573097229
Epoch: 5, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.305 Vali Acc: 0.350 Test Loss: 1.305 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 1.171814203262329
Epoch: 6, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.278 Vali Acc: 0.325 Test Loss: 1.278 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2818984985351562
Epoch: 7, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.2993342876434326
Epoch: 8, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.218 Vali Acc: 0.350 Test Loss: 1.218 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3706612586975098
Epoch: 9, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.199 Vali Acc: 0.375 Test Loss: 1.199 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4150669574737549
Epoch: 10, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 1.2999801635742188
Epoch: 11, Steps: 3 | Train Loss: 0.665 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 1.2195563316345215
Epoch: 12, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.172 Vali Acc: 0.425 Test Loss: 1.172 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 1.2501330375671387
Epoch: 13, Steps: 3 | Train Loss: 0.607 Vali Loss: 1.162 Vali Acc: 0.425 Test Loss: 1.162 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 14 cost time: 1.3269736766815186
Epoch: 14, Steps: 3 | Train Loss: 0.442 Vali Loss: 1.153 Vali Acc: 0.450 Test Loss: 1.153 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 1.292489767074585
Epoch: 15, Steps: 3 | Train Loss: 0.424 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 1.1459026336669922
Epoch: 16, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.110 Vali Acc: 0.525 Test Loss: 1.110 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 17 cost time: 1.2314255237579346
Epoch: 17, Steps: 3 | Train Loss: 0.325 Vali Loss: 1.087 Vali Acc: 0.575 Test Loss: 1.087 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 1.1497554779052734
Epoch: 18, Steps: 3 | Train Loss: 0.283 Vali Loss: 1.069 Vali Acc: 0.550 Test Loss: 1.069 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3573944568634033
Epoch: 19, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.056 Vali Acc: 0.550 Test Loss: 1.056 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1850383281707764
Epoch: 20, Steps: 3 | Train Loss: 0.154 Vali Loss: 1.038 Vali Acc: 0.550 Test Loss: 1.038 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1222381591796875
Epoch: 21, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.018 Vali Acc: 0.550 Test Loss: 1.018 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2489149570465088
Epoch: 22, Steps: 3 | Train Loss: 0.123 Vali Loss: 1.031 Vali Acc: 0.525 Test Loss: 1.031 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1487226486206055
Epoch: 23, Steps: 3 | Train Loss: 0.131 Vali Loss: 1.030 Vali Acc: 0.525 Test Loss: 1.030 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2082974910736084
Epoch: 24, Steps: 3 | Train Loss: 0.094 Vali Loss: 1.013 Vali Acc: 0.550 Test Loss: 1.013 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2184867858886719
Epoch: 25, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.999 Vali Acc: 0.550 Test Loss: 0.999 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1087253093719482
Epoch: 26, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.998 Vali Acc: 0.575 Test Loss: 0.998 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 27 cost time: 1.289377212524414
Epoch: 27, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.999 Vali Acc: 0.575 Test Loss: 0.999 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2900545597076416
Epoch: 28, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.984 Vali Acc: 0.575 Test Loss: 0.984 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 29 cost time: 1.3665766716003418
Epoch: 29, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.955 Vali Acc: 0.625 Test Loss: 0.955 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 30 cost time: 1.246861457824707
Epoch: 30, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2396306991577148
Epoch: 31, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.949 Vali Acc: 0.625 Test Loss: 0.949 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 32 cost time: 1.2544796466827393
Epoch: 32, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.954 Vali Acc: 0.575 Test Loss: 0.954 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2488934993743896
Epoch: 33, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.958 Vali Acc: 0.575 Test Loss: 0.958 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3399865627288818
Epoch: 34, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.977 Vali Acc: 0.575 Test Loss: 0.977 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.307952880859375
Epoch: 35, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.989 Vali Acc: 0.575 Test Loss: 0.989 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.357616662979126
Epoch: 36, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.995 Vali Acc: 0.575 Test Loss: 0.995 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.317016839981079
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.994 Vali Acc: 0.575 Test Loss: 0.994 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.27052640914917
Epoch: 38, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.995 Vali Acc: 0.575 Test Loss: 0.995 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3419227600097656
Epoch: 39, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.993 Vali Acc: 0.575 Test Loss: 0.993 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.3593080043792725
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.968 Vali Acc: 0.625 Test Loss: 0.968 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3545598983764648
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.949 Vali Acc: 0.650 Test Loss: 0.949 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 42 cost time: 1.3246872425079346
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.934 Vali Acc: 0.650 Test Loss: 0.934 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 43 cost time: 1.3175032138824463
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.924 Vali Acc: 0.625 Test Loss: 0.924 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3718862533569336
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.922 Vali Acc: 0.650 Test Loss: 0.922 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 45 cost time: 1.264418363571167
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.924 Vali Acc: 0.625 Test Loss: 0.924 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.296208381652832
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.928 Vali Acc: 0.625 Test Loss: 0.928 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3407788276672363
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.941 Vali Acc: 0.625 Test Loss: 0.941 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3710556030273438
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5322449207305908
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.960 Vali Acc: 0.625 Test Loss: 0.960 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.197460412979126
Epoch: 50, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.958 Vali Acc: 0.625 Test Loss: 0.958 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2120187282562256
Epoch: 51, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.956 Vali Acc: 0.625 Test Loss: 0.956 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2884373664855957
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.956 Vali Acc: 0.625 Test Loss: 0.956 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.2564451694488525
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.954 Vali Acc: 0.625 Test Loss: 0.954 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.1318626403808594
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.954 Vali Acc: 0.625 Test Loss: 0.954 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.547074794769287
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3562650680541992
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3675956726074219
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2874560356140137
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.112898588180542
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.323164463043213
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1457443237304688
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2781462669372559
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.215022087097168
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2423207759857178
Epoch: 10, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1855833530426025
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.118170976638794
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.240013599395752
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2123725414276123
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1971592903137207
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2675268650054932
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2367608547210693
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1690192222595215
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2244923114776611
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0968692302703857
Epoch: 20, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2268381118774414
Epoch: 21, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 756100
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.576697587966919
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.432 Vali Acc: 0.200 Test Loss: 1.432 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.3059632778167725
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.386 Vali Acc: 0.350 Test Loss: 1.386 Test Acc: 0.350
Validation loss decreased (-0.199986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.2265405654907227
Epoch: 3, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
Validation loss decreased (-0.349986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.3114030361175537
Epoch: 4, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.241 Vali Acc: 0.475 Test Loss: 1.241 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2788870334625244
Epoch: 5, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 1.326324224472046
Epoch: 6, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 1.3185124397277832
Epoch: 7, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.978 Vali Acc: 0.750 Test Loss: 0.978 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 1.2076058387756348
Epoch: 8, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.246053695678711
Epoch: 9, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 1.2591662406921387
Epoch: 10, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.3520190715789795
Epoch: 11, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.660 Vali Acc: 0.825 Test Loss: 0.660 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 1.2638657093048096
Epoch: 12, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.3312575817108154
Epoch: 13, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 14 cost time: 1.3278188705444336
Epoch: 14, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 1.2576165199279785
Epoch: 15, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.477 Vali Acc: 0.875 Test Loss: 0.477 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 1.2133686542510986
Epoch: 16, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.461 Vali Acc: 0.875 Test Loss: 0.461 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 1.227459192276001
Epoch: 17, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 18 cost time: 1.2806575298309326
Epoch: 18, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 19 cost time: 1.229306697845459
Epoch: 19, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 20 cost time: 1.21307373046875
Epoch: 20, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 21 cost time: 1.2506201267242432
Epoch: 21, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.21272873878479
Epoch: 22, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.2746648788452148
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 1.2857069969177246
Epoch: 24, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.2409701347351074
Epoch: 25, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.2714858055114746
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.2509193420410156
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.2428545951843262
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.3378326892852783
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.2979178428649902
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 1.3226323127746582
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 1.2637360095977783
Epoch: 32, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.205479383468628
Epoch: 33, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.287893295288086
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.254148244857788
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4239802360534668
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3946807384490967
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.383455753326416
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.391188144683838
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3444101810455322
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2735631465911865
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.380669355392456
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.346118450164795
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.49177622795105
Epoch: 1, Steps: 3 | Train Loss: 1.581 Vali Loss: 1.458 Vali Acc: 0.150 Test Loss: 1.458 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.2443170547485352
Epoch: 2, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.410 Vali Acc: 0.250 Test Loss: 1.410 Test Acc: 0.250
Validation loss decreased (-0.149985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2482943534851074
Epoch: 3, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.346 Vali Acc: 0.475 Test Loss: 1.346 Test Acc: 0.475
Validation loss decreased (-0.249986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.1617488861083984
Epoch: 4, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.1677372455596924
Epoch: 5, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.178 Vali Acc: 0.575 Test Loss: 1.178 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.0773558616638184
Epoch: 6, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.089 Vali Acc: 0.625 Test Loss: 1.089 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.0849006175994873
Epoch: 7, Steps: 3 | Train Loss: 0.828 Vali Loss: 1.003 Vali Acc: 0.750 Test Loss: 1.003 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 1.112837314605713
Epoch: 8, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.1988179683685303
Epoch: 9, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.831 Vali Acc: 0.750 Test Loss: 0.831 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.201810598373413
Epoch: 10, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.750 Vali Acc: 0.850 Test Loss: 0.750 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 1.1515989303588867
Epoch: 11, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.1325342655181885
Epoch: 12, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 13 cost time: 1.1337904930114746
Epoch: 13, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.0669565200805664
Epoch: 14, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 1.2390010356903076
Epoch: 15, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 1.1234989166259766
Epoch: 16, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 1.1676557064056396
Epoch: 17, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 1.1759963035583496
Epoch: 18, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 1.1874468326568604
Epoch: 19, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 20 cost time: 1.1573214530944824
Epoch: 20, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.458 Vali Acc: 0.875 Test Loss: 0.458 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 21 cost time: 1.2216346263885498
Epoch: 21, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 22 cost time: 1.1069614887237549
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.2413122653961182
Epoch: 23, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 1.1884005069732666
Epoch: 24, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.2356362342834473
Epoch: 25, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.1960573196411133
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.3288769721984863
Epoch: 27, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.284757375717163
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.234574794769287
Epoch: 29, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.379948616027832
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 1.299447774887085
Epoch: 31, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.2413480281829834
Epoch: 32, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.2638709545135498
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.1909527778625488
Epoch: 34, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 1.2441675662994385
Epoch: 35, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.2667479515075684
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.3890888690948486
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.2483971118927002
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.253072738647461
Epoch: 39, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.253185749053955
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.3442440032958984
Epoch: 41, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2028508186340332
Epoch: 42, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 1.1707255840301514
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 1.1645584106445312
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 1.1715736389160156
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 1.1998176574707031
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 1.308436632156372
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 1.263026475906372
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1744649410247803
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2453267574310303
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 1.2627904415130615
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 1.2390673160552979
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 1.3404691219329834
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 1.1923317909240723
Epoch: 54, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 1.1764743328094482
Epoch: 55, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 1.240464210510254
Epoch: 56, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 57 cost time: 1.1987924575805664
Epoch: 57, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 1.2939438819885254
Epoch: 58, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 1.1373445987701416
Epoch: 59, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 1.3246638774871826
Epoch: 60, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 61 cost time: 1.207512378692627
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 62 cost time: 1.1688406467437744
Epoch: 62, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 63 cost time: 1.1849603652954102
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 64 cost time: 1.4012408256530762
Epoch: 64, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 65 cost time: 1.5678737163543701
Epoch: 65, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 66 cost time: 1.2995281219482422
Epoch: 66, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 67 cost time: 1.344115972518921
Epoch: 67, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 68 cost time: 1.1769928932189941
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 69 cost time: 1.223092794418335
Epoch: 69, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 70 cost time: 1.2604777812957764
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 71 cost time: 1.2719371318817139
Epoch: 71, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 72 cost time: 1.3246800899505615
Epoch: 72, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 73 cost time: 1.2832047939300537
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.373868465423584
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.1880714893341064
Epoch: 75, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 76 cost time: 1.212993860244751
Epoch: 76, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 77 cost time: 1.1921675205230713
Epoch: 77, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 78 cost time: 1.2590312957763672
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 79 cost time: 1.1413390636444092
Epoch: 79, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 80 cost time: 1.2899701595306396
Epoch: 80, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 81 cost time: 1.2924118041992188
Epoch: 81, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 82 cost time: 1.1170058250427246
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 83 cost time: 1.249922275543213
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 84 cost time: 1.1847801208496094
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 85 cost time: 1.0928690433502197
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 86 cost time: 1.165696382522583
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.2258057594299316
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.4018023014068604
Epoch: 88, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.194037914276123
Epoch: 89, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.2941005229949951
Epoch: 90, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.13808274269104
Epoch: 91, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.2646758556365967
Epoch: 92, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 1.195932149887085
Epoch: 93, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.2516756057739258
Epoch: 94, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 1.3852550983428955
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 96 cost time: 1.2856056690216064
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 97 cost time: 1.3162450790405273
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 98 cost time: 1.289788007736206
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 99 cost time: 1.411113977432251
Epoch: 99, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 100 cost time: 1.3769817352294922
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.750277042388916
Epoch: 1, Steps: 3 | Train Loss: 1.582 Vali Loss: 1.421 Vali Acc: 0.175 Test Loss: 1.421 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.2466189861297607
Epoch: 2, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.371 Vali Acc: 0.400 Test Loss: 1.371 Test Acc: 0.400
Validation loss decreased (-0.174986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.3367455005645752
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.305 Vali Acc: 0.475 Test Loss: 1.305 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.3473882675170898
Epoch: 4, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.224 Vali Acc: 0.575 Test Loss: 1.224 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.3881747722625732
Epoch: 5, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 1.3084368705749512
Epoch: 6, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.046 Vali Acc: 0.750 Test Loss: 1.046 Test Acc: 0.750
Validation loss decreased (-0.599989 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 1.3516225814819336
Epoch: 7, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.961 Vali Acc: 0.775 Test Loss: 0.961 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.275864839553833
Epoch: 8, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 1.3894989490509033
Epoch: 9, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.216228723526001
Epoch: 10, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 1.1636695861816406
Epoch: 11, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.653 Vali Acc: 0.875 Test Loss: 0.653 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 1.252943754196167
Epoch: 12, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 1.2530946731567383
Epoch: 13, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 14 cost time: 1.3959143161773682
Epoch: 14, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 1.1906301975250244
Epoch: 15, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 1.2613263130187988
Epoch: 16, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.2005457878112793
Epoch: 17, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 1.3213508129119873
Epoch: 18, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.2132513523101807
Epoch: 19, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 1.2183773517608643
Epoch: 20, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.177070140838623
Epoch: 21, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.351320743560791
Epoch: 22, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.277472734451294
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 1.1348960399627686
Epoch: 24, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.2001094818115234
Epoch: 25, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.117861270904541
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.1838200092315674
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.4108726978302002
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.390 Vali Acc: 0.925 Test Loss: 0.390 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.3368983268737793
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.2405719757080078
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 1.228379249572754
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.3315949440002441
Epoch: 32, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.212728500366211
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.287290096282959
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 1.3123846054077148
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.275681972503662
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.2391624450683594
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.278949499130249
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.145967721939087
Epoch: 39, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.3058178424835205
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.2120413780212402
Epoch: 41, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.366713523864746
Epoch: 42, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3660993576049805
Epoch: 43, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1857085227966309
Epoch: 44, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.139521837234497
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.138925313949585
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.185899257659912
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1095614433288574
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2838160991668701
Epoch: 49, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1996335983276367
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.775744915008545
Epoch: 1, Steps: 3 | Train Loss: 1.533 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 1.3898413181304932
Epoch: 2, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.329 Vali Acc: 0.550 Test Loss: 1.329 Test Acc: 0.550
Validation loss decreased (-0.424986 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 1.3038818836212158
Epoch: 3, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.272 Vali Acc: 0.550 Test Loss: 1.272 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 1.1993157863616943
Epoch: 4, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.199 Vali Acc: 0.600 Test Loss: 1.199 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.2426373958587646
Epoch: 5, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.120762586593628
Epoch: 6, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 1.1096460819244385
Epoch: 7, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 1.2409777641296387
Epoch: 8, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.897 Vali Acc: 0.725 Test Loss: 0.897 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2251827716827393
Epoch: 9, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.3247580528259277
Epoch: 10, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 1.264369249343872
Epoch: 11, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.3360419273376465
Epoch: 12, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 1.2268624305725098
Epoch: 13, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.638 Vali Acc: 0.825 Test Loss: 0.638 Test Acc: 0.825
Validation loss decreased (-0.774993 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.4676249027252197
Epoch: 14, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 15 cost time: 1.455916404724121
Epoch: 15, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.589 Vali Acc: 0.825 Test Loss: 0.589 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 16 cost time: 1.3559308052062988
Epoch: 16, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3083183765411377
Epoch: 17, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.563 Vali Acc: 0.750 Test Loss: 0.563 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3121695518493652
Epoch: 18, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.549 Vali Acc: 0.800 Test Loss: 0.549 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3185253143310547
Epoch: 19, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2553324699401855
Epoch: 20, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.514 Vali Acc: 0.800 Test Loss: 0.514 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3138296604156494
Epoch: 21, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.500 Vali Acc: 0.800 Test Loss: 0.500 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5569822788238525
Epoch: 22, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.489 Vali Acc: 0.775 Test Loss: 0.489 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3064332008361816
Epoch: 23, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.480 Vali Acc: 0.775 Test Loss: 0.480 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.301711082458496
Epoch: 24, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.474 Vali Acc: 0.775 Test Loss: 0.474 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.262629747390747
Epoch: 25, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.468 Vali Acc: 0.775 Test Loss: 0.468 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.482477903366089
Epoch: 1, Steps: 3 | Train Loss: 1.527 Vali Loss: 1.436 Vali Acc: 0.350 Test Loss: 1.436 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.1494626998901367
Epoch: 2, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.392 Vali Acc: 0.450 Test Loss: 1.392 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 1.222771406173706
Epoch: 3, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.336 Vali Acc: 0.425 Test Loss: 1.336 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2245736122131348
Epoch: 4, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.265 Vali Acc: 0.425 Test Loss: 1.265 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1344270706176758
Epoch: 5, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.185 Vali Acc: 0.475 Test Loss: 1.185 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 1.3038976192474365
Epoch: 6, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 1.1533501148223877
Epoch: 7, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.025 Vali Acc: 0.675 Test Loss: 1.025 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 1.2783291339874268
Epoch: 8, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.947 Vali Acc: 0.675 Test Loss: 0.947 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 9 cost time: 1.149505376815796
Epoch: 9, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.876 Vali Acc: 0.650 Test Loss: 0.876 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1440081596374512
Epoch: 10, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.805 Vali Acc: 0.725 Test Loss: 0.805 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724992).  Saving model ...
Epoch: 11 cost time: 1.1870136260986328
Epoch: 11, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774993).  Saving model ...
Epoch: 12 cost time: 1.191504716873169
Epoch: 12, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 1.2922003269195557
Epoch: 13, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.641 Vali Acc: 0.800 Test Loss: 0.641 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799994).  Saving model ...
Epoch: 14 cost time: 1.142185926437378
Epoch: 14, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.3522160053253174
Epoch: 15, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.582 Vali Acc: 0.800 Test Loss: 0.582 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 1.2150778770446777
Epoch: 16, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.562 Vali Acc: 0.800 Test Loss: 0.562 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 1.384885549545288
Epoch: 17, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 18 cost time: 1.2288715839385986
Epoch: 18, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.537 Vali Acc: 0.800 Test Loss: 0.537 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 19 cost time: 1.2596805095672607
Epoch: 19, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.537 Vali Acc: 0.800 Test Loss: 0.537 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.218724250793457
Epoch: 20, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 21 cost time: 1.4344403743743896
Epoch: 21, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2456982135772705
Epoch: 22, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.527 Vali Acc: 0.800 Test Loss: 0.527 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.370065450668335
Epoch: 23, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.507 Vali Acc: 0.800 Test Loss: 0.507 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2943377494812012
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 25 cost time: 1.3417866230010986
Epoch: 25, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.483 Vali Acc: 0.825 Test Loss: 0.483 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 26 cost time: 1.4193098545074463
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.481 Vali Acc: 0.825 Test Loss: 0.481 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 27 cost time: 1.1887199878692627
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.485 Vali Acc: 0.825 Test Loss: 0.485 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2599904537200928
Epoch: 28, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.491 Vali Acc: 0.800 Test Loss: 0.491 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2322471141815186
Epoch: 29, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.496 Vali Acc: 0.800 Test Loss: 0.496 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1638412475585938
Epoch: 30, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.496 Vali Acc: 0.800 Test Loss: 0.496 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1919338703155518
Epoch: 31, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.494 Vali Acc: 0.800 Test Loss: 0.494 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2414088249206543
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.492 Vali Acc: 0.800 Test Loss: 0.492 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2370750904083252
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.490 Vali Acc: 0.800 Test Loss: 0.490 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1542720794677734
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.489 Vali Acc: 0.800 Test Loss: 0.489 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2949943542480469
Epoch: 35, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.488 Vali Acc: 0.800 Test Loss: 0.488 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.272592544555664
Epoch: 36, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.495 Vali Acc: 0.800 Test Loss: 0.495 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4218411445617676
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.420 Vali Acc: 0.200 Test Loss: 1.420 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.2802762985229492
Epoch: 2, Steps: 3 | Train Loss: 1.560 Vali Loss: 1.409 Vali Acc: 0.200 Test Loss: 1.409 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 1.3006188869476318
Epoch: 3, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.392 Vali Acc: 0.200 Test Loss: 1.392 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 1.2995946407318115
Epoch: 4, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.372 Vali Acc: 0.200 Test Loss: 1.372 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 1.237091064453125
Epoch: 5, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.346 Vali Acc: 0.250 Test Loss: 1.346 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 1.1947646141052246
Epoch: 6, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.320 Vali Acc: 0.275 Test Loss: 1.320 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 1.2338755130767822
Epoch: 7, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.292 Vali Acc: 0.350 Test Loss: 1.292 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 1.3324394226074219
Epoch: 8, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.261 Vali Acc: 0.375 Test Loss: 1.261 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 1.371910572052002
Epoch: 9, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.232 Vali Acc: 0.425 Test Loss: 1.232 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 1.3863182067871094
Epoch: 10, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.323796033859253
Epoch: 11, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.170 Vali Acc: 0.600 Test Loss: 1.170 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 1.201822280883789
Epoch: 12, Steps: 3 | Train Loss: 0.715 Vali Loss: 1.136 Vali Acc: 0.625 Test Loss: 1.136 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.2799732685089111
Epoch: 13, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.102 Vali Acc: 0.650 Test Loss: 1.102 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 1.3994967937469482
Epoch: 14, Steps: 3 | Train Loss: 0.593 Vali Loss: 1.075 Vali Acc: 0.650 Test Loss: 1.075 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 1.266521692276001
Epoch: 15, Steps: 3 | Train Loss: 0.525 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 1.4011497497558594
Epoch: 16, Steps: 3 | Train Loss: 0.422 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 1.3199148178100586
Epoch: 17, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.3283991813659668
Epoch: 18, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.962 Vali Acc: 0.725 Test Loss: 0.962 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 1.2686302661895752
Epoch: 19, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.936 Vali Acc: 0.725 Test Loss: 0.936 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 1.2506752014160156
Epoch: 20, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.907 Vali Acc: 0.750 Test Loss: 0.907 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 1.367201566696167
Epoch: 21, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.891 Vali Acc: 0.725 Test Loss: 0.891 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3277041912078857
Epoch: 22, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.885 Vali Acc: 0.725 Test Loss: 0.885 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2733616828918457
Epoch: 23, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3178305625915527
Epoch: 24, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.879 Vali Acc: 0.700 Test Loss: 0.879 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.295250654220581
Epoch: 25, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.870 Vali Acc: 0.725 Test Loss: 0.870 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3815312385559082
Epoch: 26, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.858 Vali Acc: 0.725 Test Loss: 0.858 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2991504669189453
Epoch: 27, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.840 Vali Acc: 0.725 Test Loss: 0.840 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.351039171218872
Epoch: 28, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.824 Vali Acc: 0.725 Test Loss: 0.824 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2002811431884766
Epoch: 29, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 30 cost time: 1.3154187202453613
Epoch: 30, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 31 cost time: 1.1854450702667236
Epoch: 31, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 32 cost time: 1.387819528579712
Epoch: 32, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 33 cost time: 1.2731022834777832
Epoch: 33, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 34 cost time: 1.2164959907531738
Epoch: 34, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 35 cost time: 1.1973223686218262
Epoch: 35, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.755 Vali Acc: 0.750 Test Loss: 0.755 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 36 cost time: 1.2058603763580322
Epoch: 36, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.743 Vali Acc: 0.750 Test Loss: 0.743 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 37 cost time: 1.1705505847930908
Epoch: 37, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 38 cost time: 1.2321717739105225
Epoch: 38, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 39 cost time: 1.3022148609161377
Epoch: 39, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 40 cost time: 1.3635509014129639
Epoch: 40, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 41 cost time: 1.4367990493774414
Epoch: 41, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 42 cost time: 1.2786664962768555
Epoch: 42, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 43 cost time: 1.2511756420135498
Epoch: 43, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 44 cost time: 1.2127680778503418
Epoch: 44, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 45 cost time: 1.2896697521209717
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 46 cost time: 1.366288423538208
Epoch: 46, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3949105739593506
Epoch: 47, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.540045976638794
Epoch: 48, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.223196029663086
Epoch: 49, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.713 Vali Acc: 0.750 Test Loss: 0.713 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 50 cost time: 1.4334144592285156
Epoch: 50, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 51 cost time: 1.3394362926483154
Epoch: 51, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.701 Vali Acc: 0.800 Test Loss: 0.701 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 52 cost time: 1.405714511871338
Epoch: 52, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.695 Vali Acc: 0.775 Test Loss: 0.695 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3658850193023682
Epoch: 53, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3640029430389404
Epoch: 54, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3420791625976562
Epoch: 55, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.692 Vali Acc: 0.800 Test Loss: 0.692 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 56 cost time: 1.3051795959472656
Epoch: 56, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.800 Test Loss: 0.691 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 57 cost time: 1.3951513767242432
Epoch: 57, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 58 cost time: 1.386354923248291
Epoch: 58, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.3717460632324219
Epoch: 59, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.3429977893829346
Epoch: 60, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2724103927612305
Epoch: 61, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.696 Vali Acc: 0.800 Test Loss: 0.696 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.3265879154205322
Epoch: 62, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.694 Vali Acc: 0.800 Test Loss: 0.694 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2072672843933105
Epoch: 63, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.800 Test Loss: 0.690 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.2588956356048584
Epoch: 64, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 65 cost time: 1.2960851192474365
Epoch: 65, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 66 cost time: 1.2990610599517822
Epoch: 66, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 67 cost time: 1.316554069519043
Epoch: 67, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.27549147605896
Epoch: 68, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2022628784179688
Epoch: 69, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 70 cost time: 1.5473687648773193
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.2604691982269287
Epoch: 71, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.3000807762145996
Epoch: 72, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.2336018085479736
Epoch: 73, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.692 Vali Acc: 0.825 Test Loss: 0.692 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.2481200695037842
Epoch: 74, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.690 Vali Acc: 0.825 Test Loss: 0.690 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.2175726890563965
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 76 cost time: 1.2656736373901367
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 77 cost time: 1.229015588760376
Epoch: 77, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.825 Test Loss: 0.686 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 78 cost time: 1.2231523990631104
Epoch: 78, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.825 Test Loss: 0.685 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 79 cost time: 1.3743047714233398
Epoch: 79, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.825 Test Loss: 0.683 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 80 cost time: 1.326850175857544
Epoch: 80, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.3293914794921875
Epoch: 81, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.3300292491912842
Epoch: 82, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.800 Test Loss: 0.680 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.380300760269165
Epoch: 83, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.2709999084472656
Epoch: 84, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.3080570697784424
Epoch: 85, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.800 Test Loss: 0.679 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.2460575103759766
Epoch: 86, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.3024954795837402
Epoch: 87, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 1.2411115169525146
Epoch: 88, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 1.3766436576843262
Epoch: 89, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.391855001449585
Epoch: 1, Steps: 3 | Train Loss: 1.541 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1605701446533203
Epoch: 2, Steps: 3 | Train Loss: 1.540 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.225853443145752
Epoch: 3, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.375 Vali Acc: 0.275 Test Loss: 1.375 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.3009421825408936
Epoch: 4, Steps: 3 | Train Loss: 1.436 Vali Loss: 1.369 Vali Acc: 0.275 Test Loss: 1.369 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.2237298488616943
Epoch: 5, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.363 Vali Acc: 0.300 Test Loss: 1.363 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 1.2430143356323242
Epoch: 6, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.358 Vali Acc: 0.300 Test Loss: 1.358 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 7 cost time: 1.1338386535644531
Epoch: 7, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.355 Vali Acc: 0.275 Test Loss: 1.355 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2782795429229736
Epoch: 8, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.354 Vali Acc: 0.250 Test Loss: 1.354 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0103576183319092
Epoch: 9, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.356 Vali Acc: 0.275 Test Loss: 1.356 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1454136371612549
Epoch: 10, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.353 Vali Acc: 0.250 Test Loss: 1.353 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2153069972991943
Epoch: 11, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.348 Vali Acc: 0.250 Test Loss: 1.348 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1885628700256348
Epoch: 12, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.340 Vali Acc: 0.275 Test Loss: 1.340 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.177919864654541
Epoch: 13, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.331 Vali Acc: 0.275 Test Loss: 1.331 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.22444748878479
Epoch: 14, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 15 cost time: 1.1225407123565674
Epoch: 15, Steps: 3 | Train Loss: 0.713 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 16 cost time: 1.2110955715179443
Epoch: 16, Steps: 3 | Train Loss: 0.659 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 17 cost time: 1.1604461669921875
Epoch: 17, Steps: 3 | Train Loss: 0.652 Vali Loss: 1.328 Vali Acc: 0.425 Test Loss: 1.328 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1139419078826904
Epoch: 18, Steps: 3 | Train Loss: 0.547 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 19 cost time: 1.2206480503082275
Epoch: 19, Steps: 3 | Train Loss: 0.501 Vali Loss: 1.313 Vali Acc: 0.425 Test Loss: 1.313 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 20 cost time: 1.156660556793213
Epoch: 20, Steps: 3 | Train Loss: 0.488 Vali Loss: 1.303 Vali Acc: 0.475 Test Loss: 1.303 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 21 cost time: 1.1570086479187012
Epoch: 21, Steps: 3 | Train Loss: 0.439 Vali Loss: 1.295 Vali Acc: 0.450 Test Loss: 1.295 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.096170425415039
Epoch: 22, Steps: 3 | Train Loss: 0.361 Vali Loss: 1.301 Vali Acc: 0.425 Test Loss: 1.301 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2327296733856201
Epoch: 23, Steps: 3 | Train Loss: 0.314 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1408390998840332
Epoch: 24, Steps: 3 | Train Loss: 0.286 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3339898586273193
Epoch: 25, Steps: 3 | Train Loss: 0.284 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2771198749542236
Epoch: 26, Steps: 3 | Train Loss: 0.229 Vali Loss: 1.418 Vali Acc: 0.375 Test Loss: 1.418 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2687716484069824
Epoch: 27, Steps: 3 | Train Loss: 0.201 Vali Loss: 1.421 Vali Acc: 0.375 Test Loss: 1.421 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2455596923828125
Epoch: 28, Steps: 3 | Train Loss: 0.192 Vali Loss: 1.422 Vali Acc: 0.375 Test Loss: 1.422 Test Acc: 0.375
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1942834854125977
Epoch: 29, Steps: 3 | Train Loss: 0.157 Vali Loss: 1.425 Vali Acc: 0.375 Test Loss: 1.425 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2627902030944824
Epoch: 30, Steps: 3 | Train Loss: 0.164 Vali Loss: 1.424 Vali Acc: 0.375 Test Loss: 1.424 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.475
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.763603448867798
Epoch: 1, Steps: 3 | Train Loss: 1.606 Vali Loss: 1.357 Vali Acc: 0.275 Test Loss: 1.357 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.2802159786224365
Epoch: 2, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.351 Vali Acc: 0.275 Test Loss: 1.351 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.2798309326171875
Epoch: 3, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.342 Vali Acc: 0.250 Test Loss: 1.342 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3222737312316895
Epoch: 4, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.332 Vali Acc: 0.250 Test Loss: 1.332 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3044054508209229
Epoch: 5, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.319 Vali Acc: 0.275 Test Loss: 1.319 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 6 cost time: 1.198307752609253
Epoch: 6, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.308 Vali Acc: 0.250 Test Loss: 1.308 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2571008205413818
Epoch: 7, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.300 Vali Acc: 0.300 Test Loss: 1.300 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 8 cost time: 1.2379465103149414
Epoch: 8, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.293 Vali Acc: 0.350 Test Loss: 1.293 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 1.2636172771453857
Epoch: 9, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.288 Vali Acc: 0.375 Test Loss: 1.288 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 1.274271011352539
Epoch: 10, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.278 Vali Acc: 0.425 Test Loss: 1.278 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 11 cost time: 1.2763330936431885
Epoch: 11, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.267 Vali Acc: 0.450 Test Loss: 1.267 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 12 cost time: 1.2310559749603271
Epoch: 12, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.253 Vali Acc: 0.475 Test Loss: 1.253 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 13 cost time: 1.26350736618042
Epoch: 13, Steps: 3 | Train Loss: 0.873 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1240906715393066
Epoch: 14, Steps: 3 | Train Loss: 0.740 Vali Loss: 1.228 Vali Acc: 0.375 Test Loss: 1.228 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2837324142456055
Epoch: 15, Steps: 3 | Train Loss: 0.680 Vali Loss: 1.221 Vali Acc: 0.375 Test Loss: 1.221 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2374591827392578
Epoch: 16, Steps: 3 | Train Loss: 0.629 Vali Loss: 1.218 Vali Acc: 0.375 Test Loss: 1.218 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.387958288192749
Epoch: 17, Steps: 3 | Train Loss: 0.646 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2026140689849854
Epoch: 18, Steps: 3 | Train Loss: 0.545 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.216299057006836
Epoch: 19, Steps: 3 | Train Loss: 0.459 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3968818187713623
Epoch: 20, Steps: 3 | Train Loss: 0.471 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1750593185424805
Epoch: 21, Steps: 3 | Train Loss: 0.423 Vali Loss: 1.156 Vali Acc: 0.450 Test Loss: 1.156 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3030147552490234
Epoch: 22, Steps: 3 | Train Loss: 0.358 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.475
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4095170497894287
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2805390357971191
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2767581939697266
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3215489387512207
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1981534957885742
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3220207691192627
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1841075420379639
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2262983322143555
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3842265605926514
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3288426399230957
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3345322608947754
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1274724006652832
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 965828
model size : 6.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5209527015686035
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.415 Vali Acc: 0.100 Test Loss: 1.415 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 1.158355951309204
Epoch: 2, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.375 Vali Acc: 0.150 Test Loss: 1.375 Test Acc: 0.150
Validation loss decreased (-0.099986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 1.174776554107666
Epoch: 3, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.149986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.0305397510528564
Epoch: 4, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.241 Vali Acc: 0.550 Test Loss: 1.241 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 1.2121219635009766
Epoch: 5, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 1.0561981201171875
Epoch: 6, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 1.084878921508789
Epoch: 7, Steps: 3 | Train Loss: 0.888 Vali Loss: 0.972 Vali Acc: 0.775 Test Loss: 0.972 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.1480555534362793
Epoch: 8, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 1.1775517463684082
Epoch: 9, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.079202651977539
Epoch: 10, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 11 cost time: 1.0600473880767822
Epoch: 11, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 12 cost time: 1.1063625812530518
Epoch: 12, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.576 Vali Acc: 0.925 Test Loss: 0.576 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 1.1240153312683105
Epoch: 13, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 1.182204008102417
Epoch: 14, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 1.2544710636138916
Epoch: 15, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 1.2520358562469482
Epoch: 16, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 1.2683351039886475
Epoch: 17, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 1.2352204322814941
Epoch: 18, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 1.1927375793457031
Epoch: 19, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.226917028427124
Epoch: 20, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 1.2478723526000977
Epoch: 21, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 1.2294509410858154
Epoch: 22, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 1.297288179397583
Epoch: 23, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.169830083847046
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.2019157409667969
Epoch: 25, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.267580509185791
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.1480271816253662
Epoch: 27, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.2399530410766602
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.3160696029663086
Epoch: 29, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.2530102729797363
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 1.197481632232666
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 1.2256159782409668
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.17740797996521
Epoch: 33, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.1236631870269775
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 35 cost time: 1.1695082187652588
Epoch: 35, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 36 cost time: 1.204991102218628
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 37 cost time: 1.2593069076538086
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 38 cost time: 1.1225707530975342
Epoch: 38, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 39 cost time: 1.1623191833496094
Epoch: 39, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 40 cost time: 1.1403937339782715
Epoch: 40, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 41 cost time: 1.2741007804870605
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 42 cost time: 1.2203733921051025
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 43 cost time: 1.225555181503296
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 44 cost time: 1.1476361751556396
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.925 Test Loss: 0.228 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 45 cost time: 1.2172071933746338
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 46 cost time: 1.165858268737793
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 47 cost time: 1.1254005432128906
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 48 cost time: 1.1876041889190674
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 49 cost time: 1.1890339851379395
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 50 cost time: 1.2476603984832764
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 51 cost time: 1.0811982154846191
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 52 cost time: 1.1066088676452637
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 53 cost time: 1.1693172454833984
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 54 cost time: 1.2296216487884521
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 55 cost time: 1.2920200824737549
Epoch: 55, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 56 cost time: 1.299999475479126
Epoch: 56, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 57 cost time: 1.2761914730072021
Epoch: 57, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.925 Test Loss: 0.214 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 58 cost time: 1.1748874187469482
Epoch: 58, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 59 cost time: 1.1725976467132568
Epoch: 59, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 60 cost time: 1.2565197944641113
Epoch: 60, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 61 cost time: 1.219966173171997
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 62 cost time: 1.216609239578247
Epoch: 62, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 63 cost time: 1.2547039985656738
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 64 cost time: 1.3885910511016846
Epoch: 64, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.925 Test Loss: 0.209 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 65 cost time: 1.1928179264068604
Epoch: 65, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 66 cost time: 1.2462668418884277
Epoch: 66, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.925 Test Loss: 0.208 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 67 cost time: 1.1590819358825684
Epoch: 67, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 68 cost time: 1.1895372867584229
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.925 Test Loss: 0.207 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 69 cost time: 1.2295293807983398
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 70 cost time: 1.2025043964385986
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 71 cost time: 1.2708697319030762
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 72 cost time: 1.1546292304992676
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 73 cost time: 1.1431832313537598
Epoch: 73, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 74 cost time: 1.089487075805664
Epoch: 74, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 75 cost time: 1.229093074798584
Epoch: 75, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 76 cost time: 1.0932507514953613
Epoch: 76, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 77 cost time: 1.1778810024261475
Epoch: 77, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 78 cost time: 1.2893898487091064
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 79 cost time: 1.190089225769043
Epoch: 79, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 80 cost time: 1.175511121749878
Epoch: 80, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.1618156433105469
Epoch: 81, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.1963112354278564
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.2044198513031006
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.2464654445648193
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.266845703125
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 1.2011229991912842
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 87 cost time: 1.1856529712677002
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 88 cost time: 1.0916025638580322
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.1533970832824707
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.1665563583374023
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.2573740482330322
Epoch: 91, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 92 cost time: 1.3003900051116943
Epoch: 92, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 93 cost time: 1.2648024559020996
Epoch: 93, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 94 cost time: 1.2514336109161377
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 95 cost time: 1.2400856018066406
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 96 cost time: 1.1565916538238525
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 97 cost time: 1.152216911315918
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 98 cost time: 1.3149514198303223
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 99 cost time: 1.2320153713226318
Epoch: 99, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 100 cost time: 1.2744653224945068
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5529587268829346
Epoch: 1, Steps: 3 | Train Loss: 1.510 Vali Loss: 1.411 Vali Acc: 0.175 Test Loss: 1.411 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.4566164016723633
Epoch: 2, Steps: 3 | Train Loss: 1.446 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.258455753326416
Epoch: 3, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.313 Vali Acc: 0.350 Test Loss: 1.313 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.2972400188446045
Epoch: 4, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.239 Vali Acc: 0.625 Test Loss: 1.239 Test Acc: 0.625
Validation loss decreased (-0.349987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 1.1394176483154297
Epoch: 5, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.153 Vali Acc: 0.725 Test Loss: 1.153 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724988).  Saving model ...
Epoch: 6 cost time: 1.2391180992126465
Epoch: 6, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.067 Vali Acc: 0.750 Test Loss: 1.067 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 1.2056806087493896
Epoch: 7, Steps: 3 | Train Loss: 0.908 Vali Loss: 0.975 Vali Acc: 0.775 Test Loss: 0.975 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 1.1798913478851318
Epoch: 8, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 1.2715175151824951
Epoch: 9, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.802 Vali Acc: 0.850 Test Loss: 0.802 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 1.2457749843597412
Epoch: 10, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.728 Vali Acc: 0.875 Test Loss: 0.728 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 1.2330875396728516
Epoch: 11, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 1.3712096214294434
Epoch: 12, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.600 Vali Acc: 0.900 Test Loss: 0.600 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 1.429661512374878
Epoch: 13, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.550 Vali Acc: 0.950 Test Loss: 0.550 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 1.2418181896209717
Epoch: 14, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.507 Vali Acc: 0.950 Test Loss: 0.507 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 1.1925568580627441
Epoch: 15, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.475 Vali Acc: 0.950 Test Loss: 0.475 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 1.1082661151885986
Epoch: 16, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 1.232555866241455
Epoch: 17, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 1.2627289295196533
Epoch: 18, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 1.3226280212402344
Epoch: 19, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 1.2078964710235596
Epoch: 20, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 1.5350208282470703
Epoch: 21, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 1.2469263076782227
Epoch: 22, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 1.1699821949005127
Epoch: 23, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 1.390949010848999
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 1.3825666904449463
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 1.2166132926940918
Epoch: 26, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 1.3495347499847412
Epoch: 27, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 1.1751055717468262
Epoch: 28, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 1.225156545639038
Epoch: 29, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 1.1742990016937256
Epoch: 30, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 1.2368485927581787
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 1.206233024597168
Epoch: 32, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 1.2142102718353271
Epoch: 33, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 1.3704838752746582
Epoch: 34, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 1.2722547054290771
Epoch: 35, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.302638053894043
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.1861488819122314
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.3389027118682861
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 1.202049732208252
Epoch: 39, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 1.1806919574737549
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.1443395614624023
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.2461719512939453
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.2143089771270752
Epoch: 43, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.2579009532928467
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.319645643234253
Epoch: 45, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.1794278621673584
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.2850422859191895
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.1898274421691895
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.2294719219207764
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.2000720500946045
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.2891724109649658
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 1.3219189643859863
Epoch: 52, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 1.278010368347168
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 1.3205394744873047
Epoch: 54, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.3175525665283203
Epoch: 55, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 1.296375036239624
Epoch: 56, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 1.3367578983306885
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 1.4020774364471436
Epoch: 58, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 59 cost time: 1.4728419780731201
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 60 cost time: 1.3382327556610107
Epoch: 60, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 61 cost time: 1.3988444805145264
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 62 cost time: 1.230255365371704
Epoch: 62, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 63 cost time: 1.362501621246338
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 64 cost time: 1.3634617328643799
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 65 cost time: 1.3533225059509277
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 66 cost time: 1.2368073463439941
Epoch: 66, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 67 cost time: 1.3747081756591797
Epoch: 67, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.382753849029541
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.1989398002624512
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 70 cost time: 1.2860164642333984
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.248727798461914
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.2010996341705322
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.27565336227417
Epoch: 73, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.1491520404815674
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.22348952293396
Epoch: 75, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.2748191356658936
Epoch: 76, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.2345025539398193
Epoch: 77, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.2385640144348145
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 79 cost time: 1.2794091701507568
Epoch: 79, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 80 cost time: 1.334082841873169
Epoch: 80, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.3210082054138184
Epoch: 81, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.36551833152771
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.3358335494995117
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.1230382919311523
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 85 cost time: 1.1435010433197021
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 86 cost time: 1.2145445346832275
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 87 cost time: 1.177647352218628
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 88 cost time: 1.1353950500488281
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 89 cost time: 1.2681560516357422
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.27189040184021
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.3394176959991455
Epoch: 91, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.1402223110198975
Epoch: 92, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.4134242534637451
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.235013484954834
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 95 cost time: 1.2794275283813477
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 96 cost time: 1.2908320426940918
Epoch: 96, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 97 cost time: 1.5697646141052246
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 98 cost time: 1.398941993713379
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 99 cost time: 1.1920664310455322
Epoch: 99, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 100 cost time: 1.1853747367858887
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6936869621276855
Epoch: 1, Steps: 3 | Train Loss: 1.516 Vali Loss: 1.433 Vali Acc: 0.150 Test Loss: 1.433 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.0951571464538574
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.149986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.1854028701782227
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.328 Vali Acc: 0.350 Test Loss: 1.328 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.3417956829071045
Epoch: 4, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.253 Vali Acc: 0.600 Test Loss: 1.253 Test Acc: 0.600
Validation loss decreased (-0.349987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 1.3271963596343994
Epoch: 5, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.166 Vali Acc: 0.625 Test Loss: 1.166 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 1.2063124179840088
Epoch: 6, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.3514041900634766
Epoch: 7, Steps: 3 | Train Loss: 0.888 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 1.2767894268035889
Epoch: 8, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.895 Vali Acc: 0.750 Test Loss: 0.895 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.2082879543304443
Epoch: 9, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 1.3103697299957275
Epoch: 10, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.730 Vali Acc: 0.800 Test Loss: 0.730 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.3033430576324463
Epoch: 11, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.2634084224700928
Epoch: 12, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.601 Vali Acc: 0.900 Test Loss: 0.601 Test Acc: 0.900
Validation loss decreased (-0.799993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 1.2991952896118164
Epoch: 13, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 1.1741502285003662
Epoch: 14, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 1.2478716373443604
Epoch: 15, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 1.3079578876495361
Epoch: 16, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.3952336311340332
Epoch: 17, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 1.2790918350219727
Epoch: 18, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.3349664211273193
Epoch: 19, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 1.2698540687561035
Epoch: 20, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.473543405532837
Epoch: 21, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 1.5978977680206299
Epoch: 22, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.368788480758667
Epoch: 23, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 1.3287875652313232
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.4461464881896973
Epoch: 25, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.28230619430542
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.3409569263458252
Epoch: 27, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.4086177349090576
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.5606894493103027
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.35477614402771
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 1.3917291164398193
Epoch: 31, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 1.3750877380371094
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.3052136898040771
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.2157974243164062
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 1.468763828277588
Epoch: 35, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 1.3392376899719238
Epoch: 36, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 1.4128601551055908
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 1.3141679763793945
Epoch: 38, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 1.1780281066894531
Epoch: 39, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 1.2085270881652832
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 1.2352423667907715
Epoch: 41, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 1.2603745460510254
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 1.2527117729187012
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 1.273505449295044
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 1.2115626335144043
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 1.0758588314056396
Epoch: 46, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.316 Vali Acc: 0.925 Test Loss: 0.316 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 47 cost time: 1.1428430080413818
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 48 cost time: 1.2106013298034668
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 49 cost time: 1.195629358291626
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 1.195570468902588
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 51 cost time: 1.271496057510376
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 1.3413031101226807
Epoch: 52, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 1.0780582427978516
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 54 cost time: 1.1362557411193848
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 55 cost time: 1.1395835876464844
Epoch: 55, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 56 cost time: 1.112070083618164
Epoch: 56, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 1.3532557487487793
Epoch: 57, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.4253623485565186
Epoch: 58, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 1.3948397636413574
Epoch: 59, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 60 cost time: 1.3547718524932861
Epoch: 60, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 1.299118995666504
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 62 cost time: 1.1805236339569092
Epoch: 62, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 63 cost time: 1.3188977241516113
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.367539882659912
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.5413241386413574
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 66 cost time: 1.4340665340423584
Epoch: 66, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2115888595581055
Epoch: 67, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.246697187423706
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.3309733867645264
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.2495739459991455
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.349062442779541
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.3942487239837646
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.2911818027496338
Epoch: 73, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.2906668186187744
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.3179364204406738
Epoch: 75, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.557339906692505
Epoch: 1, Steps: 3 | Train Loss: 1.546 Vali Loss: 1.377 Vali Acc: 0.400 Test Loss: 1.377 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.3445305824279785
Epoch: 2, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.333 Vali Acc: 0.425 Test Loss: 1.333 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.330862283706665
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.2604715824127197
Epoch: 4, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.197 Vali Acc: 0.625 Test Loss: 1.197 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 1.263045310974121
Epoch: 5, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.110 Vali Acc: 0.700 Test Loss: 1.110 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 1.2604990005493164
Epoch: 6, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.028 Vali Acc: 0.700 Test Loss: 1.028 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 1.258878231048584
Epoch: 7, Steps: 3 | Train Loss: 0.904 Vali Loss: 0.942 Vali Acc: 0.725 Test Loss: 0.942 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 1.2177166938781738
Epoch: 8, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.2483816146850586
Epoch: 9, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.789 Vali Acc: 0.775 Test Loss: 0.789 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 1.2171907424926758
Epoch: 10, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.725 Vali Acc: 0.800 Test Loss: 0.725 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 1.1952173709869385
Epoch: 11, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.2126054763793945
Epoch: 12, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.626 Vali Acc: 0.775 Test Loss: 0.626 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2169175148010254
Epoch: 13, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.594 Vali Acc: 0.775 Test Loss: 0.594 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2603487968444824
Epoch: 14, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.566 Vali Acc: 0.800 Test Loss: 0.566 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.3298101425170898
Epoch: 15, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.546 Vali Acc: 0.775 Test Loss: 0.546 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1964616775512695
Epoch: 16, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1855175495147705
Epoch: 17, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 18 cost time: 1.1662678718566895
Epoch: 18, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.485 Vali Acc: 0.825 Test Loss: 0.485 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 19 cost time: 1.2965259552001953
Epoch: 19, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.3591575622558594
Epoch: 20, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.259786605834961
Epoch: 21, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 22 cost time: 1.2935326099395752
Epoch: 22, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.426 Vali Acc: 0.875 Test Loss: 0.426 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 23 cost time: 1.1777162551879883
Epoch: 23, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2234032154083252
Epoch: 24, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2944557666778564
Epoch: 25, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2003045082092285
Epoch: 26, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2052533626556396
Epoch: 27, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1606554985046387
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1927402019500732
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.243591070175171
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3048677444458008
Epoch: 31, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.147869348526001
Epoch: 32, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.647347927093506
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.1890792846679688
Epoch: 2, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 1.2483282089233398
Epoch: 3, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.283 Vali Acc: 0.425 Test Loss: 1.283 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.1833505630493164
Epoch: 4, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.299682855606079
Epoch: 5, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.150 Vali Acc: 0.550 Test Loss: 1.150 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.3245902061462402
Epoch: 6, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.081 Vali Acc: 0.625 Test Loss: 1.081 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.3515751361846924
Epoch: 7, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.006 Vali Acc: 0.675 Test Loss: 1.006 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 1.2619121074676514
Epoch: 8, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.934 Vali Acc: 0.675 Test Loss: 0.934 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 9 cost time: 1.2174882888793945
Epoch: 9, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.863 Vali Acc: 0.750 Test Loss: 0.863 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.1663482189178467
Epoch: 10, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 1.1444895267486572
Epoch: 11, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 1.19465970993042
Epoch: 12, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 1.336843490600586
Epoch: 13, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 1.2050409317016602
Epoch: 14, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.652 Vali Acc: 0.750 Test Loss: 0.652 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.2419800758361816
Epoch: 15, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774994).  Saving model ...
Epoch: 16 cost time: 1.2867364883422852
Epoch: 16, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 1.1880486011505127
Epoch: 17, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.600 Vali Acc: 0.800 Test Loss: 0.600 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 1.2035987377166748
Epoch: 18, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.581 Vali Acc: 0.800 Test Loss: 0.581 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 1.2300257682800293
Epoch: 19, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 1.28902268409729
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.550 Vali Acc: 0.800 Test Loss: 0.550 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 21 cost time: 1.323829174041748
Epoch: 21, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 22 cost time: 1.4059422016143799
Epoch: 22, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.537 Vali Acc: 0.800 Test Loss: 0.537 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 23 cost time: 1.433821439743042
Epoch: 23, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.536 Vali Acc: 0.800 Test Loss: 0.536 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 24 cost time: 1.354187250137329
Epoch: 24, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 25 cost time: 1.2574777603149414
Epoch: 25, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 26 cost time: 1.236748456954956
Epoch: 26, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.520 Vali Acc: 0.800 Test Loss: 0.520 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 27 cost time: 1.318526029586792
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 28 cost time: 1.2245984077453613
Epoch: 28, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 29 cost time: 1.3534409999847412
Epoch: 29, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 30 cost time: 1.3027539253234863
Epoch: 30, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2968616485595703
Epoch: 31, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.517 Vali Acc: 0.800 Test Loss: 0.517 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4088466167449951
Epoch: 32, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.524 Vali Acc: 0.800 Test Loss: 0.524 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3556852340698242
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.528 Vali Acc: 0.800 Test Loss: 0.528 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2453505992889404
Epoch: 34, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.531 Vali Acc: 0.800 Test Loss: 0.531 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3452017307281494
Epoch: 35, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.59999418258667
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.534 Vali Acc: 0.800 Test Loss: 0.534 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.467339038848877
Epoch: 37, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4703354835510254
Epoch: 38, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.533 Vali Acc: 0.800 Test Loss: 0.533 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3512611389160156
Epoch: 39, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.81318736076355
Epoch: 1, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.485 Vali Acc: 0.275 Test Loss: 1.485 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.2659199237823486
Epoch: 2, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.472 Vali Acc: 0.300 Test Loss: 1.472 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.2596585750579834
Epoch: 3, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.455 Vali Acc: 0.275 Test Loss: 1.455 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2348344326019287
Epoch: 4, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.434 Vali Acc: 0.325 Test Loss: 1.434 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.2147564888000488
Epoch: 5, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.407 Vali Acc: 0.375 Test Loss: 1.407 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 1.2471389770507812
Epoch: 6, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.379 Vali Acc: 0.425 Test Loss: 1.379 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 7 cost time: 1.1975455284118652
Epoch: 7, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.348 Vali Acc: 0.425 Test Loss: 1.348 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 1.1837987899780273
Epoch: 8, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.316 Vali Acc: 0.450 Test Loss: 1.316 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 1.106020450592041
Epoch: 9, Steps: 3 | Train Loss: 1.008 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.122206687927246
Epoch: 10, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.253 Vali Acc: 0.550 Test Loss: 1.253 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 11 cost time: 1.1261494159698486
Epoch: 11, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.226 Vali Acc: 0.550 Test Loss: 1.226 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 1.1970672607421875
Epoch: 12, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.198 Vali Acc: 0.525 Test Loss: 1.198 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1825547218322754
Epoch: 13, Steps: 3 | Train Loss: 0.694 Vali Loss: 1.176 Vali Acc: 0.525 Test Loss: 1.176 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.142073631286621
Epoch: 14, Steps: 3 | Train Loss: 0.634 Vali Loss: 1.154 Vali Acc: 0.525 Test Loss: 1.154 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.208836555480957
Epoch: 15, Steps: 3 | Train Loss: 0.563 Vali Loss: 1.139 Vali Acc: 0.525 Test Loss: 1.139 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1361515522003174
Epoch: 16, Steps: 3 | Train Loss: 0.506 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 17 cost time: 1.1089577674865723
Epoch: 17, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 1.2226014137268066
Epoch: 18, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 1.1230473518371582
Epoch: 19, Steps: 3 | Train Loss: 0.362 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1143300533294678
Epoch: 20, Steps: 3 | Train Loss: 0.314 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1587257385253906
Epoch: 21, Steps: 3 | Train Loss: 0.209 Vali Loss: 1.002 Vali Acc: 0.625 Test Loss: 1.002 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 1.1912684440612793
Epoch: 22, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.976 Vali Acc: 0.625 Test Loss: 0.976 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 23 cost time: 1.093132734298706
Epoch: 23, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.961 Vali Acc: 0.625 Test Loss: 0.961 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 1.1199231147766113
Epoch: 24, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.947 Vali Acc: 0.650 Test Loss: 0.947 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 25 cost time: 1.1354193687438965
Epoch: 25, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.944 Vali Acc: 0.650 Test Loss: 0.944 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 26 cost time: 1.1652860641479492
Epoch: 26, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.931 Vali Acc: 0.650 Test Loss: 0.931 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 27 cost time: 1.2745864391326904
Epoch: 27, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.919 Vali Acc: 0.650 Test Loss: 0.919 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 28 cost time: 1.2127203941345215
Epoch: 28, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.911 Vali Acc: 0.650 Test Loss: 0.911 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 29 cost time: 1.1692962646484375
Epoch: 29, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.915 Vali Acc: 0.650 Test Loss: 0.915 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2699201107025146
Epoch: 30, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.904 Vali Acc: 0.650 Test Loss: 0.904 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 31 cost time: 1.2549312114715576
Epoch: 31, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.889 Vali Acc: 0.675 Test Loss: 0.889 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 32 cost time: 1.263669490814209
Epoch: 32, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.879 Vali Acc: 0.675 Test Loss: 0.879 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 33 cost time: 1.2556912899017334
Epoch: 33, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.871 Vali Acc: 0.675 Test Loss: 0.871 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 34 cost time: 1.3654379844665527
Epoch: 34, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.864 Vali Acc: 0.700 Test Loss: 0.864 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 35 cost time: 1.353280782699585
Epoch: 35, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.855 Vali Acc: 0.725 Test Loss: 0.855 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 36 cost time: 1.2666983604431152
Epoch: 36, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.847 Vali Acc: 0.725 Test Loss: 0.847 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 37 cost time: 1.4166808128356934
Epoch: 37, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.838 Vali Acc: 0.725 Test Loss: 0.838 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 38 cost time: 1.411102056503296
Epoch: 38, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.829 Vali Acc: 0.725 Test Loss: 0.829 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 39 cost time: 1.303015947341919
Epoch: 39, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.821 Vali Acc: 0.725 Test Loss: 0.821 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 40 cost time: 1.3629372119903564
Epoch: 40, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.814 Vali Acc: 0.725 Test Loss: 0.814 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 41 cost time: 1.3938407897949219
Epoch: 41, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 42 cost time: 1.2668874263763428
Epoch: 42, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.805 Vali Acc: 0.725 Test Loss: 0.805 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 43 cost time: 1.3070826530456543
Epoch: 43, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 44 cost time: 1.3131449222564697
Epoch: 44, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.798 Vali Acc: 0.725 Test Loss: 0.798 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 45 cost time: 1.2383110523223877
Epoch: 45, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.794 Vali Acc: 0.750 Test Loss: 0.794 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 46 cost time: 1.3239498138427734
Epoch: 46, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 47 cost time: 1.2964892387390137
Epoch: 47, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 48 cost time: 1.2691528797149658
Epoch: 48, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1923024654388428
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3144352436065674
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2426509857177734
Epoch: 51, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.505359172821045
Epoch: 52, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.3168904781341553
Epoch: 53, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 1.4544196128845215
Epoch: 54, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 55 cost time: 1.2167513370513916
Epoch: 55, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 56 cost time: 1.2361500263214111
Epoch: 56, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 1.147620677947998
Epoch: 57, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 58 cost time: 1.2145535945892334
Epoch: 58, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.765 Vali Acc: 0.800 Test Loss: 0.765 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 59 cost time: 1.41923189163208
Epoch: 59, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 60 cost time: 1.3371315002441406
Epoch: 60, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 61 cost time: 1.2328722476959229
Epoch: 61, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1745672225952148
Epoch: 62, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 63 cost time: 1.154423713684082
Epoch: 63, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 64 cost time: 1.1995723247528076
Epoch: 64, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 65 cost time: 1.371833324432373
Epoch: 65, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 66 cost time: 1.352675199508667
Epoch: 66, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 67 cost time: 1.3327569961547852
Epoch: 67, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 68 cost time: 1.2977328300476074
Epoch: 68, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.3046956062316895
Epoch: 69, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.278641700744629
Epoch: 70, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.2855560779571533
Epoch: 71, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.3595225811004639
Epoch: 72, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.2733650207519531
Epoch: 73, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.759 Vali Acc: 0.800 Test Loss: 0.759 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.2239243984222412
Epoch: 74, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.758 Vali Acc: 0.800 Test Loss: 0.758 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.204596757888794
Epoch: 75, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.1146702766418457
Epoch: 76, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.2178144454956055
Epoch: 77, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3791494369506836
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.548 Vali Acc: 0.250 Test Loss: 1.548 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.1902563571929932
Epoch: 2, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.534 Vali Acc: 0.275 Test Loss: 1.534 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 1.1540579795837402
Epoch: 3, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.519 Vali Acc: 0.275 Test Loss: 1.519 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 1.1662774085998535
Epoch: 4, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.502 Vali Acc: 0.300 Test Loss: 1.502 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.1989705562591553
Epoch: 5, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.481 Vali Acc: 0.250 Test Loss: 1.481 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.172797441482544
Epoch: 6, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.463 Vali Acc: 0.225 Test Loss: 1.463 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1300690174102783
Epoch: 7, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.445 Vali Acc: 0.250 Test Loss: 1.445 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1216259002685547
Epoch: 8, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.431 Vali Acc: 0.250 Test Loss: 1.431 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.125680923461914
Epoch: 9, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.418 Vali Acc: 0.275 Test Loss: 1.418 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1606647968292236
Epoch: 10, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1705496311187744
Epoch: 11, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.400 Vali Acc: 0.250 Test Loss: 1.400 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1562888622283936
Epoch: 12, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.392 Vali Acc: 0.250 Test Loss: 1.392 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1326661109924316
Epoch: 13, Steps: 3 | Train Loss: 0.836 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2426748275756836
Epoch: 14, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.379 Vali Acc: 0.250 Test Loss: 1.379 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.3
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.579245090484619
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.531 Vali Acc: 0.250 Test Loss: 1.531 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.289412498474121
Epoch: 2, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.517 Vali Acc: 0.250 Test Loss: 1.517 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.3196663856506348
Epoch: 3, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.500 Vali Acc: 0.300 Test Loss: 1.500 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.2713079452514648
Epoch: 4, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.481 Vali Acc: 0.350 Test Loss: 1.481 Test Acc: 0.350
Validation loss decreased (-0.299985 --> -0.349985).  Saving model ...
Epoch: 5 cost time: 1.3013653755187988
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.457 Vali Acc: 0.350 Test Loss: 1.457 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 6 cost time: 1.3288640975952148
Epoch: 6, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.435 Vali Acc: 0.350 Test Loss: 1.435 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 1.3520808219909668
Epoch: 7, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.410 Vali Acc: 0.325 Test Loss: 1.410 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.315039873123169
Epoch: 8, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.389 Vali Acc: 0.350 Test Loss: 1.389 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 1.2614994049072266
Epoch: 9, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.366 Vali Acc: 0.325 Test Loss: 1.366 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3903656005859375
Epoch: 10, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.347 Vali Acc: 0.325 Test Loss: 1.347 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3413567543029785
Epoch: 11, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.333 Vali Acc: 0.375 Test Loss: 1.333 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 12 cost time: 1.3361358642578125
Epoch: 12, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.318 Vali Acc: 0.375 Test Loss: 1.318 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 13 cost time: 1.3761858940124512
Epoch: 13, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 1.28440260887146
Epoch: 14, Steps: 3 | Train Loss: 0.776 Vali Loss: 1.294 Vali Acc: 0.450 Test Loss: 1.294 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 1.3831701278686523
Epoch: 15, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.285 Vali Acc: 0.450 Test Loss: 1.285 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 16 cost time: 1.2362940311431885
Epoch: 16, Steps: 3 | Train Loss: 0.621 Vali Loss: 1.274 Vali Acc: 0.450 Test Loss: 1.274 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 17 cost time: 1.2963438034057617
Epoch: 17, Steps: 3 | Train Loss: 0.667 Vali Loss: 1.263 Vali Acc: 0.450 Test Loss: 1.263 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 18 cost time: 1.2818660736083984
Epoch: 18, Steps: 3 | Train Loss: 0.535 Vali Loss: 1.246 Vali Acc: 0.450 Test Loss: 1.246 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 19 cost time: 1.2934608459472656
Epoch: 19, Steps: 3 | Train Loss: 0.518 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 20 cost time: 1.161452054977417
Epoch: 20, Steps: 3 | Train Loss: 0.430 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 21 cost time: 1.2641172409057617
Epoch: 21, Steps: 3 | Train Loss: 0.383 Vali Loss: 1.205 Vali Acc: 0.525 Test Loss: 1.205 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 22 cost time: 1.193279504776001
Epoch: 22, Steps: 3 | Train Loss: 0.380 Vali Loss: 1.184 Vali Acc: 0.450 Test Loss: 1.184 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.141392707824707
Epoch: 23, Steps: 3 | Train Loss: 0.330 Vali Loss: 1.168 Vali Acc: 0.425 Test Loss: 1.168 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1774063110351562
Epoch: 24, Steps: 3 | Train Loss: 0.294 Vali Loss: 1.147 Vali Acc: 0.450 Test Loss: 1.147 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2874135971069336
Epoch: 25, Steps: 3 | Train Loss: 0.260 Vali Loss: 1.149 Vali Acc: 0.425 Test Loss: 1.149 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2122399806976318
Epoch: 26, Steps: 3 | Train Loss: 0.246 Vali Loss: 1.148 Vali Acc: 0.425 Test Loss: 1.148 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.258497714996338
Epoch: 27, Steps: 3 | Train Loss: 0.204 Vali Loss: 1.146 Vali Acc: 0.450 Test Loss: 1.146 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.25596022605896
Epoch: 28, Steps: 3 | Train Loss: 0.162 Vali Loss: 1.144 Vali Acc: 0.475 Test Loss: 1.144 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1632628440856934
Epoch: 29, Steps: 3 | Train Loss: 0.143 Vali Loss: 1.155 Vali Acc: 0.475 Test Loss: 1.155 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1507983207702637
Epoch: 30, Steps: 3 | Train Loss: 0.155 Vali Loss: 1.153 Vali Acc: 0.475 Test Loss: 1.153 Test Acc: 0.475
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1253809928894043
Epoch: 31, Steps: 3 | Train Loss: 0.119 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.525
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4514174461364746
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.187865972518921
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.1481709480285645
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1679644584655762
Epoch: 4, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.216498851776123
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2975780963897705
Epoch: 6, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2254467010498047
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2239785194396973
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.2777292728424072
Epoch: 9, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.4153897762298584
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 1.1499054431915283
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.3670780658721924
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.266117811203003
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.2721474170684814
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.1828255653381348
Epoch: 15, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2554092407226562
Epoch: 16, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.153686285018921
Epoch: 17, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1443750858306885
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 19 cost time: 1.1678128242492676
Epoch: 19, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 20 cost time: 1.2763285636901855
Epoch: 20, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2136197090148926
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 22 cost time: 1.1766901016235352
Epoch: 22, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 23 cost time: 1.1966917514801025
Epoch: 23, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.1584372520446777
Epoch: 24, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 25 cost time: 1.212547779083252
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 26 cost time: 1.207810878753662
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 27 cost time: 1.1364257335662842
Epoch: 27, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 28 cost time: 1.2139482498168945
Epoch: 28, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 29 cost time: 1.1366865634918213
Epoch: 29, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 30 cost time: 1.2044909000396729
Epoch: 30, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.12662935256958
Epoch: 31, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 32 cost time: 1.3444862365722656
Epoch: 32, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 33 cost time: 1.225611925125122
Epoch: 33, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 34 cost time: 1.3067002296447754
Epoch: 34, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 35 cost time: 1.2586650848388672
Epoch: 35, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 36 cost time: 1.210221290588379
Epoch: 36, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 37 cost time: 1.2295842170715332
Epoch: 37, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 38 cost time: 1.2901854515075684
Epoch: 38, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 39 cost time: 1.174330711364746
Epoch: 39, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 40 cost time: 1.326749324798584
Epoch: 40, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 41 cost time: 1.3321471214294434
Epoch: 41, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 42 cost time: 1.2861573696136475
Epoch: 42, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 43 cost time: 1.2944600582122803
Epoch: 43, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3184735774993896
Epoch: 44, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.321110486984253
Epoch: 45, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 46 cost time: 1.2109613418579102
Epoch: 46, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 47 cost time: 1.3120090961456299
Epoch: 47, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 48 cost time: 1.2823820114135742
Epoch: 48, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 49 cost time: 1.2606174945831299
Epoch: 49, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 50 cost time: 1.276411771774292
Epoch: 50, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 51 cost time: 1.2364833354949951
Epoch: 51, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 52 cost time: 1.3850717544555664
Epoch: 52, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 53 cost time: 1.3556797504425049
Epoch: 53, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 54 cost time: 1.3502459526062012
Epoch: 54, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 55 cost time: 1.359314203262329
Epoch: 55, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 56 cost time: 1.3345947265625
Epoch: 56, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 57 cost time: 1.1645939350128174
Epoch: 57, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 58 cost time: 1.1746246814727783
Epoch: 58, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 59 cost time: 1.2660331726074219
Epoch: 59, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 60 cost time: 1.2768099308013916
Epoch: 60, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 61 cost time: 1.3076965808868408
Epoch: 61, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 62 cost time: 1.2431740760803223
Epoch: 62, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 63 cost time: 1.2828314304351807
Epoch: 63, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 64 cost time: 1.243696928024292
Epoch: 64, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 65 cost time: 1.1866638660430908
Epoch: 65, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 66 cost time: 1.1989881992340088
Epoch: 66, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 67 cost time: 1.2520356178283691
Epoch: 67, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 68 cost time: 1.2166731357574463
Epoch: 68, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1480658054351807
Epoch: 69, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 70 cost time: 1.2022271156311035
Epoch: 70, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 71 cost time: 1.1404340267181396
Epoch: 71, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.171325445175171
Epoch: 72, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.233095407485962
Epoch: 73, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 74 cost time: 1.2940499782562256
Epoch: 74, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 75 cost time: 1.1768264770507812
Epoch: 75, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 76 cost time: 1.1527767181396484
Epoch: 76, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 77 cost time: 1.2502593994140625
Epoch: 77, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 78 cost time: 1.2104027271270752
Epoch: 78, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 79 cost time: 1.2386739253997803
Epoch: 79, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.2092833518981934
Epoch: 80, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.3085911273956299
Epoch: 81, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.2169981002807617
Epoch: 82, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 83 cost time: 1.229381799697876
Epoch: 83, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.1883838176727295
Epoch: 84, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 85 cost time: 1.2045366764068604
Epoch: 85, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 86 cost time: 1.245398998260498
Epoch: 86, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 87 cost time: 1.2442493438720703
Epoch: 87, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 88 cost time: 1.3984289169311523
Epoch: 88, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.280346155166626
Epoch: 89, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.2106959819793701
Epoch: 90, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.1907384395599365
Epoch: 91, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.221498727798462
Epoch: 92, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.145627737045288
Epoch: 93, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.248434066772461
Epoch: 94, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 1.1993763446807861
Epoch: 95, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 1.1081290245056152
Epoch: 96, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 1.254673957824707
Epoch: 97, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 572612
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.477144479751587
Epoch: 1, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.582 Vali Acc: 0.100 Test Loss: 1.582 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 1.2842669486999512
Epoch: 2, Steps: 3 | Train Loss: 1.514 Vali Loss: 1.521 Vali Acc: 0.125 Test Loss: 1.521 Test Acc: 0.125
Validation loss decreased (-0.099984 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 1.1846542358398438
Epoch: 3, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.455 Vali Acc: 0.175 Test Loss: 1.455 Test Acc: 0.175
Validation loss decreased (-0.124985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 1.2242112159729004
Epoch: 4, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
Validation loss decreased (-0.174985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 1.146669626235962
Epoch: 5, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.278 Vali Acc: 0.425 Test Loss: 1.278 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 1.1961898803710938
Epoch: 6, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.180 Vali Acc: 0.450 Test Loss: 1.180 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 1.3523128032684326
Epoch: 7, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.083 Vali Acc: 0.625 Test Loss: 1.083 Test Acc: 0.625
Validation loss decreased (-0.449988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.3286139965057373
Epoch: 8, Steps: 3 | Train Loss: 0.862 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.252561330795288
Epoch: 9, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 1.4215378761291504
Epoch: 10, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.827 Vali Acc: 0.750 Test Loss: 0.827 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 1.259213924407959
Epoch: 11, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 1.447265863418579
Epoch: 12, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.702 Vali Acc: 0.800 Test Loss: 0.702 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.4285557270050049
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.644 Vali Acc: 0.800 Test Loss: 0.644 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 14 cost time: 1.2482924461364746
Epoch: 14, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.253101110458374
Epoch: 15, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 1.2244336605072021
Epoch: 16, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 1.4266893863677979
Epoch: 17, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 1.351034164428711
Epoch: 18, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 1.3861331939697266
Epoch: 19, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6423799991607666
Epoch: 20, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2835497856140137
Epoch: 21, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.281520128250122
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.392 Vali Acc: 0.875 Test Loss: 0.392 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.234450101852417
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2689545154571533
Epoch: 24, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.375385046005249
Epoch: 25, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.371 Vali Acc: 0.875 Test Loss: 0.371 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2485687732696533
Epoch: 26, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.369 Vali Acc: 0.875 Test Loss: 0.369 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2315831184387207
Epoch: 27, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.366 Vali Acc: 0.875 Test Loss: 0.366 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1208882331848145
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.363 Vali Acc: 0.875 Test Loss: 0.363 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.413774013519287
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.508 Vali Acc: 0.075 Test Loss: 1.508 Test Acc: 0.075
Validation loss decreased (inf --> -0.074985).  Saving model ...
Epoch: 2 cost time: 1.229933261871338
Epoch: 2, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.454 Vali Acc: 0.125 Test Loss: 1.454 Test Acc: 0.125
Validation loss decreased (-0.074985 --> -0.124985).  Saving model ...
Epoch: 3 cost time: 1.292546272277832
Epoch: 3, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.392 Vali Acc: 0.250 Test Loss: 1.392 Test Acc: 0.250
Validation loss decreased (-0.124985 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.1568336486816406
Epoch: 4, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.314 Vali Acc: 0.350 Test Loss: 1.314 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.3926846981048584
Epoch: 5, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.223 Vali Acc: 0.450 Test Loss: 1.223 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.3766908645629883
Epoch: 6, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.131 Vali Acc: 0.550 Test Loss: 1.131 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 1.3200099468231201
Epoch: 7, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.040 Vali Acc: 0.625 Test Loss: 1.040 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 1.1733119487762451
Epoch: 8, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.134023904800415
Epoch: 9, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 1.151247501373291
Epoch: 10, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.1634490489959717
Epoch: 11, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.736 Vali Acc: 0.800 Test Loss: 0.736 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 12 cost time: 1.2924573421478271
Epoch: 12, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 13 cost time: 1.2272696495056152
Epoch: 13, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 14 cost time: 1.195695161819458
Epoch: 14, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 1.2728891372680664
Epoch: 15, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 16 cost time: 1.0394036769866943
Epoch: 16, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.515 Vali Acc: 0.875 Test Loss: 0.515 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 1.2693579196929932
Epoch: 17, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 1.1671688556671143
Epoch: 18, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 1.3512659072875977
Epoch: 19, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 1.5403790473937988
Epoch: 20, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.2748186588287354
Epoch: 21, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.2469468116760254
Epoch: 22, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.407 Vali Acc: 0.900 Test Loss: 0.407 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.278515338897705
Epoch: 23, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 1.356231927871704
Epoch: 24, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 1.2681012153625488
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 1.221398115158081
Epoch: 26, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 1.3172013759613037
Epoch: 27, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 1.4610474109649658
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 1.2154333591461182
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.2205719947814941
Epoch: 30, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 1.198291540145874
Epoch: 31, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 1.289804458618164
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 1.2259838581085205
Epoch: 33, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 1.2702577114105225
Epoch: 34, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 1.3449678421020508
Epoch: 35, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 1.2182178497314453
Epoch: 36, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 1.2276856899261475
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 1.2440392971038818
Epoch: 38, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 1.1927006244659424
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 1.2954204082489014
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 41 cost time: 1.260011911392212
Epoch: 41, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 1.1601638793945312
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 1.2072994709014893
Epoch: 43, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 1.2943551540374756
Epoch: 44, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 1.335477352142334
Epoch: 45, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 1.40065336227417
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 1.1887426376342773
Epoch: 47, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 1.2334489822387695
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1792545318603516
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2973463535308838
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1958682537078857
Epoch: 51, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2823879718780518
Epoch: 52, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2933645248413086
Epoch: 53, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.261751651763916
Epoch: 54, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.292679786682129
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.2855231761932373
Epoch: 56, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.2959632873535156
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5430808067321777
Epoch: 1, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.466 Vali Acc: 0.125 Test Loss: 1.466 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.2821898460388184
Epoch: 2, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.413 Vali Acc: 0.250 Test Loss: 1.413 Test Acc: 0.250
Validation loss decreased (-0.124985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2534430027008057
Epoch: 3, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.357 Vali Acc: 0.300 Test Loss: 1.357 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.3199613094329834
Epoch: 4, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.286 Vali Acc: 0.350 Test Loss: 1.286 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.3178644180297852
Epoch: 5, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1940860748291016
Epoch: 6, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.119 Vali Acc: 0.675 Test Loss: 1.119 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.1306712627410889
Epoch: 7, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.034 Vali Acc: 0.725 Test Loss: 1.034 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 1.2266976833343506
Epoch: 8, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.954 Vali Acc: 0.775 Test Loss: 0.954 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.0983223915100098
Epoch: 9, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 1.123220443725586
Epoch: 10, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.805 Vali Acc: 0.825 Test Loss: 0.805 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 1.3198745250701904
Epoch: 11, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.745 Vali Acc: 0.825 Test Loss: 0.745 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 12 cost time: 1.1808264255523682
Epoch: 12, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.697 Vali Acc: 0.825 Test Loss: 0.697 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 13 cost time: 1.0706660747528076
Epoch: 13, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.0898878574371338
Epoch: 14, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 1.2536828517913818
Epoch: 15, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 1.2034265995025635
Epoch: 16, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.160660982131958
Epoch: 17, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 1.263096570968628
Epoch: 18, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 1.1391241550445557
Epoch: 19, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 1.13039231300354
Epoch: 20, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 0.9858345985412598
Epoch: 21, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.449 Vali Acc: 0.925 Test Loss: 0.449 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 1.1183855533599854
Epoch: 22, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.1231048107147217
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 1.0297818183898926
Epoch: 24, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.1617724895477295
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.203644037246704
Epoch: 26, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.1657373905181885
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.265146255493164
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1917388439178467
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.188148021697998
Epoch: 30, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 1.1856751441955566
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.1763255596160889
Epoch: 32, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.3281710147857666
Epoch: 33, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.2373595237731934
Epoch: 34, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 1.2085528373718262
Epoch: 35, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.2633767127990723
Epoch: 36, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.2245571613311768
Epoch: 37, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.2307467460632324
Epoch: 38, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.2432525157928467
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.2905128002166748
Epoch: 40, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.2565686702728271
Epoch: 41, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 1.2459633350372314
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 1.2973713874816895
Epoch: 43, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2545654773712158
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 1.2819902896881104
Epoch: 45, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3513867855072021
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3310585021972656
Epoch: 47, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1559474468231201
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1964988708496094
Epoch: 49, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.3188328742980957
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.195138692855835
Epoch: 51, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2185330390930176
Epoch: 52, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1307837963104248
Epoch: 53, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.240792989730835
Epoch: 54, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.694136619567871
Epoch: 1, Steps: 3 | Train Loss: 1.529 Vali Loss: 1.507 Vali Acc: 0.050 Test Loss: 1.507 Test Acc: 0.050
Validation loss decreased (inf --> -0.049985).  Saving model ...
Epoch: 2 cost time: 1.2129359245300293
Epoch: 2, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.455 Vali Acc: 0.175 Test Loss: 1.455 Test Acc: 0.175
Validation loss decreased (-0.049985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 1.217346429824829
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.397 Vali Acc: 0.325 Test Loss: 1.397 Test Acc: 0.325
Validation loss decreased (-0.174985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.08774995803833
Epoch: 4, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.325 Vali Acc: 0.450 Test Loss: 1.325 Test Acc: 0.450
Validation loss decreased (-0.324986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 1.1657490730285645
Epoch: 5, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1957042217254639
Epoch: 6, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.156 Vali Acc: 0.525 Test Loss: 1.156 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.2938954830169678
Epoch: 7, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.072 Vali Acc: 0.575 Test Loss: 1.072 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 1.1494531631469727
Epoch: 8, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 1.2089364528656006
Epoch: 9, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.916 Vali Acc: 0.750 Test Loss: 0.916 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.1406211853027344
Epoch: 10, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 1.1259069442749023
Epoch: 11, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 1.2081356048583984
Epoch: 12, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 13 cost time: 1.170985221862793
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 14 cost time: 1.2644758224487305
Epoch: 14, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.668 Vali Acc: 0.775 Test Loss: 0.668 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 15 cost time: 1.2068307399749756
Epoch: 15, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2093722820281982
Epoch: 16, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1985526084899902
Epoch: 17, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.592 Vali Acc: 0.775 Test Loss: 0.592 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 18 cost time: 1.198258638381958
Epoch: 18, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.572 Vali Acc: 0.800 Test Loss: 0.572 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 1.1838688850402832
Epoch: 19, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 1.1489713191986084
Epoch: 20, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.536 Vali Acc: 0.800 Test Loss: 0.536 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 21 cost time: 1.2431821823120117
Epoch: 21, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 22 cost time: 1.2572541236877441
Epoch: 22, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.510 Vali Acc: 0.800 Test Loss: 0.510 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 23 cost time: 1.2547721862792969
Epoch: 23, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.501 Vali Acc: 0.800 Test Loss: 0.501 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 24 cost time: 1.1607959270477295
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.492 Vali Acc: 0.800 Test Loss: 0.492 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 25 cost time: 1.2667205333709717
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.800 Test Loss: 0.490 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 26 cost time: 1.2923152446746826
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.487 Vali Acc: 0.800 Test Loss: 0.487 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 27 cost time: 1.2345020771026611
Epoch: 27, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.483 Vali Acc: 0.800 Test Loss: 0.483 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 28 cost time: 1.361201286315918
Epoch: 28, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.479 Vali Acc: 0.800 Test Loss: 0.479 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 29 cost time: 1.2441580295562744
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.473 Vali Acc: 0.800 Test Loss: 0.473 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 30 cost time: 1.1266968250274658
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.463 Vali Acc: 0.800 Test Loss: 0.463 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 31 cost time: 1.2169358730316162
Epoch: 31, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.454 Vali Acc: 0.800 Test Loss: 0.454 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 32 cost time: 1.2269206047058105
Epoch: 32, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.447 Vali Acc: 0.800 Test Loss: 0.447 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 33 cost time: 1.268219232559204
Epoch: 33, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.441 Vali Acc: 0.825 Test Loss: 0.441 Test Acc: 0.825
Validation loss decreased (-0.799996 --> -0.824996).  Saving model ...
Epoch: 34 cost time: 1.1211974620819092
Epoch: 34, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.437 Vali Acc: 0.825 Test Loss: 0.437 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 35 cost time: 1.234618902206421
Epoch: 35, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.433 Vali Acc: 0.825 Test Loss: 0.433 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 36 cost time: 1.2119355201721191
Epoch: 36, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.427 Vali Acc: 0.825 Test Loss: 0.427 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 37 cost time: 1.099057674407959
Epoch: 37, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.422 Vali Acc: 0.825 Test Loss: 0.422 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 38 cost time: 1.1549067497253418
Epoch: 38, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.419 Vali Acc: 0.825 Test Loss: 0.419 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 39 cost time: 1.0346932411193848
Epoch: 39, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.416 Vali Acc: 0.825 Test Loss: 0.416 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 40 cost time: 1.1812560558319092
Epoch: 40, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.824996 --> -0.849996).  Saving model ...
Epoch: 41 cost time: 1.1783466339111328
Epoch: 41, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 42 cost time: 1.248199701309204
Epoch: 42, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 43 cost time: 1.3101680278778076
Epoch: 43, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 44 cost time: 1.327989101409912
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 45 cost time: 1.196906566619873
Epoch: 45, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 46 cost time: 1.2711007595062256
Epoch: 46, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 47 cost time: 1.2627553939819336
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 48 cost time: 1.2157974243164062
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.271740198135376
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3796334266662598
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.256119966506958
Epoch: 51, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.321385145187378
Epoch: 52, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.4327950477600098
Epoch: 53, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 54 cost time: 1.2519001960754395
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 55 cost time: 1.1782336235046387
Epoch: 55, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 56 cost time: 1.2803068161010742
Epoch: 56, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 57 cost time: 1.2966890335083008
Epoch: 57, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 58 cost time: 1.3787062168121338
Epoch: 58, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.393 Vali Acc: 0.850 Test Loss: 0.393 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 59 cost time: 1.3661396503448486
Epoch: 59, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 60 cost time: 1.3046367168426514
Epoch: 60, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 61 cost time: 1.1898369789123535
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 62 cost time: 1.3508074283599854
Epoch: 62, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.382 Vali Acc: 0.850 Test Loss: 0.382 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 63 cost time: 1.340200662612915
Epoch: 63, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 64 cost time: 1.3365304470062256
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 65 cost time: 1.3415448665618896
Epoch: 65, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 66 cost time: 1.396557092666626
Epoch: 66, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 67 cost time: 1.3677451610565186
Epoch: 67, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 68 cost time: 1.2063183784484863
Epoch: 68, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 69 cost time: 1.2566993236541748
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 70 cost time: 1.2789158821105957
Epoch: 70, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 71 cost time: 1.2665467262268066
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 72 cost time: 1.2985341548919678
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 73 cost time: 1.2163732051849365
Epoch: 73, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 74 cost time: 1.1952855587005615
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 75 cost time: 1.2111806869506836
Epoch: 75, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 76 cost time: 1.2404043674468994
Epoch: 76, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 77 cost time: 1.3083674907684326
Epoch: 77, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 78 cost time: 1.3638851642608643
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 79 cost time: 1.1792240142822266
Epoch: 79, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 80 cost time: 1.2863259315490723
Epoch: 80, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.850 Test Loss: 0.359 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 81 cost time: 1.2383100986480713
Epoch: 81, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 82 cost time: 1.2435266971588135
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 83 cost time: 1.4162604808807373
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 84 cost time: 1.3183467388153076
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 85 cost time: 1.2136521339416504
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 86 cost time: 1.3714325428009033
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.850 Test Loss: 0.351 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 87 cost time: 1.271134376525879
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 88 cost time: 1.1681032180786133
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.349 Vali Acc: 0.850 Test Loss: 0.349 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 89 cost time: 1.2964954376220703
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 90 cost time: 1.4142742156982422
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.850 Test Loss: 0.347 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 91 cost time: 1.300441026687622
Epoch: 91, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 92 cost time: 1.3448550701141357
Epoch: 92, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 93 cost time: 1.2418334484100342
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 94 cost time: 1.4216394424438477
Epoch: 94, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.875 Test Loss: 0.343 Test Acc: 0.875
Validation loss decreased (-0.849997 --> -0.874997).  Saving model ...
Epoch: 95 cost time: 1.4402477741241455
Epoch: 95, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.875 Test Loss: 0.342 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 96 cost time: 1.3500845432281494
Epoch: 96, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 97 cost time: 1.300583839416504
Epoch: 97, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.340 Vali Acc: 0.875 Test Loss: 0.340 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 98 cost time: 1.3570098876953125
Epoch: 98, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 99 cost time: 1.3196384906768799
Epoch: 99, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 100 cost time: 1.3236973285675049
Epoch: 100, Steps: 3 | Train Loss: 0.001 Vali Loss: 0.338 Vali Acc: 0.875 Test Loss: 0.338 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6560046672821045
Epoch: 1, Steps: 3 | Train Loss: 1.572 Vali Loss: 1.543 Vali Acc: 0.150 Test Loss: 1.543 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.2102489471435547
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.489 Vali Acc: 0.300 Test Loss: 1.489 Test Acc: 0.300
Validation loss decreased (-0.149985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.0850613117218018
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.438 Vali Acc: 0.400 Test Loss: 1.438 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.1116595268249512
Epoch: 4, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.373 Vali Acc: 0.425 Test Loss: 1.373 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 1.1002960205078125
Epoch: 5, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.298 Vali Acc: 0.450 Test Loss: 1.298 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.245115041732788
Epoch: 6, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.2393617630004883
Epoch: 7, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 1.2253642082214355
Epoch: 8, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.1661696434020996
Epoch: 9, Steps: 3 | Train Loss: 0.723 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 1.152446985244751
Epoch: 10, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.927 Vali Acc: 0.625 Test Loss: 0.927 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624991).  Saving model ...
Epoch: 11 cost time: 1.0880708694458008
Epoch: 11, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.863 Vali Acc: 0.725 Test Loss: 0.863 Test Acc: 0.725
Validation loss decreased (-0.624991 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 1.321812391281128
Epoch: 12, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 1.384871006011963
Epoch: 13, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 1.2197613716125488
Epoch: 14, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.717 Vali Acc: 0.825 Test Loss: 0.717 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 1.271824598312378
Epoch: 15, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 1.2385358810424805
Epoch: 16, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.654 Vali Acc: 0.825 Test Loss: 0.654 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 17 cost time: 1.1632678508758545
Epoch: 17, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.627 Vali Acc: 0.825 Test Loss: 0.627 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 18 cost time: 1.2526531219482422
Epoch: 18, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.1270151138305664
Epoch: 19, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.600 Vali Acc: 0.825 Test Loss: 0.600 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1483924388885498
Epoch: 20, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.2210752964019775
Epoch: 21, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.568 Vali Acc: 0.825 Test Loss: 0.568 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2102904319763184
Epoch: 22, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.548 Vali Acc: 0.825 Test Loss: 0.548 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1770057678222656
Epoch: 23, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 1.3575475215911865
Epoch: 24, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 1.4284477233886719
Epoch: 25, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 1.3729579448699951
Epoch: 26, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3322265148162842
Epoch: 27, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 1.3057444095611572
Epoch: 28, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.849995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 1.2288844585418701
Epoch: 29, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 1.2110142707824707
Epoch: 30, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2283556461334229
Epoch: 31, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2679953575134277
Epoch: 32, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.470895767211914
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.411569356918335
Epoch: 34, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3641111850738525
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.249647855758667
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.512 Vali Acc: 0.825 Test Loss: 0.512 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.273388147354126
Epoch: 37, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1900193691253662
Epoch: 38, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.512 Vali Acc: 0.825 Test Loss: 0.512 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2627155780792236
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.511 Vali Acc: 0.825 Test Loss: 0.511 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.43415904045105
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.489 Vali Acc: 0.200 Test Loss: 1.489 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.1644032001495361
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.478 Vali Acc: 0.200 Test Loss: 1.478 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 1.143552303314209
Epoch: 3, Steps: 3 | Train Loss: 1.417 Vali Loss: 1.461 Vali Acc: 0.200 Test Loss: 1.461 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 1.3816485404968262
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.440 Vali Acc: 0.225 Test Loss: 1.440 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 1.2967514991760254
Epoch: 5, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.413 Vali Acc: 0.225 Test Loss: 1.413 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 6 cost time: 1.2877657413482666
Epoch: 6, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.1409566402435303
Epoch: 7, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.360 Vali Acc: 0.300 Test Loss: 1.360 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 1.2972948551177979
Epoch: 8, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.334 Vali Acc: 0.325 Test Loss: 1.334 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 9 cost time: 1.1471338272094727
Epoch: 9, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.307 Vali Acc: 0.425 Test Loss: 1.307 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 1.1726043224334717
Epoch: 10, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.279 Vali Acc: 0.400 Test Loss: 1.279 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1794250011444092
Epoch: 11, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.254 Vali Acc: 0.475 Test Loss: 1.254 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 12 cost time: 1.1393914222717285
Epoch: 12, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.228 Vali Acc: 0.475 Test Loss: 1.228 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 13 cost time: 1.1456503868103027
Epoch: 13, Steps: 3 | Train Loss: 0.770 Vali Loss: 1.197 Vali Acc: 0.525 Test Loss: 1.197 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.183873176574707
Epoch: 14, Steps: 3 | Train Loss: 0.709 Vali Loss: 1.168 Vali Acc: 0.625 Test Loss: 1.168 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 1.1272778511047363
Epoch: 15, Steps: 3 | Train Loss: 0.623 Vali Loss: 1.144 Vali Acc: 0.650 Test Loss: 1.144 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 1.152724027633667
Epoch: 16, Steps: 3 | Train Loss: 0.545 Vali Loss: 1.123 Vali Acc: 0.625 Test Loss: 1.123 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1545965671539307
Epoch: 17, Steps: 3 | Train Loss: 0.530 Vali Loss: 1.090 Vali Acc: 0.625 Test Loss: 1.090 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.203995704650879
Epoch: 18, Steps: 3 | Train Loss: 0.456 Vali Loss: 1.065 Vali Acc: 0.650 Test Loss: 1.065 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 1.2222046852111816
Epoch: 19, Steps: 3 | Train Loss: 0.415 Vali Loss: 1.041 Vali Acc: 0.650 Test Loss: 1.041 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 20 cost time: 1.1566154956817627
Epoch: 20, Steps: 3 | Train Loss: 0.334 Vali Loss: 1.023 Vali Acc: 0.625 Test Loss: 1.023 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2011148929595947
Epoch: 21, Steps: 3 | Train Loss: 0.313 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2616498470306396
Epoch: 22, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.987 Vali Acc: 0.625 Test Loss: 0.987 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2457780838012695
Epoch: 23, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1755986213684082
Epoch: 24, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.943 Vali Acc: 0.600 Test Loss: 0.943 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1708662509918213
Epoch: 25, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 26 cost time: 1.2226204872131348
Epoch: 26, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.904 Vali Acc: 0.675 Test Loss: 0.904 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 27 cost time: 1.3632445335388184
Epoch: 27, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.896 Vali Acc: 0.675 Test Loss: 0.896 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 28 cost time: 1.2964489459991455
Epoch: 28, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.895 Vali Acc: 0.650 Test Loss: 0.895 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2497892379760742
Epoch: 29, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.892 Vali Acc: 0.650 Test Loss: 0.892 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2202894687652588
Epoch: 30, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.876 Vali Acc: 0.650 Test Loss: 0.876 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.289949655532837
Epoch: 31, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.863 Vali Acc: 0.650 Test Loss: 0.863 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1578412055969238
Epoch: 32, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.861 Vali Acc: 0.650 Test Loss: 0.861 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3558900356292725
Epoch: 33, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.857 Vali Acc: 0.650 Test Loss: 0.857 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2639412879943848
Epoch: 34, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.851 Vali Acc: 0.650 Test Loss: 0.851 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2333924770355225
Epoch: 35, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.845 Vali Acc: 0.650 Test Loss: 0.845 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2640836238861084
Epoch: 36, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.829 Vali Acc: 0.675 Test Loss: 0.829 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674992).  Saving model ...
Epoch: 37 cost time: 1.2858588695526123
Epoch: 37, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.815 Vali Acc: 0.675 Test Loss: 0.815 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 38 cost time: 1.247974157333374
Epoch: 38, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.807 Vali Acc: 0.675 Test Loss: 0.807 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 39 cost time: 1.185655117034912
Epoch: 39, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.801 Vali Acc: 0.675 Test Loss: 0.801 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 40 cost time: 1.2513353824615479
Epoch: 40, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.793 Vali Acc: 0.725 Test Loss: 0.793 Test Acc: 0.725
Validation loss decreased (-0.674992 --> -0.724992).  Saving model ...
Epoch: 41 cost time: 1.1792151927947998
Epoch: 41, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.786 Vali Acc: 0.725 Test Loss: 0.786 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 42 cost time: 1.2527351379394531
Epoch: 42, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.778 Vali Acc: 0.725 Test Loss: 0.778 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 43 cost time: 1.2675838470458984
Epoch: 43, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.774 Vali Acc: 0.725 Test Loss: 0.774 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 44 cost time: 1.3585922718048096
Epoch: 44, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.770 Vali Acc: 0.725 Test Loss: 0.770 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 45 cost time: 1.2790367603302002
Epoch: 45, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.765 Vali Acc: 0.725 Test Loss: 0.765 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 46 cost time: 1.196244239807129
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.762 Vali Acc: 0.725 Test Loss: 0.762 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 47 cost time: 1.350928544998169
Epoch: 47, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.762 Vali Acc: 0.725 Test Loss: 0.762 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 48 cost time: 1.2056794166564941
Epoch: 48, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.771 Vali Acc: 0.725 Test Loss: 0.771 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3051087856292725
Epoch: 49, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.779 Vali Acc: 0.700 Test Loss: 0.779 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2828137874603271
Epoch: 50, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.778 Vali Acc: 0.725 Test Loss: 0.778 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.3405745029449463
Epoch: 51, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 1.2614617347717285
Epoch: 52, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 53 cost time: 1.2459142208099365
Epoch: 53, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.745 Vali Acc: 0.775 Test Loss: 0.745 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 54 cost time: 1.2628326416015625
Epoch: 54, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1616108417510986
Epoch: 55, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 56 cost time: 1.3667728900909424
Epoch: 56, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.732 Vali Acc: 0.775 Test Loss: 0.732 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 57 cost time: 1.262453317642212
Epoch: 57, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 58 cost time: 1.2394471168518066
Epoch: 58, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.728 Vali Acc: 0.775 Test Loss: 0.728 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 59 cost time: 1.2454097270965576
Epoch: 59, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 60 cost time: 1.3045151233673096
Epoch: 60, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 61 cost time: 1.4379265308380127
Epoch: 61, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 62 cost time: 1.355452060699463
Epoch: 62, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.702 Vali Acc: 0.775 Test Loss: 0.702 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 63 cost time: 1.4173662662506104
Epoch: 63, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 64 cost time: 1.3350894451141357
Epoch: 64, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 65 cost time: 1.310922622680664
Epoch: 65, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.688 Vali Acc: 0.775 Test Loss: 0.688 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 66 cost time: 1.3506879806518555
Epoch: 66, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 67 cost time: 1.2997565269470215
Epoch: 67, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.688 Vali Acc: 0.775 Test Loss: 0.688 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.3339712619781494
Epoch: 68, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.3225386142730713
Epoch: 69, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.3192472457885742
Epoch: 70, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.2820615768432617
Epoch: 71, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.1895167827606201
Epoch: 72, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.3024799823760986
Epoch: 73, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.775 Test Loss: 0.701 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.4054384231567383
Epoch: 74, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.3969449996948242
Epoch: 75, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.3422105312347412
Epoch: 76, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.698 Vali Acc: 0.775 Test Loss: 0.698 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.436333179473877
Epoch: 1, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.549 Vali Acc: 0.150 Test Loss: 1.549 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.1758184432983398
Epoch: 2, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.545 Vali Acc: 0.175 Test Loss: 1.545 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 1.2801792621612549
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.539 Vali Acc: 0.175 Test Loss: 1.539 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 1.2458381652832031
Epoch: 4, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.530 Vali Acc: 0.175 Test Loss: 1.530 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 5 cost time: 1.1536469459533691
Epoch: 5, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.517 Vali Acc: 0.175 Test Loss: 1.517 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 6 cost time: 1.2863221168518066
Epoch: 6, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.507 Vali Acc: 0.175 Test Loss: 1.507 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 7 cost time: 1.2090985774993896
Epoch: 7, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.496 Vali Acc: 0.175 Test Loss: 1.496 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 8 cost time: 1.2524504661560059
Epoch: 8, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.487 Vali Acc: 0.175 Test Loss: 1.487 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 9 cost time: 1.1926801204681396
Epoch: 9, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.479 Vali Acc: 0.175 Test Loss: 1.479 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 10 cost time: 1.1681134700775146
Epoch: 10, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.472 Vali Acc: 0.200 Test Loss: 1.472 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 11 cost time: 1.2352416515350342
Epoch: 11, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.471 Vali Acc: 0.200 Test Loss: 1.471 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 12 cost time: 1.242206335067749
Epoch: 12, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.468 Vali Acc: 0.175 Test Loss: 1.468 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1150243282318115
Epoch: 13, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.460 Vali Acc: 0.175 Test Loss: 1.460 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1860504150390625
Epoch: 14, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.454 Vali Acc: 0.200 Test Loss: 1.454 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 15 cost time: 1.1824071407318115
Epoch: 15, Steps: 3 | Train Loss: 0.791 Vali Loss: 1.451 Vali Acc: 0.250 Test Loss: 1.451 Test Acc: 0.250
Validation loss decreased (-0.199985 --> -0.249985).  Saving model ...
Epoch: 16 cost time: 1.1939382553100586
Epoch: 16, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.451 Vali Acc: 0.275 Test Loss: 1.451 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 17 cost time: 1.1043901443481445
Epoch: 17, Steps: 3 | Train Loss: 0.662 Vali Loss: 1.445 Vali Acc: 0.275 Test Loss: 1.445 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 18 cost time: 1.0456998348236084
Epoch: 18, Steps: 3 | Train Loss: 0.612 Vali Loss: 1.437 Vali Acc: 0.300 Test Loss: 1.437 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 19 cost time: 1.1304025650024414
Epoch: 19, Steps: 3 | Train Loss: 0.607 Vali Loss: 1.434 Vali Acc: 0.300 Test Loss: 1.434 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 20 cost time: 1.160717487335205
Epoch: 20, Steps: 3 | Train Loss: 0.493 Vali Loss: 1.436 Vali Acc: 0.300 Test Loss: 1.436 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0313832759857178
Epoch: 21, Steps: 3 | Train Loss: 0.480 Vali Loss: 1.445 Vali Acc: 0.275 Test Loss: 1.445 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1135315895080566
Epoch: 22, Steps: 3 | Train Loss: 0.393 Vali Loss: 1.453 Vali Acc: 0.300 Test Loss: 1.453 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1224350929260254
Epoch: 23, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.460 Vali Acc: 0.300 Test Loss: 1.460 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.170839786529541
Epoch: 24, Steps: 3 | Train Loss: 0.374 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.117222547531128
Epoch: 25, Steps: 3 | Train Loss: 0.327 Vali Loss: 1.461 Vali Acc: 0.300 Test Loss: 1.461 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.100640058517456
Epoch: 26, Steps: 3 | Train Loss: 0.282 Vali Loss: 1.456 Vali Acc: 0.300 Test Loss: 1.456 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1963653564453125
Epoch: 27, Steps: 3 | Train Loss: 0.240 Vali Loss: 1.479 Vali Acc: 0.325 Test Loss: 1.479 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324985).  Saving model ...
Epoch: 28 cost time: 1.2402243614196777
Epoch: 28, Steps: 3 | Train Loss: 0.241 Vali Loss: 1.509 Vali Acc: 0.325 Test Loss: 1.509 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.164985179901123
Epoch: 29, Steps: 3 | Train Loss: 0.170 Vali Loss: 1.538 Vali Acc: 0.350 Test Loss: 1.538 Test Acc: 0.350
Validation loss decreased (-0.324985 --> -0.349985).  Saving model ...
Epoch: 30 cost time: 1.3403902053833008
Epoch: 30, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.534 Vali Acc: 0.325 Test Loss: 1.534 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2132508754730225
Epoch: 31, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.524 Vali Acc: 0.325 Test Loss: 1.524 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2079763412475586
Epoch: 32, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.535 Vali Acc: 0.325 Test Loss: 1.535 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1815063953399658
Epoch: 33, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.547 Vali Acc: 0.325 Test Loss: 1.547 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2890679836273193
Epoch: 34, Steps: 3 | Train Loss: 0.097 Vali Loss: 1.538 Vali Acc: 0.350 Test Loss: 1.538 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.261308193206787
Epoch: 35, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.527 Vali Acc: 0.350 Test Loss: 1.527 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 36 cost time: 1.4111518859863281
Epoch: 36, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.509 Vali Acc: 0.350 Test Loss: 1.509 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 37 cost time: 1.3573737144470215
Epoch: 37, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.502 Vali Acc: 0.350 Test Loss: 1.502 Test Acc: 0.350
Validation loss decreased (-0.349985 --> -0.349985).  Saving model ...
Epoch: 38 cost time: 1.334681749343872
Epoch: 38, Steps: 3 | Train Loss: 0.059 Vali Loss: 1.496 Vali Acc: 0.375 Test Loss: 1.496 Test Acc: 0.375
Validation loss decreased (-0.349985 --> -0.374985).  Saving model ...
Epoch: 39 cost time: 1.2018895149230957
Epoch: 39, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.496 Vali Acc: 0.375 Test Loss: 1.496 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.291881799697876
Epoch: 40, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.487 Vali Acc: 0.400 Test Loss: 1.487 Test Acc: 0.400
Validation loss decreased (-0.374985 --> -0.399985).  Saving model ...
Epoch: 41 cost time: 1.3668792247772217
Epoch: 41, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.501 Vali Acc: 0.400 Test Loss: 1.501 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2383863925933838
Epoch: 42, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.525 Vali Acc: 0.400 Test Loss: 1.525 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3808715343475342
Epoch: 43, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.562 Vali Acc: 0.375 Test Loss: 1.562 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3710613250732422
Epoch: 44, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.595 Vali Acc: 0.375 Test Loss: 1.595 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.377612590789795
Epoch: 45, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.601 Vali Acc: 0.375 Test Loss: 1.601 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2689523696899414
Epoch: 46, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.590 Vali Acc: 0.375 Test Loss: 1.590 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.227454423904419
Epoch: 47, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.562 Vali Acc: 0.400 Test Loss: 1.562 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.271651029586792
Epoch: 48, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.554 Vali Acc: 0.400 Test Loss: 1.554 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2624998092651367
Epoch: 49, Steps: 3 | Train Loss: 0.027 Vali Loss: 1.548 Vali Acc: 0.400 Test Loss: 1.548 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.3130404949188232
Epoch: 50, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.530 Vali Acc: 0.400 Test Loss: 1.530 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.4
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.417060375213623
Epoch: 1, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.470 Vali Acc: 0.275 Test Loss: 1.470 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 1.2373089790344238
Epoch: 2, Steps: 3 | Train Loss: 1.452 Vali Loss: 1.465 Vali Acc: 0.275 Test Loss: 1.465 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 3 cost time: 1.3162143230438232
Epoch: 3, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.455 Vali Acc: 0.300 Test Loss: 1.455 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.284041166305542
Epoch: 4, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 1.2041757106781006
Epoch: 5, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.427 Vali Acc: 0.300 Test Loss: 1.427 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 1.1977717876434326
Epoch: 6, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.413 Vali Acc: 0.275 Test Loss: 1.413 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.168180227279663
Epoch: 7, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.397 Vali Acc: 0.275 Test Loss: 1.397 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1250219345092773
Epoch: 8, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0501561164855957
Epoch: 9, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.369 Vali Acc: 0.250 Test Loss: 1.369 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1928606033325195
Epoch: 10, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.355 Vali Acc: 0.250 Test Loss: 1.355 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2226660251617432
Epoch: 11, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.345 Vali Acc: 0.275 Test Loss: 1.345 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3284802436828613
Epoch: 12, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.333 Vali Acc: 0.275 Test Loss: 1.333 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2661066055297852
Epoch: 13, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.319 Vali Acc: 0.275 Test Loss: 1.319 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.18027925491333
Epoch: 14, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.307 Vali Acc: 0.275 Test Loss: 1.307 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2018749713897705
Epoch: 15, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.296 Vali Acc: 0.325 Test Loss: 1.296 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 16 cost time: 1.1052954196929932
Epoch: 16, Steps: 3 | Train Loss: 0.756 Vali Loss: 1.285 Vali Acc: 0.325 Test Loss: 1.285 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 17 cost time: 1.1506786346435547
Epoch: 17, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.272 Vali Acc: 0.350 Test Loss: 1.272 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 18 cost time: 1.1981170177459717
Epoch: 18, Steps: 3 | Train Loss: 0.672 Vali Loss: 1.260 Vali Acc: 0.375 Test Loss: 1.260 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 19 cost time: 1.2652840614318848
Epoch: 19, Steps: 3 | Train Loss: 0.630 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 1.21628999710083
Epoch: 20, Steps: 3 | Train Loss: 0.548 Vali Loss: 1.236 Vali Acc: 0.450 Test Loss: 1.236 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 21 cost time: 1.3377296924591064
Epoch: 21, Steps: 3 | Train Loss: 0.511 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1831324100494385
Epoch: 22, Steps: 3 | Train Loss: 0.398 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1731739044189453
Epoch: 23, Steps: 3 | Train Loss: 0.408 Vali Loss: 1.209 Vali Acc: 0.425 Test Loss: 1.209 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2391433715820312
Epoch: 24, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.192 Vali Acc: 0.400 Test Loss: 1.192 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3035740852355957
Epoch: 25, Steps: 3 | Train Loss: 0.323 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1868624687194824
Epoch: 26, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.176 Vali Acc: 0.450 Test Loss: 1.176 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 27 cost time: 1.2396800518035889
Epoch: 27, Steps: 3 | Train Loss: 0.268 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 28 cost time: 1.1626615524291992
Epoch: 28, Steps: 3 | Train Loss: 0.234 Vali Loss: 1.191 Vali Acc: 0.450 Test Loss: 1.191 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1399896144866943
Epoch: 29, Steps: 3 | Train Loss: 0.184 Vali Loss: 1.201 Vali Acc: 0.375 Test Loss: 1.201 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.246772289276123
Epoch: 30, Steps: 3 | Train Loss: 0.174 Vali Loss: 1.181 Vali Acc: 0.425 Test Loss: 1.181 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2002482414245605
Epoch: 31, Steps: 3 | Train Loss: 0.137 Vali Loss: 1.158 Vali Acc: 0.475 Test Loss: 1.158 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1373162269592285
Epoch: 32, Steps: 3 | Train Loss: 0.128 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 33 cost time: 1.2333147525787354
Epoch: 33, Steps: 3 | Train Loss: 0.138 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 34 cost time: 1.2046113014221191
Epoch: 34, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.153 Vali Acc: 0.525 Test Loss: 1.153 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524988).  Saving model ...
Epoch: 35 cost time: 1.1876959800720215
Epoch: 35, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.159 Vali Acc: 0.525 Test Loss: 1.159 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2205986976623535
Epoch: 36, Steps: 3 | Train Loss: 0.071 Vali Loss: 1.164 Vali Acc: 0.525 Test Loss: 1.164 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0899899005889893
Epoch: 37, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.174 Vali Acc: 0.525 Test Loss: 1.174 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3067810535430908
Epoch: 38, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.173 Vali Acc: 0.525 Test Loss: 1.173 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2535450458526611
Epoch: 39, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.171 Vali Acc: 0.550 Test Loss: 1.171 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 40 cost time: 1.2303948402404785
Epoch: 40, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.156 Vali Acc: 0.550 Test Loss: 1.156 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 41 cost time: 1.1866750717163086
Epoch: 41, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 42 cost time: 1.4841890335083008
Epoch: 42, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 43 cost time: 1.2126009464263916
Epoch: 43, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.170 Vali Acc: 0.575 Test Loss: 1.170 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 44 cost time: 1.283726692199707
Epoch: 44, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.187 Vali Acc: 0.575 Test Loss: 1.187 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.198307991027832
Epoch: 45, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.188 Vali Acc: 0.575 Test Loss: 1.188 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.307021141052246
Epoch: 46, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.182 Vali Acc: 0.575 Test Loss: 1.182 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2763092517852783
Epoch: 47, Steps: 3 | Train Loss: 0.045 Vali Loss: 1.167 Vali Acc: 0.575 Test Loss: 1.167 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 48 cost time: 1.277479648590088
Epoch: 48, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.160 Vali Acc: 0.575 Test Loss: 1.160 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 49 cost time: 1.3134114742279053
Epoch: 49, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 50 cost time: 1.260169267654419
Epoch: 50, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 51 cost time: 1.2457315921783447
Epoch: 51, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.137 Vali Acc: 0.600 Test Loss: 1.137 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 52 cost time: 1.2134745121002197
Epoch: 52, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.133 Vali Acc: 0.625 Test Loss: 1.133 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 53 cost time: 1.3176987171173096
Epoch: 53, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.137 Vali Acc: 0.625 Test Loss: 1.137 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2177484035491943
Epoch: 54, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2173020839691162
Epoch: 55, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.165 Vali Acc: 0.600 Test Loss: 1.165 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.245910882949829
Epoch: 56, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.190 Vali Acc: 0.600 Test Loss: 1.190 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.2981929779052734
Epoch: 57, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.207 Vali Acc: 0.575 Test Loss: 1.207 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.315068006515503
Epoch: 58, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.2655858993530273
Epoch: 59, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.3741161823272705
Epoch: 60, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.198 Vali Acc: 0.600 Test Loss: 1.198 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.348215103149414
Epoch: 61, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.2993533611297607
Epoch: 62, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5795416831970215
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.4236230850219727
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2858493328094482
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.292895793914795
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.352189302444458
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.1893460750579834
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.310298204421997
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.229853630065918
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.1981933116912842
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.1992628574371338
Epoch: 10, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 1.1531836986541748
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.1574797630310059
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.1352922916412354
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.1023943424224854
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.1482319831848145
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0684480667114258
Epoch: 16, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1384053230285645
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0938286781311035
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.35080885887146
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1695833206176758
Epoch: 20, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1283960342407227
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.331204891204834
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1521971225738525
Epoch: 23, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1732869148254395
Epoch: 24, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 376004
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.459172248840332
Epoch: 1, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.357 Vali Acc: 0.275 Test Loss: 1.357 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.1776337623596191
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.310 Vali Acc: 0.325 Test Loss: 1.310 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 1.1509332656860352
Epoch: 3, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.257 Vali Acc: 0.425 Test Loss: 1.257 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 1.0819616317749023
Epoch: 4, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.189 Vali Acc: 0.550 Test Loss: 1.189 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 1.3538734912872314
Epoch: 5, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.1699268817901611
Epoch: 6, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3470635414123535
Epoch: 7, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.951 Vali Acc: 0.725 Test Loss: 0.951 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 1.2526090145111084
Epoch: 8, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.2295873165130615
Epoch: 9, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.799 Vali Acc: 0.825 Test Loss: 0.799 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 1.3804466724395752
Epoch: 10, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.726 Vali Acc: 0.900 Test Loss: 0.726 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 1.2673897743225098
Epoch: 11, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.663 Vali Acc: 0.900 Test Loss: 0.663 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 1.318352460861206
Epoch: 12, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.607 Vali Acc: 0.900 Test Loss: 0.607 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 1.2935371398925781
Epoch: 13, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 1.20334792137146
Epoch: 14, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 1.1703252792358398
Epoch: 15, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2529633045196533
Epoch: 16, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.433 Vali Acc: 0.875 Test Loss: 0.433 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.251953125
Epoch: 17, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 1.3001594543457031
Epoch: 18, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 1.2114989757537842
Epoch: 19, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.2740886211395264
Epoch: 20, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 1.209348440170288
Epoch: 21, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2600703239440918
Epoch: 22, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.256901741027832
Epoch: 23, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3796768188476562
Epoch: 24, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3386070728302002
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.308283805847168
Epoch: 26, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1477315425872803
Epoch: 27, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2250196933746338
Epoch: 28, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.283106803894043
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.275 Vali Acc: 0.900 Test Loss: 0.275 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.390864372253418
Epoch: 30, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.875 Test Loss: 0.273 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5245895385742188
Epoch: 1, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.4869990348815918
Epoch: 2, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.299 Vali Acc: 0.425 Test Loss: 1.299 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.6124036312103271
Epoch: 3, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.6001262664794922
Epoch: 4, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.3088016510009766
Epoch: 5, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.112 Vali Acc: 0.650 Test Loss: 1.112 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 6 cost time: 1.2029762268066406
Epoch: 6, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.035 Vali Acc: 0.725 Test Loss: 1.035 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 1.168381690979004
Epoch: 7, Steps: 3 | Train Loss: 0.896 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 1.2275176048278809
Epoch: 8, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 1.2372798919677734
Epoch: 9, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.809 Vali Acc: 0.800 Test Loss: 0.809 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.3951268196105957
Epoch: 10, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 1.335700273513794
Epoch: 11, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 1.3542916774749756
Epoch: 12, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 1.17387056350708
Epoch: 13, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 14 cost time: 1.1128747463226318
Epoch: 14, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.520 Vali Acc: 0.875 Test Loss: 0.520 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 15 cost time: 1.3924007415771484
Epoch: 15, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 1.2634541988372803
Epoch: 16, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.1710524559020996
Epoch: 17, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 1.3463478088378906
Epoch: 18, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 1.2177515029907227
Epoch: 19, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.2080795764923096
Epoch: 20, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 1.2322359085083008
Epoch: 21, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 1.219902753829956
Epoch: 22, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.2364318370819092
Epoch: 23, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 1.3094737529754639
Epoch: 24, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 1.165349006652832
Epoch: 25, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 1.249894380569458
Epoch: 26, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 1.2069661617279053
Epoch: 27, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 1.2739841938018799
Epoch: 28, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.2206990718841553
Epoch: 29, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.2502927780151367
Epoch: 30, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 1.2600760459899902
Epoch: 31, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 1.2668380737304688
Epoch: 32, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 1.2732069492340088
Epoch: 33, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 1.233666181564331
Epoch: 34, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 1.1699965000152588
Epoch: 35, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.1306865215301514
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.2836084365844727
Epoch: 37, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.3010962009429932
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 1.256678819656372
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 1.2271907329559326
Epoch: 40, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.2876818180084229
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.395421028137207
Epoch: 42, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.21457839012146
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.3649570941925049
Epoch: 44, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.2950050830841064
Epoch: 45, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.3357150554656982
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.5879881381988525
Epoch: 47, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.4093878269195557
Epoch: 48, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.3518311977386475
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.3506553173065186
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.29966402053833
Epoch: 51, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 1.4205045700073242
Epoch: 52, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2503414154052734
Epoch: 53, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3858628273010254
Epoch: 54, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.3481991291046143
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 1.2266671657562256
Epoch: 56, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.2378332614898682
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.3042714595794678
Epoch: 58, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.2632148265838623
Epoch: 59, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.3277430534362793
Epoch: 60, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 61 cost time: 1.3589911460876465
Epoch: 61, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 62 cost time: 1.375220775604248
Epoch: 62, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 63 cost time: 1.3284542560577393
Epoch: 63, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 64 cost time: 1.2917704582214355
Epoch: 64, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 65 cost time: 1.2579562664031982
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.227691411972046
Epoch: 66, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.3872544765472412
Epoch: 67, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.283665418624878
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.3659095764160156
Epoch: 69, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.3003122806549072
Epoch: 70, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.3645942211151123
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.3442418575286865
Epoch: 72, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.3057522773742676
Epoch: 73, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.4124069213867188
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4512250423431396
Epoch: 1, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.320 Vali Acc: 0.325 Test Loss: 1.320 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 1.333207130432129
Epoch: 2, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.3787994384765625
Epoch: 3, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.230 Vali Acc: 0.475 Test Loss: 1.230 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 1.2638797760009766
Epoch: 4, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.167 Vali Acc: 0.600 Test Loss: 1.167 Test Acc: 0.600
Validation loss decreased (-0.474988 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.3306751251220703
Epoch: 5, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 1.2787315845489502
Epoch: 6, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.022 Vali Acc: 0.700 Test Loss: 1.022 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 1.160738468170166
Epoch: 7, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.947 Vali Acc: 0.725 Test Loss: 0.947 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 1.0755283832550049
Epoch: 8, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 1.2160587310791016
Epoch: 9, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.807 Vali Acc: 0.850 Test Loss: 0.807 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 1.2295143604278564
Epoch: 10, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.742 Vali Acc: 0.875 Test Loss: 0.742 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 1.2517120838165283
Epoch: 11, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 1.2830884456634521
Epoch: 12, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 1.1948866844177246
Epoch: 13, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 1.3168056011199951
Epoch: 14, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 1.2639398574829102
Epoch: 15, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 1.2454195022583008
Epoch: 16, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 1.312687635421753
Epoch: 17, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 1.1951074600219727
Epoch: 18, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 1.2510323524475098
Epoch: 19, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 1.1147725582122803
Epoch: 20, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 1.2554898262023926
Epoch: 21, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 1.1420578956604004
Epoch: 22, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 1.1781280040740967
Epoch: 23, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 1.1350293159484863
Epoch: 24, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 1.300687313079834
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 1.3442127704620361
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 1.2159819602966309
Epoch: 27, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 1.3260409832000732
Epoch: 28, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 1.4408142566680908
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 1.463130235671997
Epoch: 30, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 1.3604469299316406
Epoch: 31, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.3833849430084229
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3074069023132324
Epoch: 33, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.3001947402954102
Epoch: 34, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 1.3249762058258057
Epoch: 35, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.4606733322143555
Epoch: 36, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.380333662033081
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7228174209594727
Epoch: 38, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4583289623260498
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3149340152740479
Epoch: 40, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.342320203781128
Epoch: 41, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.348832368850708
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3384437561035156
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2584872245788574
Epoch: 44, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.4271793365478516
Epoch: 45, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5247204303741455
Epoch: 1, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.381 Vali Acc: 0.375 Test Loss: 1.381 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.2589900493621826
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.339 Vali Acc: 0.450 Test Loss: 1.339 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.3009493350982666
Epoch: 3, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.293 Vali Acc: 0.450 Test Loss: 1.293 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.2026824951171875
Epoch: 4, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.231 Vali Acc: 0.525 Test Loss: 1.231 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.264033317565918
Epoch: 5, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 1.2096312046051025
Epoch: 6, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 1.1875686645507812
Epoch: 7, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.017 Vali Acc: 0.675 Test Loss: 1.017 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 1.216991662979126
Epoch: 8, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.950 Vali Acc: 0.725 Test Loss: 0.950 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 1.2414603233337402
Epoch: 9, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.886 Vali Acc: 0.725 Test Loss: 0.886 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 1.3351960182189941
Epoch: 10, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 11 cost time: 1.1725103855133057
Epoch: 11, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.769 Vali Acc: 0.750 Test Loss: 0.769 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 1.3060789108276367
Epoch: 12, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.723 Vali Acc: 0.750 Test Loss: 0.723 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 1.0900993347167969
Epoch: 13, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.673 Vali Acc: 0.775 Test Loss: 0.673 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 14 cost time: 1.1266884803771973
Epoch: 14, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.636 Vali Acc: 0.800 Test Loss: 0.636 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799994).  Saving model ...
Epoch: 15 cost time: 1.114673137664795
Epoch: 15, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 16 cost time: 1.29721999168396
Epoch: 16, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.593 Vali Acc: 0.800 Test Loss: 0.593 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 17 cost time: 1.3234155178070068
Epoch: 17, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.580 Vali Acc: 0.800 Test Loss: 0.580 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 18 cost time: 1.1792075634002686
Epoch: 18, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.571 Vali Acc: 0.800 Test Loss: 0.571 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 1.1996781826019287
Epoch: 19, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.556 Vali Acc: 0.800 Test Loss: 0.556 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 20 cost time: 1.229971170425415
Epoch: 20, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.545 Vali Acc: 0.800 Test Loss: 0.545 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 21 cost time: 1.1936116218566895
Epoch: 21, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.527 Vali Acc: 0.800 Test Loss: 0.527 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 22 cost time: 1.2601447105407715
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.509 Vali Acc: 0.800 Test Loss: 0.509 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 23 cost time: 1.3220164775848389
Epoch: 23, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.497 Vali Acc: 0.825 Test Loss: 0.497 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 24 cost time: 1.2864384651184082
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.488 Vali Acc: 0.800 Test Loss: 0.488 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3938899040222168
Epoch: 25, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.479 Vali Acc: 0.800 Test Loss: 0.479 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2829694747924805
Epoch: 26, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.473 Vali Acc: 0.800 Test Loss: 0.473 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.354271411895752
Epoch: 27, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.468 Vali Acc: 0.800 Test Loss: 0.468 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2297184467315674
Epoch: 28, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.466 Vali Acc: 0.825 Test Loss: 0.466 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 29 cost time: 1.227329969406128
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.465 Vali Acc: 0.825 Test Loss: 0.465 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 30 cost time: 1.3470842838287354
Epoch: 30, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.464 Vali Acc: 0.825 Test Loss: 0.464 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 31 cost time: 1.2617840766906738
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.460 Vali Acc: 0.825 Test Loss: 0.460 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 32 cost time: 1.2400131225585938
Epoch: 32, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.458 Vali Acc: 0.825 Test Loss: 0.458 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 33 cost time: 1.198627233505249
Epoch: 33, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.453 Vali Acc: 0.825 Test Loss: 0.453 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 34 cost time: 1.208122730255127
Epoch: 34, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.449 Vali Acc: 0.825 Test Loss: 0.449 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 35 cost time: 1.20654296875
Epoch: 35, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.447 Vali Acc: 0.825 Test Loss: 0.447 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 36 cost time: 1.180201530456543
Epoch: 36, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.445 Vali Acc: 0.825 Test Loss: 0.445 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 37 cost time: 1.1630511283874512
Epoch: 37, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.441 Vali Acc: 0.825 Test Loss: 0.441 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 38 cost time: 1.271233320236206
Epoch: 38, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.436 Vali Acc: 0.825 Test Loss: 0.436 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 39 cost time: 1.2354991436004639
Epoch: 39, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.432 Vali Acc: 0.825 Test Loss: 0.432 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 40 cost time: 1.2406468391418457
Epoch: 40, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.429 Vali Acc: 0.825 Test Loss: 0.429 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 41 cost time: 1.1416912078857422
Epoch: 41, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.428 Vali Acc: 0.825 Test Loss: 0.428 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 42 cost time: 1.1882317066192627
Epoch: 42, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.425 Vali Acc: 0.825 Test Loss: 0.425 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 43 cost time: 1.278749704360962
Epoch: 43, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.425 Vali Acc: 0.825 Test Loss: 0.425 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 44 cost time: 1.3290245532989502
Epoch: 44, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.825 Test Loss: 0.424 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 45 cost time: 1.33563232421875
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.423 Vali Acc: 0.825 Test Loss: 0.423 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 46 cost time: 1.3186500072479248
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.421 Vali Acc: 0.825 Test Loss: 0.421 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 47 cost time: 1.3050036430358887
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.419 Vali Acc: 0.825 Test Loss: 0.419 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 48 cost time: 1.1595261096954346
Epoch: 48, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.825 Test Loss: 0.418 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 49 cost time: 1.2749979496002197
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.416 Vali Acc: 0.825 Test Loss: 0.416 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 50 cost time: 1.1952307224273682
Epoch: 50, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.414 Vali Acc: 0.825 Test Loss: 0.414 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 51 cost time: 1.2337474822998047
Epoch: 51, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.413 Vali Acc: 0.825 Test Loss: 0.413 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 52 cost time: 1.3028459548950195
Epoch: 52, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.412 Vali Acc: 0.825 Test Loss: 0.412 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 53 cost time: 1.2732508182525635
Epoch: 53, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.410 Vali Acc: 0.825 Test Loss: 0.410 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 54 cost time: 1.3797650337219238
Epoch: 54, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.409 Vali Acc: 0.825 Test Loss: 0.409 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 55 cost time: 1.2407779693603516
Epoch: 55, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.408 Vali Acc: 0.825 Test Loss: 0.408 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 56 cost time: 1.2554287910461426
Epoch: 56, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.825 Test Loss: 0.406 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 57 cost time: 1.1790051460266113
Epoch: 57, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.825 Test Loss: 0.405 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 58 cost time: 1.3834021091461182
Epoch: 58, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.825 Test Loss: 0.404 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 59 cost time: 1.462578296661377
Epoch: 59, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.403 Vali Acc: 0.825 Test Loss: 0.403 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 60 cost time: 1.2455542087554932
Epoch: 60, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.403 Vali Acc: 0.825 Test Loss: 0.403 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 61 cost time: 1.0993211269378662
Epoch: 61, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.402 Vali Acc: 0.825 Test Loss: 0.402 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 62 cost time: 1.2109107971191406
Epoch: 62, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
Validation loss decreased (-0.824996 --> -0.849996).  Saving model ...
Epoch: 63 cost time: 1.1687307357788086
Epoch: 63, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.850 Test Loss: 0.399 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 64 cost time: 1.1656856536865234
Epoch: 64, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 65 cost time: 1.345003604888916
Epoch: 65, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 66 cost time: 1.3649849891662598
Epoch: 66, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 67 cost time: 1.338414192199707
Epoch: 67, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.396 Vali Acc: 0.850 Test Loss: 0.396 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 68 cost time: 1.2000656127929688
Epoch: 68, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 69 cost time: 1.283684253692627
Epoch: 69, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.394 Vali Acc: 0.850 Test Loss: 0.394 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 70 cost time: 1.284388780593872
Epoch: 70, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 71 cost time: 1.1985952854156494
Epoch: 71, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 72 cost time: 1.3517158031463623
Epoch: 72, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 73 cost time: 1.272911548614502
Epoch: 73, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 74 cost time: 1.1414811611175537
Epoch: 74, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.2943649291992188
Epoch: 75, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.2377161979675293
Epoch: 76, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 77 cost time: 1.2273280620574951
Epoch: 77, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 78 cost time: 1.3734309673309326
Epoch: 78, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.825 Test Loss: 0.389 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.2266390323638916
Epoch: 79, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.825 Test Loss: 0.389 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.1779537200927734
Epoch: 80, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 81 cost time: 1.1500966548919678
Epoch: 81, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 82 cost time: 1.1727714538574219
Epoch: 82, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 83 cost time: 1.1686255931854248
Epoch: 83, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 84 cost time: 1.2188663482666016
Epoch: 84, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 85 cost time: 1.233903169631958
Epoch: 85, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.875 Test Loss: 0.384 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 86 cost time: 1.3158080577850342
Epoch: 86, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 87 cost time: 1.2165250778198242
Epoch: 87, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.3251714706420898
Epoch: 88, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.1613714694976807
Epoch: 89, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.1398355960845947
Epoch: 90, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.2889270782470703
Epoch: 91, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.3387839794158936
Epoch: 92, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.2884156703948975
Epoch: 93, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.3088948726654053
Epoch: 94, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.257563591003418
Epoch: 95, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 1.2467079162597656
Epoch: 96, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.563253402709961
Epoch: 1, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.2181077003479004
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.359 Vali Acc: 0.350 Test Loss: 1.359 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.2882306575775146
Epoch: 3, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.317 Vali Acc: 0.475 Test Loss: 1.317 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.198206901550293
Epoch: 4, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.259 Vali Acc: 0.525 Test Loss: 1.259 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 1.361621379852295
Epoch: 5, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.194 Vali Acc: 0.625 Test Loss: 1.194 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 1.566575527191162
Epoch: 6, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.124 Vali Acc: 0.650 Test Loss: 1.124 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 1.2192614078521729
Epoch: 7, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.057 Vali Acc: 0.675 Test Loss: 1.057 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 1.1456551551818848
Epoch: 8, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.994 Vali Acc: 0.700 Test Loss: 0.994 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 1.208486795425415
Epoch: 9, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 1.1365299224853516
Epoch: 10, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.870 Vali Acc: 0.750 Test Loss: 0.870 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.2499618530273438
Epoch: 11, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 1.363243818283081
Epoch: 12, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.213226318359375
Epoch: 13, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.714 Vali Acc: 0.850 Test Loss: 0.714 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 1.2506217956542969
Epoch: 14, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 1.1881496906280518
Epoch: 15, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.641 Vali Acc: 0.825 Test Loss: 0.641 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.306962490081787
Epoch: 16, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.614 Vali Acc: 0.825 Test Loss: 0.614 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3382062911987305
Epoch: 17, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 1.2673988342285156
Epoch: 18, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.2614541053771973
Epoch: 19, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.34181809425354
Epoch: 20, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2166144847869873
Epoch: 21, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.537 Vali Acc: 0.825 Test Loss: 0.537 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.103100299835205
Epoch: 22, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.524 Vali Acc: 0.850 Test Loss: 0.524 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 1.3151586055755615
Epoch: 23, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.32352876663208
Epoch: 24, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4514479637145996
Epoch: 25, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 26 cost time: 1.2801709175109863
Epoch: 26, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3754513263702393
Epoch: 27, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4252007007598877
Epoch: 28, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.825 Test Loss: 0.510 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.415436029434204
Epoch: 29, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 1.3552556037902832
Epoch: 30, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.491 Vali Acc: 0.850 Test Loss: 0.491 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 31 cost time: 1.4106030464172363
Epoch: 31, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.485 Vali Acc: 0.850 Test Loss: 0.485 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 32 cost time: 1.411327600479126
Epoch: 32, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 33 cost time: 1.447307825088501
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 34 cost time: 1.33552885055542
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.483 Vali Acc: 0.850 Test Loss: 0.483 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3485419750213623
Epoch: 35, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.487 Vali Acc: 0.850 Test Loss: 0.487 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3626019954681396
Epoch: 36, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.494 Vali Acc: 0.850 Test Loss: 0.494 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.433929681777954
Epoch: 37, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.500 Vali Acc: 0.825 Test Loss: 0.500 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.360910415649414
Epoch: 38, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.505 Vali Acc: 0.825 Test Loss: 0.505 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3354954719543457
Epoch: 39, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4641332626342773
Epoch: 40, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.509 Vali Acc: 0.825 Test Loss: 0.509 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2835676670074463
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.260972261428833
Epoch: 42, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3148796558380127
Epoch: 43, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.850 Test Loss: 0.502 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4909722805023193
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.485 Vali Acc: 0.125 Test Loss: 1.485 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.2304911613464355
Epoch: 2, Steps: 3 | Train Loss: 1.495 Vali Loss: 1.474 Vali Acc: 0.175 Test Loss: 1.474 Test Acc: 0.175
Validation loss decreased (-0.124985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 1.2253682613372803
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.459 Vali Acc: 0.175 Test Loss: 1.459 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174985).  Saving model ...
Epoch: 4 cost time: 1.0787475109100342
Epoch: 4, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.437 Vali Acc: 0.175 Test Loss: 1.437 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 1.1183936595916748
Epoch: 5, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.413 Vali Acc: 0.200 Test Loss: 1.413 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 6 cost time: 1.1467640399932861
Epoch: 6, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.1518077850341797
Epoch: 7, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.363 Vali Acc: 0.275 Test Loss: 1.363 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 8 cost time: 1.2221145629882812
Epoch: 8, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.343 Vali Acc: 0.350 Test Loss: 1.343 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 1.3521227836608887
Epoch: 9, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 1.1418793201446533
Epoch: 10, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 1.095935344696045
Epoch: 11, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.261 Vali Acc: 0.525 Test Loss: 1.261 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 1.1285996437072754
Epoch: 12, Steps: 3 | Train Loss: 0.831 Vali Loss: 1.238 Vali Acc: 0.550 Test Loss: 1.238 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 1.0576231479644775
Epoch: 13, Steps: 3 | Train Loss: 0.719 Vali Loss: 1.207 Vali Acc: 0.575 Test Loss: 1.207 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 1.1379129886627197
Epoch: 14, Steps: 3 | Train Loss: 0.695 Vali Loss: 1.182 Vali Acc: 0.625 Test Loss: 1.182 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 15 cost time: 1.1036560535430908
Epoch: 15, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.159 Vali Acc: 0.625 Test Loss: 1.159 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 16 cost time: 1.2656834125518799
Epoch: 16, Steps: 3 | Train Loss: 0.546 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 1.2564706802368164
Epoch: 17, Steps: 3 | Train Loss: 0.530 Vali Loss: 1.124 Vali Acc: 0.650 Test Loss: 1.124 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 18 cost time: 1.157557487487793
Epoch: 18, Steps: 3 | Train Loss: 0.451 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 19 cost time: 1.1889839172363281
Epoch: 19, Steps: 3 | Train Loss: 0.516 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 20 cost time: 1.1223382949829102
Epoch: 20, Steps: 3 | Train Loss: 0.364 Vali Loss: 1.048 Vali Acc: 0.675 Test Loss: 1.048 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 1.1969666481018066
Epoch: 21, Steps: 3 | Train Loss: 0.357 Vali Loss: 1.020 Vali Acc: 0.650 Test Loss: 1.020 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2258579730987549
Epoch: 22, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 23 cost time: 1.3315682411193848
Epoch: 23, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.988 Vali Acc: 0.675 Test Loss: 0.988 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3583908081054688
Epoch: 24, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.986 Vali Acc: 0.650 Test Loss: 0.986 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.299591302871704
Epoch: 25, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1916074752807617
Epoch: 26, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2716865539550781
Epoch: 27, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.969 Vali Acc: 0.675 Test Loss: 0.969 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1962647438049316
Epoch: 28, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.960 Vali Acc: 0.675 Test Loss: 0.960 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3425407409667969
Epoch: 29, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.956 Vali Acc: 0.650 Test Loss: 0.956 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3040900230407715
Epoch: 30, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.953 Vali Acc: 0.650 Test Loss: 0.953 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3193728923797607
Epoch: 31, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.937 Vali Acc: 0.675 Test Loss: 0.937 Test Acc: 0.675
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2020435333251953
Epoch: 32, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.926 Vali Acc: 0.675 Test Loss: 0.926 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.7
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.533302068710327
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.451 Vali Acc: 0.325 Test Loss: 1.451 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 1.2576985359191895
Epoch: 2, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.444 Vali Acc: 0.300 Test Loss: 1.444 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2477293014526367
Epoch: 3, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.435 Vali Acc: 0.325 Test Loss: 1.435 Test Acc: 0.325
Validation loss decreased (-0.324985 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.117868185043335
Epoch: 4, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.424 Vali Acc: 0.325 Test Loss: 1.424 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.3343536853790283
Epoch: 5, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.410 Vali Acc: 0.275 Test Loss: 1.410 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.168597936630249
Epoch: 6, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.398 Vali Acc: 0.250 Test Loss: 1.398 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3253064155578613
Epoch: 7, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.391 Vali Acc: 0.225 Test Loss: 1.391 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3153085708618164
Epoch: 8, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.389 Vali Acc: 0.250 Test Loss: 1.389 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1635839939117432
Epoch: 9, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.201117753982544
Epoch: 10, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.380 Vali Acc: 0.250 Test Loss: 1.380 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1337330341339111
Epoch: 11, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.371 Vali Acc: 0.250 Test Loss: 1.371 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1324107646942139
Epoch: 12, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.367 Vali Acc: 0.275 Test Loss: 1.367 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2513325214385986
Epoch: 13, Steps: 3 | Train Loss: 0.860 Vali Loss: 1.358 Vali Acc: 0.275 Test Loss: 1.358 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1921260356903076
Epoch: 14, Steps: 3 | Train Loss: 0.731 Vali Loss: 1.351 Vali Acc: 0.275 Test Loss: 1.351 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.325
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6516904830932617
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.485 Vali Acc: 0.225 Test Loss: 1.485 Test Acc: 0.225
Validation loss decreased (inf --> -0.224985).  Saving model ...
Epoch: 2 cost time: 1.367217779159546
Epoch: 2, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.477 Vali Acc: 0.250 Test Loss: 1.477 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.3537893295288086
Epoch: 3, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.465 Vali Acc: 0.250 Test Loss: 1.465 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 1.469954490661621
Epoch: 4, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.451 Vali Acc: 0.250 Test Loss: 1.451 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 5 cost time: 1.264493465423584
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.434 Vali Acc: 0.250 Test Loss: 1.434 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.2311291694641113
Epoch: 6, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.415 Vali Acc: 0.225 Test Loss: 1.415 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2173678874969482
Epoch: 7, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.402 Vali Acc: 0.225 Test Loss: 1.402 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.314340353012085
Epoch: 8, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.394 Vali Acc: 0.250 Test Loss: 1.394 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.4634861946105957
Epoch: 9, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.383 Vali Acc: 0.250 Test Loss: 1.383 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.1457037925720215
Epoch: 10, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.367 Vali Acc: 0.200 Test Loss: 1.367 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2234611511230469
Epoch: 11, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.348 Vali Acc: 0.275 Test Loss: 1.348 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 12 cost time: 1.1557652950286865
Epoch: 12, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.336 Vali Acc: 0.275 Test Loss: 1.336 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 13 cost time: 1.2718548774719238
Epoch: 13, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.323 Vali Acc: 0.325 Test Loss: 1.323 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 14 cost time: 1.1373586654663086
Epoch: 14, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.310 Vali Acc: 0.300 Test Loss: 1.310 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.214120864868164
Epoch: 15, Steps: 3 | Train Loss: 0.806 Vali Loss: 1.299 Vali Acc: 0.325 Test Loss: 1.299 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 16 cost time: 1.1826848983764648
Epoch: 16, Steps: 3 | Train Loss: 0.727 Vali Loss: 1.291 Vali Acc: 0.375 Test Loss: 1.291 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 17 cost time: 1.1944761276245117
Epoch: 17, Steps: 3 | Train Loss: 0.615 Vali Loss: 1.284 Vali Acc: 0.425 Test Loss: 1.284 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 18 cost time: 1.2477505207061768
Epoch: 18, Steps: 3 | Train Loss: 0.565 Vali Loss: 1.278 Vali Acc: 0.425 Test Loss: 1.278 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 19 cost time: 1.1684739589691162
Epoch: 19, Steps: 3 | Train Loss: 0.584 Vali Loss: 1.261 Vali Acc: 0.425 Test Loss: 1.261 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 20 cost time: 1.1464202404022217
Epoch: 20, Steps: 3 | Train Loss: 0.493 Vali Loss: 1.248 Vali Acc: 0.475 Test Loss: 1.248 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 21 cost time: 1.3678689002990723
Epoch: 21, Steps: 3 | Train Loss: 0.472 Vali Loss: 1.232 Vali Acc: 0.475 Test Loss: 1.232 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 22 cost time: 1.159663438796997
Epoch: 22, Steps: 3 | Train Loss: 0.500 Vali Loss: 1.219 Vali Acc: 0.475 Test Loss: 1.219 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 23 cost time: 1.136805534362793
Epoch: 23, Steps: 3 | Train Loss: 0.401 Vali Loss: 1.220 Vali Acc: 0.475 Test Loss: 1.220 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.155317783355713
Epoch: 24, Steps: 3 | Train Loss: 0.326 Vali Loss: 1.223 Vali Acc: 0.475 Test Loss: 1.223 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0741467475891113
Epoch: 25, Steps: 3 | Train Loss: 0.311 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 26 cost time: 1.1731748580932617
Epoch: 26, Steps: 3 | Train Loss: 0.316 Vali Loss: 1.196 Vali Acc: 0.475 Test Loss: 1.196 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3046741485595703
Epoch: 27, Steps: 3 | Train Loss: 0.252 Vali Loss: 1.180 Vali Acc: 0.475 Test Loss: 1.180 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2567341327667236
Epoch: 28, Steps: 3 | Train Loss: 0.267 Vali Loss: 1.170 Vali Acc: 0.525 Test Loss: 1.170 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 29 cost time: 1.3987629413604736
Epoch: 29, Steps: 3 | Train Loss: 0.220 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1609995365142822
Epoch: 30, Steps: 3 | Train Loss: 0.199 Vali Loss: 1.173 Vali Acc: 0.525 Test Loss: 1.173 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2776226997375488
Epoch: 31, Steps: 3 | Train Loss: 0.191 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 32 cost time: 1.2544379234313965
Epoch: 32, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.163 Vali Acc: 0.550 Test Loss: 1.163 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2359063625335693
Epoch: 33, Steps: 3 | Train Loss: 0.130 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.35441255569458
Epoch: 34, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.149 Vali Acc: 0.525 Test Loss: 1.149 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4376497268676758
Epoch: 35, Steps: 3 | Train Loss: 0.097 Vali Loss: 1.132 Vali Acc: 0.525 Test Loss: 1.132 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4387691020965576
Epoch: 36, Steps: 3 | Train Loss: 0.105 Vali Loss: 1.108 Vali Acc: 0.575 Test Loss: 1.108 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 37 cost time: 1.5609033107757568
Epoch: 37, Steps: 3 | Train Loss: 0.122 Vali Loss: 1.091 Vali Acc: 0.575 Test Loss: 1.091 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 38 cost time: 1.333489179611206
Epoch: 38, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.077 Vali Acc: 0.575 Test Loss: 1.077 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 39 cost time: 1.3658263683319092
Epoch: 39, Steps: 3 | Train Loss: 0.099 Vali Loss: 1.090 Vali Acc: 0.575 Test Loss: 1.090 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3764550685882568
Epoch: 40, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 41 cost time: 1.3647232055664062
Epoch: 41, Steps: 3 | Train Loss: 0.054 Vali Loss: 1.133 Vali Acc: 0.600 Test Loss: 1.133 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3750479221343994
Epoch: 42, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.149 Vali Acc: 0.575 Test Loss: 1.149 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3412587642669678
Epoch: 43, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.169 Vali Acc: 0.550 Test Loss: 1.169 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4099502563476562
Epoch: 44, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.161 Vali Acc: 0.550 Test Loss: 1.161 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2839603424072266
Epoch: 45, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.137 Vali Acc: 0.575 Test Loss: 1.137 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3195478916168213
Epoch: 46, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3863048553466797
Epoch: 47, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 48 cost time: 1.3101520538330078
Epoch: 48, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 49 cost time: 1.2309365272521973
Epoch: 49, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 50 cost time: 1.2536859512329102
Epoch: 50, Steps: 3 | Train Loss: 0.037 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 51 cost time: 1.1991841793060303
Epoch: 51, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3055922985076904
Epoch: 52, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.080 Vali Acc: 0.575 Test Loss: 1.080 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3051042556762695
Epoch: 53, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.093 Vali Acc: 0.575 Test Loss: 1.093 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2556657791137695
Epoch: 54, Steps: 3 | Train Loss: 0.034 Vali Loss: 1.093 Vali Acc: 0.575 Test Loss: 1.093 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2342216968536377
Epoch: 55, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.240457534790039
Epoch: 56, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.097 Vali Acc: 0.600 Test Loss: 1.097 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2144114971160889
Epoch: 57, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.190654993057251
Epoch: 58, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 59 cost time: 1.2431635856628418
Epoch: 59, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 60 cost time: 1.2545092105865479
Epoch: 60, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.039 Vali Acc: 0.600 Test Loss: 1.039 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 61 cost time: 1.2138257026672363
Epoch: 61, Steps: 3 | Train Loss: 0.017 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 62 cost time: 1.1884403228759766
Epoch: 62, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 63 cost time: 1.18593430519104
Epoch: 63, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.019 Vali Acc: 0.575 Test Loss: 1.019 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2330212593078613
Epoch: 64, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.023 Vali Acc: 0.575 Test Loss: 1.023 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.201688289642334
Epoch: 65, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.028 Vali Acc: 0.575 Test Loss: 1.028 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.3173608779907227
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.032 Vali Acc: 0.575 Test Loss: 1.032 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.359734058380127
Epoch: 67, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.030 Vali Acc: 0.575 Test Loss: 1.030 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.1736924648284912
Epoch: 68, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.031 Vali Acc: 0.575 Test Loss: 1.031 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.237830400466919
Epoch: 69, Steps: 3 | Train Loss: 0.012 Vali Loss: 1.034 Vali Acc: 0.575 Test Loss: 1.034 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.2415564060211182
Epoch: 70, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.039 Vali Acc: 0.575 Test Loss: 1.039 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.2105934619903564
Epoch: 71, Steps: 3 | Train Loss: 0.011 Vali Loss: 1.042 Vali Acc: 0.575 Test Loss: 1.042 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.3415329456329346
Epoch: 72, Steps: 3 | Train Loss: 0.010 Vali Loss: 1.042 Vali Acc: 0.575 Test Loss: 1.042 Test Acc: 0.575
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.6
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.483863115310669
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2657206058502197
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3746397495269775
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1718428134918213
Epoch: 4, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2123329639434814
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2193408012390137
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2584028244018555
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3022425174713135
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2226595878601074
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.29365873336792
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2299301624298096
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.2977030277252197
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.148268461227417
Epoch: 13, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.1079869270324707
Epoch: 14, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.2134757041931152
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.1313281059265137
Epoch: 16, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.228259563446045
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2032995223999023
Epoch: 18, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2248151302337646
Epoch: 19, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1587364673614502
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3309032917022705
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1645934581756592
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2662174701690674
Epoch: 23, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.221804141998291
Epoch: 24, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.221168041229248
Epoch: 25, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 277700
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.451829433441162
Epoch: 1, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.319 Vali Acc: 0.500 Test Loss: 1.319 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.2528047561645508
Epoch: 2, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.2589476108551025
Epoch: 3, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.2541768550872803
Epoch: 4, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.186 Vali Acc: 0.625 Test Loss: 1.186 Test Acc: 0.625
Validation loss decreased (-0.499988 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 1.2527024745941162
Epoch: 5, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.120 Vali Acc: 0.700 Test Loss: 1.120 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 1.255535364151001
Epoch: 6, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.053 Vali Acc: 0.750 Test Loss: 1.053 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 1.2205908298492432
Epoch: 7, Steps: 3 | Train Loss: 0.908 Vali Loss: 0.985 Vali Acc: 0.800 Test Loss: 0.985 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 1.2823562622070312
Epoch: 8, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.912 Vali Acc: 0.825 Test Loss: 0.912 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 1.325157880783081
Epoch: 9, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.844 Vali Acc: 0.850 Test Loss: 0.844 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 1.2793970108032227
Epoch: 10, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.781 Vali Acc: 0.900 Test Loss: 0.781 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 1.189300537109375
Epoch: 11, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.714 Vali Acc: 0.925 Test Loss: 0.714 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 1.2437481880187988
Epoch: 12, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2212133407592773
Epoch: 13, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2255780696868896
Epoch: 14, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.553 Vali Acc: 0.925 Test Loss: 0.553 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 1.2218563556671143
Epoch: 15, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 1.2128782272338867
Epoch: 16, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 1.219611644744873
Epoch: 17, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.190328598022461
Epoch: 18, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.434 Vali Acc: 0.875 Test Loss: 0.434 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2232537269592285
Epoch: 19, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.411 Vali Acc: 0.875 Test Loss: 0.411 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.233898401260376
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2821733951568604
Epoch: 21, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.383 Vali Acc: 0.875 Test Loss: 0.383 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1540617942810059
Epoch: 22, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.375 Vali Acc: 0.875 Test Loss: 0.375 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1849806308746338
Epoch: 23, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.367 Vali Acc: 0.875 Test Loss: 0.367 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.177994966506958
Epoch: 24, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2109546661376953
Epoch: 25, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1760847568511963
Epoch: 26, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.159945487976074
Epoch: 1, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.297 Vali Acc: 0.450 Test Loss: 1.297 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.03987455368042
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.262 Vali Acc: 0.475 Test Loss: 1.262 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 1.1000690460205078
Epoch: 3, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 1.074770212173462
Epoch: 4, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 1.1208419799804688
Epoch: 5, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.100 Vali Acc: 0.700 Test Loss: 1.100 Test Acc: 0.700
Validation loss decreased (-0.574988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 1.0949342250823975
Epoch: 6, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.034 Vali Acc: 0.725 Test Loss: 1.034 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 1.0793776512145996
Epoch: 7, Steps: 3 | Train Loss: 0.930 Vali Loss: 0.969 Vali Acc: 0.750 Test Loss: 0.969 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 1.1278438568115234
Epoch: 8, Steps: 3 | Train Loss: 0.877 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 1.1466610431671143
Epoch: 9, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.836 Vali Acc: 0.800 Test Loss: 0.836 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 1.1395459175109863
Epoch: 10, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.778 Vali Acc: 0.825 Test Loss: 0.778 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 1.0913209915161133
Epoch: 11, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.2650110721588135
Epoch: 12, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.662 Vali Acc: 0.825 Test Loss: 0.662 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.25091552734375
Epoch: 13, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 1.1453132629394531
Epoch: 14, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.570 Vali Acc: 0.900 Test Loss: 0.570 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 1.1823234558105469
Epoch: 15, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 1.0837900638580322
Epoch: 16, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.505 Vali Acc: 0.925 Test Loss: 0.505 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 1.147214651107788
Epoch: 17, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 1.039780855178833
Epoch: 18, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 1.025305986404419
Epoch: 19, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 1.0996544361114502
Epoch: 20, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 1.1436924934387207
Epoch: 21, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 1.1914067268371582
Epoch: 22, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 1.228494644165039
Epoch: 23, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 1.288761854171753
Epoch: 24, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 1.2070553302764893
Epoch: 25, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.1220569610595703
Epoch: 26, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.239107608795166
Epoch: 27, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.1471731662750244
Epoch: 28, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.1546955108642578
Epoch: 29, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 1.2277319431304932
Epoch: 30, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 1.2084510326385498
Epoch: 31, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 1.192570447921753
Epoch: 32, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 1.3327739238739014
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 1.2733628749847412
Epoch: 34, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 1.1115801334381104
Epoch: 35, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 1.2730016708374023
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 1.3408067226409912
Epoch: 37, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 1.231966495513916
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 1.273658037185669
Epoch: 39, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 1.2577948570251465
Epoch: 40, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.217716932296753
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0720491409301758
Epoch: 42, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.1487879753112793
Epoch: 43, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.1174259185791016
Epoch: 44, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.1404986381530762
Epoch: 45, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.1817495822906494
Epoch: 46, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.091623306274414
Epoch: 47, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.1294331550598145
Epoch: 48, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.1662652492523193
Epoch: 49, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.1858482360839844
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.181666612625122
Epoch: 51, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0623846054077148
Epoch: 52, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2087762355804443
Epoch: 53, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 1.0996267795562744
Epoch: 54, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.222414493560791
Epoch: 55, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 1.1445198059082031
Epoch: 56, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 1.1998708248138428
Epoch: 57, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 1.3052740097045898
Epoch: 58, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 59 cost time: 1.3076720237731934
Epoch: 59, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 60 cost time: 1.2637455463409424
Epoch: 60, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1265621185302734
Epoch: 61, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1408100128173828
Epoch: 62, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.271892786026001
Epoch: 63, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.213428020477295
Epoch: 64, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.1514267921447754
Epoch: 65, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 66 cost time: 1.0343053340911865
Epoch: 66, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 67 cost time: 1.4166150093078613
Epoch: 67, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1804916858673096
Epoch: 68, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.3830046653747559
Epoch: 69, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.184659481048584
Epoch: 70, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.204909086227417
Epoch: 71, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.123622179031372
Epoch: 72, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.1956045627593994
Epoch: 73, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.1939201354980469
Epoch: 74, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.16025710105896
Epoch: 75, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.146017074584961
Epoch: 76, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.373868942260742
Epoch: 1, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.1256587505340576
Epoch: 2, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.281 Vali Acc: 0.450 Test Loss: 1.281 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.1750226020812988
Epoch: 3, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.3062379360198975
Epoch: 4, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.179 Vali Acc: 0.550 Test Loss: 1.179 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 1.107511043548584
Epoch: 5, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 1.191960334777832
Epoch: 6, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 1.33552885055542
Epoch: 7, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.985 Vali Acc: 0.725 Test Loss: 0.985 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 1.151731014251709
Epoch: 8, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 1.2675652503967285
Epoch: 9, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 1.2402465343475342
Epoch: 10, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.791 Vali Acc: 0.800 Test Loss: 0.791 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.19209623336792
Epoch: 11, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 1.1754252910614014
Epoch: 12, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 1.25374174118042
Epoch: 13, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.625 Vali Acc: 0.925 Test Loss: 0.625 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 1.3193049430847168
Epoch: 14, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 1.2266788482666016
Epoch: 15, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 1.2235465049743652
Epoch: 16, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 1.2571840286254883
Epoch: 17, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.484 Vali Acc: 0.925 Test Loss: 0.484 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 1.22749924659729
Epoch: 18, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 1.2677993774414062
Epoch: 19, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 1.3370695114135742
Epoch: 20, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 1.202580213546753
Epoch: 21, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 1.2986140251159668
Epoch: 22, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 1.2525060176849365
Epoch: 23, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 1.2082812786102295
Epoch: 24, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 1.175614356994629
Epoch: 25, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.3100297451019287
Epoch: 26, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3220317363739014
Epoch: 27, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.265010118484497
Epoch: 28, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.3595187664031982
Epoch: 29, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 1.3179290294647217
Epoch: 30, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 1.4292058944702148
Epoch: 31, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 1.2792763710021973
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 1.2002818584442139
Epoch: 33, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 1.1663212776184082
Epoch: 34, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 1.373586654663086
Epoch: 35, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 1.192805528640747
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 1.2184362411499023
Epoch: 37, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 1.2740585803985596
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 1.255023717880249
Epoch: 39, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 1.2476530075073242
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2385640144348145
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2579355239868164
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1634314060211182
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3145506381988525
Epoch: 44, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3228449821472168
Epoch: 45, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2241151332855225
Epoch: 46, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2559359073638916
Epoch: 47, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2319767475128174
Epoch: 48, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.123157262802124
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3170366287231445
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.2564499378204346
Epoch: 2, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.25042724609375
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.291 Vali Acc: 0.475 Test Loss: 1.291 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.2151875495910645
Epoch: 4, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 1.2390069961547852
Epoch: 5, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.168 Vali Acc: 0.700 Test Loss: 1.168 Test Acc: 0.700
Validation loss decreased (-0.474988 --> -0.699988).  Saving model ...
Epoch: 6 cost time: 1.255706548690796
Epoch: 6, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.100 Vali Acc: 0.750 Test Loss: 1.100 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 1.4005186557769775
Epoch: 7, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.033 Vali Acc: 0.800 Test Loss: 1.033 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 1.2725918292999268
Epoch: 8, Steps: 3 | Train Loss: 0.894 Vali Loss: 0.965 Vali Acc: 0.800 Test Loss: 0.965 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 1.1478326320648193
Epoch: 9, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 1.204413890838623
Epoch: 10, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.849 Vali Acc: 0.800 Test Loss: 0.849 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 11 cost time: 1.2370400428771973
Epoch: 11, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 1.190439224243164
Epoch: 12, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.743 Vali Acc: 0.850 Test Loss: 0.743 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 1.2198700904846191
Epoch: 13, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.703 Vali Acc: 0.825 Test Loss: 0.703 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.24458646774292
Epoch: 14, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 1.162184476852417
Epoch: 15, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2605972290039062
Epoch: 16, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.606 Vali Acc: 0.825 Test Loss: 0.606 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.242549180984497
Epoch: 17, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.587 Vali Acc: 0.825 Test Loss: 0.587 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2557213306427002
Epoch: 18, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.575 Vali Acc: 0.825 Test Loss: 0.575 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2337226867675781
Epoch: 19, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1916086673736572
Epoch: 20, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1425726413726807
Epoch: 21, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.13533353805542
Epoch: 22, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.532 Vali Acc: 0.825 Test Loss: 0.532 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2565579414367676
Epoch: 23, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.526 Vali Acc: 0.800 Test Loss: 0.526 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.24013352394104
Epoch: 24, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.527 Vali Acc: 0.800 Test Loss: 0.527 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4151711463928223
Epoch: 1, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.374 Vali Acc: 0.400 Test Loss: 1.374 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 1.1576590538024902
Epoch: 2, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.331 Vali Acc: 0.450 Test Loss: 1.331 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 1.1843812465667725
Epoch: 3, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.2709617614746094
Epoch: 4, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1689040660858154
Epoch: 5, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.180 Vali Acc: 0.550 Test Loss: 1.180 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.1112372875213623
Epoch: 6, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.121 Vali Acc: 0.625 Test Loss: 1.121 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.2345678806304932
Epoch: 7, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.061 Vali Acc: 0.700 Test Loss: 1.061 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 1.2752635478973389
Epoch: 8, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.999 Vali Acc: 0.725 Test Loss: 0.999 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 1.2491493225097656
Epoch: 9, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 1.1122794151306152
Epoch: 10, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.885 Vali Acc: 0.775 Test Loss: 0.885 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 1.0988824367523193
Epoch: 11, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.826 Vali Acc: 0.775 Test Loss: 0.826 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 1.176379919052124
Epoch: 12, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.776 Vali Acc: 0.800 Test Loss: 0.776 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 1.2148926258087158
Epoch: 13, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.735 Vali Acc: 0.825 Test Loss: 0.735 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 1.1524958610534668
Epoch: 14, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 15 cost time: 1.1240804195404053
Epoch: 15, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.650 Vali Acc: 0.850 Test Loss: 0.650 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 16 cost time: 1.2230863571166992
Epoch: 16, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2388639450073242
Epoch: 17, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.599 Vali Acc: 0.800 Test Loss: 0.599 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2575340270996094
Epoch: 18, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.572 Vali Acc: 0.825 Test Loss: 0.572 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2197551727294922
Epoch: 19, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 20 cost time: 1.1219189167022705
Epoch: 20, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 21 cost time: 1.2483339309692383
Epoch: 21, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.506 Vali Acc: 0.850 Test Loss: 0.506 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 22 cost time: 1.1453683376312256
Epoch: 22, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 1.2615292072296143
Epoch: 23, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.505 Vali Acc: 0.850 Test Loss: 0.505 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1905357837677002
Epoch: 24, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.509 Vali Acc: 0.800 Test Loss: 0.509 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1604750156402588
Epoch: 25, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1015465259552002
Epoch: 26, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.523 Vali Acc: 0.800 Test Loss: 0.523 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1377575397491455
Epoch: 27, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.521 Vali Acc: 0.800 Test Loss: 0.521 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1341466903686523
Epoch: 28, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.211822748184204
Epoch: 29, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.510 Vali Acc: 0.775 Test Loss: 0.510 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1214358806610107
Epoch: 30, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.506 Vali Acc: 0.800 Test Loss: 0.506 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1131799221038818
Epoch: 31, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.336237907409668
Epoch: 32, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.379939556121826
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.484 Vali Acc: 0.250 Test Loss: 1.484 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.24867844581604
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.474 Vali Acc: 0.250 Test Loss: 1.474 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 1.1668686866760254
Epoch: 3, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.458 Vali Acc: 0.275 Test Loss: 1.458 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 4 cost time: 1.1663851737976074
Epoch: 4, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.438 Vali Acc: 0.275 Test Loss: 1.438 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.1447579860687256
Epoch: 5, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.413 Vali Acc: 0.275 Test Loss: 1.413 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 6 cost time: 1.1396396160125732
Epoch: 6, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.389 Vali Acc: 0.275 Test Loss: 1.389 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 1.206568956375122
Epoch: 7, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 1.1310641765594482
Epoch: 8, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 1.2151858806610107
Epoch: 9, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 1.254793405532837
Epoch: 10, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.299 Vali Acc: 0.450 Test Loss: 1.299 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 11 cost time: 1.1521897315979004
Epoch: 11, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.272 Vali Acc: 0.525 Test Loss: 1.272 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 1.2346351146697998
Epoch: 12, Steps: 3 | Train Loss: 0.863 Vali Loss: 1.248 Vali Acc: 0.550 Test Loss: 1.248 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 13 cost time: 1.2380504608154297
Epoch: 13, Steps: 3 | Train Loss: 0.713 Vali Loss: 1.225 Vali Acc: 0.550 Test Loss: 1.225 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 1.3042271137237549
Epoch: 14, Steps: 3 | Train Loss: 0.720 Vali Loss: 1.196 Vali Acc: 0.550 Test Loss: 1.196 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 1.2502641677856445
Epoch: 15, Steps: 3 | Train Loss: 0.651 Vali Loss: 1.167 Vali Acc: 0.575 Test Loss: 1.167 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 16 cost time: 1.1818244457244873
Epoch: 16, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.145 Vali Acc: 0.575 Test Loss: 1.145 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 17 cost time: 1.252089023590088
Epoch: 17, Steps: 3 | Train Loss: 0.521 Vali Loss: 1.115 Vali Acc: 0.575 Test Loss: 1.115 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 18 cost time: 1.284088134765625
Epoch: 18, Steps: 3 | Train Loss: 0.488 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 19 cost time: 1.2861607074737549
Epoch: 19, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 1.3576457500457764
Epoch: 20, Steps: 3 | Train Loss: 0.328 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 1.2422912120819092
Epoch: 21, Steps: 3 | Train Loss: 0.316 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 1.234236478805542
Epoch: 22, Steps: 3 | Train Loss: 0.304 Vali Loss: 1.020 Vali Acc: 0.625 Test Loss: 1.020 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 23 cost time: 1.2298760414123535
Epoch: 23, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 1.198047399520874
Epoch: 24, Steps: 3 | Train Loss: 0.231 Vali Loss: 1.001 Vali Acc: 0.625 Test Loss: 1.001 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 25 cost time: 1.3574268817901611
Epoch: 25, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 1.3969366550445557
Epoch: 26, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.966 Vali Acc: 0.650 Test Loss: 0.966 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 27 cost time: 1.3155632019042969
Epoch: 27, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.948 Vali Acc: 0.675 Test Loss: 0.948 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 28 cost time: 1.5652189254760742
Epoch: 28, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.938 Vali Acc: 0.675 Test Loss: 0.938 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 29 cost time: 1.2287876605987549
Epoch: 29, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.931 Vali Acc: 0.675 Test Loss: 0.931 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 1.2749404907226562
Epoch: 30, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.931 Vali Acc: 0.650 Test Loss: 0.931 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4297287464141846
Epoch: 31, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.928 Vali Acc: 0.650 Test Loss: 0.928 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3526833057403564
Epoch: 32, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.921 Vali Acc: 0.650 Test Loss: 0.921 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2947280406951904
Epoch: 33, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.912 Vali Acc: 0.675 Test Loss: 0.912 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 34 cost time: 1.2184832096099854
Epoch: 34, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.902 Vali Acc: 0.675 Test Loss: 0.902 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 35 cost time: 1.2245182991027832
Epoch: 35, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.891 Vali Acc: 0.675 Test Loss: 0.891 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 36 cost time: 1.309826374053955
Epoch: 36, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.884 Vali Acc: 0.675 Test Loss: 0.884 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 37 cost time: 1.2424190044403076
Epoch: 37, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.875 Vali Acc: 0.700 Test Loss: 0.875 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 38 cost time: 1.2425787448883057
Epoch: 38, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.871 Vali Acc: 0.700 Test Loss: 0.871 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 39 cost time: 1.3660483360290527
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.869 Vali Acc: 0.700 Test Loss: 0.869 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 40 cost time: 1.3499855995178223
Epoch: 40, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.868 Vali Acc: 0.700 Test Loss: 0.868 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 41 cost time: 1.2410566806793213
Epoch: 41, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.863 Vali Acc: 0.700 Test Loss: 0.863 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 1.2510759830474854
Epoch: 42, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.853 Vali Acc: 0.700 Test Loss: 0.853 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 43 cost time: 1.2400884628295898
Epoch: 43, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.842 Vali Acc: 0.725 Test Loss: 0.842 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724992).  Saving model ...
Epoch: 44 cost time: 1.332897424697876
Epoch: 44, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.835 Vali Acc: 0.725 Test Loss: 0.835 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 45 cost time: 1.312485694885254
Epoch: 45, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.827 Vali Acc: 0.725 Test Loss: 0.827 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 46 cost time: 1.2323784828186035
Epoch: 46, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.822 Vali Acc: 0.750 Test Loss: 0.822 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 47 cost time: 1.2909083366394043
Epoch: 47, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 48 cost time: 1.4336178302764893
Epoch: 48, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 1.280670404434204
Epoch: 49, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 50 cost time: 1.2040958404541016
Epoch: 50, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 51 cost time: 1.3093183040618896
Epoch: 51, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.811 Vali Acc: 0.775 Test Loss: 0.811 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 52 cost time: 1.2488739490509033
Epoch: 52, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.812 Vali Acc: 0.775 Test Loss: 0.812 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3747012615203857
Epoch: 53, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2479467391967773
Epoch: 54, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.3224010467529297
Epoch: 55, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1860930919647217
Epoch: 56, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.3185243606567383
Epoch: 57, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2939612865447998
Epoch: 58, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.2051661014556885
Epoch: 59, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.811 Vali Acc: 0.750 Test Loss: 0.811 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.2675871849060059
Epoch: 60, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.3688733577728271
Epoch: 61, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.55092191696167
Epoch: 1, Steps: 3 | Train Loss: 1.494 Vali Loss: 1.521 Vali Acc: 0.200 Test Loss: 1.521 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.3482697010040283
Epoch: 2, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.519 Vali Acc: 0.200 Test Loss: 1.519 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 1.1012585163116455
Epoch: 3, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.513 Vali Acc: 0.200 Test Loss: 1.513 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 1.1674532890319824
Epoch: 4, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.506 Vali Acc: 0.200 Test Loss: 1.506 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 1.0964012145996094
Epoch: 5, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.496 Vali Acc: 0.150 Test Loss: 1.496 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0831596851348877
Epoch: 6, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.488 Vali Acc: 0.150 Test Loss: 1.488 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1510446071624756
Epoch: 7, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.484 Vali Acc: 0.150 Test Loss: 1.484 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1208248138427734
Epoch: 8, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.476 Vali Acc: 0.150 Test Loss: 1.476 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0867369174957275
Epoch: 9, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.468 Vali Acc: 0.200 Test Loss: 1.468 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 10 cost time: 1.1279997825622559
Epoch: 10, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.466 Vali Acc: 0.200 Test Loss: 1.466 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 11 cost time: 1.1541826725006104
Epoch: 11, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.460 Vali Acc: 0.175 Test Loss: 1.460 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1048409938812256
Epoch: 12, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.455 Vali Acc: 0.225 Test Loss: 1.455 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 13 cost time: 1.2140450477600098
Epoch: 13, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.450 Vali Acc: 0.225 Test Loss: 1.450 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224986).  Saving model ...
Epoch: 14 cost time: 1.3484959602355957
Epoch: 14, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.441 Vali Acc: 0.225 Test Loss: 1.441 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 15 cost time: 1.2034945487976074
Epoch: 15, Steps: 3 | Train Loss: 0.802 Vali Loss: 1.437 Vali Acc: 0.250 Test Loss: 1.437 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.053748607635498
Epoch: 16, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.436 Vali Acc: 0.250 Test Loss: 1.436 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 17 cost time: 1.2705819606781006
Epoch: 17, Steps: 3 | Train Loss: 0.668 Vali Loss: 1.435 Vali Acc: 0.250 Test Loss: 1.435 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 18 cost time: 1.0666468143463135
Epoch: 18, Steps: 3 | Train Loss: 0.634 Vali Loss: 1.439 Vali Acc: 0.250 Test Loss: 1.439 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1877162456512451
Epoch: 19, Steps: 3 | Train Loss: 0.620 Vali Loss: 1.439 Vali Acc: 0.250 Test Loss: 1.439 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.062619686126709
Epoch: 20, Steps: 3 | Train Loss: 0.496 Vali Loss: 1.440 Vali Acc: 0.275 Test Loss: 1.440 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 21 cost time: 1.244457483291626
Epoch: 21, Steps: 3 | Train Loss: 0.520 Vali Loss: 1.446 Vali Acc: 0.250 Test Loss: 1.446 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2665317058563232
Epoch: 22, Steps: 3 | Train Loss: 0.462 Vali Loss: 1.448 Vali Acc: 0.250 Test Loss: 1.448 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1749868392944336
Epoch: 23, Steps: 3 | Train Loss: 0.399 Vali Loss: 1.451 Vali Acc: 0.250 Test Loss: 1.451 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.145552158355713
Epoch: 24, Steps: 3 | Train Loss: 0.396 Vali Loss: 1.460 Vali Acc: 0.250 Test Loss: 1.460 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2795348167419434
Epoch: 25, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299985).  Saving model ...
Epoch: 26 cost time: 1.2243266105651855
Epoch: 26, Steps: 3 | Train Loss: 0.294 Vali Loss: 1.449 Vali Acc: 0.300 Test Loss: 1.449 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 27 cost time: 1.270341157913208
Epoch: 27, Steps: 3 | Train Loss: 0.273 Vali Loss: 1.449 Vali Acc: 0.325 Test Loss: 1.449 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 28 cost time: 1.3146309852600098
Epoch: 28, Steps: 3 | Train Loss: 0.242 Vali Loss: 1.457 Vali Acc: 0.325 Test Loss: 1.457 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2065930366516113
Epoch: 29, Steps: 3 | Train Loss: 0.239 Vali Loss: 1.448 Vali Acc: 0.300 Test Loss: 1.448 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3242321014404297
Epoch: 30, Steps: 3 | Train Loss: 0.226 Vali Loss: 1.449 Vali Acc: 0.325 Test Loss: 1.449 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1995720863342285
Epoch: 31, Steps: 3 | Train Loss: 0.173 Vali Loss: 1.426 Vali Acc: 0.325 Test Loss: 1.426 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 32 cost time: 1.2235665321350098
Epoch: 32, Steps: 3 | Train Loss: 0.190 Vali Loss: 1.410 Vali Acc: 0.325 Test Loss: 1.410 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 33 cost time: 1.172147274017334
Epoch: 33, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.414 Vali Acc: 0.350 Test Loss: 1.414 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 34 cost time: 1.3478286266326904
Epoch: 34, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.442 Vali Acc: 0.325 Test Loss: 1.442 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2845942974090576
Epoch: 35, Steps: 3 | Train Loss: 0.107 Vali Loss: 1.451 Vali Acc: 0.350 Test Loss: 1.451 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3376002311706543
Epoch: 36, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.468 Vali Acc: 0.325 Test Loss: 1.468 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1259877681732178
Epoch: 37, Steps: 3 | Train Loss: 0.116 Vali Loss: 1.485 Vali Acc: 0.350 Test Loss: 1.485 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.230027437210083
Epoch: 38, Steps: 3 | Train Loss: 0.097 Vali Loss: 1.489 Vali Acc: 0.350 Test Loss: 1.489 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2370765209197998
Epoch: 39, Steps: 3 | Train Loss: 0.072 Vali Loss: 1.502 Vali Acc: 0.350 Test Loss: 1.502 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1286609172821045
Epoch: 40, Steps: 3 | Train Loss: 0.078 Vali Loss: 1.517 Vali Acc: 0.350 Test Loss: 1.517 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1755523681640625
Epoch: 41, Steps: 3 | Train Loss: 0.062 Vali Loss: 1.520 Vali Acc: 0.350 Test Loss: 1.520 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1056928634643555
Epoch: 42, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.532 Vali Acc: 0.325 Test Loss: 1.532 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1130831241607666
Epoch: 43, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.516 Vali Acc: 0.350 Test Loss: 1.516 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.35
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.31351900100708
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.518 Vali Acc: 0.300 Test Loss: 1.518 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.2282519340515137
Epoch: 2, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.514 Vali Acc: 0.300 Test Loss: 1.514 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.1148016452789307
Epoch: 3, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.506 Vali Acc: 0.275 Test Loss: 1.506 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2349247932434082
Epoch: 4, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.494 Vali Acc: 0.275 Test Loss: 1.494 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1950321197509766
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.479 Vali Acc: 0.225 Test Loss: 1.479 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2365055084228516
Epoch: 6, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.465 Vali Acc: 0.250 Test Loss: 1.465 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.140190601348877
Epoch: 7, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.454 Vali Acc: 0.275 Test Loss: 1.454 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1734199523925781
Epoch: 8, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.441 Vali Acc: 0.325 Test Loss: 1.441 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 1.3548860549926758
Epoch: 9, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.429 Vali Acc: 0.325 Test Loss: 1.429 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 10 cost time: 1.2679426670074463
Epoch: 10, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.422 Vali Acc: 0.325 Test Loss: 1.422 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 11 cost time: 1.2947678565979004
Epoch: 11, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.412 Vali Acc: 0.325 Test Loss: 1.412 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 12 cost time: 1.209824562072754
Epoch: 12, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.399 Vali Acc: 0.375 Test Loss: 1.399 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 13 cost time: 1.1789703369140625
Epoch: 13, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.388 Vali Acc: 0.375 Test Loss: 1.388 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 14 cost time: 1.304481029510498
Epoch: 14, Steps: 3 | Train Loss: 0.837 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 15 cost time: 1.281832218170166
Epoch: 15, Steps: 3 | Train Loss: 0.803 Vali Loss: 1.352 Vali Acc: 0.375 Test Loss: 1.352 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 16 cost time: 1.286623477935791
Epoch: 16, Steps: 3 | Train Loss: 0.771 Vali Loss: 1.339 Vali Acc: 0.350 Test Loss: 1.339 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.465667963027954
Epoch: 17, Steps: 3 | Train Loss: 0.691 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 18 cost time: 1.4120309352874756
Epoch: 18, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.310 Vali Acc: 0.375 Test Loss: 1.310 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 19 cost time: 1.2157950401306152
Epoch: 19, Steps: 3 | Train Loss: 0.577 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 20 cost time: 1.3712997436523438
Epoch: 20, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.290 Vali Acc: 0.375 Test Loss: 1.290 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 21 cost time: 1.2070810794830322
Epoch: 21, Steps: 3 | Train Loss: 0.468 Vali Loss: 1.284 Vali Acc: 0.375 Test Loss: 1.284 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 22 cost time: 1.205195665359497
Epoch: 22, Steps: 3 | Train Loss: 0.480 Vali Loss: 1.273 Vali Acc: 0.350 Test Loss: 1.273 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.344719409942627
Epoch: 23, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.259 Vali Acc: 0.350 Test Loss: 1.259 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2934131622314453
Epoch: 24, Steps: 3 | Train Loss: 0.331 Vali Loss: 1.256 Vali Acc: 0.375 Test Loss: 1.256 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 25 cost time: 1.1491940021514893
Epoch: 25, Steps: 3 | Train Loss: 0.351 Vali Loss: 1.238 Vali Acc: 0.350 Test Loss: 1.238 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.34016752243042
Epoch: 26, Steps: 3 | Train Loss: 0.301 Vali Loss: 1.226 Vali Acc: 0.375 Test Loss: 1.226 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 27 cost time: 1.1605634689331055
Epoch: 27, Steps: 3 | Train Loss: 0.256 Vali Loss: 1.220 Vali Acc: 0.375 Test Loss: 1.220 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374988).  Saving model ...
Epoch: 28 cost time: 1.2046394348144531
Epoch: 28, Steps: 3 | Train Loss: 0.235 Vali Loss: 1.225 Vali Acc: 0.375 Test Loss: 1.225 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.193450927734375
Epoch: 29, Steps: 3 | Train Loss: 0.216 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 30 cost time: 1.1989645957946777
Epoch: 30, Steps: 3 | Train Loss: 0.216 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0264275074005127
Epoch: 31, Steps: 3 | Train Loss: 0.181 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 32 cost time: 1.1039831638336182
Epoch: 32, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.163 Vali Acc: 0.425 Test Loss: 1.163 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 33 cost time: 1.0893797874450684
Epoch: 33, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.163 Vali Acc: 0.425 Test Loss: 1.163 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 34 cost time: 1.0488886833190918
Epoch: 34, Steps: 3 | Train Loss: 0.145 Vali Loss: 1.173 Vali Acc: 0.425 Test Loss: 1.173 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0637876987457275
Epoch: 35, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.170 Vali Acc: 0.450 Test Loss: 1.170 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 36 cost time: 1.3427276611328125
Epoch: 36, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.183 Vali Acc: 0.425 Test Loss: 1.183 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1409454345703125
Epoch: 37, Steps: 3 | Train Loss: 0.117 Vali Loss: 1.200 Vali Acc: 0.425 Test Loss: 1.200 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1299874782562256
Epoch: 38, Steps: 3 | Train Loss: 0.098 Vali Loss: 1.195 Vali Acc: 0.425 Test Loss: 1.195 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2318673133850098
Epoch: 39, Steps: 3 | Train Loss: 0.092 Vali Loss: 1.193 Vali Acc: 0.425 Test Loss: 1.193 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.241509199142456
Epoch: 40, Steps: 3 | Train Loss: 0.075 Vali Loss: 1.211 Vali Acc: 0.425 Test Loss: 1.211 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.232649326324463
Epoch: 41, Steps: 3 | Train Loss: 0.064 Vali Loss: 1.208 Vali Acc: 0.425 Test Loss: 1.208 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.284877061843872
Epoch: 42, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.208 Vali Acc: 0.425 Test Loss: 1.208 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.333481788635254
Epoch: 43, Steps: 3 | Train Loss: 0.066 Vali Loss: 1.190 Vali Acc: 0.450 Test Loss: 1.190 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2095012664794922
Epoch: 44, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 45 cost time: 1.1434664726257324
Epoch: 45, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 46 cost time: 1.1719026565551758
Epoch: 46, Steps: 3 | Train Loss: 0.052 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 47 cost time: 1.416538953781128
Epoch: 47, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 48 cost time: 1.3290090560913086
Epoch: 48, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3771395683288574
Epoch: 49, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.3880205154418945
Epoch: 50, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2555382251739502
Epoch: 51, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.27315092086792
Epoch: 52, Steps: 3 | Train Loss: 0.028 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.157757043838501
Epoch: 53, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.3226540088653564
Epoch: 54, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.297593355178833
Epoch: 55, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.418956995010376
Epoch: 56, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.236905574798584
Epoch: 57, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.5
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.836981773376465
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1471199989318848
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.27541184425354
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.1192619800567627
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.2744667530059814
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.2223331928253174
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2332417964935303
Epoch: 7, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.165724754333496
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1041488647460938
Epoch: 9, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3012871742248535
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.197385549545288
Epoch: 11, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.186689853668213
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.134326696395874
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.1973233222961426
Epoch: 14, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.1196208000183105
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.10929274559021
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 17 cost time: 1.132997751235962
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 18 cost time: 1.1949059963226318
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 19 cost time: 1.2321717739105225
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 20 cost time: 1.2953946590423584
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 21 cost time: 1.1890535354614258
Epoch: 21, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 22 cost time: 1.2010562419891357
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 23 cost time: 1.2161898612976074
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.3642559051513672
Epoch: 24, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.348332166671753
Epoch: 25, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1948039531707764
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1930441856384277
Epoch: 27, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.236274242401123
Epoch: 28, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.254314661026001
Epoch: 29, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.231902837753296
Epoch: 30, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1529195308685303
Epoch: 31, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1619758605957031
Epoch: 32, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3851876258850098
Epoch: 33, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 34 cost time: 1.4127395153045654
Epoch: 34, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 35 cost time: 1.3546473979949951
Epoch: 35, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 36 cost time: 1.2582018375396729
Epoch: 36, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 37 cost time: 1.1546454429626465
Epoch: 37, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 38 cost time: 1.1885638236999512
Epoch: 38, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 39 cost time: 1.163912057876587
Epoch: 39, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 40 cost time: 1.09543776512146
Epoch: 40, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1638572216033936
Epoch: 41, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.20491361618042
Epoch: 42, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1599788665771484
Epoch: 43, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 44 cost time: 1.280665636062622
Epoch: 44, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.270918846130371
Epoch: 45, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.162536859512329
Epoch: 46, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2126765251159668
Epoch: 47, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1295881271362305
Epoch: 48, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1434381008148193
Epoch: 49, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2613236904144287
Epoch: 50, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2776050567626953
Epoch: 51, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.1884956359863281
Epoch: 52, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.2545738220214844
Epoch: 53, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 228548
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4220938682556152
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.428 Vali Acc: 0.200 Test Loss: 1.428 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.160130262374878
Epoch: 2, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.401 Vali Acc: 0.250 Test Loss: 1.401 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2567038536071777
Epoch: 3, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.366 Vali Acc: 0.325 Test Loss: 1.366 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.2160029411315918
Epoch: 4, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.3172566890716553
Epoch: 5, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.3164255619049072
Epoch: 6, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.215 Vali Acc: 0.575 Test Loss: 1.215 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 1.325594425201416
Epoch: 7, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 1.2118585109710693
Epoch: 8, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.4009175300598145
Epoch: 9, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.040 Vali Acc: 0.700 Test Loss: 1.040 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.2475862503051758
Epoch: 10, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.986 Vali Acc: 0.750 Test Loss: 0.986 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 1.2745513916015625
Epoch: 11, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.935 Vali Acc: 0.750 Test Loss: 0.935 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 12 cost time: 1.3096923828125
Epoch: 12, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.3237285614013672
Epoch: 13, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 1.3024520874023438
Epoch: 14, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 1.1802704334259033
Epoch: 15, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 1.3036377429962158
Epoch: 16, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
Validation loss decreased (-0.749993 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.358659029006958
Epoch: 17, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.458477258682251
Epoch: 18, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 19 cost time: 1.262516736984253
Epoch: 19, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 1.1730015277862549
Epoch: 20, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 1.2926595211029053
Epoch: 21, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 1.3983039855957031
Epoch: 22, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 1.2261366844177246
Epoch: 23, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 1.198237657546997
Epoch: 24, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 1.2448396682739258
Epoch: 25, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 1.2382216453552246
Epoch: 26, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.492 Vali Acc: 0.875 Test Loss: 0.492 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 1.269714117050171
Epoch: 27, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 1.1544182300567627
Epoch: 28, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 1.1991558074951172
Epoch: 29, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 30 cost time: 1.3937883377075195
Epoch: 30, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 31 cost time: 1.167022466659546
Epoch: 31, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.425 Vali Acc: 0.875 Test Loss: 0.425 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 32 cost time: 1.3557145595550537
Epoch: 32, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.415 Vali Acc: 0.875 Test Loss: 0.415 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 33 cost time: 1.144883632659912
Epoch: 33, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 34 cost time: 1.1574106216430664
Epoch: 34, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 35 cost time: 1.1803293228149414
Epoch: 35, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 36 cost time: 1.1973156929016113
Epoch: 36, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 37 cost time: 1.3448870182037354
Epoch: 37, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 1.2760045528411865
Epoch: 38, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 1.2360997200012207
Epoch: 39, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 40 cost time: 1.181443452835083
Epoch: 40, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 1.3290355205535889
Epoch: 41, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.361 Vali Acc: 0.875 Test Loss: 0.361 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2341101169586182
Epoch: 42, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 1.2895715236663818
Epoch: 43, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 1.3110392093658447
Epoch: 44, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 1.3179798126220703
Epoch: 45, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 1.278616189956665
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 1.2598528861999512
Epoch: 47, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 48 cost time: 1.2113783359527588
Epoch: 48, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 49 cost time: 1.2711093425750732
Epoch: 49, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 1.1857216358184814
Epoch: 50, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 51 cost time: 1.3270974159240723
Epoch: 51, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3590898513793945
Epoch: 52, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.212970495223999
Epoch: 53, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2762794494628906
Epoch: 54, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1807243824005127
Epoch: 55, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.1634900569915771
Epoch: 56, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2608897686004639
Epoch: 57, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2085294723510742
Epoch: 58, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.2556335926055908
Epoch: 59, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.0783424377441406
Epoch: 60, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3405203819274902
Epoch: 1, Steps: 3 | Train Loss: 1.491 Vali Loss: 1.424 Vali Acc: 0.175 Test Loss: 1.424 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.2644870281219482
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.398 Vali Acc: 0.275 Test Loss: 1.398 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.2611045837402344
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.361 Vali Acc: 0.425 Test Loss: 1.361 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 1.1664044857025146
Epoch: 4, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.34975266456604
Epoch: 5, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.392392635345459
Epoch: 6, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.206 Vali Acc: 0.550 Test Loss: 1.206 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 1.2155423164367676
Epoch: 7, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 1.3824028968811035
Epoch: 8, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.088 Vali Acc: 0.625 Test Loss: 1.088 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.2863929271697998
Epoch: 9, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.027 Vali Acc: 0.650 Test Loss: 1.027 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 1.2137515544891357
Epoch: 10, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.971 Vali Acc: 0.700 Test Loss: 0.971 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 11 cost time: 1.341184377670288
Epoch: 11, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.916 Vali Acc: 0.725 Test Loss: 0.916 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 12 cost time: 1.2874531745910645
Epoch: 12, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.861 Vali Acc: 0.725 Test Loss: 0.861 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 1.2437477111816406
Epoch: 13, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.810 Vali Acc: 0.800 Test Loss: 0.810 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.1691641807556152
Epoch: 14, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.1127674579620361
Epoch: 15, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.711 Vali Acc: 0.825 Test Loss: 0.711 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 1.1402719020843506
Epoch: 16, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.671 Vali Acc: 0.850 Test Loss: 0.671 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.201399564743042
Epoch: 17, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 1.0986475944519043
Epoch: 18, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 1.1333179473876953
Epoch: 19, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 1.1139287948608398
Epoch: 20, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 1.1981735229492188
Epoch: 21, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 1.1079339981079102
Epoch: 22, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.1908657550811768
Epoch: 23, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.0922126770019531
Epoch: 24, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.506 Vali Acc: 0.900 Test Loss: 0.506 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 1.047551155090332
Epoch: 25, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.1681175231933594
Epoch: 26, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.2476654052734375
Epoch: 27, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.1786236763000488
Epoch: 28, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.125758171081543
Epoch: 29, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.2464141845703125
Epoch: 30, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 1.1504640579223633
Epoch: 31, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.2285776138305664
Epoch: 32, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.119499921798706
Epoch: 33, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.1980259418487549
Epoch: 34, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 1.1739559173583984
Epoch: 35, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.372 Vali Acc: 0.925 Test Loss: 0.372 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.1514899730682373
Epoch: 36, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.3080005645751953
Epoch: 37, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.1603853702545166
Epoch: 38, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.12717866897583
Epoch: 39, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.314774751663208
Epoch: 40, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 1.3693304061889648
Epoch: 41, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 1.2285270690917969
Epoch: 42, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 1.304685115814209
Epoch: 43, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 1.289435625076294
Epoch: 44, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 1.317676305770874
Epoch: 45, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 1.2320466041564941
Epoch: 46, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 47 cost time: 1.2458136081695557
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 48 cost time: 1.231299877166748
Epoch: 48, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 49 cost time: 1.2888176441192627
Epoch: 49, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 1.3224916458129883
Epoch: 50, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 51 cost time: 1.2712619304656982
Epoch: 51, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 1.2996959686279297
Epoch: 52, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 1.3106234073638916
Epoch: 53, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 54 cost time: 1.1339640617370605
Epoch: 54, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 55 cost time: 1.2291672229766846
Epoch: 55, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 56 cost time: 1.364187240600586
Epoch: 56, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 1.3042173385620117
Epoch: 57, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 1.2297086715698242
Epoch: 58, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 1.2264900207519531
Epoch: 59, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 60 cost time: 1.194650411605835
Epoch: 60, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 1.4563608169555664
Epoch: 61, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.5387775897979736
Epoch: 62, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 63 cost time: 1.1751916408538818
Epoch: 63, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 64 cost time: 1.209787368774414
Epoch: 64, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 65 cost time: 1.205470323562622
Epoch: 65, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 66 cost time: 1.1747946739196777
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 67 cost time: 1.3266205787658691
Epoch: 67, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 68 cost time: 1.252816915512085
Epoch: 68, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 69 cost time: 1.2344825267791748
Epoch: 69, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 70 cost time: 1.2433068752288818
Epoch: 70, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 71 cost time: 1.2891845703125
Epoch: 71, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.251582145690918
Epoch: 72, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.268099308013916
Epoch: 73, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.3580853939056396
Epoch: 74, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.3079521656036377
Epoch: 75, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 76 cost time: 1.2442781925201416
Epoch: 76, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 77 cost time: 1.3294317722320557
Epoch: 77, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 78 cost time: 1.2820358276367188
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 79 cost time: 1.356344223022461
Epoch: 79, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 80 cost time: 1.2351460456848145
Epoch: 80, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 81 cost time: 1.3875153064727783
Epoch: 81, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 82 cost time: 1.2184555530548096
Epoch: 82, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 83 cost time: 1.2677762508392334
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 84 cost time: 1.250401496887207
Epoch: 84, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 85 cost time: 1.3796372413635254
Epoch: 85, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 86 cost time: 1.305762529373169
Epoch: 86, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 87 cost time: 1.2895629405975342
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 88 cost time: 1.1940784454345703
Epoch: 88, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 89 cost time: 1.2986953258514404
Epoch: 89, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 90 cost time: 1.2038826942443848
Epoch: 90, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 91 cost time: 1.113194465637207
Epoch: 91, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 92 cost time: 1.1070449352264404
Epoch: 92, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.1460044384002686
Epoch: 93, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 94 cost time: 1.2321608066558838
Epoch: 94, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 95 cost time: 1.1923527717590332
Epoch: 95, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 96 cost time: 1.1813530921936035
Epoch: 96, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 97 cost time: 1.185615062713623
Epoch: 97, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 98 cost time: 1.1196935176849365
Epoch: 98, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 99 cost time: 1.2690656185150146
Epoch: 99, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.246612310409546
Epoch: 100, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.398422956466675
Epoch: 1, Steps: 3 | Train Loss: 1.515 Vali Loss: 1.397 Vali Acc: 0.150 Test Loss: 1.397 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 1.2739644050598145
Epoch: 2, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.365 Vali Acc: 0.225 Test Loss: 1.365 Test Acc: 0.225
Validation loss decreased (-0.149986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 1.1584265232086182
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.224986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.1702783107757568
Epoch: 4, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.1443068981170654
Epoch: 5, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.219 Vali Acc: 0.550 Test Loss: 1.219 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.1751022338867188
Epoch: 6, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.164 Vali Acc: 0.575 Test Loss: 1.164 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 1.4171035289764404
Epoch: 7, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.107 Vali Acc: 0.575 Test Loss: 1.107 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 1.1818008422851562
Epoch: 8, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.053 Vali Acc: 0.675 Test Loss: 1.053 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 1.1479368209838867
Epoch: 9, Steps: 3 | Train Loss: 0.898 Vali Loss: 0.997 Vali Acc: 0.750 Test Loss: 0.997 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 1.1689069271087646
Epoch: 10, Steps: 3 | Train Loss: 0.809 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 1.2281007766723633
Epoch: 11, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.1983497142791748
Epoch: 12, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 1.2230339050292969
Epoch: 13, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 1.2077324390411377
Epoch: 14, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 1.2376492023468018
Epoch: 15, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.711 Vali Acc: 0.875 Test Loss: 0.711 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 1.166536569595337
Epoch: 16, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.673 Vali Acc: 0.900 Test Loss: 0.673 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 1.2225985527038574
Epoch: 17, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 1.0915603637695312
Epoch: 18, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 1.1861913204193115
Epoch: 19, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.592 Vali Acc: 0.925 Test Loss: 0.592 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 1.1383006572723389
Epoch: 20, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.578 Vali Acc: 0.900 Test Loss: 0.578 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2109713554382324
Epoch: 21, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.564 Vali Acc: 0.900 Test Loss: 0.564 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2157933712005615
Epoch: 22, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 1.1408178806304932
Epoch: 23, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 1.125476598739624
Epoch: 24, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 1.1504580974578857
Epoch: 25, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.512 Vali Acc: 0.925 Test Loss: 0.512 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 1.1334054470062256
Epoch: 26, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.502 Vali Acc: 0.925 Test Loss: 0.502 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.146127700805664
Epoch: 27, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.489 Vali Acc: 0.925 Test Loss: 0.489 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.1577703952789307
Epoch: 28, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 1.0796847343444824
Epoch: 29, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.1145291328430176
Epoch: 30, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 1.2184381484985352
Epoch: 31, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.2157771587371826
Epoch: 32, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.2804467678070068
Epoch: 33, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.2875852584838867
Epoch: 34, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 1.137376070022583
Epoch: 35, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.143857479095459
Epoch: 36, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.1388282775878906
Epoch: 37, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.1775140762329102
Epoch: 38, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.2061407566070557
Epoch: 39, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.2209258079528809
Epoch: 40, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.2957751750946045
Epoch: 41, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 1.231449842453003
Epoch: 42, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 1.2364156246185303
Epoch: 43, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 1.2985725402832031
Epoch: 44, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 1.2493746280670166
Epoch: 45, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 1.3127007484436035
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 1.3187072277069092
Epoch: 47, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 1.4635190963745117
Epoch: 48, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 1.252436637878418
Epoch: 49, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 1.400254726409912
Epoch: 50, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 1.287832498550415
Epoch: 51, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 1.120565414428711
Epoch: 52, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 1.1939494609832764
Epoch: 53, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 1.2561924457550049
Epoch: 54, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 1.1128623485565186
Epoch: 55, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 1.1548326015472412
Epoch: 56, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 1.1975367069244385
Epoch: 57, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 1.0882511138916016
Epoch: 58, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 1.26505708694458
Epoch: 59, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 60 cost time: 1.1880602836608887
Epoch: 60, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 1.2951428890228271
Epoch: 61, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 62 cost time: 1.0799932479858398
Epoch: 62, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.043252944946289
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.0614724159240723
Epoch: 64, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 65 cost time: 1.2843925952911377
Epoch: 65, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 66 cost time: 1.1097681522369385
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 67 cost time: 1.2513630390167236
Epoch: 67, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 68 cost time: 1.1804728507995605
Epoch: 68, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 69 cost time: 1.327380895614624
Epoch: 69, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 70 cost time: 1.106421709060669
Epoch: 70, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 71 cost time: 1.1971676349639893
Epoch: 71, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 72 cost time: 1.2288401126861572
Epoch: 72, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 73 cost time: 1.1334388256072998
Epoch: 73, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 74 cost time: 1.2747223377227783
Epoch: 74, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 75 cost time: 1.2291531562805176
Epoch: 75, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 76 cost time: 1.191448450088501
Epoch: 76, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 77 cost time: 1.1880526542663574
Epoch: 77, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 78 cost time: 1.190401554107666
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 79 cost time: 1.3319785594940186
Epoch: 79, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 80 cost time: 1.389235019683838
Epoch: 80, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 81 cost time: 1.2296464443206787
Epoch: 81, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 82 cost time: 1.2441966533660889
Epoch: 82, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 83 cost time: 1.2260894775390625
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 84 cost time: 1.3937757015228271
Epoch: 84, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 85 cost time: 1.200453519821167
Epoch: 85, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 86 cost time: 1.3458960056304932
Epoch: 86, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 87 cost time: 1.2811942100524902
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 88 cost time: 1.2766845226287842
Epoch: 88, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.3046703338623047
Epoch: 89, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.1257245540618896
Epoch: 90, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 91 cost time: 1.1554250717163086
Epoch: 91, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 92 cost time: 1.314664602279663
Epoch: 92, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 93 cost time: 1.2221429347991943
Epoch: 93, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 94 cost time: 1.1264429092407227
Epoch: 94, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 95 cost time: 1.1289544105529785
Epoch: 95, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 96 cost time: 1.2862377166748047
Epoch: 96, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 97 cost time: 1.1290595531463623
Epoch: 97, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 98 cost time: 1.2159738540649414
Epoch: 98, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 99 cost time: 1.2437684535980225
Epoch: 99, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.1301958560943604
Epoch: 100, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.555441379547119
Epoch: 1, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.326 Vali Acc: 0.425 Test Loss: 1.326 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 1.2719755172729492
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.300 Vali Acc: 0.425 Test Loss: 1.300 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 1.239363670349121
Epoch: 3, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.265 Vali Acc: 0.475 Test Loss: 1.265 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 1.2885725498199463
Epoch: 4, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.220 Vali Acc: 0.525 Test Loss: 1.220 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.3935284614562988
Epoch: 5, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.169 Vali Acc: 0.550 Test Loss: 1.169 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 1.323845624923706
Epoch: 6, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.115 Vali Acc: 0.575 Test Loss: 1.115 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 1.1943519115447998
Epoch: 7, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.058 Vali Acc: 0.625 Test Loss: 1.058 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.141770601272583
Epoch: 8, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 1.1944115161895752
Epoch: 9, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 1.3269891738891602
Epoch: 10, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.900 Vali Acc: 0.775 Test Loss: 0.900 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 1.2190067768096924
Epoch: 11, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.855 Vali Acc: 0.775 Test Loss: 0.855 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.1977307796478271
Epoch: 12, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 13 cost time: 1.2270872592926025
Epoch: 13, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 1.3506736755371094
Epoch: 14, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 15 cost time: 1.2456529140472412
Epoch: 15, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 16 cost time: 1.1746411323547363
Epoch: 16, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.675 Vali Acc: 0.775 Test Loss: 0.675 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 17 cost time: 1.2934398651123047
Epoch: 17, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.330137014389038
Epoch: 18, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2965469360351562
Epoch: 19, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.153745412826538
Epoch: 20, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.366915225982666
Epoch: 21, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3557214736938477
Epoch: 22, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3799619674682617
Epoch: 23, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1701674461364746
Epoch: 24, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 25 cost time: 1.1846263408660889
Epoch: 25, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.545 Vali Acc: 0.800 Test Loss: 0.545 Test Acc: 0.800
Validation loss decreased (-0.774994 --> -0.799995).  Saving model ...
Epoch: 26 cost time: 1.2057161331176758
Epoch: 26, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.535 Vali Acc: 0.800 Test Loss: 0.535 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 27 cost time: 1.1944875717163086
Epoch: 27, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.526 Vali Acc: 0.800 Test Loss: 0.526 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 28 cost time: 1.1584692001342773
Epoch: 28, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 29 cost time: 1.229787826538086
Epoch: 29, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.505 Vali Acc: 0.800 Test Loss: 0.505 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 30 cost time: 1.2108886241912842
Epoch: 30, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.493 Vali Acc: 0.800 Test Loss: 0.493 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 31 cost time: 1.2098345756530762
Epoch: 31, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 32 cost time: 1.164480447769165
Epoch: 32, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.468 Vali Acc: 0.825 Test Loss: 0.468 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 33 cost time: 1.1520140171051025
Epoch: 33, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.456 Vali Acc: 0.825 Test Loss: 0.456 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 34 cost time: 1.344219446182251
Epoch: 34, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849996).  Saving model ...
Epoch: 35 cost time: 1.4192438125610352
Epoch: 35, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 36 cost time: 1.296048641204834
Epoch: 36, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 37 cost time: 1.214266300201416
Epoch: 37, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 38 cost time: 1.1581215858459473
Epoch: 38, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 39 cost time: 1.247715711593628
Epoch: 39, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.416 Vali Acc: 0.875 Test Loss: 0.416 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 40 cost time: 1.2565698623657227
Epoch: 40, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 41 cost time: 1.2352190017700195
Epoch: 41, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.413 Vali Acc: 0.875 Test Loss: 0.413 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 42 cost time: 1.2637672424316406
Epoch: 42, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 1.2598254680633545
Epoch: 43, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.409 Vali Acc: 0.875 Test Loss: 0.409 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 44 cost time: 1.1568057537078857
Epoch: 44, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.407 Vali Acc: 0.875 Test Loss: 0.407 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 45 cost time: 1.2560153007507324
Epoch: 45, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.404 Vali Acc: 0.875 Test Loss: 0.404 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 46 cost time: 1.2144908905029297
Epoch: 46, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.400 Vali Acc: 0.875 Test Loss: 0.400 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 47 cost time: 1.2644438743591309
Epoch: 47, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.397 Vali Acc: 0.875 Test Loss: 0.397 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 48 cost time: 1.2118453979492188
Epoch: 48, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.394 Vali Acc: 0.875 Test Loss: 0.394 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 49 cost time: 1.2805442810058594
Epoch: 49, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.388 Vali Acc: 0.875 Test Loss: 0.388 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 50 cost time: 1.2703301906585693
Epoch: 50, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.382 Vali Acc: 0.875 Test Loss: 0.382 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 51 cost time: 1.2356796264648438
Epoch: 51, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.378 Vali Acc: 0.875 Test Loss: 0.378 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 52 cost time: 1.1749799251556396
Epoch: 52, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.373 Vali Acc: 0.875 Test Loss: 0.373 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 53 cost time: 1.2159795761108398
Epoch: 53, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 1.1850359439849854
Epoch: 54, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.364 Vali Acc: 0.875 Test Loss: 0.364 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 55 cost time: 1.1566317081451416
Epoch: 55, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.362 Vali Acc: 0.875 Test Loss: 0.362 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 56 cost time: 1.2378263473510742
Epoch: 56, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.359 Vali Acc: 0.875 Test Loss: 0.359 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 57 cost time: 1.198984146118164
Epoch: 57, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.357 Vali Acc: 0.875 Test Loss: 0.357 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 58 cost time: 1.2120707035064697
Epoch: 58, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.355 Vali Acc: 0.875 Test Loss: 0.355 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 59 cost time: 1.3049120903015137
Epoch: 59, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.354 Vali Acc: 0.875 Test Loss: 0.354 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 60 cost time: 1.1421971321105957
Epoch: 60, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.353 Vali Acc: 0.875 Test Loss: 0.353 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 61 cost time: 1.0838088989257812
Epoch: 61, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.351 Vali Acc: 0.875 Test Loss: 0.351 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 62 cost time: 1.1547484397888184
Epoch: 62, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.349 Vali Acc: 0.875 Test Loss: 0.349 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874997).  Saving model ...
Epoch: 63 cost time: 1.2539770603179932
Epoch: 63, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.346 Vali Acc: 0.875 Test Loss: 0.346 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 64 cost time: 1.1429505348205566
Epoch: 64, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.344 Vali Acc: 0.875 Test Loss: 0.344 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 65 cost time: 1.1613154411315918
Epoch: 65, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.875 Test Loss: 0.341 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 66 cost time: 1.1636309623718262
Epoch: 66, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.339 Vali Acc: 0.875 Test Loss: 0.339 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 67 cost time: 1.2708899974822998
Epoch: 67, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.337 Vali Acc: 0.875 Test Loss: 0.337 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 68 cost time: 1.2093703746795654
Epoch: 68, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.875 Test Loss: 0.335 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 69 cost time: 1.1906764507293701
Epoch: 69, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.875 Test Loss: 0.333 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 70 cost time: 1.2314136028289795
Epoch: 70, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.331 Vali Acc: 0.875 Test Loss: 0.331 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 71 cost time: 1.2487521171569824
Epoch: 71, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.875 Test Loss: 0.329 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 72 cost time: 1.1523113250732422
Epoch: 72, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.326 Vali Acc: 0.875 Test Loss: 0.326 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 73 cost time: 1.1130056381225586
Epoch: 73, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.875 Test Loss: 0.325 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 74 cost time: 1.2864007949829102
Epoch: 74, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.875 Test Loss: 0.324 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 75 cost time: 1.2043981552124023
Epoch: 75, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.875 Test Loss: 0.322 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 76 cost time: 1.2739744186401367
Epoch: 76, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.875 Test Loss: 0.321 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 77 cost time: 1.2065489292144775
Epoch: 77, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.320 Vali Acc: 0.875 Test Loss: 0.320 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 78 cost time: 1.2457897663116455
Epoch: 78, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.318 Vali Acc: 0.875 Test Loss: 0.318 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 79 cost time: 1.1889982223510742
Epoch: 79, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.316 Vali Acc: 0.875 Test Loss: 0.316 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 80 cost time: 1.1819944381713867
Epoch: 80, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.314 Vali Acc: 0.875 Test Loss: 0.314 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 81 cost time: 1.213529109954834
Epoch: 81, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.313 Vali Acc: 0.875 Test Loss: 0.313 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 82 cost time: 1.1677989959716797
Epoch: 82, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.312 Vali Acc: 0.875 Test Loss: 0.312 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 83 cost time: 1.2316625118255615
Epoch: 83, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.310 Vali Acc: 0.875 Test Loss: 0.310 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 84 cost time: 1.175227403640747
Epoch: 84, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.309 Vali Acc: 0.875 Test Loss: 0.309 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 85 cost time: 1.2016065120697021
Epoch: 85, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.307 Vali Acc: 0.875 Test Loss: 0.307 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 86 cost time: 1.196786880493164
Epoch: 86, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.306 Vali Acc: 0.875 Test Loss: 0.306 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 87 cost time: 1.186894416809082
Epoch: 87, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.875 Test Loss: 0.304 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 88 cost time: 1.2291183471679688
Epoch: 88, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.303 Vali Acc: 0.875 Test Loss: 0.303 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 89 cost time: 1.2440357208251953
Epoch: 89, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.302 Vali Acc: 0.875 Test Loss: 0.302 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 90 cost time: 1.3609585762023926
Epoch: 90, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.301 Vali Acc: 0.875 Test Loss: 0.301 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 91 cost time: 1.3065218925476074
Epoch: 91, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.300 Vali Acc: 0.875 Test Loss: 0.300 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 92 cost time: 1.3447425365447998
Epoch: 92, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.875 Test Loss: 0.299 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 93 cost time: 1.356095314025879
Epoch: 93, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.298 Vali Acc: 0.875 Test Loss: 0.298 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 94 cost time: 1.2643001079559326
Epoch: 94, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.875 Test Loss: 0.297 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 95 cost time: 1.2902312278747559
Epoch: 95, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.875 Test Loss: 0.296 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 96 cost time: 1.2784276008605957
Epoch: 96, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.295 Vali Acc: 0.875 Test Loss: 0.295 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 97 cost time: 1.2944059371948242
Epoch: 97, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.875 Test Loss: 0.294 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 98 cost time: 1.30495023727417
Epoch: 98, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.875 Test Loss: 0.293 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 99 cost time: 1.3420460224151611
Epoch: 99, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.292 Vali Acc: 0.875 Test Loss: 0.292 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
Epoch: 100 cost time: 1.2663614749908447
Epoch: 100, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.875 Test Loss: 0.291 Test Acc: 0.875
Validation loss decreased (-0.874997 --> -0.874997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3912978172302246
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.373 Vali Acc: 0.350 Test Loss: 1.373 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.274994134902954
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.348 Vali Acc: 0.350 Test Loss: 1.348 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.1920139789581299
Epoch: 3, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.2565422058105469
Epoch: 4, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.278 Vali Acc: 0.425 Test Loss: 1.278 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.3021013736724854
Epoch: 5, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.233 Vali Acc: 0.450 Test Loss: 1.233 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.3235883712768555
Epoch: 6, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.187 Vali Acc: 0.525 Test Loss: 1.187 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 1.226912021636963
Epoch: 7, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.138 Vali Acc: 0.575 Test Loss: 1.138 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 1.200242042541504
Epoch: 8, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.088 Vali Acc: 0.625 Test Loss: 1.088 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.3188753128051758
Epoch: 9, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 1.2100379467010498
Epoch: 10, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.995 Vali Acc: 0.725 Test Loss: 0.995 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 1.1667444705963135
Epoch: 11, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 1.121828317642212
Epoch: 12, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 1.207930564880371
Epoch: 13, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 1.1942839622497559
Epoch: 14, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2170493602752686
Epoch: 15, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.807 Vali Acc: 0.775 Test Loss: 0.807 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 1.2849161624908447
Epoch: 16, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 1.2009284496307373
Epoch: 17, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.737 Vali Acc: 0.800 Test Loss: 0.737 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.1927387714385986
Epoch: 18, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.704 Vali Acc: 0.800 Test Loss: 0.704 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 1.2002954483032227
Epoch: 19, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.681 Vali Acc: 0.800 Test Loss: 0.681 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 1.2570066452026367
Epoch: 20, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.2759308815002441
Epoch: 21, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.660 Vali Acc: 0.775 Test Loss: 0.660 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.298999547958374
Epoch: 22, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3539397716522217
Epoch: 23, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.412738561630249
Epoch: 24, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.269057273864746
Epoch: 25, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.601 Vali Acc: 0.775 Test Loss: 0.601 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2565009593963623
Epoch: 26, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.595 Vali Acc: 0.775 Test Loss: 0.595 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2473621368408203
Epoch: 27, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2291886806488037
Epoch: 28, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2326371669769287
Epoch: 29, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2348952293395996
Epoch: 30, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 31 cost time: 1.2024867534637451
Epoch: 31, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 32 cost time: 1.2813479900360107
Epoch: 32, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.534 Vali Acc: 0.825 Test Loss: 0.534 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 33 cost time: 1.1919159889221191
Epoch: 33, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 34 cost time: 1.28291916847229
Epoch: 34, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 1.2425925731658936
Epoch: 35, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.517 Vali Acc: 0.825 Test Loss: 0.517 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2451527118682861
Epoch: 36, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2659564018249512
Epoch: 37, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1871836185455322
Epoch: 38, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.539 Vali Acc: 0.825 Test Loss: 0.539 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2568857669830322
Epoch: 39, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2217962741851807
Epoch: 40, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.540 Vali Acc: 0.825 Test Loss: 0.540 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.20064377784729
Epoch: 41, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.539 Vali Acc: 0.800 Test Loss: 0.539 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2922139167785645
Epoch: 42, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2388195991516113
Epoch: 43, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.522 Vali Acc: 0.800 Test Loss: 0.522 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.320735216140747
Epoch: 44, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.516 Vali Acc: 0.800 Test Loss: 0.516 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3682847023010254
Epoch: 1, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.385 Vali Acc: 0.275 Test Loss: 1.385 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.2739415168762207
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.379 Vali Acc: 0.300 Test Loss: 1.379 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.2731876373291016
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.2770185470581055
Epoch: 4, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.355 Vali Acc: 0.350 Test Loss: 1.355 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.1563222408294678
Epoch: 5, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 1.201146125793457
Epoch: 6, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.3893976211547852
Epoch: 7, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.310 Vali Acc: 0.450 Test Loss: 1.310 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 1.2443602085113525
Epoch: 8, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.293 Vali Acc: 0.475 Test Loss: 1.293 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 1.3807663917541504
Epoch: 9, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.24367356300354
Epoch: 10, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.261 Vali Acc: 0.475 Test Loss: 1.261 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 11 cost time: 1.2563972473144531
Epoch: 11, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.309067726135254
Epoch: 12, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.3764739036560059
Epoch: 13, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.215 Vali Acc: 0.475 Test Loss: 1.215 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2431998252868652
Epoch: 14, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.197 Vali Acc: 0.475 Test Loss: 1.197 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.242037296295166
Epoch: 15, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.178 Vali Acc: 0.475 Test Loss: 1.178 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2725424766540527
Epoch: 16, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.161 Vali Acc: 0.475 Test Loss: 1.161 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.124943494796753
Epoch: 17, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 18 cost time: 1.1868879795074463
Epoch: 18, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.121 Vali Acc: 0.525 Test Loss: 1.121 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 19 cost time: 1.2003977298736572
Epoch: 19, Steps: 3 | Train Loss: 0.666 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 1.212209939956665
Epoch: 20, Steps: 3 | Train Loss: 0.566 Vali Loss: 1.089 Vali Acc: 0.575 Test Loss: 1.089 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 1.1871824264526367
Epoch: 21, Steps: 3 | Train Loss: 0.536 Vali Loss: 1.069 Vali Acc: 0.575 Test Loss: 1.069 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 22 cost time: 1.1500828266143799
Epoch: 22, Steps: 3 | Train Loss: 0.504 Vali Loss: 1.045 Vali Acc: 0.575 Test Loss: 1.045 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 23 cost time: 1.1741955280303955
Epoch: 23, Steps: 3 | Train Loss: 0.427 Vali Loss: 1.021 Vali Acc: 0.625 Test Loss: 1.021 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 1.1147613525390625
Epoch: 24, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.995 Vali Acc: 0.625 Test Loss: 0.995 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 25 cost time: 1.1883766651153564
Epoch: 25, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.970 Vali Acc: 0.625 Test Loss: 0.970 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 26 cost time: 1.092146396636963
Epoch: 26, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.947 Vali Acc: 0.650 Test Loss: 0.947 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 27 cost time: 1.1341924667358398
Epoch: 27, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.927 Vali Acc: 0.650 Test Loss: 0.927 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 28 cost time: 1.1531827449798584
Epoch: 28, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.910 Vali Acc: 0.675 Test Loss: 0.910 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 29 cost time: 1.2000210285186768
Epoch: 29, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.895 Vali Acc: 0.675 Test Loss: 0.895 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 1.1446070671081543
Epoch: 30, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.881 Vali Acc: 0.675 Test Loss: 0.881 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 31 cost time: 1.1991939544677734
Epoch: 31, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.864 Vali Acc: 0.675 Test Loss: 0.864 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 32 cost time: 1.0758748054504395
Epoch: 32, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.853 Vali Acc: 0.675 Test Loss: 0.853 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 33 cost time: 1.1531894207000732
Epoch: 33, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.845 Vali Acc: 0.675 Test Loss: 0.845 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674992).  Saving model ...
Epoch: 34 cost time: 1.0584638118743896
Epoch: 34, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.838 Vali Acc: 0.650 Test Loss: 0.838 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1355440616607666
Epoch: 35, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.828 Vali Acc: 0.675 Test Loss: 0.828 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 36 cost time: 1.0768280029296875
Epoch: 36, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.818 Vali Acc: 0.675 Test Loss: 0.818 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 37 cost time: 1.289677619934082
Epoch: 37, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.807 Vali Acc: 0.675 Test Loss: 0.807 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 38 cost time: 1.251244306564331
Epoch: 38, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.798 Vali Acc: 0.675 Test Loss: 0.798 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 39 cost time: 1.1187925338745117
Epoch: 39, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.791 Vali Acc: 0.700 Test Loss: 0.791 Test Acc: 0.700
Validation loss decreased (-0.674992 --> -0.699992).  Saving model ...
Epoch: 40 cost time: 1.1764485836029053
Epoch: 40, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.784 Vali Acc: 0.725 Test Loss: 0.784 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 41 cost time: 1.250544548034668
Epoch: 41, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 42 cost time: 1.274878978729248
Epoch: 42, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.772 Vali Acc: 0.725 Test Loss: 0.772 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 43 cost time: 1.4773590564727783
Epoch: 43, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 44 cost time: 1.2984614372253418
Epoch: 44, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.761 Vali Acc: 0.725 Test Loss: 0.761 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.264178991317749
Epoch: 45, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.755 Vali Acc: 0.725 Test Loss: 0.755 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.286848783493042
Epoch: 46, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.750 Vali Acc: 0.725 Test Loss: 0.750 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2806918621063232
Epoch: 47, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.746 Vali Acc: 0.725 Test Loss: 0.746 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.3657927513122559
Epoch: 48, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 49 cost time: 1.3809359073638916
Epoch: 49, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 50 cost time: 1.205449104309082
Epoch: 50, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.738 Vali Acc: 0.750 Test Loss: 0.738 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 51 cost time: 1.1849009990692139
Epoch: 51, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 52 cost time: 1.2541193962097168
Epoch: 52, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 53 cost time: 1.3869693279266357
Epoch: 53, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 54 cost time: 1.2925353050231934
Epoch: 54, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.376983642578125
Epoch: 55, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.716 Vali Acc: 0.750 Test Loss: 0.716 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.3567399978637695
Epoch: 56, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.2315630912780762
Epoch: 57, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.359736680984497
Epoch: 58, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.3048672676086426
Epoch: 59, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.252622365951538
Epoch: 60, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.1867587566375732
Epoch: 61, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.335822343826294
Epoch: 62, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.1772353649139404
Epoch: 63, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.176016330718994
Epoch: 1, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.366 Vali Acc: 0.300 Test Loss: 1.366 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 1.1734580993652344
Epoch: 2, Steps: 3 | Train Loss: 1.499 Vali Loss: 1.365 Vali Acc: 0.325 Test Loss: 1.365 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.2682385444641113
Epoch: 3, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.361 Vali Acc: 0.325 Test Loss: 1.361 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.076688289642334
Epoch: 4, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.357 Vali Acc: 0.325 Test Loss: 1.357 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 5 cost time: 1.122990369796753
Epoch: 5, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.352 Vali Acc: 0.325 Test Loss: 1.352 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 1.1432769298553467
Epoch: 6, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.348 Vali Acc: 0.325 Test Loss: 1.348 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 1.2494449615478516
Epoch: 7, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.343 Vali Acc: 0.375 Test Loss: 1.343 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 1.2067458629608154
Epoch: 8, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.339 Vali Acc: 0.375 Test Loss: 1.339 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 1.376513957977295
Epoch: 9, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.333 Vali Acc: 0.375 Test Loss: 1.333 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 10 cost time: 1.2868938446044922
Epoch: 10, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.329 Vali Acc: 0.375 Test Loss: 1.329 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 1.1406242847442627
Epoch: 11, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3762285709381104
Epoch: 12, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2786633968353271
Epoch: 13, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4246113300323486
Epoch: 14, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3315958976745605
Epoch: 15, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.327 Vali Acc: 0.325 Test Loss: 1.327 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.176741123199463
Epoch: 16, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.328 Vali Acc: 0.325 Test Loss: 1.328 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2132654190063477
Epoch: 17, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.329 Vali Acc: 0.325 Test Loss: 1.329 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2777719497680664
Epoch: 18, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.329 Vali Acc: 0.300 Test Loss: 1.329 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1851766109466553
Epoch: 19, Steps: 3 | Train Loss: 0.816 Vali Loss: 1.331 Vali Acc: 0.300 Test Loss: 1.331 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2717883586883545
Epoch: 20, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.336 Vali Acc: 0.300 Test Loss: 1.336 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.375
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.591092586517334
Epoch: 1, Steps: 3 | Train Loss: 1.541 Vali Loss: 1.278 Vali Acc: 0.350 Test Loss: 1.278 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.135970115661621
Epoch: 2, Steps: 3 | Train Loss: 1.534 Vali Loss: 1.275 Vali Acc: 0.350 Test Loss: 1.275 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.2301726341247559
Epoch: 3, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.268 Vali Acc: 0.350 Test Loss: 1.268 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.226231575012207
Epoch: 4, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.2621359825134277
Epoch: 5, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.253 Vali Acc: 0.375 Test Loss: 1.253 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4392788410186768
Epoch: 6, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.245 Vali Acc: 0.425 Test Loss: 1.245 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 1.2137432098388672
Epoch: 7, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.237 Vali Acc: 0.425 Test Loss: 1.237 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 1.295823335647583
Epoch: 8, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.228 Vali Acc: 0.450 Test Loss: 1.228 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 1.2515718936920166
Epoch: 9, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.220 Vali Acc: 0.450 Test Loss: 1.220 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 1.2486262321472168
Epoch: 10, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.212 Vali Acc: 0.475 Test Loss: 1.212 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 1.161071538925171
Epoch: 11, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.204 Vali Acc: 0.475 Test Loss: 1.204 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 1.169335126876831
Epoch: 12, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.196 Vali Acc: 0.525 Test Loss: 1.196 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 1.3145027160644531
Epoch: 13, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.189 Vali Acc: 0.550 Test Loss: 1.189 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 1.2517411708831787
Epoch: 14, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.182 Vali Acc: 0.575 Test Loss: 1.182 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 1.1930127143859863
Epoch: 15, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.174 Vali Acc: 0.550 Test Loss: 1.174 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2452583312988281
Epoch: 16, Steps: 3 | Train Loss: 0.894 Vali Loss: 1.167 Vali Acc: 0.575 Test Loss: 1.167 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 17 cost time: 1.3175413608551025
Epoch: 17, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.156 Vali Acc: 0.625 Test Loss: 1.156 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 18 cost time: 1.4378407001495361
Epoch: 18, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2669768333435059
Epoch: 19, Steps: 3 | Train Loss: 0.789 Vali Loss: 1.139 Vali Acc: 0.625 Test Loss: 1.139 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 20 cost time: 1.2493553161621094
Epoch: 20, Steps: 3 | Train Loss: 0.760 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 21 cost time: 1.2460665702819824
Epoch: 21, Steps: 3 | Train Loss: 0.652 Vali Loss: 1.127 Vali Acc: 0.625 Test Loss: 1.127 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 22 cost time: 1.4190313816070557
Epoch: 22, Steps: 3 | Train Loss: 0.712 Vali Loss: 1.116 Vali Acc: 0.625 Test Loss: 1.116 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 23 cost time: 1.444051742553711
Epoch: 23, Steps: 3 | Train Loss: 0.608 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.345860242843628
Epoch: 24, Steps: 3 | Train Loss: 0.582 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2614142894744873
Epoch: 25, Steps: 3 | Train Loss: 0.576 Vali Loss: 1.100 Vali Acc: 0.575 Test Loss: 1.100 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.312150239944458
Epoch: 26, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.090 Vali Acc: 0.575 Test Loss: 1.090 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2167949676513672
Epoch: 27, Steps: 3 | Train Loss: 0.491 Vali Loss: 1.082 Vali Acc: 0.575 Test Loss: 1.082 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3086442947387695
Epoch: 28, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.073 Vali Acc: 0.550 Test Loss: 1.073 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2308604717254639
Epoch: 29, Steps: 3 | Train Loss: 0.418 Vali Loss: 1.065 Vali Acc: 0.550 Test Loss: 1.065 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.375976324081421
Epoch: 30, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.057 Vali Acc: 0.550 Test Loss: 1.057 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1973471641540527
Epoch: 31, Steps: 3 | Train Loss: 0.378 Vali Loss: 1.048 Vali Acc: 0.575 Test Loss: 1.048 Test Acc: 0.575
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2599384784698486
Epoch: 32, Steps: 3 | Train Loss: 0.358 Vali Loss: 1.045 Vali Acc: 0.575 Test Loss: 1.045 Test Acc: 0.575
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.408785104751587
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1497507095336914
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.078777551651001
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.118694543838501
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.1061327457427979
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.0977752208709717
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1026535034179688
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.024928092956543
Epoch: 8, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.1232328414916992
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.147714376449585
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 1.0553038120269775
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.1210074424743652
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.053523302078247
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.134861707687378
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.144216775894165
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.1844992637634277
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 17 cost time: 1.1438591480255127
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 18 cost time: 1.143803358078003
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 19 cost time: 1.1128177642822266
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 20 cost time: 1.1222758293151855
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 21 cost time: 1.194758415222168
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 22 cost time: 1.2759497165679932
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 23 cost time: 1.2159533500671387
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.1762006282806396
Epoch: 24, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 25 cost time: 1.1882710456848145
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 26 cost time: 1.1693432331085205
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 27 cost time: 1.1830406188964844
Epoch: 27, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 28 cost time: 1.1963293552398682
Epoch: 28, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 29 cost time: 1.1139752864837646
Epoch: 29, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 30 cost time: 1.197697401046753
Epoch: 30, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 31 cost time: 1.1461083889007568
Epoch: 31, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 32 cost time: 1.1972239017486572
Epoch: 32, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 33 cost time: 1.2597408294677734
Epoch: 33, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 34 cost time: 1.1252388954162598
Epoch: 34, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 35 cost time: 1.1794610023498535
Epoch: 35, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 36 cost time: 1.1776888370513916
Epoch: 36, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 37 cost time: 1.0949573516845703
Epoch: 37, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 38 cost time: 1.1846134662628174
Epoch: 38, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 39 cost time: 1.149235486984253
Epoch: 39, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 40 cost time: 1.1473557949066162
Epoch: 40, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 41 cost time: 1.1380481719970703
Epoch: 41, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.170212745666504
Epoch: 42, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1790051460266113
Epoch: 43, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2320375442504883
Epoch: 44, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0193653106689453
Epoch: 45, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0859477519989014
Epoch: 46, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2072150707244873
Epoch: 47, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2078611850738525
Epoch: 48, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2189834117889404
Epoch: 49, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1579711437225342
Epoch: 50, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 445540
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3589625358581543
Epoch: 1, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.379 Vali Acc: 0.200 Test Loss: 1.379 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.2255666255950928
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.345 Vali Acc: 0.250 Test Loss: 1.345 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 1.2680776119232178
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.2544875144958496
Epoch: 4, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.261 Vali Acc: 0.575 Test Loss: 1.261 Test Acc: 0.575
Validation loss decreased (-0.349987 --> -0.574987).  Saving model ...
Epoch: 5 cost time: 1.299767017364502
Epoch: 5, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.207 Vali Acc: 0.575 Test Loss: 1.207 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.269115924835205
Epoch: 6, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.2902512550354004
Epoch: 7, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.090 Vali Acc: 0.775 Test Loss: 1.090 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 1.3110930919647217
Epoch: 8, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.032 Vali Acc: 0.775 Test Loss: 1.032 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.1812517642974854
Epoch: 9, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.974 Vali Acc: 0.825 Test Loss: 0.974 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 1.1834220886230469
Epoch: 10, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.918 Vali Acc: 0.825 Test Loss: 0.918 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 1.2548720836639404
Epoch: 11, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.861 Vali Acc: 0.875 Test Loss: 0.861 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 1.4285588264465332
Epoch: 12, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.804 Vali Acc: 0.900 Test Loss: 0.804 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 1.4473681449890137
Epoch: 13, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.752 Vali Acc: 0.925 Test Loss: 0.752 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 14 cost time: 1.5013210773468018
Epoch: 14, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.698 Vali Acc: 0.925 Test Loss: 0.698 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 15 cost time: 1.5953571796417236
Epoch: 15, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.650 Vali Acc: 0.900 Test Loss: 0.650 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3248059749603271
Epoch: 16, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.606 Vali Acc: 0.900 Test Loss: 0.606 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4352712631225586
Epoch: 17, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3714525699615479
Epoch: 18, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1986796855926514
Epoch: 19, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2549777030944824
Epoch: 20, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1805391311645508
Epoch: 21, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.3954641819000244
Epoch: 22, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 1.4119086265563965
Epoch: 23, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 1.2892711162567139
Epoch: 24, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.2555906772613525
Epoch: 25, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.263094186782837
Epoch: 26, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.3650014400482178
Epoch: 27, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.2170212268829346
Epoch: 28, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 1.3066153526306152
Epoch: 29, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 1.215219259262085
Epoch: 30, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 1.2993743419647217
Epoch: 31, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 1.4074296951293945
Epoch: 32, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 1.3071188926696777
Epoch: 33, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 1.265378475189209
Epoch: 34, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 1.1928730010986328
Epoch: 35, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 1.2789404392242432
Epoch: 36, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.275578498840332
Epoch: 37, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2832047939300537
Epoch: 38, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3544063568115234
Epoch: 39, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3355576992034912
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2854342460632324
Epoch: 41, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3440780639648438
Epoch: 42, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4675674438476562
Epoch: 43, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3339190483093262
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.424468994140625
Epoch: 45, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4971871376037598
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.363563299179077
Epoch: 1, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.360 Vali Acc: 0.325 Test Loss: 1.360 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.0794341564178467
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.328 Vali Acc: 0.350 Test Loss: 1.328 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.1388602256774902
Epoch: 3, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.294 Vali Acc: 0.450 Test Loss: 1.294 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 1.0785512924194336
Epoch: 4, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.249 Vali Acc: 0.600 Test Loss: 1.249 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 1.1325464248657227
Epoch: 5, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.197 Vali Acc: 0.700 Test Loss: 1.197 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699988).  Saving model ...
Epoch: 6 cost time: 1.0894124507904053
Epoch: 6, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.141 Vali Acc: 0.750 Test Loss: 1.141 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 1.0913865566253662
Epoch: 7, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.084 Vali Acc: 0.775 Test Loss: 1.084 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 1.074981927871704
Epoch: 8, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 1.0484766960144043
Epoch: 9, Steps: 3 | Train Loss: 0.882 Vali Loss: 0.974 Vali Acc: 0.775 Test Loss: 0.974 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 1.102491855621338
Epoch: 10, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.920 Vali Acc: 0.775 Test Loss: 0.920 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 1.2434062957763672
Epoch: 11, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.867 Vali Acc: 0.825 Test Loss: 0.867 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 1.0747158527374268
Epoch: 12, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.814 Vali Acc: 0.850 Test Loss: 0.814 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 1.0526485443115234
Epoch: 13, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.765 Vali Acc: 0.875 Test Loss: 0.765 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 1.242258071899414
Epoch: 14, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.714 Vali Acc: 0.900 Test Loss: 0.714 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 1.1064646244049072
Epoch: 15, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.669 Vali Acc: 0.900 Test Loss: 0.669 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 1.096930742263794
Epoch: 16, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 1.0546340942382812
Epoch: 17, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 1.1655726432800293
Epoch: 18, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 1.1103079319000244
Epoch: 19, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 1.0334315299987793
Epoch: 20, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 1.0727031230926514
Epoch: 21, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.1201186180114746
Epoch: 22, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 1.166623592376709
Epoch: 23, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 1.1918678283691406
Epoch: 24, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 1.188575267791748
Epoch: 25, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 1.2179052829742432
Epoch: 26, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.2202632427215576
Epoch: 27, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.1782150268554688
Epoch: 28, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.183556318283081
Epoch: 29, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.1987335681915283
Epoch: 30, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 1.11667799949646
Epoch: 31, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.1620221138000488
Epoch: 32, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.1459441184997559
Epoch: 33, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.180366039276123
Epoch: 34, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 1.1738390922546387
Epoch: 35, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 1.1852760314941406
Epoch: 36, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 1.161083698272705
Epoch: 37, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 1.1851842403411865
Epoch: 38, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 1.0753657817840576
Epoch: 39, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 1.1077203750610352
Epoch: 40, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 1.1941120624542236
Epoch: 41, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 1.2295117378234863
Epoch: 42, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 1.1015853881835938
Epoch: 43, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.1129376888275146
Epoch: 44, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.122704267501831
Epoch: 45, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.1073875427246094
Epoch: 46, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.1413204669952393
Epoch: 47, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.1777942180633545
Epoch: 48, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.1391029357910156
Epoch: 49, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.1751492023468018
Epoch: 50, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.1239254474639893
Epoch: 51, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 1.0808148384094238
Epoch: 52, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 1.225693702697754
Epoch: 53, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 1.0592873096466064
Epoch: 54, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.0944914817810059
Epoch: 55, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 1.088111162185669
Epoch: 56, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 1.1450750827789307
Epoch: 57, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 1.0754961967468262
Epoch: 58, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 59 cost time: 1.0716423988342285
Epoch: 59, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 60 cost time: 1.0788295269012451
Epoch: 60, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 61 cost time: 1.1890509128570557
Epoch: 61, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 62 cost time: 1.1614487171173096
Epoch: 62, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 63 cost time: 1.1575899124145508
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 64 cost time: 1.1566112041473389
Epoch: 64, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 65 cost time: 1.1567974090576172
Epoch: 65, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 66 cost time: 1.1712982654571533
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 67 cost time: 1.1161715984344482
Epoch: 67, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 68 cost time: 1.1706137657165527
Epoch: 68, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 69 cost time: 1.1273472309112549
Epoch: 69, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 70 cost time: 1.1524295806884766
Epoch: 70, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 71 cost time: 1.1806774139404297
Epoch: 71, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 72 cost time: 1.1908822059631348
Epoch: 72, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 73 cost time: 1.1197516918182373
Epoch: 73, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 74 cost time: 1.1554439067840576
Epoch: 74, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 75 cost time: 1.115107774734497
Epoch: 75, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 76 cost time: 1.1584477424621582
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 77 cost time: 1.0802874565124512
Epoch: 77, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 78 cost time: 1.1923983097076416
Epoch: 78, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 79 cost time: 1.120335340499878
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 80 cost time: 1.168217420578003
Epoch: 80, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 81 cost time: 1.1073846817016602
Epoch: 81, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 82 cost time: 1.191420316696167
Epoch: 82, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.282254934310913
Epoch: 83, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 84 cost time: 1.1817376613616943
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 85 cost time: 1.1551368236541748
Epoch: 85, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 86 cost time: 1.1550660133361816
Epoch: 86, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 87 cost time: 1.1718125343322754
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 88 cost time: 1.223609209060669
Epoch: 88, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 89 cost time: 1.1923439502716064
Epoch: 89, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 90 cost time: 1.2946114540100098
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 91 cost time: 1.0961060523986816
Epoch: 91, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 92 cost time: 1.1238598823547363
Epoch: 92, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 93 cost time: 1.0792922973632812
Epoch: 93, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 94 cost time: 1.123042345046997
Epoch: 94, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 95 cost time: 1.2204384803771973
Epoch: 95, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 96 cost time: 1.2502696514129639
Epoch: 96, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 97 cost time: 1.3353815078735352
Epoch: 97, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 98 cost time: 1.1835377216339111
Epoch: 98, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 99 cost time: 1.232259750366211
Epoch: 99, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 100 cost time: 1.2083039283752441
Epoch: 100, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.519165277481079
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.427 Vali Acc: 0.250 Test Loss: 1.427 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2043447494506836
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.325 Test Loss: 1.387 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.305464506149292
Epoch: 3, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.3305141925811768
Epoch: 4, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.2096819877624512
Epoch: 5, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.251 Vali Acc: 0.450 Test Loss: 1.251 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.0601143836975098
Epoch: 6, Steps: 3 | Train Loss: 1.106 Vali Loss: 1.192 Vali Acc: 0.625 Test Loss: 1.192 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 1.2178936004638672
Epoch: 7, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.130 Vali Acc: 0.675 Test Loss: 1.130 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 1.22049880027771
Epoch: 8, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 1.1351702213287354
Epoch: 9, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.012 Vali Acc: 0.700 Test Loss: 1.012 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.2085604667663574
Epoch: 10, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 1.1628186702728271
Epoch: 11, Steps: 3 | Train Loss: 0.737 Vali Loss: 0.903 Vali Acc: 0.825 Test Loss: 0.903 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 1.3144993782043457
Epoch: 12, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.849 Vali Acc: 0.850 Test Loss: 0.849 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 1.423757553100586
Epoch: 13, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.800 Vali Acc: 0.900 Test Loss: 0.800 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 1.403874397277832
Epoch: 14, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.749 Vali Acc: 0.875 Test Loss: 0.749 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1047108173370361
Epoch: 15, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.703 Vali Acc: 0.875 Test Loss: 0.703 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2345809936523438
Epoch: 16, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.659 Vali Acc: 0.900 Test Loss: 0.659 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 1.1336438655853271
Epoch: 17, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.615 Vali Acc: 0.925 Test Loss: 0.615 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 18 cost time: 1.2316029071807861
Epoch: 18, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 1.3229341506958008
Epoch: 19, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.544 Vali Acc: 0.925 Test Loss: 0.544 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 1.1495797634124756
Epoch: 20, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.516 Vali Acc: 0.925 Test Loss: 0.516 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 1.1510672569274902
Epoch: 21, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.493 Vali Acc: 0.925 Test Loss: 0.493 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 1.2396304607391357
Epoch: 22, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 1.3209984302520752
Epoch: 23, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 1.1582205295562744
Epoch: 24, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 1.2171709537506104
Epoch: 25, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.429 Vali Acc: 0.950 Test Loss: 0.429 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 1.2884953022003174
Epoch: 26, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 1.2863163948059082
Epoch: 27, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 1.3084685802459717
Epoch: 28, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 1.2354328632354736
Epoch: 29, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 1.2769126892089844
Epoch: 30, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 1.272500991821289
Epoch: 31, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 1.3410234451293945
Epoch: 32, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 1.4113430976867676
Epoch: 33, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 1.3331880569458008
Epoch: 34, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 1.2493011951446533
Epoch: 35, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 1.3035643100738525
Epoch: 36, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 1.4743285179138184
Epoch: 37, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 1.311121940612793
Epoch: 38, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 1.2868003845214844
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 1.1987154483795166
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 1.1991045475006104
Epoch: 41, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 1.1676580905914307
Epoch: 42, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 1.338381052017212
Epoch: 43, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 1.2255654335021973
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 1.2148442268371582
Epoch: 45, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 1.2674095630645752
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 1.3065054416656494
Epoch: 47, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 1.2679429054260254
Epoch: 48, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 1.2437562942504883
Epoch: 49, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 1.2430627346038818
Epoch: 50, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 51 cost time: 1.256202220916748
Epoch: 51, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 52 cost time: 1.0986027717590332
Epoch: 52, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 53 cost time: 1.156165361404419
Epoch: 53, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 54 cost time: 1.2451832294464111
Epoch: 54, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 55 cost time: 1.3095872402191162
Epoch: 55, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 56 cost time: 1.3513073921203613
Epoch: 56, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 57 cost time: 1.2799749374389648
Epoch: 57, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 58 cost time: 1.2020823955535889
Epoch: 58, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 59 cost time: 1.2760322093963623
Epoch: 59, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 60 cost time: 1.25852632522583
Epoch: 60, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 61 cost time: 1.3312194347381592
Epoch: 61, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 62 cost time: 1.2108001708984375
Epoch: 62, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 63 cost time: 1.1862130165100098
Epoch: 63, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 64 cost time: 1.2984039783477783
Epoch: 64, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 65 cost time: 1.245643138885498
Epoch: 65, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 66 cost time: 1.2418491840362549
Epoch: 66, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 67 cost time: 1.215928554534912
Epoch: 67, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 68 cost time: 1.202941656112671
Epoch: 68, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 69 cost time: 1.2115838527679443
Epoch: 69, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 70 cost time: 1.2237534523010254
Epoch: 70, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 71 cost time: 1.2159724235534668
Epoch: 71, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 72 cost time: 1.4298412799835205
Epoch: 72, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 73 cost time: 1.266239881515503
Epoch: 73, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 74 cost time: 1.2179067134857178
Epoch: 74, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 75 cost time: 1.2240321636199951
Epoch: 75, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 76 cost time: 1.2357027530670166
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.1739404201507568
Epoch: 77, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.2000269889831543
Epoch: 78, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.0798983573913574
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.15228271484375
Epoch: 80, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.14302396774292
Epoch: 81, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.1358129978179932
Epoch: 82, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.2492396831512451
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.2246792316436768
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 85 cost time: 1.2115771770477295
Epoch: 85, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 86 cost time: 1.1516108512878418
Epoch: 86, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 87 cost time: 1.2632620334625244
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 88 cost time: 1.2252509593963623
Epoch: 88, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 89 cost time: 1.275266170501709
Epoch: 89, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 90 cost time: 1.298093557357788
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 91 cost time: 1.1474347114562988
Epoch: 91, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 92 cost time: 1.1732306480407715
Epoch: 92, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 93 cost time: 1.158367395401001
Epoch: 93, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 94 cost time: 1.2557976245880127
Epoch: 94, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 95 cost time: 1.3733959197998047
Epoch: 95, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 96 cost time: 1.3167834281921387
Epoch: 96, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 97 cost time: 1.255690336227417
Epoch: 97, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.279273271560669
Epoch: 98, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 99 cost time: 1.4019641876220703
Epoch: 99, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 100 cost time: 1.4137239456176758
Epoch: 100, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6351492404937744
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.426 Vali Acc: 0.225 Test Loss: 1.426 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 1.3161742687225342
Epoch: 2, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.393 Vali Acc: 0.250 Test Loss: 1.393 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2686734199523926
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.362 Vali Acc: 0.275 Test Loss: 1.362 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 1.3224806785583496
Epoch: 4, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.320 Vali Acc: 0.375 Test Loss: 1.320 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.205059289932251
Epoch: 5, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 1.1603374481201172
Epoch: 6, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.220 Vali Acc: 0.550 Test Loss: 1.220 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 1.2425730228424072
Epoch: 7, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.166 Vali Acc: 0.575 Test Loss: 1.166 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 1.232874870300293
Epoch: 8, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.115 Vali Acc: 0.575 Test Loss: 1.115 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.195505142211914
Epoch: 9, Steps: 3 | Train Loss: 0.893 Vali Loss: 1.063 Vali Acc: 0.575 Test Loss: 1.063 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 1.1506311893463135
Epoch: 10, Steps: 3 | Train Loss: 0.854 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 1.0697331428527832
Epoch: 11, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.968 Vali Acc: 0.650 Test Loss: 0.968 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 1.2319931983947754
Epoch: 12, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.921 Vali Acc: 0.675 Test Loss: 0.921 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 13 cost time: 1.1018683910369873
Epoch: 13, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 1.3056745529174805
Epoch: 14, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 1.2236647605895996
Epoch: 15, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 1.0714561939239502
Epoch: 16, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.754 Vali Acc: 0.775 Test Loss: 0.754 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 1.1416394710540771
Epoch: 17, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 18 cost time: 1.288313627243042
Epoch: 18, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 19 cost time: 1.325453758239746
Epoch: 19, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 20 cost time: 1.1068923473358154
Epoch: 20, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774994).  Saving model ...
Epoch: 21 cost time: 1.1685516834259033
Epoch: 21, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.621 Vali Acc: 0.775 Test Loss: 0.621 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 22 cost time: 1.1636619567871094
Epoch: 22, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1292052268981934
Epoch: 23, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1296906471252441
Epoch: 24, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.582 Vali Acc: 0.775 Test Loss: 0.582 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774994).  Saving model ...
Epoch: 25 cost time: 1.1509802341461182
Epoch: 25, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2821662425994873
Epoch: 26, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.557 Vali Acc: 0.750 Test Loss: 0.557 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2615456581115723
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.546 Vali Acc: 0.750 Test Loss: 0.546 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2601349353790283
Epoch: 28, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.534 Vali Acc: 0.775 Test Loss: 0.534 Test Acc: 0.775
Validation loss decreased (-0.774994 --> -0.774995).  Saving model ...
Epoch: 29 cost time: 1.2808139324188232
Epoch: 29, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.522 Vali Acc: 0.775 Test Loss: 0.522 Test Acc: 0.775
Validation loss decreased (-0.774995 --> -0.774995).  Saving model ...
Epoch: 30 cost time: 1.246589183807373
Epoch: 30, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.509 Vali Acc: 0.775 Test Loss: 0.509 Test Acc: 0.775
Validation loss decreased (-0.774995 --> -0.774995).  Saving model ...
Epoch: 31 cost time: 1.125443935394287
Epoch: 31, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.497 Vali Acc: 0.775 Test Loss: 0.497 Test Acc: 0.775
Validation loss decreased (-0.774995 --> -0.774995).  Saving model ...
Epoch: 32 cost time: 1.2711544036865234
Epoch: 32, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.775 Test Loss: 0.487 Test Acc: 0.775
Validation loss decreased (-0.774995 --> -0.774995).  Saving model ...
Epoch: 33 cost time: 1.1766321659088135
Epoch: 33, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.481 Vali Acc: 0.775 Test Loss: 0.481 Test Acc: 0.775
Validation loss decreased (-0.774995 --> -0.774995).  Saving model ...
Epoch: 34 cost time: 1.2833235263824463
Epoch: 34, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
Validation loss decreased (-0.774995 --> -0.799995).  Saving model ...
Epoch: 35 cost time: 1.1449463367462158
Epoch: 35, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.472 Vali Acc: 0.825 Test Loss: 0.472 Test Acc: 0.825
Validation loss decreased (-0.799995 --> -0.824995).  Saving model ...
Epoch: 36 cost time: 1.398271083831787
Epoch: 36, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.466 Vali Acc: 0.825 Test Loss: 0.466 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 37 cost time: 1.3789429664611816
Epoch: 37, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.461 Vali Acc: 0.800 Test Loss: 0.461 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3246614933013916
Epoch: 38, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.457 Vali Acc: 0.800 Test Loss: 0.457 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2623283863067627
Epoch: 39, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.453 Vali Acc: 0.800 Test Loss: 0.453 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3005056381225586
Epoch: 40, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.450 Vali Acc: 0.775 Test Loss: 0.450 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1441411972045898
Epoch: 41, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.448 Vali Acc: 0.775 Test Loss: 0.448 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.12730073928833
Epoch: 42, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.445 Vali Acc: 0.775 Test Loss: 0.445 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3397891521453857
Epoch: 43, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.442 Vali Acc: 0.800 Test Loss: 0.442 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1648352146148682
Epoch: 44, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.437 Vali Acc: 0.800 Test Loss: 0.437 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1938824653625488
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.434 Vali Acc: 0.825 Test Loss: 0.434 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824996).  Saving model ...
Epoch: 46 cost time: 1.3499653339385986
Epoch: 46, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.430 Vali Acc: 0.825 Test Loss: 0.430 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 47 cost time: 1.1831870079040527
Epoch: 47, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.425 Vali Acc: 0.825 Test Loss: 0.425 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 48 cost time: 1.200822353363037
Epoch: 48, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.419 Vali Acc: 0.825 Test Loss: 0.419 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 49 cost time: 1.2674450874328613
Epoch: 49, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.415 Vali Acc: 0.825 Test Loss: 0.415 Test Acc: 0.825
Validation loss decreased (-0.824996 --> -0.824996).  Saving model ...
Epoch: 50 cost time: 1.2488508224487305
Epoch: 50, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.824996 --> -0.849996).  Saving model ...
Epoch: 51 cost time: 1.3546323776245117
Epoch: 51, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 52 cost time: 1.2463123798370361
Epoch: 52, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 53 cost time: 1.3084800243377686
Epoch: 53, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.401 Vali Acc: 0.875 Test Loss: 0.401 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
Epoch: 54 cost time: 1.182091236114502
Epoch: 54, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 1.2928776741027832
Epoch: 55, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 1.2409045696258545
Epoch: 56, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 1.2181708812713623
Epoch: 57, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 1.2810065746307373
Epoch: 58, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 1.2621395587921143
Epoch: 59, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 60 cost time: 1.2476775646209717
Epoch: 60, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 1.3793988227844238
Epoch: 61, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 62 cost time: 1.148660659790039
Epoch: 62, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 63 cost time: 1.234659194946289
Epoch: 63, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 1.2513206005096436
Epoch: 64, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 1.2449402809143066
Epoch: 65, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 1.2072198390960693
Epoch: 66, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 1.3559651374816895
Epoch: 67, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 1.2082569599151611
Epoch: 68, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 69 cost time: 1.2801826000213623
Epoch: 69, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 70 cost time: 1.098064661026001
Epoch: 70, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 71 cost time: 1.436492681503296
Epoch: 71, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 72 cost time: 1.1977782249450684
Epoch: 72, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 73 cost time: 1.2511367797851562
Epoch: 73, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 74 cost time: 1.2921514511108398
Epoch: 74, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 75 cost time: 1.3024113178253174
Epoch: 75, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 76 cost time: 1.1625213623046875
Epoch: 76, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 77 cost time: 1.2157995700836182
Epoch: 77, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 78 cost time: 1.2060942649841309
Epoch: 78, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 79 cost time: 1.1594152450561523
Epoch: 79, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 80 cost time: 1.1487312316894531
Epoch: 80, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 81 cost time: 1.158674955368042
Epoch: 81, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 82 cost time: 1.2042756080627441
Epoch: 82, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 83 cost time: 1.1964383125305176
Epoch: 83, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.356 Vali Acc: 0.900 Test Loss: 0.356 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 84 cost time: 1.1892213821411133
Epoch: 84, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 85 cost time: 1.1508152484893799
Epoch: 85, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 86 cost time: 1.2040057182312012
Epoch: 86, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 87 cost time: 1.0704190731048584
Epoch: 87, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 88 cost time: 1.3314039707183838
Epoch: 88, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 89 cost time: 1.2317240238189697
Epoch: 89, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 90 cost time: 1.1702263355255127
Epoch: 90, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 91 cost time: 1.2367744445800781
Epoch: 91, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 92 cost time: 1.1852900981903076
Epoch: 92, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 93 cost time: 1.248067855834961
Epoch: 93, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 94 cost time: 1.0761055946350098
Epoch: 94, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 95 cost time: 1.240373134613037
Epoch: 95, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 96 cost time: 1.1593244075775146
Epoch: 96, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 97 cost time: 1.1057395935058594
Epoch: 97, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 98 cost time: 1.2414462566375732
Epoch: 98, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 99 cost time: 1.1938695907592773
Epoch: 99, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 100 cost time: 1.3344547748565674
Epoch: 100, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5432679653167725
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.381 Vali Acc: 0.200 Test Loss: 1.381 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 1.2830414772033691
Epoch: 2, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.349 Vali Acc: 0.225 Test Loss: 1.349 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 1.202009916305542
Epoch: 3, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.321 Vali Acc: 0.300 Test Loss: 1.321 Test Acc: 0.300
Validation loss decreased (-0.224987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 1.235175371170044
Epoch: 4, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.193788766860962
Epoch: 5, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.241 Vali Acc: 0.475 Test Loss: 1.241 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 1.244086503982544
Epoch: 6, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 1.1331555843353271
Epoch: 7, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.146 Vali Acc: 0.625 Test Loss: 1.146 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.1720705032348633
Epoch: 8, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.1035723686218262
Epoch: 9, Steps: 3 | Train Loss: 0.921 Vali Loss: 1.052 Vali Acc: 0.650 Test Loss: 1.052 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.2671473026275635
Epoch: 10, Steps: 3 | Train Loss: 0.832 Vali Loss: 1.007 Vali Acc: 0.675 Test Loss: 1.007 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 1.2041311264038086
Epoch: 11, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.2301549911499023
Epoch: 12, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.922 Vali Acc: 0.700 Test Loss: 0.922 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 1.285238265991211
Epoch: 13, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.883 Vali Acc: 0.800 Test Loss: 0.883 Test Acc: 0.800
Validation loss decreased (-0.699991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 1.3736748695373535
Epoch: 14, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 1.414085865020752
Epoch: 15, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 16 cost time: 1.183361291885376
Epoch: 16, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.1289851665496826
Epoch: 17, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.2502081394195557
Epoch: 18, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.703 Vali Acc: 0.850 Test Loss: 0.703 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 1.2171943187713623
Epoch: 19, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.675 Vali Acc: 0.825 Test Loss: 0.675 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2312555313110352
Epoch: 20, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 21 cost time: 1.1799089908599854
Epoch: 21, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.634 Vali Acc: 0.825 Test Loss: 0.634 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3117790222167969
Epoch: 22, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2239527702331543
Epoch: 23, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.609 Vali Acc: 0.825 Test Loss: 0.609 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1836140155792236
Epoch: 24, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.597 Vali Acc: 0.825 Test Loss: 0.597 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1243538856506348
Epoch: 25, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.176537036895752
Epoch: 26, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 1.2501718997955322
Epoch: 27, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.246678113937378
Epoch: 28, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.19535231590271
Epoch: 29, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.211653709411621
Epoch: 30, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.128791332244873
Epoch: 31, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3156583309173584
Epoch: 32, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.538 Vali Acc: 0.800 Test Loss: 0.538 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.31553316116333
Epoch: 33, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2221086025238037
Epoch: 34, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.546 Vali Acc: 0.825 Test Loss: 0.546 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2458126544952393
Epoch: 35, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3546719551086426
Epoch: 36, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.524 Vali Acc: 0.825 Test Loss: 0.524 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3948581218719482
Epoch: 1, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.434 Vali Acc: 0.125 Test Loss: 1.434 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 1.1669046878814697
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.426 Vali Acc: 0.125 Test Loss: 1.426 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 3 cost time: 1.1785740852355957
Epoch: 3, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.417 Vali Acc: 0.125 Test Loss: 1.417 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 1.0714805126190186
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.403 Vali Acc: 0.150 Test Loss: 1.403 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 5 cost time: 1.222316026687622
Epoch: 5, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.387 Vali Acc: 0.175 Test Loss: 1.387 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 1.1218762397766113
Epoch: 6, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.369 Vali Acc: 0.200 Test Loss: 1.369 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 1.1697511672973633
Epoch: 7, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.349 Vali Acc: 0.225 Test Loss: 1.349 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224987).  Saving model ...
Epoch: 8 cost time: 1.0854721069335938
Epoch: 8, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.329 Vali Acc: 0.250 Test Loss: 1.329 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 9 cost time: 1.1604654788970947
Epoch: 9, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.308 Vali Acc: 0.300 Test Loss: 1.308 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 10 cost time: 1.183631181716919
Epoch: 10, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.288 Vali Acc: 0.375 Test Loss: 1.288 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 11 cost time: 1.2187471389770508
Epoch: 11, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 1.2349543571472168
Epoch: 12, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.1851856708526611
Epoch: 13, Steps: 3 | Train Loss: 0.931 Vali Loss: 1.225 Vali Acc: 0.525 Test Loss: 1.225 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 14 cost time: 1.117811679840088
Epoch: 14, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.204 Vali Acc: 0.550 Test Loss: 1.204 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 15 cost time: 1.1643311977386475
Epoch: 15, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.182 Vali Acc: 0.525 Test Loss: 1.182 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1376097202301025
Epoch: 16, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.161 Vali Acc: 0.525 Test Loss: 1.161 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1330962181091309
Epoch: 17, Steps: 3 | Train Loss: 0.751 Vali Loss: 1.136 Vali Acc: 0.550 Test Loss: 1.136 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549989).  Saving model ...
Epoch: 18 cost time: 1.1936559677124023
Epoch: 18, Steps: 3 | Train Loss: 0.737 Vali Loss: 1.113 Vali Acc: 0.550 Test Loss: 1.113 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 19 cost time: 1.1875717639923096
Epoch: 19, Steps: 3 | Train Loss: 0.624 Vali Loss: 1.091 Vali Acc: 0.550 Test Loss: 1.091 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 1.1864910125732422
Epoch: 20, Steps: 3 | Train Loss: 0.613 Vali Loss: 1.070 Vali Acc: 0.575 Test Loss: 1.070 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 21 cost time: 1.2228569984436035
Epoch: 21, Steps: 3 | Train Loss: 0.591 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 22 cost time: 1.217087984085083
Epoch: 22, Steps: 3 | Train Loss: 0.507 Vali Loss: 1.029 Vali Acc: 0.625 Test Loss: 1.029 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 23 cost time: 1.3119597434997559
Epoch: 23, Steps: 3 | Train Loss: 0.435 Vali Loss: 1.011 Vali Acc: 0.625 Test Loss: 1.011 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 24 cost time: 1.2402074337005615
Epoch: 24, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.991 Vali Acc: 0.625 Test Loss: 0.991 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 25 cost time: 1.2793912887573242
Epoch: 25, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.969 Vali Acc: 0.650 Test Loss: 0.969 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 26 cost time: 1.2197654247283936
Epoch: 26, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.950 Vali Acc: 0.625 Test Loss: 0.950 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.222362995147705
Epoch: 27, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.932 Vali Acc: 0.650 Test Loss: 0.932 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 28 cost time: 1.2565648555755615
Epoch: 28, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.917 Vali Acc: 0.650 Test Loss: 0.917 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 29 cost time: 1.3401858806610107
Epoch: 29, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.902 Vali Acc: 0.675 Test Loss: 0.902 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 30 cost time: 1.261828899383545
Epoch: 30, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.889 Vali Acc: 0.675 Test Loss: 0.889 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 31 cost time: 1.311375379562378
Epoch: 31, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.876 Vali Acc: 0.675 Test Loss: 0.876 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 32 cost time: 1.2078990936279297
Epoch: 32, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.863 Vali Acc: 0.700 Test Loss: 0.863 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 33 cost time: 1.2703938484191895
Epoch: 33, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.852 Vali Acc: 0.700 Test Loss: 0.852 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 1.2462804317474365
Epoch: 34, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.841 Vali Acc: 0.700 Test Loss: 0.841 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 35 cost time: 1.3935809135437012
Epoch: 35, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.828 Vali Acc: 0.700 Test Loss: 0.828 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 36 cost time: 1.3243396282196045
Epoch: 36, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.813 Vali Acc: 0.700 Test Loss: 0.813 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 37 cost time: 1.1366240978240967
Epoch: 37, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 38 cost time: 1.135007619857788
Epoch: 38, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 39 cost time: 1.1851484775543213
Epoch: 39, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 40 cost time: 1.168449878692627
Epoch: 40, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.783 Vali Acc: 0.775 Test Loss: 0.783 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 41 cost time: 1.221325397491455
Epoch: 41, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 42 cost time: 1.147825002670288
Epoch: 42, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.775 Vali Acc: 0.800 Test Loss: 0.775 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 43 cost time: 1.1324279308319092
Epoch: 43, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.768 Vali Acc: 0.800 Test Loss: 0.768 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 44 cost time: 1.0477120876312256
Epoch: 44, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 45 cost time: 1.1187193393707275
Epoch: 45, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1094603538513184
Epoch: 46, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.122882604598999
Epoch: 47, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1618037223815918
Epoch: 48, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 49 cost time: 1.1278669834136963
Epoch: 49, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.721 Vali Acc: 0.800 Test Loss: 0.721 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 50 cost time: 1.1774804592132568
Epoch: 50, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.102386474609375
Epoch: 51, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.202437162399292
Epoch: 52, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1903667449951172
Epoch: 53, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.701 Vali Acc: 0.775 Test Loss: 0.701 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1714251041412354
Epoch: 54, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.696 Vali Acc: 0.775 Test Loss: 0.696 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2044622898101807
Epoch: 55, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.2938919067382812
Epoch: 56, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1450536251068115
Epoch: 57, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.2021281719207764
Epoch: 58, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.2480008602142334
Epoch: 59, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5546443462371826
Epoch: 1, Steps: 3 | Train Loss: 1.431 Vali Loss: 1.497 Vali Acc: 0.200 Test Loss: 1.497 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.2457447052001953
Epoch: 2, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.495 Vali Acc: 0.200 Test Loss: 1.495 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 1.3337454795837402
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.490 Vali Acc: 0.200 Test Loss: 1.490 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 1.3199033737182617
Epoch: 4, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.484 Vali Acc: 0.200 Test Loss: 1.484 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 1.3137249946594238
Epoch: 5, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.477 Vali Acc: 0.200 Test Loss: 1.477 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 1.4080419540405273
Epoch: 6, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.471 Vali Acc: 0.200 Test Loss: 1.471 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 7 cost time: 1.1906046867370605
Epoch: 7, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.465 Vali Acc: 0.175 Test Loss: 1.465 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1754248142242432
Epoch: 8, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.460 Vali Acc: 0.175 Test Loss: 1.460 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1795403957366943
Epoch: 9, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.454 Vali Acc: 0.175 Test Loss: 1.454 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1471617221832275
Epoch: 10, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.450 Vali Acc: 0.175 Test Loss: 1.450 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1374714374542236
Epoch: 11, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.447 Vali Acc: 0.125 Test Loss: 1.447 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2890591621398926
Epoch: 12, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.443 Vali Acc: 0.150 Test Loss: 1.443 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1631207466125488
Epoch: 13, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.441 Vali Acc: 0.175 Test Loss: 1.441 Test Acc: 0.175
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3002464771270752
Epoch: 14, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.436 Vali Acc: 0.200 Test Loss: 1.436 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199986).  Saving model ...
Epoch: 15 cost time: 1.1791558265686035
Epoch: 15, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.432 Vali Acc: 0.200 Test Loss: 1.432 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 16 cost time: 1.316697597503662
Epoch: 16, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.430 Vali Acc: 0.200 Test Loss: 1.430 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 17 cost time: 1.2627427577972412
Epoch: 17, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.428 Vali Acc: 0.175 Test Loss: 1.428 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2635538578033447
Epoch: 18, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.424 Vali Acc: 0.200 Test Loss: 1.424 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 19 cost time: 1.1889433860778809
Epoch: 19, Steps: 3 | Train Loss: 0.798 Vali Loss: 1.421 Vali Acc: 0.200 Test Loss: 1.421 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 20 cost time: 1.176112413406372
Epoch: 20, Steps: 3 | Train Loss: 0.811 Vali Loss: 1.417 Vali Acc: 0.250 Test Loss: 1.417 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 21 cost time: 1.2329742908477783
Epoch: 21, Steps: 3 | Train Loss: 0.782 Vali Loss: 1.411 Vali Acc: 0.250 Test Loss: 1.411 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 22 cost time: 1.3196148872375488
Epoch: 22, Steps: 3 | Train Loss: 0.666 Vali Loss: 1.404 Vali Acc: 0.250 Test Loss: 1.404 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 23 cost time: 1.3378937244415283
Epoch: 23, Steps: 3 | Train Loss: 0.686 Vali Loss: 1.399 Vali Acc: 0.250 Test Loss: 1.399 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.3016111850738525
Epoch: 24, Steps: 3 | Train Loss: 0.682 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 25 cost time: 1.2716343402862549
Epoch: 25, Steps: 3 | Train Loss: 0.600 Vali Loss: 1.379 Vali Acc: 0.300 Test Loss: 1.379 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 26 cost time: 1.16774582862854
Epoch: 26, Steps: 3 | Train Loss: 0.586 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.331230878829956
Epoch: 27, Steps: 3 | Train Loss: 0.556 Vali Loss: 1.361 Vali Acc: 0.275 Test Loss: 1.361 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3505914211273193
Epoch: 28, Steps: 3 | Train Loss: 0.509 Vali Loss: 1.353 Vali Acc: 0.275 Test Loss: 1.353 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6326780319213867
Epoch: 29, Steps: 3 | Train Loss: 0.482 Vali Loss: 1.348 Vali Acc: 0.275 Test Loss: 1.348 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2184193134307861
Epoch: 30, Steps: 3 | Train Loss: 0.424 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.300732135772705
Epoch: 31, Steps: 3 | Train Loss: 0.402 Vali Loss: 1.338 Vali Acc: 0.275 Test Loss: 1.338 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2963781356811523
Epoch: 32, Steps: 3 | Train Loss: 0.392 Vali Loss: 1.331 Vali Acc: 0.275 Test Loss: 1.331 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2326619625091553
Epoch: 33, Steps: 3 | Train Loss: 0.367 Vali Loss: 1.327 Vali Acc: 0.300 Test Loss: 1.327 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 34 cost time: 1.1974339485168457
Epoch: 34, Steps: 3 | Train Loss: 0.340 Vali Loss: 1.314 Vali Acc: 0.300 Test Loss: 1.314 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 35 cost time: 1.219519853591919
Epoch: 35, Steps: 3 | Train Loss: 0.343 Vali Loss: 1.300 Vali Acc: 0.325 Test Loss: 1.300 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 36 cost time: 1.2000696659088135
Epoch: 36, Steps: 3 | Train Loss: 0.296 Vali Loss: 1.302 Vali Acc: 0.300 Test Loss: 1.302 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2896478176116943
Epoch: 37, Steps: 3 | Train Loss: 0.276 Vali Loss: 1.301 Vali Acc: 0.300 Test Loss: 1.301 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3740830421447754
Epoch: 38, Steps: 3 | Train Loss: 0.257 Vali Loss: 1.296 Vali Acc: 0.325 Test Loss: 1.296 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 39 cost time: 1.2628509998321533
Epoch: 39, Steps: 3 | Train Loss: 0.256 Vali Loss: 1.275 Vali Acc: 0.325 Test Loss: 1.275 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 40 cost time: 1.388265609741211
Epoch: 40, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.260 Vali Acc: 0.375 Test Loss: 1.260 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 41 cost time: 1.391526460647583
Epoch: 41, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 42 cost time: 1.1771306991577148
Epoch: 42, Steps: 3 | Train Loss: 0.245 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 43 cost time: 1.231611967086792
Epoch: 43, Steps: 3 | Train Loss: 0.186 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 44 cost time: 1.2453343868255615
Epoch: 44, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 45 cost time: 1.2085824012756348
Epoch: 45, Steps: 3 | Train Loss: 0.189 Vali Loss: 1.221 Vali Acc: 0.375 Test Loss: 1.221 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1898131370544434
Epoch: 46, Steps: 3 | Train Loss: 0.121 Vali Loss: 1.231 Vali Acc: 0.375 Test Loss: 1.231 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2601313591003418
Epoch: 47, Steps: 3 | Train Loss: 0.140 Vali Loss: 1.239 Vali Acc: 0.375 Test Loss: 1.239 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3198163509368896
Epoch: 48, Steps: 3 | Train Loss: 0.139 Vali Loss: 1.246 Vali Acc: 0.375 Test Loss: 1.246 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1790106296539307
Epoch: 49, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.249 Vali Acc: 0.375 Test Loss: 1.249 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2753422260284424
Epoch: 50, Steps: 3 | Train Loss: 0.113 Vali Loss: 1.233 Vali Acc: 0.375 Test Loss: 1.233 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.195915699005127
Epoch: 51, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.220 Vali Acc: 0.375 Test Loss: 1.220 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1511602401733398
Epoch: 52, Steps: 3 | Train Loss: 0.106 Vali Loss: 1.195 Vali Acc: 0.425 Test Loss: 1.195 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 53 cost time: 1.1291217803955078
Epoch: 53, Steps: 3 | Train Loss: 0.087 Vali Loss: 1.173 Vali Acc: 0.425 Test Loss: 1.173 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 54 cost time: 1.207345724105835
Epoch: 54, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.169 Vali Acc: 0.425 Test Loss: 1.169 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 55 cost time: 1.2573418617248535
Epoch: 55, Steps: 3 | Train Loss: 0.101 Vali Loss: 1.151 Vali Acc: 0.450 Test Loss: 1.151 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 56 cost time: 1.1985907554626465
Epoch: 56, Steps: 3 | Train Loss: 0.074 Vali Loss: 1.135 Vali Acc: 0.450 Test Loss: 1.135 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449989).  Saving model ...
Epoch: 57 cost time: 1.2048723697662354
Epoch: 57, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.115 Vali Acc: 0.475 Test Loss: 1.115 Test Acc: 0.475
Validation loss decreased (-0.449989 --> -0.474989).  Saving model ...
Epoch: 58 cost time: 1.0787513256072998
Epoch: 58, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.098 Vali Acc: 0.475 Test Loss: 1.098 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 59 cost time: 1.3636460304260254
Epoch: 59, Steps: 3 | Train Loss: 0.077 Vali Loss: 1.093 Vali Acc: 0.475 Test Loss: 1.093 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 60 cost time: 1.2963125705718994
Epoch: 60, Steps: 3 | Train Loss: 0.067 Vali Loss: 1.112 Vali Acc: 0.450 Test Loss: 1.112 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.3273885250091553
Epoch: 61, Steps: 3 | Train Loss: 0.063 Vali Loss: 1.144 Vali Acc: 0.450 Test Loss: 1.144 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.3664517402648926
Epoch: 62, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.165 Vali Acc: 0.375 Test Loss: 1.165 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.3961193561553955
Epoch: 63, Steps: 3 | Train Loss: 0.050 Vali Loss: 1.174 Vali Acc: 0.375 Test Loss: 1.174 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.3779244422912598
Epoch: 64, Steps: 3 | Train Loss: 0.047 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.3928182125091553
Epoch: 65, Steps: 3 | Train Loss: 0.044 Vali Loss: 1.133 Vali Acc: 0.425 Test Loss: 1.133 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.3062677383422852
Epoch: 66, Steps: 3 | Train Loss: 0.051 Vali Loss: 1.124 Vali Acc: 0.475 Test Loss: 1.124 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.4332900047302246
Epoch: 67, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 68 cost time: 1.4229736328125
Epoch: 68, Steps: 3 | Train Loss: 0.058 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 69 cost time: 1.3376307487487793
Epoch: 69, Steps: 3 | Train Loss: 0.049 Vali Loss: 1.077 Vali Acc: 0.525 Test Loss: 1.077 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 70 cost time: 1.2616095542907715
Epoch: 70, Steps: 3 | Train Loss: 0.032 Vali Loss: 1.067 Vali Acc: 0.525 Test Loss: 1.067 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 71 cost time: 1.2110366821289062
Epoch: 71, Steps: 3 | Train Loss: 0.053 Vali Loss: 1.058 Vali Acc: 0.525 Test Loss: 1.058 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 72 cost time: 1.2246363162994385
Epoch: 72, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.056 Vali Acc: 0.525 Test Loss: 1.056 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 73 cost time: 1.31990647315979
Epoch: 73, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 74 cost time: 1.3221149444580078
Epoch: 74, Steps: 3 | Train Loss: 0.041 Vali Loss: 1.069 Vali Acc: 0.550 Test Loss: 1.069 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.2639827728271484
Epoch: 75, Steps: 3 | Train Loss: 0.042 Vali Loss: 1.076 Vali Acc: 0.550 Test Loss: 1.076 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.1857857704162598
Epoch: 76, Steps: 3 | Train Loss: 0.038 Vali Loss: 1.088 Vali Acc: 0.550 Test Loss: 1.088 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.27443528175354
Epoch: 77, Steps: 3 | Train Loss: 0.026 Vali Loss: 1.096 Vali Acc: 0.550 Test Loss: 1.096 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.2284128665924072
Epoch: 78, Steps: 3 | Train Loss: 0.039 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.1833317279815674
Epoch: 79, Steps: 3 | Train Loss: 0.029 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.1780200004577637
Epoch: 80, Steps: 3 | Train Loss: 0.033 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 81 cost time: 1.3012173175811768
Epoch: 81, Steps: 3 | Train Loss: 0.025 Vali Loss: 1.082 Vali Acc: 0.575 Test Loss: 1.082 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 82 cost time: 1.2869789600372314
Epoch: 82, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.072 Vali Acc: 0.575 Test Loss: 1.072 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 83 cost time: 1.267960786819458
Epoch: 83, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.058 Vali Acc: 0.575 Test Loss: 1.058 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 84 cost time: 1.2140991687774658
Epoch: 84, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 85 cost time: 1.3223536014556885
Epoch: 85, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 86 cost time: 1.2406318187713623
Epoch: 86, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 87 cost time: 1.115563154220581
Epoch: 87, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.2223069667816162
Epoch: 88, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 89 cost time: 1.1776187419891357
Epoch: 89, Steps: 3 | Train Loss: 0.023 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.2136852741241455
Epoch: 90, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.1136517524719238
Epoch: 91, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.2417099475860596
Epoch: 92, Steps: 3 | Train Loss: 0.016 Vali Loss: 1.041 Vali Acc: 0.575 Test Loss: 1.041 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.1199429035186768
Epoch: 93, Steps: 3 | Train Loss: 0.021 Vali Loss: 1.038 Vali Acc: 0.575 Test Loss: 1.038 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.3084466457366943
Epoch: 94, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.038 Vali Acc: 0.575 Test Loss: 1.038 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.1716070175170898
Epoch: 95, Steps: 3 | Train Loss: 0.015 Vali Loss: 1.037 Vali Acc: 0.575 Test Loss: 1.037 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 1.2451176643371582
Epoch: 96, Steps: 3 | Train Loss: 0.019 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 97 cost time: 1.2838058471679688
Epoch: 97, Steps: 3 | Train Loss: 0.018 Vali Loss: 1.016 Vali Acc: 0.625 Test Loss: 1.016 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 98 cost time: 1.2697045803070068
Epoch: 98, Steps: 3 | Train Loss: 0.014 Vali Loss: 1.008 Vali Acc: 0.625 Test Loss: 1.008 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 99 cost time: 1.2421536445617676
Epoch: 99, Steps: 3 | Train Loss: 0.013 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 100 cost time: 1.222381353378296
Epoch: 100, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.625
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5784239768981934
Epoch: 1, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.453 Vali Acc: 0.150 Test Loss: 1.453 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 1.202176570892334
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.449 Vali Acc: 0.150 Test Loss: 1.449 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 1.308314323425293
Epoch: 3, Steps: 3 | Train Loss: 1.304 Vali Loss: 1.443 Vali Acc: 0.175 Test Loss: 1.443 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 1.343329668045044
Epoch: 4, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.434 Vali Acc: 0.150 Test Loss: 1.434 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2568559646606445
Epoch: 5, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.425 Vali Acc: 0.150 Test Loss: 1.425 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3314378261566162
Epoch: 6, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.415 Vali Acc: 0.200 Test Loss: 1.415 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 1.3083434104919434
Epoch: 7, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.406 Vali Acc: 0.225 Test Loss: 1.406 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 8 cost time: 1.1140937805175781
Epoch: 8, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.1273396015167236
Epoch: 9, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.2292556762695312
Epoch: 10, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 11 cost time: 1.1698029041290283
Epoch: 11, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 12 cost time: 1.3837652206420898
Epoch: 12, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.363 Vali Acc: 0.300 Test Loss: 1.363 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 13 cost time: 1.2588496208190918
Epoch: 13, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.356 Vali Acc: 0.300 Test Loss: 1.356 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 14 cost time: 1.2771549224853516
Epoch: 14, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.345 Vali Acc: 0.325 Test Loss: 1.345 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 15 cost time: 1.2122435569763184
Epoch: 15, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.334 Vali Acc: 0.325 Test Loss: 1.334 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 16 cost time: 1.2754504680633545
Epoch: 16, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.324 Vali Acc: 0.325 Test Loss: 1.324 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 17 cost time: 1.1812937259674072
Epoch: 17, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.312 Vali Acc: 0.325 Test Loss: 1.312 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 18 cost time: 1.2311596870422363
Epoch: 18, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.300 Vali Acc: 0.325 Test Loss: 1.300 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 19 cost time: 1.153444766998291
Epoch: 19, Steps: 3 | Train Loss: 0.805 Vali Loss: 1.289 Vali Acc: 0.325 Test Loss: 1.289 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 20 cost time: 1.248473882675171
Epoch: 20, Steps: 3 | Train Loss: 0.822 Vali Loss: 1.279 Vali Acc: 0.325 Test Loss: 1.279 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 21 cost time: 1.2838187217712402
Epoch: 21, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.267 Vali Acc: 0.375 Test Loss: 1.267 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 22 cost time: 1.1712777614593506
Epoch: 22, Steps: 3 | Train Loss: 0.735 Vali Loss: 1.256 Vali Acc: 0.350 Test Loss: 1.256 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2000789642333984
Epoch: 23, Steps: 3 | Train Loss: 0.626 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 24 cost time: 1.3187313079833984
Epoch: 24, Steps: 3 | Train Loss: 0.630 Vali Loss: 1.241 Vali Acc: 0.425 Test Loss: 1.241 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 25 cost time: 1.3195903301239014
Epoch: 25, Steps: 3 | Train Loss: 0.585 Vali Loss: 1.230 Vali Acc: 0.425 Test Loss: 1.230 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 26 cost time: 1.2985029220581055
Epoch: 26, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.218 Vali Acc: 0.425 Test Loss: 1.218 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 27 cost time: 1.2513952255249023
Epoch: 27, Steps: 3 | Train Loss: 0.570 Vali Loss: 1.205 Vali Acc: 0.425 Test Loss: 1.205 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 28 cost time: 1.393418312072754
Epoch: 28, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.194 Vali Acc: 0.425 Test Loss: 1.194 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 29 cost time: 1.234081745147705
Epoch: 29, Steps: 3 | Train Loss: 0.477 Vali Loss: 1.184 Vali Acc: 0.425 Test Loss: 1.184 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 30 cost time: 1.2314789295196533
Epoch: 30, Steps: 3 | Train Loss: 0.422 Vali Loss: 1.173 Vali Acc: 0.425 Test Loss: 1.173 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 31 cost time: 1.3837735652923584
Epoch: 31, Steps: 3 | Train Loss: 0.369 Vali Loss: 1.157 Vali Acc: 0.425 Test Loss: 1.157 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 32 cost time: 1.334094762802124
Epoch: 32, Steps: 3 | Train Loss: 0.392 Vali Loss: 1.142 Vali Acc: 0.425 Test Loss: 1.142 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424989).  Saving model ...
Epoch: 33 cost time: 1.3789005279541016
Epoch: 33, Steps: 3 | Train Loss: 0.372 Vali Loss: 1.133 Vali Acc: 0.450 Test Loss: 1.133 Test Acc: 0.450
Validation loss decreased (-0.424989 --> -0.449989).  Saving model ...
Epoch: 34 cost time: 1.3708219528198242
Epoch: 34, Steps: 3 | Train Loss: 0.294 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
Validation loss decreased (-0.449989 --> -0.499989).  Saving model ...
Epoch: 35 cost time: 1.3630597591400146
Epoch: 35, Steps: 3 | Train Loss: 0.346 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 36 cost time: 1.2880902290344238
Epoch: 36, Steps: 3 | Train Loss: 0.291 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 37 cost time: 1.5633912086486816
Epoch: 37, Steps: 3 | Train Loss: 0.268 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 38 cost time: 1.167271375656128
Epoch: 38, Steps: 3 | Train Loss: 0.239 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 39 cost time: 1.2089686393737793
Epoch: 39, Steps: 3 | Train Loss: 0.286 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 40 cost time: 1.3073394298553467
Epoch: 40, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 41 cost time: 1.1691312789916992
Epoch: 41, Steps: 3 | Train Loss: 0.223 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 42 cost time: 1.2124576568603516
Epoch: 42, Steps: 3 | Train Loss: 0.211 Vali Loss: 1.013 Vali Acc: 0.575 Test Loss: 1.013 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2195522785186768
Epoch: 43, Steps: 3 | Train Loss: 0.201 Vali Loss: 1.007 Vali Acc: 0.575 Test Loss: 1.007 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4164090156555176
Epoch: 44, Steps: 3 | Train Loss: 0.163 Vali Loss: 1.004 Vali Acc: 0.575 Test Loss: 1.004 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2543597221374512
Epoch: 45, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.999 Vali Acc: 0.575 Test Loss: 0.999 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1928198337554932
Epoch: 46, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 47 cost time: 1.300926923751831
Epoch: 47, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.989 Vali Acc: 0.625 Test Loss: 0.989 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 48 cost time: 1.1556782722473145
Epoch: 48, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.982 Vali Acc: 0.625 Test Loss: 0.982 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 49 cost time: 1.3189208507537842
Epoch: 49, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.983 Vali Acc: 0.625 Test Loss: 0.983 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1797292232513428
Epoch: 50, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.976 Vali Acc: 0.625 Test Loss: 0.976 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 51 cost time: 1.0907819271087646
Epoch: 51, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.968 Vali Acc: 0.625 Test Loss: 0.968 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 52 cost time: 1.1539924144744873
Epoch: 52, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 53 cost time: 1.206899642944336
Epoch: 53, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.932 Vali Acc: 0.650 Test Loss: 0.932 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 54 cost time: 1.200188159942627
Epoch: 54, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.918 Vali Acc: 0.650 Test Loss: 0.918 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 55 cost time: 1.235964059829712
Epoch: 55, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.900 Vali Acc: 0.650 Test Loss: 0.900 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 56 cost time: 1.152251958847046
Epoch: 56, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.886 Vali Acc: 0.650 Test Loss: 0.886 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 57 cost time: 1.1686878204345703
Epoch: 57, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.878 Vali Acc: 0.650 Test Loss: 0.878 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 58 cost time: 1.1830899715423584
Epoch: 58, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.874 Vali Acc: 0.650 Test Loss: 0.874 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 59 cost time: 1.2166719436645508
Epoch: 59, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.870 Vali Acc: 0.650 Test Loss: 0.870 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 60 cost time: 1.2250440120697021
Epoch: 60, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.869 Vali Acc: 0.650 Test Loss: 0.869 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 61 cost time: 1.250692367553711
Epoch: 61, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.875 Vali Acc: 0.650 Test Loss: 0.875 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.2481486797332764
Epoch: 62, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.872 Vali Acc: 0.650 Test Loss: 0.872 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.2936925888061523
Epoch: 63, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.864 Vali Acc: 0.650 Test Loss: 0.864 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 64 cost time: 1.2709195613861084
Epoch: 64, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.851 Vali Acc: 0.650 Test Loss: 0.851 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 65 cost time: 1.360884666442871
Epoch: 65, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.837 Vali Acc: 0.675 Test Loss: 0.837 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674992).  Saving model ...
Epoch: 66 cost time: 1.2845025062561035
Epoch: 66, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.833 Vali Acc: 0.675 Test Loss: 0.833 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 67 cost time: 1.1840827465057373
Epoch: 67, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.830 Vali Acc: 0.700 Test Loss: 0.830 Test Acc: 0.700
Validation loss decreased (-0.674992 --> -0.699992).  Saving model ...
Epoch: 68 cost time: 1.2910728454589844
Epoch: 68, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.826 Vali Acc: 0.700 Test Loss: 0.826 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 69 cost time: 1.3807618618011475
Epoch: 69, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.817 Vali Acc: 0.700 Test Loss: 0.817 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 70 cost time: 1.3908624649047852
Epoch: 70, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.810 Vali Acc: 0.700 Test Loss: 0.810 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 71 cost time: 1.3875112533569336
Epoch: 71, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.803 Vali Acc: 0.725 Test Loss: 0.803 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 72 cost time: 1.3147609233856201
Epoch: 72, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 73 cost time: 1.3354592323303223
Epoch: 73, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.799 Vali Acc: 0.725 Test Loss: 0.799 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 74 cost time: 1.3784449100494385
Epoch: 74, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.800 Vali Acc: 0.725 Test Loss: 0.800 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.4027860164642334
Epoch: 75, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.801 Vali Acc: 0.725 Test Loss: 0.801 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.340555191040039
Epoch: 76, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.803 Vali Acc: 0.700 Test Loss: 0.803 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.2505009174346924
Epoch: 77, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.807 Vali Acc: 0.700 Test Loss: 0.807 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.3102498054504395
Epoch: 78, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.811 Vali Acc: 0.725 Test Loss: 0.811 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.3704495429992676
Epoch: 79, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749992).  Saving model ...
Epoch: 80 cost time: 1.3625409603118896
Epoch: 80, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.818 Vali Acc: 0.750 Test Loss: 0.818 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.3117642402648926
Epoch: 81, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.2628977298736572
Epoch: 82, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.3333427906036377
Epoch: 83, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.823 Vali Acc: 0.725 Test Loss: 0.823 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.217118740081787
Epoch: 84, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.817 Vali Acc: 0.725 Test Loss: 0.817 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.2511346340179443
Epoch: 85, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.812 Vali Acc: 0.750 Test Loss: 0.812 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 86 cost time: 1.3733906745910645
Epoch: 86, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 87 cost time: 1.3436830043792725
Epoch: 87, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.2790653705596924
Epoch: 88, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.2138519287109375
Epoch: 89, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.790 Vali Acc: 0.750 Test Loss: 0.790 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.2679145336151123
Epoch: 90, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.787 Vali Acc: 0.750 Test Loss: 0.787 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.1501598358154297
Epoch: 91, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.141444206237793
Epoch: 92, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.2536768913269043
Epoch: 93, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.783 Vali Acc: 0.750 Test Loss: 0.783 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.1897735595703125
Epoch: 94, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.783 Vali Acc: 0.725 Test Loss: 0.783 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.1213939189910889
Epoch: 95, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 1.2424933910369873
Epoch: 96, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.782 Vali Acc: 0.725 Test Loss: 0.782 Test Acc: 0.725
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3536787033081055
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1114344596862793
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2113537788391113
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.1812164783477783
Epoch: 4, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.3143911361694336
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.2318975925445557
Epoch: 6, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.237849235534668
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.2635235786437988
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.2667481899261475
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.395463466644287
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.238938808441162
Epoch: 11, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.2775537967681885
Epoch: 12, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.2521352767944336
Epoch: 13, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0890309810638428
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1741933822631836
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.227569818496704
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2564902305603027
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2533988952636719
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2282078266143799
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2463371753692627
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2455806732177734
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.394526720046997
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 248932
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.514458417892456
Epoch: 1, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.310 Vali Acc: 0.300 Test Loss: 1.310 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 1.245203971862793
Epoch: 2, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.284 Vali Acc: 0.325 Test Loss: 1.284 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 1.3722403049468994
Epoch: 3, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.257 Vali Acc: 0.375 Test Loss: 1.257 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.2286808490753174
Epoch: 4, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.222 Vali Acc: 0.525 Test Loss: 1.222 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 1.30625319480896
Epoch: 5, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.180 Vali Acc: 0.575 Test Loss: 1.180 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 1.2448515892028809
Epoch: 6, Steps: 3 | Train Loss: 1.097 Vali Loss: 1.137 Vali Acc: 0.625 Test Loss: 1.137 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.5480849742889404
Epoch: 7, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 1.3519370555877686
Epoch: 8, Steps: 3 | Train Loss: 0.971 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 1.2895846366882324
Epoch: 9, Steps: 3 | Train Loss: 0.912 Vali Loss: 0.992 Vali Acc: 0.725 Test Loss: 0.992 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 1.2763442993164062
Epoch: 10, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.945 Vali Acc: 0.725 Test Loss: 0.945 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 1.2938592433929443
Epoch: 11, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 1.240821123123169
Epoch: 12, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 1.2528810501098633
Epoch: 13, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.817 Vali Acc: 0.825 Test Loss: 0.817 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 1.3002738952636719
Epoch: 14, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.776 Vali Acc: 0.825 Test Loss: 0.776 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 1.2681829929351807
Epoch: 15, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.730 Vali Acc: 0.825 Test Loss: 0.730 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 1.3173677921295166
Epoch: 16, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.2594590187072754
Epoch: 17, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.650 Vali Acc: 0.900 Test Loss: 0.650 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 1.4722020626068115
Epoch: 18, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 1.1917359828948975
Epoch: 19, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 1.116736650466919
Epoch: 20, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 1.3533921241760254
Epoch: 21, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 1.1798317432403564
Epoch: 22, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.2204055786132812
Epoch: 23, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 1.205782175064087
Epoch: 24, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 1.1937921047210693
Epoch: 25, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.1735522747039795
Epoch: 26, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 1.1800715923309326
Epoch: 27, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 1.2365102767944336
Epoch: 28, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 1.2020387649536133
Epoch: 29, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 1.2934250831604004
Epoch: 30, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 1.318037748336792
Epoch: 31, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 1.3842134475708008
Epoch: 32, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 1.3801188468933105
Epoch: 33, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 1.2592110633850098
Epoch: 34, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 1.3037874698638916
Epoch: 35, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.3097670078277588
Epoch: 36, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.1778972148895264
Epoch: 37, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.374253511428833
Epoch: 38, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 1.2941522598266602
Epoch: 39, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 1.3221049308776855
Epoch: 40, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 1.3303096294403076
Epoch: 41, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 1.4124419689178467
Epoch: 42, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 1.2868590354919434
Epoch: 43, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.321 Vali Acc: 0.925 Test Loss: 0.321 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 1.4081871509552002
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 1.3675031661987305
Epoch: 45, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 1.4754698276519775
Epoch: 46, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 47 cost time: 1.4497098922729492
Epoch: 47, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 48 cost time: 1.3868999481201172
Epoch: 48, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 49 cost time: 1.4454505443572998
Epoch: 49, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 1.3731238842010498
Epoch: 50, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 51 cost time: 1.3036160469055176
Epoch: 51, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 52 cost time: 1.362363576889038
Epoch: 52, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 53 cost time: 1.2757933139801025
Epoch: 53, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 54 cost time: 1.2652297019958496
Epoch: 54, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 55 cost time: 1.3030476570129395
Epoch: 55, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 56 cost time: 1.3020405769348145
Epoch: 56, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 57 cost time: 1.3198363780975342
Epoch: 57, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 58 cost time: 1.2717881202697754
Epoch: 58, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 59 cost time: 1.3027281761169434
Epoch: 59, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 60 cost time: 1.3674945831298828
Epoch: 60, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 61 cost time: 1.3801851272583008
Epoch: 61, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 62 cost time: 1.3962321281433105
Epoch: 62, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 63 cost time: 1.3218793869018555
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 64 cost time: 1.3796281814575195
Epoch: 64, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 65 cost time: 1.300492286682129
Epoch: 65, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 66 cost time: 1.3443067073822021
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 67 cost time: 1.4981770515441895
Epoch: 67, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.4324579238891602
Epoch: 68, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.4781289100646973
Epoch: 69, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.3743796348571777
Epoch: 70, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.3406407833099365
Epoch: 71, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.3988018035888672
Epoch: 72, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.3528895378112793
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.4857068061828613
Epoch: 74, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.3347558975219727
Epoch: 75, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.354550838470459
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 77 cost time: 1.3658320903778076
Epoch: 77, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 78 cost time: 1.372288703918457
Epoch: 78, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 79 cost time: 1.297581672668457
Epoch: 79, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 80 cost time: 1.3001210689544678
Epoch: 80, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 81 cost time: 1.3535237312316895
Epoch: 81, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 82 cost time: 1.3145074844360352
Epoch: 82, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 83 cost time: 1.286958932876587
Epoch: 83, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 84 cost time: 1.2734007835388184
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 85 cost time: 1.1876153945922852
Epoch: 85, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 86 cost time: 1.3360695838928223
Epoch: 86, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 87 cost time: 1.278160810470581
Epoch: 87, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 88 cost time: 1.2206952571868896
Epoch: 88, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 89 cost time: 1.3212461471557617
Epoch: 89, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 90 cost time: 1.41943359375
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 91 cost time: 1.2166252136230469
Epoch: 91, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 92 cost time: 1.1956627368927002
Epoch: 92, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 93 cost time: 1.2367911338806152
Epoch: 93, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 94 cost time: 1.2771615982055664
Epoch: 94, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 95 cost time: 1.3269755840301514
Epoch: 95, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 96 cost time: 1.3638181686401367
Epoch: 96, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 97 cost time: 1.3799381256103516
Epoch: 97, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 98 cost time: 1.440319299697876
Epoch: 98, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 99 cost time: 1.5569796562194824
Epoch: 99, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 100 cost time: 1.6528942584991455
Epoch: 100, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5140511989593506
Epoch: 1, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.333 Vali Acc: 0.275 Test Loss: 1.333 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 1.1774296760559082
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.307 Vali Acc: 0.300 Test Loss: 1.307 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 1.214479923248291
Epoch: 3, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.281 Vali Acc: 0.325 Test Loss: 1.281 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 1.2021992206573486
Epoch: 4, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.246 Vali Acc: 0.375 Test Loss: 1.246 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 1.2642426490783691
Epoch: 5, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.205 Vali Acc: 0.425 Test Loss: 1.205 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 1.2912793159484863
Epoch: 6, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.162 Vali Acc: 0.600 Test Loss: 1.162 Test Acc: 0.600
Validation loss decreased (-0.424988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.197702407836914
Epoch: 7, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 1.1618688106536865
Epoch: 8, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.0543994903564453
Epoch: 9, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.016 Vali Acc: 0.650 Test Loss: 1.016 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 1.0557427406311035
Epoch: 10, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.969 Vali Acc: 0.675 Test Loss: 0.969 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 1.1453003883361816
Epoch: 11, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.924 Vali Acc: 0.700 Test Loss: 0.924 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 1.2175507545471191
Epoch: 12, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.1214547157287598
Epoch: 13, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 1.1514921188354492
Epoch: 14, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.115746259689331
Epoch: 15, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.13545823097229
Epoch: 16, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 1.2086408138275146
Epoch: 17, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.1358845233917236
Epoch: 18, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 19 cost time: 1.0636239051818848
Epoch: 19, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 20 cost time: 1.1680617332458496
Epoch: 20, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 21 cost time: 1.0785157680511475
Epoch: 21, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 1.0071401596069336
Epoch: 22, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.544 Vali Acc: 0.875 Test Loss: 0.544 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 23 cost time: 1.0323066711425781
Epoch: 23, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 24 cost time: 1.0787572860717773
Epoch: 24, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.511 Vali Acc: 0.875 Test Loss: 0.511 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 25 cost time: 1.1412863731384277
Epoch: 25, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 26 cost time: 1.0679290294647217
Epoch: 26, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 1.0805718898773193
Epoch: 27, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.0286595821380615
Epoch: 28, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.138176441192627
Epoch: 29, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.1131303310394287
Epoch: 30, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 1.1844823360443115
Epoch: 31, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 1.121652364730835
Epoch: 32, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 1.1111202239990234
Epoch: 33, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 1.1212348937988281
Epoch: 34, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 1.0995371341705322
Epoch: 35, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 1.1066761016845703
Epoch: 36, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 1.2868733406066895
Epoch: 37, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 1.21522855758667
Epoch: 38, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 1.1275081634521484
Epoch: 39, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 40 cost time: 1.111060619354248
Epoch: 40, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 1.1956636905670166
Epoch: 41, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 1.1433501243591309
Epoch: 42, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 1.127305269241333
Epoch: 43, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 1.144301176071167
Epoch: 44, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.377 Vali Acc: 0.900 Test Loss: 0.377 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 1.1863038539886475
Epoch: 45, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 1.208648443222046
Epoch: 46, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 1.1030635833740234
Epoch: 47, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 1.1317570209503174
Epoch: 48, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 1.2547812461853027
Epoch: 49, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 50 cost time: 1.2600789070129395
Epoch: 50, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 1.1492948532104492
Epoch: 51, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.365 Vali Acc: 0.900 Test Loss: 0.365 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 1.1521339416503906
Epoch: 52, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.364 Vali Acc: 0.900 Test Loss: 0.364 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 1.1858596801757812
Epoch: 53, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 1.1141273975372314
Epoch: 54, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 1.165555477142334
Epoch: 55, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 1.2663781642913818
Epoch: 56, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 1.1638529300689697
Epoch: 57, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 1.1908812522888184
Epoch: 58, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 1.1848571300506592
Epoch: 59, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 60 cost time: 1.1845016479492188
Epoch: 60, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 1.171976089477539
Epoch: 61, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 62 cost time: 1.237703561782837
Epoch: 62, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 63 cost time: 1.1104247570037842
Epoch: 63, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 64 cost time: 1.1537435054779053
Epoch: 64, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 65 cost time: 1.2517898082733154
Epoch: 65, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 66 cost time: 1.2820048332214355
Epoch: 66, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 67 cost time: 1.3052356243133545
Epoch: 67, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 68 cost time: 1.298929214477539
Epoch: 68, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 69 cost time: 1.2130889892578125
Epoch: 69, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 70 cost time: 1.2295091152191162
Epoch: 70, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 71 cost time: 1.3507487773895264
Epoch: 71, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 72 cost time: 1.1933939456939697
Epoch: 72, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 73 cost time: 1.3412723541259766
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 74 cost time: 1.2537095546722412
Epoch: 74, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 75 cost time: 1.2715985774993896
Epoch: 75, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 76 cost time: 1.339066505432129
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 77 cost time: 1.2201378345489502
Epoch: 77, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 78 cost time: 1.2206284999847412
Epoch: 78, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 79 cost time: 1.3986988067626953
Epoch: 79, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 80 cost time: 1.1585159301757812
Epoch: 80, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 81 cost time: 1.086076021194458
Epoch: 81, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 82 cost time: 1.1507837772369385
Epoch: 82, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 83 cost time: 1.2124946117401123
Epoch: 83, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 84 cost time: 1.0856704711914062
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 85 cost time: 1.1921024322509766
Epoch: 85, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 86 cost time: 1.1621918678283691
Epoch: 86, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 87 cost time: 1.10420823097229
Epoch: 87, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 88 cost time: 1.1855697631835938
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 89 cost time: 1.1768798828125
Epoch: 89, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.900 Test Loss: 0.327 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 90 cost time: 1.1752383708953857
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 91 cost time: 1.1441080570220947
Epoch: 91, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 92 cost time: 1.1965997219085693
Epoch: 92, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 93 cost time: 1.151036024093628
Epoch: 93, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 94 cost time: 1.1296701431274414
Epoch: 94, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 95 cost time: 1.1789209842681885
Epoch: 95, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 96 cost time: 1.130176305770874
Epoch: 96, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 97 cost time: 1.0922701358795166
Epoch: 97, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 98 cost time: 1.0996198654174805
Epoch: 98, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 99 cost time: 1.173621416091919
Epoch: 99, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 100 cost time: 1.0535931587219238
Epoch: 100, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.45505428314209
Epoch: 1, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.342 Vali Acc: 0.300 Test Loss: 1.342 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 1.1334683895111084
Epoch: 2, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.320 Vali Acc: 0.300 Test Loss: 1.320 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 1.1885120868682861
Epoch: 3, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.297 Vali Acc: 0.325 Test Loss: 1.297 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 1.358755350112915
Epoch: 4, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.265 Vali Acc: 0.375 Test Loss: 1.265 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.3687827587127686
Epoch: 5, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.2115893363952637
Epoch: 6, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.2240095138549805
Epoch: 7, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2203443050384521
Epoch: 8, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.099 Vali Acc: 0.625 Test Loss: 1.099 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.260054111480713
Epoch: 9, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.4000754356384277
Epoch: 10, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.010 Vali Acc: 0.675 Test Loss: 1.010 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 1.2849030494689941
Epoch: 11, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.968 Vali Acc: 0.700 Test Loss: 0.968 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.3122503757476807
Epoch: 12, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.927 Vali Acc: 0.725 Test Loss: 0.927 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 1.4441068172454834
Epoch: 13, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.888 Vali Acc: 0.700 Test Loss: 0.888 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.292480230331421
Epoch: 14, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.850 Vali Acc: 0.725 Test Loss: 0.850 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 15 cost time: 1.2805087566375732
Epoch: 15, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.806 Vali Acc: 0.775 Test Loss: 0.806 Test Acc: 0.775
Validation loss decreased (-0.724992 --> -0.774992).  Saving model ...
Epoch: 16 cost time: 1.1115972995758057
Epoch: 16, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.768 Vali Acc: 0.775 Test Loss: 0.768 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 1.0896539688110352
Epoch: 17, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 1.122925043106079
Epoch: 18, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 1.2057642936706543
Epoch: 19, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.663 Vali Acc: 0.900 Test Loss: 0.663 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 1.2052996158599854
Epoch: 20, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 1.223693609237671
Epoch: 21, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 1.1585462093353271
Epoch: 22, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.4408023357391357
Epoch: 23, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 1.46217942237854
Epoch: 24, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 1.0967340469360352
Epoch: 25, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 1.1784913539886475
Epoch: 26, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 1.3347408771514893
Epoch: 27, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.515 Vali Acc: 0.925 Test Loss: 0.515 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 1.2100706100463867
Epoch: 28, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.504 Vali Acc: 0.925 Test Loss: 0.504 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 1.1424968242645264
Epoch: 29, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 1.3364508152008057
Epoch: 30, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 1.3958008289337158
Epoch: 31, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 1.2786316871643066
Epoch: 32, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 1.3098478317260742
Epoch: 33, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 1.1273512840270996
Epoch: 34, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 1.2546062469482422
Epoch: 35, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 1.1336090564727783
Epoch: 36, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 1.226909875869751
Epoch: 37, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 1.1786320209503174
Epoch: 38, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 39 cost time: 1.3017075061798096
Epoch: 39, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.2067043781280518
Epoch: 40, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.1822617053985596
Epoch: 41, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 1.2965381145477295
Epoch: 42, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 1.1539957523345947
Epoch: 43, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 1.3013062477111816
Epoch: 44, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 1.2597055435180664
Epoch: 45, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 1.1364250183105469
Epoch: 46, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.429 Vali Acc: 0.950 Test Loss: 0.429 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 1.270967960357666
Epoch: 47, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 1.2308757305145264
Epoch: 48, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 49 cost time: 1.0620474815368652
Epoch: 49, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 1.1055057048797607
Epoch: 50, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 51 cost time: 1.1397206783294678
Epoch: 51, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 52 cost time: 1.0030663013458252
Epoch: 52, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 53 cost time: 1.1605548858642578
Epoch: 53, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9984128475189209
Epoch: 54, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 55 cost time: 1.1851773262023926
Epoch: 55, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 56 cost time: 1.2014613151550293
Epoch: 56, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 57 cost time: 1.2089595794677734
Epoch: 57, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 58 cost time: 1.136425256729126
Epoch: 58, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 59 cost time: 1.2388577461242676
Epoch: 59, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 60 cost time: 1.1924047470092773
Epoch: 60, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 61 cost time: 1.2459619045257568
Epoch: 61, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 62 cost time: 1.1424696445465088
Epoch: 62, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 63 cost time: 1.1284568309783936
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 64 cost time: 1.318906307220459
Epoch: 64, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 65 cost time: 1.1538262367248535
Epoch: 65, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 66 cost time: 1.3344590663909912
Epoch: 66, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 67 cost time: 1.2222721576690674
Epoch: 67, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 68 cost time: 1.2141368389129639
Epoch: 68, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 69 cost time: 1.1901795864105225
Epoch: 69, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 70 cost time: 1.1280274391174316
Epoch: 70, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 71 cost time: 1.2477476596832275
Epoch: 71, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 72 cost time: 1.3633131980895996
Epoch: 72, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.236480712890625
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 74 cost time: 1.2138710021972656
Epoch: 74, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 75 cost time: 1.3113903999328613
Epoch: 75, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.2025036811828613
Epoch: 76, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.2367815971374512
Epoch: 77, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.2792162895202637
Epoch: 78, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.1715598106384277
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.3544604778289795
Epoch: 80, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.1104047298431396
Epoch: 81, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.1079010963439941
Epoch: 82, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 1.2551038265228271
Epoch: 83, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 1.1324665546417236
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.472874879837036
Epoch: 1, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1961314678192139
Epoch: 2, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.352 Vali Acc: 0.250 Test Loss: 1.352 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2090785503387451
Epoch: 3, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.328 Vali Acc: 0.250 Test Loss: 1.328 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 1.2700424194335938
Epoch: 4, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.293 Vali Acc: 0.300 Test Loss: 1.293 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 1.370201587677002
Epoch: 5, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.252 Vali Acc: 0.375 Test Loss: 1.252 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.2320268154144287
Epoch: 6, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.233520269393921
Epoch: 7, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.162 Vali Acc: 0.550 Test Loss: 1.162 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.1608829498291016
Epoch: 8, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.2485973834991455
Epoch: 9, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.2652184963226318
Epoch: 10, Steps: 3 | Train Loss: 0.843 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 1.2281780242919922
Epoch: 11, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.974 Vali Acc: 0.700 Test Loss: 0.974 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.5387864112854004
Epoch: 12, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.931 Vali Acc: 0.725 Test Loss: 0.931 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 1.331003189086914
Epoch: 13, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.891 Vali Acc: 0.750 Test Loss: 0.891 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.1922767162322998
Epoch: 14, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.2556178569793701
Epoch: 15, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.813 Vali Acc: 0.800 Test Loss: 0.813 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.3529834747314453
Epoch: 16, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.3253016471862793
Epoch: 17, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.374403715133667
Epoch: 18, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.712 Vali Acc: 0.825 Test Loss: 0.712 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 1.2554583549499512
Epoch: 19, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.686 Vali Acc: 0.825 Test Loss: 0.686 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 1.3239624500274658
Epoch: 20, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.663 Vali Acc: 0.825 Test Loss: 0.663 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.354745626449585
Epoch: 21, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.643 Vali Acc: 0.800 Test Loss: 0.643 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2564184665679932
Epoch: 22, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3426389694213867
Epoch: 23, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.611 Vali Acc: 0.800 Test Loss: 0.611 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.25673508644104
Epoch: 24, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.596 Vali Acc: 0.800 Test Loss: 0.596 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.172410488128662
Epoch: 25, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.205183506011963
Epoch: 26, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.572 Vali Acc: 0.800 Test Loss: 0.572 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1290068626403809
Epoch: 27, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.563 Vali Acc: 0.800 Test Loss: 0.563 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3139066696166992
Epoch: 28, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.556 Vali Acc: 0.800 Test Loss: 0.556 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2903430461883545
Epoch: 29, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.550 Vali Acc: 0.800 Test Loss: 0.550 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1530179977416992
Epoch: 30, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.548 Vali Acc: 0.800 Test Loss: 0.548 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.093233108520508
Epoch: 1, Steps: 3 | Train Loss: 1.270 Vali Loss: 1.372 Vali Acc: 0.275 Test Loss: 1.372 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.0929467678070068
Epoch: 2, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.350 Vali Acc: 0.275 Test Loss: 1.350 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.148500919342041
Epoch: 3, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.327 Vali Acc: 0.325 Test Loss: 1.327 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 1.132030725479126
Epoch: 4, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.1749727725982666
Epoch: 5, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.1350786685943604
Epoch: 6, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.0761451721191406
Epoch: 7, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.185 Vali Acc: 0.550 Test Loss: 1.185 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.2332091331481934
Epoch: 8, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.143 Vali Acc: 0.575 Test Loss: 1.143 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.2017543315887451
Epoch: 9, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.104 Vali Acc: 0.650 Test Loss: 1.104 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.2429883480072021
Epoch: 10, Steps: 3 | Train Loss: 0.825 Vali Loss: 1.066 Vali Acc: 0.625 Test Loss: 1.066 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1755902767181396
Epoch: 11, Steps: 3 | Train Loss: 0.785 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2753074169158936
Epoch: 12, Steps: 3 | Train Loss: 0.690 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2408511638641357
Epoch: 13, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.970 Vali Acc: 0.625 Test Loss: 0.970 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1635487079620361
Epoch: 14, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.16511869430542
Epoch: 15, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.905 Vali Acc: 0.700 Test Loss: 0.905 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.1498031616210938
Epoch: 16, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 1.2310268878936768
Epoch: 17, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 1.3207426071166992
Epoch: 18, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 19 cost time: 1.2817192077636719
Epoch: 19, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 1.3251593112945557
Epoch: 20, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.773 Vali Acc: 0.800 Test Loss: 0.773 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 1.2063281536102295
Epoch: 21, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 1.1882600784301758
Epoch: 22, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.3459806442260742
Epoch: 23, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 1.202662706375122
Epoch: 24, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1428663730621338
Epoch: 25, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2442700862884521
Epoch: 26, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.689 Vali Acc: 0.775 Test Loss: 0.689 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.191145896911621
Epoch: 27, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1146111488342285
Epoch: 28, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.136615514755249
Epoch: 29, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.651 Vali Acc: 0.775 Test Loss: 0.651 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1732587814331055
Epoch: 30, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0945136547088623
Epoch: 31, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1579647064208984
Epoch: 32, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 33 cost time: 1.3160679340362549
Epoch: 33, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2239995002746582
Epoch: 34, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 35 cost time: 1.1875286102294922
Epoch: 35, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.632 Vali Acc: 0.800 Test Loss: 0.632 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 36 cost time: 1.147479772567749
Epoch: 36, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0662922859191895
Epoch: 37, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2409143447875977
Epoch: 38, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.173792839050293
Epoch: 39, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 40 cost time: 1.1987054347991943
Epoch: 40, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 41 cost time: 1.1618473529815674
Epoch: 41, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.625 Vali Acc: 0.800 Test Loss: 0.625 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1584842205047607
Epoch: 42, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 43 cost time: 1.1322507858276367
Epoch: 43, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.620 Vali Acc: 0.775 Test Loss: 0.620 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1736745834350586
Epoch: 44, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.614 Vali Acc: 0.800 Test Loss: 0.614 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 45 cost time: 1.2025980949401855
Epoch: 45, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.612 Vali Acc: 0.800 Test Loss: 0.612 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 46 cost time: 1.2342190742492676
Epoch: 46, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.609 Vali Acc: 0.800 Test Loss: 0.609 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 47 cost time: 1.2278001308441162
Epoch: 47, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 48 cost time: 1.227370023727417
Epoch: 48, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1415657997131348
Epoch: 49, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2126243114471436
Epoch: 50, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1036357879638672
Epoch: 51, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2110669612884521
Epoch: 52, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.599 Vali Acc: 0.775 Test Loss: 0.599 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2404825687408447
Epoch: 53, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.3449561595916748
Epoch: 54, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.1722753047943115
Epoch: 55, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.1264851093292236
Epoch: 56, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.599 Vali Acc: 0.775 Test Loss: 0.599 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.2120354175567627
Epoch: 57, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.599 Vali Acc: 0.775 Test Loss: 0.599 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.416849136352539
Epoch: 1, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.2049460411071777
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.367 Vali Acc: 0.375 Test Loss: 1.367 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.1412274837493896
Epoch: 3, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.1544480323791504
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.1609976291656494
Epoch: 5, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.238788366317749
Epoch: 6, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1667852401733398
Epoch: 7, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 1.2251803874969482
Epoch: 8, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 1.147031307220459
Epoch: 9, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 1.1319658756256104
Epoch: 10, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 1.1984131336212158
Epoch: 11, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.233 Vali Acc: 0.375 Test Loss: 1.233 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2039127349853516
Epoch: 12, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.220 Vali Acc: 0.375 Test Loss: 1.220 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.152742624282837
Epoch: 13, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.206 Vali Acc: 0.425 Test Loss: 1.206 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 14 cost time: 1.2841894626617432
Epoch: 14, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.3056974411010742
Epoch: 15, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.2226614952087402
Epoch: 16, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.164 Vali Acc: 0.525 Test Loss: 1.164 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 17 cost time: 1.308509349822998
Epoch: 17, Steps: 3 | Train Loss: 0.807 Vali Loss: 1.145 Vali Acc: 0.525 Test Loss: 1.145 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 18 cost time: 1.3719215393066406
Epoch: 18, Steps: 3 | Train Loss: 0.747 Vali Loss: 1.127 Vali Acc: 0.525 Test Loss: 1.127 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 19 cost time: 1.3642656803131104
Epoch: 19, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.111 Vali Acc: 0.525 Test Loss: 1.111 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 20 cost time: 1.2913079261779785
Epoch: 20, Steps: 3 | Train Loss: 0.688 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 21 cost time: 1.3394694328308105
Epoch: 21, Steps: 3 | Train Loss: 0.604 Vali Loss: 1.078 Vali Acc: 0.550 Test Loss: 1.078 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 22 cost time: 1.3665730953216553
Epoch: 22, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.063 Vali Acc: 0.550 Test Loss: 1.063 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 23 cost time: 1.318800926208496
Epoch: 23, Steps: 3 | Train Loss: 0.595 Vali Loss: 1.051 Vali Acc: 0.550 Test Loss: 1.051 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 24 cost time: 1.3023171424865723
Epoch: 24, Steps: 3 | Train Loss: 0.544 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 25 cost time: 1.414799690246582
Epoch: 25, Steps: 3 | Train Loss: 0.510 Vali Loss: 1.020 Vali Acc: 0.575 Test Loss: 1.020 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 26 cost time: 1.384467363357544
Epoch: 26, Steps: 3 | Train Loss: 0.462 Vali Loss: 1.000 Vali Acc: 0.550 Test Loss: 1.000 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4352893829345703
Epoch: 27, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.983 Vali Acc: 0.600 Test Loss: 0.983 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 28 cost time: 1.3377814292907715
Epoch: 28, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 29 cost time: 1.2789747714996338
Epoch: 29, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.955 Vali Acc: 0.650 Test Loss: 0.955 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 30 cost time: 1.3148016929626465
Epoch: 30, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.949 Vali Acc: 0.675 Test Loss: 0.949 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 31 cost time: 1.2959372997283936
Epoch: 31, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.939 Vali Acc: 0.700 Test Loss: 0.939 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 32 cost time: 1.1763935089111328
Epoch: 32, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.930 Vali Acc: 0.700 Test Loss: 0.930 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 33 cost time: 1.2457315921783447
Epoch: 33, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.917 Vali Acc: 0.700 Test Loss: 0.917 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 34 cost time: 1.2633590698242188
Epoch: 34, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.908 Vali Acc: 0.725 Test Loss: 0.908 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 35 cost time: 1.1745045185089111
Epoch: 35, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.896 Vali Acc: 0.725 Test Loss: 0.896 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 36 cost time: 1.2069268226623535
Epoch: 36, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.887 Vali Acc: 0.700 Test Loss: 0.887 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.298865795135498
Epoch: 37, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.882 Vali Acc: 0.700 Test Loss: 0.882 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.265458106994629
Epoch: 38, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.873 Vali Acc: 0.700 Test Loss: 0.873 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2696270942687988
Epoch: 39, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.863 Vali Acc: 0.725 Test Loss: 0.863 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 40 cost time: 1.2237756252288818
Epoch: 40, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.855 Vali Acc: 0.750 Test Loss: 0.855 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 41 cost time: 1.1236474514007568
Epoch: 41, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 42 cost time: 1.1935129165649414
Epoch: 42, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 43 cost time: 1.1465110778808594
Epoch: 43, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 44 cost time: 1.1883790493011475
Epoch: 44, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 45 cost time: 1.1426174640655518
Epoch: 45, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 46 cost time: 1.2319021224975586
Epoch: 46, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.818 Vali Acc: 0.725 Test Loss: 0.818 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3912577629089355
Epoch: 47, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.810 Vali Acc: 0.725 Test Loss: 0.810 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2178025245666504
Epoch: 48, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 49 cost time: 1.1328833103179932
Epoch: 49, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 50 cost time: 1.2223408222198486
Epoch: 50, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.791 Vali Acc: 0.775 Test Loss: 0.791 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 51 cost time: 1.2212498188018799
Epoch: 51, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 52 cost time: 1.1406276226043701
Epoch: 52, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.786 Vali Acc: 0.775 Test Loss: 0.786 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 53 cost time: 1.1776032447814941
Epoch: 53, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1815109252929688
Epoch: 54, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.786 Vali Acc: 0.775 Test Loss: 0.786 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 55 cost time: 1.245051622390747
Epoch: 55, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.784 Vali Acc: 0.775 Test Loss: 0.784 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 56 cost time: 1.2281336784362793
Epoch: 56, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 57 cost time: 1.2431297302246094
Epoch: 57, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 58 cost time: 1.3003191947937012
Epoch: 58, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 59 cost time: 1.387019395828247
Epoch: 59, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.188952922821045
Epoch: 60, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.752 Vali Acc: 0.750 Test Loss: 0.752 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.2891321182250977
Epoch: 61, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.747 Vali Acc: 0.750 Test Loss: 0.747 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2070932388305664
Epoch: 62, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.743 Vali Acc: 0.750 Test Loss: 0.743 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1128599643707275
Epoch: 63, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.738 Vali Acc: 0.750 Test Loss: 0.738 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.1610631942749023
Epoch: 64, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.734 Vali Acc: 0.750 Test Loss: 0.734 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.28814697265625
Epoch: 65, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.203995704650879
Epoch: 66, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.2223985195159912
Epoch: 67, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.712 Vali Acc: 0.750 Test Loss: 0.712 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.2331125736236572
Epoch: 68, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2708864212036133
Epoch: 1, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.432 Vali Acc: 0.350 Test Loss: 1.432 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.096127986907959
Epoch: 2, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.429 Vali Acc: 0.350 Test Loss: 1.429 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.228111982345581
Epoch: 3, Steps: 3 | Train Loss: 1.551 Vali Loss: 1.422 Vali Acc: 0.300 Test Loss: 1.422 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2363801002502441
Epoch: 4, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.413 Vali Acc: 0.300 Test Loss: 1.413 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1438679695129395
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.402 Vali Acc: 0.275 Test Loss: 1.402 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2295947074890137
Epoch: 6, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.392 Vali Acc: 0.275 Test Loss: 1.392 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.097346544265747
Epoch: 7, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.383 Vali Acc: 0.325 Test Loss: 1.383 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1401786804199219
Epoch: 8, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1529595851898193
Epoch: 9, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.365 Vali Acc: 0.300 Test Loss: 1.365 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2876694202423096
Epoch: 10, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.359 Vali Acc: 0.275 Test Loss: 1.359 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3340613842010498
Epoch: 11, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.354 Vali Acc: 0.350 Test Loss: 1.354 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 12 cost time: 1.2072622776031494
Epoch: 12, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.350 Vali Acc: 0.325 Test Loss: 1.350 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2288424968719482
Epoch: 13, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.345 Vali Acc: 0.375 Test Loss: 1.345 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 14 cost time: 1.263667345046997
Epoch: 14, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.343 Vali Acc: 0.350 Test Loss: 1.343 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1853806972503662
Epoch: 15, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.338 Vali Acc: 0.375 Test Loss: 1.338 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 16 cost time: 1.284386396408081
Epoch: 16, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 17 cost time: 1.3042211532592773
Epoch: 17, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 18 cost time: 1.2755498886108398
Epoch: 18, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 19 cost time: 1.1466155052185059
Epoch: 19, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 20 cost time: 1.2261459827423096
Epoch: 20, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 21 cost time: 1.239522933959961
Epoch: 21, Steps: 3 | Train Loss: 0.744 Vali Loss: 1.303 Vali Acc: 0.425 Test Loss: 1.303 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 22 cost time: 1.2150273323059082
Epoch: 22, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.293 Vali Acc: 0.425 Test Loss: 1.293 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 23 cost time: 1.2029404640197754
Epoch: 23, Steps: 3 | Train Loss: 0.773 Vali Loss: 1.287 Vali Acc: 0.425 Test Loss: 1.287 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 24 cost time: 1.180302619934082
Epoch: 24, Steps: 3 | Train Loss: 0.767 Vali Loss: 1.277 Vali Acc: 0.425 Test Loss: 1.277 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 25 cost time: 1.2085812091827393
Epoch: 25, Steps: 3 | Train Loss: 0.683 Vali Loss: 1.270 Vali Acc: 0.425 Test Loss: 1.270 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 26 cost time: 1.0808026790618896
Epoch: 26, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.068643569946289
Epoch: 27, Steps: 3 | Train Loss: 0.557 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 28 cost time: 1.1854734420776367
Epoch: 28, Steps: 3 | Train Loss: 0.589 Vali Loss: 1.252 Vali Acc: 0.450 Test Loss: 1.252 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 29 cost time: 1.1175627708435059
Epoch: 29, Steps: 3 | Train Loss: 0.572 Vali Loss: 1.249 Vali Acc: 0.425 Test Loss: 1.249 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1853666305541992
Epoch: 30, Steps: 3 | Train Loss: 0.525 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0661296844482422
Epoch: 31, Steps: 3 | Train Loss: 0.435 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0797123908996582
Epoch: 32, Steps: 3 | Train Loss: 0.467 Vali Loss: 1.247 Vali Acc: 0.375 Test Loss: 1.247 Test Acc: 0.375
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.063520908355713
Epoch: 33, Steps: 3 | Train Loss: 0.449 Vali Loss: 1.245 Vali Acc: 0.375 Test Loss: 1.245 Test Acc: 0.375
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1029977798461914
Epoch: 34, Steps: 3 | Train Loss: 0.390 Vali Loss: 1.251 Vali Acc: 0.375 Test Loss: 1.251 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1027719974517822
Epoch: 35, Steps: 3 | Train Loss: 0.345 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.042529582977295
Epoch: 36, Steps: 3 | Train Loss: 0.356 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2166411876678467
Epoch: 37, Steps: 3 | Train Loss: 0.294 Vali Loss: 1.234 Vali Acc: 0.425 Test Loss: 1.234 Test Acc: 0.425
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1831700801849365
Epoch: 38, Steps: 3 | Train Loss: 0.313 Vali Loss: 1.226 Vali Acc: 0.425 Test Loss: 1.226 Test Acc: 0.425
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.45
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4351422786712646
Epoch: 1, Steps: 3 | Train Loss: 1.500 Vali Loss: 1.425 Vali Acc: 0.325 Test Loss: 1.425 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 1.1651408672332764
Epoch: 2, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.420 Vali Acc: 0.325 Test Loss: 1.420 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 1.225534200668335
Epoch: 3, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.413 Vali Acc: 0.325 Test Loss: 1.413 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.2923166751861572
Epoch: 4, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.403 Vali Acc: 0.350 Test Loss: 1.403 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.349355697631836
Epoch: 5, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 1.2153725624084473
Epoch: 6, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 1.2448456287384033
Epoch: 7, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.373 Vali Acc: 0.350 Test Loss: 1.373 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 8 cost time: 1.218259334564209
Epoch: 8, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 9 cost time: 1.2118399143218994
Epoch: 9, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.350 Vali Acc: 0.325 Test Loss: 1.350 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1831040382385254
Epoch: 10, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.340 Vali Acc: 0.325 Test Loss: 1.340 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2925117015838623
Epoch: 11, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.332 Vali Acc: 0.350 Test Loss: 1.332 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.330946922302246
Epoch: 12, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.324 Vali Acc: 0.425 Test Loss: 1.324 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 13 cost time: 1.340327501296997
Epoch: 13, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424987).  Saving model ...
Epoch: 14 cost time: 1.2292447090148926
Epoch: 14, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.309 Vali Acc: 0.450 Test Loss: 1.309 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 15 cost time: 1.367797613143921
Epoch: 15, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.299 Vali Acc: 0.425 Test Loss: 1.299 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3285024166107178
Epoch: 16, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.290 Vali Acc: 0.425 Test Loss: 1.290 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3308231830596924
Epoch: 17, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.280 Vali Acc: 0.425 Test Loss: 1.280 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1858179569244385
Epoch: 18, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.267 Vali Acc: 0.425 Test Loss: 1.267 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1663289070129395
Epoch: 19, Steps: 3 | Train Loss: 0.848 Vali Loss: 1.257 Vali Acc: 0.425 Test Loss: 1.257 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2527580261230469
Epoch: 20, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.249 Vali Acc: 0.450 Test Loss: 1.249 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 21 cost time: 1.242551326751709
Epoch: 21, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.240 Vali Acc: 0.450 Test Loss: 1.240 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 22 cost time: 1.1598267555236816
Epoch: 22, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.227 Vali Acc: 0.475 Test Loss: 1.227 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 23 cost time: 1.1398427486419678
Epoch: 23, Steps: 3 | Train Loss: 0.743 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 24 cost time: 1.2801213264465332
Epoch: 24, Steps: 3 | Train Loss: 0.710 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 25 cost time: 1.350606918334961
Epoch: 25, Steps: 3 | Train Loss: 0.662 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 26 cost time: 1.1464800834655762
Epoch: 26, Steps: 3 | Train Loss: 0.631 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 27 cost time: 1.2580139636993408
Epoch: 27, Steps: 3 | Train Loss: 0.569 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 28 cost time: 1.2237374782562256
Epoch: 28, Steps: 3 | Train Loss: 0.520 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 29 cost time: 1.1869282722473145
Epoch: 29, Steps: 3 | Train Loss: 0.561 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 30 cost time: 1.1807692050933838
Epoch: 30, Steps: 3 | Train Loss: 0.502 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 31 cost time: 1.279479742050171
Epoch: 31, Steps: 3 | Train Loss: 0.414 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 32 cost time: 1.2492451667785645
Epoch: 32, Steps: 3 | Train Loss: 0.458 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 33 cost time: 1.423980712890625
Epoch: 33, Steps: 3 | Train Loss: 0.456 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 34 cost time: 1.2475295066833496
Epoch: 34, Steps: 3 | Train Loss: 0.359 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 35 cost time: 1.2374541759490967
Epoch: 35, Steps: 3 | Train Loss: 0.332 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 36 cost time: 1.3769047260284424
Epoch: 36, Steps: 3 | Train Loss: 0.339 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 37 cost time: 1.433276653289795
Epoch: 37, Steps: 3 | Train Loss: 0.300 Vali Loss: 1.094 Vali Acc: 0.525 Test Loss: 1.094 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 38 cost time: 1.3273983001708984
Epoch: 38, Steps: 3 | Train Loss: 0.282 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4103586673736572
Epoch: 39, Steps: 3 | Train Loss: 0.287 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3683557510375977
Epoch: 40, Steps: 3 | Train Loss: 0.242 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3450558185577393
Epoch: 41, Steps: 3 | Train Loss: 0.235 Vali Loss: 1.074 Vali Acc: 0.500 Test Loss: 1.074 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.354898452758789
Epoch: 42, Steps: 3 | Train Loss: 0.192 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2290318012237549
Epoch: 43, Steps: 3 | Train Loss: 0.233 Vali Loss: 1.061 Vali Acc: 0.500 Test Loss: 1.061 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2476420402526855
Epoch: 44, Steps: 3 | Train Loss: 0.178 Vali Loss: 1.059 Vali Acc: 0.475 Test Loss: 1.059 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.325627326965332
Epoch: 45, Steps: 3 | Train Loss: 0.205 Vali Loss: 1.052 Vali Acc: 0.475 Test Loss: 1.052 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1961274147033691
Epoch: 46, Steps: 3 | Train Loss: 0.146 Vali Loss: 1.052 Vali Acc: 0.475 Test Loss: 1.052 Test Acc: 0.475
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2511916160583496
Epoch: 47, Steps: 3 | Train Loss: 0.134 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.525
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5231196880340576
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1277778148651123
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0936598777770996
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0777530670166016
Epoch: 4, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.094404697418213
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1336743831634521
Epoch: 6, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2450931072235107
Epoch: 7, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2724192142486572
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.099804401397705
Epoch: 9, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1156797409057617
Epoch: 10, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2319238185882568
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 150628
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4561774730682373
Epoch: 1, Steps: 3 | Train Loss: 1.516 Vali Loss: 1.400 Vali Acc: 0.350 Test Loss: 1.400 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.274836778640747
Epoch: 2, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.2831661701202393
Epoch: 3, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.5217411518096924
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.3689603805541992
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.2894763946533203
Epoch: 6, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.2277441024780273
Epoch: 7, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
Validation loss decreased (-0.399988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 1.3454136848449707
Epoch: 8, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.142 Vali Acc: 0.625 Test Loss: 1.142 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.2384073734283447
Epoch: 9, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.091 Vali Acc: 0.675 Test Loss: 1.091 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 1.3228204250335693
Epoch: 10, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.040 Vali Acc: 0.675 Test Loss: 1.040 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 1.2841110229492188
Epoch: 11, Steps: 3 | Train Loss: 0.881 Vali Loss: 0.988 Vali Acc: 0.700 Test Loss: 0.988 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.395759105682373
Epoch: 12, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.939 Vali Acc: 0.725 Test Loss: 0.939 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 1.3503997325897217
Epoch: 13, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.890 Vali Acc: 0.750 Test Loss: 0.890 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.1938097476959229
Epoch: 14, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.843 Vali Acc: 0.800 Test Loss: 0.843 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.26893949508667
Epoch: 15, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.799 Vali Acc: 0.825 Test Loss: 0.799 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 1.2935490608215332
Epoch: 16, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.756 Vali Acc: 0.850 Test Loss: 0.756 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.2527637481689453
Epoch: 17, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.718 Vali Acc: 0.875 Test Loss: 0.718 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 1.2906877994537354
Epoch: 18, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.680 Vali Acc: 0.875 Test Loss: 0.680 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 1.3087875843048096
Epoch: 19, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 20 cost time: 1.4658339023590088
Epoch: 20, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 1.3355441093444824
Epoch: 21, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 1.2409045696258545
Epoch: 22, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.2704126834869385
Epoch: 23, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.532 Vali Acc: 0.925 Test Loss: 0.532 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 1.2519457340240479
Epoch: 24, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 1.2357878684997559
Epoch: 25, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3281936645507812
Epoch: 26, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2512578964233398
Epoch: 27, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.252638339996338
Epoch: 28, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.273362159729004
Epoch: 29, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.360886812210083
Epoch: 30, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2674953937530518
Epoch: 31, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1630127429962158
Epoch: 32, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1847946643829346
Epoch: 33, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2144911289215088
Epoch: 34, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.329282760620117
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.396 Vali Acc: 0.250 Test Loss: 1.396 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2173066139221191
Epoch: 2, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.371 Vali Acc: 0.300 Test Loss: 1.371 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.2381088733673096
Epoch: 3, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 1.1670424938201904
Epoch: 4, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.151780605316162
Epoch: 5, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.2029383182525635
Epoch: 6, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.2478113174438477
Epoch: 7, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.190 Vali Acc: 0.525 Test Loss: 1.190 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 1.233963966369629
Epoch: 8, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.142 Vali Acc: 0.575 Test Loss: 1.142 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 1.228788137435913
Epoch: 9, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.091 Vali Acc: 0.625 Test Loss: 1.091 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.1865415573120117
Epoch: 10, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.041 Vali Acc: 0.675 Test Loss: 1.041 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 1.131141185760498
Epoch: 11, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.990 Vali Acc: 0.700 Test Loss: 0.990 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.251089334487915
Epoch: 12, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.940 Vali Acc: 0.750 Test Loss: 0.940 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 1.2159509658813477
Epoch: 13, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.126450538635254
Epoch: 14, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 15 cost time: 1.2220170497894287
Epoch: 15, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.128805160522461
Epoch: 16, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1765220165252686
Epoch: 17, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.726 Vali Acc: 0.800 Test Loss: 0.726 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 1.2154390811920166
Epoch: 18, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
Validation loss decreased (-0.799993 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 1.2997410297393799
Epoch: 19, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 1.273467779159546
Epoch: 20, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.624 Vali Acc: 0.875 Test Loss: 0.624 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874994).  Saving model ...
Epoch: 21 cost time: 1.1425893306732178
Epoch: 21, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 1.140319585800171
Epoch: 22, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.2021629810333252
Epoch: 23, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 1.2785983085632324
Epoch: 24, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 1.3018624782562256
Epoch: 25, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.2414257526397705
Epoch: 26, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.510 Vali Acc: 0.900 Test Loss: 0.510 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.147653341293335
Epoch: 27, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.1627631187438965
Epoch: 28, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.055652379989624
Epoch: 29, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.2075932025909424
Epoch: 30, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 1.1910295486450195
Epoch: 31, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 1.308885097503662
Epoch: 32, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 1.2906427383422852
Epoch: 33, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2708230018615723
Epoch: 34, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.285555124282837
Epoch: 35, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.420022964477539
Epoch: 36, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.309211015701294
Epoch: 37, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 1.2511107921600342
Epoch: 38, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 1.244795322418213
Epoch: 39, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 40 cost time: 1.3075182437896729
Epoch: 40, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 1.272454023361206
Epoch: 41, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 1.3498289585113525
Epoch: 42, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 1.2820217609405518
Epoch: 43, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 44 cost time: 1.2694871425628662
Epoch: 44, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 1.2606029510498047
Epoch: 45, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 1.1767346858978271
Epoch: 46, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 1.2713537216186523
Epoch: 47, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 48 cost time: 1.2052514553070068
Epoch: 48, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 1.1334953308105469
Epoch: 49, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 50 cost time: 1.1875205039978027
Epoch: 50, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 51 cost time: 1.1272947788238525
Epoch: 51, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 52 cost time: 1.1953742504119873
Epoch: 52, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 53 cost time: 1.194617509841919
Epoch: 53, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 54 cost time: 1.2007291316986084
Epoch: 54, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 55 cost time: 1.117544174194336
Epoch: 55, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 1.1440098285675049
Epoch: 56, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 57 cost time: 1.269395112991333
Epoch: 57, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 58 cost time: 1.2606990337371826
Epoch: 58, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 59 cost time: 1.1858184337615967
Epoch: 59, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 60 cost time: 1.1744604110717773
Epoch: 60, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 61 cost time: 1.1060893535614014
Epoch: 61, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 62 cost time: 1.166224718093872
Epoch: 62, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 63 cost time: 1.186011791229248
Epoch: 63, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 1.1655888557434082
Epoch: 64, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 1.1555447578430176
Epoch: 65, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.381 Vali Acc: 0.900 Test Loss: 0.381 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 1.218818187713623
Epoch: 66, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 67 cost time: 1.2221994400024414
Epoch: 67, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 68 cost time: 1.1977815628051758
Epoch: 68, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 69 cost time: 1.1563303470611572
Epoch: 69, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 70 cost time: 1.1787755489349365
Epoch: 70, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 71 cost time: 1.3009569644927979
Epoch: 71, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 72 cost time: 1.2339987754821777
Epoch: 72, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 73 cost time: 1.169044017791748
Epoch: 73, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 74 cost time: 1.2184770107269287
Epoch: 74, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 75 cost time: 1.2220978736877441
Epoch: 75, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 76 cost time: 1.276982069015503
Epoch: 76, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 77 cost time: 1.2449445724487305
Epoch: 77, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 78 cost time: 1.2271959781646729
Epoch: 78, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 79 cost time: 1.263333797454834
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 80 cost time: 1.2450671195983887
Epoch: 80, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 81 cost time: 1.1640689373016357
Epoch: 81, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 82 cost time: 1.1754405498504639
Epoch: 82, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.224928379058838
Epoch: 83, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.3745787143707275
Epoch: 84, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.1582419872283936
Epoch: 85, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.1587064266204834
Epoch: 86, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.2220871448516846
Epoch: 87, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.1923167705535889
Epoch: 88, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.3235175609588623
Epoch: 89, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.2417871952056885
Epoch: 90, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 1.2551066875457764
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.4027111530303955
Epoch: 1, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 1.1383774280548096
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.324 Vali Acc: 0.350 Test Loss: 1.324 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 1.126021146774292
Epoch: 3, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.301 Vali Acc: 0.350 Test Loss: 1.301 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 1.1533844470977783
Epoch: 4, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.1021883487701416
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 1.2312450408935547
Epoch: 6, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.190 Vali Acc: 0.450 Test Loss: 1.190 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 1.1925954818725586
Epoch: 7, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.2149362564086914
Epoch: 8, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.499989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.2596712112426758
Epoch: 9, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.2469854354858398
Epoch: 10, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.011 Vali Acc: 0.650 Test Loss: 1.011 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 1.088120698928833
Epoch: 11, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 1.1071648597717285
Epoch: 12, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 1.1520302295684814
Epoch: 13, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 1.2703161239624023
Epoch: 14, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.836 Vali Acc: 0.775 Test Loss: 0.836 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 1.2156352996826172
Epoch: 15, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 1.1874301433563232
Epoch: 16, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.761 Vali Acc: 0.850 Test Loss: 0.761 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 1.1188404560089111
Epoch: 17, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 1.12319016456604
Epoch: 18, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.696 Vali Acc: 0.875 Test Loss: 0.696 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 19 cost time: 1.1968109607696533
Epoch: 19, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 1.320894718170166
Epoch: 20, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 1.3729002475738525
Epoch: 21, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 1.2879939079284668
Epoch: 22, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 1.279550552368164
Epoch: 23, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 1.3100976943969727
Epoch: 24, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 1.4609076976776123
Epoch: 25, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 1.3572862148284912
Epoch: 26, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.3434576988220215
Epoch: 27, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 1.3208332061767578
Epoch: 28, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 1.3996610641479492
Epoch: 29, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.2770099639892578
Epoch: 30, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 1.249648094177246
Epoch: 31, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 1.2473714351654053
Epoch: 32, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 1.1887474060058594
Epoch: 33, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 34 cost time: 1.2083868980407715
Epoch: 34, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 35 cost time: 1.1864867210388184
Epoch: 35, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 36 cost time: 1.2194643020629883
Epoch: 36, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 37 cost time: 1.268977403640747
Epoch: 37, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 38 cost time: 1.1895742416381836
Epoch: 38, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 39 cost time: 1.2297348976135254
Epoch: 39, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 1.133432388305664
Epoch: 40, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 1.2087786197662354
Epoch: 41, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.447 Vali Acc: 0.925 Test Loss: 0.447 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 1.268977403640747
Epoch: 42, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 1.1580591201782227
Epoch: 43, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 1.15348219871521
Epoch: 44, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 1.2711219787597656
Epoch: 45, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 1.2224440574645996
Epoch: 46, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 1.3200900554656982
Epoch: 47, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 1.2001924514770508
Epoch: 48, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 1.1289267539978027
Epoch: 49, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.19161057472229
Epoch: 50, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 1.2063775062561035
Epoch: 51, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 1.2461540699005127
Epoch: 52, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 1.3383336067199707
Epoch: 53, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 1.4642951488494873
Epoch: 54, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 1.2149481773376465
Epoch: 55, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 1.2384169101715088
Epoch: 56, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 57 cost time: 1.2398412227630615
Epoch: 57, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 1.1566929817199707
Epoch: 58, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 1.2559237480163574
Epoch: 59, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.258660078048706
Epoch: 60, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.166689157485962
Epoch: 61, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.1750555038452148
Epoch: 62, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.267594814300537
Epoch: 63, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.2250456809997559
Epoch: 64, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 65 cost time: 1.389615535736084
Epoch: 65, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 66 cost time: 1.103464126586914
Epoch: 66, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 67 cost time: 1.2365999221801758
Epoch: 67, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 68 cost time: 1.1703743934631348
Epoch: 68, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2045247554779053
Epoch: 69, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.281914472579956
Epoch: 70, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 71 cost time: 1.3166592121124268
Epoch: 71, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 72 cost time: 1.2482538223266602
Epoch: 72, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 73 cost time: 1.2485520839691162
Epoch: 73, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 74 cost time: 1.1652390956878662
Epoch: 74, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 75 cost time: 1.1404869556427002
Epoch: 75, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 76 cost time: 1.3579776287078857
Epoch: 76, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 77 cost time: 1.216076135635376
Epoch: 77, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 78 cost time: 1.1931390762329102
Epoch: 78, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 79 cost time: 1.1714420318603516
Epoch: 79, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 80 cost time: 1.170743465423584
Epoch: 80, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 81 cost time: 1.2456307411193848
Epoch: 81, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 82 cost time: 1.2721707820892334
Epoch: 82, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.3141448497772217
Epoch: 83, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 84 cost time: 1.3365230560302734
Epoch: 84, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.377981185913086
Epoch: 85, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.4888386726379395
Epoch: 86, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.3590962886810303
Epoch: 87, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.2733087539672852
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.3256049156188965
Epoch: 89, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.2965314388275146
Epoch: 90, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 1.2718017101287842
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 1.4970362186431885
Epoch: 92, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 93 cost time: 1.2633230686187744
Epoch: 93, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 94 cost time: 1.3159983158111572
Epoch: 94, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 95 cost time: 1.336871862411499
Epoch: 95, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 96 cost time: 1.2508213520050049
Epoch: 96, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 97 cost time: 1.30350923538208
Epoch: 97, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 98 cost time: 1.294079065322876
Epoch: 98, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 99 cost time: 1.1735882759094238
Epoch: 99, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 100 cost time: 1.2664132118225098
Epoch: 100, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3477227687835693
Epoch: 1, Steps: 3 | Train Loss: 1.512 Vali Loss: 1.432 Vali Acc: 0.250 Test Loss: 1.432 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2883613109588623
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.402 Vali Acc: 0.250 Test Loss: 1.402 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2996575832366943
Epoch: 3, Steps: 3 | Train Loss: 1.440 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 1.1929078102111816
Epoch: 4, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.332632064819336
Epoch: 5, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 1.2103996276855469
Epoch: 6, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.256 Vali Acc: 0.425 Test Loss: 1.256 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 1.2230818271636963
Epoch: 7, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.2514545917510986
Epoch: 8, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 1.2559196949005127
Epoch: 9, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.107 Vali Acc: 0.650 Test Loss: 1.107 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.2753498554229736
Epoch: 10, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.057 Vali Acc: 0.700 Test Loss: 1.057 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 1.235184907913208
Epoch: 11, Steps: 3 | Train Loss: 0.890 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 1.4324324131011963
Epoch: 12, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.963 Vali Acc: 0.725 Test Loss: 0.963 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.286550521850586
Epoch: 13, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 14 cost time: 1.267519235610962
Epoch: 14, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.880 Vali Acc: 0.775 Test Loss: 0.880 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 1.137789011001587
Epoch: 15, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.172508716583252
Epoch: 16, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.806 Vali Acc: 0.800 Test Loss: 0.806 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.2079260349273682
Epoch: 17, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.774 Vali Acc: 0.775 Test Loss: 0.774 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.221390724182129
Epoch: 18, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2078981399536133
Epoch: 19, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2556407451629639
Epoch: 20, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.684 Vali Acc: 0.800 Test Loss: 0.684 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 21 cost time: 1.179605484008789
Epoch: 21, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.661 Vali Acc: 0.800 Test Loss: 0.661 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 1.2956206798553467
Epoch: 22, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.637 Vali Acc: 0.800 Test Loss: 0.637 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 1.1794183254241943
Epoch: 23, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.620 Vali Acc: 0.800 Test Loss: 0.620 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 1.3084180355072021
Epoch: 24, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.607 Vali Acc: 0.800 Test Loss: 0.607 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 25 cost time: 1.1900651454925537
Epoch: 25, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.595 Vali Acc: 0.825 Test Loss: 0.595 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 1.272171974182129
Epoch: 26, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.584 Vali Acc: 0.825 Test Loss: 0.584 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 1.2334153652191162
Epoch: 27, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.576 Vali Acc: 0.825 Test Loss: 0.576 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 1.343061923980713
Epoch: 28, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.573 Vali Acc: 0.825 Test Loss: 0.573 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 29 cost time: 1.1857635974884033
Epoch: 29, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.569 Vali Acc: 0.825 Test Loss: 0.569 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 30 cost time: 1.2864665985107422
Epoch: 30, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.563 Vali Acc: 0.825 Test Loss: 0.563 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 31 cost time: 1.2485876083374023
Epoch: 31, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.557 Vali Acc: 0.800 Test Loss: 0.557 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2178781032562256
Epoch: 32, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1969709396362305
Epoch: 33, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.547 Vali Acc: 0.800 Test Loss: 0.547 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1980328559875488
Epoch: 34, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1994342803955078
Epoch: 35, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.532 Vali Acc: 0.800 Test Loss: 0.532 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1690912246704102
Epoch: 36, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.526 Vali Acc: 0.800 Test Loss: 0.526 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2384147644042969
Epoch: 37, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.519 Vali Acc: 0.800 Test Loss: 0.519 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2119507789611816
Epoch: 38, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.514 Vali Acc: 0.825 Test Loss: 0.514 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 39 cost time: 1.2113690376281738
Epoch: 39, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 40 cost time: 1.303898572921753
Epoch: 40, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.501 Vali Acc: 0.825 Test Loss: 0.501 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 41 cost time: 1.1858165264129639
Epoch: 41, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.495 Vali Acc: 0.825 Test Loss: 0.495 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 42 cost time: 1.4025845527648926
Epoch: 42, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.492 Vali Acc: 0.825 Test Loss: 0.492 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 43 cost time: 1.2345919609069824
Epoch: 43, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.490 Vali Acc: 0.825 Test Loss: 0.490 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 44 cost time: 1.150937795639038
Epoch: 44, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.489 Vali Acc: 0.825 Test Loss: 0.489 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 45 cost time: 1.148484706878662
Epoch: 45, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.487 Vali Acc: 0.825 Test Loss: 0.487 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 46 cost time: 1.3639979362487793
Epoch: 46, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 47 cost time: 1.1961719989776611
Epoch: 47, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.482 Vali Acc: 0.825 Test Loss: 0.482 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 48 cost time: 1.257784366607666
Epoch: 48, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.479 Vali Acc: 0.825 Test Loss: 0.479 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 49 cost time: 1.2458257675170898
Epoch: 49, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.477 Vali Acc: 0.825 Test Loss: 0.477 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 50 cost time: 1.1767282485961914
Epoch: 50, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 51 cost time: 1.3091404438018799
Epoch: 51, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 52 cost time: 1.4804904460906982
Epoch: 52, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 53 cost time: 1.3131346702575684
Epoch: 53, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 54 cost time: 1.2050654888153076
Epoch: 54, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 55 cost time: 1.251560926437378
Epoch: 55, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 56 cost time: 1.3451831340789795
Epoch: 56, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 57 cost time: 1.511667251586914
Epoch: 57, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 58 cost time: 1.338794231414795
Epoch: 58, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 59 cost time: 1.357506513595581
Epoch: 59, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 60 cost time: 1.2856991291046143
Epoch: 60, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 61 cost time: 1.250861406326294
Epoch: 61, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849996).  Saving model ...
Epoch: 62 cost time: 1.2896032333374023
Epoch: 62, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 63 cost time: 1.359539270401001
Epoch: 63, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 64 cost time: 1.286205768585205
Epoch: 64, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.444 Vali Acc: 0.850 Test Loss: 0.444 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 65 cost time: 1.1410291194915771
Epoch: 65, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.441 Vali Acc: 0.850 Test Loss: 0.441 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 66 cost time: 1.1606009006500244
Epoch: 66, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 67 cost time: 1.2491111755371094
Epoch: 67, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 68 cost time: 1.1895997524261475
Epoch: 68, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 69 cost time: 1.198503017425537
Epoch: 69, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 70 cost time: 1.228515386581421
Epoch: 70, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 71 cost time: 1.25347900390625
Epoch: 71, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 72 cost time: 1.2074089050292969
Epoch: 72, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 73 cost time: 1.1507902145385742
Epoch: 73, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 74 cost time: 1.2268486022949219
Epoch: 74, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 75 cost time: 1.1572399139404297
Epoch: 75, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 76 cost time: 1.2224488258361816
Epoch: 76, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 77 cost time: 1.1252341270446777
Epoch: 77, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 78 cost time: 1.1503760814666748
Epoch: 78, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 79 cost time: 1.1996662616729736
Epoch: 79, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 80 cost time: 1.2098114490509033
Epoch: 80, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 81 cost time: 1.2038743495941162
Epoch: 81, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 82 cost time: 1.1590042114257812
Epoch: 82, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 83 cost time: 1.2232460975646973
Epoch: 83, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 84 cost time: 1.2735354900360107
Epoch: 84, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 85 cost time: 1.2581770420074463
Epoch: 85, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 86 cost time: 1.2191991806030273
Epoch: 86, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 87 cost time: 1.35331392288208
Epoch: 87, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 88 cost time: 1.2186522483825684
Epoch: 88, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 89 cost time: 1.2458016872406006
Epoch: 89, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 90 cost time: 1.3521838188171387
Epoch: 90, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 91 cost time: 1.2682349681854248
Epoch: 91, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 92 cost time: 1.3167963027954102
Epoch: 92, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 93 cost time: 1.2842824459075928
Epoch: 93, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 94 cost time: 1.24346923828125
Epoch: 94, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 95 cost time: 1.227989912033081
Epoch: 95, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 96 cost time: 1.2815535068511963
Epoch: 96, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 97 cost time: 1.408078670501709
Epoch: 97, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 98 cost time: 1.330127239227295
Epoch: 98, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 99 cost time: 1.3371820449829102
Epoch: 99, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849996).  Saving model ...
Epoch: 100 cost time: 1.193711757659912
Epoch: 100, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
Validation loss decreased (-0.849996 --> -0.874996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.440526008605957
Epoch: 1, Steps: 3 | Train Loss: 1.567 Vali Loss: 1.408 Vali Acc: 0.350 Test Loss: 1.408 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 1.3924939632415771
Epoch: 2, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.376 Vali Acc: 0.350 Test Loss: 1.376 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.3005354404449463
Epoch: 3, Steps: 3 | Train Loss: 1.492 Vali Loss: 1.354 Vali Acc: 0.350 Test Loss: 1.354 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 1.2966523170471191
Epoch: 4, Steps: 3 | Train Loss: 1.450 Vali Loss: 1.323 Vali Acc: 0.325 Test Loss: 1.323 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1584599018096924
Epoch: 5, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.286 Vali Acc: 0.300 Test Loss: 1.286 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2585890293121338
Epoch: 6, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.246 Vali Acc: 0.325 Test Loss: 1.246 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1525931358337402
Epoch: 7, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.204 Vali Acc: 0.375 Test Loss: 1.204 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374988).  Saving model ...
Epoch: 8 cost time: 1.2655835151672363
Epoch: 8, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 1.4366226196289062
Epoch: 9, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.115 Vali Acc: 0.450 Test Loss: 1.115 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449989).  Saving model ...
Epoch: 10 cost time: 1.3091814517974854
Epoch: 10, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.070 Vali Acc: 0.475 Test Loss: 1.070 Test Acc: 0.475
Validation loss decreased (-0.449989 --> -0.474989).  Saving model ...
Epoch: 11 cost time: 1.1502678394317627
Epoch: 11, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.026 Vali Acc: 0.575 Test Loss: 1.026 Test Acc: 0.575
Validation loss decreased (-0.474989 --> -0.574990).  Saving model ...
Epoch: 12 cost time: 1.326373815536499
Epoch: 12, Steps: 3 | Train Loss: 0.899 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
Validation loss decreased (-0.574990 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 1.2906501293182373
Epoch: 13, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.944 Vali Acc: 0.675 Test Loss: 0.944 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 14 cost time: 1.2326672077178955
Epoch: 14, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.906 Vali Acc: 0.700 Test Loss: 0.906 Test Acc: 0.700
Validation loss decreased (-0.674991 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 1.1740217208862305
Epoch: 15, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.872 Vali Acc: 0.700 Test Loss: 0.872 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.0990147590637207
Epoch: 16, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.837 Vali Acc: 0.700 Test Loss: 0.837 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 17 cost time: 1.18513822555542
Epoch: 17, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.806 Vali Acc: 0.725 Test Loss: 0.806 Test Acc: 0.725
Validation loss decreased (-0.699992 --> -0.724992).  Saving model ...
Epoch: 18 cost time: 1.250258207321167
Epoch: 18, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.773 Vali Acc: 0.725 Test Loss: 0.773 Test Acc: 0.725
Validation loss decreased (-0.724992 --> -0.724992).  Saving model ...
Epoch: 19 cost time: 1.313783884048462
Epoch: 19, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.743 Vali Acc: 0.750 Test Loss: 0.743 Test Acc: 0.750
Validation loss decreased (-0.724992 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 1.2589702606201172
Epoch: 20, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 21 cost time: 1.2522406578063965
Epoch: 21, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 22 cost time: 1.1817340850830078
Epoch: 22, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.1970298290252686
Epoch: 23, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.645 Vali Acc: 0.800 Test Loss: 0.645 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 1.2989966869354248
Epoch: 24, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.629 Vali Acc: 0.825 Test Loss: 0.629 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824994).  Saving model ...
Epoch: 25 cost time: 1.2429380416870117
Epoch: 25, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.619 Vali Acc: 0.825 Test Loss: 0.619 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 26 cost time: 1.2063214778900146
Epoch: 26, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 27 cost time: 1.3139302730560303
Epoch: 27, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.599 Vali Acc: 0.825 Test Loss: 0.599 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 28 cost time: 1.2347908020019531
Epoch: 28, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.595 Vali Acc: 0.800 Test Loss: 0.595 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2821934223175049
Epoch: 29, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4881253242492676
Epoch: 30, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.586 Vali Acc: 0.800 Test Loss: 0.586 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1967792510986328
Epoch: 31, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.587 Vali Acc: 0.800 Test Loss: 0.587 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1850385665893555
Epoch: 32, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.584 Vali Acc: 0.800 Test Loss: 0.584 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.349686861038208
Epoch: 33, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.582 Vali Acc: 0.800 Test Loss: 0.582 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.166057825088501
Epoch: 34, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.582 Vali Acc: 0.800 Test Loss: 0.582 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1857740879058838
Epoch: 35, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.21382474899292
Epoch: 36, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.573 Vali Acc: 0.800 Test Loss: 0.573 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2074074745178223
Epoch: 37, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.568 Vali Acc: 0.800 Test Loss: 0.568 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.825
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.363349676132202
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.536 Vali Acc: 0.200 Test Loss: 1.536 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.170346736907959
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.525 Vali Acc: 0.225 Test Loss: 1.525 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 3 cost time: 1.1633796691894531
Epoch: 3, Steps: 3 | Train Loss: 1.460 Vali Loss: 1.515 Vali Acc: 0.250 Test Loss: 1.515 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 4 cost time: 1.1874127388000488
Epoch: 4, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.502 Vali Acc: 0.225 Test Loss: 1.502 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1284160614013672
Epoch: 5, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.485 Vali Acc: 0.275 Test Loss: 1.485 Test Acc: 0.275
Validation loss decreased (-0.249985 --> -0.274985).  Saving model ...
Epoch: 6 cost time: 1.1687233448028564
Epoch: 6, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.469 Vali Acc: 0.275 Test Loss: 1.469 Test Acc: 0.275
Validation loss decreased (-0.274985 --> -0.274985).  Saving model ...
Epoch: 7 cost time: 1.1431231498718262
Epoch: 7, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.453 Vali Acc: 0.250 Test Loss: 1.453 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0575518608093262
Epoch: 8, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.435 Vali Acc: 0.250 Test Loss: 1.435 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2072434425354004
Epoch: 9, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.416 Vali Acc: 0.250 Test Loss: 1.416 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.15598464012146
Epoch: 10, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.397 Vali Acc: 0.325 Test Loss: 1.397 Test Acc: 0.325
Validation loss decreased (-0.274985 --> -0.324986).  Saving model ...
Epoch: 11 cost time: 1.207688808441162
Epoch: 11, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.379 Vali Acc: 0.375 Test Loss: 1.379 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 12 cost time: 1.2392480373382568
Epoch: 12, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.361 Vali Acc: 0.350 Test Loss: 1.361 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3212525844573975
Epoch: 13, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 14 cost time: 1.1811244487762451
Epoch: 14, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.323 Vali Acc: 0.425 Test Loss: 1.323 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 15 cost time: 1.2979552745819092
Epoch: 15, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.304 Vali Acc: 0.450 Test Loss: 1.304 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 16 cost time: 1.233879566192627
Epoch: 16, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.285 Vali Acc: 0.450 Test Loss: 1.285 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 17 cost time: 1.2458302974700928
Epoch: 17, Steps: 3 | Train Loss: 0.830 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 18 cost time: 1.2820134162902832
Epoch: 18, Steps: 3 | Train Loss: 0.792 Vali Loss: 1.247 Vali Acc: 0.550 Test Loss: 1.247 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 19 cost time: 1.2488985061645508
Epoch: 19, Steps: 3 | Train Loss: 0.787 Vali Loss: 1.226 Vali Acc: 0.550 Test Loss: 1.226 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 20 cost time: 1.2331616878509521
Epoch: 20, Steps: 3 | Train Loss: 0.762 Vali Loss: 1.207 Vali Acc: 0.550 Test Loss: 1.207 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 21 cost time: 1.2636067867279053
Epoch: 21, Steps: 3 | Train Loss: 0.665 Vali Loss: 1.190 Vali Acc: 0.575 Test Loss: 1.190 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 22 cost time: 1.3249378204345703
Epoch: 22, Steps: 3 | Train Loss: 0.627 Vali Loss: 1.172 Vali Acc: 0.575 Test Loss: 1.172 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 23 cost time: 1.294877290725708
Epoch: 23, Steps: 3 | Train Loss: 0.586 Vali Loss: 1.157 Vali Acc: 0.575 Test Loss: 1.157 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 24 cost time: 1.2118797302246094
Epoch: 24, Steps: 3 | Train Loss: 0.570 Vali Loss: 1.144 Vali Acc: 0.575 Test Loss: 1.144 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 25 cost time: 1.1086945533752441
Epoch: 25, Steps: 3 | Train Loss: 0.483 Vali Loss: 1.130 Vali Acc: 0.575 Test Loss: 1.130 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 26 cost time: 1.075282335281372
Epoch: 26, Steps: 3 | Train Loss: 0.468 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 1.1336722373962402
Epoch: 27, Steps: 3 | Train Loss: 0.459 Vali Loss: 1.094 Vali Acc: 0.600 Test Loss: 1.094 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 1.0786583423614502
Epoch: 28, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 1.0703253746032715
Epoch: 29, Steps: 3 | Train Loss: 0.404 Vali Loss: 1.072 Vali Acc: 0.600 Test Loss: 1.072 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 30 cost time: 1.1199166774749756
Epoch: 30, Steps: 3 | Train Loss: 0.359 Vali Loss: 1.060 Vali Acc: 0.575 Test Loss: 1.060 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.097822904586792
Epoch: 31, Steps: 3 | Train Loss: 0.331 Vali Loss: 1.050 Vali Acc: 0.625 Test Loss: 1.050 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 32 cost time: 1.2322206497192383
Epoch: 32, Steps: 3 | Train Loss: 0.318 Vali Loss: 1.039 Vali Acc: 0.625 Test Loss: 1.039 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 33 cost time: 1.1410138607025146
Epoch: 33, Steps: 3 | Train Loss: 0.305 Vali Loss: 1.031 Vali Acc: 0.625 Test Loss: 1.031 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 34 cost time: 1.0735158920288086
Epoch: 34, Steps: 3 | Train Loss: 0.237 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649990).  Saving model ...
Epoch: 35 cost time: 1.0883667469024658
Epoch: 35, Steps: 3 | Train Loss: 0.242 Vali Loss: 1.011 Vali Acc: 0.675 Test Loss: 1.011 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 36 cost time: 1.1480066776275635
Epoch: 36, Steps: 3 | Train Loss: 0.229 Vali Loss: 1.001 Vali Acc: 0.700 Test Loss: 1.001 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 37 cost time: 1.1152763366699219
Epoch: 37, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.986 Vali Acc: 0.700 Test Loss: 0.986 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 38 cost time: 1.138359785079956
Epoch: 38, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.975 Vali Acc: 0.700 Test Loss: 0.975 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 39 cost time: 1.1487793922424316
Epoch: 39, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.965 Vali Acc: 0.700 Test Loss: 0.965 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 40 cost time: 1.1460084915161133
Epoch: 40, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 41 cost time: 1.1259088516235352
Epoch: 41, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.948 Vali Acc: 0.700 Test Loss: 0.948 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 1.1445796489715576
Epoch: 42, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 43 cost time: 1.1842601299285889
Epoch: 43, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.946 Vali Acc: 0.725 Test Loss: 0.946 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.067704200744629
Epoch: 44, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.947 Vali Acc: 0.725 Test Loss: 0.947 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1002709865570068
Epoch: 45, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.947 Vali Acc: 0.725 Test Loss: 0.947 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1483023166656494
Epoch: 46, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 47 cost time: 1.0697522163391113
Epoch: 47, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.937 Vali Acc: 0.725 Test Loss: 0.937 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 48 cost time: 1.250213623046875
Epoch: 48, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.932 Vali Acc: 0.725 Test Loss: 0.932 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 49 cost time: 1.2290096282958984
Epoch: 49, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 50 cost time: 1.200117826461792
Epoch: 50, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.922 Vali Acc: 0.725 Test Loss: 0.922 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 51 cost time: 1.2092790603637695
Epoch: 51, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.918 Vali Acc: 0.725 Test Loss: 0.918 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 52 cost time: 1.1748361587524414
Epoch: 52, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.912 Vali Acc: 0.725 Test Loss: 0.912 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 53 cost time: 1.2219011783599854
Epoch: 53, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 54 cost time: 1.3434152603149414
Epoch: 54, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.902 Vali Acc: 0.725 Test Loss: 0.902 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 55 cost time: 1.284942626953125
Epoch: 55, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.895 Vali Acc: 0.725 Test Loss: 0.895 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 56 cost time: 1.2282087802886963
Epoch: 56, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.889 Vali Acc: 0.725 Test Loss: 0.889 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 57 cost time: 1.189579725265503
Epoch: 57, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.884 Vali Acc: 0.750 Test Loss: 0.884 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 58 cost time: 1.314368724822998
Epoch: 58, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.883 Vali Acc: 0.750 Test Loss: 0.883 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 59 cost time: 1.2223436832427979
Epoch: 59, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 60 cost time: 1.4086289405822754
Epoch: 60, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.877 Vali Acc: 0.750 Test Loss: 0.877 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 61 cost time: 1.3178770542144775
Epoch: 61, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 62 cost time: 1.2735211849212646
Epoch: 62, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.872 Vali Acc: 0.750 Test Loss: 0.872 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 63 cost time: 1.2006616592407227
Epoch: 63, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.871 Vali Acc: 0.750 Test Loss: 0.871 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 64 cost time: 1.1966404914855957
Epoch: 64, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.868 Vali Acc: 0.750 Test Loss: 0.868 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 65 cost time: 1.1822655200958252
Epoch: 65, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 66 cost time: 1.2134556770324707
Epoch: 66, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.862 Vali Acc: 0.775 Test Loss: 0.862 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 67 cost time: 1.1753318309783936
Epoch: 67, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.860 Vali Acc: 0.775 Test Loss: 0.860 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 68 cost time: 1.0977327823638916
Epoch: 68, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.12251877784729
Epoch: 69, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.0240399837493896
Epoch: 70, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.1168646812438965
Epoch: 71, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 72 cost time: 1.16127610206604
Epoch: 72, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 73 cost time: 1.133692741394043
Epoch: 73, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.845 Vali Acc: 0.775 Test Loss: 0.845 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 74 cost time: 1.2203185558319092
Epoch: 74, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1211841106414795
Epoch: 75, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.1593067646026611
Epoch: 76, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.2017676830291748
Epoch: 77, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.1774318218231201
Epoch: 78, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.1222949028015137
Epoch: 79, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.836 Vali Acc: 0.750 Test Loss: 0.836 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.1913464069366455
Epoch: 80, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.1673526763916016
Epoch: 81, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.100959300994873
Epoch: 82, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.2082877159118652
Epoch: 83, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.425417900085449
Epoch: 1, Steps: 3 | Train Loss: 1.497 Vali Loss: 1.324 Vali Acc: 0.450 Test Loss: 1.324 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 1.336751937866211
Epoch: 2, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.320 Vali Acc: 0.425 Test Loss: 1.320 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.170311450958252
Epoch: 3, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1513051986694336
Epoch: 4, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.311 Vali Acc: 0.425 Test Loss: 1.311 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3154046535491943
Epoch: 5, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.305 Vali Acc: 0.425 Test Loss: 1.305 Test Acc: 0.425
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2320339679718018
Epoch: 6, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.301 Vali Acc: 0.425 Test Loss: 1.301 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2457809448242188
Epoch: 7, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1683275699615479
Epoch: 8, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1393015384674072
Epoch: 9, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.287 Vali Acc: 0.350 Test Loss: 1.287 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1285135746002197
Epoch: 10, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.283 Vali Acc: 0.375 Test Loss: 1.283 Test Acc: 0.375
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1961655616760254
Epoch: 11, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.278 Vali Acc: 0.350 Test Loss: 1.278 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.45
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.1682796478271484
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.310 Vali Acc: 0.375 Test Loss: 1.310 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2233302593231201
Epoch: 2, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.1921155452728271
Epoch: 3, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.1787643432617188
Epoch: 4, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.295 Vali Acc: 0.350 Test Loss: 1.295 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3193283081054688
Epoch: 5, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.286 Vali Acc: 0.350 Test Loss: 1.286 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.226719617843628
Epoch: 6, Steps: 3 | Train Loss: 1.475 Vali Loss: 1.278 Vali Acc: 0.325 Test Loss: 1.278 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1674950122833252
Epoch: 7, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.270 Vali Acc: 0.300 Test Loss: 1.270 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.496612310409546
Epoch: 8, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.261 Vali Acc: 0.300 Test Loss: 1.261 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3634562492370605
Epoch: 9, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.251 Vali Acc: 0.300 Test Loss: 1.251 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2252717018127441
Epoch: 10, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.242 Vali Acc: 0.350 Test Loss: 1.242 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1596581935882568
Epoch: 11, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.233 Vali Acc: 0.375 Test Loss: 1.233 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374988).  Saving model ...
Epoch: 12 cost time: 1.1942250728607178
Epoch: 12, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
Validation loss decreased (-0.374988 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 1.1976351737976074
Epoch: 13, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 1.2402138710021973
Epoch: 14, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.205 Vali Acc: 0.450 Test Loss: 1.205 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 15 cost time: 1.2933270931243896
Epoch: 15, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.195 Vali Acc: 0.475 Test Loss: 1.195 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 16 cost time: 1.3917906284332275
Epoch: 16, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.3133935928344727
Epoch: 17, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.3388683795928955
Epoch: 18, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.3460042476654053
Epoch: 19, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.158 Vali Acc: 0.525 Test Loss: 1.158 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 20 cost time: 1.3303003311157227
Epoch: 20, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3879408836364746
Epoch: 21, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3164889812469482
Epoch: 22, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.124 Vali Acc: 0.525 Test Loss: 1.124 Test Acc: 0.525
Validation loss decreased (-0.524988 --> -0.524989).  Saving model ...
Epoch: 23 cost time: 1.2568376064300537
Epoch: 23, Steps: 3 | Train Loss: 0.749 Vali Loss: 1.115 Vali Acc: 0.550 Test Loss: 1.115 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 24 cost time: 1.362797498703003
Epoch: 24, Steps: 3 | Train Loss: 0.742 Vali Loss: 1.106 Vali Acc: 0.575 Test Loss: 1.106 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 25 cost time: 1.4005296230316162
Epoch: 25, Steps: 3 | Train Loss: 0.726 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 26 cost time: 1.2985968589782715
Epoch: 26, Steps: 3 | Train Loss: 0.670 Vali Loss: 1.085 Vali Acc: 0.575 Test Loss: 1.085 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 27 cost time: 1.2848689556121826
Epoch: 27, Steps: 3 | Train Loss: 0.679 Vali Loss: 1.072 Vali Acc: 0.575 Test Loss: 1.072 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 28 cost time: 1.259864091873169
Epoch: 28, Steps: 3 | Train Loss: 0.560 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 1.3463246822357178
Epoch: 29, Steps: 3 | Train Loss: 0.605 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 30 cost time: 1.2845783233642578
Epoch: 30, Steps: 3 | Train Loss: 0.562 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.384270191192627
Epoch: 31, Steps: 3 | Train Loss: 0.547 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2409355640411377
Epoch: 32, Steps: 3 | Train Loss: 0.497 Vali Loss: 1.030 Vali Acc: 0.625 Test Loss: 1.030 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 33 cost time: 1.2313051223754883
Epoch: 33, Steps: 3 | Train Loss: 0.446 Vali Loss: 1.023 Vali Acc: 0.625 Test Loss: 1.023 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 34 cost time: 1.3677635192871094
Epoch: 34, Steps: 3 | Train Loss: 0.386 Vali Loss: 1.015 Vali Acc: 0.600 Test Loss: 1.015 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2802743911743164
Epoch: 35, Steps: 3 | Train Loss: 0.404 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1963305473327637
Epoch: 36, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.998 Vali Acc: 0.575 Test Loss: 0.998 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1289963722229004
Epoch: 37, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.987 Vali Acc: 0.575 Test Loss: 0.987 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1821458339691162
Epoch: 38, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1853275299072266
Epoch: 39, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.966 Vali Acc: 0.600 Test Loss: 0.966 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.140928030014038
Epoch: 40, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.281893014907837
Epoch: 41, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.944 Vali Acc: 0.625 Test Loss: 0.944 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 42 cost time: 1.2205047607421875
Epoch: 42, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.937 Vali Acc: 0.625 Test Loss: 0.937 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 43 cost time: 1.2690098285675049
Epoch: 43, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.931 Vali Acc: 0.625 Test Loss: 0.931 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 44 cost time: 1.088916540145874
Epoch: 44, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.926 Vali Acc: 0.600 Test Loss: 0.926 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.2268459796905518
Epoch: 45, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.921 Vali Acc: 0.600 Test Loss: 0.921 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.198904037475586
Epoch: 46, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.911 Vali Acc: 0.600 Test Loss: 0.911 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2299308776855469
Epoch: 47, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.907 Vali Acc: 0.600 Test Loss: 0.907 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1766724586486816
Epoch: 48, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.901 Vali Acc: 0.600 Test Loss: 0.901 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2923955917358398
Epoch: 49, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.894 Vali Acc: 0.625 Test Loss: 0.894 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 50 cost time: 1.1644301414489746
Epoch: 50, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.885 Vali Acc: 0.625 Test Loss: 0.885 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 51 cost time: 1.2325656414031982
Epoch: 51, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.875 Vali Acc: 0.625 Test Loss: 0.875 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 52 cost time: 1.305413007736206
Epoch: 52, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.866 Vali Acc: 0.625 Test Loss: 0.866 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 53 cost time: 1.2503798007965088
Epoch: 53, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.864 Vali Acc: 0.625 Test Loss: 0.864 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 54 cost time: 1.2447245121002197
Epoch: 54, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.857 Vali Acc: 0.625 Test Loss: 0.857 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 55 cost time: 1.1955320835113525
Epoch: 55, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.851 Vali Acc: 0.625 Test Loss: 0.851 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 56 cost time: 1.2493269443511963
Epoch: 56, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.843 Vali Acc: 0.625 Test Loss: 0.843 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624992).  Saving model ...
Epoch: 57 cost time: 1.152406930923462
Epoch: 57, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.836 Vali Acc: 0.650 Test Loss: 0.836 Test Acc: 0.650
Validation loss decreased (-0.624992 --> -0.649992).  Saving model ...
Epoch: 58 cost time: 1.3630702495574951
Epoch: 58, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.833 Vali Acc: 0.650 Test Loss: 0.833 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 59 cost time: 1.4197957515716553
Epoch: 59, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.825 Vali Acc: 0.650 Test Loss: 0.825 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 60 cost time: 1.2642176151275635
Epoch: 60, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.817 Vali Acc: 0.650 Test Loss: 0.817 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 61 cost time: 1.3456366062164307
Epoch: 61, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.812 Vali Acc: 0.650 Test Loss: 0.812 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 62 cost time: 1.3457074165344238
Epoch: 62, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.807 Vali Acc: 0.650 Test Loss: 0.807 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 63 cost time: 1.4496753215789795
Epoch: 63, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.803 Vali Acc: 0.650 Test Loss: 0.803 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 64 cost time: 1.3344573974609375
Epoch: 64, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.799 Vali Acc: 0.650 Test Loss: 0.799 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 65 cost time: 1.2273330688476562
Epoch: 65, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.792 Vali Acc: 0.650 Test Loss: 0.792 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 66 cost time: 1.4559805393218994
Epoch: 66, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.785 Vali Acc: 0.650 Test Loss: 0.785 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 67 cost time: 1.3715384006500244
Epoch: 67, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.777 Vali Acc: 0.650 Test Loss: 0.777 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 68 cost time: 1.2267992496490479
Epoch: 68, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.773 Vali Acc: 0.650 Test Loss: 0.773 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 69 cost time: 1.4015393257141113
Epoch: 69, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.764 Vali Acc: 0.675 Test Loss: 0.764 Test Acc: 0.675
Validation loss decreased (-0.649992 --> -0.674992).  Saving model ...
Epoch: 70 cost time: 1.3892464637756348
Epoch: 70, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.753 Vali Acc: 0.675 Test Loss: 0.753 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674992).  Saving model ...
Epoch: 71 cost time: 1.3562800884246826
Epoch: 71, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.746 Vali Acc: 0.675 Test Loss: 0.746 Test Acc: 0.675
Validation loss decreased (-0.674992 --> -0.674993).  Saving model ...
Epoch: 72 cost time: 1.1605618000030518
Epoch: 72, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.739 Vali Acc: 0.700 Test Loss: 0.739 Test Acc: 0.700
Validation loss decreased (-0.674993 --> -0.699993).  Saving model ...
Epoch: 73 cost time: 1.1726570129394531
Epoch: 73, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.732 Vali Acc: 0.700 Test Loss: 0.732 Test Acc: 0.700
Validation loss decreased (-0.699993 --> -0.699993).  Saving model ...
Epoch: 74 cost time: 1.307692527770996
Epoch: 74, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.729 Vali Acc: 0.725 Test Loss: 0.729 Test Acc: 0.725
Validation loss decreased (-0.699993 --> -0.724993).  Saving model ...
Epoch: 75 cost time: 1.3380954265594482
Epoch: 75, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.726 Vali Acc: 0.725 Test Loss: 0.726 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 76 cost time: 1.2313356399536133
Epoch: 76, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.724 Vali Acc: 0.725 Test Loss: 0.724 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 77 cost time: 1.2534937858581543
Epoch: 77, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.727 Vali Acc: 0.725 Test Loss: 0.727 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.186204195022583
Epoch: 78, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.728 Vali Acc: 0.725 Test Loss: 0.728 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.2624788284301758
Epoch: 79, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.728 Vali Acc: 0.725 Test Loss: 0.728 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.275893211364746
Epoch: 80, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.727 Vali Acc: 0.725 Test Loss: 0.727 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.172982931137085
Epoch: 81, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.729 Vali Acc: 0.700 Test Loss: 0.729 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.2362241744995117
Epoch: 82, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.728 Vali Acc: 0.700 Test Loss: 0.728 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.2037780284881592
Epoch: 83, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.726 Vali Acc: 0.725 Test Loss: 0.726 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.1949894428253174
Epoch: 84, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.722 Vali Acc: 0.725 Test Loss: 0.722 Test Acc: 0.725
Validation loss decreased (-0.724993 --> -0.724993).  Saving model ...
Epoch: 85 cost time: 1.1947121620178223
Epoch: 85, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
Validation loss decreased (-0.724993 --> -0.749993).  Saving model ...
Epoch: 86 cost time: 1.2125964164733887
Epoch: 86, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 87 cost time: 1.1788527965545654
Epoch: 87, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.714 Vali Acc: 0.725 Test Loss: 0.714 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.2241950035095215
Epoch: 88, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.713 Vali Acc: 0.725 Test Loss: 0.713 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.162992238998413
Epoch: 89, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.712 Vali Acc: 0.725 Test Loss: 0.712 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.3978180885314941
Epoch: 90, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.712 Vali Acc: 0.725 Test Loss: 0.712 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.2099838256835938
Epoch: 91, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.712 Vali Acc: 0.725 Test Loss: 0.712 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.3079626560211182
Epoch: 92, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.711 Vali Acc: 0.725 Test Loss: 0.711 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.2868390083312988
Epoch: 93, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.706 Vali Acc: 0.725 Test Loss: 0.706 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.2778232097625732
Epoch: 94, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.700 Vali Acc: 0.725 Test Loss: 0.700 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.1786720752716064
Epoch: 95, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 96 cost time: 1.262843370437622
Epoch: 96, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 97 cost time: 1.297553539276123
Epoch: 97, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.683 Vali Acc: 0.750 Test Loss: 0.683 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 98 cost time: 1.2205801010131836
Epoch: 98, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.685 Vali Acc: 0.750 Test Loss: 0.685 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.296293020248413
Epoch: 99, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.691 Vali Acc: 0.750 Test Loss: 0.691 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.224350929260254
Epoch: 100, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.696 Vali Acc: 0.750 Test Loss: 0.696 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.75
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2314815521240234
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1118979454040527
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.1651339530944824
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.1056227684020996
Epoch: 4, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.1877720355987549
Epoch: 5, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.2409098148345947
Epoch: 6, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.396707534790039
Epoch: 7, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2080533504486084
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.3258476257324219
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.2694168090820312
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 1.2145743370056152
Epoch: 11, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.257495403289795
Epoch: 12, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.359896183013916
Epoch: 13, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.2323758602142334
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.2980587482452393
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.2170321941375732
Epoch: 16, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 17 cost time: 1.2793328762054443
Epoch: 17, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 18 cost time: 1.1673831939697266
Epoch: 18, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 19 cost time: 1.2691738605499268
Epoch: 19, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 20 cost time: 1.4184906482696533
Epoch: 20, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 21 cost time: 1.2282164096832275
Epoch: 21, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 22 cost time: 1.2552623748779297
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 23 cost time: 1.275956630706787
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.3493480682373047
Epoch: 24, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 25 cost time: 1.3655786514282227
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 26 cost time: 1.3345017433166504
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 27 cost time: 1.2754864692687988
Epoch: 27, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 28 cost time: 1.2531626224517822
Epoch: 28, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.378413438796997
Epoch: 29, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.308441400527954
Epoch: 30, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.303664207458496
Epoch: 31, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.26271653175354
Epoch: 32, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.311903476715088
Epoch: 33, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2692713737487793
Epoch: 34, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1752681732177734
Epoch: 35, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1588630676269531
Epoch: 36, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1778755187988281
Epoch: 37, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 38 cost time: 1.2593255043029785
Epoch: 38, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2467167377471924
Epoch: 39, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 40 cost time: 1.2776925563812256
Epoch: 40, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 41 cost time: 1.255164623260498
Epoch: 41, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 42 cost time: 1.148409128189087
Epoch: 42, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1690058708190918
Epoch: 43, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2340681552886963
Epoch: 44, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.252544641494751
Epoch: 45, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.176466941833496
Epoch: 46, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1948802471160889
Epoch: 47, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3082449436187744
Epoch: 48, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.2733469009399414
Epoch: 49, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2079663276672363
Epoch: 50, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.217405080795288
Epoch: 51, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 101476
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.444209337234497
Epoch: 1, Steps: 3 | Train Loss: 1.573 Vali Loss: 1.469 Vali Acc: 0.125 Test Loss: 1.469 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.2433438301086426
Epoch: 2, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.439 Vali Acc: 0.175 Test Loss: 1.439 Test Acc: 0.175
Validation loss decreased (-0.124985 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 1.1729328632354736
Epoch: 3, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (-0.174986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 1.2183928489685059
Epoch: 4, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.381 Vali Acc: 0.350 Test Loss: 1.381 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 1.3132686614990234
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.341 Vali Acc: 0.400 Test Loss: 1.341 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 1.393768548965454
Epoch: 6, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.2737112045288086
Epoch: 7, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.252 Vali Acc: 0.550 Test Loss: 1.252 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 1.4713490009307861
Epoch: 8, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.208 Vali Acc: 0.575 Test Loss: 1.208 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 1.3019087314605713
Epoch: 9, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 1.4761412143707275
Epoch: 10, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.117 Vali Acc: 0.625 Test Loss: 1.117 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 1.4363911151885986
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.072 Vali Acc: 0.650 Test Loss: 1.072 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 1.2394990921020508
Epoch: 12, Steps: 3 | Train Loss: 0.824 Vali Loss: 1.026 Vali Acc: 0.675 Test Loss: 1.026 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 1.154419183731079
Epoch: 13, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.981 Vali Acc: 0.675 Test Loss: 0.981 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 1.1127245426177979
Epoch: 14, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.933 Vali Acc: 0.725 Test Loss: 0.933 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.1863486766815186
Epoch: 15, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.1013906002044678
Epoch: 16, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 1.2722125053405762
Epoch: 17, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 1.1915185451507568
Epoch: 18, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.777 Vali Acc: 0.750 Test Loss: 0.777 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.4243581295013428
Epoch: 19, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.744 Vali Acc: 0.750 Test Loss: 0.744 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 20 cost time: 1.2967100143432617
Epoch: 20, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 21 cost time: 1.1769864559173584
Epoch: 21, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.673 Vali Acc: 0.800 Test Loss: 0.673 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 1.2977771759033203
Epoch: 22, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.640 Vali Acc: 0.800 Test Loss: 0.640 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 23 cost time: 1.2537217140197754
Epoch: 23, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.614 Vali Acc: 0.800 Test Loss: 0.614 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 1.2938146591186523
Epoch: 24, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.799994 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.136855125427246
Epoch: 25, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.1187152862548828
Epoch: 26, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.562 Vali Acc: 0.850 Test Loss: 0.562 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 1.2392258644104004
Epoch: 27, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 28 cost time: 1.205824851989746
Epoch: 28, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 29 cost time: 1.3340108394622803
Epoch: 29, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 30 cost time: 1.0965521335601807
Epoch: 30, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 1.2140696048736572
Epoch: 31, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 1.259296178817749
Epoch: 32, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 1.3109252452850342
Epoch: 33, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 1.2929797172546387
Epoch: 34, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 1.246084213256836
Epoch: 35, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.449 Vali Acc: 0.925 Test Loss: 0.449 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.1227550506591797
Epoch: 36, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.1813271045684814
Epoch: 37, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.2957687377929688
Epoch: 38, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.3038079738616943
Epoch: 39, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.2705957889556885
Epoch: 40, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.1496167182922363
Epoch: 41, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 1.272770881652832
Epoch: 42, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 1.1719346046447754
Epoch: 43, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 1.2037358283996582
Epoch: 44, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 1.1341755390167236
Epoch: 45, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 1.1139252185821533
Epoch: 46, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.408 Vali Acc: 0.925 Test Loss: 0.408 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 1.0822186470031738
Epoch: 47, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 1.1501147747039795
Epoch: 48, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 1.00117826461792
Epoch: 49, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 1.3091309070587158
Epoch: 50, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 1.2250618934631348
Epoch: 51, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 1.2251722812652588
Epoch: 52, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 1.1196043491363525
Epoch: 53, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 1.085310459136963
Epoch: 54, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 1.2096199989318848
Epoch: 55, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 1.1354243755340576
Epoch: 56, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 57 cost time: 1.121884822845459
Epoch: 57, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 1.2046611309051514
Epoch: 58, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 1.2274558544158936
Epoch: 59, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 1.1857631206512451
Epoch: 60, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 61 cost time: 1.2848455905914307
Epoch: 61, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 62 cost time: 1.3229093551635742
Epoch: 62, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 63 cost time: 1.1927406787872314
Epoch: 63, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 64 cost time: 1.1896131038665771
Epoch: 64, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 65 cost time: 1.3058500289916992
Epoch: 65, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 66 cost time: 1.383298635482788
Epoch: 66, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 67 cost time: 1.3985474109649658
Epoch: 67, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 68 cost time: 1.250880479812622
Epoch: 68, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 69 cost time: 1.2276298999786377
Epoch: 69, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 70 cost time: 1.2018656730651855
Epoch: 70, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 71 cost time: 1.308664083480835
Epoch: 71, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 72 cost time: 1.234100580215454
Epoch: 72, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 73 cost time: 1.2901668548583984
Epoch: 73, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 74 cost time: 1.2299175262451172
Epoch: 74, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 75 cost time: 1.3201165199279785
Epoch: 75, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 76 cost time: 1.2059879302978516
Epoch: 76, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 77 cost time: 1.249155044555664
Epoch: 77, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 78 cost time: 1.2403879165649414
Epoch: 78, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 79 cost time: 1.2953083515167236
Epoch: 79, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 80 cost time: 1.2500014305114746
Epoch: 80, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 81 cost time: 1.3251652717590332
Epoch: 81, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 82 cost time: 1.1381523609161377
Epoch: 82, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 83 cost time: 1.2028639316558838
Epoch: 83, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 84 cost time: 1.115520715713501
Epoch: 84, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 85 cost time: 1.2164740562438965
Epoch: 85, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 86 cost time: 1.3903224468231201
Epoch: 86, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 87 cost time: 1.109001636505127
Epoch: 87, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 88 cost time: 1.3105528354644775
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 89 cost time: 1.309401035308838
Epoch: 89, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 90 cost time: 1.204099178314209
Epoch: 90, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 91 cost time: 1.0401535034179688
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 92 cost time: 1.1347832679748535
Epoch: 92, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 93 cost time: 1.2587430477142334
Epoch: 93, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 94 cost time: 1.0716161727905273
Epoch: 94, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 95 cost time: 1.1853728294372559
Epoch: 95, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 96 cost time: 1.197070598602295
Epoch: 96, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 97 cost time: 1.4100611209869385
Epoch: 97, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 98 cost time: 1.2653181552886963
Epoch: 98, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 99 cost time: 1.1164426803588867
Epoch: 99, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 100 cost time: 1.2813363075256348
Epoch: 100, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5584609508514404
Epoch: 1, Steps: 3 | Train Loss: 1.579 Vali Loss: 1.458 Vali Acc: 0.250 Test Loss: 1.458 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.2439610958099365
Epoch: 2, Steps: 3 | Train Loss: 1.524 Vali Loss: 1.428 Vali Acc: 0.250 Test Loss: 1.428 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2327821254730225
Epoch: 3, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.402 Vali Acc: 0.375 Test Loss: 1.402 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.2009456157684326
Epoch: 4, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.367 Vali Acc: 0.475 Test Loss: 1.367 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474986).  Saving model ...
Epoch: 5 cost time: 1.2585241794586182
Epoch: 5, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.325 Vali Acc: 0.525 Test Loss: 1.325 Test Acc: 0.525
Validation loss decreased (-0.474986 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 1.1917724609375
Epoch: 6, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.279 Vali Acc: 0.525 Test Loss: 1.279 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 1.254657506942749
Epoch: 7, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 1.285273551940918
Epoch: 8, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.188 Vali Acc: 0.575 Test Loss: 1.188 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 1.277740716934204
Epoch: 9, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 1.222055435180664
Epoch: 10, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 1.281470775604248
Epoch: 11, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.048 Vali Acc: 0.725 Test Loss: 1.048 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 1.3123283386230469
Epoch: 12, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.002 Vali Acc: 0.775 Test Loss: 1.002 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 1.3148267269134521
Epoch: 13, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.955 Vali Acc: 0.775 Test Loss: 0.955 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 1.246544599533081
Epoch: 14, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.906 Vali Acc: 0.800 Test Loss: 0.906 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 1.3339333534240723
Epoch: 15, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 1.334885835647583
Epoch: 16, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 1.3121016025543213
Epoch: 17, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.785 Vali Acc: 0.800 Test Loss: 0.785 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 1.3630154132843018
Epoch: 18, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 1.455129861831665
Epoch: 19, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.716 Vali Acc: 0.825 Test Loss: 0.716 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 1.1681482791900635
Epoch: 20, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.681 Vali Acc: 0.825 Test Loss: 0.681 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.2143008708953857
Epoch: 21, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 22 cost time: 1.2578983306884766
Epoch: 22, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 23 cost time: 1.3004891872406006
Epoch: 23, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.596 Vali Acc: 0.825 Test Loss: 0.596 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824994).  Saving model ...
Epoch: 24 cost time: 1.2642974853515625
Epoch: 24, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.1735661029815674
Epoch: 25, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.181734561920166
Epoch: 26, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 27 cost time: 1.1349809169769287
Epoch: 27, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.532 Vali Acc: 0.875 Test Loss: 0.532 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 28 cost time: 1.287095308303833
Epoch: 28, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 29 cost time: 1.312166452407837
Epoch: 29, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.508 Vali Acc: 0.900 Test Loss: 0.508 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 1.3836557865142822
Epoch: 30, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 1.3099784851074219
Epoch: 31, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 1.4966809749603271
Epoch: 32, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 1.2460722923278809
Epoch: 33, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 1.3615036010742188
Epoch: 34, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 1.4821743965148926
Epoch: 35, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.448 Vali Acc: 0.925 Test Loss: 0.448 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 1.277634620666504
Epoch: 36, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 1.2799737453460693
Epoch: 37, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 1.251194715499878
Epoch: 38, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 1.408592939376831
Epoch: 39, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.431 Vali Acc: 0.925 Test Loss: 0.431 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 1.2952334880828857
Epoch: 40, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 1.2676279544830322
Epoch: 41, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3528106212615967
Epoch: 42, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1871623992919922
Epoch: 43, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1150851249694824
Epoch: 44, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.162806510925293
Epoch: 45, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2094643115997314
Epoch: 46, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1901936531066895
Epoch: 47, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1724584102630615
Epoch: 48, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2210917472839355
Epoch: 49, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 1.1363353729248047
Epoch: 50, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 51 cost time: 1.0847992897033691
Epoch: 51, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 52 cost time: 1.2056984901428223
Epoch: 52, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 53 cost time: 1.169189453125
Epoch: 53, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 54 cost time: 1.1082487106323242
Epoch: 54, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 55 cost time: 1.2302742004394531
Epoch: 55, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 56 cost time: 1.1216204166412354
Epoch: 56, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 57 cost time: 1.1701719760894775
Epoch: 57, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 58 cost time: 1.1362011432647705
Epoch: 58, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.380 Vali Acc: 0.925 Test Loss: 0.380 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 59 cost time: 1.2577998638153076
Epoch: 59, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 60 cost time: 1.0833430290222168
Epoch: 60, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 61 cost time: 1.1084511280059814
Epoch: 61, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 62 cost time: 1.1941304206848145
Epoch: 62, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 63 cost time: 1.1357707977294922
Epoch: 63, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 64 cost time: 1.223836898803711
Epoch: 64, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 65 cost time: 1.3539278507232666
Epoch: 65, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 66 cost time: 1.3222246170043945
Epoch: 66, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 67 cost time: 1.3089735507965088
Epoch: 67, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 68 cost time: 1.4132513999938965
Epoch: 68, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 69 cost time: 1.3084957599639893
Epoch: 69, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 70 cost time: 1.4913082122802734
Epoch: 70, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 71 cost time: 1.2790312767028809
Epoch: 71, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 72 cost time: 1.2066850662231445
Epoch: 72, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 73 cost time: 1.2412121295928955
Epoch: 73, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 74 cost time: 1.3002920150756836
Epoch: 74, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 75 cost time: 1.2187786102294922
Epoch: 75, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 76 cost time: 1.2419376373291016
Epoch: 76, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 77 cost time: 1.1681394577026367
Epoch: 77, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 78 cost time: 1.1951768398284912
Epoch: 78, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 79 cost time: 1.3379714488983154
Epoch: 79, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 80 cost time: 1.2950832843780518
Epoch: 80, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 81 cost time: 1.3698029518127441
Epoch: 81, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 82 cost time: 1.2683625221252441
Epoch: 82, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 83 cost time: 1.1723456382751465
Epoch: 83, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 84 cost time: 1.237658977508545
Epoch: 84, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 85 cost time: 1.2185299396514893
Epoch: 85, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 86 cost time: 1.2591004371643066
Epoch: 86, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 87 cost time: 1.3152575492858887
Epoch: 87, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 88 cost time: 1.155691146850586
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 89 cost time: 1.1775102615356445
Epoch: 89, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 90 cost time: 1.1689703464508057
Epoch: 90, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 91 cost time: 1.1579291820526123
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 92 cost time: 1.5401248931884766
Epoch: 92, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 93 cost time: 1.3896985054016113
Epoch: 93, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.354 Vali Acc: 0.925 Test Loss: 0.354 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 94 cost time: 1.2153139114379883
Epoch: 94, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 95 cost time: 1.123964548110962
Epoch: 95, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 96 cost time: 1.1545398235321045
Epoch: 96, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 97 cost time: 1.2446236610412598
Epoch: 97, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 98 cost time: 1.28415846824646
Epoch: 98, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.3067114353179932
Epoch: 99, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.284905195236206
Epoch: 100, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.445444107055664
Epoch: 1, Steps: 3 | Train Loss: 1.550 Vali Loss: 1.442 Vali Acc: 0.250 Test Loss: 1.442 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.2599256038665771
Epoch: 2, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.413 Vali Acc: 0.225 Test Loss: 1.413 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2138640880584717
Epoch: 3, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.390 Vali Acc: 0.250 Test Loss: 1.390 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.2443053722381592
Epoch: 4, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.359 Vali Acc: 0.275 Test Loss: 1.359 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 1.190687656402588
Epoch: 5, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 1.1629528999328613
Epoch: 6, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.279 Vali Acc: 0.375 Test Loss: 1.279 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.2454025745391846
Epoch: 7, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 1.1241319179534912
Epoch: 8, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.197 Vali Acc: 0.575 Test Loss: 1.197 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 1.1761293411254883
Epoch: 9, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.153 Vali Acc: 0.625 Test Loss: 1.153 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 10 cost time: 1.3401367664337158
Epoch: 10, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 11 cost time: 1.1236817836761475
Epoch: 11, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.066 Vali Acc: 0.650 Test Loss: 1.066 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 1.141568660736084
Epoch: 12, Steps: 3 | Train Loss: 0.809 Vali Loss: 1.023 Vali Acc: 0.675 Test Loss: 1.023 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 1.2889220714569092
Epoch: 13, Steps: 3 | Train Loss: 0.750 Vali Loss: 0.979 Vali Acc: 0.700 Test Loss: 0.979 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699990).  Saving model ...
Epoch: 14 cost time: 1.2450876235961914
Epoch: 14, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.935 Vali Acc: 0.725 Test Loss: 0.935 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 1.2132651805877686
Epoch: 15, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.893 Vali Acc: 0.725 Test Loss: 0.893 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 16 cost time: 1.2928011417388916
Epoch: 16, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.2765350341796875
Epoch: 17, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 1.1937384605407715
Epoch: 18, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.749992 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 1.1768691539764404
Epoch: 19, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.766 Vali Acc: 0.800 Test Loss: 0.766 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 1.2503833770751953
Epoch: 20, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 21 cost time: 1.1902706623077393
Epoch: 21, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 22 cost time: 1.2159054279327393
Epoch: 22, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.675 Vali Acc: 0.825 Test Loss: 0.675 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 1.242739200592041
Epoch: 23, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 1.1300406455993652
Epoch: 24, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 25 cost time: 1.1273236274719238
Epoch: 25, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.615 Vali Acc: 0.850 Test Loss: 0.615 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 26 cost time: 1.4066340923309326
Epoch: 26, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 1.358243465423584
Epoch: 27, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.594 Vali Acc: 0.875 Test Loss: 0.594 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 1.2294931411743164
Epoch: 28, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 1.2404084205627441
Epoch: 29, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 1.2767443656921387
Epoch: 30, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 31 cost time: 1.3618791103363037
Epoch: 31, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 32 cost time: 1.258131504058838
Epoch: 32, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 33 cost time: 1.3223378658294678
Epoch: 33, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 34 cost time: 1.3729333877563477
Epoch: 34, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 35 cost time: 1.3163719177246094
Epoch: 35, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 36 cost time: 1.274188756942749
Epoch: 36, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 37 cost time: 1.2053070068359375
Epoch: 37, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 38 cost time: 1.314737319946289
Epoch: 38, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 1.3194191455841064
Epoch: 39, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 1.4335453510284424
Epoch: 40, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.491 Vali Acc: 0.875 Test Loss: 0.491 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 41 cost time: 1.1797733306884766
Epoch: 41, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.490 Vali Acc: 0.875 Test Loss: 0.490 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 42 cost time: 1.2415852546691895
Epoch: 42, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 43 cost time: 1.2783284187316895
Epoch: 43, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1141934394836426
Epoch: 44, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2721900939941406
Epoch: 45, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.488 Vali Acc: 0.875 Test Loss: 0.488 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 46 cost time: 1.1395692825317383
Epoch: 46, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 47 cost time: 1.2677452564239502
Epoch: 47, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 48 cost time: 1.13200044631958
Epoch: 48, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.479 Vali Acc: 0.875 Test Loss: 0.479 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 49 cost time: 1.2299165725708008
Epoch: 49, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.475 Vali Acc: 0.875 Test Loss: 0.475 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 50 cost time: 1.204242467880249
Epoch: 50, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.472 Vali Acc: 0.875 Test Loss: 0.472 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 51 cost time: 1.1726007461547852
Epoch: 51, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.470 Vali Acc: 0.875 Test Loss: 0.470 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 1.2001104354858398
Epoch: 52, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 1.1928114891052246
Epoch: 53, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.466 Vali Acc: 0.875 Test Loss: 0.466 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 1.3514618873596191
Epoch: 54, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 1.1531198024749756
Epoch: 55, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 1.2461159229278564
Epoch: 56, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 1.155536413192749
Epoch: 57, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.460 Vali Acc: 0.875 Test Loss: 0.460 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 1.1834607124328613
Epoch: 58, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.459 Vali Acc: 0.875 Test Loss: 0.459 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 1.1928510665893555
Epoch: 59, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 1.1157779693603516
Epoch: 60, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 1.273352861404419
Epoch: 61, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 62 cost time: 1.150071620941162
Epoch: 62, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 63 cost time: 1.212512493133545
Epoch: 63, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 64 cost time: 1.1742408275604248
Epoch: 64, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.148583173751831
Epoch: 65, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.456 Vali Acc: 0.875 Test Loss: 0.456 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 66 cost time: 1.127319574356079
Epoch: 66, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.455 Vali Acc: 0.875 Test Loss: 0.455 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 67 cost time: 1.1812567710876465
Epoch: 67, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.454 Vali Acc: 0.875 Test Loss: 0.454 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 68 cost time: 1.1723854541778564
Epoch: 68, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 69 cost time: 1.0885491371154785
Epoch: 69, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 70 cost time: 1.300837755203247
Epoch: 70, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 71 cost time: 1.26273512840271
Epoch: 71, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.3169670104980469
Epoch: 72, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.1580874919891357
Epoch: 73, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.2575676441192627
Epoch: 74, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.452 Vali Acc: 0.875 Test Loss: 0.452 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 75 cost time: 1.2149460315704346
Epoch: 75, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 76 cost time: 1.335599660873413
Epoch: 76, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 77 cost time: 1.2920827865600586
Epoch: 77, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 78 cost time: 1.224881649017334
Epoch: 78, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 79 cost time: 1.3499782085418701
Epoch: 79, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.3011763095855713
Epoch: 80, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.451 Vali Acc: 0.875 Test Loss: 0.451 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.2919518947601318
Epoch: 81, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 82 cost time: 1.2248435020446777
Epoch: 82, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 83 cost time: 1.212275505065918
Epoch: 83, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.2091021537780762
Epoch: 84, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.3689360618591309
Epoch: 85, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.3183870315551758
Epoch: 86, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.3259737491607666
Epoch: 87, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.450 Vali Acc: 0.875 Test Loss: 0.450 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 88 cost time: 1.2576358318328857
Epoch: 88, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 89 cost time: 1.2415916919708252
Epoch: 89, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 90 cost time: 1.1848664283752441
Epoch: 90, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.447 Vali Acc: 0.875 Test Loss: 0.447 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 91 cost time: 1.3190293312072754
Epoch: 91, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 92 cost time: 1.307311773300171
Epoch: 92, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 93 cost time: 1.2375617027282715
Epoch: 93, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.2222099304199219
Epoch: 94, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.1409204006195068
Epoch: 95, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 96 cost time: 1.1560359001159668
Epoch: 96, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 97 cost time: 1.245368480682373
Epoch: 97, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.2726476192474365
Epoch: 98, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.3332123756408691
Epoch: 99, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.875 Test Loss: 0.445 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.1555259227752686
Epoch: 100, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.875 Test Loss: 0.446 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2857539653778076
Epoch: 1, Steps: 3 | Train Loss: 1.471 Vali Loss: 1.385 Vali Acc: 0.175 Test Loss: 1.385 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 1.1336402893066406
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.360 Vali Acc: 0.350 Test Loss: 1.360 Test Acc: 0.350
Validation loss decreased (-0.174986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 1.087594985961914
Epoch: 3, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.337 Vali Acc: 0.375 Test Loss: 1.337 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.1465141773223877
Epoch: 4, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.307 Vali Acc: 0.425 Test Loss: 1.307 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 1.3303248882293701
Epoch: 5, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.270 Vali Acc: 0.450 Test Loss: 1.270 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.1768808364868164
Epoch: 6, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.251270055770874
Epoch: 7, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.187 Vali Acc: 0.575 Test Loss: 1.187 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 1.1636285781860352
Epoch: 8, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 1.1258370876312256
Epoch: 9, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.102 Vali Acc: 0.575 Test Loss: 1.102 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2663698196411133
Epoch: 10, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.058 Vali Acc: 0.575 Test Loss: 1.058 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1590445041656494
Epoch: 11, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.015 Vali Acc: 0.575 Test Loss: 1.015 Test Acc: 0.575
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1875085830688477
Epoch: 12, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.972 Vali Acc: 0.625 Test Loss: 0.972 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 1.2529468536376953
Epoch: 13, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.931 Vali Acc: 0.625 Test Loss: 0.931 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 14 cost time: 1.149839162826538
Epoch: 14, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
Validation loss decreased (-0.624991 --> -0.699991).  Saving model ...
Epoch: 15 cost time: 1.2784132957458496
Epoch: 15, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.851 Vali Acc: 0.700 Test Loss: 0.851 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 16 cost time: 1.4061717987060547
Epoch: 16, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 17 cost time: 1.341259241104126
Epoch: 17, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.790 Vali Acc: 0.725 Test Loss: 0.790 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1094331741333008
Epoch: 18, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.762 Vali Acc: 0.725 Test Loss: 0.762 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2354159355163574
Epoch: 19, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.738 Vali Acc: 0.725 Test Loss: 0.738 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2214934825897217
Epoch: 20, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.710 Vali Acc: 0.725 Test Loss: 0.710 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0745410919189453
Epoch: 21, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 1.1909809112548828
Epoch: 22, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.749993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.152529001235962
Epoch: 23, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.638 Vali Acc: 0.800 Test Loss: 0.638 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 24 cost time: 1.1482584476470947
Epoch: 24, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.623 Vali Acc: 0.800 Test Loss: 0.623 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 25 cost time: 1.2931792736053467
Epoch: 25, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.613 Vali Acc: 0.800 Test Loss: 0.613 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 26 cost time: 1.1292924880981445
Epoch: 26, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1980888843536377
Epoch: 27, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.599 Vali Acc: 0.775 Test Loss: 0.599 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1946921348571777
Epoch: 28, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2421352863311768
Epoch: 29, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3380348682403564
Epoch: 30, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3069026470184326
Epoch: 31, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.560 Vali Acc: 0.800 Test Loss: 0.560 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 32 cost time: 1.256667137145996
Epoch: 32, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 33 cost time: 1.1600451469421387
Epoch: 33, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
Validation loss decreased (-0.799994 --> -0.824995).  Saving model ...
Epoch: 34 cost time: 1.268256664276123
Epoch: 34, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.533 Vali Acc: 0.825 Test Loss: 0.533 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 35 cost time: 1.180534839630127
Epoch: 35, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.527 Vali Acc: 0.825 Test Loss: 0.527 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 36 cost time: 1.159942388534546
Epoch: 36, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.525 Vali Acc: 0.825 Test Loss: 0.525 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 37 cost time: 1.3926138877868652
Epoch: 37, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.520 Vali Acc: 0.825 Test Loss: 0.520 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 38 cost time: 1.200674295425415
Epoch: 38, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.516 Vali Acc: 0.825 Test Loss: 0.516 Test Acc: 0.825
Validation loss decreased (-0.824995 --> -0.824995).  Saving model ...
Epoch: 39 cost time: 1.3067076206207275
Epoch: 39, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 40 cost time: 1.2209680080413818
Epoch: 40, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 41 cost time: 1.1909279823303223
Epoch: 41, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.508 Vali Acc: 0.825 Test Loss: 0.508 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.398921251296997
Epoch: 42, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.506 Vali Acc: 0.825 Test Loss: 0.506 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2709214687347412
Epoch: 43, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.506 Vali Acc: 0.800 Test Loss: 0.506 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.4101839065551758
Epoch: 44, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.506 Vali Acc: 0.800 Test Loss: 0.506 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3076226711273193
Epoch: 45, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.506 Vali Acc: 0.800 Test Loss: 0.506 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.2975356578826904
Epoch: 46, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.503 Vali Acc: 0.800 Test Loss: 0.503 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2735075950622559
Epoch: 47, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.499 Vali Acc: 0.800 Test Loss: 0.499 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2271602153778076
Epoch: 48, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.493 Vali Acc: 0.825 Test Loss: 0.493 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2949774265289307
Epoch: 49, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.488 Vali Acc: 0.825 Test Loss: 0.488 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.376429796218872
Epoch: 50, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.484 Vali Acc: 0.825 Test Loss: 0.484 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.491647243499756
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 1.1389994621276855
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.324 Vali Acc: 0.300 Test Loss: 1.324 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 1.205700159072876
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.305 Vali Acc: 0.300 Test Loss: 1.305 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 1.1905100345611572
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.278 Vali Acc: 0.350 Test Loss: 1.278 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 1.210784673690796
Epoch: 5, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.247 Vali Acc: 0.350 Test Loss: 1.247 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349988).  Saving model ...
Epoch: 6 cost time: 1.212836742401123
Epoch: 6, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.213 Vali Acc: 0.350 Test Loss: 1.213 Test Acc: 0.350
Validation loss decreased (-0.349988 --> -0.349988).  Saving model ...
Epoch: 7 cost time: 1.4118363857269287
Epoch: 7, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.178 Vali Acc: 0.375 Test Loss: 1.178 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 8 cost time: 1.1787283420562744
Epoch: 8, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.144 Vali Acc: 0.475 Test Loss: 1.144 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474989).  Saving model ...
Epoch: 9 cost time: 1.1114890575408936
Epoch: 9, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.109 Vali Acc: 0.650 Test Loss: 1.109 Test Acc: 0.650
Validation loss decreased (-0.474989 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 1.1154160499572754
Epoch: 10, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.074 Vali Acc: 0.625 Test Loss: 1.074 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0744545459747314
Epoch: 11, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.038 Vali Acc: 0.625 Test Loss: 1.038 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1995890140533447
Epoch: 12, Steps: 3 | Train Loss: 0.833 Vali Loss: 1.003 Vali Acc: 0.725 Test Loss: 1.003 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 13 cost time: 1.1495797634124756
Epoch: 13, Steps: 3 | Train Loss: 0.765 Vali Loss: 0.969 Vali Acc: 0.700 Test Loss: 0.969 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1300675868988037
Epoch: 14, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.933 Vali Acc: 0.750 Test Loss: 0.933 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 15 cost time: 1.3256468772888184
Epoch: 15, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.1051948070526123
Epoch: 16, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 1.2146391868591309
Epoch: 17, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.842 Vali Acc: 0.750 Test Loss: 0.842 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 18 cost time: 1.1968743801116943
Epoch: 18, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 19 cost time: 1.2647044658660889
Epoch: 19, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 1.3207719326019287
Epoch: 20, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 1.3063769340515137
Epoch: 21, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
Validation loss decreased (-0.774992 --> -0.774993).  Saving model ...
Epoch: 22 cost time: 1.4078049659729004
Epoch: 22, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 23 cost time: 1.3107333183288574
Epoch: 23, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.685 Vali Acc: 0.800 Test Loss: 0.685 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 24 cost time: 1.3250603675842285
Epoch: 24, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.667 Vali Acc: 0.775 Test Loss: 0.667 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2739672660827637
Epoch: 25, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.657 Vali Acc: 0.800 Test Loss: 0.657 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 26 cost time: 1.4093434810638428
Epoch: 26, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.651 Vali Acc: 0.800 Test Loss: 0.651 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 27 cost time: 1.261136531829834
Epoch: 27, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.648 Vali Acc: 0.800 Test Loss: 0.648 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 28 cost time: 1.2609868049621582
Epoch: 28, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.639 Vali Acc: 0.800 Test Loss: 0.639 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 29 cost time: 1.5435943603515625
Epoch: 29, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3635780811309814
Epoch: 30, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.619 Vali Acc: 0.775 Test Loss: 0.619 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2317860126495361
Epoch: 31, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.610 Vali Acc: 0.800 Test Loss: 0.610 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 32 cost time: 1.2752275466918945
Epoch: 32, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.601 Vali Acc: 0.800 Test Loss: 0.601 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 33 cost time: 1.4047224521636963
Epoch: 33, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.588 Vali Acc: 0.800 Test Loss: 0.588 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 34 cost time: 1.1862587928771973
Epoch: 34, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 35 cost time: 1.2016947269439697
Epoch: 35, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.565 Vali Acc: 0.800 Test Loss: 0.565 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 36 cost time: 1.1457011699676514
Epoch: 36, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.559 Vali Acc: 0.800 Test Loss: 0.559 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 37 cost time: 1.112421989440918
Epoch: 37, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.554 Vali Acc: 0.800 Test Loss: 0.554 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 38 cost time: 1.202183485031128
Epoch: 38, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 39 cost time: 1.1414854526519775
Epoch: 39, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1701226234436035
Epoch: 40, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.426203727722168
Epoch: 41, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4062085151672363
Epoch: 42, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2089223861694336
Epoch: 43, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.800 Test Loss: 0.553 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1763393878936768
Epoch: 44, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.552 Vali Acc: 0.800 Test Loss: 0.552 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.231652021408081
Epoch: 45, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.551 Vali Acc: 0.800 Test Loss: 0.551 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 46 cost time: 1.2071771621704102
Epoch: 46, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.550 Vali Acc: 0.800 Test Loss: 0.550 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 47 cost time: 1.28080415725708
Epoch: 47, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.548 Vali Acc: 0.800 Test Loss: 0.548 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799995).  Saving model ...
Epoch: 48 cost time: 1.1719729900360107
Epoch: 48, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.545 Vali Acc: 0.800 Test Loss: 0.545 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 49 cost time: 1.324450969696045
Epoch: 49, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.540 Vali Acc: 0.800 Test Loss: 0.540 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 50 cost time: 1.2333488464355469
Epoch: 50, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.536 Vali Acc: 0.800 Test Loss: 0.536 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 51 cost time: 1.218792200088501
Epoch: 51, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.537 Vali Acc: 0.800 Test Loss: 0.537 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2188191413879395
Epoch: 52, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.538 Vali Acc: 0.800 Test Loss: 0.538 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2099978923797607
Epoch: 53, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2589085102081299
Epoch: 54, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.3440899848937988
Epoch: 55, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.542 Vali Acc: 0.800 Test Loss: 0.542 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2663354873657227
Epoch: 56, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.545 Vali Acc: 0.800 Test Loss: 0.545 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.192627191543579
Epoch: 57, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.545 Vali Acc: 0.800 Test Loss: 0.545 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.3326950073242188
Epoch: 58, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.545 Vali Acc: 0.800 Test Loss: 0.545 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.1963613033294678
Epoch: 59, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.544 Vali Acc: 0.800 Test Loss: 0.544 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1994712352752686
Epoch: 60, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.543 Vali Acc: 0.800 Test Loss: 0.543 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.8
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.2796437740325928
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.416 Vali Acc: 0.250 Test Loss: 1.416 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1102409362792969
Epoch: 2, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.410 Vali Acc: 0.225 Test Loss: 1.410 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1695725917816162
Epoch: 3, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.405 Vali Acc: 0.225 Test Loss: 1.405 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0953896045684814
Epoch: 4, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.398 Vali Acc: 0.225 Test Loss: 1.398 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1208388805389404
Epoch: 5, Steps: 3 | Train Loss: 1.434 Vali Loss: 1.388 Vali Acc: 0.225 Test Loss: 1.388 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0513231754302979
Epoch: 6, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.375 Vali Acc: 0.250 Test Loss: 1.375 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.1282272338867188
Epoch: 7, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.364 Vali Acc: 0.300 Test Loss: 1.364 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 8 cost time: 1.2021090984344482
Epoch: 8, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 9 cost time: 1.1408560276031494
Epoch: 9, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 10 cost time: 1.1849656105041504
Epoch: 10, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.327 Vali Acc: 0.400 Test Loss: 1.327 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 1.1372644901275635
Epoch: 11, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.315 Vali Acc: 0.425 Test Loss: 1.315 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 12 cost time: 1.1983318328857422
Epoch: 12, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.301 Vali Acc: 0.400 Test Loss: 1.301 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1426403522491455
Epoch: 13, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2079136371612549
Epoch: 14, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.272 Vali Acc: 0.375 Test Loss: 1.272 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1195483207702637
Epoch: 15, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3469152450561523
Epoch: 16, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.239 Vali Acc: 0.425 Test Loss: 1.239 Test Acc: 0.425
Validation loss decreased (-0.424987 --> -0.424988).  Saving model ...
Epoch: 17 cost time: 1.19622802734375
Epoch: 17, Steps: 3 | Train Loss: 0.819 Vali Loss: 1.225 Vali Acc: 0.425 Test Loss: 1.225 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 18 cost time: 1.2859632968902588
Epoch: 18, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.209 Vali Acc: 0.425 Test Loss: 1.209 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 19 cost time: 1.2018914222717285
Epoch: 19, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.195 Vali Acc: 0.450 Test Loss: 1.195 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 20 cost time: 1.1426563262939453
Epoch: 20, Steps: 3 | Train Loss: 0.774 Vali Loss: 1.178 Vali Acc: 0.450 Test Loss: 1.178 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 21 cost time: 1.1763293743133545
Epoch: 21, Steps: 3 | Train Loss: 0.678 Vali Loss: 1.160 Vali Acc: 0.450 Test Loss: 1.160 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 22 cost time: 1.2635352611541748
Epoch: 22, Steps: 3 | Train Loss: 0.648 Vali Loss: 1.141 Vali Acc: 0.475 Test Loss: 1.141 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474989).  Saving model ...
Epoch: 23 cost time: 1.2937848567962646
Epoch: 23, Steps: 3 | Train Loss: 0.598 Vali Loss: 1.124 Vali Acc: 0.475 Test Loss: 1.124 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 24 cost time: 1.175020694732666
Epoch: 24, Steps: 3 | Train Loss: 0.579 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499989).  Saving model ...
Epoch: 25 cost time: 1.2126100063323975
Epoch: 25, Steps: 3 | Train Loss: 0.592 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 26 cost time: 1.1940360069274902
Epoch: 26, Steps: 3 | Train Loss: 0.514 Vali Loss: 1.084 Vali Acc: 0.525 Test Loss: 1.084 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 27 cost time: 1.2211360931396484
Epoch: 27, Steps: 3 | Train Loss: 0.479 Vali Loss: 1.071 Vali Acc: 0.550 Test Loss: 1.071 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 28 cost time: 1.2645187377929688
Epoch: 28, Steps: 3 | Train Loss: 0.436 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549989).  Saving model ...
Epoch: 29 cost time: 1.3025760650634766
Epoch: 29, Steps: 3 | Train Loss: 0.433 Vali Loss: 1.047 Vali Acc: 0.550 Test Loss: 1.047 Test Acc: 0.550
Validation loss decreased (-0.549989 --> -0.549990).  Saving model ...
Epoch: 30 cost time: 1.269615888595581
Epoch: 30, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.034 Vali Acc: 0.550 Test Loss: 1.034 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 31 cost time: 1.2167510986328125
Epoch: 31, Steps: 3 | Train Loss: 0.349 Vali Loss: 1.020 Vali Acc: 0.575 Test Loss: 1.020 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 32 cost time: 1.229367733001709
Epoch: 32, Steps: 3 | Train Loss: 0.350 Vali Loss: 1.002 Vali Acc: 0.575 Test Loss: 1.002 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 33 cost time: 1.2695519924163818
Epoch: 33, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 34 cost time: 1.2051115036010742
Epoch: 34, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.967 Vali Acc: 0.600 Test Loss: 0.967 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 35 cost time: 1.333402395248413
Epoch: 35, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 36 cost time: 1.3009366989135742
Epoch: 36, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.949 Vali Acc: 0.625 Test Loss: 0.949 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624991).  Saving model ...
Epoch: 37 cost time: 1.2021386623382568
Epoch: 37, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 38 cost time: 1.1449213027954102
Epoch: 38, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.933 Vali Acc: 0.625 Test Loss: 0.933 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 39 cost time: 1.1816864013671875
Epoch: 39, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.928 Vali Acc: 0.625 Test Loss: 0.928 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 40 cost time: 1.2179858684539795
Epoch: 40, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.920 Vali Acc: 0.650 Test Loss: 0.920 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649991).  Saving model ...
Epoch: 41 cost time: 1.2022736072540283
Epoch: 41, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.911 Vali Acc: 0.650 Test Loss: 0.911 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 42 cost time: 1.0909969806671143
Epoch: 42, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.905 Vali Acc: 0.675 Test Loss: 0.905 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 43 cost time: 1.1188693046569824
Epoch: 43, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.901 Vali Acc: 0.725 Test Loss: 0.901 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 44 cost time: 1.0982623100280762
Epoch: 44, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.895 Vali Acc: 0.725 Test Loss: 0.895 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 45 cost time: 1.2156314849853516
Epoch: 45, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.891 Vali Acc: 0.725 Test Loss: 0.891 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724991).  Saving model ...
Epoch: 46 cost time: 1.1304666996002197
Epoch: 46, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2576513290405273
Epoch: 47, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 48 cost time: 1.0492589473724365
Epoch: 48, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.864 Vali Acc: 0.750 Test Loss: 0.864 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 49 cost time: 1.2011733055114746
Epoch: 49, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.854 Vali Acc: 0.750 Test Loss: 0.854 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 50 cost time: 1.091839075088501
Epoch: 50, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.848 Vali Acc: 0.750 Test Loss: 0.848 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 51 cost time: 1.1009502410888672
Epoch: 51, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 52 cost time: 1.0616905689239502
Epoch: 52, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.834 Vali Acc: 0.750 Test Loss: 0.834 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 53 cost time: 1.152775764465332
Epoch: 53, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.828 Vali Acc: 0.750 Test Loss: 0.828 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 1.0469098091125488
Epoch: 54, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 55 cost time: 1.1248023509979248
Epoch: 55, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.820 Vali Acc: 0.725 Test Loss: 0.820 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1900339126586914
Epoch: 56, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.817 Vali Acc: 0.725 Test Loss: 0.817 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1922383308410645
Epoch: 57, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.812 Vali Acc: 0.725 Test Loss: 0.812 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1872375011444092
Epoch: 58, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.806 Vali Acc: 0.725 Test Loss: 0.806 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1546728610992432
Epoch: 59, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.802 Vali Acc: 0.725 Test Loss: 0.802 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.088465929031372
Epoch: 60, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 61 cost time: 1.2045810222625732
Epoch: 61, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.792 Vali Acc: 0.750 Test Loss: 0.792 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 62 cost time: 1.1992170810699463
Epoch: 62, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.786 Vali Acc: 0.750 Test Loss: 0.786 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 63 cost time: 1.2355272769927979
Epoch: 63, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 64 cost time: 1.1798622608184814
Epoch: 64, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 65 cost time: 1.3491008281707764
Epoch: 65, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 66 cost time: 1.1917064189910889
Epoch: 66, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.763 Vali Acc: 0.750 Test Loss: 0.763 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 67 cost time: 1.2106056213378906
Epoch: 67, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.758 Vali Acc: 0.750 Test Loss: 0.758 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 68 cost time: 1.2431309223175049
Epoch: 68, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.755 Vali Acc: 0.750 Test Loss: 0.755 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 69 cost time: 1.1986384391784668
Epoch: 69, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.752 Vali Acc: 0.750 Test Loss: 0.752 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 70 cost time: 1.3281471729278564
Epoch: 70, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.746 Vali Acc: 0.750 Test Loss: 0.746 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 71 cost time: 1.3560926914215088
Epoch: 71, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 72 cost time: 1.2357017993927002
Epoch: 72, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.738 Vali Acc: 0.750 Test Loss: 0.738 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 73 cost time: 1.2518041133880615
Epoch: 73, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.735 Vali Acc: 0.750 Test Loss: 0.735 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 74 cost time: 1.1864867210388184
Epoch: 74, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 75 cost time: 1.1291158199310303
Epoch: 75, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.727 Vali Acc: 0.750 Test Loss: 0.727 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 76 cost time: 1.1748826503753662
Epoch: 76, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.725 Vali Acc: 0.750 Test Loss: 0.725 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 77 cost time: 1.1854827404022217
Epoch: 77, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 78 cost time: 1.165065050125122
Epoch: 78, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 79 cost time: 1.1221578121185303
Epoch: 79, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 80 cost time: 1.1961863040924072
Epoch: 80, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
Validation loss decreased (-0.749993 --> -0.774993).  Saving model ...
Epoch: 81 cost time: 1.1940226554870605
Epoch: 81, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 82 cost time: 1.196699857711792
Epoch: 82, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 83 cost time: 1.1309678554534912
Epoch: 83, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 84 cost time: 1.1242115497589111
Epoch: 84, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.206812858581543
Epoch: 85, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.1223599910736084
Epoch: 86, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.1739575862884521
Epoch: 87, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.2254576683044434
Epoch: 88, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.0985243320465088
Epoch: 89, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 90 cost time: 1.187415361404419
Epoch: 90, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.701 Vali Acc: 0.775 Test Loss: 0.701 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 91 cost time: 1.1921501159667969
Epoch: 91, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 92 cost time: 1.1060128211975098
Epoch: 92, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 93 cost time: 1.2043368816375732
Epoch: 93, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 94 cost time: 1.25233793258667
Epoch: 94, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 95 cost time: 1.1619484424591064
Epoch: 95, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 96 cost time: 1.3019130229949951
Epoch: 96, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.685 Vali Acc: 0.775 Test Loss: 0.685 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 97 cost time: 1.1765165328979492
Epoch: 97, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.684 Vali Acc: 0.775 Test Loss: 0.684 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 98 cost time: 1.0850119590759277
Epoch: 98, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 99 cost time: 1.1909806728363037
Epoch: 99, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.681 Vali Acc: 0.775 Test Loss: 0.681 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
Epoch: 100 cost time: 1.2606220245361328
Epoch: 100, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.680 Vali Acc: 0.775 Test Loss: 0.680 Test Acc: 0.775
Validation loss decreased (-0.774993 --> -0.774993).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.3876335620880127
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.483 Vali Acc: 0.125 Test Loss: 1.483 Test Acc: 0.125
Validation loss decreased (inf --> -0.124985).  Saving model ...
Epoch: 2 cost time: 1.1738080978393555
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.483 Vali Acc: 0.125 Test Loss: 1.483 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0716514587402344
Epoch: 3, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.483 Vali Acc: 0.150 Test Loss: 1.483 Test Acc: 0.150
Validation loss decreased (-0.124985 --> -0.149985).  Saving model ...
Epoch: 4 cost time: 1.1839213371276855
Epoch: 4, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.480 Vali Acc: 0.175 Test Loss: 1.480 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174985).  Saving model ...
Epoch: 5 cost time: 1.1956510543823242
Epoch: 5, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.477 Vali Acc: 0.200 Test Loss: 1.477 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 1.1767990589141846
Epoch: 6, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.473 Vali Acc: 0.200 Test Loss: 1.473 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 7 cost time: 1.260998249053955
Epoch: 7, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.469 Vali Acc: 0.150 Test Loss: 1.469 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2087056636810303
Epoch: 8, Steps: 3 | Train Loss: 1.393 Vali Loss: 1.466 Vali Acc: 0.150 Test Loss: 1.466 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1199254989624023
Epoch: 9, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.462 Vali Acc: 0.150 Test Loss: 1.462 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0397670269012451
Epoch: 10, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.460 Vali Acc: 0.150 Test Loss: 1.460 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1529855728149414
Epoch: 11, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.458 Vali Acc: 0.225 Test Loss: 1.458 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 12 cost time: 1.1970551013946533
Epoch: 12, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.456 Vali Acc: 0.225 Test Loss: 1.456 Test Acc: 0.225
Validation loss decreased (-0.224985 --> -0.224985).  Saving model ...
Epoch: 13 cost time: 1.2293119430541992
Epoch: 13, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.452 Vali Acc: 0.250 Test Loss: 1.452 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249985).  Saving model ...
Epoch: 14 cost time: 1.2422640323638916
Epoch: 14, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.446 Vali Acc: 0.250 Test Loss: 1.446 Test Acc: 0.250
Validation loss decreased (-0.249985 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.093320369720459
Epoch: 15, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.441 Vali Acc: 0.250 Test Loss: 1.441 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.267153024673462
Epoch: 16, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 17 cost time: 1.3891191482543945
Epoch: 17, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.434 Vali Acc: 0.275 Test Loss: 1.434 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 18 cost time: 1.305880069732666
Epoch: 18, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.430 Vali Acc: 0.275 Test Loss: 1.430 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 19 cost time: 1.2655694484710693
Epoch: 19, Steps: 3 | Train Loss: 0.960 Vali Loss: 1.426 Vali Acc: 0.275 Test Loss: 1.426 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 20 cost time: 1.1823947429656982
Epoch: 20, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.419 Vali Acc: 0.275 Test Loss: 1.419 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 21 cost time: 1.175666093826294
Epoch: 21, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.413 Vali Acc: 0.300 Test Loss: 1.413 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 22 cost time: 1.338756799697876
Epoch: 22, Steps: 3 | Train Loss: 0.784 Vali Loss: 1.406 Vali Acc: 0.300 Test Loss: 1.406 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 23 cost time: 1.3995745182037354
Epoch: 23, Steps: 3 | Train Loss: 0.775 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.350705623626709
Epoch: 24, Steps: 3 | Train Loss: 0.847 Vali Loss: 1.399 Vali Acc: 0.275 Test Loss: 1.399 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3839426040649414
Epoch: 25, Steps: 3 | Train Loss: 0.776 Vali Loss: 1.396 Vali Acc: 0.275 Test Loss: 1.396 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2366011142730713
Epoch: 26, Steps: 3 | Train Loss: 0.717 Vali Loss: 1.388 Vali Acc: 0.275 Test Loss: 1.388 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2787842750549316
Epoch: 27, Steps: 3 | Train Loss: 0.711 Vali Loss: 1.379 Vali Acc: 0.275 Test Loss: 1.379 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2804527282714844
Epoch: 28, Steps: 3 | Train Loss: 0.638 Vali Loss: 1.370 Vali Acc: 0.275 Test Loss: 1.370 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5226020812988281
Epoch: 29, Steps: 3 | Train Loss: 0.596 Vali Loss: 1.361 Vali Acc: 0.300 Test Loss: 1.361 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 30 cost time: 1.3393337726593018
Epoch: 30, Steps: 3 | Train Loss: 0.586 Vali Loss: 1.357 Vali Acc: 0.325 Test Loss: 1.357 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 31 cost time: 1.3242759704589844
Epoch: 31, Steps: 3 | Train Loss: 0.499 Vali Loss: 1.352 Vali Acc: 0.300 Test Loss: 1.352 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2462365627288818
Epoch: 32, Steps: 3 | Train Loss: 0.524 Vali Loss: 1.345 Vali Acc: 0.300 Test Loss: 1.345 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1738488674163818
Epoch: 33, Steps: 3 | Train Loss: 0.487 Vali Loss: 1.340 Vali Acc: 0.300 Test Loss: 1.340 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3032729625701904
Epoch: 34, Steps: 3 | Train Loss: 0.435 Vali Loss: 1.336 Vali Acc: 0.300 Test Loss: 1.336 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3497412204742432
Epoch: 35, Steps: 3 | Train Loss: 0.464 Vali Loss: 1.328 Vali Acc: 0.325 Test Loss: 1.328 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 36 cost time: 1.3374266624450684
Epoch: 36, Steps: 3 | Train Loss: 0.394 Vali Loss: 1.327 Vali Acc: 0.325 Test Loss: 1.327 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 37 cost time: 1.2818784713745117
Epoch: 37, Steps: 3 | Train Loss: 0.410 Vali Loss: 1.326 Vali Acc: 0.350 Test Loss: 1.326 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 38 cost time: 1.3112115859985352
Epoch: 38, Steps: 3 | Train Loss: 0.365 Vali Loss: 1.323 Vali Acc: 0.350 Test Loss: 1.323 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 39 cost time: 1.3223950862884521
Epoch: 39, Steps: 3 | Train Loss: 0.352 Vali Loss: 1.322 Vali Acc: 0.400 Test Loss: 1.322 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 40 cost time: 1.6064252853393555
Epoch: 40, Steps: 3 | Train Loss: 0.333 Vali Loss: 1.315 Vali Acc: 0.400 Test Loss: 1.315 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 41 cost time: 1.274118185043335
Epoch: 41, Steps: 3 | Train Loss: 0.295 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.158503770828247
Epoch: 42, Steps: 3 | Train Loss: 0.331 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2117621898651123
Epoch: 43, Steps: 3 | Train Loss: 0.280 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 44 cost time: 1.246356725692749
Epoch: 44, Steps: 3 | Train Loss: 0.249 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 45 cost time: 1.2158317565917969
Epoch: 45, Steps: 3 | Train Loss: 0.207 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2891879081726074
Epoch: 46, Steps: 3 | Train Loss: 0.256 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.200406789779663
Epoch: 47, Steps: 3 | Train Loss: 0.172 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.124927282333374
Epoch: 48, Steps: 3 | Train Loss: 0.201 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2055225372314453
Epoch: 49, Steps: 3 | Train Loss: 0.214 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1939971446990967
Epoch: 50, Steps: 3 | Train Loss: 0.184 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2113113403320312
Epoch: 51, Steps: 3 | Train Loss: 0.177 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 52 cost time: 1.3253462314605713
Epoch: 52, Steps: 3 | Train Loss: 0.160 Vali Loss: 1.242 Vali Acc: 0.400 Test Loss: 1.242 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 53 cost time: 1.1101858615875244
Epoch: 53, Steps: 3 | Train Loss: 0.143 Vali Loss: 1.218 Vali Acc: 0.425 Test Loss: 1.218 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 54 cost time: 1.3146848678588867
Epoch: 54, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.217 Vali Acc: 0.450 Test Loss: 1.217 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 55 cost time: 1.2762064933776855
Epoch: 55, Steps: 3 | Train Loss: 0.135 Vali Loss: 1.214 Vali Acc: 0.450 Test Loss: 1.214 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 56 cost time: 1.3203320503234863
Epoch: 56, Steps: 3 | Train Loss: 0.125 Vali Loss: 1.211 Vali Acc: 0.450 Test Loss: 1.211 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 57 cost time: 1.2953758239746094
Epoch: 57, Steps: 3 | Train Loss: 0.114 Vali Loss: 1.224 Vali Acc: 0.425 Test Loss: 1.224 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.2028520107269287
Epoch: 58, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.219 Vali Acc: 0.425 Test Loss: 1.219 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1370198726654053
Epoch: 59, Steps: 3 | Train Loss: 0.108 Vali Loss: 1.202 Vali Acc: 0.425 Test Loss: 1.202 Test Acc: 0.425
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.2464895248413086
Epoch: 60, Steps: 3 | Train Loss: 0.112 Vali Loss: 1.174 Vali Acc: 0.450 Test Loss: 1.174 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 61 cost time: 1.3134279251098633
Epoch: 61, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.160 Vali Acc: 0.450 Test Loss: 1.160 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 62 cost time: 1.361591100692749
Epoch: 62, Steps: 3 | Train Loss: 0.110 Vali Loss: 1.162 Vali Acc: 0.450 Test Loss: 1.162 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.421389102935791
Epoch: 63, Steps: 3 | Train Loss: 0.085 Vali Loss: 1.155 Vali Acc: 0.450 Test Loss: 1.155 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 64 cost time: 1.4652469158172607
Epoch: 64, Steps: 3 | Train Loss: 0.081 Vali Loss: 1.154 Vali Acc: 0.450 Test Loss: 1.154 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 65 cost time: 1.2817258834838867
Epoch: 65, Steps: 3 | Train Loss: 0.079 Vali Loss: 1.142 Vali Acc: 0.450 Test Loss: 1.142 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449989).  Saving model ...
Epoch: 66 cost time: 1.1777281761169434
Epoch: 66, Steps: 3 | Train Loss: 0.088 Vali Loss: 1.122 Vali Acc: 0.450 Test Loss: 1.122 Test Acc: 0.450
Validation loss decreased (-0.449989 --> -0.449989).  Saving model ...
Epoch: 67 cost time: 1.249833583831787
Epoch: 67, Steps: 3 | Train Loss: 0.068 Vali Loss: 1.106 Vali Acc: 0.450 Test Loss: 1.106 Test Acc: 0.450
Validation loss decreased (-0.449989 --> -0.449989).  Saving model ...
Epoch: 68 cost time: 1.2667112350463867
Epoch: 68, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.087 Vali Acc: 0.475 Test Loss: 1.087 Test Acc: 0.475
Validation loss decreased (-0.449989 --> -0.474989).  Saving model ...
Epoch: 69 cost time: 1.2219207286834717
Epoch: 69, Steps: 3 | Train Loss: 0.055 Vali Loss: 1.081 Vali Acc: 0.475 Test Loss: 1.081 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 70 cost time: 1.1458938121795654
Epoch: 70, Steps: 3 | Train Loss: 0.073 Vali Loss: 1.085 Vali Acc: 0.475 Test Loss: 1.085 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.228935718536377
Epoch: 71, Steps: 3 | Train Loss: 0.080 Vali Loss: 1.091 Vali Acc: 0.475 Test Loss: 1.091 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.158646583557129
Epoch: 72, Steps: 3 | Train Loss: 0.065 Vali Loss: 1.099 Vali Acc: 0.475 Test Loss: 1.099 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.31014084815979
Epoch: 73, Steps: 3 | Train Loss: 0.043 Vali Loss: 1.096 Vali Acc: 0.475 Test Loss: 1.096 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.245896816253662
Epoch: 74, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.098 Vali Acc: 0.475 Test Loss: 1.098 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.158776044845581
Epoch: 75, Steps: 3 | Train Loss: 0.056 Vali Loss: 1.094 Vali Acc: 0.475 Test Loss: 1.094 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.1875109672546387
Epoch: 76, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.087 Vali Acc: 0.475 Test Loss: 1.087 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.205331802368164
Epoch: 77, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.077 Vali Acc: 0.475 Test Loss: 1.077 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 78 cost time: 1.2692573070526123
Epoch: 78, Steps: 3 | Train Loss: 0.061 Vali Loss: 1.075 Vali Acc: 0.475 Test Loss: 1.075 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 79 cost time: 1.2661054134368896
Epoch: 79, Steps: 3 | Train Loss: 0.040 Vali Loss: 1.062 Vali Acc: 0.475 Test Loss: 1.062 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474989).  Saving model ...
Epoch: 80 cost time: 1.262230396270752
Epoch: 80, Steps: 3 | Train Loss: 0.048 Vali Loss: 1.017 Vali Acc: 0.500 Test Loss: 1.017 Test Acc: 0.500
Validation loss decreased (-0.474989 --> -0.499990).  Saving model ...
Epoch: 81 cost time: 1.2557461261749268
Epoch: 81, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.990 Vali Acc: 0.500 Test Loss: 0.990 Test Acc: 0.500
Validation loss decreased (-0.499990 --> -0.499990).  Saving model ...
Epoch: 82 cost time: 1.2031073570251465
Epoch: 82, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.982 Vali Acc: 0.525 Test Loss: 0.982 Test Acc: 0.525
Validation loss decreased (-0.499990 --> -0.524990).  Saving model ...
Epoch: 83 cost time: 1.243133306503296
Epoch: 83, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.981 Vali Acc: 0.525 Test Loss: 0.981 Test Acc: 0.525
Validation loss decreased (-0.524990 --> -0.524990).  Saving model ...
Epoch: 84 cost time: 1.1533446311950684
Epoch: 84, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.995 Vali Acc: 0.525 Test Loss: 0.995 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.2157723903656006
Epoch: 85, Steps: 3 | Train Loss: 0.036 Vali Loss: 1.010 Vali Acc: 0.525 Test Loss: 1.010 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.1472163200378418
Epoch: 86, Steps: 3 | Train Loss: 0.035 Vali Loss: 1.023 Vali Acc: 0.525 Test Loss: 1.023 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.1560277938842773
Epoch: 87, Steps: 3 | Train Loss: 0.031 Vali Loss: 1.039 Vali Acc: 0.525 Test Loss: 1.039 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.240644931793213
Epoch: 88, Steps: 3 | Train Loss: 0.022 Vali Loss: 1.046 Vali Acc: 0.525 Test Loss: 1.046 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.2518017292022705
Epoch: 89, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.055 Vali Acc: 0.525 Test Loss: 1.055 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.1893410682678223
Epoch: 90, Steps: 3 | Train Loss: 0.030 Vali Loss: 1.048 Vali Acc: 0.525 Test Loss: 1.048 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 1.274583339691162
Epoch: 91, Steps: 3 | Train Loss: 0.020 Vali Loss: 1.033 Vali Acc: 0.525 Test Loss: 1.033 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 1.2195374965667725
Epoch: 92, Steps: 3 | Train Loss: 0.024 Vali Loss: 1.004 Vali Acc: 0.525 Test Loss: 1.004 Test Acc: 0.525
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 1.1227126121520996
Epoch: 93, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.977 Vali Acc: 0.550 Test Loss: 0.977 Test Acc: 0.550
Validation loss decreased (-0.524990 --> -0.549990).  Saving model ...
Epoch: 94 cost time: 1.2899470329284668
Epoch: 94, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 95 cost time: 1.25089693069458
Epoch: 95, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.941 Vali Acc: 0.550 Test Loss: 0.941 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549991).  Saving model ...
Epoch: 96 cost time: 1.3017914295196533
Epoch: 96, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.943 Vali Acc: 0.550 Test Loss: 0.943 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.2869524955749512
Epoch: 97, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.942 Vali Acc: 0.550 Test Loss: 0.942 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.2781329154968262
Epoch: 98, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.951 Vali Acc: 0.550 Test Loss: 0.951 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.3186328411102295
Epoch: 99, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.954 Vali Acc: 0.550 Test Loss: 0.954 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.3271863460540771
Epoch: 100, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.55
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.5927817821502686
Epoch: 1, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.398 Vali Acc: 0.250 Test Loss: 1.398 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3589191436767578
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.2505335807800293
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.395 Vali Acc: 0.250 Test Loss: 1.395 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 1.2780234813690186
Epoch: 4, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.391 Vali Acc: 0.250 Test Loss: 1.391 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 1.2204926013946533
Epoch: 5, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 1.1784522533416748
Epoch: 6, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.377 Vali Acc: 0.275 Test Loss: 1.377 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 7 cost time: 1.1723835468292236
Epoch: 7, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.370 Vali Acc: 0.325 Test Loss: 1.370 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 8 cost time: 1.1901240348815918
Epoch: 8, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.364 Vali Acc: 0.325 Test Loss: 1.364 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 9 cost time: 1.1215548515319824
Epoch: 9, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.356 Vali Acc: 0.350 Test Loss: 1.356 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 10 cost time: 1.1780362129211426
Epoch: 10, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.350 Vali Acc: 0.325 Test Loss: 1.350 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0531749725341797
Epoch: 11, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349987).  Saving model ...
Epoch: 12 cost time: 1.1200358867645264
Epoch: 12, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.339 Vali Acc: 0.350 Test Loss: 1.339 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 13 cost time: 1.2431354522705078
Epoch: 13, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.332 Vali Acc: 0.350 Test Loss: 1.332 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 14 cost time: 1.3214588165283203
Epoch: 14, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.324 Vali Acc: 0.350 Test Loss: 1.324 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 15 cost time: 1.2364888191223145
Epoch: 15, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 16 cost time: 1.277231216430664
Epoch: 16, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.306 Vali Acc: 0.375 Test Loss: 1.306 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 17 cost time: 1.2182133197784424
Epoch: 17, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.300 Vali Acc: 0.375 Test Loss: 1.300 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 18 cost time: 1.1492927074432373
Epoch: 18, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.291 Vali Acc: 0.350 Test Loss: 1.291 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.315234661102295
Epoch: 19, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.281 Vali Acc: 0.375 Test Loss: 1.281 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 20 cost time: 1.1581201553344727
Epoch: 20, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 21 cost time: 1.373469591140747
Epoch: 21, Steps: 3 | Train Loss: 0.853 Vali Loss: 1.258 Vali Acc: 0.375 Test Loss: 1.258 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.127896785736084
Epoch: 22, Steps: 3 | Train Loss: 0.763 Vali Loss: 1.246 Vali Acc: 0.375 Test Loss: 1.246 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2570149898529053
Epoch: 23, Steps: 3 | Train Loss: 0.749 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 24 cost time: 1.3226521015167236
Epoch: 24, Steps: 3 | Train Loss: 0.786 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 25 cost time: 1.2880444526672363
Epoch: 25, Steps: 3 | Train Loss: 0.700 Vali Loss: 1.222 Vali Acc: 0.425 Test Loss: 1.222 Test Acc: 0.425
Validation loss decreased (-0.399988 --> -0.424988).  Saving model ...
Epoch: 26 cost time: 1.21952486038208
Epoch: 26, Steps: 3 | Train Loss: 0.664 Vali Loss: 1.217 Vali Acc: 0.425 Test Loss: 1.217 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 27 cost time: 1.283146858215332
Epoch: 27, Steps: 3 | Train Loss: 0.634 Vali Loss: 1.209 Vali Acc: 0.450 Test Loss: 1.209 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449988).  Saving model ...
Epoch: 28 cost time: 1.3048315048217773
Epoch: 28, Steps: 3 | Train Loss: 0.576 Vali Loss: 1.200 Vali Acc: 0.475 Test Loss: 1.200 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 29 cost time: 1.2400813102722168
Epoch: 29, Steps: 3 | Train Loss: 0.547 Vali Loss: 1.189 Vali Acc: 0.450 Test Loss: 1.189 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.326294183731079
Epoch: 30, Steps: 3 | Train Loss: 0.602 Vali Loss: 1.180 Vali Acc: 0.450 Test Loss: 1.180 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3451473712921143
Epoch: 31, Steps: 3 | Train Loss: 0.441 Vali Loss: 1.172 Vali Acc: 0.450 Test Loss: 1.172 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1598434448242188
Epoch: 32, Steps: 3 | Train Loss: 0.491 Vali Loss: 1.162 Vali Acc: 0.475 Test Loss: 1.162 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 33 cost time: 1.30063796043396
Epoch: 33, Steps: 3 | Train Loss: 0.475 Vali Loss: 1.154 Vali Acc: 0.450 Test Loss: 1.154 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2032749652862549
Epoch: 34, Steps: 3 | Train Loss: 0.439 Vali Loss: 1.149 Vali Acc: 0.450 Test Loss: 1.149 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2727806568145752
Epoch: 35, Steps: 3 | Train Loss: 0.406 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 36 cost time: 1.3073663711547852
Epoch: 36, Steps: 3 | Train Loss: 0.352 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 37 cost time: 1.075242280960083
Epoch: 37, Steps: 3 | Train Loss: 0.359 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 38 cost time: 1.074411392211914
Epoch: 38, Steps: 3 | Train Loss: 0.382 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 39 cost time: 1.1800181865692139
Epoch: 39, Steps: 3 | Train Loss: 0.279 Vali Loss: 1.117 Vali Acc: 0.525 Test Loss: 1.117 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 40 cost time: 1.13688063621521
Epoch: 40, Steps: 3 | Train Loss: 0.275 Vali Loss: 1.114 Vali Acc: 0.525 Test Loss: 1.114 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 41 cost time: 1.0789110660552979
Epoch: 41, Steps: 3 | Train Loss: 0.254 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1878116130828857
Epoch: 42, Steps: 3 | Train Loss: 0.285 Vali Loss: 1.112 Vali Acc: 0.475 Test Loss: 1.112 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2356278896331787
Epoch: 43, Steps: 3 | Train Loss: 0.250 Vali Loss: 1.116 Vali Acc: 0.475 Test Loss: 1.116 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1506707668304443
Epoch: 44, Steps: 3 | Train Loss: 0.210 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1576650142669678
Epoch: 45, Steps: 3 | Train Loss: 0.187 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1587018966674805
Epoch: 46, Steps: 3 | Train Loss: 0.218 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2273015975952148
Epoch: 47, Steps: 3 | Train Loss: 0.185 Vali Loss: 1.100 Vali Acc: 0.500 Test Loss: 1.100 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1032347679138184
Epoch: 48, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1590003967285156
Epoch: 49, Steps: 3 | Train Loss: 0.175 Vali Loss: 1.075 Vali Acc: 0.525 Test Loss: 1.075 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 50 cost time: 1.211378812789917
Epoch: 50, Steps: 3 | Train Loss: 0.156 Vali Loss: 1.066 Vali Acc: 0.525 Test Loss: 1.066 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524989).  Saving model ...
Epoch: 51 cost time: 1.1792995929718018
Epoch: 51, Steps: 3 | Train Loss: 0.159 Vali Loss: 1.045 Vali Acc: 0.525 Test Loss: 1.045 Test Acc: 0.525
Validation loss decreased (-0.524989 --> -0.524990).  Saving model ...
Epoch: 52 cost time: 1.1430366039276123
Epoch: 52, Steps: 3 | Train Loss: 0.148 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
Validation loss decreased (-0.524990 --> -0.549990).  Saving model ...
Epoch: 53 cost time: 1.2455508708953857
Epoch: 53, Steps: 3 | Train Loss: 0.153 Vali Loss: 1.016 Vali Acc: 0.575 Test Loss: 1.016 Test Acc: 0.575
Validation loss decreased (-0.549990 --> -0.574990).  Saving model ...
Epoch: 54 cost time: 1.1780850887298584
Epoch: 54, Steps: 3 | Train Loss: 0.129 Vali Loss: 1.021 Vali Acc: 0.525 Test Loss: 1.021 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2245092391967773
Epoch: 55, Steps: 3 | Train Loss: 0.115 Vali Loss: 1.024 Vali Acc: 0.525 Test Loss: 1.024 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.234177827835083
Epoch: 56, Steps: 3 | Train Loss: 0.124 Vali Loss: 1.024 Vali Acc: 0.525 Test Loss: 1.024 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1918919086456299
Epoch: 57, Steps: 3 | Train Loss: 0.109 Vali Loss: 1.022 Vali Acc: 0.525 Test Loss: 1.022 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.3275320529937744
Epoch: 58, Steps: 3 | Train Loss: 0.102 Vali Loss: 1.012 Vali Acc: 0.525 Test Loss: 1.012 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.3111457824707031
Epoch: 59, Steps: 3 | Train Loss: 0.104 Vali Loss: 1.001 Vali Acc: 0.550 Test Loss: 1.001 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.2418670654296875
Epoch: 60, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.989 Vali Acc: 0.575 Test Loss: 0.989 Test Acc: 0.575
Validation loss decreased (-0.574990 --> -0.574990).  Saving model ...
Epoch: 61 cost time: 1.231879711151123
Epoch: 61, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 62 cost time: 1.1915736198425293
Epoch: 62, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.980 Vali Acc: 0.600 Test Loss: 0.980 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 63 cost time: 1.194030523300171
Epoch: 63, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 64 cost time: 1.317126750946045
Epoch: 64, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.969 Vali Acc: 0.600 Test Loss: 0.969 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 65 cost time: 1.2583484649658203
Epoch: 65, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.963 Vali Acc: 0.625 Test Loss: 0.963 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 66 cost time: 1.2397892475128174
Epoch: 66, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.946 Vali Acc: 0.625 Test Loss: 0.946 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 67 cost time: 1.250525712966919
Epoch: 67, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.929 Vali Acc: 0.625 Test Loss: 0.929 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 68 cost time: 1.2206709384918213
Epoch: 68, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.916 Vali Acc: 0.625 Test Loss: 0.916 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 69 cost time: 1.2732493877410889
Epoch: 69, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.909 Vali Acc: 0.625 Test Loss: 0.909 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 70 cost time: 1.2442388534545898
Epoch: 70, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.905 Vali Acc: 0.625 Test Loss: 0.905 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 71 cost time: 1.1987864971160889
Epoch: 71, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.905 Vali Acc: 0.625 Test Loss: 0.905 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 72 cost time: 1.1821069717407227
Epoch: 72, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.908 Vali Acc: 0.625 Test Loss: 0.908 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.1312675476074219
Epoch: 73, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.909 Vali Acc: 0.625 Test Loss: 0.909 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.1166622638702393
Epoch: 74, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.919 Vali Acc: 0.600 Test Loss: 0.919 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.2014718055725098
Epoch: 75, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.930 Vali Acc: 0.575 Test Loss: 0.930 Test Acc: 0.575
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.2882089614868164
Epoch: 76, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.936 Vali Acc: 0.575 Test Loss: 0.936 Test Acc: 0.575
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.250502586364746
Epoch: 77, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.932 Vali Acc: 0.575 Test Loss: 0.932 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.2984390258789062
Epoch: 78, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.924 Vali Acc: 0.575 Test Loss: 0.924 Test Acc: 0.575
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.2122626304626465
Epoch: 79, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.901 Vali Acc: 0.575 Test Loss: 0.901 Test Acc: 0.575
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.352583885192871
Epoch: 80, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.859 Vali Acc: 0.625 Test Loss: 0.859 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 81 cost time: 1.160557746887207
Epoch: 81, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.836 Vali Acc: 0.650 Test Loss: 0.836 Test Acc: 0.650
Validation loss decreased (-0.624991 --> -0.649992).  Saving model ...
Epoch: 82 cost time: 1.1822950839996338
Epoch: 82, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.830 Vali Acc: 0.650 Test Loss: 0.830 Test Acc: 0.650
Validation loss decreased (-0.649992 --> -0.649992).  Saving model ...
Epoch: 83 cost time: 1.1133472919464111
Epoch: 83, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.832 Vali Acc: 0.650 Test Loss: 0.832 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.3285927772521973
Epoch: 84, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.840 Vali Acc: 0.625 Test Loss: 0.840 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.1802599430084229
Epoch: 85, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.849 Vali Acc: 0.650 Test Loss: 0.849 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.1595218181610107
Epoch: 86, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.857 Vali Acc: 0.625 Test Loss: 0.857 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.1968834400177002
Epoch: 87, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.872 Vali Acc: 0.625 Test Loss: 0.872 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 1.1465654373168945
Epoch: 88, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.878 Vali Acc: 0.625 Test Loss: 0.878 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 1.157222032546997
Epoch: 89, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.882 Vali Acc: 0.625 Test Loss: 0.882 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 1.2243046760559082
Epoch: 90, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.876 Vali Acc: 0.625 Test Loss: 0.876 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 1.1909387111663818
Epoch: 91, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.870 Vali Acc: 0.625 Test Loss: 0.870 Test Acc: 0.625
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 1.2601289749145508
Epoch: 92, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.854 Vali Acc: 0.625 Test Loss: 0.854 Test Acc: 0.625
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.65
model parameter : 76900
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
fourier enhanced block used!
modes=32, index=[2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 28, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 46, 47, 48]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
 fourier enhanced cross attention used!
modes_q=25, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
modes_kv=32, index_kv=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 35, 36, 37, 39, 42, 43, 48]
>>>>>>>start training : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.470212697982788
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3412303924560547
Epoch: 2, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3165488243103027
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.319375991821289
Epoch: 4, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2755095958709717
Epoch: 5, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2393345832824707
Epoch: 6, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 1.228379249572754
Epoch: 7, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 8 cost time: 1.1652896404266357
Epoch: 8, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 9 cost time: 1.0913314819335938
Epoch: 9, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 10 cost time: 1.262282371520996
Epoch: 10, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 11 cost time: 1.4119288921356201
Epoch: 11, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 12 cost time: 1.171459436416626
Epoch: 12, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 13 cost time: 1.207646131515503
Epoch: 13, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 14 cost time: 1.2279880046844482
Epoch: 14, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 15 cost time: 1.2275362014770508
Epoch: 15, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 16 cost time: 1.2505137920379639
Epoch: 16, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 17 cost time: 1.3012681007385254
Epoch: 17, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1880064010620117
Epoch: 18, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2439625263214111
Epoch: 19, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3173842430114746
Epoch: 20, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 21 cost time: 1.4354090690612793
Epoch: 21, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 22 cost time: 1.3790931701660156
Epoch: 22, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 23 cost time: 1.343245506286621
Epoch: 23, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 24 cost time: 1.2327687740325928
Epoch: 24, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.253722906112671
Epoch: 25, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4157836437225342
Epoch: 26, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.383486032485962
Epoch: 27, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3666434288024902
Epoch: 28, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.109910488128662
Epoch: 29, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1429572105407715
Epoch: 30, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1381139755249023
Epoch: 31, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1388702392578125
Epoch: 32, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1954166889190674
Epoch: 33, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 34 cost time: 1.169992446899414
Epoch: 34, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 35 cost time: 1.2461614608764648
Epoch: 35, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 36 cost time: 1.2611749172210693
Epoch: 36, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 37 cost time: 1.249678373336792
Epoch: 37, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 38 cost time: 1.2114408016204834
Epoch: 38, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 39 cost time: 1.1767258644104004
Epoch: 39, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 40 cost time: 1.1813278198242188
Epoch: 40, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 41 cost time: 1.3241522312164307
Epoch: 41, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 42 cost time: 1.0965445041656494
Epoch: 42, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 43 cost time: 1.2892813682556152
Epoch: 43, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2253048419952393
Epoch: 44, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1927134990692139
Epoch: 45, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2021849155426025
Epoch: 46, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.303602933883667
Epoch: 47, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.235511302947998
Epoch: 48, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3924400806427002
Epoch: 49, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2426655292510986
Epoch: 50, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 51 cost time: 1.194106101989746
Epoch: 51, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 52 cost time: 1.1861698627471924
Epoch: 52, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 53 cost time: 1.1529011726379395
Epoch: 53, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 54 cost time: 1.2228758335113525
Epoch: 54, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 55 cost time: 1.2361953258514404
Epoch: 55, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 56 cost time: 1.251793622970581
Epoch: 56, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.5138788223266602
Epoch: 57, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 58 cost time: 1.4396753311157227
Epoch: 58, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 59 cost time: 1.4307563304901123
Epoch: 59, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 60 cost time: 1.3804547786712646
Epoch: 60, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 61 cost time: 1.3325653076171875
Epoch: 61, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 62 cost time: 1.5500032901763916
Epoch: 62, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 63 cost time: 1.4191057682037354
Epoch: 63, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 64 cost time: 1.3811910152435303
Epoch: 64, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3450093269348145
Epoch: 65, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.406186580657959
Epoch: 66, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.5007028579711914
Epoch: 67, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.403371810913086
Epoch: 68, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.3303823471069336
Epoch: 69, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.5743401050567627
Epoch: 70, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.3321831226348877
Epoch: 71, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.3924365043640137
Epoch: 72, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 73 cost time: 1.347738265991211
Epoch: 73, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 74 cost time: 1.3376622200012207
Epoch: 74, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 75 cost time: 1.330608606338501
Epoch: 75, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 76 cost time: 1.3510174751281738
Epoch: 76, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 77 cost time: 1.363539695739746
Epoch: 77, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 78 cost time: 1.3070659637451172
Epoch: 78, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 79 cost time: 1.3754158020019531
Epoch: 79, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.3138031959533691
Epoch: 80, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.208967685699463
Epoch: 81, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.2738206386566162
Epoch: 82, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.291616439819336
Epoch: 83, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.1969025135040283
Epoch: 84, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.221266269683838
Epoch: 85, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.205777645111084
Epoch: 86, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.2217011451721191
Epoch: 87, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.2800002098083496
Epoch: 88, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_FEDformer_UEA_ftM_sl100_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.25
model parameter : 76900
model size : 1.54MB
