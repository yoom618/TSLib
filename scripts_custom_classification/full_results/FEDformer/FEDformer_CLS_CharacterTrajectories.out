Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.376099586486816
Epoch: 1, Steps: 89 | Train Loss: 1.029 Vali Loss: 0.946 Vali Acc: 0.808 Test Loss: 0.946 Test Acc: 0.808
Validation loss decreased (inf --> -0.807790).  Saving model ...
Epoch: 2 cost time: 22.608392477035522
Epoch: 2, Steps: 89 | Train Loss: 0.653 Vali Loss: 1.183 Vali Acc: 0.831 Test Loss: 1.183 Test Acc: 0.831
Validation loss decreased (-0.807790 --> -0.830768).  Saving model ...
Epoch: 3 cost time: 25.05329966545105
Epoch: 3, Steps: 89 | Train Loss: 0.694 Vali Loss: 0.962 Vali Acc: 0.866 Test Loss: 0.962 Test Acc: 0.866
Validation loss decreased (-0.830768 --> -0.865589).  Saving model ...
Epoch: 4 cost time: 21.47849726676941
Epoch: 4, Steps: 89 | Train Loss: 0.734 Vali Loss: 1.405 Vali Acc: 0.849 Test Loss: 1.405 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.250584840774536
Epoch: 5, Steps: 89 | Train Loss: 0.797 Vali Loss: 1.683 Vali Acc: 0.864 Test Loss: 1.683 Test Acc: 0.864
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.84449291229248
Epoch: 6, Steps: 89 | Train Loss: 0.605 Vali Loss: 0.991 Vali Acc: 0.904 Test Loss: 0.991 Test Acc: 0.904
Validation loss decreased (-0.865589 --> -0.903890).  Saving model ...
Epoch: 7 cost time: 21.792030096054077
Epoch: 7, Steps: 89 | Train Loss: 0.649 Vali Loss: 1.453 Vali Acc: 0.845 Test Loss: 1.453 Test Acc: 0.845
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.112863063812256
Epoch: 8, Steps: 89 | Train Loss: 0.848 Vali Loss: 1.677 Vali Acc: 0.852 Test Loss: 1.677 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.622653245925903
Epoch: 9, Steps: 89 | Train Loss: 0.594 Vali Loss: 1.038 Vali Acc: 0.910 Test Loss: 1.038 Test Acc: 0.910
Validation loss decreased (-0.903890 --> -0.910157).  Saving model ...
Epoch: 10 cost time: 21.86744213104248
Epoch: 10, Steps: 89 | Train Loss: 0.592 Vali Loss: 0.953 Vali Acc: 0.923 Test Loss: 0.953 Test Acc: 0.923
Validation loss decreased (-0.910157 --> -0.922692).  Saving model ...
Epoch: 11 cost time: 22.71277928352356
Epoch: 11, Steps: 89 | Train Loss: 0.445 Vali Loss: 1.526 Vali Acc: 0.879 Test Loss: 1.526 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.513269186019897
Epoch: 12, Steps: 89 | Train Loss: 0.383 Vali Loss: 1.632 Vali Acc: 0.885 Test Loss: 1.632 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.093070030212402
Epoch: 13, Steps: 89 | Train Loss: 0.681 Vali Loss: 1.668 Vali Acc: 0.875 Test Loss: 1.668 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 22.60286259651184
Epoch: 14, Steps: 89 | Train Loss: 0.447 Vali Loss: 1.159 Vali Acc: 0.921 Test Loss: 1.159 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 20.722622394561768
Epoch: 15, Steps: 89 | Train Loss: 0.437 Vali Loss: 1.346 Vali Acc: 0.905 Test Loss: 1.346 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 21.36412024497986
Epoch: 16, Steps: 89 | Train Loss: 0.487 Vali Loss: 1.172 Vali Acc: 0.909 Test Loss: 1.172 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 21.459352016448975
Epoch: 17, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.970 Vali Acc: 0.930 Test Loss: 0.970 Test Acc: 0.930
Validation loss decreased (-0.922692 --> -0.929656).  Saving model ...
Epoch: 18 cost time: 21.258437156677246
Epoch: 18, Steps: 89 | Train Loss: 0.419 Vali Loss: 1.058 Vali Acc: 0.920 Test Loss: 1.058 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 21.753026962280273
Epoch: 19, Steps: 89 | Train Loss: 0.388 Vali Loss: 1.356 Vali Acc: 0.919 Test Loss: 1.356 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.39270257949829
Epoch: 20, Steps: 89 | Train Loss: 0.371 Vali Loss: 1.158 Vali Acc: 0.928 Test Loss: 1.158 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 21.925036907196045
Epoch: 21, Steps: 89 | Train Loss: 0.432 Vali Loss: 1.246 Vali Acc: 0.925 Test Loss: 1.246 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 22.049769163131714
Epoch: 22, Steps: 89 | Train Loss: 0.531 Vali Loss: 1.405 Vali Acc: 0.896 Test Loss: 1.405 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 22.422348260879517
Epoch: 23, Steps: 89 | Train Loss: 0.305 Vali Loss: 1.309 Vali Acc: 0.930 Test Loss: 1.309 Test Acc: 0.930
Validation loss decreased (-0.929656 --> -0.930349).  Saving model ...
Epoch: 24 cost time: 22.09464716911316
Epoch: 24, Steps: 89 | Train Loss: 0.614 Vali Loss: 2.053 Vali Acc: 0.884 Test Loss: 2.053 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 21.85142946243286
Epoch: 25, Steps: 89 | Train Loss: 0.303 Vali Loss: 1.042 Vali Acc: 0.942 Test Loss: 1.042 Test Acc: 0.942
Validation loss decreased (-0.930349 --> -0.941494).  Saving model ...
Epoch: 26 cost time: 22.83329963684082
Epoch: 26, Steps: 89 | Train Loss: 0.394 Vali Loss: 1.369 Vali Acc: 0.911 Test Loss: 1.369 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 21.599869966506958
Epoch: 27, Steps: 89 | Train Loss: 0.364 Vali Loss: 1.155 Vali Acc: 0.930 Test Loss: 1.155 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 21.502618074417114
Epoch: 28, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.905 Vali Acc: 0.946 Test Loss: 0.905 Test Acc: 0.946
Validation loss decreased (-0.941494 --> -0.945673).  Saving model ...
Epoch: 29 cost time: 21.488672733306885
Epoch: 29, Steps: 89 | Train Loss: 0.257 Vali Loss: 1.455 Vali Acc: 0.914 Test Loss: 1.455 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 21.97419285774231
Epoch: 30, Steps: 89 | Train Loss: 0.306 Vali Loss: 1.875 Vali Acc: 0.892 Test Loss: 1.875 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 21.14402198791504
Epoch: 31, Steps: 89 | Train Loss: 0.453 Vali Loss: 1.253 Vali Acc: 0.928 Test Loss: 1.253 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 21.74897336959839
Epoch: 32, Steps: 89 | Train Loss: 0.397 Vali Loss: 1.356 Vali Acc: 0.930 Test Loss: 1.356 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 21.067122220993042
Epoch: 33, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.857 Vali Acc: 0.958 Test Loss: 0.857 Test Acc: 0.958
Validation loss decreased (-0.945673 --> -0.957512).  Saving model ...
Epoch: 34 cost time: 21.626880884170532
Epoch: 34, Steps: 89 | Train Loss: 0.297 Vali Loss: 1.022 Vali Acc: 0.945 Test Loss: 1.022 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 21.429436922073364
Epoch: 35, Steps: 89 | Train Loss: 0.236 Vali Loss: 1.387 Vali Acc: 0.923 Test Loss: 1.387 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 22.173492193222046
Epoch: 36, Steps: 89 | Train Loss: 0.330 Vali Loss: 1.451 Vali Acc: 0.932 Test Loss: 1.451 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 22.432536125183105
Epoch: 37, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.984 Vali Acc: 0.941 Test Loss: 0.984 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 22.954431533813477
Epoch: 38, Steps: 89 | Train Loss: 0.314 Vali Loss: 1.300 Vali Acc: 0.933 Test Loss: 1.300 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 22.3670871257782
Epoch: 39, Steps: 89 | Train Loss: 0.251 Vali Loss: 1.153 Vali Acc: 0.952 Test Loss: 1.153 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 23.93007755279541
Epoch: 40, Steps: 89 | Train Loss: 0.199 Vali Loss: 1.172 Vali Acc: 0.939 Test Loss: 1.172 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 21.783701419830322
Epoch: 41, Steps: 89 | Train Loss: 0.251 Vali Loss: 1.494 Vali Acc: 0.930 Test Loss: 1.494 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 22.325513124465942
Epoch: 42, Steps: 89 | Train Loss: 0.287 Vali Loss: 1.263 Vali Acc: 0.932 Test Loss: 1.263 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 22.357561826705933
Epoch: 43, Steps: 89 | Train Loss: 0.242 Vali Loss: 1.418 Vali Acc: 0.939 Test Loss: 1.418 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.832497358322144
Epoch: 1, Steps: 89 | Train Loss: 1.102 Vali Loss: 1.233 Vali Acc: 0.776 Test Loss: 1.233 Test Acc: 0.776
Validation loss decreased (inf --> -0.775754).  Saving model ...
Epoch: 2 cost time: 23.763833045959473
Epoch: 2, Steps: 89 | Train Loss: 0.938 Vali Loss: 1.731 Vali Acc: 0.774 Test Loss: 1.731 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.08765196800232
Epoch: 3, Steps: 89 | Train Loss: 0.746 Vali Loss: 1.898 Vali Acc: 0.824 Test Loss: 1.898 Test Acc: 0.824
Validation loss decreased (-0.775754 --> -0.823797).  Saving model ...
Epoch: 4 cost time: 21.847042560577393
Epoch: 4, Steps: 89 | Train Loss: 0.780 Vali Loss: 0.752 Vali Acc: 0.882 Test Loss: 0.752 Test Acc: 0.882
Validation loss decreased (-0.823797 --> -0.881608).  Saving model ...
Epoch: 5 cost time: 22.426713466644287
Epoch: 5, Steps: 89 | Train Loss: 0.648 Vali Loss: 1.237 Vali Acc: 0.859 Test Loss: 1.237 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.774064302444458
Epoch: 6, Steps: 89 | Train Loss: 0.692 Vali Loss: 0.696 Vali Acc: 0.907 Test Loss: 0.696 Test Acc: 0.907
Validation loss decreased (-0.881608 --> -0.906678).  Saving model ...
Epoch: 7 cost time: 24.077000379562378
Epoch: 7, Steps: 89 | Train Loss: 0.708 Vali Loss: 1.485 Vali Acc: 0.841 Test Loss: 1.485 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.991697311401367
Epoch: 8, Steps: 89 | Train Loss: 0.619 Vali Loss: 1.213 Vali Acc: 0.861 Test Loss: 1.213 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.341712713241577
Epoch: 9, Steps: 89 | Train Loss: 0.543 Vali Loss: 1.157 Vali Acc: 0.877 Test Loss: 1.157 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.371773719787598
Epoch: 10, Steps: 89 | Train Loss: 0.426 Vali Loss: 1.253 Vali Acc: 0.882 Test Loss: 1.253 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.78572106361389
Epoch: 11, Steps: 89 | Train Loss: 0.542 Vali Loss: 1.269 Vali Acc: 0.885 Test Loss: 1.269 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 22.38440728187561
Epoch: 12, Steps: 89 | Train Loss: 0.422 Vali Loss: 1.170 Vali Acc: 0.907 Test Loss: 1.170 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.913453340530396
Epoch: 13, Steps: 89 | Train Loss: 0.567 Vali Loss: 1.252 Vali Acc: 0.912 Test Loss: 1.252 Test Acc: 0.912
Validation loss decreased (-0.906678 --> -0.911547).  Saving model ...
Epoch: 14 cost time: 22.540858030319214
Epoch: 14, Steps: 89 | Train Loss: 0.376 Vali Loss: 0.881 Vali Acc: 0.921 Test Loss: 0.881 Test Acc: 0.921
Validation loss decreased (-0.911547 --> -0.921300).  Saving model ...
Epoch: 15 cost time: 22.315967798233032
Epoch: 15, Steps: 89 | Train Loss: 0.485 Vali Loss: 1.558 Vali Acc: 0.867 Test Loss: 1.558 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.16522526741028
Epoch: 16, Steps: 89 | Train Loss: 0.470 Vali Loss: 1.293 Vali Acc: 0.895 Test Loss: 1.293 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 24.990224361419678
Epoch: 17, Steps: 89 | Train Loss: 0.550 Vali Loss: 0.629 Vali Acc: 0.938 Test Loss: 0.629 Test Acc: 0.938
Validation loss decreased (-0.921300 --> -0.938016).  Saving model ...
Epoch: 18 cost time: 23.02728009223938
Epoch: 18, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.936 Vali Acc: 0.912 Test Loss: 0.936 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.708847045898438
Epoch: 19, Steps: 89 | Train Loss: 0.258 Vali Loss: 1.243 Vali Acc: 0.900 Test Loss: 1.243 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 23.46249008178711
Epoch: 20, Steps: 89 | Train Loss: 0.311 Vali Loss: 1.100 Vali Acc: 0.901 Test Loss: 1.100 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.97138524055481
Epoch: 21, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.801 Vali Acc: 0.930 Test Loss: 0.801 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 23.00624132156372
Epoch: 22, Steps: 89 | Train Loss: 0.361 Vali Loss: 1.032 Vali Acc: 0.913 Test Loss: 1.032 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 24.353912115097046
Epoch: 23, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.701 Vali Acc: 0.922 Test Loss: 0.701 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 22.838372230529785
Epoch: 24, Steps: 89 | Train Loss: 0.522 Vali Loss: 0.780 Vali Acc: 0.925 Test Loss: 0.780 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 23.729758501052856
Epoch: 25, Steps: 89 | Train Loss: 0.352 Vali Loss: 1.324 Vali Acc: 0.900 Test Loss: 1.324 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 23.59728741645813
Epoch: 26, Steps: 89 | Train Loss: 0.446 Vali Loss: 1.406 Vali Acc: 0.884 Test Loss: 1.406 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 23.375092029571533
Epoch: 27, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.706 Vali Acc: 0.948 Test Loss: 0.706 Test Acc: 0.948
Validation loss decreased (-0.938016 --> -0.948461).  Saving model ...
Epoch: 28 cost time: 22.87010383605957
Epoch: 28, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.188 Vali Acc: 0.903 Test Loss: 1.188 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 23.70786762237549
Epoch: 29, Steps: 89 | Train Loss: 0.337 Vali Loss: 1.522 Vali Acc: 0.900 Test Loss: 1.522 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 24.033732891082764
Epoch: 30, Steps: 89 | Train Loss: 0.396 Vali Loss: 1.573 Vali Acc: 0.874 Test Loss: 1.573 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 23.718289852142334
Epoch: 31, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.957 Vali Acc: 0.925 Test Loss: 0.957 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 26.073407411575317
Epoch: 32, Steps: 89 | Train Loss: 0.478 Vali Loss: 0.598 Vali Acc: 0.937 Test Loss: 0.598 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 24.34544825553894
Epoch: 33, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.682 Vali Acc: 0.939 Test Loss: 0.682 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 23.317732334136963
Epoch: 34, Steps: 89 | Train Loss: 0.302 Vali Loss: 1.040 Vali Acc: 0.918 Test Loss: 1.040 Test Acc: 0.918
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 22.979074716567993
Epoch: 35, Steps: 89 | Train Loss: 0.394 Vali Loss: 1.279 Vali Acc: 0.903 Test Loss: 1.279 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 22.498011589050293
Epoch: 36, Steps: 89 | Train Loss: 0.277 Vali Loss: 1.275 Vali Acc: 0.895 Test Loss: 1.275 Test Acc: 0.895
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 21.660050868988037
Epoch: 37, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.905 Vali Acc: 0.918 Test Loss: 0.905 Test Acc: 0.918
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9484679665738162
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.89687466621399
Epoch: 1, Steps: 89 | Train Loss: 1.161 Vali Loss: 0.871 Vali Acc: 0.815 Test Loss: 0.871 Test Acc: 0.815
Validation loss decreased (inf --> -0.815451).  Saving model ...
Epoch: 2 cost time: 21.594571113586426
Epoch: 2, Steps: 89 | Train Loss: 0.821 Vali Loss: 1.067 Vali Acc: 0.834 Test Loss: 1.067 Test Acc: 0.834
Validation loss decreased (-0.815451 --> -0.833555).  Saving model ...
Epoch: 3 cost time: 21.507472276687622
Epoch: 3, Steps: 89 | Train Loss: 0.626 Vali Loss: 1.449 Vali Acc: 0.804 Test Loss: 1.449 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.883338451385498
Epoch: 4, Steps: 89 | Train Loss: 0.802 Vali Loss: 1.571 Vali Acc: 0.839 Test Loss: 1.571 Test Acc: 0.839
Validation loss decreased (-0.833555 --> -0.839121).  Saving model ...
Epoch: 5 cost time: 21.733808279037476
Epoch: 5, Steps: 89 | Train Loss: 0.792 Vali Loss: 1.384 Vali Acc: 0.866 Test Loss: 1.384 Test Acc: 0.866
Validation loss decreased (-0.839121 --> -0.865585).  Saving model ...
Epoch: 6 cost time: 20.83480739593506
Epoch: 6, Steps: 89 | Train Loss: 0.658 Vali Loss: 0.742 Vali Acc: 0.896 Test Loss: 0.742 Test Acc: 0.896
Validation loss decreased (-0.865585 --> -0.896232).  Saving model ...
Epoch: 7 cost time: 22.094695806503296
Epoch: 7, Steps: 89 | Train Loss: 0.619 Vali Loss: 1.568 Vali Acc: 0.864 Test Loss: 1.568 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.07957410812378
Epoch: 8, Steps: 89 | Train Loss: 0.779 Vali Loss: 1.270 Vali Acc: 0.875 Test Loss: 1.270 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.627124786376953
Epoch: 9, Steps: 89 | Train Loss: 0.787 Vali Loss: 1.526 Vali Acc: 0.884 Test Loss: 1.526 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.267826557159424
Epoch: 10, Steps: 89 | Train Loss: 0.448 Vali Loss: 1.257 Vali Acc: 0.893 Test Loss: 1.257 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.462143421173096
Epoch: 11, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.895 Vali Acc: 0.937 Test Loss: 0.895 Test Acc: 0.937
Validation loss decreased (-0.896232 --> -0.936621).  Saving model ...
Epoch: 12 cost time: 22.688410997390747
Epoch: 12, Steps: 89 | Train Loss: 0.403 Vali Loss: 1.248 Vali Acc: 0.884 Test Loss: 1.248 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.218079566955566
Epoch: 13, Steps: 89 | Train Loss: 0.376 Vali Loss: 1.792 Vali Acc: 0.879 Test Loss: 1.792 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.221905946731567
Epoch: 14, Steps: 89 | Train Loss: 0.655 Vali Loss: 0.941 Vali Acc: 0.908 Test Loss: 0.941 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 22.12777876853943
Epoch: 15, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.772 Vali Acc: 0.928 Test Loss: 0.772 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.51820158958435
Epoch: 16, Steps: 89 | Train Loss: 0.340 Vali Loss: 1.107 Vali Acc: 0.907 Test Loss: 1.107 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 22.71987771987915
Epoch: 17, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.680 Vali Acc: 0.927 Test Loss: 0.680 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 22.20521378517151
Epoch: 18, Steps: 89 | Train Loss: 0.600 Vali Loss: 0.838 Vali Acc: 0.921 Test Loss: 0.838 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 21.2412052154541
Epoch: 19, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.681 Vali Acc: 0.935 Test Loss: 0.681 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 21.46407437324524
Epoch: 20, Steps: 89 | Train Loss: 0.465 Vali Loss: 0.791 Vali Acc: 0.916 Test Loss: 0.791 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 22.321444034576416
Epoch: 21, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.743 Vali Acc: 0.920 Test Loss: 0.743 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9366295264623955
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.95107936859131
Epoch: 1, Steps: 89 | Train Loss: 1.284 Vali Loss: 0.867 Vali Acc: 0.816 Test Loss: 0.867 Test Acc: 0.816
Validation loss decreased (inf --> -0.816147).  Saving model ...
Epoch: 2 cost time: 24.825802326202393
Epoch: 2, Steps: 89 | Train Loss: 0.716 Vali Loss: 1.063 Vali Acc: 0.817 Test Loss: 1.063 Test Acc: 0.817
Validation loss decreased (-0.816147 --> -0.816842).  Saving model ...
Epoch: 3 cost time: 24.13482093811035
Epoch: 3, Steps: 89 | Train Loss: 0.503 Vali Loss: 0.710 Vali Acc: 0.875 Test Loss: 0.710 Test Acc: 0.875
Validation loss decreased (-0.816842 --> -0.874645).  Saving model ...
Epoch: 4 cost time: 22.658605098724365
Epoch: 4, Steps: 89 | Train Loss: 0.703 Vali Loss: 1.195 Vali Acc: 0.821 Test Loss: 1.195 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.8160343170166
Epoch: 5, Steps: 89 | Train Loss: 0.754 Vali Loss: 0.828 Vali Acc: 0.902 Test Loss: 0.828 Test Acc: 0.902
Validation loss decreased (-0.874645 --> -0.901802).  Saving model ...
Epoch: 6 cost time: 22.755406379699707
Epoch: 6, Steps: 89 | Train Loss: 0.722 Vali Loss: 1.363 Vali Acc: 0.870 Test Loss: 1.363 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.593592882156372
Epoch: 7, Steps: 89 | Train Loss: 0.882 Vali Loss: 1.099 Vali Acc: 0.887 Test Loss: 1.099 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.840663194656372
Epoch: 8, Steps: 89 | Train Loss: 0.830 Vali Loss: 0.932 Vali Acc: 0.896 Test Loss: 0.932 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.967968702316284
Epoch: 9, Steps: 89 | Train Loss: 0.633 Vali Loss: 1.558 Vali Acc: 0.863 Test Loss: 1.558 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 22.3740656375885
Epoch: 10, Steps: 89 | Train Loss: 0.839 Vali Loss: 1.667 Vali Acc: 0.875 Test Loss: 1.667 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.875471591949463
Epoch: 11, Steps: 89 | Train Loss: 0.646 Vali Loss: 1.480 Vali Acc: 0.874 Test Loss: 1.480 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 22.212767601013184
Epoch: 12, Steps: 89 | Train Loss: 0.640 Vali Loss: 1.108 Vali Acc: 0.891 Test Loss: 1.108 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.190563678741455
Epoch: 13, Steps: 89 | Train Loss: 0.526 Vali Loss: 1.307 Vali Acc: 0.881 Test Loss: 1.307 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 23.25172257423401
Epoch: 14, Steps: 89 | Train Loss: 0.722 Vali Loss: 0.601 Vali Acc: 0.927 Test Loss: 0.601 Test Acc: 0.927
Validation loss decreased (-0.901802 --> -0.926874).  Saving model ...
Epoch: 15 cost time: 23.838698625564575
Epoch: 15, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.746 Vali Acc: 0.937 Test Loss: 0.746 Test Acc: 0.937
Validation loss decreased (-0.926874 --> -0.937318).  Saving model ...
Epoch: 16 cost time: 23.71928572654724
Epoch: 16, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.847 Vali Acc: 0.932 Test Loss: 0.847 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.773529291152954
Epoch: 17, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.662 Vali Acc: 0.935 Test Loss: 0.662 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.51201367378235
Epoch: 18, Steps: 89 | Train Loss: 0.500 Vali Loss: 1.247 Vali Acc: 0.905 Test Loss: 1.247 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.246512413024902
Epoch: 19, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.760 Vali Acc: 0.936 Test Loss: 0.760 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 23.65554976463318
Epoch: 20, Steps: 89 | Train Loss: 0.373 Vali Loss: 1.353 Vali Acc: 0.902 Test Loss: 1.353 Test Acc: 0.902
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 23.594008207321167
Epoch: 21, Steps: 89 | Train Loss: 0.385 Vali Loss: 0.682 Vali Acc: 0.942 Test Loss: 0.682 Test Acc: 0.942
Validation loss decreased (-0.937318 --> -0.942194).  Saving model ...
Epoch: 22 cost time: 23.671496868133545
Epoch: 22, Steps: 89 | Train Loss: 0.535 Vali Loss: 1.046 Vali Acc: 0.899 Test Loss: 1.046 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 22.49992799758911
Epoch: 23, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.913 Vali Acc: 0.917 Test Loss: 0.913 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 23.920389413833618
Epoch: 24, Steps: 89 | Train Loss: 0.430 Vali Loss: 0.730 Vali Acc: 0.932 Test Loss: 0.730 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 22.71363592147827
Epoch: 25, Steps: 89 | Train Loss: 0.305 Vali Loss: 2.098 Vali Acc: 0.878 Test Loss: 2.098 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 23.424774169921875
Epoch: 26, Steps: 89 | Train Loss: 0.292 Vali Loss: 1.010 Vali Acc: 0.912 Test Loss: 1.010 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 23.65834617614746
Epoch: 27, Steps: 89 | Train Loss: 0.519 Vali Loss: 0.885 Vali Acc: 0.907 Test Loss: 0.885 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 22.867070198059082
Epoch: 28, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.943 Vali Acc: 0.900 Test Loss: 0.943 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 24.03226900100708
Epoch: 29, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.509 Vali Acc: 0.946 Test Loss: 0.509 Test Acc: 0.946
Validation loss decreased (-0.942194 --> -0.945677).  Saving model ...
Epoch: 30 cost time: 23.55467987060547
Epoch: 30, Steps: 89 | Train Loss: 0.191 Vali Loss: 1.143 Vali Acc: 0.912 Test Loss: 1.143 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 23.520212411880493
Epoch: 31, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.574 Vali Acc: 0.939 Test Loss: 0.574 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 24.787312507629395
Epoch: 32, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.363 Vali Acc: 0.959 Test Loss: 0.363 Test Acc: 0.959
Validation loss decreased (-0.945677 --> -0.958910).  Saving model ...
Epoch: 33 cost time: 22.918959617614746
Epoch: 33, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.533 Vali Acc: 0.947 Test Loss: 0.533 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 24.487988233566284
Epoch: 34, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.576 Vali Acc: 0.948 Test Loss: 0.576 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 23.883293628692627
Epoch: 35, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.535 Vali Acc: 0.946 Test Loss: 0.535 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.865041732788086
Epoch: 36, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.615 Vali Acc: 0.951 Test Loss: 0.615 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 22.20928192138672
Epoch: 37, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.572 Vali Acc: 0.952 Test Loss: 0.572 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 22.682925701141357
Epoch: 38, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.507 Vali Acc: 0.953 Test Loss: 0.507 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 22.305520057678223
Epoch: 39, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.290 Vali Acc: 0.964 Test Loss: 0.290 Test Acc: 0.964
Validation loss decreased (-0.958910 --> -0.963785).  Saving model ...
Epoch: 40 cost time: 23.413707733154297
Epoch: 40, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.340 Vali Acc: 0.965 Test Loss: 0.340 Test Acc: 0.965
Validation loss decreased (-0.963785 --> -0.965178).  Saving model ...
Epoch: 41 cost time: 23.08754849433899
Epoch: 41, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.313 Vali Acc: 0.964 Test Loss: 0.313 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 23.90512752532959
Epoch: 42, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.297 Vali Acc: 0.971 Test Loss: 0.297 Test Acc: 0.971
Validation loss decreased (-0.965178 --> -0.971446).  Saving model ...
Epoch: 43 cost time: 22.767913103103638
Epoch: 43, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.446 Vali Acc: 0.953 Test Loss: 0.446 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 22.89168357849121
Epoch: 44, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.637 Vali Acc: 0.938 Test Loss: 0.637 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 23.079083681106567
Epoch: 45, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.448 Vali Acc: 0.949 Test Loss: 0.448 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 22.63091540336609
Epoch: 46, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.636 Vali Acc: 0.936 Test Loss: 0.636 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 22.79094123840332
Epoch: 47, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.526 Vali Acc: 0.949 Test Loss: 0.526 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 22.00794553756714
Epoch: 48, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.449 Vali Acc: 0.945 Test Loss: 0.449 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 22.173276901245117
Epoch: 49, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.422 Vali Acc: 0.962 Test Loss: 0.422 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 22.25731635093689
Epoch: 50, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.447 Vali Acc: 0.956 Test Loss: 0.447 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 22.43120050430298
Epoch: 51, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.327 Vali Acc: 0.965 Test Loss: 0.327 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 22.202950716018677
Epoch: 52, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.287 Vali Acc: 0.964 Test Loss: 0.287 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.055667877197266
Epoch: 1, Steps: 89 | Train Loss: 1.531 Vali Loss: 1.051 Vali Acc: 0.769 Test Loss: 1.051 Test Acc: 0.769
Validation loss decreased (inf --> -0.768792).  Saving model ...
Epoch: 2 cost time: 23.698447465896606
Epoch: 2, Steps: 89 | Train Loss: 0.584 Vali Loss: 1.059 Vali Acc: 0.839 Test Loss: 1.059 Test Acc: 0.839
Validation loss decreased (-0.768792 --> -0.839126).  Saving model ...
Epoch: 3 cost time: 23.704705715179443
Epoch: 3, Steps: 89 | Train Loss: 0.490 Vali Loss: 0.948 Vali Acc: 0.848 Test Loss: 0.948 Test Acc: 0.848
Validation loss decreased (-0.839126 --> -0.848180).  Saving model ...
Epoch: 4 cost time: 23.56891179084778
Epoch: 4, Steps: 89 | Train Loss: 0.554 Vali Loss: 2.246 Vali Acc: 0.809 Test Loss: 2.246 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.3458411693573
Epoch: 5, Steps: 89 | Train Loss: 0.892 Vali Loss: 2.087 Vali Acc: 0.841 Test Loss: 2.087 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.53552794456482
Epoch: 6, Steps: 89 | Train Loss: 0.883 Vali Loss: 2.293 Vali Acc: 0.811 Test Loss: 2.293 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.737438678741455
Epoch: 7, Steps: 89 | Train Loss: 0.828 Vali Loss: 1.383 Vali Acc: 0.883 Test Loss: 1.383 Test Acc: 0.883
Validation loss decreased (-0.848180 --> -0.882995).  Saving model ...
Epoch: 8 cost time: 24.625426292419434
Epoch: 8, Steps: 89 | Train Loss: 0.705 Vali Loss: 1.542 Vali Acc: 0.875 Test Loss: 1.542 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.853695392608643
Epoch: 9, Steps: 89 | Train Loss: 0.806 Vali Loss: 1.190 Vali Acc: 0.887 Test Loss: 1.190 Test Acc: 0.887
Validation loss decreased (-0.882995 --> -0.887175).  Saving model ...
Epoch: 10 cost time: 25.241196393966675
Epoch: 10, Steps: 89 | Train Loss: 0.801 Vali Loss: 2.310 Vali Acc: 0.837 Test Loss: 2.310 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.18884825706482
Epoch: 11, Steps: 89 | Train Loss: 0.886 Vali Loss: 1.286 Vali Acc: 0.906 Test Loss: 1.286 Test Acc: 0.906
Validation loss decreased (-0.887175 --> -0.905976).  Saving model ...
Epoch: 12 cost time: 23.82529377937317
Epoch: 12, Steps: 89 | Train Loss: 0.870 Vali Loss: 1.359 Vali Acc: 0.909 Test Loss: 1.359 Test Acc: 0.909
Validation loss decreased (-0.905976 --> -0.908761).  Saving model ...
Epoch: 13 cost time: 24.51083254814148
Epoch: 13, Steps: 89 | Train Loss: 0.536 Vali Loss: 1.215 Vali Acc: 0.923 Test Loss: 1.215 Test Acc: 0.923
Validation loss decreased (-0.908761 --> -0.923386).  Saving model ...
Epoch: 14 cost time: 23.9167263507843
Epoch: 14, Steps: 89 | Train Loss: 0.664 Vali Loss: 0.967 Vali Acc: 0.924 Test Loss: 0.967 Test Acc: 0.924
Validation loss decreased (-0.923386 --> -0.924085).  Saving model ...
Epoch: 15 cost time: 24.019660711288452
Epoch: 15, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.995 Vali Acc: 0.909 Test Loss: 0.995 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 24.063597917556763
Epoch: 16, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.794 Vali Acc: 0.932 Test Loss: 0.794 Test Acc: 0.932
Validation loss decreased (-0.924085 --> -0.932443).  Saving model ...
Epoch: 17 cost time: 22.952232599258423
Epoch: 17, Steps: 89 | Train Loss: 0.486 Vali Loss: 0.684 Vali Acc: 0.925 Test Loss: 0.684 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 25.57751178741455
Epoch: 18, Steps: 89 | Train Loss: 0.444 Vali Loss: 0.619 Vali Acc: 0.935 Test Loss: 0.619 Test Acc: 0.935
Validation loss decreased (-0.932443 --> -0.935231).  Saving model ...
Epoch: 19 cost time: 23.248294591903687
Epoch: 19, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.786 Vali Acc: 0.933 Test Loss: 0.786 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.10536241531372
Epoch: 20, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.548 Vali Acc: 0.946 Test Loss: 0.548 Test Acc: 0.946
Validation loss decreased (-0.935231 --> -0.945677).  Saving model ...
Epoch: 21 cost time: 24.529399156570435
Epoch: 21, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.671 Vali Acc: 0.937 Test Loss: 0.671 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 24.49461793899536
Epoch: 22, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.709 Vali Acc: 0.935 Test Loss: 0.709 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 23.688997507095337
Epoch: 23, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.715 Vali Acc: 0.923 Test Loss: 0.715 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 24.29375195503235
Epoch: 24, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.705 Vali Acc: 0.941 Test Loss: 0.705 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 25.22947406768799
Epoch: 25, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.554 Vali Acc: 0.942 Test Loss: 0.554 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 23.876105070114136
Epoch: 26, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.470 Vali Acc: 0.948 Test Loss: 0.470 Test Acc: 0.948
Validation loss decreased (-0.945677 --> -0.947767).  Saving model ...
Epoch: 27 cost time: 23.03984570503235
Epoch: 27, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.551 Vali Acc: 0.942 Test Loss: 0.551 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 23.930829286575317
Epoch: 28, Steps: 89 | Train Loss: 0.194 Vali Loss: 1.203 Vali Acc: 0.914 Test Loss: 1.203 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 22.71832585334778
Epoch: 29, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.699 Vali Acc: 0.948 Test Loss: 0.699 Test Acc: 0.948
Validation loss decreased (-0.947767 --> -0.948461).  Saving model ...
Epoch: 30 cost time: 22.322662353515625
Epoch: 30, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.440 Vali Acc: 0.957 Test Loss: 0.440 Test Acc: 0.957
Validation loss decreased (-0.948461 --> -0.956820).  Saving model ...
Epoch: 31 cost time: 22.684752464294434
Epoch: 31, Steps: 89 | Train Loss: 0.199 Vali Loss: 1.073 Vali Acc: 0.926 Test Loss: 1.073 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 23.193962335586548
Epoch: 32, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.371 Vali Acc: 0.962 Test Loss: 0.371 Test Acc: 0.962
Validation loss decreased (-0.956820 --> -0.961695).  Saving model ...
Epoch: 33 cost time: 22.269577741622925
Epoch: 33, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.507 Vali Acc: 0.948 Test Loss: 0.507 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 22.13449501991272
Epoch: 34, Steps: 89 | Train Loss: 0.224 Vali Loss: 1.155 Vali Acc: 0.928 Test Loss: 1.155 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 22.761350393295288
Epoch: 35, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.322 Vali Acc: 0.967 Test Loss: 0.322 Test Acc: 0.967
Validation loss decreased (-0.961695 --> -0.966571).  Saving model ...
Epoch: 36 cost time: 22.715489625930786
Epoch: 36, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.394 Vali Acc: 0.969 Test Loss: 0.394 Test Acc: 0.969
Validation loss decreased (-0.966571 --> -0.969355).  Saving model ...
Epoch: 37 cost time: 21.15121579170227
Epoch: 37, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.536 Vali Acc: 0.956 Test Loss: 0.536 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 22.032264947891235
Epoch: 38, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.394 Vali Acc: 0.964 Test Loss: 0.394 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 21.94712471961975
Epoch: 39, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.394 Vali Acc: 0.962 Test Loss: 0.394 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 21.185871362686157
Epoch: 40, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.347 Vali Acc: 0.959 Test Loss: 0.347 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 22.43274998664856
Epoch: 41, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.479 Vali Acc: 0.946 Test Loss: 0.479 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 22.18361186981201
Epoch: 42, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.254 Vali Acc: 0.969 Test Loss: 0.254 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 22.752835512161255
Epoch: 43, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.497 Vali Acc: 0.943 Test Loss: 0.497 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 21.4906325340271
Epoch: 44, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.355 Vali Acc: 0.954 Test Loss: 0.355 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 23.662558555603027
Epoch: 45, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.453 Vali Acc: 0.962 Test Loss: 0.453 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 23.04189944267273
Epoch: 46, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.508 Vali Acc: 0.958 Test Loss: 0.508 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.972073078155518
Epoch: 1, Steps: 89 | Train Loss: 1.491 Vali Loss: 1.029 Vali Acc: 0.737 Test Loss: 1.029 Test Acc: 0.737
Validation loss decreased (inf --> -0.737455).  Saving model ...
Epoch: 2 cost time: 22.123668909072876
Epoch: 2, Steps: 89 | Train Loss: 0.501 Vali Loss: 1.315 Vali Acc: 0.786 Test Loss: 1.315 Test Acc: 0.786
Validation loss decreased (-0.737455 --> -0.786199).  Saving model ...
Epoch: 3 cost time: 21.46855664253235
Epoch: 3, Steps: 89 | Train Loss: 0.443 Vali Loss: 1.492 Vali Acc: 0.798 Test Loss: 1.492 Test Acc: 0.798
Validation loss decreased (-0.786199 --> -0.798035).  Saving model ...
Epoch: 4 cost time: 22.836490631103516
Epoch: 4, Steps: 89 | Train Loss: 0.448 Vali Loss: 2.304 Vali Acc: 0.734 Test Loss: 2.304 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.759725332260132
Epoch: 5, Steps: 89 | Train Loss: 0.670 Vali Loss: 2.493 Vali Acc: 0.744 Test Loss: 2.493 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.773281812667847
Epoch: 6, Steps: 89 | Train Loss: 0.820 Vali Loss: 1.551 Vali Acc: 0.847 Test Loss: 1.551 Test Acc: 0.847
Validation loss decreased (-0.798035 --> -0.846781).  Saving model ...
Epoch: 7 cost time: 22.17487072944641
Epoch: 7, Steps: 89 | Train Loss: 0.770 Vali Loss: 1.573 Vali Acc: 0.848 Test Loss: 1.573 Test Acc: 0.848
Validation loss decreased (-0.846781 --> -0.848174).  Saving model ...
Epoch: 8 cost time: 22.492594242095947
Epoch: 8, Steps: 89 | Train Loss: 0.918 Vali Loss: 1.529 Vali Acc: 0.866 Test Loss: 1.529 Test Acc: 0.866
Validation loss decreased (-0.848174 --> -0.865584).  Saving model ...
Epoch: 9 cost time: 21.965003728866577
Epoch: 9, Steps: 89 | Train Loss: 0.857 Vali Loss: 1.303 Vali Acc: 0.890 Test Loss: 1.303 Test Acc: 0.890
Validation loss decreased (-0.865584 --> -0.889959).  Saving model ...
Epoch: 10 cost time: 21.969942092895508
Epoch: 10, Steps: 89 | Train Loss: 0.932 Vali Loss: 1.555 Vali Acc: 0.874 Test Loss: 1.555 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.85899305343628
Epoch: 11, Steps: 89 | Train Loss: 0.926 Vali Loss: 0.708 Vali Acc: 0.918 Test Loss: 0.708 Test Acc: 0.918
Validation loss decreased (-0.889959 --> -0.917820).  Saving model ...
Epoch: 12 cost time: 21.90613102912903
Epoch: 12, Steps: 89 | Train Loss: 0.673 Vali Loss: 0.577 Vali Acc: 0.945 Test Loss: 0.577 Test Acc: 0.945
Validation loss decreased (-0.917820 --> -0.944980).  Saving model ...
Epoch: 13 cost time: 22.23086977005005
Epoch: 13, Steps: 89 | Train Loss: 0.425 Vali Loss: 1.283 Vali Acc: 0.909 Test Loss: 1.283 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.91466999053955
Epoch: 14, Steps: 89 | Train Loss: 0.592 Vali Loss: 0.758 Vali Acc: 0.909 Test Loss: 0.758 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.584519624710083
Epoch: 15, Steps: 89 | Train Loss: 0.426 Vali Loss: 0.604 Vali Acc: 0.949 Test Loss: 0.604 Test Acc: 0.949
Validation loss decreased (-0.944980 --> -0.949158).  Saving model ...
Epoch: 16 cost time: 22.007087230682373
Epoch: 16, Steps: 89 | Train Loss: 0.318 Vali Loss: 1.143 Vali Acc: 0.910 Test Loss: 1.143 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.723319053649902
Epoch: 17, Steps: 89 | Train Loss: 0.680 Vali Loss: 1.026 Vali Acc: 0.905 Test Loss: 1.026 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.68771243095398
Epoch: 18, Steps: 89 | Train Loss: 0.401 Vali Loss: 0.658 Vali Acc: 0.941 Test Loss: 0.658 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.04678201675415
Epoch: 19, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.621 Vali Acc: 0.940 Test Loss: 0.621 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 23.202744007110596
Epoch: 20, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.768 Vali Acc: 0.936 Test Loss: 0.768 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 23.564563512802124
Epoch: 21, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.606 Vali Acc: 0.948 Test Loss: 0.606 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.66298747062683
Epoch: 22, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.589 Vali Acc: 0.955 Test Loss: 0.589 Test Acc: 0.955
Validation loss decreased (-0.949158 --> -0.954729).  Saving model ...
Epoch: 23 cost time: 22.236104488372803
Epoch: 23, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.520 Vali Acc: 0.951 Test Loss: 0.520 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.73097062110901
Epoch: 24, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.615 Vali Acc: 0.949 Test Loss: 0.615 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.418914556503296
Epoch: 25, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.655 Vali Acc: 0.939 Test Loss: 0.655 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.793867111206055
Epoch: 26, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.692 Vali Acc: 0.946 Test Loss: 0.692 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 22.72495675086975
Epoch: 27, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.743 Vali Acc: 0.928 Test Loss: 0.743 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 22.972219705581665
Epoch: 28, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.724 Vali Acc: 0.942 Test Loss: 0.724 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 22.462486743927002
Epoch: 29, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.766 Vali Acc: 0.938 Test Loss: 0.766 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 22.68773102760315
Epoch: 30, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.599 Vali Acc: 0.938 Test Loss: 0.599 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 21.908549308776855
Epoch: 31, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.657 Vali Acc: 0.932 Test Loss: 0.657 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 24.771842002868652
Epoch: 32, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.694 Vali Acc: 0.942 Test Loss: 0.694 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9547353760445683
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.501681804656982
Epoch: 1, Steps: 89 | Train Loss: 1.418 Vali Loss: 1.001 Vali Acc: 0.738 Test Loss: 1.001 Test Acc: 0.738
Validation loss decreased (inf --> -0.738152).  Saving model ...
Epoch: 2 cost time: 23.13811182975769
Epoch: 2, Steps: 89 | Train Loss: 0.395 Vali Loss: 1.180 Vali Acc: 0.776 Test Loss: 1.180 Test Acc: 0.776
Validation loss decreased (-0.738152 --> -0.776451).  Saving model ...
Epoch: 3 cost time: 24.066744804382324
Epoch: 3, Steps: 89 | Train Loss: 0.418 Vali Loss: 1.448 Vali Acc: 0.710 Test Loss: 1.448 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.070172548294067
Epoch: 4, Steps: 89 | Train Loss: 0.349 Vali Loss: 1.824 Vali Acc: 0.753 Test Loss: 1.824 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.167863130569458
Epoch: 5, Steps: 89 | Train Loss: 0.564 Vali Loss: 1.548 Vali Acc: 0.795 Test Loss: 1.548 Test Acc: 0.795
Validation loss decreased (-0.776451 --> -0.795249).  Saving model ...
Epoch: 6 cost time: 26.42866277694702
Epoch: 6, Steps: 89 | Train Loss: 0.660 Vali Loss: 1.411 Vali Acc: 0.798 Test Loss: 1.411 Test Acc: 0.798
Validation loss decreased (-0.795249 --> -0.798036).  Saving model ...
Epoch: 7 cost time: 24.303725719451904
Epoch: 7, Steps: 89 | Train Loss: 1.081 Vali Loss: 2.915 Vali Acc: 0.720 Test Loss: 2.915 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.580806493759155
Epoch: 8, Steps: 89 | Train Loss: 0.580 Vali Loss: 1.662 Vali Acc: 0.835 Test Loss: 1.662 Test Acc: 0.835
Validation loss decreased (-0.798036 --> -0.834942).  Saving model ...
Epoch: 9 cost time: 25.296531677246094
Epoch: 9, Steps: 89 | Train Loss: 1.091 Vali Loss: 3.706 Vali Acc: 0.718 Test Loss: 3.706 Test Acc: 0.718
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.202974796295166
Epoch: 10, Steps: 89 | Train Loss: 1.504 Vali Loss: 2.623 Vali Acc: 0.816 Test Loss: 2.623 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.179739713668823
Epoch: 11, Steps: 89 | Train Loss: 1.148 Vali Loss: 1.113 Vali Acc: 0.909 Test Loss: 1.113 Test Acc: 0.909
Validation loss decreased (-0.834942 --> -0.909460).  Saving model ...
Epoch: 12 cost time: 24.66351056098938
Epoch: 12, Steps: 89 | Train Loss: 0.927 Vali Loss: 0.918 Vali Acc: 0.923 Test Loss: 0.918 Test Acc: 0.923
Validation loss decreased (-0.909460 --> -0.923389).  Saving model ...
Epoch: 13 cost time: 23.152037143707275
Epoch: 13, Steps: 89 | Train Loss: 0.719 Vali Loss: 0.937 Vali Acc: 0.926 Test Loss: 0.937 Test Acc: 0.926
Validation loss decreased (-0.923389 --> -0.926174).  Saving model ...
Epoch: 14 cost time: 23.712735891342163
Epoch: 14, Steps: 89 | Train Loss: 0.678 Vali Loss: 0.740 Vali Acc: 0.930 Test Loss: 0.740 Test Acc: 0.930
Validation loss decreased (-0.926174 --> -0.930355).  Saving model ...
Epoch: 15 cost time: 22.543514490127563
Epoch: 15, Steps: 89 | Train Loss: 0.355 Vali Loss: 1.033 Vali Acc: 0.914 Test Loss: 1.033 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 23.676215171813965
Epoch: 16, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.976 Vali Acc: 0.934 Test Loss: 0.976 Test Acc: 0.934
Validation loss decreased (-0.930355 --> -0.933834).  Saving model ...
Epoch: 17 cost time: 23.16875171661377
Epoch: 17, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.948 Vali Acc: 0.921 Test Loss: 0.948 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.92953109741211
Epoch: 18, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.646 Vali Acc: 0.935 Test Loss: 0.646 Test Acc: 0.935
Validation loss decreased (-0.933834 --> -0.935230).  Saving model ...
Epoch: 19 cost time: 24.20092010498047
Epoch: 19, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.618 Vali Acc: 0.947 Test Loss: 0.618 Test Acc: 0.947
Validation loss decreased (-0.935230 --> -0.947069).  Saving model ...
Epoch: 20 cost time: 22.137712478637695
Epoch: 20, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.694 Vali Acc: 0.955 Test Loss: 0.694 Test Acc: 0.955
Validation loss decreased (-0.947069 --> -0.955425).  Saving model ...
Epoch: 21 cost time: 23.412116527557373
Epoch: 21, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.553 Vali Acc: 0.952 Test Loss: 0.553 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 24.523080825805664
Epoch: 22, Steps: 89 | Train Loss: 0.393 Vali Loss: 0.725 Vali Acc: 0.928 Test Loss: 0.725 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 24.819480419158936
Epoch: 23, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.862 Vali Acc: 0.930 Test Loss: 0.862 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 23.691977500915527
Epoch: 24, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.959 Vali Acc: 0.922 Test Loss: 0.959 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 24.69208288192749
Epoch: 25, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.644 Vali Acc: 0.947 Test Loss: 0.644 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 24.02782154083252
Epoch: 26, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.715 Vali Acc: 0.937 Test Loss: 0.715 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 23.714396715164185
Epoch: 27, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.721 Vali Acc: 0.940 Test Loss: 0.721 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 24.04652452468872
Epoch: 28, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.683 Vali Acc: 0.947 Test Loss: 0.683 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 23.000799894332886
Epoch: 29, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.638 Vali Acc: 0.945 Test Loss: 0.638 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 24.40127182006836
Epoch: 30, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.017 Vali Acc: 0.926 Test Loss: 1.017 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9554317548746518
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.019073009490967
Epoch: 1, Steps: 89 | Train Loss: 1.436 Vali Loss: 1.162 Vali Acc: 0.701 Test Loss: 1.162 Test Acc: 0.701
Validation loss decreased (inf --> -0.701242).  Saving model ...
Epoch: 2 cost time: 21.86541986465454
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 1.453 Vali Acc: 0.778 Test Loss: 1.453 Test Acc: 0.778
Validation loss decreased (-0.701242 --> -0.777841).  Saving model ...
Epoch: 3 cost time: 22.62786340713501
Epoch: 3, Steps: 89 | Train Loss: 0.397 Vali Loss: 1.648 Vali Acc: 0.696 Test Loss: 1.648 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.64086651802063
Epoch: 4, Steps: 89 | Train Loss: 0.445 Vali Loss: 1.802 Vali Acc: 0.729 Test Loss: 1.802 Test Acc: 0.729
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.023197174072266
Epoch: 5, Steps: 89 | Train Loss: 0.565 Vali Loss: 3.440 Vali Acc: 0.714 Test Loss: 3.440 Test Acc: 0.714
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 21.569690942764282
Epoch: 6, Steps: 89 | Train Loss: 0.610 Vali Loss: 3.162 Vali Acc: 0.726 Test Loss: 3.162 Test Acc: 0.726
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.307826280593872
Epoch: 7, Steps: 89 | Train Loss: 0.825 Vali Loss: 2.608 Vali Acc: 0.794 Test Loss: 2.608 Test Acc: 0.794
Validation loss decreased (-0.777841 --> -0.793846).  Saving model ...
Epoch: 8 cost time: 22.000996589660645
Epoch: 8, Steps: 89 | Train Loss: 0.938 Vali Loss: 1.365 Vali Acc: 0.855 Test Loss: 1.365 Test Acc: 0.855
Validation loss decreased (-0.793846 --> -0.855140).  Saving model ...
Epoch: 9 cost time: 21.640206575393677
Epoch: 9, Steps: 89 | Train Loss: 1.054 Vali Loss: 0.982 Vali Acc: 0.902 Test Loss: 0.982 Test Acc: 0.902
Validation loss decreased (-0.855140 --> -0.901801).  Saving model ...
Epoch: 10 cost time: 21.886420011520386
Epoch: 10, Steps: 89 | Train Loss: 0.794 Vali Loss: 0.974 Vali Acc: 0.899 Test Loss: 0.974 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.249810218811035
Epoch: 11, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.592 Vali Acc: 0.935 Test Loss: 0.592 Test Acc: 0.935
Validation loss decreased (-0.901801 --> -0.935231).  Saving model ...
Epoch: 12 cost time: 24.1100754737854
Epoch: 12, Steps: 89 | Train Loss: 0.514 Vali Loss: 0.687 Vali Acc: 0.937 Test Loss: 0.687 Test Acc: 0.937
Validation loss decreased (-0.935231 --> -0.937319).  Saving model ...
Epoch: 13 cost time: 21.39646291732788
Epoch: 13, Steps: 89 | Train Loss: 0.601 Vali Loss: 1.235 Vali Acc: 0.896 Test Loss: 1.235 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.349371671676636
Epoch: 14, Steps: 89 | Train Loss: 0.487 Vali Loss: 1.027 Vali Acc: 0.912 Test Loss: 1.027 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.555670976638794
Epoch: 15, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.982 Vali Acc: 0.925 Test Loss: 0.982 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.430293560028076
Epoch: 16, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.670 Vali Acc: 0.939 Test Loss: 0.670 Test Acc: 0.939
Validation loss decreased (-0.937319 --> -0.938712).  Saving model ...
Epoch: 17 cost time: 21.20186996459961
Epoch: 17, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.589 Vali Acc: 0.948 Test Loss: 0.589 Test Acc: 0.948
Validation loss decreased (-0.938712 --> -0.948462).  Saving model ...
Epoch: 18 cost time: 21.111042976379395
Epoch: 18, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.543 Vali Acc: 0.934 Test Loss: 0.543 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.063244342803955
Epoch: 19, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.650 Vali Acc: 0.937 Test Loss: 0.650 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.788942575454712
Epoch: 20, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.796 Vali Acc: 0.928 Test Loss: 0.796 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 22.27071213722229
Epoch: 21, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.797 Vali Acc: 0.917 Test Loss: 0.797 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 22.088505268096924
Epoch: 22, Steps: 89 | Train Loss: 0.282 Vali Loss: 1.180 Vali Acc: 0.894 Test Loss: 1.180 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 23.107280492782593
Epoch: 23, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.738 Vali Acc: 0.942 Test Loss: 0.738 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 22.218518018722534
Epoch: 24, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.815 Vali Acc: 0.935 Test Loss: 0.815 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 24.698216915130615
Epoch: 25, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.714 Vali Acc: 0.939 Test Loss: 0.714 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 22.70260000228882
Epoch: 26, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.744 Vali Acc: 0.931 Test Loss: 0.744 Test Acc: 0.931
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 21.999247312545776
Epoch: 27, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.592 Vali Acc: 0.944 Test Loss: 0.592 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9484679665738162
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.50218629837036
Epoch: 1, Steps: 89 | Train Loss: 1.476 Vali Loss: 1.206 Vali Acc: 0.723 Test Loss: 1.206 Test Acc: 0.723
Validation loss decreased (inf --> -0.722829).  Saving model ...
Epoch: 2 cost time: 22.649826526641846
Epoch: 2, Steps: 89 | Train Loss: 0.416 Vali Loss: 1.356 Vali Acc: 0.726 Test Loss: 1.356 Test Acc: 0.726
Validation loss decreased (-0.722829 --> -0.725613).  Saving model ...
Epoch: 3 cost time: 22.770699501037598
Epoch: 3, Steps: 89 | Train Loss: 0.413 Vali Loss: 1.260 Vali Acc: 0.782 Test Loss: 1.260 Test Acc: 0.782
Validation loss decreased (-0.725613 --> -0.782021).  Saving model ...
Epoch: 4 cost time: 21.418070793151855
Epoch: 4, Steps: 89 | Train Loss: 0.475 Vali Loss: 2.625 Vali Acc: 0.751 Test Loss: 2.625 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.82472014427185
Epoch: 5, Steps: 89 | Train Loss: 0.659 Vali Loss: 1.408 Vali Acc: 0.818 Test Loss: 1.408 Test Acc: 0.818
Validation loss decreased (-0.782021 --> -0.818231).  Saving model ...
Epoch: 6 cost time: 22.52738380432129
Epoch: 6, Steps: 89 | Train Loss: 0.876 Vali Loss: 1.316 Vali Acc: 0.825 Test Loss: 1.316 Test Acc: 0.825
Validation loss decreased (-0.818231 --> -0.825196).  Saving model ...
Epoch: 7 cost time: 22.413353204727173
Epoch: 7, Steps: 89 | Train Loss: 0.824 Vali Loss: 1.403 Vali Acc: 0.850 Test Loss: 1.403 Test Acc: 0.850
Validation loss decreased (-0.825196 --> -0.850265).  Saving model ...
Epoch: 8 cost time: 23.1515793800354
Epoch: 8, Steps: 89 | Train Loss: 1.179 Vali Loss: 2.020 Vali Acc: 0.800 Test Loss: 2.020 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.807507753372192
Epoch: 9, Steps: 89 | Train Loss: 1.056 Vali Loss: 1.767 Vali Acc: 0.843 Test Loss: 1.767 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.502708435058594
Epoch: 10, Steps: 89 | Train Loss: 0.956 Vali Loss: 2.157 Vali Acc: 0.845 Test Loss: 2.157 Test Acc: 0.845
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.207613706588745
Epoch: 11, Steps: 89 | Train Loss: 0.885 Vali Loss: 1.086 Vali Acc: 0.905 Test Loss: 1.086 Test Acc: 0.905
Validation loss decreased (-0.850265 --> -0.905282).  Saving model ...
Epoch: 12 cost time: 23.22828197479248
Epoch: 12, Steps: 89 | Train Loss: 0.722 Vali Loss: 0.913 Vali Acc: 0.910 Test Loss: 0.913 Test Acc: 0.910
Validation loss decreased (-0.905282 --> -0.910158).  Saving model ...
Epoch: 13 cost time: 21.957484483718872
Epoch: 13, Steps: 89 | Train Loss: 0.601 Vali Loss: 1.110 Vali Acc: 0.893 Test Loss: 1.110 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.254859447479248
Epoch: 14, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.743 Vali Acc: 0.931 Test Loss: 0.743 Test Acc: 0.931
Validation loss decreased (-0.910158 --> -0.931051).  Saving model ...
Epoch: 15 cost time: 22.0839421749115
Epoch: 15, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.614 Vali Acc: 0.942 Test Loss: 0.614 Test Acc: 0.942
Validation loss decreased (-0.931051 --> -0.941498).  Saving model ...
Epoch: 16 cost time: 23.090893268585205
Epoch: 16, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.941 Vali Acc: 0.905 Test Loss: 0.941 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 23.422980546951294
Epoch: 17, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.590 Vali Acc: 0.930 Test Loss: 0.590 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.643831729888916
Epoch: 18, Steps: 89 | Train Loss: 0.528 Vali Loss: 0.774 Vali Acc: 0.903 Test Loss: 0.774 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.42910599708557
Epoch: 19, Steps: 89 | Train Loss: 0.359 Vali Loss: 0.713 Vali Acc: 0.927 Test Loss: 0.713 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 24.496152877807617
Epoch: 20, Steps: 89 | Train Loss: 0.341 Vali Loss: 0.689 Vali Acc: 0.935 Test Loss: 0.689 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 22.88276243209839
Epoch: 21, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.581 Vali Acc: 0.943 Test Loss: 0.581 Test Acc: 0.943
Validation loss decreased (-0.941498 --> -0.942891).  Saving model ...
Epoch: 22 cost time: 23.7569100856781
Epoch: 22, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.954 Vali Acc: 0.904 Test Loss: 0.954 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 21.71962857246399
Epoch: 23, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.755 Vali Acc: 0.924 Test Loss: 0.755 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 23.10134744644165
Epoch: 24, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.662 Vali Acc: 0.924 Test Loss: 0.662 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.987163066864014
Epoch: 25, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.723 Vali Acc: 0.930 Test Loss: 0.723 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 23.20597004890442
Epoch: 26, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.655 Vali Acc: 0.937 Test Loss: 0.655 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 22.989591360092163
Epoch: 27, Steps: 89 | Train Loss: 0.174 Vali Loss: 1.111 Vali Acc: 0.907 Test Loss: 1.111 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 23.86496591567993
Epoch: 28, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.599 Vali Acc: 0.944 Test Loss: 0.599 Test Acc: 0.944
Validation loss decreased (-0.942891 --> -0.943587).  Saving model ...
Epoch: 29 cost time: 20.707334518432617
Epoch: 29, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.619 Vali Acc: 0.940 Test Loss: 0.619 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 21.63127088546753
Epoch: 30, Steps: 89 | Train Loss: 0.220 Vali Loss: 1.409 Vali Acc: 0.898 Test Loss: 1.409 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 20.84194302558899
Epoch: 31, Steps: 89 | Train Loss: 0.329 Vali Loss: 0.599 Vali Acc: 0.945 Test Loss: 0.599 Test Acc: 0.945
Validation loss decreased (-0.943587 --> -0.944980).  Saving model ...
Epoch: 32 cost time: 21.98263645172119
Epoch: 32, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.456 Vali Acc: 0.958 Test Loss: 0.456 Test Acc: 0.958
Validation loss decreased (-0.944980 --> -0.958213).  Saving model ...
Epoch: 33 cost time: 21.90367841720581
Epoch: 33, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.629 Vali Acc: 0.946 Test Loss: 0.629 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 20.979862689971924
Epoch: 34, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.687 Vali Acc: 0.932 Test Loss: 0.687 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 23.03999924659729
Epoch: 35, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.835 Vali Acc: 0.940 Test Loss: 0.835 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.049158811569214
Epoch: 36, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.545 Vali Acc: 0.946 Test Loss: 0.545 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 21.55624294281006
Epoch: 37, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.447 Vali Acc: 0.956 Test Loss: 0.447 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 22.24993062019348
Epoch: 38, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.553 Vali Acc: 0.955 Test Loss: 0.553 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 22.808202266693115
Epoch: 39, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 23.464505434036255
Epoch: 40, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.520 Vali Acc: 0.946 Test Loss: 0.520 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 24.116567373275757
Epoch: 41, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.681 Vali Acc: 0.932 Test Loss: 0.681 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 22.50931453704834
Epoch: 42, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.463 Vali Acc: 0.946 Test Loss: 0.463 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.209781169891357
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.055 Test Loss: 2.995 Test Acc: 0.055
Validation loss decreased (inf --> -0.054984).  Saving model ...
Epoch: 2 cost time: 21.311091661453247
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.054984 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 20.45940661430359
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 21.099944353103638
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 22.32629704475403
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 22.225395679473877
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 21.194696187973022
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 21.87148427963257
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 22.613362789154053
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 21.584423542022705
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 21.98068141937256
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 21.236413717269897
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 20.768969774246216
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 23.1652934551239
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 22.133663415908813
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 21.474310398101807
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 21.525191068649292
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 21.818294525146484
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 21.969425916671753
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 21.99794292449951
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 21.39801025390625
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 21.257392644882202
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 21.579746961593628
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 22.028613567352295
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 21.948873043060303
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 20.965733528137207
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 22.519636392593384
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 22.71793270111084
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 21.825572967529297
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 22.120790719985962
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 22.024901151657104
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 21.772322416305542
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 21.70660090446472
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 21.74299931526184
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 21.937735319137573
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 21.124224185943604
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 21.395196676254272
Epoch: 37, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 22.083943843841553
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 21.477219343185425
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 22.78778386116028
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 24.298287868499756
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 22.850862503051758
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 22.599478483200073
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 23.480854272842407
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 23.99281120300293
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 22.989460468292236
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 22.62559986114502
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 22.45216727256775
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 21.261961936950684
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 22.61005687713623
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 21.214823722839355
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 21.930378198623657
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 22.761057138442993
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 20.86105513572693
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 22.076142072677612
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 22.969309329986572
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 22.24232578277588
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 22.37656331062317
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 21.470494270324707
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 22.089200258255005
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 61 cost time: 23.58319902420044
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 22.20673894882202
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 22.499457359313965
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 24.30518674850464
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 24.173958778381348
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 22.365293264389038
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 21.41382384300232
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 21.414137363433838
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 22.339324235916138
Epoch: 69, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 22.03689455986023
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 18670612
model size : 90.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.18636989593506
Epoch: 1, Steps: 89 | Train Loss: 0.981 Vali Loss: 0.579 Vali Acc: 0.858 Test Loss: 0.579 Test Acc: 0.858
Validation loss decreased (inf --> -0.857933).  Saving model ...
Epoch: 2 cost time: 24.108280181884766
Epoch: 2, Steps: 89 | Train Loss: 0.632 Vali Loss: 0.613 Vali Acc: 0.882 Test Loss: 0.613 Test Acc: 0.882
Validation loss decreased (-0.857933 --> -0.881609).  Saving model ...
Epoch: 3 cost time: 22.881762266159058
Epoch: 3, Steps: 89 | Train Loss: 0.612 Vali Loss: 0.789 Vali Acc: 0.870 Test Loss: 0.789 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.994818449020386
Epoch: 4, Steps: 89 | Train Loss: 0.677 Vali Loss: 2.223 Vali Acc: 0.823 Test Loss: 2.223 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.37878942489624
Epoch: 5, Steps: 89 | Train Loss: 0.625 Vali Loss: 1.342 Vali Acc: 0.881 Test Loss: 1.342 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.41177248954773
Epoch: 6, Steps: 89 | Train Loss: 0.603 Vali Loss: 1.430 Vali Acc: 0.882 Test Loss: 1.430 Test Acc: 0.882
Validation loss decreased (-0.881609 --> -0.882298).  Saving model ...
Epoch: 7 cost time: 23.225627183914185
Epoch: 7, Steps: 89 | Train Loss: 0.608 Vali Loss: 1.145 Vali Acc: 0.885 Test Loss: 1.145 Test Acc: 0.885
Validation loss decreased (-0.882298 --> -0.885086).  Saving model ...
Epoch: 8 cost time: 23.917888879776
Epoch: 8, Steps: 89 | Train Loss: 0.678 Vali Loss: 1.093 Vali Acc: 0.894 Test Loss: 1.093 Test Acc: 0.894
Validation loss decreased (-0.885086 --> -0.894139).  Saving model ...
Epoch: 9 cost time: 23.178370714187622
Epoch: 9, Steps: 89 | Train Loss: 0.636 Vali Loss: 1.194 Vali Acc: 0.886 Test Loss: 1.194 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.74537444114685
Epoch: 10, Steps: 89 | Train Loss: 0.696 Vali Loss: 1.517 Vali Acc: 0.859 Test Loss: 1.517 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.468712329864502
Epoch: 11, Steps: 89 | Train Loss: 0.626 Vali Loss: 2.608 Vali Acc: 0.829 Test Loss: 2.608 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.64070773124695
Epoch: 12, Steps: 89 | Train Loss: 0.820 Vali Loss: 1.084 Vali Acc: 0.926 Test Loss: 1.084 Test Acc: 0.926
Validation loss decreased (-0.894139 --> -0.926173).  Saving model ...
Epoch: 13 cost time: 23.677042961120605
Epoch: 13, Steps: 89 | Train Loss: 0.437 Vali Loss: 1.377 Vali Acc: 0.891 Test Loss: 1.377 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.846683263778687
Epoch: 14, Steps: 89 | Train Loss: 0.433 Vali Loss: 1.398 Vali Acc: 0.909 Test Loss: 1.398 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.34151530265808
Epoch: 15, Steps: 89 | Train Loss: 0.366 Vali Loss: 1.186 Vali Acc: 0.912 Test Loss: 1.186 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.58702564239502
Epoch: 16, Steps: 89 | Train Loss: 0.369 Vali Loss: 1.437 Vali Acc: 0.910 Test Loss: 1.437 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.298241138458252
Epoch: 17, Steps: 89 | Train Loss: 0.451 Vali Loss: 1.323 Vali Acc: 0.903 Test Loss: 1.323 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.45079016685486
Epoch: 18, Steps: 89 | Train Loss: 0.425 Vali Loss: 1.328 Vali Acc: 0.912 Test Loss: 1.328 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.46479034423828
Epoch: 19, Steps: 89 | Train Loss: 0.877 Vali Loss: 1.239 Vali Acc: 0.923 Test Loss: 1.239 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 23.378336668014526
Epoch: 20, Steps: 89 | Train Loss: 0.338 Vali Loss: 1.150 Vali Acc: 0.918 Test Loss: 1.150 Test Acc: 0.918
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 21.22111415863037
Epoch: 21, Steps: 89 | Train Loss: 0.438 Vali Loss: 1.456 Vali Acc: 0.900 Test Loss: 1.456 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 23.06552004814148
Epoch: 22, Steps: 89 | Train Loss: 0.283 Vali Loss: 1.056 Vali Acc: 0.931 Test Loss: 1.056 Test Acc: 0.931
Validation loss decreased (-0.926173 --> -0.931048).  Saving model ...
Epoch: 23 cost time: 22.701658010482788
Epoch: 23, Steps: 89 | Train Loss: 0.367 Vali Loss: 1.414 Vali Acc: 0.908 Test Loss: 1.414 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.45424175262451
Epoch: 24, Steps: 89 | Train Loss: 0.242 Vali Loss: 1.777 Vali Acc: 0.893 Test Loss: 1.777 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 23.563215017318726
Epoch: 25, Steps: 89 | Train Loss: 0.464 Vali Loss: 1.069 Vali Acc: 0.925 Test Loss: 1.069 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.062642574310303
Epoch: 26, Steps: 89 | Train Loss: 0.235 Vali Loss: 1.181 Vali Acc: 0.937 Test Loss: 1.181 Test Acc: 0.937
Validation loss decreased (-0.931048 --> -0.936618).  Saving model ...
Epoch: 27 cost time: 24.1863374710083
Epoch: 27, Steps: 89 | Train Loss: 0.499 Vali Loss: 1.894 Vali Acc: 0.878 Test Loss: 1.894 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 23.288630962371826
Epoch: 28, Steps: 89 | Train Loss: 0.369 Vali Loss: 1.205 Vali Acc: 0.917 Test Loss: 1.205 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 23.296874523162842
Epoch: 29, Steps: 89 | Train Loss: 0.409 Vali Loss: 1.288 Vali Acc: 0.923 Test Loss: 1.288 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 23.10387945175171
Epoch: 30, Steps: 89 | Train Loss: 0.348 Vali Loss: 1.052 Vali Acc: 0.938 Test Loss: 1.052 Test Acc: 0.938
Validation loss decreased (-0.936618 --> -0.938012).  Saving model ...
Epoch: 31 cost time: 24.49899125099182
Epoch: 31, Steps: 89 | Train Loss: 0.290 Vali Loss: 1.092 Vali Acc: 0.932 Test Loss: 1.092 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 22.95705223083496
Epoch: 32, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.257 Vali Acc: 0.934 Test Loss: 1.257 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 22.055672883987427
Epoch: 33, Steps: 89 | Train Loss: 0.394 Vali Loss: 1.415 Vali Acc: 0.926 Test Loss: 1.415 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 22.49730110168457
Epoch: 34, Steps: 89 | Train Loss: 0.317 Vali Loss: 1.535 Vali Acc: 0.898 Test Loss: 1.535 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 21.36297082901001
Epoch: 35, Steps: 89 | Train Loss: 0.318 Vali Loss: 1.074 Vali Acc: 0.925 Test Loss: 1.074 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 21.32476234436035
Epoch: 36, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.976 Vali Acc: 0.946 Test Loss: 0.976 Test Acc: 0.946
Validation loss decreased (-0.938012 --> -0.946369).  Saving model ...
Epoch: 37 cost time: 22.60722780227661
Epoch: 37, Steps: 89 | Train Loss: 0.221 Vali Loss: 1.527 Vali Acc: 0.912 Test Loss: 1.527 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 20.683146953582764
Epoch: 38, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.914 Vali Acc: 0.948 Test Loss: 0.914 Test Acc: 0.948
Validation loss decreased (-0.946369 --> -0.947762).  Saving model ...
Epoch: 39 cost time: 21.819936513900757
Epoch: 39, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.146 Vali Acc: 0.939 Test Loss: 1.146 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 22.9744815826416
Epoch: 40, Steps: 89 | Train Loss: 0.260 Vali Loss: 1.151 Vali Acc: 0.928 Test Loss: 1.151 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 22.770806550979614
Epoch: 41, Steps: 89 | Train Loss: 0.177 Vali Loss: 1.365 Vali Acc: 0.935 Test Loss: 1.365 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 23.33785319328308
Epoch: 42, Steps: 89 | Train Loss: 0.259 Vali Loss: 1.094 Vali Acc: 0.948 Test Loss: 1.094 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 24.30118179321289
Epoch: 43, Steps: 89 | Train Loss: 0.232 Vali Loss: 1.190 Vali Acc: 0.936 Test Loss: 1.190 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 23.242832899093628
Epoch: 44, Steps: 89 | Train Loss: 0.343 Vali Loss: 1.592 Vali Acc: 0.905 Test Loss: 1.592 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 21.997490406036377
Epoch: 45, Steps: 89 | Train Loss: 0.397 Vali Loss: 1.273 Vali Acc: 0.930 Test Loss: 1.273 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 22.091703176498413
Epoch: 46, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.830 Vali Acc: 0.955 Test Loss: 0.830 Test Acc: 0.955
Validation loss decreased (-0.947762 --> -0.955423).  Saving model ...
Epoch: 47 cost time: 21.329044818878174
Epoch: 47, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.791 Vali Acc: 0.947 Test Loss: 0.791 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 22.878236055374146
Epoch: 48, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.958 Vali Acc: 0.940 Test Loss: 0.958 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 22.705881595611572
Epoch: 49, Steps: 89 | Train Loss: 0.179 Vali Loss: 1.314 Vali Acc: 0.914 Test Loss: 1.314 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 20.697033405303955
Epoch: 50, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.160 Vali Acc: 0.927 Test Loss: 1.160 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 22.89226531982422
Epoch: 51, Steps: 89 | Train Loss: 0.269 Vali Loss: 1.297 Vali Acc: 0.928 Test Loss: 1.297 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 22.420853853225708
Epoch: 52, Steps: 89 | Train Loss: 0.235 Vali Loss: 1.336 Vali Acc: 0.919 Test Loss: 1.336 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 21.238218784332275
Epoch: 53, Steps: 89 | Train Loss: 0.225 Vali Loss: 1.383 Vali Acc: 0.898 Test Loss: 1.383 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 21.443195581436157
Epoch: 54, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.837 Vali Acc: 0.955 Test Loss: 0.837 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 20.624751091003418
Epoch: 55, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.840 Vali Acc: 0.950 Test Loss: 0.840 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 21.769808053970337
Epoch: 56, Steps: 89 | Train Loss: 0.448 Vali Loss: 1.323 Vali Acc: 0.915 Test Loss: 1.323 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9554317548746518
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.381470680236816
Epoch: 1, Steps: 89 | Train Loss: 1.074 Vali Loss: 0.983 Vali Acc: 0.821 Test Loss: 0.983 Test Acc: 0.821
Validation loss decreased (inf --> -0.821021).  Saving model ...
Epoch: 2 cost time: 23.245503425598145
Epoch: 2, Steps: 89 | Train Loss: 0.668 Vali Loss: 0.684 Vali Acc: 0.870 Test Loss: 0.684 Test Acc: 0.870
Validation loss decreased (-0.821021 --> -0.869770).  Saving model ...
Epoch: 3 cost time: 24.922265768051147
Epoch: 3, Steps: 89 | Train Loss: 0.664 Vali Loss: 0.924 Vali Acc: 0.870 Test Loss: 0.924 Test Acc: 0.870
Validation loss decreased (-0.869770 --> -0.870464).  Saving model ...
Epoch: 4 cost time: 24.416329622268677
Epoch: 4, Steps: 89 | Train Loss: 0.696 Vali Loss: 1.351 Vali Acc: 0.879 Test Loss: 1.351 Test Acc: 0.879
Validation loss decreased (-0.870464 --> -0.878817).  Saving model ...
Epoch: 5 cost time: 24.17202401161194
Epoch: 5, Steps: 89 | Train Loss: 0.592 Vali Loss: 1.037 Vali Acc: 0.884 Test Loss: 1.037 Test Acc: 0.884
Validation loss decreased (-0.878817 --> -0.883694).  Saving model ...
Epoch: 6 cost time: 24.5883948802948
Epoch: 6, Steps: 89 | Train Loss: 0.800 Vali Loss: 0.785 Vali Acc: 0.919 Test Loss: 0.785 Test Acc: 0.919
Validation loss decreased (-0.883694 --> -0.918516).  Saving model ...
Epoch: 7 cost time: 23.306917667388916
Epoch: 7, Steps: 89 | Train Loss: 0.744 Vali Loss: 0.942 Vali Acc: 0.889 Test Loss: 0.942 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.834787845611572
Epoch: 8, Steps: 89 | Train Loss: 0.584 Vali Loss: 1.612 Vali Acc: 0.875 Test Loss: 1.612 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.295555591583252
Epoch: 9, Steps: 89 | Train Loss: 0.596 Vali Loss: 1.083 Vali Acc: 0.892 Test Loss: 1.083 Test Acc: 0.892
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.207961082458496
Epoch: 10, Steps: 89 | Train Loss: 0.469 Vali Loss: 1.072 Vali Acc: 0.905 Test Loss: 1.072 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.04107689857483
Epoch: 11, Steps: 89 | Train Loss: 0.587 Vali Loss: 0.949 Vali Acc: 0.903 Test Loss: 0.949 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 23.536739587783813
Epoch: 12, Steps: 89 | Train Loss: 0.402 Vali Loss: 1.084 Vali Acc: 0.913 Test Loss: 1.084 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.162479162216187
Epoch: 13, Steps: 89 | Train Loss: 0.484 Vali Loss: 1.364 Vali Acc: 0.888 Test Loss: 1.364 Test Acc: 0.888
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 22.153102159500122
Epoch: 14, Steps: 89 | Train Loss: 0.373 Vali Loss: 1.144 Vali Acc: 0.873 Test Loss: 1.144 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.753305196762085
Epoch: 15, Steps: 89 | Train Loss: 0.621 Vali Loss: 1.530 Vali Acc: 0.884 Test Loss: 1.530 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.668413877487183
Epoch: 16, Steps: 89 | Train Loss: 0.649 Vali Loss: 1.014 Vali Acc: 0.914 Test Loss: 1.014 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9185236768802229
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.06347131729126
Epoch: 1, Steps: 89 | Train Loss: 1.146 Vali Loss: 0.713 Vali Acc: 0.829 Test Loss: 0.713 Test Acc: 0.829
Validation loss decreased (inf --> -0.829380).  Saving model ...
Epoch: 2 cost time: 21.628749132156372
Epoch: 2, Steps: 89 | Train Loss: 0.585 Vali Loss: 0.699 Vali Acc: 0.860 Test Loss: 0.699 Test Acc: 0.860
Validation loss decreased (-0.829380 --> -0.860021).  Saving model ...
Epoch: 3 cost time: 22.398476600646973
Epoch: 3, Steps: 89 | Train Loss: 0.602 Vali Loss: 1.278 Vali Acc: 0.841 Test Loss: 1.278 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.548576831817627
Epoch: 4, Steps: 89 | Train Loss: 0.829 Vali Loss: 1.040 Vali Acc: 0.879 Test Loss: 1.040 Test Acc: 0.879
Validation loss decreased (-0.860021 --> -0.878820).  Saving model ...
Epoch: 5 cost time: 22.935346603393555
Epoch: 5, Steps: 89 | Train Loss: 0.575 Vali Loss: 0.886 Vali Acc: 0.891 Test Loss: 0.886 Test Acc: 0.891
Validation loss decreased (-0.878820 --> -0.890660).  Saving model ...
Epoch: 6 cost time: 23.98746418952942
Epoch: 6, Steps: 89 | Train Loss: 0.589 Vali Loss: 1.413 Vali Acc: 0.831 Test Loss: 1.413 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.343100547790527
Epoch: 7, Steps: 89 | Train Loss: 0.669 Vali Loss: 1.148 Vali Acc: 0.892 Test Loss: 1.148 Test Acc: 0.892
Validation loss decreased (-0.890660 --> -0.892050).  Saving model ...
Epoch: 8 cost time: 21.52393078804016
Epoch: 8, Steps: 89 | Train Loss: 0.724 Vali Loss: 1.249 Vali Acc: 0.879 Test Loss: 1.249 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.217585563659668
Epoch: 9, Steps: 89 | Train Loss: 0.473 Vali Loss: 1.486 Vali Acc: 0.874 Test Loss: 1.486 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.08478617668152
Epoch: 10, Steps: 89 | Train Loss: 0.759 Vali Loss: 1.099 Vali Acc: 0.889 Test Loss: 1.099 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.723546266555786
Epoch: 11, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.724 Vali Acc: 0.934 Test Loss: 0.724 Test Acc: 0.934
Validation loss decreased (-0.892050 --> -0.933837).  Saving model ...
Epoch: 12 cost time: 22.341193199157715
Epoch: 12, Steps: 89 | Train Loss: 0.581 Vali Loss: 1.186 Vali Acc: 0.910 Test Loss: 1.186 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.48222780227661
Epoch: 13, Steps: 89 | Train Loss: 0.522 Vali Loss: 0.978 Vali Acc: 0.910 Test Loss: 0.978 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.500604391098022
Epoch: 14, Steps: 89 | Train Loss: 0.518 Vali Loss: 0.711 Vali Acc: 0.914 Test Loss: 0.711 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 22.419615030288696
Epoch: 15, Steps: 89 | Train Loss: 0.528 Vali Loss: 0.742 Vali Acc: 0.940 Test Loss: 0.742 Test Acc: 0.940
Validation loss decreased (-0.933837 --> -0.940104).  Saving model ...
Epoch: 16 cost time: 22.128332138061523
Epoch: 16, Steps: 89 | Train Loss: 0.317 Vali Loss: 1.160 Vali Acc: 0.914 Test Loss: 1.160 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.588746786117554
Epoch: 17, Steps: 89 | Train Loss: 0.644 Vali Loss: 1.146 Vali Acc: 0.909 Test Loss: 1.146 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.76856517791748
Epoch: 18, Steps: 89 | Train Loss: 0.457 Vali Loss: 0.785 Vali Acc: 0.930 Test Loss: 0.785 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 21.51585364341736
Epoch: 19, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.880 Vali Acc: 0.926 Test Loss: 0.880 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 22.363266944885254
Epoch: 20, Steps: 89 | Train Loss: 0.430 Vali Loss: 0.690 Vali Acc: 0.939 Test Loss: 0.690 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.154951572418213
Epoch: 21, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.963 Vali Acc: 0.925 Test Loss: 0.963 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 21.80904269218445
Epoch: 22, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.629 Vali Acc: 0.944 Test Loss: 0.629 Test Acc: 0.944
Validation loss decreased (-0.940104 --> -0.944283).  Saving model ...
Epoch: 23 cost time: 21.31878685951233
Epoch: 23, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.911 Vali Acc: 0.915 Test Loss: 0.911 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.050130605697632
Epoch: 24, Steps: 89 | Train Loss: 0.380 Vali Loss: 3.034 Vali Acc: 0.836 Test Loss: 3.034 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 21.75794005393982
Epoch: 25, Steps: 89 | Train Loss: 0.493 Vali Loss: 0.991 Vali Acc: 0.905 Test Loss: 0.991 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 21.359353065490723
Epoch: 26, Steps: 89 | Train Loss: 0.492 Vali Loss: 0.565 Vali Acc: 0.946 Test Loss: 0.565 Test Acc: 0.946
Validation loss decreased (-0.944283 --> -0.946373).  Saving model ...
Epoch: 27 cost time: 22.23180317878723
Epoch: 27, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.630 Vali Acc: 0.921 Test Loss: 0.630 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 24.846367359161377
Epoch: 28, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.677 Vali Acc: 0.923 Test Loss: 0.677 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 21.041202306747437
Epoch: 29, Steps: 89 | Train Loss: 0.442 Vali Loss: 0.805 Vali Acc: 0.921 Test Loss: 0.805 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 20.95718789100647
Epoch: 30, Steps: 89 | Train Loss: 0.444 Vali Loss: 0.893 Vali Acc: 0.915 Test Loss: 0.893 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 22.300631046295166
Epoch: 31, Steps: 89 | Train Loss: 0.385 Vali Loss: 0.549 Vali Acc: 0.903 Test Loss: 0.549 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 23.259024620056152
Epoch: 32, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.561 Vali Acc: 0.938 Test Loss: 0.561 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 23.05068612098694
Epoch: 33, Steps: 89 | Train Loss: 0.372 Vali Loss: 1.083 Vali Acc: 0.878 Test Loss: 1.083 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 23.946709156036377
Epoch: 34, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 22.80469584465027
Epoch: 35, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.502 Vali Acc: 0.927 Test Loss: 0.502 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 24.50805377960205
Epoch: 36, Steps: 89 | Train Loss: 0.494 Vali Loss: 0.903 Vali Acc: 0.857 Test Loss: 0.903 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9463788300835655
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 32.89037728309631
Epoch: 1, Steps: 89 | Train Loss: 1.291 Vali Loss: 0.627 Vali Acc: 0.840 Test Loss: 0.627 Test Acc: 0.840
Validation loss decreased (inf --> -0.839827).  Saving model ...
Epoch: 2 cost time: 30.313066720962524
Epoch: 2, Steps: 89 | Train Loss: 0.664 Vali Loss: 0.758 Vali Acc: 0.848 Test Loss: 0.758 Test Acc: 0.848
Validation loss decreased (-0.839827 --> -0.848182).  Saving model ...
Epoch: 3 cost time: 29.34545660018921
Epoch: 3, Steps: 89 | Train Loss: 0.611 Vali Loss: 1.007 Vali Acc: 0.876 Test Loss: 1.007 Test Acc: 0.876
Validation loss decreased (-0.848182 --> -0.876034).  Saving model ...
Epoch: 4 cost time: 31.589383363723755
Epoch: 4, Steps: 89 | Train Loss: 0.519 Vali Loss: 1.115 Vali Acc: 0.870 Test Loss: 1.115 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.252604484558105
Epoch: 5, Steps: 89 | Train Loss: 0.612 Vali Loss: 0.864 Vali Acc: 0.907 Test Loss: 0.864 Test Acc: 0.907
Validation loss decreased (-0.876034 --> -0.907373).  Saving model ...
Epoch: 6 cost time: 30.147255897521973
Epoch: 6, Steps: 89 | Train Loss: 0.853 Vali Loss: 1.115 Vali Acc: 0.895 Test Loss: 1.115 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.295073747634888
Epoch: 7, Steps: 89 | Train Loss: 0.792 Vali Loss: 1.307 Vali Acc: 0.859 Test Loss: 1.307 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 29.78753137588501
Epoch: 8, Steps: 89 | Train Loss: 0.706 Vali Loss: 1.785 Vali Acc: 0.865 Test Loss: 1.785 Test Acc: 0.865
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 31.658438444137573
Epoch: 9, Steps: 89 | Train Loss: 0.722 Vali Loss: 1.242 Vali Acc: 0.892 Test Loss: 1.242 Test Acc: 0.892
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 31.95475459098816
Epoch: 10, Steps: 89 | Train Loss: 0.703 Vali Loss: 1.429 Vali Acc: 0.889 Test Loss: 1.429 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 29.683738470077515
Epoch: 11, Steps: 89 | Train Loss: 0.683 Vali Loss: 1.164 Vali Acc: 0.886 Test Loss: 1.164 Test Acc: 0.886
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 32.317622661590576
Epoch: 12, Steps: 89 | Train Loss: 0.764 Vali Loss: 1.091 Vali Acc: 0.910 Test Loss: 1.091 Test Acc: 0.910
Validation loss decreased (-0.907373 --> -0.910156).  Saving model ...
Epoch: 13 cost time: 31.88097095489502
Epoch: 13, Steps: 89 | Train Loss: 0.577 Vali Loss: 1.470 Vali Acc: 0.916 Test Loss: 1.470 Test Acc: 0.916
Validation loss decreased (-0.910156 --> -0.916420).  Saving model ...
Epoch: 14 cost time: 29.36228656768799
Epoch: 14, Steps: 89 | Train Loss: 0.645 Vali Loss: 1.001 Vali Acc: 0.931 Test Loss: 1.001 Test Acc: 0.931
Validation loss decreased (-0.916420 --> -0.931048).  Saving model ...
Epoch: 15 cost time: 26.60157299041748
Epoch: 15, Steps: 89 | Train Loss: 0.522 Vali Loss: 0.697 Vali Acc: 0.914 Test Loss: 0.697 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 29.504052877426147
Epoch: 16, Steps: 89 | Train Loss: 0.577 Vali Loss: 1.223 Vali Acc: 0.893 Test Loss: 1.223 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 31.576433420181274
Epoch: 17, Steps: 89 | Train Loss: 0.737 Vali Loss: 1.569 Vali Acc: 0.894 Test Loss: 1.569 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 29.96241021156311
Epoch: 18, Steps: 89 | Train Loss: 0.576 Vali Loss: 0.601 Vali Acc: 0.923 Test Loss: 0.601 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 31.399463176727295
Epoch: 19, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.775 Vali Acc: 0.922 Test Loss: 0.775 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 31.43094301223755
Epoch: 20, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.650 Vali Acc: 0.939 Test Loss: 0.650 Test Acc: 0.939
Validation loss decreased (-0.931048 --> -0.938712).  Saving model ...
Epoch: 21 cost time: 30.034687995910645
Epoch: 21, Steps: 89 | Train Loss: 0.539 Vali Loss: 0.495 Vali Acc: 0.931 Test Loss: 0.495 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 31.417266130447388
Epoch: 22, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.906 Vali Acc: 0.861 Test Loss: 0.906 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 33.06402373313904
Epoch: 23, Steps: 89 | Train Loss: 0.471 Vali Loss: 0.842 Vali Acc: 0.891 Test Loss: 0.842 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 31.53826880455017
Epoch: 24, Steps: 89 | Train Loss: 0.476 Vali Loss: 0.734 Vali Acc: 0.923 Test Loss: 0.734 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 32.340845584869385
Epoch: 25, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.792 Vali Acc: 0.873 Test Loss: 0.792 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 32.429593563079834
Epoch: 26, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.634 Vali Acc: 0.913 Test Loss: 0.634 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 30.35757303237915
Epoch: 27, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.372 Vali Acc: 0.918 Test Loss: 0.372 Test Acc: 0.918
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 31.10996985435486
Epoch: 28, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.477 Vali Acc: 0.907 Test Loss: 0.477 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 31.77594542503357
Epoch: 29, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.263 Vali Acc: 0.956 Test Loss: 0.263 Test Acc: 0.956
Validation loss decreased (-0.938712 --> -0.956126).  Saving model ...
Epoch: 30 cost time: 29.694647073745728
Epoch: 30, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.443 Vali Acc: 0.921 Test Loss: 0.443 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 31.058937788009644
Epoch: 31, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.330 Vali Acc: 0.943 Test Loss: 0.330 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 31.54673433303833
Epoch: 32, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.482 Vali Acc: 0.944 Test Loss: 0.482 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 29.450801372528076
Epoch: 33, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.552 Vali Acc: 0.933 Test Loss: 0.552 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 31.44874405860901
Epoch: 34, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.403 Vali Acc: 0.924 Test Loss: 0.403 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 31.40008044242859
Epoch: 35, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.415 Vali Acc: 0.948 Test Loss: 0.415 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 29.892369270324707
Epoch: 36, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.346 Vali Acc: 0.948 Test Loss: 0.346 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 30.886242389678955
Epoch: 37, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.447 Vali Acc: 0.933 Test Loss: 0.447 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 31.22239398956299
Epoch: 38, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.433 Vali Acc: 0.946 Test Loss: 0.433 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 29.10955572128296
Epoch: 39, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.267 Vali Acc: 0.963 Test Loss: 0.267 Test Acc: 0.963
Validation loss decreased (-0.956126 --> -0.963089).  Saving model ...
Epoch: 40 cost time: 31.695096731185913
Epoch: 40, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.262 Vali Acc: 0.962 Test Loss: 0.262 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 31.93228816986084
Epoch: 41, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.288 Vali Acc: 0.960 Test Loss: 0.288 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 29.24684739112854
Epoch: 42, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.318 Vali Acc: 0.953 Test Loss: 0.318 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 30.98345422744751
Epoch: 43, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.412 Vali Acc: 0.938 Test Loss: 0.412 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 31.643890619277954
Epoch: 44, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.407 Vali Acc: 0.944 Test Loss: 0.407 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 29.713796854019165
Epoch: 45, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.340 Vali Acc: 0.953 Test Loss: 0.340 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 31.318450450897217
Epoch: 46, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.277 Vali Acc: 0.955 Test Loss: 0.277 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 31.836122751235962
Epoch: 47, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.368 Vali Acc: 0.946 Test Loss: 0.368 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 29.36076283454895
Epoch: 48, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.404 Vali Acc: 0.956 Test Loss: 0.404 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 31.479315757751465
Epoch: 49, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.399 Vali Acc: 0.945 Test Loss: 0.399 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 33.28740358352661
Epoch: 1, Steps: 89 | Train Loss: 1.564 Vali Loss: 0.852 Vali Acc: 0.766 Test Loss: 0.852 Test Acc: 0.766
Validation loss decreased (inf --> -0.766008).  Saving model ...
Epoch: 2 cost time: 30.32023572921753
Epoch: 2, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.873 Vali Acc: 0.821 Test Loss: 0.873 Test Acc: 0.821
Validation loss decreased (-0.766008 --> -0.821022).  Saving model ...
Epoch: 3 cost time: 31.61672019958496
Epoch: 3, Steps: 89 | Train Loss: 0.513 Vali Loss: 0.768 Vali Acc: 0.883 Test Loss: 0.768 Test Acc: 0.883
Validation loss decreased (-0.821022 --> -0.883001).  Saving model ...
Epoch: 4 cost time: 32.106252908706665
Epoch: 4, Steps: 89 | Train Loss: 0.571 Vali Loss: 1.670 Vali Acc: 0.830 Test Loss: 1.670 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.526711225509644
Epoch: 5, Steps: 89 | Train Loss: 0.685 Vali Loss: 2.191 Vali Acc: 0.844 Test Loss: 2.191 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 31.63707160949707
Epoch: 6, Steps: 89 | Train Loss: 0.717 Vali Loss: 1.542 Vali Acc: 0.860 Test Loss: 1.542 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.41306233406067
Epoch: 7, Steps: 89 | Train Loss: 0.890 Vali Loss: 1.231 Vali Acc: 0.882 Test Loss: 1.231 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 30.81689214706421
Epoch: 8, Steps: 89 | Train Loss: 0.742 Vali Loss: 1.781 Vali Acc: 0.867 Test Loss: 1.781 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 31.234424114227295
Epoch: 9, Steps: 89 | Train Loss: 0.755 Vali Loss: 2.434 Vali Acc: 0.842 Test Loss: 2.434 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 30.76520848274231
Epoch: 10, Steps: 89 | Train Loss: 0.894 Vali Loss: 1.586 Vali Acc: 0.859 Test Loss: 1.586 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 31.38102912902832
Epoch: 11, Steps: 89 | Train Loss: 0.833 Vali Loss: 1.546 Vali Acc: 0.903 Test Loss: 1.546 Test Acc: 0.903
Validation loss decreased (-0.883001 --> -0.902492).  Saving model ...
Epoch: 12 cost time: 32.409982442855835
Epoch: 12, Steps: 89 | Train Loss: 1.058 Vali Loss: 1.859 Vali Acc: 0.876 Test Loss: 1.859 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 31.269742012023926
Epoch: 13, Steps: 89 | Train Loss: 0.900 Vali Loss: 1.330 Vali Acc: 0.891 Test Loss: 1.330 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 31.58521008491516
Epoch: 14, Steps: 89 | Train Loss: 0.725 Vali Loss: 1.004 Vali Acc: 0.925 Test Loss: 1.004 Test Acc: 0.925
Validation loss decreased (-0.902492 --> -0.924781).  Saving model ...
Epoch: 15 cost time: 32.276867628097534
Epoch: 15, Steps: 89 | Train Loss: 0.687 Vali Loss: 3.489 Vali Acc: 0.850 Test Loss: 3.489 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 30.97732973098755
Epoch: 16, Steps: 89 | Train Loss: 0.895 Vali Loss: 1.085 Vali Acc: 0.921 Test Loss: 1.085 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 31.586200714111328
Epoch: 17, Steps: 89 | Train Loss: 0.526 Vali Loss: 1.228 Vali Acc: 0.909 Test Loss: 1.228 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 31.766894340515137
Epoch: 18, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.756 Vali Acc: 0.934 Test Loss: 0.756 Test Acc: 0.934
Validation loss decreased (-0.924781 --> -0.933836).  Saving model ...
Epoch: 19 cost time: 30.586325645446777
Epoch: 19, Steps: 89 | Train Loss: 0.337 Vali Loss: 1.026 Vali Acc: 0.925 Test Loss: 1.026 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 31.405935287475586
Epoch: 20, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.914 Vali Acc: 0.939 Test Loss: 0.914 Test Acc: 0.939
Validation loss decreased (-0.933836 --> -0.938710).  Saving model ...
Epoch: 21 cost time: 30.782923936843872
Epoch: 21, Steps: 89 | Train Loss: 0.400 Vali Loss: 0.619 Vali Acc: 0.952 Test Loss: 0.619 Test Acc: 0.952
Validation loss decreased (-0.938710 --> -0.951944).  Saving model ...
Epoch: 22 cost time: 29.37826919555664
Epoch: 22, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.623 Vali Acc: 0.961 Test Loss: 0.623 Test Acc: 0.961
Validation loss decreased (-0.951944 --> -0.960997).  Saving model ...
Epoch: 23 cost time: 31.276062965393066
Epoch: 23, Steps: 89 | Train Loss: 0.464 Vali Loss: 0.827 Vali Acc: 0.943 Test Loss: 0.827 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 32.98796105384827
Epoch: 24, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.463 Vali Acc: 0.957 Test Loss: 0.463 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 29.945833921432495
Epoch: 25, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.852 Vali Acc: 0.946 Test Loss: 0.852 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 32.44376492500305
Epoch: 26, Steps: 89 | Train Loss: 0.278 Vali Loss: 1.201 Vali Acc: 0.921 Test Loss: 1.201 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 32.137455463409424
Epoch: 27, Steps: 89 | Train Loss: 0.288 Vali Loss: 1.037 Vali Acc: 0.935 Test Loss: 1.037 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 30.470553159713745
Epoch: 28, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.981 Vali Acc: 0.925 Test Loss: 0.981 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 31.446999311447144
Epoch: 29, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.749 Vali Acc: 0.939 Test Loss: 0.749 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 31.604838609695435
Epoch: 30, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.867 Vali Acc: 0.929 Test Loss: 0.867 Test Acc: 0.929
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 29.976073265075684
Epoch: 31, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.469 Vali Acc: 0.959 Test Loss: 0.469 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 32.519591331481934
Epoch: 32, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.598 Vali Acc: 0.959 Test Loss: 0.598 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 32.89216995239258
Epoch: 1, Steps: 89 | Train Loss: 1.508 Vali Loss: 1.123 Vali Acc: 0.635 Test Loss: 1.123 Test Acc: 0.635
Validation loss decreased (inf --> -0.635086).  Saving model ...
Epoch: 2 cost time: 30.12855100631714
Epoch: 2, Steps: 89 | Train Loss: 0.451 Vali Loss: 1.400 Vali Acc: 0.718 Test Loss: 1.400 Test Acc: 0.718
Validation loss decreased (-0.635086 --> -0.717953).  Saving model ...
Epoch: 3 cost time: 31.360190868377686
Epoch: 3, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.917 Vali Acc: 0.844 Test Loss: 0.917 Test Acc: 0.844
Validation loss decreased (-0.717953 --> -0.844002).  Saving model ...
Epoch: 4 cost time: 31.521553993225098
Epoch: 4, Steps: 89 | Train Loss: 0.389 Vali Loss: 1.292 Vali Acc: 0.772 Test Loss: 1.292 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.352320432662964
Epoch: 5, Steps: 89 | Train Loss: 0.401 Vali Loss: 3.198 Vali Acc: 0.643 Test Loss: 3.198 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 31.34761691093445
Epoch: 6, Steps: 89 | Train Loss: 0.735 Vali Loss: 2.474 Vali Acc: 0.777 Test Loss: 2.474 Test Acc: 0.777
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.99050521850586
Epoch: 7, Steps: 89 | Train Loss: 0.697 Vali Loss: 1.582 Vali Acc: 0.864 Test Loss: 1.582 Test Acc: 0.864
Validation loss decreased (-0.844002 --> -0.863494).  Saving model ...
Epoch: 8 cost time: 29.507001399993896
Epoch: 8, Steps: 89 | Train Loss: 0.687 Vali Loss: 2.212 Vali Acc: 0.793 Test Loss: 2.212 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.734960556030273
Epoch: 9, Steps: 89 | Train Loss: 0.736 Vali Loss: 2.415 Vali Acc: 0.863 Test Loss: 2.415 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 32.66921544075012
Epoch: 10, Steps: 89 | Train Loss: 0.871 Vali Loss: 1.993 Vali Acc: 0.846 Test Loss: 1.993 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 30.537455558776855
Epoch: 11, Steps: 89 | Train Loss: 1.160 Vali Loss: 1.601 Vali Acc: 0.882 Test Loss: 1.601 Test Acc: 0.882
Validation loss decreased (-0.863494 --> -0.882296).  Saving model ...
Epoch: 12 cost time: 32.61751580238342
Epoch: 12, Steps: 89 | Train Loss: 0.922 Vali Loss: 1.903 Vali Acc: 0.881 Test Loss: 1.903 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 33.099716663360596
Epoch: 13, Steps: 89 | Train Loss: 1.082 Vali Loss: 1.096 Vali Acc: 0.905 Test Loss: 1.096 Test Acc: 0.905
Validation loss decreased (-0.882296 --> -0.905282).  Saving model ...
Epoch: 14 cost time: 29.72282600402832
Epoch: 14, Steps: 89 | Train Loss: 0.829 Vali Loss: 0.977 Vali Acc: 0.925 Test Loss: 0.977 Test Acc: 0.925
Validation loss decreased (-0.905282 --> -0.925478).  Saving model ...
Epoch: 15 cost time: 31.54115915298462
Epoch: 15, Steps: 89 | Train Loss: 0.941 Vali Loss: 1.454 Vali Acc: 0.909 Test Loss: 1.454 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 32.009132623672485
Epoch: 16, Steps: 89 | Train Loss: 0.916 Vali Loss: 1.170 Vali Acc: 0.925 Test Loss: 1.170 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 29.44515061378479
Epoch: 17, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.715 Vali Acc: 0.955 Test Loss: 0.715 Test Acc: 0.955
Validation loss decreased (-0.925478 --> -0.954728).  Saving model ...
Epoch: 18 cost time: 30.625155448913574
Epoch: 18, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.967 Vali Acc: 0.931 Test Loss: 0.967 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 30.253718376159668
Epoch: 19, Steps: 89 | Train Loss: 0.315 Vali Loss: 1.598 Vali Acc: 0.920 Test Loss: 1.598 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 30.023743629455566
Epoch: 20, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.834 Vali Acc: 0.942 Test Loss: 0.834 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 30.852303504943848
Epoch: 21, Steps: 89 | Train Loss: 0.323 Vali Loss: 1.313 Vali Acc: 0.904 Test Loss: 1.313 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 30.228328466415405
Epoch: 22, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.658 Vali Acc: 0.937 Test Loss: 0.658 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 29.780879974365234
Epoch: 23, Steps: 89 | Train Loss: 0.273 Vali Loss: 1.618 Vali Acc: 0.916 Test Loss: 1.618 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 31.126854181289673
Epoch: 24, Steps: 89 | Train Loss: 0.237 Vali Loss: 1.024 Vali Acc: 0.926 Test Loss: 1.024 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 30.31925392150879
Epoch: 25, Steps: 89 | Train Loss: 0.393 Vali Loss: 1.024 Vali Acc: 0.925 Test Loss: 1.024 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 29.987152338027954
Epoch: 26, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.919 Vali Acc: 0.925 Test Loss: 0.919 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 30.82101011276245
Epoch: 27, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.581 Vali Acc: 0.943 Test Loss: 0.581 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9547353760445683
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 31.86455535888672
Epoch: 1, Steps: 89 | Train Loss: 1.450 Vali Loss: 1.541 Vali Acc: 0.641 Test Loss: 1.541 Test Acc: 0.641
Validation loss decreased (inf --> -0.640653).  Saving model ...
Epoch: 2 cost time: 30.671593189239502
Epoch: 2, Steps: 89 | Train Loss: 0.384 Vali Loss: 2.224 Vali Acc: 0.663 Test Loss: 2.224 Test Acc: 0.663
Validation loss decreased (-0.640653 --> -0.662930).  Saving model ...
Epoch: 3 cost time: 30.57887554168701
Epoch: 3, Steps: 89 | Train Loss: 0.356 Vali Loss: 1.699 Vali Acc: 0.703 Test Loss: 1.699 Test Acc: 0.703
Validation loss decreased (-0.662930 --> -0.703326).  Saving model ...
Epoch: 4 cost time: 28.734317302703857
Epoch: 4, Steps: 89 | Train Loss: 0.329 Vali Loss: 2.373 Vali Acc: 0.724 Test Loss: 2.373 Test Acc: 0.724
Validation loss decreased (-0.703326 --> -0.723514).  Saving model ...
Epoch: 5 cost time: 30.607107400894165
Epoch: 5, Steps: 89 | Train Loss: 0.381 Vali Loss: 2.197 Vali Acc: 0.741 Test Loss: 2.197 Test Acc: 0.741
Validation loss decreased (-0.723514 --> -0.740925).  Saving model ...
Epoch: 6 cost time: 30.897385835647583
Epoch: 6, Steps: 89 | Train Loss: 0.472 Vali Loss: 3.718 Vali Acc: 0.646 Test Loss: 3.718 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 29.229337692260742
Epoch: 7, Steps: 89 | Train Loss: 0.703 Vali Loss: 3.568 Vali Acc: 0.692 Test Loss: 3.568 Test Acc: 0.692
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 28.235208988189697
Epoch: 8, Steps: 89 | Train Loss: 0.690 Vali Loss: 3.068 Vali Acc: 0.752 Test Loss: 3.068 Test Acc: 0.752
Validation loss decreased (-0.740925 --> -0.752058).  Saving model ...
Epoch: 9 cost time: 29.911209106445312
Epoch: 9, Steps: 89 | Train Loss: 0.797 Vali Loss: 3.410 Vali Acc: 0.743 Test Loss: 3.410 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 31.071422338485718
Epoch: 10, Steps: 89 | Train Loss: 0.967 Vali Loss: 3.563 Vali Acc: 0.746 Test Loss: 3.563 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 30.632293224334717
Epoch: 11, Steps: 89 | Train Loss: 1.269 Vali Loss: 3.448 Vali Acc: 0.816 Test Loss: 3.448 Test Acc: 0.816
Validation loss decreased (-0.752058 --> -0.816122).  Saving model ...
Epoch: 12 cost time: 29.51755428314209
Epoch: 12, Steps: 89 | Train Loss: 1.415 Vali Loss: 2.704 Vali Acc: 0.840 Test Loss: 2.704 Test Acc: 0.840
Validation loss decreased (-0.816122 --> -0.839806).  Saving model ...
Epoch: 13 cost time: 24.406903505325317
Epoch: 13, Steps: 89 | Train Loss: 1.304 Vali Loss: 2.003 Vali Acc: 0.890 Test Loss: 2.003 Test Acc: 0.890
Validation loss decreased (-0.839806 --> -0.889952).  Saving model ...
Epoch: 14 cost time: 30.96687126159668
Epoch: 14, Steps: 89 | Train Loss: 1.141 Vali Loss: 1.075 Vali Acc: 0.901 Test Loss: 1.075 Test Acc: 0.901
Validation loss decreased (-0.889952 --> -0.901103).  Saving model ...
Epoch: 15 cost time: 28.89092707633972
Epoch: 15, Steps: 89 | Train Loss: 0.739 Vali Loss: 1.592 Vali Acc: 0.877 Test Loss: 1.592 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 30.011197805404663
Epoch: 16, Steps: 89 | Train Loss: 0.743 Vali Loss: 1.617 Vali Acc: 0.874 Test Loss: 1.617 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 29.29313898086548
Epoch: 17, Steps: 89 | Train Loss: 0.679 Vali Loss: 0.961 Vali Acc: 0.944 Test Loss: 0.961 Test Acc: 0.944
Validation loss decreased (-0.901103 --> -0.943584).  Saving model ...
Epoch: 18 cost time: 28.649749517440796
Epoch: 18, Steps: 89 | Train Loss: 0.576 Vali Loss: 0.626 Vali Acc: 0.950 Test Loss: 0.626 Test Acc: 0.950
Validation loss decreased (-0.943584 --> -0.949854).  Saving model ...
Epoch: 19 cost time: 29.35536241531372
Epoch: 19, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.776 Vali Acc: 0.951 Test Loss: 0.776 Test Acc: 0.951
Validation loss decreased (-0.949854 --> -0.950549).  Saving model ...
Epoch: 20 cost time: 28.54287576675415
Epoch: 20, Steps: 89 | Train Loss: 0.325 Vali Loss: 1.422 Vali Acc: 0.925 Test Loss: 1.422 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 28.653449296951294
Epoch: 21, Steps: 89 | Train Loss: 0.457 Vali Loss: 1.410 Vali Acc: 0.914 Test Loss: 1.410 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 30.481005907058716
Epoch: 22, Steps: 89 | Train Loss: 0.486 Vali Loss: 1.634 Vali Acc: 0.902 Test Loss: 1.634 Test Acc: 0.902
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 30.245314836502075
Epoch: 23, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.694 Vali Acc: 0.941 Test Loss: 0.694 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 28.252660274505615
Epoch: 24, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.929 Vali Acc: 0.939 Test Loss: 0.929 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 30.960389137268066
Epoch: 25, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.650 Vali Acc: 0.947 Test Loss: 0.650 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 29.313743829727173
Epoch: 26, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.617 Vali Acc: 0.948 Test Loss: 0.617 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 29.341362476348877
Epoch: 27, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.858 Vali Acc: 0.937 Test Loss: 0.858 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 30.409942388534546
Epoch: 28, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.712 Vali Acc: 0.944 Test Loss: 0.712 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 30.488940000534058
Epoch: 29, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.665 Vali Acc: 0.944 Test Loss: 0.665 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9505571030640668
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 31.088913202285767
Epoch: 1, Steps: 89 | Train Loss: 1.466 Vali Loss: 1.947 Vali Acc: 0.602 Test Loss: 1.947 Test Acc: 0.602
Validation loss decreased (inf --> -0.602348).  Saving model ...
Epoch: 2 cost time: 30.104756355285645
Epoch: 2, Steps: 89 | Train Loss: 0.392 Vali Loss: 2.652 Vali Acc: 0.666 Test Loss: 2.652 Test Acc: 0.666
Validation loss decreased (-0.602348 --> -0.666408).  Saving model ...
Epoch: 3 cost time: 28.51029396057129
Epoch: 3, Steps: 89 | Train Loss: 0.343 Vali Loss: 1.287 Vali Acc: 0.784 Test Loss: 1.287 Test Acc: 0.784
Validation loss decreased (-0.666408 --> -0.784110).  Saving model ...
Epoch: 4 cost time: 29.733924865722656
Epoch: 4, Steps: 89 | Train Loss: 0.415 Vali Loss: 1.878 Vali Acc: 0.746 Test Loss: 1.878 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.183217525482178
Epoch: 5, Steps: 89 | Train Loss: 0.376 Vali Loss: 2.208 Vali Acc: 0.788 Test Loss: 2.208 Test Acc: 0.788
Validation loss decreased (-0.784110 --> -0.788279).  Saving model ...
Epoch: 6 cost time: 28.60030221939087
Epoch: 6, Steps: 89 | Train Loss: 0.687 Vali Loss: 2.570 Vali Acc: 0.721 Test Loss: 2.570 Test Acc: 0.721
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 29.42635226249695
Epoch: 7, Steps: 89 | Train Loss: 0.851 Vali Loss: 2.264 Vali Acc: 0.733 Test Loss: 2.264 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 30.946988582611084
Epoch: 8, Steps: 89 | Train Loss: 0.775 Vali Loss: 2.754 Vali Acc: 0.765 Test Loss: 2.754 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 28.021891593933105
Epoch: 9, Steps: 89 | Train Loss: 0.835 Vali Loss: 2.344 Vali Acc: 0.788 Test Loss: 2.344 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 29.530000925064087
Epoch: 10, Steps: 89 | Train Loss: 0.875 Vali Loss: 3.213 Vali Acc: 0.828 Test Loss: 3.213 Test Acc: 0.828
Validation loss decreased (-0.788279 --> -0.827962).  Saving model ...
Epoch: 11 cost time: 30.27715039253235
Epoch: 11, Steps: 89 | Train Loss: 1.019 Vali Loss: 3.726 Vali Acc: 0.790 Test Loss: 3.726 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 29.230889797210693
Epoch: 12, Steps: 89 | Train Loss: 1.016 Vali Loss: 3.754 Vali Acc: 0.760 Test Loss: 3.754 Test Acc: 0.760
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 30.176506757736206
Epoch: 13, Steps: 89 | Train Loss: 1.088 Vali Loss: 2.159 Vali Acc: 0.875 Test Loss: 2.159 Test Acc: 0.875
Validation loss decreased (-0.827962 --> -0.875327).  Saving model ...
Epoch: 14 cost time: 29.495906591415405
Epoch: 14, Steps: 89 | Train Loss: 1.298 Vali Loss: 2.841 Vali Acc: 0.873 Test Loss: 2.841 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 29.09260392189026
Epoch: 15, Steps: 89 | Train Loss: 1.167 Vali Loss: 3.311 Vali Acc: 0.880 Test Loss: 3.311 Test Acc: 0.880
Validation loss decreased (-0.875327 --> -0.880190).  Saving model ...
Epoch: 16 cost time: 29.79047703742981
Epoch: 16, Steps: 89 | Train Loss: 0.994 Vali Loss: 1.406 Vali Acc: 0.910 Test Loss: 1.406 Test Acc: 0.910
Validation loss decreased (-0.880190 --> -0.910153).  Saving model ...
Epoch: 17 cost time: 30.77054715156555
Epoch: 17, Steps: 89 | Train Loss: 0.557 Vali Loss: 1.362 Vali Acc: 0.903 Test Loss: 1.362 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 29.88604736328125
Epoch: 18, Steps: 89 | Train Loss: 0.474 Vali Loss: 1.074 Vali Acc: 0.923 Test Loss: 1.074 Test Acc: 0.923
Validation loss decreased (-0.910153 --> -0.923388).  Saving model ...
Epoch: 19 cost time: 30.21283745765686
Epoch: 19, Steps: 89 | Train Loss: 0.405 Vali Loss: 1.163 Vali Acc: 0.924 Test Loss: 1.163 Test Acc: 0.924
Validation loss decreased (-0.923388 --> -0.924083).  Saving model ...
Epoch: 20 cost time: 30.97360348701477
Epoch: 20, Steps: 89 | Train Loss: 0.440 Vali Loss: 1.077 Vali Acc: 0.949 Test Loss: 1.077 Test Acc: 0.949
Validation loss decreased (-0.924083 --> -0.949154).  Saving model ...
Epoch: 21 cost time: 29.53495454788208
Epoch: 21, Steps: 89 | Train Loss: 0.283 Vali Loss: 1.095 Vali Acc: 0.946 Test Loss: 1.095 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 30.387892961502075
Epoch: 22, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.957 Vali Acc: 0.942 Test Loss: 0.957 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 31.45840549468994
Epoch: 23, Steps: 89 | Train Loss: 0.410 Vali Loss: 0.970 Vali Acc: 0.944 Test Loss: 0.970 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 27.920869827270508
Epoch: 24, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.735 Vali Acc: 0.948 Test Loss: 0.735 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 25.8184974193573
Epoch: 25, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.843 Vali Acc: 0.943 Test Loss: 0.843 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 31.23777747154236
Epoch: 26, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.718 Vali Acc: 0.937 Test Loss: 0.718 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 29.226516246795654
Epoch: 27, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.829 Vali Acc: 0.940 Test Loss: 0.829 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 30.14226269721985
Epoch: 28, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.936 Vali Acc: 0.928 Test Loss: 0.936 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 30.772429943084717
Epoch: 29, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.664 Vali Acc: 0.947 Test Loss: 0.664 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 29.146921634674072
Epoch: 30, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.606 Vali Acc: 0.955 Test Loss: 0.606 Test Acc: 0.955
Validation loss decreased (-0.949154 --> -0.955426).  Saving model ...
Epoch: 31 cost time: 32.10609006881714
Epoch: 31, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.897 Vali Acc: 0.930 Test Loss: 0.897 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 31.072406768798828
Epoch: 32, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.780 Vali Acc: 0.950 Test Loss: 0.780 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 28.701801776885986
Epoch: 33, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.663 Vali Acc: 0.947 Test Loss: 0.663 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 30.78868007659912
Epoch: 34, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.645 Vali Acc: 0.961 Test Loss: 0.645 Test Acc: 0.961
Validation loss decreased (-0.955426 --> -0.960996).  Saving model ...
Epoch: 35 cost time: 30.279043674468994
Epoch: 35, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.678 Vali Acc: 0.947 Test Loss: 0.678 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 29.690603256225586
Epoch: 36, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.889 Vali Acc: 0.942 Test Loss: 0.889 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 31.52286458015442
Epoch: 37, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.558 Vali Acc: 0.958 Test Loss: 0.558 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 31.322942972183228
Epoch: 38, Steps: 89 | Train Loss: 0.141 Vali Loss: 1.018 Vali Acc: 0.925 Test Loss: 1.018 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 28.967317819595337
Epoch: 39, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.661 Vali Acc: 0.955 Test Loss: 0.661 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 30.90998411178589
Epoch: 40, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.660 Vali Acc: 0.957 Test Loss: 0.660 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 30.863168239593506
Epoch: 41, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.580 Vali Acc: 0.953 Test Loss: 0.580 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 28.326347589492798
Epoch: 42, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.589 Vali Acc: 0.957 Test Loss: 0.589 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 30.81692409515381
Epoch: 43, Steps: 89 | Train Loss: 0.177 Vali Loss: 1.205 Vali Acc: 0.923 Test Loss: 1.205 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 30.631866931915283
Epoch: 44, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.500 Vali Acc: 0.962 Test Loss: 0.500 Test Acc: 0.962
Validation loss decreased (-0.960996 --> -0.961694).  Saving model ...
Epoch: 45 cost time: 28.890644311904907
Epoch: 45, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.415 Vali Acc: 0.970 Test Loss: 0.415 Test Acc: 0.970
Validation loss decreased (-0.961694 --> -0.970052).  Saving model ...
Epoch: 46 cost time: 30.760332345962524
Epoch: 46, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.387 Vali Acc: 0.966 Test Loss: 0.387 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 29.869635105133057
Epoch: 47, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.541 Vali Acc: 0.960 Test Loss: 0.541 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 29.170615911483765
Epoch: 48, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.478 Vali Acc: 0.963 Test Loss: 0.478 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 28.18552327156067
Epoch: 49, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.978 Vali Acc: 0.925 Test Loss: 0.978 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 30.356315851211548
Epoch: 50, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.563 Vali Acc: 0.957 Test Loss: 0.563 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 28.495395183563232
Epoch: 51, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.573 Vali Acc: 0.952 Test Loss: 0.573 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 30.883490562438965
Epoch: 52, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.548 Vali Acc: 0.954 Test Loss: 0.548 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 30.48675537109375
Epoch: 53, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.484 Vali Acc: 0.961 Test Loss: 0.484 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 27.889776468276978
Epoch: 54, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.498 Vali Acc: 0.953 Test Loss: 0.498 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 30.554811716079712
Epoch: 55, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.627 Vali Acc: 0.958 Test Loss: 0.627 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 30.21848154067993
Epoch: 1, Steps: 89 | Train Loss: 1.501 Vali Loss: 1.759 Vali Acc: 0.652 Test Loss: 1.759 Test Acc: 0.652
Validation loss decreased (inf --> -0.651793).  Saving model ...
Epoch: 2 cost time: 28.416621923446655
Epoch: 2, Steps: 89 | Train Loss: 0.410 Vali Loss: 2.049 Vali Acc: 0.683 Test Loss: 2.049 Test Acc: 0.683
Validation loss decreased (-0.651793 --> -0.683127).  Saving model ...
Epoch: 3 cost time: 28.949560165405273
Epoch: 3, Steps: 89 | Train Loss: 0.399 Vali Loss: 1.602 Vali Acc: 0.737 Test Loss: 1.602 Test Acc: 0.737
Validation loss decreased (-0.683127 --> -0.736753).  Saving model ...
Epoch: 4 cost time: 28.14766502380371
Epoch: 4, Steps: 89 | Train Loss: 0.361 Vali Loss: 2.373 Vali Acc: 0.768 Test Loss: 2.373 Test Acc: 0.768
Validation loss decreased (-0.736753 --> -0.768082).  Saving model ...
Epoch: 5 cost time: 28.439194917678833
Epoch: 5, Steps: 89 | Train Loss: 0.443 Vali Loss: 2.569 Vali Acc: 0.733 Test Loss: 2.569 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.470181941986084
Epoch: 6, Steps: 89 | Train Loss: 0.529 Vali Loss: 2.521 Vali Acc: 0.723 Test Loss: 2.521 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 29.71364426612854
Epoch: 7, Steps: 89 | Train Loss: 0.874 Vali Loss: 2.750 Vali Acc: 0.749 Test Loss: 2.750 Test Acc: 0.749
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.971802949905396
Epoch: 8, Steps: 89 | Train Loss: 1.207 Vali Loss: 2.531 Vali Acc: 0.825 Test Loss: 2.531 Test Acc: 0.825
Validation loss decreased (-0.768082 --> -0.824487).  Saving model ...
Epoch: 9 cost time: 25.946430921554565
Epoch: 9, Steps: 89 | Train Loss: 1.090 Vali Loss: 3.916 Vali Acc: 0.734 Test Loss: 3.916 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 30.12300181388855
Epoch: 10, Steps: 89 | Train Loss: 1.007 Vali Loss: 1.627 Vali Acc: 0.868 Test Loss: 1.627 Test Acc: 0.868
Validation loss decreased (-0.824487 --> -0.867672).  Saving model ...
Epoch: 11 cost time: 28.428140878677368
Epoch: 11, Steps: 89 | Train Loss: 1.165 Vali Loss: 1.569 Vali Acc: 0.882 Test Loss: 1.569 Test Acc: 0.882
Validation loss decreased (-0.867672 --> -0.881600).  Saving model ...
Epoch: 12 cost time: 30.355457544326782
Epoch: 12, Steps: 89 | Train Loss: 1.191 Vali Loss: 1.290 Vali Acc: 0.902 Test Loss: 1.290 Test Acc: 0.902
Validation loss decreased (-0.881600 --> -0.901798).  Saving model ...
Epoch: 13 cost time: 29.58993935585022
Epoch: 13, Steps: 89 | Train Loss: 0.785 Vali Loss: 1.029 Vali Acc: 0.907 Test Loss: 1.029 Test Acc: 0.907
Validation loss decreased (-0.901798 --> -0.906675).  Saving model ...
Epoch: 14 cost time: 28.609286308288574
Epoch: 14, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.860 Vali Acc: 0.932 Test Loss: 0.860 Test Acc: 0.932
Validation loss decreased (-0.906675 --> -0.931746).  Saving model ...
Epoch: 15 cost time: 26.989583253860474
Epoch: 15, Steps: 89 | Train Loss: 0.428 Vali Loss: 1.252 Vali Acc: 0.901 Test Loss: 1.252 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 28.774293661117554
Epoch: 16, Steps: 89 | Train Loss: 0.420 Vali Loss: 1.224 Vali Acc: 0.880 Test Loss: 1.224 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 29.62750816345215
Epoch: 17, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.892 Vali Acc: 0.924 Test Loss: 0.892 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 28.28025460243225
Epoch: 18, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.914 Vali Acc: 0.925 Test Loss: 0.914 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 28.929075956344604
Epoch: 19, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.818 Vali Acc: 0.928 Test Loss: 0.818 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 28.960853099822998
Epoch: 20, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.726 Vali Acc: 0.937 Test Loss: 0.726 Test Acc: 0.937
Validation loss decreased (-0.931746 --> -0.937319).  Saving model ...
Epoch: 21 cost time: 28.62697410583496
Epoch: 21, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.757 Vali Acc: 0.918 Test Loss: 0.757 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 29.11328935623169
Epoch: 22, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.722 Vali Acc: 0.906 Test Loss: 0.722 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 29.47762632369995
Epoch: 23, Steps: 89 | Train Loss: 0.315 Vali Loss: 1.153 Vali Acc: 0.907 Test Loss: 1.153 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 28.133373022079468
Epoch: 24, Steps: 89 | Train Loss: 0.495 Vali Loss: 1.496 Vali Acc: 0.910 Test Loss: 1.496 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 28.946141242980957
Epoch: 25, Steps: 89 | Train Loss: 0.520 Vali Loss: 0.770 Vali Acc: 0.928 Test Loss: 0.770 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 29.324331283569336
Epoch: 26, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.857 Vali Acc: 0.936 Test Loss: 0.857 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 29.735900163650513
Epoch: 27, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.782 Vali Acc: 0.936 Test Loss: 0.782 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 28.396523475646973
Epoch: 28, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.844 Vali Acc: 0.913 Test Loss: 0.844 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 29.595932483673096
Epoch: 29, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.635 Vali Acc: 0.942 Test Loss: 0.635 Test Acc: 0.942
Validation loss decreased (-0.937319 --> -0.942194).  Saving model ...
Epoch: 30 cost time: 29.20966362953186
Epoch: 30, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.551 Vali Acc: 0.955 Test Loss: 0.551 Test Acc: 0.955
Validation loss decreased (-0.942194 --> -0.955426).  Saving model ...
Epoch: 31 cost time: 28.301188707351685
Epoch: 31, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.668 Vali Acc: 0.942 Test Loss: 0.668 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 30.037997007369995
Epoch: 32, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.479 Vali Acc: 0.952 Test Loss: 0.479 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 29.21701979637146
Epoch: 33, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.549 Vali Acc: 0.957 Test Loss: 0.549 Test Acc: 0.957
Validation loss decreased (-0.955426 --> -0.956819).  Saving model ...
Epoch: 34 cost time: 28.483925580978394
Epoch: 34, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.959 Vali Acc: 0.926 Test Loss: 0.959 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 29.664748907089233
Epoch: 35, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.523 Vali Acc: 0.948 Test Loss: 0.523 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 30.04303240776062
Epoch: 36, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.621 Vali Acc: 0.950 Test Loss: 0.621 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 28.945679664611816
Epoch: 37, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.600 Vali Acc: 0.946 Test Loss: 0.600 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 30.25505256652832
Epoch: 38, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.836 Vali Acc: 0.927 Test Loss: 0.836 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 30.001204013824463
Epoch: 39, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.560 Vali Acc: 0.949 Test Loss: 0.560 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 29.778061389923096
Epoch: 40, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.761 Vali Acc: 0.936 Test Loss: 0.761 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 30.53859806060791
Epoch: 41, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.677 Vali Acc: 0.948 Test Loss: 0.677 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 29.739346504211426
Epoch: 42, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.528 Vali Acc: 0.955 Test Loss: 0.528 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 29.09071159362793
Epoch: 43, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.571 Vali Acc: 0.955 Test Loss: 0.571 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 30.895151615142822
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.065 Test Loss: 2.996 Test Acc: 0.065
Validation loss decreased (inf --> -0.064733).  Saving model ...
Epoch: 2 cost time: 26.20454692840576
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 27.226988792419434
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 30.02140498161316
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 28.129466772079468
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 29.255156755447388
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 29.759076595306396
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 28.422131061553955
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 29.49636936187744
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 29.616851568222046
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 28.388309955596924
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 29.77040386199951
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 29.573331832885742
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 27.543128967285156
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 30.12995934486389
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 29.781257152557373
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 28.171663522720337
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 30.47693634033203
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 30.39222502708435
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 28.359264135360718
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 26.2008056640625
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 29.45130681991577
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 29.234591245651245
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 30.4836642742157
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 29.68131971359253
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 27.90219736099243
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 29.72283387184143
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 30.3838849067688
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 28.52841353416443
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 30.31619906425476
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 29.653465747833252
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 28.339722871780396
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 29.728824853897095
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 30.08888840675354
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 28.450215101242065
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 29.562268257141113
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 29.796062231063843
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 26.002113580703735
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 29.013166904449463
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 29.133416414260864
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 27.762954711914062
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 29.926735401153564
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 29.221951961517334
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 28.211052894592285
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 30.51162028312683
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 30.730119228363037
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 28.934213638305664
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 30.041590929031372
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 29.38854169845581
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 29.029356718063354
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 30.207356214523315
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 30.24664616584778
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 28.50017547607422
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 30.359272956848145
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 30.126753330230713
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 28.156378269195557
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 30.904111623764038
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 30.047083139419556
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 27.950120210647583
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 26.497620344161987
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 61 cost time: 26.587135314941406
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 24.095577239990234
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 30.756579875946045
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 64 cost time: 28.821781635284424
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 65 cost time: 30.61619806289673
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 29.73861575126648
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 27.277916193008423
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 29.411840200424194
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 29.115031003952026
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 28.137534856796265
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 29.31531310081482
Epoch: 71, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 72 cost time: 28.249420642852783
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 28.583024740219116
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 29.046264171600342
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 29.0583393573761
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 28.09504199028015
Epoch: 76, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 27.74534273147583
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 29.396709442138672
Epoch: 78, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 28.188223123550415
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 29.705132722854614
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 29.294501066207886
Epoch: 81, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 15524884
model size : 78.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 32.32988977432251
Epoch: 1, Steps: 89 | Train Loss: 1.020 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (inf --> -0.849576).  Saving model ...
Epoch: 2 cost time: 30.11482334136963
Epoch: 2, Steps: 89 | Train Loss: 0.611 Vali Loss: 0.793 Vali Acc: 0.860 Test Loss: 0.793 Test Acc: 0.860
Validation loss decreased (-0.849576 --> -0.860020).  Saving model ...
Epoch: 3 cost time: 28.66682004928589
Epoch: 3, Steps: 89 | Train Loss: 0.543 Vali Loss: 0.672 Vali Acc: 0.912 Test Loss: 0.672 Test Acc: 0.912
Validation loss decreased (-0.860020 --> -0.912250).  Saving model ...
Epoch: 4 cost time: 30.03284502029419
Epoch: 4, Steps: 89 | Train Loss: 0.592 Vali Loss: 0.866 Vali Acc: 0.886 Test Loss: 0.866 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.189281225204468
Epoch: 5, Steps: 89 | Train Loss: 0.604 Vali Loss: 0.912 Vali Acc: 0.909 Test Loss: 0.912 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.713279247283936
Epoch: 6, Steps: 89 | Train Loss: 0.713 Vali Loss: 1.617 Vali Acc: 0.875 Test Loss: 1.617 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 31.457093238830566
Epoch: 7, Steps: 89 | Train Loss: 0.856 Vali Loss: 0.811 Vali Acc: 0.931 Test Loss: 0.811 Test Acc: 0.931
Validation loss decreased (-0.912250 --> -0.931050).  Saving model ...
Epoch: 8 cost time: 30.59680938720703
Epoch: 8, Steps: 89 | Train Loss: 0.633 Vali Loss: 1.561 Vali Acc: 0.903 Test Loss: 1.561 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 28.64060378074646
Epoch: 9, Steps: 89 | Train Loss: 0.721 Vali Loss: 1.039 Vali Acc: 0.908 Test Loss: 1.039 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.16339087486267
Epoch: 10, Steps: 89 | Train Loss: 0.508 Vali Loss: 1.568 Vali Acc: 0.882 Test Loss: 1.568 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 30.78209948539734
Epoch: 11, Steps: 89 | Train Loss: 0.353 Vali Loss: 1.157 Vali Acc: 0.926 Test Loss: 1.157 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 28.35720467567444
Epoch: 12, Steps: 89 | Train Loss: 0.518 Vali Loss: 1.015 Vali Acc: 0.919 Test Loss: 1.015 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 31.092783451080322
Epoch: 13, Steps: 89 | Train Loss: 0.619 Vali Loss: 1.245 Vali Acc: 0.923 Test Loss: 1.245 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 31.55803632736206
Epoch: 14, Steps: 89 | Train Loss: 0.655 Vali Loss: 1.688 Vali Acc: 0.905 Test Loss: 1.688 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 29.69358491897583
Epoch: 15, Steps: 89 | Train Loss: 0.588 Vali Loss: 1.623 Vali Acc: 0.899 Test Loss: 1.623 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 31.65045738220215
Epoch: 16, Steps: 89 | Train Loss: 0.820 Vali Loss: 1.025 Vali Acc: 0.924 Test Loss: 1.025 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 30.737717390060425
Epoch: 17, Steps: 89 | Train Loss: 0.639 Vali Loss: 1.093 Vali Acc: 0.926 Test Loss: 1.093 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9310584958217271
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 30.908541440963745
Epoch: 1, Steps: 89 | Train Loss: 1.106 Vali Loss: 0.749 Vali Acc: 0.847 Test Loss: 0.749 Test Acc: 0.847
Validation loss decreased (inf --> -0.846789).  Saving model ...
Epoch: 2 cost time: 29.190694093704224
Epoch: 2, Steps: 89 | Train Loss: 0.670 Vali Loss: 0.841 Vali Acc: 0.822 Test Loss: 0.841 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.859715700149536
Epoch: 3, Steps: 89 | Train Loss: 0.665 Vali Loss: 1.112 Vali Acc: 0.867 Test Loss: 1.112 Test Acc: 0.867
Validation loss decreased (-0.846789 --> -0.866981).  Saving model ...
Epoch: 4 cost time: 29.637163877487183
Epoch: 4, Steps: 89 | Train Loss: 0.651 Vali Loss: 0.942 Vali Acc: 0.886 Test Loss: 0.942 Test Acc: 0.886
Validation loss decreased (-0.866981 --> -0.885784).  Saving model ...
Epoch: 5 cost time: 29.96626091003418
Epoch: 5, Steps: 89 | Train Loss: 0.672 Vali Loss: 1.519 Vali Acc: 0.829 Test Loss: 1.519 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.955824613571167
Epoch: 6, Steps: 89 | Train Loss: 0.665 Vali Loss: 1.756 Vali Acc: 0.833 Test Loss: 1.756 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.798864126205444
Epoch: 7, Steps: 89 | Train Loss: 0.835 Vali Loss: 1.502 Vali Acc: 0.855 Test Loss: 1.502 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 25.508368730545044
Epoch: 8, Steps: 89 | Train Loss: 0.540 Vali Loss: 0.937 Vali Acc: 0.913 Test Loss: 0.937 Test Acc: 0.913
Validation loss decreased (-0.885784 --> -0.912943).  Saving model ...
Epoch: 9 cost time: 30.74465012550354
Epoch: 9, Steps: 89 | Train Loss: 0.646 Vali Loss: 1.393 Vali Acc: 0.864 Test Loss: 1.393 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 31.11718726158142
Epoch: 10, Steps: 89 | Train Loss: 0.548 Vali Loss: 2.821 Vali Acc: 0.810 Test Loss: 2.821 Test Acc: 0.810
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 28.56239604949951
Epoch: 11, Steps: 89 | Train Loss: 0.674 Vali Loss: 1.231 Vali Acc: 0.894 Test Loss: 1.231 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 31.5077862739563
Epoch: 12, Steps: 89 | Train Loss: 0.534 Vali Loss: 1.369 Vali Acc: 0.897 Test Loss: 1.369 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 30.824016571044922
Epoch: 13, Steps: 89 | Train Loss: 0.561 Vali Loss: 1.115 Vali Acc: 0.905 Test Loss: 1.115 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 29.64198875427246
Epoch: 14, Steps: 89 | Train Loss: 0.487 Vali Loss: 0.846 Vali Acc: 0.933 Test Loss: 0.846 Test Acc: 0.933
Validation loss decreased (-0.912943 --> -0.933139).  Saving model ...
Epoch: 15 cost time: 31.53139853477478
Epoch: 15, Steps: 89 | Train Loss: 0.368 Vali Loss: 1.270 Vali Acc: 0.905 Test Loss: 1.270 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 30.092198610305786
Epoch: 16, Steps: 89 | Train Loss: 0.361 Vali Loss: 1.425 Vali Acc: 0.905 Test Loss: 1.425 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 30.388747692108154
Epoch: 17, Steps: 89 | Train Loss: 0.745 Vali Loss: 1.391 Vali Acc: 0.899 Test Loss: 1.391 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 30.916399002075195
Epoch: 18, Steps: 89 | Train Loss: 0.492 Vali Loss: 1.287 Vali Acc: 0.904 Test Loss: 1.287 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 28.986613750457764
Epoch: 19, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.920 Vali Acc: 0.939 Test Loss: 0.920 Test Acc: 0.939
Validation loss decreased (-0.933139 --> -0.939406).  Saving model ...
Epoch: 20 cost time: 30.636390447616577
Epoch: 20, Steps: 89 | Train Loss: 0.299 Vali Loss: 1.381 Vali Acc: 0.907 Test Loss: 1.381 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 31.398996829986572
Epoch: 21, Steps: 89 | Train Loss: 0.368 Vali Loss: 0.920 Vali Acc: 0.932 Test Loss: 0.920 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 28.86517834663391
Epoch: 22, Steps: 89 | Train Loss: 0.373 Vali Loss: 1.733 Vali Acc: 0.909 Test Loss: 1.733 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 30.791024446487427
Epoch: 23, Steps: 89 | Train Loss: 0.502 Vali Loss: 0.964 Vali Acc: 0.935 Test Loss: 0.964 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 31.135147094726562
Epoch: 24, Steps: 89 | Train Loss: 0.477 Vali Loss: 1.486 Vali Acc: 0.874 Test Loss: 1.486 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 28.603333711624146
Epoch: 25, Steps: 89 | Train Loss: 0.240 Vali Loss: 1.001 Vali Acc: 0.928 Test Loss: 1.001 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 31.39948844909668
Epoch: 26, Steps: 89 | Train Loss: 0.381 Vali Loss: 1.410 Vali Acc: 0.905 Test Loss: 1.410 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 31.729392528533936
Epoch: 27, Steps: 89 | Train Loss: 0.391 Vali Loss: 1.264 Vali Acc: 0.920 Test Loss: 1.264 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 28.999240398406982
Epoch: 28, Steps: 89 | Train Loss: 0.553 Vali Loss: 1.136 Vali Acc: 0.929 Test Loss: 1.136 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 31.47735571861267
Epoch: 29, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.776 Vali Acc: 0.935 Test Loss: 0.776 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9394150417827298
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.96455407142639
Epoch: 1, Steps: 89 | Train Loss: 1.189 Vali Loss: 0.938 Vali Acc: 0.794 Test Loss: 0.938 Test Acc: 0.794
Validation loss decreased (inf --> -0.793862).  Saving model ...
Epoch: 2 cost time: 29.08796000480652
Epoch: 2, Steps: 89 | Train Loss: 0.660 Vali Loss: 0.711 Vali Acc: 0.857 Test Loss: 0.711 Test Acc: 0.857
Validation loss decreased (-0.793862 --> -0.856539).  Saving model ...
Epoch: 3 cost time: 29.90685510635376
Epoch: 3, Steps: 89 | Train Loss: 0.610 Vali Loss: 0.786 Vali Acc: 0.871 Test Loss: 0.786 Test Acc: 0.871
Validation loss decreased (-0.856539 --> -0.871162).  Saving model ...
Epoch: 4 cost time: 27.83271884918213
Epoch: 4, Steps: 89 | Train Loss: 0.590 Vali Loss: 1.362 Vali Acc: 0.857 Test Loss: 1.362 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.128103017807007
Epoch: 5, Steps: 89 | Train Loss: 0.667 Vali Loss: 2.260 Vali Acc: 0.861 Test Loss: 2.260 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 29.417710781097412
Epoch: 6, Steps: 89 | Train Loss: 0.951 Vali Loss: 1.430 Vali Acc: 0.898 Test Loss: 1.430 Test Acc: 0.898
Validation loss decreased (-0.871162 --> -0.897618).  Saving model ...
Epoch: 7 cost time: 27.83550238609314
Epoch: 7, Steps: 89 | Train Loss: 0.668 Vali Loss: 1.304 Vali Acc: 0.873 Test Loss: 1.304 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 29.763216018676758
Epoch: 8, Steps: 89 | Train Loss: 0.710 Vali Loss: 1.072 Vali Acc: 0.899 Test Loss: 1.072 Test Acc: 0.899
Validation loss decreased (-0.897618 --> -0.899014).  Saving model ...
Epoch: 9 cost time: 30.743756771087646
Epoch: 9, Steps: 89 | Train Loss: 0.681 Vali Loss: 1.020 Vali Acc: 0.914 Test Loss: 1.020 Test Acc: 0.914
Validation loss decreased (-0.899014 --> -0.913639).  Saving model ...
Epoch: 10 cost time: 28.778034687042236
Epoch: 10, Steps: 89 | Train Loss: 0.683 Vali Loss: 0.977 Vali Acc: 0.917 Test Loss: 0.977 Test Acc: 0.917
Validation loss decreased (-0.913639 --> -0.917121).  Saving model ...
Epoch: 11 cost time: 30.98571228981018
Epoch: 11, Steps: 89 | Train Loss: 0.477 Vali Loss: 0.773 Vali Acc: 0.931 Test Loss: 0.773 Test Acc: 0.931
Validation loss decreased (-0.917121 --> -0.931051).  Saving model ...
Epoch: 12 cost time: 30.29550838470459
Epoch: 12, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.761 Vali Acc: 0.945 Test Loss: 0.761 Test Acc: 0.945
Validation loss decreased (-0.931051 --> -0.944978).  Saving model ...
Epoch: 13 cost time: 28.954951763153076
Epoch: 13, Steps: 89 | Train Loss: 0.449 Vali Loss: 1.087 Vali Acc: 0.932 Test Loss: 1.087 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 30.552290678024292
Epoch: 14, Steps: 89 | Train Loss: 0.507 Vali Loss: 1.209 Vali Acc: 0.915 Test Loss: 1.209 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 29.740370512008667
Epoch: 15, Steps: 89 | Train Loss: 0.625 Vali Loss: 1.211 Vali Acc: 0.905 Test Loss: 1.211 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 29.71550488471985
Epoch: 16, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.872 Vali Acc: 0.942 Test Loss: 0.872 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 30.007938146591187
Epoch: 17, Steps: 89 | Train Loss: 0.529 Vali Loss: 0.977 Vali Acc: 0.921 Test Loss: 0.977 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 29.623342514038086
Epoch: 18, Steps: 89 | Train Loss: 0.520 Vali Loss: 1.310 Vali Acc: 0.909 Test Loss: 1.310 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 30.136996030807495
Epoch: 19, Steps: 89 | Train Loss: 0.537 Vali Loss: 1.170 Vali Acc: 0.919 Test Loss: 1.170 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 30.61772632598877
Epoch: 20, Steps: 89 | Train Loss: 0.429 Vali Loss: 2.249 Vali Acc: 0.882 Test Loss: 2.249 Test Acc: 0.882
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 28.526637077331543
Epoch: 21, Steps: 89 | Train Loss: 0.603 Vali Loss: 1.549 Vali Acc: 0.880 Test Loss: 1.549 Test Acc: 0.880
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 30.220731019973755
Epoch: 22, Steps: 89 | Train Loss: 0.497 Vali Loss: 1.402 Vali Acc: 0.907 Test Loss: 1.402 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9449860724233984
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 30.72208070755005
Epoch: 1, Steps: 89 | Train Loss: 1.338 Vali Loss: 0.809 Vali Acc: 0.827 Test Loss: 0.809 Test Acc: 0.827
Validation loss decreased (inf --> -0.826594).  Saving model ...
Epoch: 2 cost time: 28.882210731506348
Epoch: 2, Steps: 89 | Train Loss: 0.540 Vali Loss: 0.833 Vali Acc: 0.844 Test Loss: 0.833 Test Acc: 0.844
Validation loss decreased (-0.826594 --> -0.844003).  Saving model ...
Epoch: 3 cost time: 30.26580834388733
Epoch: 3, Steps: 89 | Train Loss: 0.516 Vali Loss: 0.781 Vali Acc: 0.875 Test Loss: 0.781 Test Acc: 0.875
Validation loss decreased (-0.844003 --> -0.875340).  Saving model ...
Epoch: 4 cost time: 29.073358058929443
Epoch: 4, Steps: 89 | Train Loss: 0.620 Vali Loss: 1.121 Vali Acc: 0.861 Test Loss: 1.121 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.466325759887695
Epoch: 5, Steps: 89 | Train Loss: 0.528 Vali Loss: 1.258 Vali Acc: 0.898 Test Loss: 1.258 Test Acc: 0.898
Validation loss decreased (-0.875340 --> -0.897620).  Saving model ...
Epoch: 6 cost time: 29.407407522201538
Epoch: 6, Steps: 89 | Train Loss: 0.733 Vali Loss: 2.048 Vali Acc: 0.861 Test Loss: 2.048 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 28.959245443344116
Epoch: 7, Steps: 89 | Train Loss: 0.746 Vali Loss: 0.913 Vali Acc: 0.915 Test Loss: 0.913 Test Acc: 0.915
Validation loss decreased (-0.897620 --> -0.915033).  Saving model ...
Epoch: 8 cost time: 28.855608701705933
Epoch: 8, Steps: 89 | Train Loss: 0.638 Vali Loss: 1.227 Vali Acc: 0.900 Test Loss: 1.227 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 29.334792375564575
Epoch: 9, Steps: 89 | Train Loss: 0.740 Vali Loss: 1.426 Vali Acc: 0.887 Test Loss: 1.426 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 28.795153856277466
Epoch: 10, Steps: 89 | Train Loss: 0.903 Vali Loss: 1.230 Vali Acc: 0.916 Test Loss: 1.230 Test Acc: 0.916
Validation loss decreased (-0.915033 --> -0.916422).  Saving model ...
Epoch: 11 cost time: 29.015512704849243
Epoch: 11, Steps: 89 | Train Loss: 0.573 Vali Loss: 1.361 Vali Acc: 0.912 Test Loss: 1.361 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 29.785101652145386
Epoch: 12, Steps: 89 | Train Loss: 0.603 Vali Loss: 2.320 Vali Acc: 0.870 Test Loss: 2.320 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 27.577452421188354
Epoch: 13, Steps: 89 | Train Loss: 0.771 Vali Loss: 1.434 Vali Acc: 0.904 Test Loss: 1.434 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 29.39026713371277
Epoch: 14, Steps: 89 | Train Loss: 0.658 Vali Loss: 1.457 Vali Acc: 0.903 Test Loss: 1.457 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 29.818366289138794
Epoch: 15, Steps: 89 | Train Loss: 0.786 Vali Loss: 1.853 Vali Acc: 0.893 Test Loss: 1.853 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 26.955204963684082
Epoch: 16, Steps: 89 | Train Loss: 0.795 Vali Loss: 1.114 Vali Acc: 0.934 Test Loss: 1.114 Test Acc: 0.934
Validation loss decreased (-0.916422 --> -0.933833).  Saving model ...
Epoch: 17 cost time: 29.75993514060974
Epoch: 17, Steps: 89 | Train Loss: 0.747 Vali Loss: 1.187 Vali Acc: 0.926 Test Loss: 1.187 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 29.89374876022339
Epoch: 18, Steps: 89 | Train Loss: 0.654 Vali Loss: 1.794 Vali Acc: 0.909 Test Loss: 1.794 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 27.88460612297058
Epoch: 19, Steps: 89 | Train Loss: 0.384 Vali Loss: 1.310 Vali Acc: 0.927 Test Loss: 1.310 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 31.106271505355835
Epoch: 20, Steps: 89 | Train Loss: 0.409 Vali Loss: 2.094 Vali Acc: 0.892 Test Loss: 2.094 Test Acc: 0.892
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 30.692687273025513
Epoch: 21, Steps: 89 | Train Loss: 0.502 Vali Loss: 1.912 Vali Acc: 0.922 Test Loss: 1.912 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 28.60108232498169
Epoch: 22, Steps: 89 | Train Loss: 0.757 Vali Loss: 1.190 Vali Acc: 0.935 Test Loss: 1.190 Test Acc: 0.935
Validation loss decreased (-0.933833 --> -0.934528).  Saving model ...
Epoch: 23 cost time: 30.330701112747192
Epoch: 23, Steps: 89 | Train Loss: 0.616 Vali Loss: 1.265 Vali Acc: 0.928 Test Loss: 1.265 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 30.49455761909485
Epoch: 24, Steps: 89 | Train Loss: 0.634 Vali Loss: 1.420 Vali Acc: 0.919 Test Loss: 1.420 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 28.566086769104004
Epoch: 25, Steps: 89 | Train Loss: 0.726 Vali Loss: 1.107 Vali Acc: 0.923 Test Loss: 1.107 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 29.583083629608154
Epoch: 26, Steps: 89 | Train Loss: 0.550 Vali Loss: 1.120 Vali Acc: 0.928 Test Loss: 1.120 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 29.177741050720215
Epoch: 27, Steps: 89 | Train Loss: 0.756 Vali Loss: 0.686 Vali Acc: 0.921 Test Loss: 0.686 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 29.149502992630005
Epoch: 28, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.793 Vali Acc: 0.921 Test Loss: 0.793 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 29.900015354156494
Epoch: 29, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.561 Vali Acc: 0.944 Test Loss: 0.561 Test Acc: 0.944
Validation loss decreased (-0.934528 --> -0.943588).  Saving model ...
Epoch: 30 cost time: 28.668212890625
Epoch: 30, Steps: 89 | Train Loss: 0.467 Vali Loss: 1.242 Vali Acc: 0.893 Test Loss: 1.242 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 29.82517147064209
Epoch: 31, Steps: 89 | Train Loss: 0.431 Vali Loss: 1.042 Vali Acc: 0.877 Test Loss: 1.042 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 28.34283208847046
Epoch: 32, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.721 Vali Acc: 0.901 Test Loss: 0.721 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 27.501001834869385
Epoch: 33, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.493 Vali Acc: 0.924 Test Loss: 0.493 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 29.800278902053833
Epoch: 34, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.436 Vali Acc: 0.942 Test Loss: 0.436 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 29.265464305877686
Epoch: 35, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.548 Vali Acc: 0.935 Test Loss: 0.548 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 28.51925277709961
Epoch: 36, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.448 Vali Acc: 0.933 Test Loss: 0.448 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 29.687690019607544
Epoch: 37, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.507 Vali Acc: 0.945 Test Loss: 0.507 Test Acc: 0.945
Validation loss decreased (-0.943588 --> -0.944981).  Saving model ...
Epoch: 38 cost time: 29.677947282791138
Epoch: 38, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.495 Vali Acc: 0.933 Test Loss: 0.495 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 27.83098554611206
Epoch: 39, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 29.511767387390137
Epoch: 40, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.599 Vali Acc: 0.927 Test Loss: 0.599 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 29.366939783096313
Epoch: 41, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.629 Vali Acc: 0.924 Test Loss: 0.629 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 26.943015575408936
Epoch: 42, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.452 Vali Acc: 0.932 Test Loss: 0.452 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 26.81879687309265
Epoch: 43, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.449 Vali Acc: 0.940 Test Loss: 0.449 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 27.851913452148438
Epoch: 44, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.371 Vali Acc: 0.955 Test Loss: 0.371 Test Acc: 0.955
Validation loss decreased (-0.944981 --> -0.954732).  Saving model ...
Epoch: 45 cost time: 29.881628274917603
Epoch: 45, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.470 Vali Acc: 0.935 Test Loss: 0.470 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 29.870232582092285
Epoch: 46, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.597 Vali Acc: 0.921 Test Loss: 0.597 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 29.5925452709198
Epoch: 47, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.641 Vali Acc: 0.926 Test Loss: 0.641 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 30.750904083251953
Epoch: 48, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.269 Vali Acc: 0.965 Test Loss: 0.269 Test Acc: 0.965
Validation loss decreased (-0.954732 --> -0.965178).  Saving model ...
Epoch: 49 cost time: 29.161051750183105
Epoch: 49, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.354 Vali Acc: 0.955 Test Loss: 0.354 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 30.213666439056396
Epoch: 50, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.355 Vali Acc: 0.958 Test Loss: 0.355 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 30.802783012390137
Epoch: 51, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.511 Vali Acc: 0.931 Test Loss: 0.511 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 28.911792993545532
Epoch: 52, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.639 Vali Acc: 0.933 Test Loss: 0.639 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 30.330506324768066
Epoch: 53, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.623 Vali Acc: 0.928 Test Loss: 0.623 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 30.133742332458496
Epoch: 54, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.473 Vali Acc: 0.953 Test Loss: 0.473 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 28.43427062034607
Epoch: 55, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.369 Vali Acc: 0.939 Test Loss: 0.369 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 30.354912757873535
Epoch: 56, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.291 Vali Acc: 0.955 Test Loss: 0.291 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 29.768932104110718
Epoch: 57, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.497 Vali Acc: 0.945 Test Loss: 0.497 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 28.22477674484253
Epoch: 58, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.353 Vali Acc: 0.946 Test Loss: 0.353 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 30.39834237098694
Epoch: 1, Steps: 89 | Train Loss: 1.598 Vali Loss: 1.200 Vali Acc: 0.717 Test Loss: 1.200 Test Acc: 0.717
Validation loss decreased (inf --> -0.717258).  Saving model ...
Epoch: 2 cost time: 28.592027187347412
Epoch: 2, Steps: 89 | Train Loss: 0.533 Vali Loss: 1.584 Vali Acc: 0.670 Test Loss: 1.584 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.078814268112183
Epoch: 3, Steps: 89 | Train Loss: 0.533 Vali Loss: 0.635 Vali Acc: 0.884 Test Loss: 0.635 Test Acc: 0.884
Validation loss decreased (-0.717258 --> -0.884395).  Saving model ...
Epoch: 4 cost time: 30.297423362731934
Epoch: 4, Steps: 89 | Train Loss: 0.526 Vali Loss: 1.228 Vali Acc: 0.808 Test Loss: 1.228 Test Acc: 0.808
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.749799489974976
Epoch: 5, Steps: 89 | Train Loss: 0.507 Vali Loss: 1.207 Vali Acc: 0.863 Test Loss: 1.207 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 29.031875371932983
Epoch: 6, Steps: 89 | Train Loss: 0.594 Vali Loss: 1.398 Vali Acc: 0.866 Test Loss: 1.398 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 30.275790214538574
Epoch: 7, Steps: 89 | Train Loss: 0.628 Vali Loss: 0.977 Vali Acc: 0.913 Test Loss: 0.977 Test Acc: 0.913
Validation loss decreased (-0.884395 --> -0.912943).  Saving model ...
Epoch: 8 cost time: 29.353500843048096
Epoch: 8, Steps: 89 | Train Loss: 0.747 Vali Loss: 1.224 Vali Acc: 0.891 Test Loss: 1.224 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 28.7614426612854
Epoch: 9, Steps: 89 | Train Loss: 0.568 Vali Loss: 1.752 Vali Acc: 0.861 Test Loss: 1.752 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 29.658562898635864
Epoch: 10, Steps: 89 | Train Loss: 0.665 Vali Loss: 1.427 Vali Acc: 0.898 Test Loss: 1.427 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 29.361050844192505
Epoch: 11, Steps: 89 | Train Loss: 0.744 Vali Loss: 1.860 Vali Acc: 0.871 Test Loss: 1.860 Test Acc: 0.871
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 28.80343222618103
Epoch: 12, Steps: 89 | Train Loss: 0.678 Vali Loss: 1.095 Vali Acc: 0.918 Test Loss: 1.095 Test Acc: 0.918
Validation loss decreased (-0.912943 --> -0.917816).  Saving model ...
Epoch: 13 cost time: 29.776649713516235
Epoch: 13, Steps: 89 | Train Loss: 0.834 Vali Loss: 1.813 Vali Acc: 0.875 Test Loss: 1.813 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 29.438099145889282
Epoch: 14, Steps: 89 | Train Loss: 0.939 Vali Loss: 1.845 Vali Acc: 0.888 Test Loss: 1.845 Test Acc: 0.888
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 28.865131378173828
Epoch: 15, Steps: 89 | Train Loss: 0.793 Vali Loss: 1.303 Vali Acc: 0.909 Test Loss: 1.303 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 29.619747638702393
Epoch: 16, Steps: 89 | Train Loss: 0.994 Vali Loss: 1.780 Vali Acc: 0.903 Test Loss: 1.780 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 28.725971460342407
Epoch: 17, Steps: 89 | Train Loss: 0.932 Vali Loss: 1.558 Vali Acc: 0.912 Test Loss: 1.558 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 26.144577741622925
Epoch: 18, Steps: 89 | Train Loss: 0.999 Vali Loss: 3.066 Vali Acc: 0.843 Test Loss: 3.066 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 28.227149724960327
Epoch: 19, Steps: 89 | Train Loss: 1.055 Vali Loss: 1.126 Vali Acc: 0.934 Test Loss: 1.126 Test Acc: 0.934
Validation loss decreased (-0.917816 --> -0.933833).  Saving model ...
Epoch: 20 cost time: 28.329425811767578
Epoch: 20, Steps: 89 | Train Loss: 1.006 Vali Loss: 3.059 Vali Acc: 0.908 Test Loss: 3.059 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 28.688774347305298
Epoch: 21, Steps: 89 | Train Loss: 1.020 Vali Loss: 1.295 Vali Acc: 0.921 Test Loss: 1.295 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 28.85755443572998
Epoch: 22, Steps: 89 | Train Loss: 0.878 Vali Loss: 1.052 Vali Acc: 0.943 Test Loss: 1.052 Test Acc: 0.943
Validation loss decreased (-0.933833 --> -0.942886).  Saving model ...
Epoch: 23 cost time: 28.258849382400513
Epoch: 23, Steps: 89 | Train Loss: 0.736 Vali Loss: 1.101 Vali Acc: 0.931 Test Loss: 1.101 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 27.897156715393066
Epoch: 24, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.745 Vali Acc: 0.962 Test Loss: 0.745 Test Acc: 0.962
Validation loss decreased (-0.942886 --> -0.962388).  Saving model ...
Epoch: 25 cost time: 29.359031438827515
Epoch: 25, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.988 Vali Acc: 0.954 Test Loss: 0.988 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 29.01904058456421
Epoch: 26, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.945 Vali Acc: 0.953 Test Loss: 0.945 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 28.320067882537842
Epoch: 27, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.893 Vali Acc: 0.946 Test Loss: 0.893 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 29.031052589416504
Epoch: 28, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.839 Vali Acc: 0.953 Test Loss: 0.839 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 29.868648052215576
Epoch: 29, Steps: 89 | Train Loss: 0.335 Vali Loss: 1.073 Vali Acc: 0.946 Test Loss: 1.073 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 28.182267427444458
Epoch: 30, Steps: 89 | Train Loss: 0.443 Vali Loss: 1.588 Vali Acc: 0.916 Test Loss: 1.588 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 27.87697696685791
Epoch: 31, Steps: 89 | Train Loss: 0.338 Vali Loss: 1.387 Vali Acc: 0.929 Test Loss: 1.387 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 28.49082922935486
Epoch: 32, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.992 Vali Acc: 0.948 Test Loss: 0.992 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 26.60448908805847
Epoch: 33, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.758 Vali Acc: 0.961 Test Loss: 0.758 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 28.541494607925415
Epoch: 34, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.959 Vali Acc: 0.951 Test Loss: 0.959 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.18271827697754
Epoch: 1, Steps: 89 | Train Loss: 1.523 Vali Loss: 1.444 Vali Acc: 0.620 Test Loss: 1.444 Test Acc: 0.620
Validation loss decreased (inf --> -0.619763).  Saving model ...
Epoch: 2 cost time: 28.864320993423462
Epoch: 2, Steps: 89 | Train Loss: 0.442 Vali Loss: 1.855 Vali Acc: 0.620 Test Loss: 1.855 Test Acc: 0.620
Validation loss decreased (-0.619763 --> -0.620455).  Saving model ...
Epoch: 3 cost time: 28.528979539871216
Epoch: 3, Steps: 89 | Train Loss: 0.464 Vali Loss: 1.526 Vali Acc: 0.701 Test Loss: 1.526 Test Acc: 0.701
Validation loss decreased (-0.620455 --> -0.701238).  Saving model ...
Epoch: 4 cost time: 26.902390956878662
Epoch: 4, Steps: 89 | Train Loss: 0.351 Vali Loss: 1.555 Vali Acc: 0.756 Test Loss: 1.555 Test Acc: 0.756
Validation loss decreased (-0.701238 --> -0.756252).  Saving model ...
Epoch: 5 cost time: 27.23772668838501
Epoch: 5, Steps: 89 | Train Loss: 0.539 Vali Loss: 2.347 Vali Acc: 0.720 Test Loss: 2.347 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.48257613182068
Epoch: 6, Steps: 89 | Train Loss: 0.546 Vali Loss: 2.020 Vali Acc: 0.790 Test Loss: 2.020 Test Acc: 0.790
Validation loss decreased (-0.756252 --> -0.790370).  Saving model ...
Epoch: 7 cost time: 27.605613708496094
Epoch: 7, Steps: 89 | Train Loss: 0.574 Vali Loss: 1.270 Vali Acc: 0.832 Test Loss: 1.270 Test Acc: 0.832
Validation loss decreased (-0.790370 --> -0.832160).  Saving model ...
Epoch: 8 cost time: 27.478649854660034
Epoch: 8, Steps: 89 | Train Loss: 0.582 Vali Loss: 2.254 Vali Acc: 0.796 Test Loss: 2.254 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 28.42399835586548
Epoch: 9, Steps: 89 | Train Loss: 0.712 Vali Loss: 3.405 Vali Acc: 0.780 Test Loss: 3.405 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 27.006080150604248
Epoch: 10, Steps: 89 | Train Loss: 0.721 Vali Loss: 3.726 Vali Acc: 0.818 Test Loss: 3.726 Test Acc: 0.818
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 27.457003593444824
Epoch: 11, Steps: 89 | Train Loss: 0.922 Vali Loss: 1.912 Vali Acc: 0.867 Test Loss: 1.912 Test Acc: 0.867
Validation loss decreased (-0.832160 --> -0.866973).  Saving model ...
Epoch: 12 cost time: 28.078104972839355
Epoch: 12, Steps: 89 | Train Loss: 0.790 Vali Loss: 2.608 Vali Acc: 0.796 Test Loss: 2.608 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 28.072561502456665
Epoch: 13, Steps: 89 | Train Loss: 0.950 Vali Loss: 1.622 Vali Acc: 0.868 Test Loss: 1.622 Test Acc: 0.868
Validation loss decreased (-0.866973 --> -0.867672).  Saving model ...
Epoch: 14 cost time: 26.64394736289978
Epoch: 14, Steps: 89 | Train Loss: 0.742 Vali Loss: 2.356 Vali Acc: 0.849 Test Loss: 2.356 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 28.485427141189575
Epoch: 15, Steps: 89 | Train Loss: 1.146 Vali Loss: 1.535 Vali Acc: 0.897 Test Loss: 1.535 Test Acc: 0.897
Validation loss decreased (-0.867672 --> -0.896921).  Saving model ...
Epoch: 16 cost time: 28.443708896636963
Epoch: 16, Steps: 89 | Train Loss: 0.975 Vali Loss: 1.513 Vali Acc: 0.905 Test Loss: 1.513 Test Acc: 0.905
Validation loss decreased (-0.896921 --> -0.904581).  Saving model ...
Epoch: 17 cost time: 25.818705797195435
Epoch: 17, Steps: 89 | Train Loss: 0.727 Vali Loss: 1.333 Vali Acc: 0.916 Test Loss: 1.333 Test Acc: 0.916
Validation loss decreased (-0.904581 --> -0.915725).  Saving model ...
Epoch: 18 cost time: 27.70273184776306
Epoch: 18, Steps: 89 | Train Loss: 0.783 Vali Loss: 1.730 Vali Acc: 0.901 Test Loss: 1.730 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 27.521827220916748
Epoch: 19, Steps: 89 | Train Loss: 0.789 Vali Loss: 1.952 Vali Acc: 0.907 Test Loss: 1.952 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 26.034359455108643
Epoch: 20, Steps: 89 | Train Loss: 0.677 Vali Loss: 1.569 Vali Acc: 0.927 Test Loss: 1.569 Test Acc: 0.927
Validation loss decreased (-0.915725 --> -0.926865).  Saving model ...
Epoch: 21 cost time: 28.226728916168213
Epoch: 21, Steps: 89 | Train Loss: 0.472 Vali Loss: 1.331 Vali Acc: 0.923 Test Loss: 1.331 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 27.79849123954773
Epoch: 22, Steps: 89 | Train Loss: 0.282 Vali Loss: 1.024 Vali Acc: 0.944 Test Loss: 1.024 Test Acc: 0.944
Validation loss decreased (-0.926865 --> -0.943583).  Saving model ...
Epoch: 23 cost time: 26.38996982574463
Epoch: 23, Steps: 89 | Train Loss: 0.497 Vali Loss: 1.405 Vali Acc: 0.926 Test Loss: 1.405 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 27.985016345977783
Epoch: 24, Steps: 89 | Train Loss: 0.357 Vali Loss: 1.268 Vali Acc: 0.922 Test Loss: 1.268 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 28.385190963745117
Epoch: 25, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.682 Vali Acc: 0.957 Test Loss: 0.682 Test Acc: 0.957
Validation loss decreased (-0.943583 --> -0.956818).  Saving model ...
Epoch: 26 cost time: 26.448029279708862
Epoch: 26, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.730 Vali Acc: 0.962 Test Loss: 0.730 Test Acc: 0.962
Validation loss decreased (-0.956818 --> -0.961692).  Saving model ...
Epoch: 27 cost time: 28.52440094947815
Epoch: 27, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.998 Vali Acc: 0.950 Test Loss: 0.998 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 29.10092329978943
Epoch: 28, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.706 Vali Acc: 0.958 Test Loss: 0.706 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 27.284242630004883
Epoch: 29, Steps: 89 | Train Loss: 0.326 Vali Loss: 1.350 Vali Acc: 0.930 Test Loss: 1.350 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 29.65541911125183
Epoch: 30, Steps: 89 | Train Loss: 0.475 Vali Loss: 1.328 Vali Acc: 0.925 Test Loss: 1.328 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 28.810216188430786
Epoch: 31, Steps: 89 | Train Loss: 0.727 Vali Loss: 1.615 Vali Acc: 0.923 Test Loss: 1.615 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 27.69910979270935
Epoch: 32, Steps: 89 | Train Loss: 0.469 Vali Loss: 1.156 Vali Acc: 0.936 Test Loss: 1.156 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 28.322201013565063
Epoch: 33, Steps: 89 | Train Loss: 0.267 Vali Loss: 1.043 Vali Acc: 0.933 Test Loss: 1.043 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 27.64168906211853
Epoch: 34, Steps: 89 | Train Loss: 0.254 Vali Loss: 1.138 Vali Acc: 0.937 Test Loss: 1.138 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 29.08899426460266
Epoch: 35, Steps: 89 | Train Loss: 0.555 Vali Loss: 0.877 Vali Acc: 0.947 Test Loss: 0.877 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 27.84534215927124
Epoch: 36, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.736 Vali Acc: 0.944 Test Loss: 0.736 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.85376000404358
Epoch: 1, Steps: 89 | Train Loss: 1.440 Vali Loss: 1.269 Vali Acc: 0.680 Test Loss: 1.269 Test Acc: 0.680
Validation loss decreased (inf --> -0.680349).  Saving model ...
Epoch: 2 cost time: 29.712132692337036
Epoch: 2, Steps: 89 | Train Loss: 0.388 Vali Loss: 1.048 Vali Acc: 0.777 Test Loss: 1.048 Test Acc: 0.777
Validation loss decreased (-0.680349 --> -0.777148).  Saving model ...
Epoch: 3 cost time: 30.10314631462097
Epoch: 3, Steps: 89 | Train Loss: 0.371 Vali Loss: 1.906 Vali Acc: 0.724 Test Loss: 1.906 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.96560287475586
Epoch: 4, Steps: 89 | Train Loss: 0.319 Vali Loss: 2.834 Vali Acc: 0.714 Test Loss: 2.834 Test Acc: 0.714
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.170992612838745
Epoch: 5, Steps: 89 | Train Loss: 0.286 Vali Loss: 2.337 Vali Acc: 0.733 Test Loss: 2.337 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 29.23909044265747
Epoch: 6, Steps: 89 | Train Loss: 0.314 Vali Loss: 2.055 Vali Acc: 0.763 Test Loss: 2.055 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.502931833267212
Epoch: 7, Steps: 89 | Train Loss: 0.493 Vali Loss: 3.958 Vali Acc: 0.662 Test Loss: 3.958 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 28.880993366241455
Epoch: 8, Steps: 89 | Train Loss: 0.468 Vali Loss: 3.712 Vali Acc: 0.696 Test Loss: 3.712 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 29.51865553855896
Epoch: 9, Steps: 89 | Train Loss: 0.710 Vali Loss: 4.398 Vali Acc: 0.699 Test Loss: 4.398 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 28.30377507209778
Epoch: 10, Steps: 89 | Train Loss: 0.811 Vali Loss: 3.033 Vali Acc: 0.765 Test Loss: 3.033 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 25.858200788497925
Epoch: 11, Steps: 89 | Train Loss: 0.684 Vali Loss: 2.247 Vali Acc: 0.788 Test Loss: 2.247 Test Acc: 0.788
Validation loss decreased (-0.777148 --> -0.788278).  Saving model ...
Epoch: 12 cost time: 26.308688640594482
Epoch: 12, Steps: 89 | Train Loss: 0.603 Vali Loss: 2.108 Vali Acc: 0.834 Test Loss: 2.108 Test Acc: 0.834
Validation loss decreased (-0.788278 --> -0.834241).  Saving model ...
Epoch: 13 cost time: 29.562203884124756
Epoch: 13, Steps: 89 | Train Loss: 0.685 Vali Loss: 2.213 Vali Acc: 0.832 Test Loss: 2.213 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 29.021668434143066
Epoch: 14, Steps: 89 | Train Loss: 0.667 Vali Loss: 2.424 Vali Acc: 0.816 Test Loss: 2.424 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 27.471429109573364
Epoch: 15, Steps: 89 | Train Loss: 0.902 Vali Loss: 2.204 Vali Acc: 0.851 Test Loss: 2.204 Test Acc: 0.851
Validation loss decreased (-0.834241 --> -0.850953).  Saving model ...
Epoch: 16 cost time: 28.48218083381653
Epoch: 16, Steps: 89 | Train Loss: 1.110 Vali Loss: 2.076 Vali Acc: 0.851 Test Loss: 2.076 Test Acc: 0.851
Validation loss decreased (-0.850953 --> -0.850954).  Saving model ...
Epoch: 17 cost time: 28.690733194351196
Epoch: 17, Steps: 89 | Train Loss: 1.111 Vali Loss: 1.638 Vali Acc: 0.898 Test Loss: 1.638 Test Acc: 0.898
Validation loss decreased (-0.850954 --> -0.897616).  Saving model ...
Epoch: 18 cost time: 27.61029291152954
Epoch: 18, Steps: 89 | Train Loss: 1.090 Vali Loss: 1.688 Vali Acc: 0.899 Test Loss: 1.688 Test Acc: 0.899
Validation loss decreased (-0.897616 --> -0.899008).  Saving model ...
Epoch: 19 cost time: 28.05722975730896
Epoch: 19, Steps: 89 | Train Loss: 0.676 Vali Loss: 1.065 Vali Acc: 0.929 Test Loss: 1.065 Test Acc: 0.929
Validation loss decreased (-0.899008 --> -0.928959).  Saving model ...
Epoch: 20 cost time: 28.462265729904175
Epoch: 20, Steps: 89 | Train Loss: 0.795 Vali Loss: 0.825 Vali Acc: 0.930 Test Loss: 0.825 Test Acc: 0.930
Validation loss decreased (-0.928959 --> -0.930354).  Saving model ...
Epoch: 21 cost time: 27.75848388671875
Epoch: 21, Steps: 89 | Train Loss: 0.552 Vali Loss: 1.236 Vali Acc: 0.921 Test Loss: 1.236 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 28.56043553352356
Epoch: 22, Steps: 89 | Train Loss: 0.518 Vali Loss: 0.977 Vali Acc: 0.937 Test Loss: 0.977 Test Acc: 0.937
Validation loss decreased (-0.930354 --> -0.937316).  Saving model ...
Epoch: 23 cost time: 27.953961610794067
Epoch: 23, Steps: 89 | Train Loss: 0.559 Vali Loss: 0.957 Vali Acc: 0.943 Test Loss: 0.957 Test Acc: 0.943
Validation loss decreased (-0.937316 --> -0.942887).  Saving model ...
Epoch: 24 cost time: 27.323962211608887
Epoch: 24, Steps: 89 | Train Loss: 0.471 Vali Loss: 0.838 Vali Acc: 0.951 Test Loss: 0.838 Test Acc: 0.951
Validation loss decreased (-0.942887 --> -0.951245).  Saving model ...
Epoch: 25 cost time: 28.47585415840149
Epoch: 25, Steps: 89 | Train Loss: 0.357 Vali Loss: 1.348 Vali Acc: 0.925 Test Loss: 1.348 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 27.833622694015503
Epoch: 26, Steps: 89 | Train Loss: 0.375 Vali Loss: 1.046 Vali Acc: 0.937 Test Loss: 1.046 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 28.12809443473816
Epoch: 27, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.996 Vali Acc: 0.946 Test Loss: 0.996 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 28.520604848861694
Epoch: 28, Steps: 89 | Train Loss: 0.215 Vali Loss: 1.035 Vali Acc: 0.937 Test Loss: 1.035 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 28.666218757629395
Epoch: 29, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.218 Vali Acc: 0.937 Test Loss: 1.218 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 27.611367225646973
Epoch: 30, Steps: 89 | Train Loss: 0.300 Vali Loss: 1.013 Vali Acc: 0.937 Test Loss: 1.013 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 28.583662509918213
Epoch: 31, Steps: 89 | Train Loss: 0.341 Vali Loss: 0.916 Vali Acc: 0.944 Test Loss: 0.916 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 27.987183570861816
Epoch: 32, Steps: 89 | Train Loss: 0.345 Vali Loss: 1.447 Vali Acc: 0.937 Test Loss: 1.447 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 28.687053203582764
Epoch: 33, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.867 Vali Acc: 0.947 Test Loss: 0.867 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 28.715320110321045
Epoch: 34, Steps: 89 | Train Loss: 0.298 Vali Loss: 1.164 Vali Acc: 0.937 Test Loss: 1.164 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9512534818941504
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.961183547973633
Epoch: 1, Steps: 89 | Train Loss: 1.458 Vali Loss: 1.339 Vali Acc: 0.675 Test Loss: 1.339 Test Acc: 0.675
Validation loss decreased (inf --> -0.674778).  Saving model ...
Epoch: 2 cost time: 28.016685247421265
Epoch: 2, Steps: 89 | Train Loss: 0.375 Vali Loss: 1.075 Vali Acc: 0.801 Test Loss: 1.075 Test Acc: 0.801
Validation loss decreased (-0.674778 --> -0.800825).  Saving model ...
Epoch: 3 cost time: 27.820369720458984
Epoch: 3, Steps: 89 | Train Loss: 0.363 Vali Loss: 2.671 Vali Acc: 0.694 Test Loss: 2.671 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.418542623519897
Epoch: 4, Steps: 89 | Train Loss: 0.331 Vali Loss: 3.578 Vali Acc: 0.616 Test Loss: 3.578 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.937753438949585
Epoch: 5, Steps: 89 | Train Loss: 0.358 Vali Loss: 5.666 Vali Acc: 0.558 Test Loss: 5.666 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 28.17744731903076
Epoch: 6, Steps: 89 | Train Loss: 0.461 Vali Loss: 4.948 Vali Acc: 0.595 Test Loss: 4.948 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.728631258010864
Epoch: 7, Steps: 89 | Train Loss: 0.455 Vali Loss: 4.058 Vali Acc: 0.648 Test Loss: 4.058 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 28.850642204284668
Epoch: 8, Steps: 89 | Train Loss: 0.525 Vali Loss: 3.852 Vali Acc: 0.735 Test Loss: 3.852 Test Acc: 0.735
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 25.29624056816101
Epoch: 9, Steps: 89 | Train Loss: 0.669 Vali Loss: 5.796 Vali Acc: 0.649 Test Loss: 5.796 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 27.340458869934082
Epoch: 10, Steps: 89 | Train Loss: 0.595 Vali Loss: 3.202 Vali Acc: 0.740 Test Loss: 3.202 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 28.224628686904907
Epoch: 11, Steps: 89 | Train Loss: 0.832 Vali Loss: 1.763 Vali Acc: 0.813 Test Loss: 1.763 Test Acc: 0.813
Validation loss decreased (-0.800825 --> -0.812656).  Saving model ...
Epoch: 12 cost time: 27.616117477416992
Epoch: 12, Steps: 89 | Train Loss: 0.992 Vali Loss: 1.851 Vali Acc: 0.852 Test Loss: 1.851 Test Acc: 0.852
Validation loss decreased (-0.812656 --> -0.852349).  Saving model ...
Epoch: 13 cost time: 27.332576036453247
Epoch: 13, Steps: 89 | Train Loss: 0.687 Vali Loss: 1.619 Vali Acc: 0.890 Test Loss: 1.619 Test Acc: 0.890
Validation loss decreased (-0.852349 --> -0.889956).  Saving model ...
Epoch: 14 cost time: 28.40430521965027
Epoch: 14, Steps: 89 | Train Loss: 0.722 Vali Loss: 2.485 Vali Acc: 0.852 Test Loss: 2.485 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 27.900004863739014
Epoch: 15, Steps: 89 | Train Loss: 0.851 Vali Loss: 1.560 Vali Acc: 0.873 Test Loss: 1.560 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 26.504223823547363
Epoch: 16, Steps: 89 | Train Loss: 0.657 Vali Loss: 1.189 Vali Acc: 0.911 Test Loss: 1.189 Test Acc: 0.911
Validation loss decreased (-0.889956 --> -0.910852).  Saving model ...
Epoch: 17 cost time: 24.3656222820282
Epoch: 17, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.689 Vali Acc: 0.935 Test Loss: 0.689 Test Acc: 0.935
Validation loss decreased (-0.910852 --> -0.934533).  Saving model ...
Epoch: 18 cost time: 24.312455415725708
Epoch: 18, Steps: 89 | Train Loss: 0.571 Vali Loss: 3.199 Vali Acc: 0.860 Test Loss: 3.199 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 28.511698007583618
Epoch: 19, Steps: 89 | Train Loss: 0.807 Vali Loss: 0.924 Vali Acc: 0.935 Test Loss: 0.924 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 28.11062741279602
Epoch: 20, Steps: 89 | Train Loss: 0.431 Vali Loss: 1.594 Vali Acc: 0.896 Test Loss: 1.594 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 26.184088230133057
Epoch: 21, Steps: 89 | Train Loss: 0.448 Vali Loss: 1.119 Vali Acc: 0.934 Test Loss: 1.119 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 29.149028778076172
Epoch: 22, Steps: 89 | Train Loss: 0.585 Vali Loss: 0.887 Vali Acc: 0.938 Test Loss: 0.887 Test Acc: 0.938
Validation loss decreased (-0.934533 --> -0.938013).  Saving model ...
Epoch: 23 cost time: 30.119015216827393
Epoch: 23, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.917 Vali Acc: 0.932 Test Loss: 0.917 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 28.30092453956604
Epoch: 24, Steps: 89 | Train Loss: 0.376 Vali Loss: 0.984 Vali Acc: 0.926 Test Loss: 0.984 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 29.295395851135254
Epoch: 25, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.842 Vali Acc: 0.946 Test Loss: 0.842 Test Acc: 0.946
Validation loss decreased (-0.938013 --> -0.946370).  Saving model ...
Epoch: 26 cost time: 28.150758266448975
Epoch: 26, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.974 Vali Acc: 0.929 Test Loss: 0.974 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 28.146226167678833
Epoch: 27, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.900 Vali Acc: 0.945 Test Loss: 0.900 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 29.660203456878662
Epoch: 28, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.716 Vali Acc: 0.940 Test Loss: 0.716 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 29.45204448699951
Epoch: 29, Steps: 89 | Train Loss: 0.371 Vali Loss: 0.875 Vali Acc: 0.920 Test Loss: 0.875 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 27.91957116127014
Epoch: 30, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.781 Vali Acc: 0.940 Test Loss: 0.781 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 28.920467853546143
Epoch: 31, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.822 Vali Acc: 0.935 Test Loss: 0.822 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 28.579903602600098
Epoch: 32, Steps: 89 | Train Loss: 0.406 Vali Loss: 1.335 Vali Acc: 0.921 Test Loss: 1.335 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 28.3983154296875
Epoch: 33, Steps: 89 | Train Loss: 0.391 Vali Loss: 1.002 Vali Acc: 0.932 Test Loss: 1.002 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 29.397572994232178
Epoch: 34, Steps: 89 | Train Loss: 0.329 Vali Loss: 1.667 Vali Acc: 0.906 Test Loss: 1.667 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 29.089946269989014
Epoch: 35, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.745 Vali Acc: 0.942 Test Loss: 0.745 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9463788300835655
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.034690380096436
Epoch: 1, Steps: 89 | Train Loss: 1.486 Vali Loss: 1.150 Vali Acc: 0.734 Test Loss: 1.150 Test Acc: 0.734
Validation loss decreased (inf --> -0.733972).  Saving model ...
Epoch: 2 cost time: 28.227041482925415
Epoch: 2, Steps: 89 | Train Loss: 0.399 Vali Loss: 1.067 Vali Acc: 0.797 Test Loss: 1.067 Test Acc: 0.797
Validation loss decreased (-0.733972 --> -0.796647).  Saving model ...
Epoch: 3 cost time: 25.96317720413208
Epoch: 3, Steps: 89 | Train Loss: 0.426 Vali Loss: 2.729 Vali Acc: 0.594 Test Loss: 2.729 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.400619983673096
Epoch: 4, Steps: 89 | Train Loss: 0.308 Vali Loss: 2.405 Vali Acc: 0.782 Test Loss: 2.405 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.260884523391724
Epoch: 5, Steps: 89 | Train Loss: 0.505 Vali Loss: 3.632 Vali Acc: 0.719 Test Loss: 3.632 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.201176404953003
Epoch: 6, Steps: 89 | Train Loss: 0.480 Vali Loss: 2.752 Vali Acc: 0.747 Test Loss: 2.752 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.18297004699707
Epoch: 7, Steps: 89 | Train Loss: 0.470 Vali Loss: 3.207 Vali Acc: 0.674 Test Loss: 3.207 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 27.443190574645996
Epoch: 8, Steps: 89 | Train Loss: 0.642 Vali Loss: 3.798 Vali Acc: 0.746 Test Loss: 3.798 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 25.982335090637207
Epoch: 9, Steps: 89 | Train Loss: 0.687 Vali Loss: 3.560 Vali Acc: 0.776 Test Loss: 3.560 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 26.30636739730835
Epoch: 10, Steps: 89 | Train Loss: 0.740 Vali Loss: 2.264 Vali Acc: 0.813 Test Loss: 2.264 Test Acc: 0.813
Validation loss decreased (-0.796647 --> -0.812651).  Saving model ...
Epoch: 11 cost time: 27.531904935836792
Epoch: 11, Steps: 89 | Train Loss: 0.936 Vali Loss: 2.673 Vali Acc: 0.822 Test Loss: 2.673 Test Acc: 0.822
Validation loss decreased (-0.812651 --> -0.822397).  Saving model ...
Epoch: 12 cost time: 26.90906071662903
Epoch: 12, Steps: 89 | Train Loss: 0.883 Vali Loss: 2.777 Vali Acc: 0.836 Test Loss: 2.777 Test Acc: 0.836
Validation loss decreased (-0.822397 --> -0.836323).  Saving model ...
Epoch: 13 cost time: 27.55968165397644
Epoch: 13, Steps: 89 | Train Loss: 0.742 Vali Loss: 1.848 Vali Acc: 0.857 Test Loss: 1.848 Test Acc: 0.857
Validation loss decreased (-0.836323 --> -0.856527).  Saving model ...
Epoch: 14 cost time: 28.81416082382202
Epoch: 14, Steps: 89 | Train Loss: 0.971 Vali Loss: 1.408 Vali Acc: 0.917 Test Loss: 1.408 Test Acc: 0.917
Validation loss decreased (-0.856527 --> -0.917117).  Saving model ...
Epoch: 15 cost time: 26.73553705215454
Epoch: 15, Steps: 89 | Train Loss: 1.043 Vali Loss: 1.251 Vali Acc: 0.903 Test Loss: 1.251 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 26.51813530921936
Epoch: 16, Steps: 89 | Train Loss: 0.662 Vali Loss: 0.686 Vali Acc: 0.932 Test Loss: 0.686 Test Acc: 0.932
Validation loss decreased (-0.917117 --> -0.931748).  Saving model ...
Epoch: 17 cost time: 28.912804126739502
Epoch: 17, Steps: 89 | Train Loss: 0.508 Vali Loss: 0.917 Vali Acc: 0.928 Test Loss: 0.917 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 28.341604232788086
Epoch: 18, Steps: 89 | Train Loss: 0.679 Vali Loss: 0.988 Vali Acc: 0.923 Test Loss: 0.988 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 27.658873558044434
Epoch: 19, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.794 Vali Acc: 0.942 Test Loss: 0.794 Test Acc: 0.942
Validation loss decreased (-0.931748 --> -0.942193).  Saving model ...
Epoch: 20 cost time: 28.817404985427856
Epoch: 20, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.774 Vali Acc: 0.942 Test Loss: 0.774 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 28.159319162368774
Epoch: 21, Steps: 89 | Train Loss: 0.342 Vali Loss: 1.227 Vali Acc: 0.927 Test Loss: 1.227 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 26.95848560333252
Epoch: 22, Steps: 89 | Train Loss: 0.398 Vali Loss: 1.199 Vali Acc: 0.916 Test Loss: 1.199 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 28.981080532073975
Epoch: 23, Steps: 89 | Train Loss: 0.635 Vali Loss: 1.134 Vali Acc: 0.923 Test Loss: 1.134 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.935516834259033
Epoch: 24, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.952 Vali Acc: 0.939 Test Loss: 0.952 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 26.431780338287354
Epoch: 25, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.895 Vali Acc: 0.946 Test Loss: 0.895 Test Acc: 0.946
Validation loss decreased (-0.942193 --> -0.946370).  Saving model ...
Epoch: 26 cost time: 27.254894733428955
Epoch: 26, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.616 Vali Acc: 0.951 Test Loss: 0.616 Test Acc: 0.951
Validation loss decreased (-0.946370 --> -0.951247).  Saving model ...
Epoch: 27 cost time: 27.168809175491333
Epoch: 27, Steps: 89 | Train Loss: 0.257 Vali Loss: 1.265 Vali Acc: 0.910 Test Loss: 1.265 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 27.071873426437378
Epoch: 28, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.641 Vali Acc: 0.956 Test Loss: 0.641 Test Acc: 0.956
Validation loss decreased (-0.951247 --> -0.956122).  Saving model ...
Epoch: 29 cost time: 27.700764894485474
Epoch: 29, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.868 Vali Acc: 0.935 Test Loss: 0.868 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 26.80486798286438
Epoch: 30, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.657 Vali Acc: 0.945 Test Loss: 0.657 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 26.446366786956787
Epoch: 31, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.539 Vali Acc: 0.949 Test Loss: 0.539 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 28.063326358795166
Epoch: 32, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.694 Vali Acc: 0.950 Test Loss: 0.694 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 27.345755338668823
Epoch: 33, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.896 Vali Acc: 0.946 Test Loss: 0.896 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 27.563825607299805
Epoch: 34, Steps: 89 | Train Loss: 0.430 Vali Loss: 0.815 Vali Acc: 0.940 Test Loss: 0.815 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 27.869165420532227
Epoch: 35, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.939 Vali Acc: 0.932 Test Loss: 0.939 Test Acc: 0.932
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 27.9458909034729
Epoch: 36, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.342 Vali Acc: 0.925 Test Loss: 1.342 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 25.945923805236816
Epoch: 37, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.581 Vali Acc: 0.951 Test Loss: 0.581 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 27.013657808303833
Epoch: 38, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.798 Vali Acc: 0.930 Test Loss: 0.798 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9561281337047354
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.40325140953064
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.054 Test Loss: 2.996 Test Acc: 0.054
Validation loss decreased (inf --> -0.054288).  Saving model ...
Epoch: 2 cost time: 26.972121953964233
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.054288 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 27.961596965789795
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 27.248743295669556
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 26.349136352539062
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 26.938032865524292
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 27.327692985534668
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 26.077322483062744
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 26.992537021636963
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 27.335344076156616
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 26.0124614238739
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 27.38050889968872
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 25.61524748802185
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 27.422946214675903
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 27.775686979293823
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 27.40665340423584
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 27.281548500061035
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 26.751216411590576
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 27.755293130874634
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 26.96622920036316
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 27.542423009872437
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 28.349075078964233
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 27.173054456710815
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 28.830575942993164
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 27.8134868144989
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 27.619153261184692
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 28.09917712211609
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 27.29932689666748
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 27.00658893585205
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 28.00285840034485
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 27.94834280014038
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 26.784983158111572
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 27.741787672042847
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 28.486501455307007
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 27.69368004798889
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 26.863535165786743
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 27.536869764328003
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 28.04117751121521
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 26.411847829818726
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 28.0776526927948
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 27.615859746932983
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 27.499350786209106
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 28.45521116256714
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 28.162024974822998
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 26.911256074905396
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 28.449045419692993
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 28.05184507369995
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 27.433441162109375
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 24.89570665359497
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 27.11601448059082
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 27.698339462280273
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 26.694474935531616
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 28.368128538131714
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 54 cost time: 27.775590896606445
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 27.377143144607544
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 26.262521266937256
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 27.368157386779785
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 26.889386653900146
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 26.3269145488739
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 27.390310525894165
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 26.77402400970459
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 25.79705786705017
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 27.67877960205078
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 27.416247129440308
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 26.12312626838684
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 66 cost time: 27.6170072555542
Epoch: 66, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 67 cost time: 27.69991707801819
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 26.584322929382324
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 27.998985290527344
Epoch: 69, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 28.194779634475708
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 26.81560707092285
Epoch: 71, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 27.40971302986145
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 27.642118215560913
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 26.951687574386597
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 27.213165283203125
Epoch: 75, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 26.95914101600647
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 13952020
model size : 72.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.465314865112305
Epoch: 1, Steps: 89 | Train Loss: 1.042 Vali Loss: 0.521 Vali Acc: 0.864 Test Loss: 0.521 Test Acc: 0.864
Validation loss decreased (inf --> -0.863505).  Saving model ...
Epoch: 2 cost time: 28.350461959838867
Epoch: 2, Steps: 89 | Train Loss: 0.514 Vali Loss: 1.053 Vali Acc: 0.820 Test Loss: 1.053 Test Acc: 0.820
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.320833921432495
Epoch: 3, Steps: 89 | Train Loss: 0.612 Vali Loss: 0.769 Vali Acc: 0.898 Test Loss: 0.769 Test Acc: 0.898
Validation loss decreased (-0.863505 --> -0.897625).  Saving model ...
Epoch: 4 cost time: 26.868499517440796
Epoch: 4, Steps: 89 | Train Loss: 0.461 Vali Loss: 1.116 Vali Acc: 0.868 Test Loss: 1.116 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.666924476623535
Epoch: 5, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.947 Vali Acc: 0.894 Test Loss: 0.947 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.74655556678772
Epoch: 6, Steps: 89 | Train Loss: 0.517 Vali Loss: 1.424 Vali Acc: 0.880 Test Loss: 1.424 Test Acc: 0.880
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.097087383270264
Epoch: 7, Steps: 89 | Train Loss: 0.699 Vali Loss: 2.481 Vali Acc: 0.828 Test Loss: 2.481 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.239089250564575
Epoch: 8, Steps: 89 | Train Loss: 0.924 Vali Loss: 2.679 Vali Acc: 0.835 Test Loss: 2.679 Test Acc: 0.835
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 28.86815595626831
Epoch: 9, Steps: 89 | Train Loss: 0.641 Vali Loss: 1.396 Vali Acc: 0.925 Test Loss: 1.396 Test Acc: 0.925
Validation loss decreased (-0.897625 --> -0.925474).  Saving model ...
Epoch: 10 cost time: 27.005188703536987
Epoch: 10, Steps: 89 | Train Loss: 0.724 Vali Loss: 2.366 Vali Acc: 0.873 Test Loss: 2.366 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 29.225569486618042
Epoch: 11, Steps: 89 | Train Loss: 0.657 Vali Loss: 1.543 Vali Acc: 0.898 Test Loss: 1.543 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 29.28779888153076
Epoch: 12, Steps: 89 | Train Loss: 0.507 Vali Loss: 1.402 Vali Acc: 0.906 Test Loss: 1.402 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 27.517717361450195
Epoch: 13, Steps: 89 | Train Loss: 0.564 Vali Loss: 1.093 Vali Acc: 0.932 Test Loss: 1.093 Test Acc: 0.932
Validation loss decreased (-0.925474 --> -0.931744).  Saving model ...
Epoch: 14 cost time: 29.265499591827393
Epoch: 14, Steps: 89 | Train Loss: 0.610 Vali Loss: 1.492 Vali Acc: 0.909 Test Loss: 1.492 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 29.106961965560913
Epoch: 15, Steps: 89 | Train Loss: 0.323 Vali Loss: 1.300 Vali Acc: 0.921 Test Loss: 1.300 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 27.512667894363403
Epoch: 16, Steps: 89 | Train Loss: 0.445 Vali Loss: 1.089 Vali Acc: 0.928 Test Loss: 1.089 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 29.139620542526245
Epoch: 17, Steps: 89 | Train Loss: 0.661 Vali Loss: 2.939 Vali Acc: 0.875 Test Loss: 2.939 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 29.012083530426025
Epoch: 18, Steps: 89 | Train Loss: 0.645 Vali Loss: 1.501 Vali Acc: 0.905 Test Loss: 1.501 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 27.25567102432251
Epoch: 19, Steps: 89 | Train Loss: 0.600 Vali Loss: 1.825 Vali Acc: 0.909 Test Loss: 1.825 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 29.03179621696472
Epoch: 20, Steps: 89 | Train Loss: 0.548 Vali Loss: 1.275 Vali Acc: 0.916 Test Loss: 1.275 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 29.18400478363037
Epoch: 21, Steps: 89 | Train Loss: 0.482 Vali Loss: 1.475 Vali Acc: 0.937 Test Loss: 1.475 Test Acc: 0.937
Validation loss decreased (-0.931744 --> -0.936615).  Saving model ...
Epoch: 22 cost time: 27.499172687530518
Epoch: 22, Steps: 89 | Train Loss: 0.564 Vali Loss: 1.140 Vali Acc: 0.936 Test Loss: 1.140 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 29.560815572738647
Epoch: 23, Steps: 89 | Train Loss: 0.450 Vali Loss: 1.810 Vali Acc: 0.911 Test Loss: 1.810 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 29.075153827667236
Epoch: 24, Steps: 89 | Train Loss: 0.435 Vali Loss: 2.065 Vali Acc: 0.898 Test Loss: 2.065 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 27.688421487808228
Epoch: 25, Steps: 89 | Train Loss: 0.394 Vali Loss: 1.375 Vali Acc: 0.937 Test Loss: 1.375 Test Acc: 0.937
Validation loss decreased (-0.936615 --> -0.936616).  Saving model ...
Epoch: 26 cost time: 29.153462409973145
Epoch: 26, Steps: 89 | Train Loss: 0.448 Vali Loss: 1.288 Vali Acc: 0.940 Test Loss: 1.288 Test Acc: 0.940
Validation loss decreased (-0.936616 --> -0.940099).  Saving model ...
Epoch: 27 cost time: 28.33547019958496
Epoch: 27, Steps: 89 | Train Loss: 0.429 Vali Loss: 1.461 Vali Acc: 0.928 Test Loss: 1.461 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 27.78080463409424
Epoch: 28, Steps: 89 | Train Loss: 0.360 Vali Loss: 1.665 Vali Acc: 0.909 Test Loss: 1.665 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 28.57536005973816
Epoch: 29, Steps: 89 | Train Loss: 0.335 Vali Loss: 1.842 Vali Acc: 0.923 Test Loss: 1.842 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 29.47133779525757
Epoch: 30, Steps: 89 | Train Loss: 0.332 Vali Loss: 1.326 Vali Acc: 0.936 Test Loss: 1.326 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 28.747695922851562
Epoch: 31, Steps: 89 | Train Loss: 0.274 Vali Loss: 1.148 Vali Acc: 0.950 Test Loss: 1.148 Test Acc: 0.950
Validation loss decreased (-0.940099 --> -0.949849).  Saving model ...
Epoch: 32 cost time: 29.855908393859863
Epoch: 32, Steps: 89 | Train Loss: 0.456 Vali Loss: 1.494 Vali Acc: 0.931 Test Loss: 1.494 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 29.791038990020752
Epoch: 33, Steps: 89 | Train Loss: 0.449 Vali Loss: 1.179 Vali Acc: 0.939 Test Loss: 1.179 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 27.929656267166138
Epoch: 34, Steps: 89 | Train Loss: 0.326 Vali Loss: 1.752 Vali Acc: 0.923 Test Loss: 1.752 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 24.241201162338257
Epoch: 35, Steps: 89 | Train Loss: 0.389 Vali Loss: 1.256 Vali Acc: 0.937 Test Loss: 1.256 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 29.97019600868225
Epoch: 36, Steps: 89 | Train Loss: 0.114 Vali Loss: 1.534 Vali Acc: 0.926 Test Loss: 1.534 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 27.728499174118042
Epoch: 37, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.047 Vali Acc: 0.948 Test Loss: 1.047 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 28.980327129364014
Epoch: 38, Steps: 89 | Train Loss: 0.375 Vali Loss: 1.450 Vali Acc: 0.927 Test Loss: 1.450 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 29.788000106811523
Epoch: 39, Steps: 89 | Train Loss: 0.507 Vali Loss: 2.641 Vali Acc: 0.886 Test Loss: 2.641 Test Acc: 0.886
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 28.498477935791016
Epoch: 40, Steps: 89 | Train Loss: 0.431 Vali Loss: 1.797 Vali Acc: 0.927 Test Loss: 1.797 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 29.60129475593567
Epoch: 41, Steps: 89 | Train Loss: 0.321 Vali Loss: 1.738 Vali Acc: 0.921 Test Loss: 1.738 Test Acc: 0.921
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9498607242339833
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.89557909965515
Epoch: 1, Steps: 89 | Train Loss: 1.146 Vali Loss: 0.503 Vali Acc: 0.874 Test Loss: 0.503 Test Acc: 0.874
Validation loss decreased (inf --> -0.873950).  Saving model ...
Epoch: 2 cost time: 27.379193544387817
Epoch: 2, Steps: 89 | Train Loss: 0.651 Vali Loss: 1.128 Vali Acc: 0.841 Test Loss: 1.128 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.658082246780396
Epoch: 3, Steps: 89 | Train Loss: 0.692 Vali Loss: 0.794 Vali Acc: 0.880 Test Loss: 0.794 Test Acc: 0.880
Validation loss decreased (-0.873950 --> -0.879519).  Saving model ...
Epoch: 4 cost time: 28.304969787597656
Epoch: 4, Steps: 89 | Train Loss: 0.639 Vali Loss: 0.892 Vali Acc: 0.905 Test Loss: 0.892 Test Acc: 0.905
Validation loss decreased (-0.879519 --> -0.904587).  Saving model ...
Epoch: 5 cost time: 27.45948314666748
Epoch: 5, Steps: 89 | Train Loss: 0.602 Vali Loss: 1.227 Vali Acc: 0.863 Test Loss: 1.227 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.547075271606445
Epoch: 6, Steps: 89 | Train Loss: 0.718 Vali Loss: 1.107 Vali Acc: 0.902 Test Loss: 1.107 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 28.555914163589478
Epoch: 7, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.939 Vali Acc: 0.927 Test Loss: 0.939 Test Acc: 0.927
Validation loss decreased (-0.904587 --> -0.926871).  Saving model ...
Epoch: 8 cost time: 26.89317488670349
Epoch: 8, Steps: 89 | Train Loss: 0.710 Vali Loss: 1.116 Vali Acc: 0.900 Test Loss: 1.116 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 29.140552520751953
Epoch: 9, Steps: 89 | Train Loss: 0.577 Vali Loss: 1.906 Vali Acc: 0.859 Test Loss: 1.906 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 28.612380981445312
Epoch: 10, Steps: 89 | Train Loss: 0.549 Vali Loss: 2.206 Vali Acc: 0.847 Test Loss: 2.206 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 27.87078547477722
Epoch: 11, Steps: 89 | Train Loss: 0.651 Vali Loss: 1.588 Vali Acc: 0.894 Test Loss: 1.588 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 28.844849109649658
Epoch: 12, Steps: 89 | Train Loss: 0.475 Vali Loss: 1.403 Vali Acc: 0.896 Test Loss: 1.403 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 28.51911234855652
Epoch: 13, Steps: 89 | Train Loss: 0.677 Vali Loss: 1.753 Vali Acc: 0.905 Test Loss: 1.753 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 28.05099391937256
Epoch: 14, Steps: 89 | Train Loss: 0.574 Vali Loss: 1.275 Vali Acc: 0.919 Test Loss: 1.275 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 24.922519207000732
Epoch: 15, Steps: 89 | Train Loss: 0.490 Vali Loss: 1.441 Vali Acc: 0.894 Test Loss: 1.441 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 29.258292198181152
Epoch: 16, Steps: 89 | Train Loss: 0.665 Vali Loss: 0.823 Vali Acc: 0.937 Test Loss: 0.823 Test Acc: 0.937
Validation loss decreased (-0.926871 --> -0.937318).  Saving model ...
Epoch: 17 cost time: 28.87591290473938
Epoch: 17, Steps: 89 | Train Loss: 0.673 Vali Loss: 1.172 Vali Acc: 0.919 Test Loss: 1.172 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 28.015974044799805
Epoch: 18, Steps: 89 | Train Loss: 0.665 Vali Loss: 2.069 Vali Acc: 0.895 Test Loss: 2.069 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 29.495885372161865
Epoch: 19, Steps: 89 | Train Loss: 0.316 Vali Loss: 2.369 Vali Acc: 0.865 Test Loss: 2.369 Test Acc: 0.865
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 28.699187517166138
Epoch: 20, Steps: 89 | Train Loss: 0.451 Vali Loss: 1.499 Vali Acc: 0.912 Test Loss: 1.499 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 27.159380197525024
Epoch: 21, Steps: 89 | Train Loss: 0.455 Vali Loss: 0.887 Vali Acc: 0.950 Test Loss: 0.887 Test Acc: 0.950
Validation loss decreased (-0.937318 --> -0.949852).  Saving model ...
Epoch: 22 cost time: 27.877081155776978
Epoch: 22, Steps: 89 | Train Loss: 0.389 Vali Loss: 1.225 Vali Acc: 0.921 Test Loss: 1.225 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 29.28682017326355
Epoch: 23, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.994 Vali Acc: 0.946 Test Loss: 0.994 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 27.76175308227539
Epoch: 24, Steps: 89 | Train Loss: 0.575 Vali Loss: 1.797 Vali Acc: 0.882 Test Loss: 1.797 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 29.080342769622803
Epoch: 25, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.771 Vali Acc: 0.952 Test Loss: 0.771 Test Acc: 0.952
Validation loss decreased (-0.949852 --> -0.951942).  Saving model ...
Epoch: 26 cost time: 29.03642725944519
Epoch: 26, Steps: 89 | Train Loss: 0.454 Vali Loss: 1.849 Vali Acc: 0.896 Test Loss: 1.849 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 26.89222288131714
Epoch: 27, Steps: 89 | Train Loss: 0.375 Vali Loss: 1.447 Vali Acc: 0.908 Test Loss: 1.447 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 28.632386684417725
Epoch: 28, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.955 Vali Acc: 0.945 Test Loss: 0.955 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 29.09584617614746
Epoch: 29, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.738 Vali Acc: 0.941 Test Loss: 0.738 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 26.88136649131775
Epoch: 30, Steps: 89 | Train Loss: 0.364 Vali Loss: 1.114 Vali Acc: 0.928 Test Loss: 1.114 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 28.47695255279541
Epoch: 31, Steps: 89 | Train Loss: 0.316 Vali Loss: 1.326 Vali Acc: 0.925 Test Loss: 1.326 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 28.933664798736572
Epoch: 32, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.860 Vali Acc: 0.955 Test Loss: 0.860 Test Acc: 0.955
Validation loss decreased (-0.951942 --> -0.954727).  Saving model ...
Epoch: 33 cost time: 27.256109952926636
Epoch: 33, Steps: 89 | Train Loss: 0.274 Vali Loss: 1.173 Vali Acc: 0.916 Test Loss: 1.173 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 29.45850372314453
Epoch: 34, Steps: 89 | Train Loss: 0.358 Vali Loss: 1.307 Vali Acc: 0.908 Test Loss: 1.307 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 29.046589612960815
Epoch: 35, Steps: 89 | Train Loss: 0.588 Vali Loss: 0.644 Vali Acc: 0.955 Test Loss: 0.644 Test Acc: 0.955
Validation loss decreased (-0.954727 --> -0.955425).  Saving model ...
Epoch: 36 cost time: 27.96697759628296
Epoch: 36, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.992 Vali Acc: 0.944 Test Loss: 0.992 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 28.261788606643677
Epoch: 37, Steps: 89 | Train Loss: 0.357 Vali Loss: 1.120 Vali Acc: 0.938 Test Loss: 1.120 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 25.714017868041992
Epoch: 38, Steps: 89 | Train Loss: 0.461 Vali Loss: 1.089 Vali Acc: 0.932 Test Loss: 1.089 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 26.424580097198486
Epoch: 39, Steps: 89 | Train Loss: 0.443 Vali Loss: 1.287 Vali Acc: 0.907 Test Loss: 1.287 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 28.377954721450806
Epoch: 40, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.902 Vali Acc: 0.943 Test Loss: 0.902 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 28.225513458251953
Epoch: 41, Steps: 89 | Train Loss: 0.391 Vali Loss: 2.012 Vali Acc: 0.908 Test Loss: 2.012 Test Acc: 0.908
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 26.563005208969116
Epoch: 42, Steps: 89 | Train Loss: 0.317 Vali Loss: 2.971 Vali Acc: 0.893 Test Loss: 2.971 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 28.649600744247437
Epoch: 43, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.932 Vali Acc: 0.942 Test Loss: 0.932 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 28.670885801315308
Epoch: 44, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.820 Vali Acc: 0.953 Test Loss: 0.820 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 27.392523288726807
Epoch: 45, Steps: 89 | Train Loss: 0.373 Vali Loss: 1.380 Vali Acc: 0.926 Test Loss: 1.380 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9554317548746518
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.879226446151733
Epoch: 1, Steps: 89 | Train Loss: 1.208 Vali Loss: 0.679 Vali Acc: 0.825 Test Loss: 0.679 Test Acc: 0.825
Validation loss decreased (inf --> -0.825202).  Saving model ...
Epoch: 2 cost time: 26.886358499526978
Epoch: 2, Steps: 89 | Train Loss: 0.655 Vali Loss: 0.854 Vali Acc: 0.854 Test Loss: 0.854 Test Acc: 0.854
Validation loss decreased (-0.825202 --> -0.853752).  Saving model ...
Epoch: 3 cost time: 27.66037130355835
Epoch: 3, Steps: 89 | Train Loss: 0.632 Vali Loss: 0.754 Vali Acc: 0.879 Test Loss: 0.754 Test Acc: 0.879
Validation loss decreased (-0.853752 --> -0.878823).  Saving model ...
Epoch: 4 cost time: 27.914220571517944
Epoch: 4, Steps: 89 | Train Loss: 0.602 Vali Loss: 0.959 Vali Acc: 0.896 Test Loss: 0.959 Test Acc: 0.896
Validation loss decreased (-0.878823 --> -0.895534).  Saving model ...
Epoch: 5 cost time: 26.369388818740845
Epoch: 5, Steps: 89 | Train Loss: 0.728 Vali Loss: 1.117 Vali Acc: 0.881 Test Loss: 1.117 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.126620769500732
Epoch: 6, Steps: 89 | Train Loss: 0.966 Vali Loss: 1.121 Vali Acc: 0.900 Test Loss: 1.121 Test Acc: 0.900
Validation loss decreased (-0.895534 --> -0.900407).  Saving model ...
Epoch: 7 cost time: 27.762324333190918
Epoch: 7, Steps: 89 | Train Loss: 0.766 Vali Loss: 0.967 Vali Acc: 0.903 Test Loss: 0.967 Test Acc: 0.903
Validation loss decreased (-0.900407 --> -0.902497).  Saving model ...
Epoch: 8 cost time: 26.14288330078125
Epoch: 8, Steps: 89 | Train Loss: 0.751 Vali Loss: 0.979 Vali Acc: 0.928 Test Loss: 0.979 Test Acc: 0.928
Validation loss decreased (-0.902497 --> -0.927567).  Saving model ...
Epoch: 9 cost time: 27.446043968200684
Epoch: 9, Steps: 89 | Train Loss: 0.518 Vali Loss: 2.604 Vali Acc: 0.850 Test Loss: 2.604 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.777090787887573
Epoch: 10, Steps: 89 | Train Loss: 0.713 Vali Loss: 1.087 Vali Acc: 0.929 Test Loss: 1.087 Test Acc: 0.929
Validation loss decreased (-0.927567 --> -0.928958).  Saving model ...
Epoch: 11 cost time: 26.874247074127197
Epoch: 11, Steps: 89 | Train Loss: 0.668 Vali Loss: 1.204 Vali Acc: 0.912 Test Loss: 1.204 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 28.24029541015625
Epoch: 12, Steps: 89 | Train Loss: 0.626 Vali Loss: 1.047 Vali Acc: 0.939 Test Loss: 1.047 Test Acc: 0.939
Validation loss decreased (-0.928958 --> -0.938708).  Saving model ...
Epoch: 13 cost time: 28.2742919921875
Epoch: 13, Steps: 89 | Train Loss: 0.497 Vali Loss: 1.110 Vali Acc: 0.930 Test Loss: 1.110 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.935049533843994
Epoch: 14, Steps: 89 | Train Loss: 0.799 Vali Loss: 2.069 Vali Acc: 0.902 Test Loss: 2.069 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 28.21611714363098
Epoch: 15, Steps: 89 | Train Loss: 0.587 Vali Loss: 1.291 Vali Acc: 0.914 Test Loss: 1.291 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 28.371509790420532
Epoch: 16, Steps: 89 | Train Loss: 0.916 Vali Loss: 1.536 Vali Acc: 0.913 Test Loss: 1.536 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.36978316307068
Epoch: 17, Steps: 89 | Train Loss: 0.471 Vali Loss: 1.915 Vali Acc: 0.891 Test Loss: 1.915 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 28.18500542640686
Epoch: 18, Steps: 89 | Train Loss: 0.559 Vali Loss: 1.673 Vali Acc: 0.912 Test Loss: 1.673 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 27.579254388809204
Epoch: 19, Steps: 89 | Train Loss: 0.535 Vali Loss: 1.369 Vali Acc: 0.912 Test Loss: 1.369 Test Acc: 0.912
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 26.156638622283936
Epoch: 20, Steps: 89 | Train Loss: 0.784 Vali Loss: 1.279 Vali Acc: 0.917 Test Loss: 1.279 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 27.97114133834839
Epoch: 21, Steps: 89 | Train Loss: 0.680 Vali Loss: 1.156 Vali Acc: 0.930 Test Loss: 1.156 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 28.21140146255493
Epoch: 22, Steps: 89 | Train Loss: 0.687 Vali Loss: 1.203 Vali Acc: 0.903 Test Loss: 1.203 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9387186629526463
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.59588623046875
Epoch: 1, Steps: 89 | Train Loss: 1.349 Vali Loss: 0.825 Vali Acc: 0.784 Test Loss: 0.825 Test Acc: 0.784
Validation loss decreased (inf --> -0.784114).  Saving model ...
Epoch: 2 cost time: 27.516217708587646
Epoch: 2, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.875 Vali Acc: 0.842 Test Loss: 0.875 Test Acc: 0.842
Validation loss decreased (-0.784114 --> -0.841913).  Saving model ...
Epoch: 3 cost time: 24.840352058410645
Epoch: 3, Steps: 89 | Train Loss: 0.588 Vali Loss: 0.974 Vali Acc: 0.865 Test Loss: 0.974 Test Acc: 0.865
Validation loss decreased (-0.841913 --> -0.864893).  Saving model ...
Epoch: 4 cost time: 26.60131573677063
Epoch: 4, Steps: 89 | Train Loss: 0.609 Vali Loss: 1.088 Vali Acc: 0.859 Test Loss: 1.088 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.829696655273438
Epoch: 5, Steps: 89 | Train Loss: 0.770 Vali Loss: 1.186 Vali Acc: 0.861 Test Loss: 1.186 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.881944179534912
Epoch: 6, Steps: 89 | Train Loss: 0.689 Vali Loss: 1.438 Vali Acc: 0.861 Test Loss: 1.438 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.770195245742798
Epoch: 7, Steps: 89 | Train Loss: 0.497 Vali Loss: 1.569 Vali Acc: 0.875 Test Loss: 1.569 Test Acc: 0.875
Validation loss decreased (-0.864893 --> -0.874636).  Saving model ...
Epoch: 8 cost time: 27.727054834365845
Epoch: 8, Steps: 89 | Train Loss: 0.522 Vali Loss: 1.540 Vali Acc: 0.879 Test Loss: 1.540 Test Acc: 0.879
Validation loss decreased (-0.874636 --> -0.878815).  Saving model ...
Epoch: 9 cost time: 26.46848487854004
Epoch: 9, Steps: 89 | Train Loss: 0.535 Vali Loss: 1.674 Vali Acc: 0.875 Test Loss: 1.674 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 28.280083894729614
Epoch: 10, Steps: 89 | Train Loss: 0.671 Vali Loss: 1.667 Vali Acc: 0.900 Test Loss: 1.667 Test Acc: 0.900
Validation loss decreased (-0.878815 --> -0.899705).  Saving model ...
Epoch: 11 cost time: 28.40370512008667
Epoch: 11, Steps: 89 | Train Loss: 0.457 Vali Loss: 1.388 Vali Acc: 0.909 Test Loss: 1.388 Test Acc: 0.909
Validation loss decreased (-0.899705 --> -0.908760).  Saving model ...
Epoch: 12 cost time: 25.72616744041443
Epoch: 12, Steps: 89 | Train Loss: 0.690 Vali Loss: 1.149 Vali Acc: 0.930 Test Loss: 1.149 Test Acc: 0.930
Validation loss decreased (-0.908760 --> -0.930351).  Saving model ...
Epoch: 13 cost time: 26.264472007751465
Epoch: 13, Steps: 89 | Train Loss: 0.531 Vali Loss: 1.706 Vali Acc: 0.903 Test Loss: 1.706 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.547566890716553
Epoch: 14, Steps: 89 | Train Loss: 0.643 Vali Loss: 1.033 Vali Acc: 0.929 Test Loss: 1.033 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 25.66382384300232
Epoch: 15, Steps: 89 | Train Loss: 0.765 Vali Loss: 1.484 Vali Acc: 0.914 Test Loss: 1.484 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.997610569000244
Epoch: 16, Steps: 89 | Train Loss: 0.758 Vali Loss: 0.949 Vali Acc: 0.942 Test Loss: 0.949 Test Acc: 0.942
Validation loss decreased (-0.930351 --> -0.941495).  Saving model ...
Epoch: 17 cost time: 27.878554105758667
Epoch: 17, Steps: 89 | Train Loss: 0.425 Vali Loss: 1.909 Vali Acc: 0.912 Test Loss: 1.909 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 26.197460889816284
Epoch: 18, Steps: 89 | Train Loss: 0.492 Vali Loss: 0.944 Vali Acc: 0.948 Test Loss: 0.944 Test Acc: 0.948
Validation loss decreased (-0.941495 --> -0.947762).  Saving model ...
Epoch: 19 cost time: 25.64020824432373
Epoch: 19, Steps: 89 | Train Loss: 0.427 Vali Loss: 1.721 Vali Acc: 0.908 Test Loss: 1.721 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 26.18274235725403
Epoch: 20, Steps: 89 | Train Loss: 0.718 Vali Loss: 2.385 Vali Acc: 0.886 Test Loss: 2.385 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.152026653289795
Epoch: 21, Steps: 89 | Train Loss: 0.846 Vali Loss: 1.709 Vali Acc: 0.912 Test Loss: 1.709 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.847766399383545
Epoch: 22, Steps: 89 | Train Loss: 0.944 Vali Loss: 1.085 Vali Acc: 0.949 Test Loss: 1.085 Test Acc: 0.949
Validation loss decreased (-0.947762 --> -0.949153).  Saving model ...
Epoch: 23 cost time: 24.490018367767334
Epoch: 23, Steps: 89 | Train Loss: 0.566 Vali Loss: 1.677 Vali Acc: 0.931 Test Loss: 1.677 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 27.89262342453003
Epoch: 24, Steps: 89 | Train Loss: 0.796 Vali Loss: 1.236 Vali Acc: 0.936 Test Loss: 1.236 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 27.93023657798767
Epoch: 25, Steps: 89 | Train Loss: 0.564 Vali Loss: 1.208 Vali Acc: 0.941 Test Loss: 1.208 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 25.70120882987976
Epoch: 26, Steps: 89 | Train Loss: 0.410 Vali Loss: 1.377 Vali Acc: 0.939 Test Loss: 1.377 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 26.931698322296143
Epoch: 27, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.928 Vali Acc: 0.930 Test Loss: 0.928 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 27.914085388183594
Epoch: 28, Steps: 89 | Train Loss: 0.258 Vali Loss: 1.060 Vali Acc: 0.942 Test Loss: 1.060 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 24.92095685005188
Epoch: 29, Steps: 89 | Train Loss: 0.402 Vali Loss: 1.285 Vali Acc: 0.912 Test Loss: 1.285 Test Acc: 0.912
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 26.975642442703247
Epoch: 30, Steps: 89 | Train Loss: 0.308 Vali Loss: 1.288 Vali Acc: 0.944 Test Loss: 1.288 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 24.262707233428955
Epoch: 31, Steps: 89 | Train Loss: 0.365 Vali Loss: 1.600 Vali Acc: 0.915 Test Loss: 1.600 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 26.48851180076599
Epoch: 32, Steps: 89 | Train Loss: 0.572 Vali Loss: 0.847 Vali Acc: 0.957 Test Loss: 0.847 Test Acc: 0.957
Validation loss decreased (-0.949153 --> -0.956816).  Saving model ...
Epoch: 33 cost time: 27.36481547355652
Epoch: 33, Steps: 89 | Train Loss: 0.470 Vali Loss: 1.110 Vali Acc: 0.944 Test Loss: 1.110 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 27.09034299850464
Epoch: 34, Steps: 89 | Train Loss: 0.493 Vali Loss: 1.240 Vali Acc: 0.901 Test Loss: 1.240 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 25.969926834106445
Epoch: 35, Steps: 89 | Train Loss: 0.579 Vali Loss: 1.488 Vali Acc: 0.916 Test Loss: 1.488 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 26.883853435516357
Epoch: 36, Steps: 89 | Train Loss: 0.566 Vali Loss: 1.198 Vali Acc: 0.931 Test Loss: 1.198 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 27.604943990707397
Epoch: 37, Steps: 89 | Train Loss: 0.599 Vali Loss: 1.035 Vali Acc: 0.922 Test Loss: 1.035 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 25.566479444503784
Epoch: 38, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.698 Vali Acc: 0.948 Test Loss: 0.698 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 26.739104986190796
Epoch: 39, Steps: 89 | Train Loss: 0.474 Vali Loss: 0.654 Vali Acc: 0.928 Test Loss: 0.654 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 26.83403491973877
Epoch: 40, Steps: 89 | Train Loss: 0.429 Vali Loss: 1.225 Vali Acc: 0.897 Test Loss: 1.225 Test Acc: 0.897
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 26.1891872882843
Epoch: 41, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.594 Vali Acc: 0.896 Test Loss: 0.594 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 25.192900896072388
Epoch: 42, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.654 Vali Acc: 0.919 Test Loss: 0.654 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.84758234024048
Epoch: 1, Steps: 89 | Train Loss: 1.582 Vali Loss: 1.251 Vali Acc: 0.665 Test Loss: 1.251 Test Acc: 0.665
Validation loss decreased (inf --> -0.665029).  Saving model ...
Epoch: 2 cost time: 25.408382177352905
Epoch: 2, Steps: 89 | Train Loss: 0.570 Vali Loss: 1.256 Vali Acc: 0.757 Test Loss: 1.256 Test Acc: 0.757
Validation loss decreased (-0.665029 --> -0.756951).  Saving model ...
Epoch: 3 cost time: 27.196959733963013
Epoch: 3, Steps: 89 | Train Loss: 0.500 Vali Loss: 1.298 Vali Acc: 0.803 Test Loss: 1.298 Test Acc: 0.803
Validation loss decreased (-0.756951 --> -0.802912).  Saving model ...
Epoch: 4 cost time: 27.129618883132935
Epoch: 4, Steps: 89 | Train Loss: 0.462 Vali Loss: 0.967 Vali Acc: 0.873 Test Loss: 0.967 Test Acc: 0.873
Validation loss decreased (-0.802912 --> -0.873249).  Saving model ...
Epoch: 5 cost time: 25.669846296310425
Epoch: 5, Steps: 89 | Train Loss: 0.516 Vali Loss: 2.190 Vali Acc: 0.825 Test Loss: 2.190 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.255794525146484
Epoch: 6, Steps: 89 | Train Loss: 0.790 Vali Loss: 1.843 Vali Acc: 0.836 Test Loss: 1.843 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.980318307876587
Epoch: 7, Steps: 89 | Train Loss: 0.508 Vali Loss: 0.984 Vali Acc: 0.910 Test Loss: 0.984 Test Acc: 0.910
Validation loss decreased (-0.873249 --> -0.910157).  Saving model ...
Epoch: 8 cost time: 26.867119073867798
Epoch: 8, Steps: 89 | Train Loss: 0.542 Vali Loss: 1.203 Vali Acc: 0.905 Test Loss: 1.203 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.373141527175903
Epoch: 9, Steps: 89 | Train Loss: 0.656 Vali Loss: 1.451 Vali Acc: 0.894 Test Loss: 1.451 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.951563119888306
Epoch: 10, Steps: 89 | Train Loss: 0.557 Vali Loss: 3.006 Vali Acc: 0.859 Test Loss: 3.006 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.10438084602356
Epoch: 11, Steps: 89 | Train Loss: 0.774 Vali Loss: 1.376 Vali Acc: 0.896 Test Loss: 1.376 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 27.004091024398804
Epoch: 12, Steps: 89 | Train Loss: 0.589 Vali Loss: 0.769 Vali Acc: 0.939 Test Loss: 0.769 Test Acc: 0.939
Validation loss decreased (-0.910157 --> -0.938711).  Saving model ...
Epoch: 13 cost time: 27.040217876434326
Epoch: 13, Steps: 89 | Train Loss: 0.576 Vali Loss: 1.943 Vali Acc: 0.892 Test Loss: 1.943 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.905938863754272
Epoch: 14, Steps: 89 | Train Loss: 0.786 Vali Loss: 2.412 Vali Acc: 0.858 Test Loss: 2.412 Test Acc: 0.858
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.419047594070435
Epoch: 15, Steps: 89 | Train Loss: 0.784 Vali Loss: 1.447 Vali Acc: 0.909 Test Loss: 1.447 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.3939049243927
Epoch: 16, Steps: 89 | Train Loss: 0.680 Vali Loss: 0.811 Vali Acc: 0.946 Test Loss: 0.811 Test Acc: 0.946
Validation loss decreased (-0.938711 --> -0.945674).  Saving model ...
Epoch: 17 cost time: 25.23590588569641
Epoch: 17, Steps: 89 | Train Loss: 0.673 Vali Loss: 1.184 Vali Acc: 0.924 Test Loss: 1.184 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.131805419921875
Epoch: 18, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.963 Vali Acc: 0.937 Test Loss: 0.963 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 26.320557117462158
Epoch: 19, Steps: 89 | Train Loss: 0.816 Vali Loss: 1.007 Vali Acc: 0.935 Test Loss: 1.007 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 24.312751054763794
Epoch: 20, Steps: 89 | Train Loss: 0.443 Vali Loss: 1.398 Vali Acc: 0.928 Test Loss: 1.398 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 27.211763381958008
Epoch: 21, Steps: 89 | Train Loss: 0.576 Vali Loss: 1.923 Vali Acc: 0.901 Test Loss: 1.923 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 27.412660598754883
Epoch: 22, Steps: 89 | Train Loss: 0.835 Vali Loss: 0.892 Vali Acc: 0.945 Test Loss: 0.892 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 26.89795708656311
Epoch: 23, Steps: 89 | Train Loss: 0.552 Vali Loss: 1.645 Vali Acc: 0.925 Test Loss: 1.645 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 26.591132640838623
Epoch: 24, Steps: 89 | Train Loss: 0.536 Vali Loss: 1.067 Vali Acc: 0.937 Test Loss: 1.067 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 27.039442777633667
Epoch: 25, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.739 Vali Acc: 0.954 Test Loss: 0.739 Test Acc: 0.954
Validation loss decreased (-0.945674 --> -0.954032).  Saving model ...
Epoch: 26 cost time: 25.99357008934021
Epoch: 26, Steps: 89 | Train Loss: 0.455 Vali Loss: 0.702 Vali Acc: 0.958 Test Loss: 0.702 Test Acc: 0.958
Validation loss decreased (-0.954032 --> -0.958210).  Saving model ...
Epoch: 27 cost time: 26.685527801513672
Epoch: 27, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.812 Vali Acc: 0.939 Test Loss: 0.812 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 27.870118618011475
Epoch: 28, Steps: 89 | Train Loss: 0.283 Vali Loss: 1.083 Vali Acc: 0.953 Test Loss: 1.083 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 26.224907636642456
Epoch: 29, Steps: 89 | Train Loss: 0.416 Vali Loss: 1.030 Vali Acc: 0.937 Test Loss: 1.030 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 26.442415475845337
Epoch: 30, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.764 Vali Acc: 0.948 Test Loss: 0.764 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 28.588962078094482
Epoch: 31, Steps: 89 | Train Loss: 0.331 Vali Loss: 1.262 Vali Acc: 0.926 Test Loss: 1.262 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 25.92208743095398
Epoch: 32, Steps: 89 | Train Loss: 0.421 Vali Loss: 0.775 Vali Acc: 0.950 Test Loss: 0.775 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 26.580339670181274
Epoch: 33, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.942 Vali Acc: 0.943 Test Loss: 0.942 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 27.07304573059082
Epoch: 34, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.798 Vali Acc: 0.944 Test Loss: 0.798 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 26.6163489818573
Epoch: 35, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.008 Vali Acc: 0.942 Test Loss: 1.008 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 27.27434778213501
Epoch: 36, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.709 Vali Acc: 0.953 Test Loss: 0.709 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.74817180633545
Epoch: 1, Steps: 89 | Train Loss: 1.498 Vali Loss: 1.463 Vali Acc: 0.612 Test Loss: 1.463 Test Acc: 0.612
Validation loss decreased (inf --> -0.612102).  Saving model ...
Epoch: 2 cost time: 26.414265632629395
Epoch: 2, Steps: 89 | Train Loss: 0.473 Vali Loss: 0.751 Vali Acc: 0.818 Test Loss: 0.751 Test Acc: 0.818
Validation loss decreased (-0.612102 --> -0.817541).  Saving model ...
Epoch: 3 cost time: 27.934366703033447
Epoch: 3, Steps: 89 | Train Loss: 0.424 Vali Loss: 1.110 Vali Acc: 0.798 Test Loss: 1.110 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.099688053131104
Epoch: 4, Steps: 89 | Train Loss: 0.424 Vali Loss: 1.172 Vali Acc: 0.795 Test Loss: 1.172 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.909799575805664
Epoch: 5, Steps: 89 | Train Loss: 0.356 Vali Loss: 1.657 Vali Acc: 0.760 Test Loss: 1.657 Test Acc: 0.760
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 28.18728756904602
Epoch: 6, Steps: 89 | Train Loss: 0.532 Vali Loss: 3.182 Vali Acc: 0.728 Test Loss: 3.182 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.27043867111206
Epoch: 7, Steps: 89 | Train Loss: 0.526 Vali Loss: 1.693 Vali Acc: 0.812 Test Loss: 1.693 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 26.933400630950928
Epoch: 8, Steps: 89 | Train Loss: 0.431 Vali Loss: 2.114 Vali Acc: 0.802 Test Loss: 2.114 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 27.107205152511597
Epoch: 9, Steps: 89 | Train Loss: 0.465 Vali Loss: 2.972 Vali Acc: 0.719 Test Loss: 2.972 Test Acc: 0.719
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 26.45028853416443
Epoch: 10, Steps: 89 | Train Loss: 0.378 Vali Loss: 2.916 Vali Acc: 0.759 Test Loss: 2.916 Test Acc: 0.759
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 26.354825019836426
Epoch: 11, Steps: 89 | Train Loss: 0.523 Vali Loss: 3.083 Vali Acc: 0.704 Test Loss: 3.083 Test Acc: 0.704
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 27.245227336883545
Epoch: 12, Steps: 89 | Train Loss: 0.818 Vali Loss: 1.226 Vali Acc: 0.914 Test Loss: 1.226 Test Acc: 0.914
Validation loss decreased (-0.817541 --> -0.913637).  Saving model ...
Epoch: 13 cost time: 27.323566198349
Epoch: 13, Steps: 89 | Train Loss: 0.853 Vali Loss: 1.796 Vali Acc: 0.875 Test Loss: 1.796 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.612416744232178
Epoch: 14, Steps: 89 | Train Loss: 0.987 Vali Loss: 2.591 Vali Acc: 0.846 Test Loss: 2.591 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 28.051941871643066
Epoch: 15, Steps: 89 | Train Loss: 1.024 Vali Loss: 3.066 Vali Acc: 0.809 Test Loss: 3.066 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 27.591748476028442
Epoch: 16, Steps: 89 | Train Loss: 1.154 Vali Loss: 2.000 Vali Acc: 0.870 Test Loss: 2.000 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 27.194401025772095
Epoch: 17, Steps: 89 | Train Loss: 0.628 Vali Loss: 1.921 Vali Acc: 0.888 Test Loss: 1.921 Test Acc: 0.888
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 27.046669721603394
Epoch: 18, Steps: 89 | Train Loss: 0.865 Vali Loss: 2.348 Vali Acc: 0.887 Test Loss: 2.348 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 27.109137535095215
Epoch: 19, Steps: 89 | Train Loss: 0.853 Vali Loss: 2.606 Vali Acc: 0.893 Test Loss: 2.606 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 25.482365608215332
Epoch: 20, Steps: 89 | Train Loss: 0.970 Vali Loss: 2.348 Vali Acc: 0.909 Test Loss: 2.348 Test Acc: 0.909
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 27.072043657302856
Epoch: 21, Steps: 89 | Train Loss: 0.583 Vali Loss: 1.447 Vali Acc: 0.913 Test Loss: 1.447 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 26.66061568260193
Epoch: 22, Steps: 89 | Train Loss: 0.891 Vali Loss: 1.372 Vali Acc: 0.930 Test Loss: 1.372 Test Acc: 0.930
Validation loss decreased (-0.913637 --> -0.929652).  Saving model ...
Epoch: 23 cost time: 25.496474742889404
Epoch: 23, Steps: 89 | Train Loss: 0.459 Vali Loss: 1.648 Vali Acc: 0.927 Test Loss: 1.648 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 26.676695823669434
Epoch: 24, Steps: 89 | Train Loss: 0.620 Vali Loss: 1.293 Vali Acc: 0.938 Test Loss: 1.293 Test Acc: 0.938
Validation loss decreased (-0.929652 --> -0.938009).  Saving model ...
Epoch: 25 cost time: 27.13819932937622
Epoch: 25, Steps: 89 | Train Loss: 0.464 Vali Loss: 1.138 Vali Acc: 0.948 Test Loss: 1.138 Test Acc: 0.948
Validation loss decreased (-0.938009 --> -0.947760).  Saving model ...
Epoch: 26 cost time: 25.099716186523438
Epoch: 26, Steps: 89 | Train Loss: 0.564 Vali Loss: 1.180 Vali Acc: 0.940 Test Loss: 1.180 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 26.993398189544678
Epoch: 27, Steps: 89 | Train Loss: 0.314 Vali Loss: 1.361 Vali Acc: 0.923 Test Loss: 1.361 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 26.945716381072998
Epoch: 28, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.806 Vali Acc: 0.953 Test Loss: 0.806 Test Acc: 0.953
Validation loss decreased (-0.947760 --> -0.952638).  Saving model ...
Epoch: 29 cost time: 26.164334774017334
Epoch: 29, Steps: 89 | Train Loss: 0.264 Vali Loss: 1.669 Vali Acc: 0.914 Test Loss: 1.669 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 27.142332315444946
Epoch: 30, Steps: 89 | Train Loss: 0.480 Vali Loss: 1.713 Vali Acc: 0.919 Test Loss: 1.713 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 26.600762128829956
Epoch: 31, Steps: 89 | Train Loss: 0.241 Vali Loss: 1.231 Vali Acc: 0.946 Test Loss: 1.231 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 25.667827606201172
Epoch: 32, Steps: 89 | Train Loss: 0.353 Vali Loss: 1.314 Vali Acc: 0.931 Test Loss: 1.314 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 25.589934587478638
Epoch: 33, Steps: 89 | Train Loss: 0.311 Vali Loss: 1.006 Vali Acc: 0.949 Test Loss: 1.006 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 26.79542064666748
Epoch: 34, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.755 Vali Acc: 0.953 Test Loss: 0.755 Test Acc: 0.953
Validation loss decreased (-0.952638 --> -0.952639).  Saving model ...
Epoch: 35 cost time: 23.929166316986084
Epoch: 35, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.987 Vali Acc: 0.939 Test Loss: 0.987 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 25.89103603363037
Epoch: 36, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.883 Vali Acc: 0.944 Test Loss: 0.883 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 27.02963614463806
Epoch: 37, Steps: 89 | Train Loss: 0.305 Vali Loss: 1.033 Vali Acc: 0.945 Test Loss: 1.033 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 26.652855157852173
Epoch: 38, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.880 Vali Acc: 0.958 Test Loss: 0.880 Test Acc: 0.958
Validation loss decreased (-0.952639 --> -0.957512).  Saving model ...
Epoch: 39 cost time: 25.786438703536987
Epoch: 39, Steps: 89 | Train Loss: 0.171 Vali Loss: 1.059 Vali Acc: 0.942 Test Loss: 1.059 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 26.82111120223999
Epoch: 40, Steps: 89 | Train Loss: 0.302 Vali Loss: 1.245 Vali Acc: 0.933 Test Loss: 1.245 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 27.068350791931152
Epoch: 41, Steps: 89 | Train Loss: 0.477 Vali Loss: 0.667 Vali Acc: 0.957 Test Loss: 0.667 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 25.655259370803833
Epoch: 42, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.706 Vali Acc: 0.952 Test Loss: 0.706 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 27.255988359451294
Epoch: 43, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.728 Vali Acc: 0.962 Test Loss: 0.728 Test Acc: 0.962
Validation loss decreased (-0.957512 --> -0.961692).  Saving model ...
Epoch: 44 cost time: 27.404910802841187
Epoch: 44, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.730 Vali Acc: 0.955 Test Loss: 0.730 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 25.94227409362793
Epoch: 45, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.633 Vali Acc: 0.963 Test Loss: 0.633 Test Acc: 0.963
Validation loss decreased (-0.961692 --> -0.963086).  Saving model ...
Epoch: 46 cost time: 27.460180282592773
Epoch: 46, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.988 Vali Acc: 0.934 Test Loss: 0.988 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 27.709718465805054
Epoch: 47, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.914 Vali Acc: 0.932 Test Loss: 0.914 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 25.776859045028687
Epoch: 48, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.822 Vali Acc: 0.942 Test Loss: 0.822 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 27.38605046272278
Epoch: 49, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.731 Vali Acc: 0.949 Test Loss: 0.731 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 27.838001251220703
Epoch: 50, Steps: 89 | Train Loss: 0.245 Vali Loss: 1.198 Vali Acc: 0.929 Test Loss: 1.198 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 25.226091146469116
Epoch: 51, Steps: 89 | Train Loss: 0.139 Vali Loss: 1.197 Vali Acc: 0.930 Test Loss: 1.197 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 28.864250421524048
Epoch: 52, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.720 Vali Acc: 0.951 Test Loss: 0.720 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 28.05762028694153
Epoch: 53, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.655 Vali Acc: 0.971 Test Loss: 0.655 Test Acc: 0.971
Validation loss decreased (-0.963086 --> -0.971442).  Saving model ...
Epoch: 54 cost time: 26.211395740509033
Epoch: 54, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.619 Vali Acc: 0.967 Test Loss: 0.619 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 28.337169885635376
Epoch: 55, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.915 Vali Acc: 0.922 Test Loss: 0.915 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 28.218885898590088
Epoch: 56, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.855 Vali Acc: 0.948 Test Loss: 0.855 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 26.513503313064575
Epoch: 57, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.839 Vali Acc: 0.951 Test Loss: 0.839 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 27.82394051551819
Epoch: 58, Steps: 89 | Train Loss: 0.154 Vali Loss: 1.111 Vali Acc: 0.916 Test Loss: 1.111 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 28.058881998062134
Epoch: 59, Steps: 89 | Train Loss: 0.195 Vali Loss: 1.124 Vali Acc: 0.948 Test Loss: 1.124 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 26.0041720867157
Epoch: 60, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.687 Vali Acc: 0.961 Test Loss: 0.687 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 28.410802125930786
Epoch: 61, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.760 Vali Acc: 0.953 Test Loss: 0.760 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 27.275449991226196
Epoch: 62, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.823 Vali Acc: 0.944 Test Loss: 0.823 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 27.128795385360718
Epoch: 63, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.750 Vali Acc: 0.955 Test Loss: 0.750 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.25028157234192
Epoch: 1, Steps: 89 | Train Loss: 1.436 Vali Loss: 1.277 Vali Acc: 0.654 Test Loss: 1.277 Test Acc: 0.654
Validation loss decreased (inf --> -0.653887).  Saving model ...
Epoch: 2 cost time: 26.708102464675903
Epoch: 2, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.934 Vali Acc: 0.786 Test Loss: 0.934 Test Acc: 0.786
Validation loss decreased (-0.653887 --> -0.786202).  Saving model ...
Epoch: 3 cost time: 27.76033878326416
Epoch: 3, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.929 Vali Acc: 0.803 Test Loss: 0.929 Test Acc: 0.803
Validation loss decreased (-0.786202 --> -0.802915).  Saving model ...
Epoch: 4 cost time: 26.982222080230713
Epoch: 4, Steps: 89 | Train Loss: 0.339 Vali Loss: 2.076 Vali Acc: 0.673 Test Loss: 2.076 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.28053617477417
Epoch: 5, Steps: 89 | Train Loss: 0.252 Vali Loss: 3.854 Vali Acc: 0.623 Test Loss: 3.854 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.69215679168701
Epoch: 6, Steps: 89 | Train Loss: 0.384 Vali Loss: 4.168 Vali Acc: 0.608 Test Loss: 4.168 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.15056610107422
Epoch: 7, Steps: 89 | Train Loss: 0.438 Vali Loss: 3.210 Vali Acc: 0.648 Test Loss: 3.210 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.066717624664307
Epoch: 8, Steps: 89 | Train Loss: 0.550 Vali Loss: 4.719 Vali Acc: 0.661 Test Loss: 4.719 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.873093843460083
Epoch: 9, Steps: 89 | Train Loss: 0.457 Vali Loss: 7.367 Vali Acc: 0.503 Test Loss: 7.367 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 27.350476026535034
Epoch: 10, Steps: 89 | Train Loss: 0.502 Vali Loss: 4.059 Vali Acc: 0.721 Test Loss: 4.059 Test Acc: 0.721
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.490223169326782
Epoch: 11, Steps: 89 | Train Loss: 0.698 Vali Loss: 3.340 Vali Acc: 0.767 Test Loss: 3.340 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 27.210652351379395
Epoch: 12, Steps: 89 | Train Loss: 0.708 Vali Loss: 2.708 Vali Acc: 0.782 Test Loss: 2.708 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 26.922939777374268
Epoch: 13, Steps: 89 | Train Loss: 0.681 Vali Loss: 4.872 Vali Acc: 0.739 Test Loss: 4.872 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.802924791086351
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.466049909591675
Epoch: 1, Steps: 89 | Train Loss: 1.472 Vali Loss: 1.047 Vali Acc: 0.698 Test Loss: 1.047 Test Acc: 0.698
Validation loss decreased (inf --> -0.698457).  Saving model ...
Epoch: 2 cost time: 27.608246564865112
Epoch: 2, Steps: 89 | Train Loss: 0.410 Vali Loss: 1.026 Vali Acc: 0.802 Test Loss: 1.026 Test Acc: 0.802
Validation loss decreased (-0.698457 --> -0.802218).  Saving model ...
Epoch: 3 cost time: 28.1562397480011
Epoch: 3, Steps: 89 | Train Loss: 0.325 Vali Loss: 1.318 Vali Acc: 0.764 Test Loss: 1.318 Test Acc: 0.764
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.3728768825531
Epoch: 4, Steps: 89 | Train Loss: 0.323 Vali Loss: 4.199 Vali Acc: 0.540 Test Loss: 4.199 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.03604745864868
Epoch: 5, Steps: 89 | Train Loss: 0.251 Vali Loss: 3.099 Vali Acc: 0.726 Test Loss: 3.099 Test Acc: 0.726
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.67229652404785
Epoch: 6, Steps: 89 | Train Loss: 0.389 Vali Loss: 2.682 Vali Acc: 0.675 Test Loss: 2.682 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.58277940750122
Epoch: 7, Steps: 89 | Train Loss: 0.525 Vali Loss: 2.600 Vali Acc: 0.770 Test Loss: 2.600 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 28.20405387878418
Epoch: 8, Steps: 89 | Train Loss: 0.881 Vali Loss: 4.224 Vali Acc: 0.628 Test Loss: 4.224 Test Acc: 0.628
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 26.625789642333984
Epoch: 9, Steps: 89 | Train Loss: 0.587 Vali Loss: 4.197 Vali Acc: 0.721 Test Loss: 4.197 Test Acc: 0.721
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 27.507946014404297
Epoch: 10, Steps: 89 | Train Loss: 0.405 Vali Loss: 4.330 Vali Acc: 0.767 Test Loss: 4.330 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 27.547659158706665
Epoch: 11, Steps: 89 | Train Loss: 0.454 Vali Loss: 2.700 Vali Acc: 0.778 Test Loss: 2.700 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 27.40457844734192
Epoch: 12, Steps: 89 | Train Loss: 0.726 Vali Loss: 4.698 Vali Acc: 0.754 Test Loss: 4.698 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.8022284122562674
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.96145796775818
Epoch: 1, Steps: 89 | Train Loss: 1.494 Vali Loss: 0.968 Vali Acc: 0.713 Test Loss: 0.968 Test Acc: 0.713
Validation loss decreased (inf --> -0.713082).  Saving model ...
Epoch: 2 cost time: 27.655391454696655
Epoch: 2, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.874 Vali Acc: 0.806 Test Loss: 0.874 Test Acc: 0.806
Validation loss decreased (-0.713082 --> -0.805702).  Saving model ...
Epoch: 3 cost time: 27.36083722114563
Epoch: 3, Steps: 89 | Train Loss: 0.332 Vali Loss: 1.344 Vali Acc: 0.781 Test Loss: 1.344 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.85487389564514
Epoch: 4, Steps: 89 | Train Loss: 0.376 Vali Loss: 1.924 Vali Acc: 0.758 Test Loss: 1.924 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.11707091331482
Epoch: 5, Steps: 89 | Train Loss: 0.283 Vali Loss: 2.735 Vali Acc: 0.729 Test Loss: 2.735 Test Acc: 0.729
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.14834189414978
Epoch: 6, Steps: 89 | Train Loss: 0.497 Vali Loss: 2.113 Vali Acc: 0.720 Test Loss: 2.113 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.94922399520874
Epoch: 7, Steps: 89 | Train Loss: 0.546 Vali Loss: 4.522 Vali Acc: 0.685 Test Loss: 4.522 Test Acc: 0.685
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 26.37253189086914
Epoch: 8, Steps: 89 | Train Loss: 0.569 Vali Loss: 1.890 Vali Acc: 0.807 Test Loss: 1.890 Test Acc: 0.807
Validation loss decreased (-0.805702 --> -0.807084).  Saving model ...
Epoch: 9 cost time: 28.14124608039856
Epoch: 9, Steps: 89 | Train Loss: 0.732 Vali Loss: 2.364 Vali Acc: 0.744 Test Loss: 2.364 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.364011764526367
Epoch: 10, Steps: 89 | Train Loss: 0.588 Vali Loss: 2.463 Vali Acc: 0.808 Test Loss: 2.463 Test Acc: 0.808
Validation loss decreased (-0.807084 --> -0.807775).  Saving model ...
Epoch: 11 cost time: 25.543142557144165
Epoch: 11, Steps: 89 | Train Loss: 0.598 Vali Loss: 2.173 Vali Acc: 0.806 Test Loss: 2.173 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 27.488810777664185
Epoch: 12, Steps: 89 | Train Loss: 0.907 Vali Loss: 2.931 Vali Acc: 0.869 Test Loss: 2.931 Test Acc: 0.869
Validation loss decreased (-0.807775 --> -0.869051).  Saving model ...
Epoch: 13 cost time: 27.613616943359375
Epoch: 13, Steps: 89 | Train Loss: 0.927 Vali Loss: 2.902 Vali Acc: 0.774 Test Loss: 2.902 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.819597959518433
Epoch: 14, Steps: 89 | Train Loss: 1.081 Vali Loss: 1.973 Vali Acc: 0.861 Test Loss: 1.973 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 27.391620635986328
Epoch: 15, Steps: 89 | Train Loss: 0.770 Vali Loss: 1.660 Vali Acc: 0.884 Test Loss: 1.660 Test Acc: 0.884
Validation loss decreased (-0.869051 --> -0.883688).  Saving model ...
Epoch: 16 cost time: 27.379603147506714
Epoch: 16, Steps: 89 | Train Loss: 0.902 Vali Loss: 1.605 Vali Acc: 0.891 Test Loss: 1.605 Test Acc: 0.891
Validation loss decreased (-0.883688 --> -0.891349).  Saving model ...
Epoch: 17 cost time: 25.86805033683777
Epoch: 17, Steps: 89 | Train Loss: 0.881 Vali Loss: 1.726 Vali Acc: 0.896 Test Loss: 1.726 Test Acc: 0.896
Validation loss decreased (-0.891349 --> -0.896222).  Saving model ...
Epoch: 18 cost time: 27.485413789749146
Epoch: 18, Steps: 89 | Train Loss: 0.680 Vali Loss: 1.312 Vali Acc: 0.928 Test Loss: 1.312 Test Acc: 0.928
Validation loss decreased (-0.896222 --> -0.927563).  Saving model ...
Epoch: 19 cost time: 27.3270206451416
Epoch: 19, Steps: 89 | Train Loss: 0.743 Vali Loss: 1.838 Vali Acc: 0.878 Test Loss: 1.838 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 25.65441870689392
Epoch: 20, Steps: 89 | Train Loss: 0.590 Vali Loss: 1.070 Vali Acc: 0.923 Test Loss: 1.070 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.839475631713867
Epoch: 21, Steps: 89 | Train Loss: 0.706 Vali Loss: 1.062 Vali Acc: 0.931 Test Loss: 1.062 Test Acc: 0.931
Validation loss decreased (-0.927563 --> -0.931048).  Saving model ...
Epoch: 22 cost time: 26.73448348045349
Epoch: 22, Steps: 89 | Train Loss: 0.628 Vali Loss: 1.016 Vali Acc: 0.916 Test Loss: 1.016 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 26.47755193710327
Epoch: 23, Steps: 89 | Train Loss: 0.624 Vali Loss: 0.950 Vali Acc: 0.942 Test Loss: 0.950 Test Acc: 0.942
Validation loss decreased (-0.931048 --> -0.941495).  Saving model ...
Epoch: 24 cost time: 25.501173496246338
Epoch: 24, Steps: 89 | Train Loss: 0.528 Vali Loss: 1.721 Vali Acc: 0.896 Test Loss: 1.721 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 26.91514539718628
Epoch: 25, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.837 Vali Acc: 0.946 Test Loss: 0.837 Test Acc: 0.946
Validation loss decreased (-0.941495 --> -0.946370).  Saving model ...
Epoch: 26 cost time: 26.379353523254395
Epoch: 26, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.821 Vali Acc: 0.942 Test Loss: 0.821 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 25.106207370758057
Epoch: 27, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.969 Vali Acc: 0.937 Test Loss: 0.969 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 25.872739791870117
Epoch: 28, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.688 Vali Acc: 0.958 Test Loss: 0.688 Test Acc: 0.958
Validation loss decreased (-0.946370 --> -0.958210).  Saving model ...
Epoch: 29 cost time: 26.161808252334595
Epoch: 29, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.991 Vali Acc: 0.931 Test Loss: 0.991 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 25.30094814300537
Epoch: 30, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.765 Vali Acc: 0.950 Test Loss: 0.765 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 25.253061771392822
Epoch: 31, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.792 Vali Acc: 0.949 Test Loss: 0.792 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 25.96807885169983
Epoch: 32, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.941 Vali Acc: 0.939 Test Loss: 0.941 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 25.933528900146484
Epoch: 33, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.838 Vali Acc: 0.947 Test Loss: 0.838 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 25.44241213798523
Epoch: 34, Steps: 89 | Train Loss: 0.248 Vali Loss: 1.006 Vali Acc: 0.941 Test Loss: 1.006 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 26.760688304901123
Epoch: 35, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.816 Vali Acc: 0.951 Test Loss: 0.816 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 26.498760223388672
Epoch: 36, Steps: 89 | Train Loss: 0.268 Vali Loss: 1.157 Vali Acc: 0.925 Test Loss: 1.157 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 26.17669677734375
Epoch: 37, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.924 Vali Acc: 0.941 Test Loss: 0.924 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 27.352885484695435
Epoch: 38, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.819 Vali Acc: 0.947 Test Loss: 0.819 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.475605964660645
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.065 Test Loss: 2.996 Test Acc: 0.065
Validation loss decreased (inf --> -0.064733).  Saving model ...
Epoch: 2 cost time: 25.5949809551239
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 25.24652934074402
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 26.39918541908264
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 26.363670825958252
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 27.70952010154724
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 26.97609305381775
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 25.217549324035645
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 28.19336771965027
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 26.80185294151306
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 26.464472770690918
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 26.98548173904419
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 26.104204893112183
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 25.870549201965332
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 26.508023023605347
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 25.630088567733765
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 25.58245277404785
Epoch: 17, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 26.767789125442505
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 27.042150259017944
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 26.290074586868286
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 26.615381479263306
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 25.05268907546997
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 26.669716358184814
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 25.392759799957275
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 27.469481945037842
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 26.968530654907227
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 25.59120225906372
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 27.045748710632324
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 26.637791633605957
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 25.65731906890869
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 27.64881992340088
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 26.610918045043945
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 26.24039053916931
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 26.13488459587097
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 27.53263807296753
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 25.34999442100525
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 26.606160402297974
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 26.007322549819946
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 26.549467086791992
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 26.505932807922363
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 26.585581302642822
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 25.60572648048401
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 26.809530019760132
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 27.200457096099854
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 25.83612585067749
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 27.154966115951538
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 26.538477182388306
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 24.509164810180664
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 25.303243160247803
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 26.064579963684082
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 26.55418348312378
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 25.524704217910767
Epoch: 52, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 26.595452308654785
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 26.5276038646698
Epoch: 54, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 26.477396965026855
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 26.623156547546387
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 26.388744115829468
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 24.500548601150513
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 59 cost time: 25.86878800392151
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 60 cost time: 23.700705766677856
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 25.302417039871216
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 26.772052526474
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 26.385762214660645
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 64 cost time: 25.803091287612915
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 26.536580801010132
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 66 cost time: 26.53154993057251
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 25.54714035987854
Epoch: 67, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 27.21680474281311
Epoch: 68, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 27.00152015686035
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 26.303740739822388
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 26.920968055725098
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 72 cost time: 26.49345374107361
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 25.891390323638916
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 74 cost time: 24.835878372192383
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 24.811563968658447
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 27.054858207702637
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 26.547873497009277
Epoch: 77, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 26.135988235473633
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 27.73492455482483
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 26.550890684127808
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 24.86248517036438
Epoch: 81, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 26.608748197555542
Epoch: 82, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 26.160252571105957
Epoch: 83, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 13165588
model size : 69.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.564273595809937
Epoch: 1, Steps: 89 | Train Loss: 1.034 Vali Loss: 0.826 Vali Acc: 0.818 Test Loss: 0.826 Test Acc: 0.818
Validation loss decreased (inf --> -0.818237).  Saving model ...
Epoch: 2 cost time: 28.873462438583374
Epoch: 2, Steps: 89 | Train Loss: 0.565 Vali Loss: 0.626 Vali Acc: 0.901 Test Loss: 0.626 Test Acc: 0.901
Validation loss decreased (-0.818237 --> -0.901108).  Saving model ...
Epoch: 3 cost time: 28.448216915130615
Epoch: 3, Steps: 89 | Train Loss: 0.571 Vali Loss: 0.882 Vali Acc: 0.863 Test Loss: 0.882 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.404512405395508
Epoch: 4, Steps: 89 | Train Loss: 0.680 Vali Loss: 0.892 Vali Acc: 0.892 Test Loss: 0.892 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 28.608356714248657
Epoch: 5, Steps: 89 | Train Loss: 0.562 Vali Loss: 2.068 Vali Acc: 0.808 Test Loss: 2.068 Test Acc: 0.808
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 27.33283543586731
Epoch: 6, Steps: 89 | Train Loss: 0.703 Vali Loss: 1.198 Vali Acc: 0.901 Test Loss: 1.198 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.45047163963318
Epoch: 7, Steps: 89 | Train Loss: 0.588 Vali Loss: 1.127 Vali Acc: 0.899 Test Loss: 1.127 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 27.97626233100891
Epoch: 8, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.882 Vali Acc: 0.928 Test Loss: 0.882 Test Acc: 0.928
Validation loss decreased (-0.901108 --> -0.928264).  Saving model ...
Epoch: 9 cost time: 26.83951425552368
Epoch: 9, Steps: 89 | Train Loss: 0.582 Vali Loss: 1.462 Vali Acc: 0.900 Test Loss: 1.462 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 28.051411867141724
Epoch: 10, Steps: 89 | Train Loss: 0.663 Vali Loss: 1.503 Vali Acc: 0.914 Test Loss: 1.503 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 28.347348928451538
Epoch: 11, Steps: 89 | Train Loss: 0.801 Vali Loss: 1.418 Vali Acc: 0.906 Test Loss: 1.418 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 27.520617485046387
Epoch: 12, Steps: 89 | Train Loss: 0.687 Vali Loss: 1.389 Vali Acc: 0.894 Test Loss: 1.389 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 29.330000638961792
Epoch: 13, Steps: 89 | Train Loss: 0.751 Vali Loss: 1.087 Vali Acc: 0.929 Test Loss: 1.087 Test Acc: 0.929
Validation loss decreased (-0.928264 --> -0.928958).  Saving model ...
Epoch: 14 cost time: 28.72851037979126
Epoch: 14, Steps: 89 | Train Loss: 0.521 Vali Loss: 1.615 Vali Acc: 0.909 Test Loss: 1.615 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 27.18060278892517
Epoch: 15, Steps: 89 | Train Loss: 0.639 Vali Loss: 1.502 Vali Acc: 0.916 Test Loss: 1.502 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 29.090465545654297
Epoch: 16, Steps: 89 | Train Loss: 0.595 Vali Loss: 1.269 Vali Acc: 0.933 Test Loss: 1.269 Test Acc: 0.933
Validation loss decreased (-0.928958 --> -0.933135).  Saving model ...
Epoch: 17 cost time: 28.98280620574951
Epoch: 17, Steps: 89 | Train Loss: 0.330 Vali Loss: 1.584 Vali Acc: 0.921 Test Loss: 1.584 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.04980707168579
Epoch: 18, Steps: 89 | Train Loss: 0.337 Vali Loss: 1.075 Vali Acc: 0.939 Test Loss: 1.075 Test Acc: 0.939
Validation loss decreased (-0.933135 --> -0.939404).  Saving model ...
Epoch: 19 cost time: 28.871777057647705
Epoch: 19, Steps: 89 | Train Loss: 0.512 Vali Loss: 1.055 Vali Acc: 0.944 Test Loss: 1.055 Test Acc: 0.944
Validation loss decreased (-0.939404 --> -0.944279).  Saving model ...
Epoch: 20 cost time: 27.90692162513733
Epoch: 20, Steps: 89 | Train Loss: 0.364 Vali Loss: 1.153 Vali Acc: 0.939 Test Loss: 1.153 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 27.377177476882935
Epoch: 21, Steps: 89 | Train Loss: 0.548 Vali Loss: 2.042 Vali Acc: 0.909 Test Loss: 2.042 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 28.79031014442444
Epoch: 22, Steps: 89 | Train Loss: 0.542 Vali Loss: 2.026 Vali Acc: 0.901 Test Loss: 2.026 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 27.847488403320312
Epoch: 23, Steps: 89 | Train Loss: 0.402 Vali Loss: 1.454 Vali Acc: 0.930 Test Loss: 1.454 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 27.772549390792847
Epoch: 24, Steps: 89 | Train Loss: 0.378 Vali Loss: 1.187 Vali Acc: 0.938 Test Loss: 1.187 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 29.294344902038574
Epoch: 25, Steps: 89 | Train Loss: 0.549 Vali Loss: 1.342 Vali Acc: 0.944 Test Loss: 1.342 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 28.258102655410767
Epoch: 26, Steps: 89 | Train Loss: 0.212 Vali Loss: 1.398 Vali Acc: 0.929 Test Loss: 1.398 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 28.968188047409058
Epoch: 27, Steps: 89 | Train Loss: 0.499 Vali Loss: 1.863 Vali Acc: 0.919 Test Loss: 1.863 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 29.284356832504272
Epoch: 28, Steps: 89 | Train Loss: 0.415 Vali Loss: 1.581 Vali Acc: 0.948 Test Loss: 1.581 Test Acc: 0.948
Validation loss decreased (-0.944279 --> -0.947756).  Saving model ...
Epoch: 29 cost time: 28.09723973274231
Epoch: 29, Steps: 89 | Train Loss: 0.681 Vali Loss: 1.327 Vali Acc: 0.930 Test Loss: 1.327 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 29.22878670692444
Epoch: 30, Steps: 89 | Train Loss: 0.286 Vali Loss: 1.572 Vali Acc: 0.938 Test Loss: 1.572 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 28.62061619758606
Epoch: 31, Steps: 89 | Train Loss: 0.410 Vali Loss: 1.246 Vali Acc: 0.937 Test Loss: 1.246 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 22.784032344818115
Epoch: 32, Steps: 89 | Train Loss: 0.309 Vali Loss: 1.513 Vali Acc: 0.945 Test Loss: 1.513 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 29.14291739463806
Epoch: 33, Steps: 89 | Train Loss: 0.243 Vali Loss: 3.905 Vali Acc: 0.891 Test Loss: 3.905 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 29.357430458068848
Epoch: 34, Steps: 89 | Train Loss: 0.778 Vali Loss: 1.515 Vali Acc: 0.932 Test Loss: 1.515 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 27.716293811798096
Epoch: 35, Steps: 89 | Train Loss: 0.340 Vali Loss: 1.562 Vali Acc: 0.928 Test Loss: 1.562 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 29.313735008239746
Epoch: 36, Steps: 89 | Train Loss: 0.378 Vali Loss: 1.265 Vali Acc: 0.948 Test Loss: 1.265 Test Acc: 0.948
Validation loss decreased (-0.947756 --> -0.947759).  Saving model ...
Epoch: 37 cost time: 29.596031188964844
Epoch: 37, Steps: 89 | Train Loss: 0.184 Vali Loss: 1.656 Vali Acc: 0.939 Test Loss: 1.656 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 27.879032135009766
Epoch: 38, Steps: 89 | Train Loss: 0.296 Vali Loss: 1.644 Vali Acc: 0.927 Test Loss: 1.644 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 28.887994289398193
Epoch: 39, Steps: 89 | Train Loss: 0.343 Vali Loss: 1.575 Vali Acc: 0.925 Test Loss: 1.575 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 29.463051795959473
Epoch: 40, Steps: 89 | Train Loss: 0.162 Vali Loss: 2.063 Vali Acc: 0.925 Test Loss: 2.063 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 27.58568811416626
Epoch: 41, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.251 Vali Acc: 0.944 Test Loss: 1.251 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 28.845675468444824
Epoch: 42, Steps: 89 | Train Loss: 0.360 Vali Loss: 1.670 Vali Acc: 0.923 Test Loss: 1.670 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 29.109102964401245
Epoch: 43, Steps: 89 | Train Loss: 0.261 Vali Loss: 1.375 Vali Acc: 0.922 Test Loss: 1.375 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 27.437691926956177
Epoch: 44, Steps: 89 | Train Loss: 0.374 Vali Loss: 2.214 Vali Acc: 0.894 Test Loss: 2.214 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 28.613871574401855
Epoch: 45, Steps: 89 | Train Loss: 0.351 Vali Loss: 1.716 Vali Acc: 0.917 Test Loss: 1.716 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 29.418481588363647
Epoch: 46, Steps: 89 | Train Loss: 0.248 Vali Loss: 1.624 Vali Acc: 0.942 Test Loss: 1.624 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9477715877437326
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.685832500457764
Epoch: 1, Steps: 89 | Train Loss: 1.098 Vali Loss: 0.802 Vali Acc: 0.824 Test Loss: 0.802 Test Acc: 0.824
Validation loss decreased (inf --> -0.823808).  Saving model ...
Epoch: 2 cost time: 28.252018928527832
Epoch: 2, Steps: 89 | Train Loss: 0.697 Vali Loss: 0.624 Vali Acc: 0.873 Test Loss: 0.624 Test Acc: 0.873
Validation loss decreased (-0.823808 --> -0.872556).  Saving model ...
Epoch: 3 cost time: 26.920668363571167
Epoch: 3, Steps: 89 | Train Loss: 0.780 Vali Loss: 0.787 Vali Acc: 0.905 Test Loss: 0.787 Test Acc: 0.905
Validation loss decreased (-0.872556 --> -0.905285).  Saving model ...
Epoch: 4 cost time: 28.17789626121521
Epoch: 4, Steps: 89 | Train Loss: 0.620 Vali Loss: 1.100 Vali Acc: 0.857 Test Loss: 1.100 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 28.38740110397339
Epoch: 5, Steps: 89 | Train Loss: 0.577 Vali Loss: 1.088 Vali Acc: 0.873 Test Loss: 1.088 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.828901529312134
Epoch: 6, Steps: 89 | Train Loss: 0.669 Vali Loss: 1.309 Vali Acc: 0.882 Test Loss: 1.309 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 28.420249938964844
Epoch: 7, Steps: 89 | Train Loss: 0.820 Vali Loss: 1.748 Vali Acc: 0.857 Test Loss: 1.748 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 28.599186658859253
Epoch: 8, Steps: 89 | Train Loss: 0.686 Vali Loss: 1.207 Vali Acc: 0.905 Test Loss: 1.207 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 27.977690935134888
Epoch: 9, Steps: 89 | Train Loss: 0.471 Vali Loss: 1.571 Vali Acc: 0.887 Test Loss: 1.571 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 28.27031135559082
Epoch: 10, Steps: 89 | Train Loss: 0.563 Vali Loss: 1.384 Vali Acc: 0.908 Test Loss: 1.384 Test Acc: 0.908
Validation loss decreased (-0.905285 --> -0.908064).  Saving model ...
Epoch: 11 cost time: 28.611681699752808
Epoch: 11, Steps: 89 | Train Loss: 0.660 Vali Loss: 1.666 Vali Acc: 0.880 Test Loss: 1.666 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.530353546142578
Epoch: 12, Steps: 89 | Train Loss: 0.543 Vali Loss: 1.095 Vali Acc: 0.918 Test Loss: 1.095 Test Acc: 0.918
Validation loss decreased (-0.908064 --> -0.917816).  Saving model ...
Epoch: 13 cost time: 28.548115015029907
Epoch: 13, Steps: 89 | Train Loss: 0.849 Vali Loss: 1.182 Vali Acc: 0.930 Test Loss: 1.182 Test Acc: 0.930
Validation loss decreased (-0.917816 --> -0.929654).  Saving model ...
Epoch: 14 cost time: 28.41328501701355
Epoch: 14, Steps: 89 | Train Loss: 0.664 Vali Loss: 1.128 Vali Acc: 0.921 Test Loss: 1.128 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.819401741027832
Epoch: 15, Steps: 89 | Train Loss: 0.507 Vali Loss: 1.805 Vali Acc: 0.910 Test Loss: 1.805 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 29.412760734558105
Epoch: 16, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.916 Vali Acc: 0.937 Test Loss: 0.916 Test Acc: 0.937
Validation loss decreased (-0.929654 --> -0.937317).  Saving model ...
Epoch: 17 cost time: 29.716248273849487
Epoch: 17, Steps: 89 | Train Loss: 0.385 Vali Loss: 1.271 Vali Acc: 0.929 Test Loss: 1.271 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.06854009628296
Epoch: 18, Steps: 89 | Train Loss: 0.639 Vali Loss: 1.452 Vali Acc: 0.928 Test Loss: 1.452 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 28.086442232131958
Epoch: 19, Steps: 89 | Train Loss: 0.534 Vali Loss: 1.451 Vali Acc: 0.919 Test Loss: 1.451 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 28.290910720825195
Epoch: 20, Steps: 89 | Train Loss: 0.435 Vali Loss: 1.442 Vali Acc: 0.916 Test Loss: 1.442 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 27.150734424591064
Epoch: 21, Steps: 89 | Train Loss: 0.631 Vali Loss: 1.894 Vali Acc: 0.887 Test Loss: 1.894 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 28.019977807998657
Epoch: 22, Steps: 89 | Train Loss: 0.343 Vali Loss: 1.130 Vali Acc: 0.931 Test Loss: 1.130 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 28.487359285354614
Epoch: 23, Steps: 89 | Train Loss: 0.449 Vali Loss: 1.174 Vali Acc: 0.941 Test Loss: 1.174 Test Acc: 0.941
Validation loss decreased (-0.937317 --> -0.940796).  Saving model ...
Epoch: 24 cost time: 27.01318049430847
Epoch: 24, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.933 Vali Acc: 0.943 Test Loss: 0.933 Test Acc: 0.943
Validation loss decreased (-0.940796 --> -0.942888).  Saving model ...
Epoch: 25 cost time: 27.964248657226562
Epoch: 25, Steps: 89 | Train Loss: 0.843 Vali Loss: 0.904 Vali Acc: 0.938 Test Loss: 0.904 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 28.246728658676147
Epoch: 26, Steps: 89 | Train Loss: 0.394 Vali Loss: 1.247 Vali Acc: 0.918 Test Loss: 1.247 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 26.401105403900146
Epoch: 27, Steps: 89 | Train Loss: 0.321 Vali Loss: 1.037 Vali Acc: 0.946 Test Loss: 1.037 Test Acc: 0.946
Validation loss decreased (-0.942888 --> -0.945672).  Saving model ...
Epoch: 28 cost time: 28.62355613708496
Epoch: 28, Steps: 89 | Train Loss: 0.725 Vali Loss: 1.358 Vali Acc: 0.927 Test Loss: 1.358 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 28.007964849472046
Epoch: 29, Steps: 89 | Train Loss: 0.583 Vali Loss: 0.853 Vali Acc: 0.937 Test Loss: 0.853 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 26.403300762176514
Epoch: 30, Steps: 89 | Train Loss: 0.289 Vali Loss: 1.370 Vali Acc: 0.936 Test Loss: 1.370 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 28.416457891464233
Epoch: 31, Steps: 89 | Train Loss: 0.313 Vali Loss: 1.220 Vali Acc: 0.923 Test Loss: 1.220 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 28.483274221420288
Epoch: 32, Steps: 89 | Train Loss: 0.417 Vali Loss: 1.344 Vali Acc: 0.926 Test Loss: 1.344 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 26.333653688430786
Epoch: 33, Steps: 89 | Train Loss: 0.393 Vali Loss: 1.432 Vali Acc: 0.927 Test Loss: 1.432 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 25.13017177581787
Epoch: 34, Steps: 89 | Train Loss: 0.419 Vali Loss: 1.020 Vali Acc: 0.931 Test Loss: 1.020 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 27.72548508644104
Epoch: 35, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.904 Vali Acc: 0.948 Test Loss: 0.904 Test Acc: 0.948
Validation loss decreased (-0.945672 --> -0.948459).  Saving model ...
Epoch: 36 cost time: 28.32255721092224
Epoch: 36, Steps: 89 | Train Loss: 0.290 Vali Loss: 1.548 Vali Acc: 0.925 Test Loss: 1.548 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 26.043055057525635
Epoch: 37, Steps: 89 | Train Loss: 0.291 Vali Loss: 1.039 Vali Acc: 0.948 Test Loss: 1.039 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 27.669511318206787
Epoch: 38, Steps: 89 | Train Loss: 0.366 Vali Loss: 1.139 Vali Acc: 0.944 Test Loss: 1.139 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 27.204182624816895
Epoch: 39, Steps: 89 | Train Loss: 0.321 Vali Loss: 1.030 Vali Acc: 0.941 Test Loss: 1.030 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 26.759408235549927
Epoch: 40, Steps: 89 | Train Loss: 0.375 Vali Loss: 1.470 Vali Acc: 0.929 Test Loss: 1.470 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 28.797163009643555
Epoch: 41, Steps: 89 | Train Loss: 0.390 Vali Loss: 0.856 Vali Acc: 0.954 Test Loss: 0.856 Test Acc: 0.954
Validation loss decreased (-0.948459 --> -0.954030).  Saving model ...
Epoch: 42 cost time: 29.060022592544556
Epoch: 42, Steps: 89 | Train Loss: 0.253 Vali Loss: 1.350 Vali Acc: 0.924 Test Loss: 1.350 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 27.832129955291748
Epoch: 43, Steps: 89 | Train Loss: 0.262 Vali Loss: 1.296 Vali Acc: 0.928 Test Loss: 1.296 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 28.764739751815796
Epoch: 44, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.709 Vali Acc: 0.951 Test Loss: 0.709 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 29.00804090499878
Epoch: 45, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.946 Vali Acc: 0.957 Test Loss: 0.946 Test Acc: 0.957
Validation loss decreased (-0.954030 --> -0.956815).  Saving model ...
Epoch: 46 cost time: 28.035717010498047
Epoch: 46, Steps: 89 | Train Loss: 0.116 Vali Loss: 1.774 Vali Acc: 0.913 Test Loss: 1.774 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 29.358778715133667
Epoch: 47, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.972 Vali Acc: 0.944 Test Loss: 0.972 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 29.165690898895264
Epoch: 48, Steps: 89 | Train Loss: 0.257 Vali Loss: 1.188 Vali Acc: 0.935 Test Loss: 1.188 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 27.60611343383789
Epoch: 49, Steps: 89 | Train Loss: 0.225 Vali Loss: 1.334 Vali Acc: 0.925 Test Loss: 1.334 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 29.467893600463867
Epoch: 50, Steps: 89 | Train Loss: 0.238 Vali Loss: 1.083 Vali Acc: 0.939 Test Loss: 1.083 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 28.837965965270996
Epoch: 51, Steps: 89 | Train Loss: 0.259 Vali Loss: 1.005 Vali Acc: 0.939 Test Loss: 1.005 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 27.57846426963806
Epoch: 52, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.037 Vali Acc: 0.947 Test Loss: 1.037 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 29.313170433044434
Epoch: 53, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.911 Vali Acc: 0.963 Test Loss: 0.911 Test Acc: 0.963
Validation loss decreased (-0.956815 --> -0.963083).  Saving model ...
Epoch: 54 cost time: 28.810067415237427
Epoch: 54, Steps: 89 | Train Loss: 0.127 Vali Loss: 1.851 Vali Acc: 0.906 Test Loss: 1.851 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 28.969125270843506
Epoch: 55, Steps: 89 | Train Loss: 0.189 Vali Loss: 1.040 Vali Acc: 0.957 Test Loss: 1.040 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 28.71957230567932
Epoch: 56, Steps: 89 | Train Loss: 0.251 Vali Loss: 1.856 Vali Acc: 0.909 Test Loss: 1.856 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 28.11064052581787
Epoch: 57, Steps: 89 | Train Loss: 0.241 Vali Loss: 1.353 Vali Acc: 0.923 Test Loss: 1.353 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 29.047588109970093
Epoch: 58, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.793 Vali Acc: 0.959 Test Loss: 0.793 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 28.983835220336914
Epoch: 59, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.903 Vali Acc: 0.953 Test Loss: 0.903 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 26.82168173789978
Epoch: 60, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.951 Vali Acc: 0.945 Test Loss: 0.951 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 28.69908905029297
Epoch: 61, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.933 Vali Acc: 0.948 Test Loss: 0.933 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 28.986849069595337
Epoch: 62, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.936 Vali Acc: 0.942 Test Loss: 0.936 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 27.109710931777954
Epoch: 63, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.942 Vali Acc: 0.948 Test Loss: 0.942 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.16611337661743
Epoch: 1, Steps: 89 | Train Loss: 1.186 Vali Loss: 0.805 Vali Acc: 0.816 Test Loss: 0.805 Test Acc: 0.816
Validation loss decreased (inf --> -0.816148).  Saving model ...
Epoch: 2 cost time: 26.145199298858643
Epoch: 2, Steps: 89 | Train Loss: 0.648 Vali Loss: 0.684 Vali Acc: 0.875 Test Loss: 0.684 Test Acc: 0.875
Validation loss decreased (-0.816148 --> -0.874645).  Saving model ...
Epoch: 3 cost time: 26.214083909988403
Epoch: 3, Steps: 89 | Train Loss: 0.575 Vali Loss: 0.767 Vali Acc: 0.896 Test Loss: 0.767 Test Acc: 0.896
Validation loss decreased (-0.874645 --> -0.895536).  Saving model ...
Epoch: 4 cost time: 26.52903461456299
Epoch: 4, Steps: 89 | Train Loss: 0.538 Vali Loss: 1.015 Vali Acc: 0.903 Test Loss: 1.015 Test Acc: 0.903
Validation loss decreased (-0.895536 --> -0.902497).  Saving model ...
Epoch: 5 cost time: 26.824400901794434
Epoch: 5, Steps: 89 | Train Loss: 0.624 Vali Loss: 1.043 Vali Acc: 0.905 Test Loss: 1.043 Test Acc: 0.905
Validation loss decreased (-0.902497 --> -0.904586).  Saving model ...
Epoch: 6 cost time: 26.446688890457153
Epoch: 6, Steps: 89 | Train Loss: 0.588 Vali Loss: 1.218 Vali Acc: 0.895 Test Loss: 1.218 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.510265111923218
Epoch: 7, Steps: 89 | Train Loss: 0.660 Vali Loss: 1.329 Vali Acc: 0.896 Test Loss: 1.329 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.87690758705139
Epoch: 8, Steps: 89 | Train Loss: 0.542 Vali Loss: 0.725 Vali Acc: 0.937 Test Loss: 0.725 Test Acc: 0.937
Validation loss decreased (-0.904586 --> -0.937319).  Saving model ...
Epoch: 9 cost time: 26.028666496276855
Epoch: 9, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.978 Vali Acc: 0.907 Test Loss: 0.978 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 26.623802661895752
Epoch: 10, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.870 Vali Acc: 0.948 Test Loss: 0.870 Test Acc: 0.948
Validation loss decreased (-0.937319 --> -0.947763).  Saving model ...
Epoch: 11 cost time: 27.38356375694275
Epoch: 11, Steps: 89 | Train Loss: 0.524 Vali Loss: 1.272 Vali Acc: 0.912 Test Loss: 1.272 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.89780306816101
Epoch: 12, Steps: 89 | Train Loss: 0.492 Vali Loss: 1.259 Vali Acc: 0.929 Test Loss: 1.259 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 27.1018283367157
Epoch: 13, Steps: 89 | Train Loss: 0.570 Vali Loss: 1.438 Vali Acc: 0.903 Test Loss: 1.438 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 28.01220703125
Epoch: 14, Steps: 89 | Train Loss: 0.470 Vali Loss: 1.576 Vali Acc: 0.911 Test Loss: 1.576 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 26.127981185913086
Epoch: 15, Steps: 89 | Train Loss: 1.071 Vali Loss: 2.219 Vali Acc: 0.912 Test Loss: 2.219 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 27.430773973464966
Epoch: 16, Steps: 89 | Train Loss: 0.545 Vali Loss: 0.798 Vali Acc: 0.955 Test Loss: 0.798 Test Acc: 0.955
Validation loss decreased (-0.947763 --> -0.955424).  Saving model ...
Epoch: 17 cost time: 27.64431381225586
Epoch: 17, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.863 Vali Acc: 0.944 Test Loss: 0.863 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 26.125030755996704
Epoch: 18, Steps: 89 | Train Loss: 0.306 Vali Loss: 1.724 Vali Acc: 0.923 Test Loss: 1.724 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 26.560035467147827
Epoch: 19, Steps: 89 | Train Loss: 0.617 Vali Loss: 1.434 Vali Acc: 0.926 Test Loss: 1.434 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 27.71285367012024
Epoch: 20, Steps: 89 | Train Loss: 0.331 Vali Loss: 1.599 Vali Acc: 0.935 Test Loss: 1.599 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 27.281888484954834
Epoch: 21, Steps: 89 | Train Loss: 0.748 Vali Loss: 1.876 Vali Acc: 0.904 Test Loss: 1.876 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 27.580599546432495
Epoch: 22, Steps: 89 | Train Loss: 0.428 Vali Loss: 1.744 Vali Acc: 0.930 Test Loss: 1.744 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 28.62633228302002
Epoch: 23, Steps: 89 | Train Loss: 0.460 Vali Loss: 1.272 Vali Acc: 0.936 Test Loss: 1.272 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 27.53936767578125
Epoch: 24, Steps: 89 | Train Loss: 0.437 Vali Loss: 1.427 Vali Acc: 0.921 Test Loss: 1.427 Test Acc: 0.921
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 28.027219533920288
Epoch: 25, Steps: 89 | Train Loss: 0.556 Vali Loss: 1.808 Vali Acc: 0.909 Test Loss: 1.808 Test Acc: 0.909
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 28.254353046417236
Epoch: 26, Steps: 89 | Train Loss: 0.378 Vali Loss: 1.462 Vali Acc: 0.936 Test Loss: 1.462 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9554317548746518
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.342981576919556
Epoch: 1, Steps: 89 | Train Loss: 1.292 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
Validation loss decreased (inf --> -0.800132).  Saving model ...
Epoch: 2 cost time: 26.435548543930054
Epoch: 2, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.624 Vali Acc: 0.903 Test Loss: 0.624 Test Acc: 0.903
Validation loss decreased (-0.800132 --> -0.903197).  Saving model ...
Epoch: 3 cost time: 27.6708984375
Epoch: 3, Steps: 89 | Train Loss: 0.557 Vali Loss: 1.514 Vali Acc: 0.806 Test Loss: 1.514 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.917302131652832
Epoch: 4, Steps: 89 | Train Loss: 0.573 Vali Loss: 0.724 Vali Acc: 0.909 Test Loss: 0.724 Test Acc: 0.909
Validation loss decreased (-0.903197 --> -0.909464).  Saving model ...
Epoch: 5 cost time: 26.352052211761475
Epoch: 5, Steps: 89 | Train Loss: 0.662 Vali Loss: 1.235 Vali Acc: 0.858 Test Loss: 1.235 Test Acc: 0.858
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 26.68568754196167
Epoch: 6, Steps: 89 | Train Loss: 0.760 Vali Loss: 0.886 Vali Acc: 0.920 Test Loss: 0.886 Test Acc: 0.920
Validation loss decreased (-0.909464 --> -0.919908).  Saving model ...
Epoch: 7 cost time: 25.79265308380127
Epoch: 7, Steps: 89 | Train Loss: 0.519 Vali Loss: 1.071 Vali Acc: 0.912 Test Loss: 1.071 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.286602020263672
Epoch: 8, Steps: 89 | Train Loss: 0.807 Vali Loss: 1.905 Vali Acc: 0.868 Test Loss: 1.905 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.736951112747192
Epoch: 9, Steps: 89 | Train Loss: 0.581 Vali Loss: 1.191 Vali Acc: 0.907 Test Loss: 1.191 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.913752794265747
Epoch: 10, Steps: 89 | Train Loss: 0.404 Vali Loss: 1.372 Vali Acc: 0.906 Test Loss: 1.372 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 27.664471864700317
Epoch: 11, Steps: 89 | Train Loss: 0.648 Vali Loss: 1.857 Vali Acc: 0.864 Test Loss: 1.857 Test Acc: 0.864
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 28.004414796829224
Epoch: 12, Steps: 89 | Train Loss: 0.678 Vali Loss: 2.034 Vali Acc: 0.874 Test Loss: 2.034 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 25.294147968292236
Epoch: 13, Steps: 89 | Train Loss: 0.580 Vali Loss: 0.900 Vali Acc: 0.939 Test Loss: 0.900 Test Acc: 0.939
Validation loss decreased (-0.919908 --> -0.938710).  Saving model ...
Epoch: 14 cost time: 26.59004235267639
Epoch: 14, Steps: 89 | Train Loss: 0.506 Vali Loss: 2.140 Vali Acc: 0.896 Test Loss: 2.140 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 27.235767364501953
Epoch: 15, Steps: 89 | Train Loss: 0.817 Vali Loss: 1.081 Vali Acc: 0.951 Test Loss: 1.081 Test Acc: 0.951
Validation loss decreased (-0.938710 --> -0.950546).  Saving model ...
Epoch: 16 cost time: 26.600791454315186
Epoch: 16, Steps: 89 | Train Loss: 0.738 Vali Loss: 2.064 Vali Acc: 0.891 Test Loss: 2.064 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 27.101871252059937
Epoch: 17, Steps: 89 | Train Loss: 0.527 Vali Loss: 1.584 Vali Acc: 0.924 Test Loss: 1.584 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 28.379449129104614
Epoch: 18, Steps: 89 | Train Loss: 0.488 Vali Loss: 0.940 Vali Acc: 0.958 Test Loss: 0.940 Test Acc: 0.958
Validation loss decreased (-0.950546 --> -0.958208).  Saving model ...
Epoch: 19 cost time: 26.001636505126953
Epoch: 19, Steps: 89 | Train Loss: 0.522 Vali Loss: 1.884 Vali Acc: 0.911 Test Loss: 1.884 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 24.789103031158447
Epoch: 20, Steps: 89 | Train Loss: 0.486 Vali Loss: 3.543 Vali Acc: 0.880 Test Loss: 3.543 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 28.133283376693726
Epoch: 21, Steps: 89 | Train Loss: 0.806 Vali Loss: 1.312 Vali Acc: 0.936 Test Loss: 1.312 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 25.891337871551514
Epoch: 22, Steps: 89 | Train Loss: 0.307 Vali Loss: 2.212 Vali Acc: 0.894 Test Loss: 2.212 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 26.919543981552124
Epoch: 23, Steps: 89 | Train Loss: 0.466 Vali Loss: 1.636 Vali Acc: 0.923 Test Loss: 1.636 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 28.05523705482483
Epoch: 24, Steps: 89 | Train Loss: 0.687 Vali Loss: 1.316 Vali Acc: 0.940 Test Loss: 1.316 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 27.926280736923218
Epoch: 25, Steps: 89 | Train Loss: 0.908 Vali Loss: 2.028 Vali Acc: 0.916 Test Loss: 2.028 Test Acc: 0.916
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 26.297943830490112
Epoch: 26, Steps: 89 | Train Loss: 0.809 Vali Loss: 1.185 Vali Acc: 0.946 Test Loss: 1.185 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 27.87802290916443
Epoch: 27, Steps: 89 | Train Loss: 0.668 Vali Loss: 1.842 Vali Acc: 0.929 Test Loss: 1.842 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 27.557950735092163
Epoch: 28, Steps: 89 | Train Loss: 0.434 Vali Loss: 1.180 Vali Acc: 0.945 Test Loss: 1.180 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.137616395950317
Epoch: 1, Steps: 89 | Train Loss: 1.550 Vali Loss: 1.034 Vali Acc: 0.724 Test Loss: 1.034 Test Acc: 0.724
Validation loss decreased (inf --> -0.724224).  Saving model ...
Epoch: 2 cost time: 26.51541304588318
Epoch: 2, Steps: 89 | Train Loss: 0.564 Vali Loss: 1.080 Vali Acc: 0.769 Test Loss: 1.080 Test Acc: 0.769
Validation loss decreased (-0.724224 --> -0.768791).  Saving model ...
Epoch: 3 cost time: 26.40464973449707
Epoch: 3, Steps: 89 | Train Loss: 0.422 Vali Loss: 1.221 Vali Acc: 0.813 Test Loss: 1.221 Test Acc: 0.813
Validation loss decreased (-0.768791 --> -0.813358).  Saving model ...
Epoch: 4 cost time: 26.238932609558105
Epoch: 4, Steps: 89 | Train Loss: 0.575 Vali Loss: 0.823 Vali Acc: 0.881 Test Loss: 0.823 Test Acc: 0.881
Validation loss decreased (-0.813358 --> -0.880911).  Saving model ...
Epoch: 5 cost time: 26.538418769836426
Epoch: 5, Steps: 89 | Train Loss: 0.376 Vali Loss: 1.645 Vali Acc: 0.838 Test Loss: 1.645 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.46345067024231
Epoch: 6, Steps: 89 | Train Loss: 0.472 Vali Loss: 1.517 Vali Acc: 0.842 Test Loss: 1.517 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.16054630279541
Epoch: 7, Steps: 89 | Train Loss: 0.736 Vali Loss: 2.394 Vali Acc: 0.852 Test Loss: 2.394 Test Acc: 0.852
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.38415288925171
Epoch: 8, Steps: 89 | Train Loss: 0.729 Vali Loss: 1.611 Vali Acc: 0.877 Test Loss: 1.611 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 25.31025242805481
Epoch: 9, Steps: 89 | Train Loss: 0.570 Vali Loss: 0.862 Vali Acc: 0.930 Test Loss: 0.862 Test Acc: 0.930
Validation loss decreased (-0.880911 --> -0.929657).  Saving model ...
Epoch: 10 cost time: 26.238659143447876
Epoch: 10, Steps: 89 | Train Loss: 0.764 Vali Loss: 1.607 Vali Acc: 0.880 Test Loss: 1.607 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 26.786762714385986
Epoch: 11, Steps: 89 | Train Loss: 0.774 Vali Loss: 1.575 Vali Acc: 0.891 Test Loss: 1.575 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.60829472541809
Epoch: 12, Steps: 89 | Train Loss: 0.377 Vali Loss: 1.116 Vali Acc: 0.932 Test Loss: 1.116 Test Acc: 0.932
Validation loss decreased (-0.929657 --> -0.931744).  Saving model ...
Epoch: 13 cost time: 26.28286051750183
Epoch: 13, Steps: 89 | Train Loss: 0.593 Vali Loss: 1.515 Vali Acc: 0.903 Test Loss: 1.515 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.848226308822632
Epoch: 14, Steps: 89 | Train Loss: 0.622 Vali Loss: 1.352 Vali Acc: 0.916 Test Loss: 1.352 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 25.75281596183777
Epoch: 15, Steps: 89 | Train Loss: 0.626 Vali Loss: 0.986 Vali Acc: 0.935 Test Loss: 0.986 Test Acc: 0.935
Validation loss decreased (-0.931744 --> -0.935227).  Saving model ...
Epoch: 16 cost time: 25.521663904190063
Epoch: 16, Steps: 89 | Train Loss: 0.562 Vali Loss: 2.202 Vali Acc: 0.891 Test Loss: 2.202 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 26.69672703742981
Epoch: 17, Steps: 89 | Train Loss: 0.463 Vali Loss: 1.022 Vali Acc: 0.942 Test Loss: 1.022 Test Acc: 0.942
Validation loss decreased (-0.935227 --> -0.942190).  Saving model ...
Epoch: 18 cost time: 26.605178833007812
Epoch: 18, Steps: 89 | Train Loss: 0.517 Vali Loss: 0.939 Vali Acc: 0.950 Test Loss: 0.939 Test Acc: 0.950
Validation loss decreased (-0.942190 --> -0.949851).  Saving model ...
Epoch: 19 cost time: 23.53175163269043
Epoch: 19, Steps: 89 | Train Loss: 0.588 Vali Loss: 1.692 Vali Acc: 0.912 Test Loss: 1.692 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 25.70763373374939
Epoch: 20, Steps: 89 | Train Loss: 0.669 Vali Loss: 2.014 Vali Acc: 0.912 Test Loss: 2.014 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 27.272395849227905
Epoch: 21, Steps: 89 | Train Loss: 0.592 Vali Loss: 1.049 Vali Acc: 0.929 Test Loss: 1.049 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 26.38321828842163
Epoch: 22, Steps: 89 | Train Loss: 0.342 Vali Loss: 2.594 Vali Acc: 0.925 Test Loss: 2.594 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 27.87154984474182
Epoch: 23, Steps: 89 | Train Loss: 0.598 Vali Loss: 1.049 Vali Acc: 0.955 Test Loss: 1.049 Test Acc: 0.955
Validation loss decreased (-0.949851 --> -0.955421).  Saving model ...
Epoch: 24 cost time: 27.809903383255005
Epoch: 24, Steps: 89 | Train Loss: 0.972 Vali Loss: 2.382 Vali Acc: 0.872 Test Loss: 2.382 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 26.18454098701477
Epoch: 25, Steps: 89 | Train Loss: 0.743 Vali Loss: 1.669 Vali Acc: 0.917 Test Loss: 1.669 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 27.16013741493225
Epoch: 26, Steps: 89 | Train Loss: 0.551 Vali Loss: 1.738 Vali Acc: 0.916 Test Loss: 1.738 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 27.046698808670044
Epoch: 27, Steps: 89 | Train Loss: 0.657 Vali Loss: 1.175 Vali Acc: 0.944 Test Loss: 1.175 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 25.98860764503479
Epoch: 28, Steps: 89 | Train Loss: 0.301 Vali Loss: 1.023 Vali Acc: 0.961 Test Loss: 1.023 Test Acc: 0.961
Validation loss decreased (-0.955421 --> -0.960993).  Saving model ...
Epoch: 29 cost time: 27.306378841400146
Epoch: 29, Steps: 89 | Train Loss: 0.543 Vali Loss: 1.165 Vali Acc: 0.951 Test Loss: 1.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 27.23719048500061
Epoch: 30, Steps: 89 | Train Loss: 0.296 Vali Loss: 1.152 Vali Acc: 0.944 Test Loss: 1.152 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 25.798420429229736
Epoch: 31, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.877 Vali Acc: 0.954 Test Loss: 0.877 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 26.859144687652588
Epoch: 32, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.884 Vali Acc: 0.959 Test Loss: 0.884 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 27.34722590446472
Epoch: 33, Steps: 89 | Train Loss: 0.189 Vali Loss: 1.931 Vali Acc: 0.910 Test Loss: 1.931 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 26.249956607818604
Epoch: 34, Steps: 89 | Train Loss: 0.355 Vali Loss: 1.248 Vali Acc: 0.948 Test Loss: 1.248 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 26.86974811553955
Epoch: 35, Steps: 89 | Train Loss: 0.484 Vali Loss: 0.876 Vali Acc: 0.950 Test Loss: 0.876 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 26.645024061203003
Epoch: 36, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.966 Vali Acc: 0.945 Test Loss: 0.966 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 26.0402615070343
Epoch: 37, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.889 Vali Acc: 0.949 Test Loss: 0.889 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 27.57791757583618
Epoch: 38, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.767 Vali Acc: 0.960 Test Loss: 0.767 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.99371838569641
Epoch: 1, Steps: 89 | Train Loss: 1.475 Vali Loss: 1.130 Vali Acc: 0.682 Test Loss: 1.130 Test Acc: 0.682
Validation loss decreased (inf --> -0.681744).  Saving model ...
Epoch: 2 cost time: 26.660746574401855
Epoch: 2, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.563 Vali Acc: 0.859 Test Loss: 0.563 Test Acc: 0.859
Validation loss decreased (-0.681744 --> -0.859326).  Saving model ...
Epoch: 3 cost time: 25.217081308364868
Epoch: 3, Steps: 89 | Train Loss: 0.419 Vali Loss: 1.576 Vali Acc: 0.742 Test Loss: 1.576 Test Acc: 0.742
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.129705905914307
Epoch: 4, Steps: 89 | Train Loss: 0.435 Vali Loss: 2.305 Vali Acc: 0.661 Test Loss: 2.305 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.508148193359375
Epoch: 5, Steps: 89 | Train Loss: 0.369 Vali Loss: 2.038 Vali Acc: 0.747 Test Loss: 2.038 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.986824989318848
Epoch: 6, Steps: 89 | Train Loss: 0.439 Vali Loss: 4.740 Vali Acc: 0.592 Test Loss: 4.740 Test Acc: 0.592
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 25.87620997428894
Epoch: 7, Steps: 89 | Train Loss: 0.466 Vali Loss: 1.365 Vali Acc: 0.834 Test Loss: 1.365 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 27.082336902618408
Epoch: 8, Steps: 89 | Train Loss: 0.679 Vali Loss: 3.052 Vali Acc: 0.757 Test Loss: 3.052 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 27.12645673751831
Epoch: 9, Steps: 89 | Train Loss: 0.542 Vali Loss: 1.662 Vali Acc: 0.809 Test Loss: 1.662 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 25.45070219039917
Epoch: 10, Steps: 89 | Train Loss: 0.555 Vali Loss: 3.323 Vali Acc: 0.827 Test Loss: 3.323 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 25.89484405517578
Epoch: 11, Steps: 89 | Train Loss: 0.965 Vali Loss: 2.602 Vali Acc: 0.838 Test Loss: 2.602 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 26.583786487579346
Epoch: 12, Steps: 89 | Train Loss: 0.736 Vali Loss: 2.549 Vali Acc: 0.828 Test Loss: 2.549 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.8593314763231198
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.165051698684692
Epoch: 1, Steps: 89 | Train Loss: 1.398 Vali Loss: 1.359 Vali Acc: 0.696 Test Loss: 1.359 Test Acc: 0.696
Validation loss decreased (inf --> -0.695669).  Saving model ...
Epoch: 2 cost time: 26.587850093841553
Epoch: 2, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.665 Vali Acc: 0.847 Test Loss: 0.665 Test Acc: 0.847
Validation loss decreased (-0.695669 --> -0.847486).  Saving model ...
Epoch: 3 cost time: 26.906058311462402
Epoch: 3, Steps: 89 | Train Loss: 0.259 Vali Loss: 2.028 Vali Acc: 0.678 Test Loss: 2.028 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.52588152885437
Epoch: 4, Steps: 89 | Train Loss: 0.359 Vali Loss: 1.822 Vali Acc: 0.712 Test Loss: 1.822 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.026142835617065
Epoch: 5, Steps: 89 | Train Loss: 0.349 Vali Loss: 2.425 Vali Acc: 0.685 Test Loss: 2.425 Test Acc: 0.685
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.469102144241333
Epoch: 6, Steps: 89 | Train Loss: 0.354 Vali Loss: 2.470 Vali Acc: 0.750 Test Loss: 2.470 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 27.34588050842285
Epoch: 7, Steps: 89 | Train Loss: 0.367 Vali Loss: 4.049 Vali Acc: 0.709 Test Loss: 4.049 Test Acc: 0.709
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 25.73297429084778
Epoch: 8, Steps: 89 | Train Loss: 0.468 Vali Loss: 2.348 Vali Acc: 0.754 Test Loss: 2.348 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 27.573005199432373
Epoch: 9, Steps: 89 | Train Loss: 0.535 Vali Loss: 1.898 Vali Acc: 0.799 Test Loss: 1.898 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 27.309189081192017
Epoch: 10, Steps: 89 | Train Loss: 0.678 Vali Loss: 1.969 Vali Acc: 0.862 Test Loss: 1.969 Test Acc: 0.862
Validation loss decreased (-0.847486 --> -0.862097).  Saving model ...
Epoch: 11 cost time: 25.606702089309692
Epoch: 11, Steps: 89 | Train Loss: 0.721 Vali Loss: 2.815 Vali Acc: 0.781 Test Loss: 2.815 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.10896897315979
Epoch: 12, Steps: 89 | Train Loss: 0.645 Vali Loss: 3.259 Vali Acc: 0.777 Test Loss: 3.259 Test Acc: 0.777
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.55946946144104
Epoch: 13, Steps: 89 | Train Loss: 0.640 Vali Loss: 2.262 Vali Acc: 0.818 Test Loss: 2.262 Test Acc: 0.818
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.99812340736389
Epoch: 14, Steps: 89 | Train Loss: 0.655 Vali Loss: 2.334 Vali Acc: 0.854 Test Loss: 2.334 Test Acc: 0.854
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 26.96544337272644
Epoch: 15, Steps: 89 | Train Loss: 0.718 Vali Loss: 1.859 Vali Acc: 0.877 Test Loss: 1.859 Test Acc: 0.877
Validation loss decreased (-0.862097 --> -0.877419).  Saving model ...
Epoch: 16 cost time: 26.6860032081604
Epoch: 16, Steps: 89 | Train Loss: 0.897 Vali Loss: 1.970 Vali Acc: 0.871 Test Loss: 1.970 Test Acc: 0.871
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 26.57126021385193
Epoch: 17, Steps: 89 | Train Loss: 0.872 Vali Loss: 2.425 Vali Acc: 0.860 Test Loss: 2.425 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 26.38612723350525
Epoch: 18, Steps: 89 | Train Loss: 0.425 Vali Loss: 1.134 Vali Acc: 0.930 Test Loss: 1.134 Test Acc: 0.930
Validation loss decreased (-0.877419 --> -0.930351).  Saving model ...
Epoch: 19 cost time: 26.220139980316162
Epoch: 19, Steps: 89 | Train Loss: 0.464 Vali Loss: 1.964 Vali Acc: 0.898 Test Loss: 1.964 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 25.760305881500244
Epoch: 20, Steps: 89 | Train Loss: 0.427 Vali Loss: 2.101 Vali Acc: 0.883 Test Loss: 2.101 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 26.135504961013794
Epoch: 21, Steps: 89 | Train Loss: 0.976 Vali Loss: 1.427 Vali Acc: 0.916 Test Loss: 1.427 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 26.243016719818115
Epoch: 22, Steps: 89 | Train Loss: 0.508 Vali Loss: 2.366 Vali Acc: 0.889 Test Loss: 2.366 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 26.62598466873169
Epoch: 23, Steps: 89 | Train Loss: 0.465 Vali Loss: 1.385 Vali Acc: 0.921 Test Loss: 1.385 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 25.93838882446289
Epoch: 24, Steps: 89 | Train Loss: 0.586 Vali Loss: 1.573 Vali Acc: 0.922 Test Loss: 1.573 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 27.187540531158447
Epoch: 25, Steps: 89 | Train Loss: 0.441 Vali Loss: 1.161 Vali Acc: 0.932 Test Loss: 1.161 Test Acc: 0.932
Validation loss decreased (-0.930351 --> -0.932440).  Saving model ...
Epoch: 26 cost time: 26.033084392547607
Epoch: 26, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.872 Vali Acc: 0.952 Test Loss: 0.872 Test Acc: 0.952
Validation loss decreased (-0.932440 --> -0.951941).  Saving model ...
Epoch: 27 cost time: 25.771228075027466
Epoch: 27, Steps: 89 | Train Loss: 0.356 Vali Loss: 1.006 Vali Acc: 0.944 Test Loss: 1.006 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 26.898019313812256
Epoch: 28, Steps: 89 | Train Loss: 0.527 Vali Loss: 1.067 Vali Acc: 0.948 Test Loss: 1.067 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 26.698296308517456
Epoch: 29, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.871 Vali Acc: 0.959 Test Loss: 0.871 Test Acc: 0.959
Validation loss decreased (-0.951941 --> -0.958905).  Saving model ...
Epoch: 30 cost time: 27.01825213432312
Epoch: 30, Steps: 89 | Train Loss: 0.250 Vali Loss: 1.026 Vali Acc: 0.948 Test Loss: 1.026 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 26.518237829208374
Epoch: 31, Steps: 89 | Train Loss: 0.119 Vali Loss: 1.253 Vali Acc: 0.951 Test Loss: 1.253 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 25.878936767578125
Epoch: 32, Steps: 89 | Train Loss: 0.237 Vali Loss: 1.207 Vali Acc: 0.947 Test Loss: 1.207 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 26.666903972625732
Epoch: 33, Steps: 89 | Train Loss: 0.378 Vali Loss: 1.391 Vali Acc: 0.935 Test Loss: 1.391 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 26.956444025039673
Epoch: 34, Steps: 89 | Train Loss: 0.344 Vali Loss: 1.061 Vali Acc: 0.949 Test Loss: 1.061 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 26.940157413482666
Epoch: 35, Steps: 89 | Train Loss: 0.291 Vali Loss: 1.086 Vali Acc: 0.942 Test Loss: 1.086 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 26.31392002105713
Epoch: 36, Steps: 89 | Train Loss: 0.330 Vali Loss: 0.931 Vali Acc: 0.951 Test Loss: 0.931 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 25.079144716262817
Epoch: 37, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.862 Vali Acc: 0.962 Test Loss: 0.862 Test Acc: 0.962
Validation loss decreased (-0.958905 --> -0.962387).  Saving model ...
Epoch: 38 cost time: 27.67083716392517
Epoch: 38, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.926 Vali Acc: 0.958 Test Loss: 0.926 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 26.37436604499817
Epoch: 39, Steps: 89 | Train Loss: 0.351 Vali Loss: 1.011 Vali Acc: 0.946 Test Loss: 1.011 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 26.610401391983032
Epoch: 40, Steps: 89 | Train Loss: 0.379 Vali Loss: 1.498 Vali Acc: 0.928 Test Loss: 1.498 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 26.696661949157715
Epoch: 41, Steps: 89 | Train Loss: 0.389 Vali Loss: 1.204 Vali Acc: 0.940 Test Loss: 1.204 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 26.416950702667236
Epoch: 42, Steps: 89 | Train Loss: 0.251 Vali Loss: 1.368 Vali Acc: 0.923 Test Loss: 1.368 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 26.697798013687134
Epoch: 43, Steps: 89 | Train Loss: 0.324 Vali Loss: 1.159 Vali Acc: 0.937 Test Loss: 1.159 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 26.705021619796753
Epoch: 44, Steps: 89 | Train Loss: 0.503 Vali Loss: 0.880 Vali Acc: 0.956 Test Loss: 0.880 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 26.383203744888306
Epoch: 45, Steps: 89 | Train Loss: 0.206 Vali Loss: 1.701 Vali Acc: 0.912 Test Loss: 1.701 Test Acc: 0.912
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 26.521492958068848
Epoch: 46, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.711 Vali Acc: 0.924 Test Loss: 1.711 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 26.88631558418274
Epoch: 47, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.768 Vali Acc: 0.962 Test Loss: 0.768 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.313100337982178
Epoch: 1, Steps: 89 | Train Loss: 1.425 Vali Loss: 1.618 Vali Acc: 0.650 Test Loss: 1.618 Test Acc: 0.650
Validation loss decreased (inf --> -0.650402).  Saving model ...
Epoch: 2 cost time: 28.036048650741577
Epoch: 2, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.852 Vali Acc: 0.816 Test Loss: 0.852 Test Acc: 0.816
Validation loss decreased (-0.650402 --> -0.816147).  Saving model ...
Epoch: 3 cost time: 27.356764316558838
Epoch: 3, Steps: 89 | Train Loss: 0.316 Vali Loss: 2.321 Vali Acc: 0.636 Test Loss: 2.321 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.65128183364868
Epoch: 4, Steps: 89 | Train Loss: 0.329 Vali Loss: 3.036 Vali Acc: 0.607 Test Loss: 3.036 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.35066533088684
Epoch: 5, Steps: 89 | Train Loss: 0.301 Vali Loss: 2.390 Vali Acc: 0.726 Test Loss: 2.390 Test Acc: 0.726
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.83716106414795
Epoch: 6, Steps: 89 | Train Loss: 0.276 Vali Loss: 1.322 Vali Acc: 0.823 Test Loss: 1.322 Test Acc: 0.823
Validation loss decreased (-0.816147 --> -0.823107).  Saving model ...
Epoch: 7 cost time: 27.564085245132446
Epoch: 7, Steps: 89 | Train Loss: 0.294 Vali Loss: 3.619 Vali Acc: 0.650 Test Loss: 3.619 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.54441499710083
Epoch: 8, Steps: 89 | Train Loss: 0.495 Vali Loss: 3.020 Vali Acc: 0.753 Test Loss: 3.020 Test Acc: 0.753
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.692724466323853
Epoch: 9, Steps: 89 | Train Loss: 0.686 Vali Loss: 2.286 Vali Acc: 0.810 Test Loss: 2.286 Test Acc: 0.810
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.458775281906128
Epoch: 10, Steps: 89 | Train Loss: 0.552 Vali Loss: 1.493 Vali Acc: 0.845 Test Loss: 1.493 Test Acc: 0.845
Validation loss decreased (-0.823107 --> -0.845389).  Saving model ...
Epoch: 11 cost time: 26.943923711776733
Epoch: 11, Steps: 89 | Train Loss: 0.581 Vali Loss: 3.515 Vali Acc: 0.715 Test Loss: 3.515 Test Acc: 0.715
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.736935138702393
Epoch: 12, Steps: 89 | Train Loss: 0.651 Vali Loss: 4.416 Vali Acc: 0.788 Test Loss: 4.416 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.955089569091797
Epoch: 13, Steps: 89 | Train Loss: 0.669 Vali Loss: 4.143 Vali Acc: 0.721 Test Loss: 4.143 Test Acc: 0.721
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 27.283238649368286
Epoch: 14, Steps: 89 | Train Loss: 0.674 Vali Loss: 3.043 Vali Acc: 0.834 Test Loss: 3.043 Test Acc: 0.834
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 27.403918027877808
Epoch: 15, Steps: 89 | Train Loss: 0.509 Vali Loss: 2.037 Vali Acc: 0.847 Test Loss: 2.037 Test Acc: 0.847
Validation loss decreased (-0.845389 --> -0.846776).  Saving model ...
Epoch: 16 cost time: 27.4129798412323
Epoch: 16, Steps: 89 | Train Loss: 0.571 Vali Loss: 3.975 Vali Acc: 0.774 Test Loss: 3.975 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 26.975307941436768
Epoch: 17, Steps: 89 | Train Loss: 0.788 Vali Loss: 1.692 Vali Acc: 0.890 Test Loss: 1.692 Test Acc: 0.890
Validation loss decreased (-0.846776 --> -0.889955).  Saving model ...
Epoch: 18 cost time: 28.22254490852356
Epoch: 18, Steps: 89 | Train Loss: 0.817 Vali Loss: 1.839 Vali Acc: 0.878 Test Loss: 1.839 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 24.904554843902588
Epoch: 19, Steps: 89 | Train Loss: 1.102 Vali Loss: 1.640 Vali Acc: 0.908 Test Loss: 1.640 Test Acc: 0.908
Validation loss decreased (-0.889955 --> -0.908062).  Saving model ...
Epoch: 20 cost time: 27.05142378807068
Epoch: 20, Steps: 89 | Train Loss: 0.868 Vali Loss: 2.265 Vali Acc: 0.864 Test Loss: 2.265 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 27.813473224639893
Epoch: 21, Steps: 89 | Train Loss: 1.045 Vali Loss: 1.591 Vali Acc: 0.889 Test Loss: 1.591 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 26.545214414596558
Epoch: 22, Steps: 89 | Train Loss: 0.547 Vali Loss: 1.148 Vali Acc: 0.927 Test Loss: 1.148 Test Acc: 0.927
Validation loss decreased (-0.908062 --> -0.926869).  Saving model ...
Epoch: 23 cost time: 27.264725923538208
Epoch: 23, Steps: 89 | Train Loss: 0.391 Vali Loss: 1.243 Vali Acc: 0.932 Test Loss: 1.243 Test Acc: 0.932
Validation loss decreased (-0.926869 --> -0.931742).  Saving model ...
Epoch: 24 cost time: 28.022979259490967
Epoch: 24, Steps: 89 | Train Loss: 0.530 Vali Loss: 1.317 Vali Acc: 0.928 Test Loss: 1.317 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 26.499961376190186
Epoch: 25, Steps: 89 | Train Loss: 0.552 Vali Loss: 1.027 Vali Acc: 0.926 Test Loss: 1.027 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 27.026113033294678
Epoch: 26, Steps: 89 | Train Loss: 0.539 Vali Loss: 0.799 Vali Acc: 0.951 Test Loss: 0.799 Test Acc: 0.951
Validation loss decreased (-0.931742 --> -0.951245).  Saving model ...
Epoch: 27 cost time: 26.769912004470825
Epoch: 27, Steps: 89 | Train Loss: 0.406 Vali Loss: 1.554 Vali Acc: 0.923 Test Loss: 1.554 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 25.888758897781372
Epoch: 28, Steps: 89 | Train Loss: 0.370 Vali Loss: 1.111 Vali Acc: 0.952 Test Loss: 1.111 Test Acc: 0.952
Validation loss decreased (-0.951245 --> -0.951939).  Saving model ...
Epoch: 29 cost time: 28.916583776474
Epoch: 29, Steps: 89 | Train Loss: 0.322 Vali Loss: 1.151 Vali Acc: 0.937 Test Loss: 1.151 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 28.544175148010254
Epoch: 30, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.825 Vali Acc: 0.946 Test Loss: 0.825 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 26.979089498519897
Epoch: 31, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.730 Vali Acc: 0.958 Test Loss: 0.730 Test Acc: 0.958
Validation loss decreased (-0.951939 --> -0.958210).  Saving model ...
Epoch: 32 cost time: 27.415095329284668
Epoch: 32, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.794 Vali Acc: 0.944 Test Loss: 0.794 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 27.48278284072876
Epoch: 33, Steps: 89 | Train Loss: 0.264 Vali Loss: 1.241 Vali Acc: 0.942 Test Loss: 1.241 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 28.049140214920044
Epoch: 34, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.080 Vali Acc: 0.943 Test Loss: 1.080 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 27.417590379714966
Epoch: 35, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.983 Vali Acc: 0.943 Test Loss: 0.983 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 26.892804622650146
Epoch: 36, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.723 Vali Acc: 0.957 Test Loss: 0.723 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 27.11263418197632
Epoch: 37, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.691 Vali Acc: 0.961 Test Loss: 0.691 Test Acc: 0.961
Validation loss decreased (-0.958210 --> -0.960996).  Saving model ...
Epoch: 38 cost time: 28.031781673431396
Epoch: 38, Steps: 89 | Train Loss: 0.421 Vali Loss: 0.923 Vali Acc: 0.943 Test Loss: 0.923 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 27.95984172821045
Epoch: 39, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.907 Vali Acc: 0.945 Test Loss: 0.907 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 27.111767530441284
Epoch: 40, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.977 Vali Acc: 0.946 Test Loss: 0.977 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 27.879320859909058
Epoch: 41, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.973 Vali Acc: 0.940 Test Loss: 0.973 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 28.56991934776306
Epoch: 42, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.850 Vali Acc: 0.958 Test Loss: 0.850 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 26.62780475616455
Epoch: 43, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.647 Vali Acc: 0.947 Test Loss: 0.647 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 27.893582582473755
Epoch: 44, Steps: 89 | Train Loss: 0.234 Vali Loss: 1.409 Vali Acc: 0.921 Test Loss: 1.409 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 27.55420994758606
Epoch: 45, Steps: 89 | Train Loss: 0.263 Vali Loss: 1.056 Vali Acc: 0.932 Test Loss: 1.056 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 27.020625591278076
Epoch: 46, Steps: 89 | Train Loss: 0.334 Vali Loss: 1.864 Vali Acc: 0.912 Test Loss: 1.864 Test Acc: 0.912
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 28.45847797393799
Epoch: 47, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.808 Vali Acc: 0.950 Test Loss: 0.808 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.14128804206848
Epoch: 1, Steps: 89 | Train Loss: 1.460 Vali Loss: 1.493 Vali Acc: 0.663 Test Loss: 1.493 Test Acc: 0.663
Validation loss decreased (inf --> -0.662938).  Saving model ...
Epoch: 2 cost time: 26.686872482299805
Epoch: 2, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.986 Vali Acc: 0.794 Test Loss: 0.986 Test Acc: 0.794
Validation loss decreased (-0.662938 --> -0.793862).  Saving model ...
Epoch: 3 cost time: 27.449532508850098
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 2.226 Vali Acc: 0.649 Test Loss: 2.226 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 27.19687557220459
Epoch: 4, Steps: 89 | Train Loss: 0.362 Vali Loss: 3.182 Vali Acc: 0.652 Test Loss: 3.182 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.972405672073364
Epoch: 5, Steps: 89 | Train Loss: 0.441 Vali Loss: 2.496 Vali Acc: 0.667 Test Loss: 2.496 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 26.154690504074097
Epoch: 6, Steps: 89 | Train Loss: 0.390 Vali Loss: 1.504 Vali Acc: 0.852 Test Loss: 1.504 Test Acc: 0.852
Validation loss decreased (-0.793862 --> -0.851656).  Saving model ...
Epoch: 7 cost time: 26.485079288482666
Epoch: 7, Steps: 89 | Train Loss: 0.356 Vali Loss: 3.389 Vali Acc: 0.677 Test Loss: 3.389 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.00285267829895
Epoch: 8, Steps: 89 | Train Loss: 0.677 Vali Loss: 2.322 Vali Acc: 0.810 Test Loss: 2.322 Test Acc: 0.810
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.853196144104004
Epoch: 9, Steps: 89 | Train Loss: 0.597 Vali Loss: 4.117 Vali Acc: 0.652 Test Loss: 4.117 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 26.40300703048706
Epoch: 10, Steps: 89 | Train Loss: 0.527 Vali Loss: 4.481 Vali Acc: 0.723 Test Loss: 4.481 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 25.974072456359863
Epoch: 11, Steps: 89 | Train Loss: 0.696 Vali Loss: 2.418 Vali Acc: 0.792 Test Loss: 2.418 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 27.221982955932617
Epoch: 12, Steps: 89 | Train Loss: 0.718 Vali Loss: 7.060 Vali Acc: 0.724 Test Loss: 7.060 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 24.810215950012207
Epoch: 13, Steps: 89 | Train Loss: 0.829 Vali Loss: 3.274 Vali Acc: 0.790 Test Loss: 3.274 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 26.648241758346558
Epoch: 14, Steps: 89 | Train Loss: 0.710 Vali Loss: 2.337 Vali Acc: 0.811 Test Loss: 2.337 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 26.83440399169922
Epoch: 15, Steps: 89 | Train Loss: 0.923 Vali Loss: 1.779 Vali Acc: 0.873 Test Loss: 1.779 Test Acc: 0.873
Validation loss decreased (-0.851656 --> -0.873241).  Saving model ...
Epoch: 16 cost time: 23.773812294006348
Epoch: 16, Steps: 89 | Train Loss: 0.918 Vali Loss: 2.195 Vali Acc: 0.843 Test Loss: 2.195 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.768768310546875
Epoch: 17, Steps: 89 | Train Loss: 0.999 Vali Loss: 1.940 Vali Acc: 0.881 Test Loss: 1.940 Test Acc: 0.881
Validation loss decreased (-0.873241 --> -0.880900).  Saving model ...
Epoch: 18 cost time: 25.77138376235962
Epoch: 18, Steps: 89 | Train Loss: 0.943 Vali Loss: 1.285 Vali Acc: 0.916 Test Loss: 1.285 Test Acc: 0.916
Validation loss decreased (-0.880900 --> -0.915725).  Saving model ...
Epoch: 19 cost time: 24.991532802581787
Epoch: 19, Steps: 89 | Train Loss: 0.838 Vali Loss: 2.943 Vali Acc: 0.877 Test Loss: 2.943 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 26.973897457122803
Epoch: 20, Steps: 89 | Train Loss: 0.904 Vali Loss: 1.867 Vali Acc: 0.881 Test Loss: 1.867 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 25.83125615119934
Epoch: 21, Steps: 89 | Train Loss: 0.724 Vali Loss: 1.421 Vali Acc: 0.902 Test Loss: 1.421 Test Acc: 0.902
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.763357877731323
Epoch: 22, Steps: 89 | Train Loss: 0.574 Vali Loss: 1.675 Vali Acc: 0.923 Test Loss: 1.675 Test Acc: 0.923
Validation loss decreased (-0.915725 --> -0.923382).  Saving model ...
Epoch: 23 cost time: 25.65022087097168
Epoch: 23, Steps: 89 | Train Loss: 0.550 Vali Loss: 1.932 Vali Acc: 0.927 Test Loss: 1.932 Test Acc: 0.927
Validation loss decreased (-0.923382 --> -0.926861).  Saving model ...
Epoch: 24 cost time: 25.67539405822754
Epoch: 24, Steps: 89 | Train Loss: 0.784 Vali Loss: 1.186 Vali Acc: 0.936 Test Loss: 1.186 Test Acc: 0.936
Validation loss decreased (-0.926861 --> -0.935921).  Saving model ...
Epoch: 25 cost time: 24.97942614555359
Epoch: 25, Steps: 89 | Train Loss: 0.603 Vali Loss: 1.462 Vali Acc: 0.923 Test Loss: 1.462 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 24.205554485321045
Epoch: 26, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.851 Vali Acc: 0.949 Test Loss: 0.851 Test Acc: 0.949
Validation loss decreased (-0.935921 --> -0.949156).  Saving model ...
Epoch: 27 cost time: 25.945333003997803
Epoch: 27, Steps: 89 | Train Loss: 0.491 Vali Loss: 1.259 Vali Acc: 0.938 Test Loss: 1.259 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 26.563106775283813
Epoch: 28, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.721 Vali Acc: 0.959 Test Loss: 0.721 Test Acc: 0.959
Validation loss decreased (-0.949156 --> -0.958906).  Saving model ...
Epoch: 29 cost time: 25.227290153503418
Epoch: 29, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.682 Vali Acc: 0.957 Test Loss: 0.682 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 25.80144429206848
Epoch: 30, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.953 Vali Acc: 0.947 Test Loss: 0.953 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 25.653053283691406
Epoch: 31, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.877 Vali Acc: 0.944 Test Loss: 0.877 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 25.81568455696106
Epoch: 32, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.961 Vali Acc: 0.942 Test Loss: 0.961 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 25.940454483032227
Epoch: 33, Steps: 89 | Train Loss: 0.240 Vali Loss: 1.129 Vali Acc: 0.939 Test Loss: 1.129 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 26.907496213912964
Epoch: 34, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.947 Vali Acc: 0.944 Test Loss: 0.947 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 26.09056544303894
Epoch: 35, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.829 Vali Acc: 0.942 Test Loss: 0.829 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 25.936269998550415
Epoch: 36, Steps: 89 | Train Loss: 0.227 Vali Loss: 1.016 Vali Acc: 0.937 Test Loss: 1.016 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 26.258936166763306
Epoch: 37, Steps: 89 | Train Loss: 0.150 Vali Loss: 1.157 Vali Acc: 0.928 Test Loss: 1.157 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 25.925597429275513
Epoch: 38, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.787 Vali Acc: 0.951 Test Loss: 0.787 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.436182737350464
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.061 Test Loss: 2.996 Test Acc: 0.061
Validation loss decreased (inf --> -0.060555).  Saving model ...
Epoch: 2 cost time: 26.548136234283447
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 3 cost time: 26.53769326210022
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.060555 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 26.82243299484253
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 26.304609060287476
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 27.27930450439453
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 25.547659873962402
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 26.310405492782593
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 27.083475589752197
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 25.6895694732666
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 26.25447106361389
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 26.494860887527466
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 26.461844444274902
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 26.904826879501343
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 27.2931227684021
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 26.161104202270508
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 26.524137020111084
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 26.408143281936646
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.39470887184143
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 26.863701820373535
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 25.833483457565308
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 25.434109687805176
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 25.659751892089844
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 26.41302466392517
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 26.23039722442627
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 25.299262046813965
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 25.612022399902344
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 26.46436858177185
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 25.658406734466553
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 26.492461681365967
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 26.20987343788147
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 25.575613975524902
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 26.213784217834473
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 25.64594078063965
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.69294762611389
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 26.331380367279053
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 25.896218061447144
Epoch: 37, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 25.30987238883972
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 26.131829500198364
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 26.88552713394165
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 25.175350666046143
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 25.16960096359253
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 25.729159116744995
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 26.78109312057495
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 26.222683668136597
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 25.04427695274353
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 25.895829439163208
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 26.45163059234619
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 25.470022916793823
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 26.42292332649231
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 26.227747201919556
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 25.508729696273804
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 25.463062524795532
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 25.465187788009644
Epoch: 54, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 25.81609344482422
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 25.025994062423706
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 25.37195324897766
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 25.73780083656311
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 24.9733669757843
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 60 cost time: 26.0524582862854
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 61 cost time: 26.358011960983276
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 26.063716173171997
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 26.02215838432312
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 64 cost time: 26.266640424728394
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 25.556349277496338
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 26.650532245635986
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 26.950223207473755
Epoch: 67, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 68 cost time: 26.447944164276123
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 26.8672034740448
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 25.906302213668823
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 71 cost time: 26.817030429840088
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 26.087873220443726
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 26.245892763137817
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 26.372243881225586
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 26.85076117515564
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 26.60825777053833
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 25.787822484970093
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 26.512536764144897
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 26.562185764312744
Epoch: 79, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 26.338175058364868
Epoch: 80, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 12772372
model size : 68.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.02155375480652
Epoch: 1, Steps: 89 | Train Loss: 1.130 Vali Loss: 0.642 Vali Acc: 0.832 Test Loss: 0.642 Test Acc: 0.832
Validation loss decreased (inf --> -0.832166).  Saving model ...
Epoch: 2 cost time: 25.549275159835815
Epoch: 2, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.366 Vali Acc: 0.916 Test Loss: 0.366 Test Acc: 0.916
Validation loss decreased (-0.832166 --> -0.915734).  Saving model ...
Epoch: 3 cost time: 25.657655239105225
Epoch: 3, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.450 Vali Acc: 0.903 Test Loss: 0.450 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.857379913330078
Epoch: 4, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.688 Vali Acc: 0.871 Test Loss: 0.688 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.0325288772583
Epoch: 5, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.449 Vali Acc: 0.921 Test Loss: 0.449 Test Acc: 0.921
Validation loss decreased (-0.915734 --> -0.920608).  Saving model ...
Epoch: 6 cost time: 22.70722460746765
Epoch: 6, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.547 Vali Acc: 0.916 Test Loss: 0.547 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.013320922851562
Epoch: 7, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.765 Vali Acc: 0.928 Test Loss: 0.765 Test Acc: 0.928
Validation loss decreased (-0.920608 --> -0.928265).  Saving model ...
Epoch: 8 cost time: 24.990015506744385
Epoch: 8, Steps: 89 | Train Loss: 0.370 Vali Loss: 1.112 Vali Acc: 0.872 Test Loss: 1.112 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.492173433303833
Epoch: 9, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.743 Vali Acc: 0.914 Test Loss: 0.743 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.25707721710205
Epoch: 10, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.722 Vali Acc: 0.915 Test Loss: 0.722 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.42236042022705
Epoch: 11, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.680 Vali Acc: 0.926 Test Loss: 0.680 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 24.356680631637573
Epoch: 12, Steps: 89 | Train Loss: 0.367 Vali Loss: 1.538 Vali Acc: 0.889 Test Loss: 1.538 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 24.752644300460815
Epoch: 13, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.747 Vali Acc: 0.930 Test Loss: 0.747 Test Acc: 0.930
Validation loss decreased (-0.928265 --> -0.929658).  Saving model ...
Epoch: 14 cost time: 25.514941453933716
Epoch: 14, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.973 Vali Acc: 0.907 Test Loss: 0.973 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.83157992362976
Epoch: 15, Steps: 89 | Train Loss: 0.338 Vali Loss: 1.217 Vali Acc: 0.902 Test Loss: 1.217 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 26.16088628768921
Epoch: 16, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.743 Vali Acc: 0.942 Test Loss: 0.743 Test Acc: 0.942
Validation loss decreased (-0.929658 --> -0.941497).  Saving model ...
Epoch: 17 cost time: 25.07346200942993
Epoch: 17, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.677 Vali Acc: 0.940 Test Loss: 0.677 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 24.820300102233887
Epoch: 18, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.775 Vali Acc: 0.932 Test Loss: 0.775 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 24.56138515472412
Epoch: 19, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.589 Vali Acc: 0.954 Test Loss: 0.589 Test Acc: 0.954
Validation loss decreased (-0.941497 --> -0.954033).  Saving model ...
Epoch: 20 cost time: 24.120599508285522
Epoch: 20, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.909 Vali Acc: 0.921 Test Loss: 0.909 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.40729856491089
Epoch: 21, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.736 Vali Acc: 0.934 Test Loss: 0.736 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.867513179779053
Epoch: 22, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.833 Vali Acc: 0.928 Test Loss: 0.833 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 24.661019563674927
Epoch: 23, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.775 Vali Acc: 0.942 Test Loss: 0.775 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 26.008687496185303
Epoch: 24, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.677 Vali Acc: 0.948 Test Loss: 0.677 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 24.831382751464844
Epoch: 25, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.547 Vali Acc: 0.955 Test Loss: 0.547 Test Acc: 0.955
Validation loss decreased (-0.954033 --> -0.955426).  Saving model ...
Epoch: 26 cost time: 25.840423583984375
Epoch: 26, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.799 Vali Acc: 0.926 Test Loss: 0.799 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 24.978325366973877
Epoch: 27, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.913 Vali Acc: 0.935 Test Loss: 0.913 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 25.367278575897217
Epoch: 28, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.564 Vali Acc: 0.955 Test Loss: 0.564 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 27.191622734069824
Epoch: 29, Steps: 89 | Train Loss: 0.070 Vali Loss: 1.215 Vali Acc: 0.908 Test Loss: 1.215 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 27.37232756614685
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 1.217 Vali Acc: 0.909 Test Loss: 1.217 Test Acc: 0.909
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 28.06046223640442
Epoch: 31, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.891 Vali Acc: 0.939 Test Loss: 0.891 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 26.381638765335083
Epoch: 32, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.077 Vali Acc: 0.925 Test Loss: 1.077 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 26.864133596420288
Epoch: 33, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.811 Vali Acc: 0.948 Test Loss: 0.811 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 27.41792893409729
Epoch: 34, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.892 Vali Acc: 0.942 Test Loss: 0.892 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 28.293450355529785
Epoch: 35, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.676 Vali Acc: 0.953 Test Loss: 0.676 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9554317548746518
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.96166491508484
Epoch: 1, Steps: 89 | Train Loss: 1.238 Vali Loss: 0.714 Vali Acc: 0.814 Test Loss: 0.714 Test Acc: 0.814
Validation loss decreased (inf --> -0.814060).  Saving model ...
Epoch: 2 cost time: 25.62174916267395
Epoch: 2, Steps: 89 | Train Loss: 0.492 Vali Loss: 0.406 Vali Acc: 0.905 Test Loss: 0.406 Test Acc: 0.905
Validation loss decreased (-0.814060 --> -0.904592).  Saving model ...
Epoch: 3 cost time: 26.693581581115723
Epoch: 3, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.411 Vali Acc: 0.908 Test Loss: 0.411 Test Acc: 0.908
Validation loss decreased (-0.904592 --> -0.908074).  Saving model ...
Epoch: 4 cost time: 27.24962854385376
Epoch: 4, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.487 Vali Acc: 0.901 Test Loss: 0.487 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.93913769721985
Epoch: 5, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.677 Vali Acc: 0.884 Test Loss: 0.677 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.479999542236328
Epoch: 6, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.566 Vali Acc: 0.914 Test Loss: 0.566 Test Acc: 0.914
Validation loss decreased (-0.908074 --> -0.913643).  Saving model ...
Epoch: 7 cost time: 27.809086084365845
Epoch: 7, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.806 Vali Acc: 0.870 Test Loss: 0.806 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.538628578186035
Epoch: 8, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.781 Vali Acc: 0.912 Test Loss: 0.781 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 27.082027435302734
Epoch: 9, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.979 Vali Acc: 0.897 Test Loss: 0.979 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.94207000732422
Epoch: 10, Steps: 89 | Train Loss: 0.345 Vali Loss: 1.392 Vali Acc: 0.867 Test Loss: 1.392 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 27.951760292053223
Epoch: 11, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.716 Vali Acc: 0.924 Test Loss: 0.716 Test Acc: 0.924
Validation loss decreased (-0.913643 --> -0.924088).  Saving model ...
Epoch: 12 cost time: 27.98780870437622
Epoch: 12, Steps: 89 | Train Loss: 0.302 Vali Loss: 1.125 Vali Acc: 0.894 Test Loss: 1.125 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 27.244417190551758
Epoch: 13, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.820 Vali Acc: 0.918 Test Loss: 0.820 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 26.888782501220703
Epoch: 14, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.654 Vali Acc: 0.933 Test Loss: 0.654 Test Acc: 0.933
Validation loss decreased (-0.924088 --> -0.933141).  Saving model ...
Epoch: 15 cost time: 27.07823348045349
Epoch: 15, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.661 Vali Acc: 0.932 Test Loss: 0.661 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 29.000178813934326
Epoch: 16, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.866 Vali Acc: 0.921 Test Loss: 0.866 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 27.008381843566895
Epoch: 17, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.560 Vali Acc: 0.941 Test Loss: 0.560 Test Acc: 0.941
Validation loss decreased (-0.933141 --> -0.940802).  Saving model ...
Epoch: 18 cost time: 26.036221981048584
Epoch: 18, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.746 Vali Acc: 0.919 Test Loss: 0.746 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 27.015758752822876
Epoch: 19, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.641 Vali Acc: 0.939 Test Loss: 0.641 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 26.26399803161621
Epoch: 20, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.774 Vali Acc: 0.938 Test Loss: 0.774 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 26.599380254745483
Epoch: 21, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.715 Vali Acc: 0.942 Test Loss: 0.715 Test Acc: 0.942
Validation loss decreased (-0.940802 --> -0.942193).  Saving model ...
Epoch: 22 cost time: 27.76339054107666
Epoch: 22, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.662 Vali Acc: 0.938 Test Loss: 0.662 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 27.37705636024475
Epoch: 23, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.973 Vali Acc: 0.924 Test Loss: 0.973 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 27.825950145721436
Epoch: 24, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.843 Vali Acc: 0.925 Test Loss: 0.843 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 28.502569437026978
Epoch: 25, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.602 Vali Acc: 0.947 Test Loss: 0.602 Test Acc: 0.947
Validation loss decreased (-0.942193 --> -0.947069).  Saving model ...
Epoch: 26 cost time: 29.038881301879883
Epoch: 26, Steps: 89 | Train Loss: 0.151 Vali Loss: 1.065 Vali Acc: 0.912 Test Loss: 1.065 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 29.864402770996094
Epoch: 27, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.717 Vali Acc: 0.939 Test Loss: 0.717 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 27.861161470413208
Epoch: 28, Steps: 89 | Train Loss: 0.142 Vali Loss: 1.057 Vali Acc: 0.924 Test Loss: 1.057 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 28.502198219299316
Epoch: 29, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.861 Vali Acc: 0.923 Test Loss: 0.861 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 27.18817400932312
Epoch: 30, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.816 Vali Acc: 0.932 Test Loss: 0.816 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 28.218438386917114
Epoch: 31, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.875 Vali Acc: 0.922 Test Loss: 0.875 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 28.74046802520752
Epoch: 32, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.695 Vali Acc: 0.942 Test Loss: 0.695 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 26.849828958511353
Epoch: 33, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.652 Vali Acc: 0.948 Test Loss: 0.652 Test Acc: 0.948
Validation loss decreased (-0.947069 --> -0.948461).  Saving model ...
Epoch: 34 cost time: 27.86230707168579
Epoch: 34, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.717 Vali Acc: 0.933 Test Loss: 0.717 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 26.60960817337036
Epoch: 35, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.650 Vali Acc: 0.951 Test Loss: 0.650 Test Acc: 0.951
Validation loss decreased (-0.948461 --> -0.951247).  Saving model ...
Epoch: 36 cost time: 27.607680320739746
Epoch: 36, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.633 Vali Acc: 0.950 Test Loss: 0.633 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 29.901248693466187
Epoch: 37, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.497 Vali Acc: 0.966 Test Loss: 0.497 Test Acc: 0.966
Validation loss decreased (-0.951247 --> -0.965872).  Saving model ...
Epoch: 38 cost time: 27.435079097747803
Epoch: 38, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.751 Vali Acc: 0.935 Test Loss: 0.751 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 25.99510908126831
Epoch: 39, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.663 Vali Acc: 0.940 Test Loss: 0.663 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 27.069169998168945
Epoch: 40, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.729 Vali Acc: 0.950 Test Loss: 0.729 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 28.009083032608032
Epoch: 41, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.919 Vali Acc: 0.935 Test Loss: 0.919 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 27.01024556159973
Epoch: 42, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.598 Vali Acc: 0.944 Test Loss: 0.598 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 27.221442461013794
Epoch: 43, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.631 Vali Acc: 0.939 Test Loss: 0.631 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 25.8406720161438
Epoch: 44, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.687 Vali Acc: 0.938 Test Loss: 0.687 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 26.769329071044922
Epoch: 45, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.582 Vali Acc: 0.945 Test Loss: 0.582 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 26.3593807220459
Epoch: 46, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.704 Vali Acc: 0.946 Test Loss: 0.704 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 27.654019117355347
Epoch: 47, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.675 Vali Acc: 0.948 Test Loss: 0.675 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.104827880859375
Epoch: 1, Steps: 89 | Train Loss: 1.279 Vali Loss: 0.676 Vali Acc: 0.820 Test Loss: 0.676 Test Acc: 0.820
Validation loss decreased (inf --> -0.819631).  Saving model ...
Epoch: 2 cost time: 26.805467128753662
Epoch: 2, Steps: 89 | Train Loss: 0.486 Vali Loss: 0.478 Vali Acc: 0.879 Test Loss: 0.478 Test Acc: 0.879
Validation loss decreased (-0.819631 --> -0.878825).  Saving model ...
Epoch: 3 cost time: 26.38764524459839
Epoch: 3, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.387 Vali Acc: 0.912 Test Loss: 0.387 Test Acc: 0.912
Validation loss decreased (-0.878825 --> -0.912252).  Saving model ...
Epoch: 4 cost time: 25.535101175308228
Epoch: 4, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.617 Vali Acc: 0.882 Test Loss: 0.617 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.490867137908936
Epoch: 5, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.586 Vali Acc: 0.887 Test Loss: 0.586 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.822892665863037
Epoch: 6, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.858 Vali Acc: 0.886 Test Loss: 0.858 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.7868709564209
Epoch: 7, Steps: 89 | Train Loss: 0.378 Vali Loss: 1.047 Vali Acc: 0.866 Test Loss: 1.047 Test Acc: 0.866
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.25267243385315
Epoch: 8, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.785 Vali Acc: 0.903 Test Loss: 0.785 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 26.148450136184692
Epoch: 9, Steps: 89 | Train Loss: 0.375 Vali Loss: 1.358 Vali Acc: 0.859 Test Loss: 1.358 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 26.866939544677734
Epoch: 10, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.619 Vali Acc: 0.935 Test Loss: 0.619 Test Acc: 0.935
Validation loss decreased (-0.912252 --> -0.934534).  Saving model ...
Epoch: 11 cost time: 27.045671701431274
Epoch: 11, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.678 Vali Acc: 0.925 Test Loss: 0.678 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.609201192855835
Epoch: 12, Steps: 89 | Train Loss: 0.262 Vali Loss: 1.397 Vali Acc: 0.895 Test Loss: 1.397 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 27.538765907287598
Epoch: 13, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.699 Vali Acc: 0.932 Test Loss: 0.699 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 25.854851484298706
Epoch: 14, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.666 Vali Acc: 0.929 Test Loss: 0.666 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 24.985183477401733
Epoch: 15, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.758 Vali Acc: 0.923 Test Loss: 0.758 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 27.007871866226196
Epoch: 16, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.518 Vali Acc: 0.952 Test Loss: 0.518 Test Acc: 0.952
Validation loss decreased (-0.934534 --> -0.951945).  Saving model ...
Epoch: 17 cost time: 27.23060703277588
Epoch: 17, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.933 Vali Acc: 0.920 Test Loss: 0.933 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.375792980194092
Epoch: 18, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.654 Vali Acc: 0.925 Test Loss: 0.654 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 26.352299451828003
Epoch: 19, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.565 Vali Acc: 0.948 Test Loss: 0.565 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 27.125904083251953
Epoch: 20, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.988 Vali Acc: 0.903 Test Loss: 0.988 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 26.4416184425354
Epoch: 21, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.841 Vali Acc: 0.927 Test Loss: 0.841 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 27.43376326560974
Epoch: 22, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.609 Vali Acc: 0.949 Test Loss: 0.609 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 26.54549503326416
Epoch: 23, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.848 Vali Acc: 0.926 Test Loss: 0.848 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 26.84460687637329
Epoch: 24, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.789 Vali Acc: 0.942 Test Loss: 0.789 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 24.96658730506897
Epoch: 25, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.818 Vali Acc: 0.928 Test Loss: 0.818 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 24.806840658187866
Epoch: 26, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.480 Vali Acc: 0.948 Test Loss: 0.480 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.44328260421753
Epoch: 1, Steps: 89 | Train Loss: 1.441 Vali Loss: 0.679 Vali Acc: 0.807 Test Loss: 0.679 Test Acc: 0.807
Validation loss decreased (inf --> -0.807096).  Saving model ...
Epoch: 2 cost time: 26.089106798171997
Epoch: 2, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.644 Vali Acc: 0.836 Test Loss: 0.644 Test Acc: 0.836
Validation loss decreased (-0.807096 --> -0.836345).  Saving model ...
Epoch: 3 cost time: 25.773862600326538
Epoch: 3, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.534 Vali Acc: 0.879 Test Loss: 0.534 Test Acc: 0.879
Validation loss decreased (-0.836345 --> -0.878825).  Saving model ...
Epoch: 4 cost time: 26.749422550201416
Epoch: 4, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.486 Vali Acc: 0.901 Test Loss: 0.486 Test Acc: 0.901
Validation loss decreased (-0.878825 --> -0.901109).  Saving model ...
Epoch: 5 cost time: 27.059003114700317
Epoch: 5, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.506 Vali Acc: 0.909 Test Loss: 0.506 Test Acc: 0.909
Validation loss decreased (-0.901109 --> -0.909466).  Saving model ...
Epoch: 6 cost time: 24.94921088218689
Epoch: 6, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.810 Vali Acc: 0.892 Test Loss: 0.810 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.312063694000244
Epoch: 7, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.656 Vali Acc: 0.902 Test Loss: 0.656 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.46539545059204
Epoch: 8, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.922 Vali Acc: 0.900 Test Loss: 0.922 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 26.917619466781616
Epoch: 9, Steps: 89 | Train Loss: 0.379 Vali Loss: 0.996 Vali Acc: 0.864 Test Loss: 0.996 Test Acc: 0.864
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.6530339717865
Epoch: 10, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.864 Vali Acc: 0.912 Test Loss: 0.864 Test Acc: 0.912
Validation loss decreased (-0.909466 --> -0.911551).  Saving model ...
Epoch: 11 cost time: 26.004420280456543
Epoch: 11, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.602 Vali Acc: 0.925 Test Loss: 0.602 Test Acc: 0.925
Validation loss decreased (-0.911551 --> -0.924785).  Saving model ...
Epoch: 12 cost time: 26.24758529663086
Epoch: 12, Steps: 89 | Train Loss: 0.200 Vali Loss: 1.326 Vali Acc: 0.877 Test Loss: 1.326 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.38992691040039
Epoch: 13, Steps: 89 | Train Loss: 0.300 Vali Loss: 1.386 Vali Acc: 0.885 Test Loss: 1.386 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.360402584075928
Epoch: 14, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.827 Vali Acc: 0.933 Test Loss: 0.827 Test Acc: 0.933
Validation loss decreased (-0.924785 --> -0.933139).  Saving model ...
Epoch: 15 cost time: 24.96420931816101
Epoch: 15, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.594 Vali Acc: 0.943 Test Loss: 0.594 Test Acc: 0.943
Validation loss decreased (-0.933139 --> -0.942891).  Saving model ...
Epoch: 16 cost time: 24.502607345581055
Epoch: 16, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.901 Vali Acc: 0.913 Test Loss: 0.901 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.368645668029785
Epoch: 17, Steps: 89 | Train Loss: 0.277 Vali Loss: 1.124 Vali Acc: 0.909 Test Loss: 1.124 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.733460664749146
Epoch: 18, Steps: 89 | Train Loss: 0.311 Vali Loss: 1.191 Vali Acc: 0.912 Test Loss: 1.191 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 25.483765840530396
Epoch: 19, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.663 Vali Acc: 0.940 Test Loss: 0.663 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.074076652526855
Epoch: 20, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.629 Vali Acc: 0.948 Test Loss: 0.629 Test Acc: 0.948
Validation loss decreased (-0.942891 --> -0.947765).  Saving model ...
Epoch: 21 cost time: 24.444433212280273
Epoch: 21, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.794 Vali Acc: 0.932 Test Loss: 0.794 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 25.57223415374756
Epoch: 22, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.715 Vali Acc: 0.934 Test Loss: 0.715 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 26.12906813621521
Epoch: 23, Steps: 89 | Train Loss: 0.171 Vali Loss: 1.018 Vali Acc: 0.930 Test Loss: 1.018 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 26.38783288002014
Epoch: 24, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.717 Vali Acc: 0.937 Test Loss: 0.717 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 25.726205110549927
Epoch: 25, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.493 Vali Acc: 0.955 Test Loss: 0.493 Test Acc: 0.955
Validation loss decreased (-0.947765 --> -0.955427).  Saving model ...
Epoch: 26 cost time: 26.37314224243164
Epoch: 26, Steps: 89 | Train Loss: 0.170 Vali Loss: 1.123 Vali Acc: 0.913 Test Loss: 1.123 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 25.648942470550537
Epoch: 27, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.635 Vali Acc: 0.950 Test Loss: 0.635 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 25.363733768463135
Epoch: 28, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.860 Vali Acc: 0.933 Test Loss: 0.860 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 25.18916392326355
Epoch: 29, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.650 Vali Acc: 0.939 Test Loss: 0.650 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 25.453478574752808
Epoch: 30, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.244 Vali Acc: 0.917 Test Loss: 1.244 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 24.53168559074402
Epoch: 31, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.826 Vali Acc: 0.938 Test Loss: 0.826 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 24.681585788726807
Epoch: 32, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.789 Vali Acc: 0.944 Test Loss: 0.789 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 26.058828830718994
Epoch: 33, Steps: 89 | Train Loss: 0.101 Vali Loss: 1.141 Vali Acc: 0.930 Test Loss: 1.141 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 25.34961247444153
Epoch: 34, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.817 Vali Acc: 0.936 Test Loss: 0.817 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 25.414735078811646
Epoch: 35, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.500 Vali Acc: 0.964 Test Loss: 0.500 Test Acc: 0.964
Validation loss decreased (-0.955427 --> -0.964480).  Saving model ...
Epoch: 36 cost time: 25.886261224746704
Epoch: 36, Steps: 89 | Train Loss: 0.129 Vali Loss: 1.007 Vali Acc: 0.938 Test Loss: 1.007 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 25.774680137634277
Epoch: 37, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.874 Vali Acc: 0.943 Test Loss: 0.874 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 25.89936923980713
Epoch: 38, Steps: 89 | Train Loss: 0.250 Vali Loss: 1.322 Vali Acc: 0.912 Test Loss: 1.322 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 24.784356117248535
Epoch: 39, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.726 Vali Acc: 0.951 Test Loss: 0.726 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 27.539528608322144
Epoch: 40, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.919 Vali Acc: 0.928 Test Loss: 0.919 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 26.050705909729004
Epoch: 41, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.768 Vali Acc: 0.940 Test Loss: 0.768 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 24.306952953338623
Epoch: 42, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.795 Vali Acc: 0.939 Test Loss: 0.795 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 25.23078751564026
Epoch: 43, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.760 Vali Acc: 0.937 Test Loss: 0.760 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 25.14342474937439
Epoch: 44, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.650 Vali Acc: 0.955 Test Loss: 0.650 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 24.105831384658813
Epoch: 45, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.685 Vali Acc: 0.946 Test Loss: 0.685 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.471691370010376
Epoch: 1, Steps: 89 | Train Loss: 1.838 Vali Loss: 1.185 Vali Acc: 0.655 Test Loss: 1.185 Test Acc: 0.655
Validation loss decreased (inf --> -0.654584).  Saving model ...
Epoch: 2 cost time: 26.105042457580566
Epoch: 2, Steps: 89 | Train Loss: 0.561 Vali Loss: 0.788 Vali Acc: 0.799 Test Loss: 0.788 Test Acc: 0.799
Validation loss decreased (-0.654584 --> -0.799435).  Saving model ...
Epoch: 3 cost time: 25.450371503829956
Epoch: 3, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.651 Vali Acc: 0.843 Test Loss: 0.651 Test Acc: 0.843
Validation loss decreased (-0.799435 --> -0.843308).  Saving model ...
Epoch: 4 cost time: 25.950095176696777
Epoch: 4, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.662 Vali Acc: 0.877 Test Loss: 0.662 Test Acc: 0.877
Validation loss decreased (-0.843308 --> -0.876734).  Saving model ...
Epoch: 5 cost time: 25.57706642150879
Epoch: 5, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.556 Vali Acc: 0.905 Test Loss: 0.556 Test Acc: 0.905
Validation loss decreased (-0.876734 --> -0.905287).  Saving model ...
Epoch: 6 cost time: 24.69320559501648
Epoch: 6, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.380 Vali Acc: 0.939 Test Loss: 0.380 Test Acc: 0.939
Validation loss decreased (-0.905287 --> -0.938715).  Saving model ...
Epoch: 7 cost time: 25.94425892829895
Epoch: 7, Steps: 89 | Train Loss: 0.390 Vali Loss: 0.517 Vali Acc: 0.925 Test Loss: 0.517 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 27.279918909072876
Epoch: 8, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.660 Vali Acc: 0.914 Test Loss: 0.660 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.39923858642578
Epoch: 9, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.695 Vali Acc: 0.907 Test Loss: 0.695 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 26.213313341140747
Epoch: 10, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.969 Vali Acc: 0.883 Test Loss: 0.969 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 25.614020109176636
Epoch: 11, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.497 Vali Acc: 0.934 Test Loss: 0.497 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.618282318115234
Epoch: 12, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.562 Vali Acc: 0.944 Test Loss: 0.562 Test Acc: 0.944
Validation loss decreased (-0.938715 --> -0.944284).  Saving model ...
Epoch: 13 cost time: 24.21147108078003
Epoch: 13, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.632 Vali Acc: 0.928 Test Loss: 0.632 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.12494730949402
Epoch: 14, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.816 Vali Acc: 0.919 Test Loss: 0.816 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.244178533554077
Epoch: 15, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.637 Vali Acc: 0.932 Test Loss: 0.637 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.132936000823975
Epoch: 16, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.671 Vali Acc: 0.933 Test Loss: 0.671 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 27.040881633758545
Epoch: 17, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.627 Vali Acc: 0.933 Test Loss: 0.627 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 25.215240240097046
Epoch: 18, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.687 Vali Acc: 0.934 Test Loss: 0.687 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.461216688156128
Epoch: 19, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.572 Vali Acc: 0.939 Test Loss: 0.572 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 25.31892704963684
Epoch: 20, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.594 Vali Acc: 0.946 Test Loss: 0.594 Test Acc: 0.946
Validation loss decreased (-0.944284 --> -0.945677).  Saving model ...
Epoch: 21 cost time: 24.51407527923584
Epoch: 21, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.647 Vali Acc: 0.931 Test Loss: 0.647 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 25.750715017318726
Epoch: 22, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.497 Vali Acc: 0.958 Test Loss: 0.497 Test Acc: 0.958
Validation loss decreased (-0.945677 --> -0.957516).  Saving model ...
Epoch: 23 cost time: 24.875585317611694
Epoch: 23, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.651 Vali Acc: 0.942 Test Loss: 0.651 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 25.47729206085205
Epoch: 24, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.563 Vali Acc: 0.948 Test Loss: 0.563 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 25.071133852005005
Epoch: 25, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.450 Vali Acc: 0.956 Test Loss: 0.450 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 24.664664030075073
Epoch: 26, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.558 Vali Acc: 0.941 Test Loss: 0.558 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 23.459121465682983
Epoch: 27, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.611 Vali Acc: 0.936 Test Loss: 0.611 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 24.503821849822998
Epoch: 28, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.962 Vali Acc: 0.930 Test Loss: 0.962 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 27.29642939567566
Epoch: 29, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.494 Vali Acc: 0.952 Test Loss: 0.494 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 26.078134059906006
Epoch: 30, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.540 Vali Acc: 0.947 Test Loss: 0.540 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 25.725812911987305
Epoch: 31, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.535 Vali Acc: 0.946 Test Loss: 0.535 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 26.233938694000244
Epoch: 32, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.761 Vali Acc: 0.940 Test Loss: 0.761 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.208642959594727
Epoch: 1, Steps: 89 | Train Loss: 1.812 Vali Loss: 1.152 Vali Acc: 0.609 Test Loss: 1.152 Test Acc: 0.609
Validation loss decreased (inf --> -0.609320).  Saving model ...
Epoch: 2 cost time: 24.889320135116577
Epoch: 2, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.812 Vali Acc: 0.776 Test Loss: 0.812 Test Acc: 0.776
Validation loss decreased (-0.609320 --> -0.775758).  Saving model ...
Epoch: 3 cost time: 26.119572162628174
Epoch: 3, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.773 Vali Acc: 0.801 Test Loss: 0.773 Test Acc: 0.801
Validation loss decreased (-0.775758 --> -0.800828).  Saving model ...
Epoch: 4 cost time: 25.31206965446472
Epoch: 4, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.846 Vali Acc: 0.856 Test Loss: 0.846 Test Acc: 0.856
Validation loss decreased (-0.800828 --> -0.855841).  Saving model ...
Epoch: 5 cost time: 25.360450983047485
Epoch: 5, Steps: 89 | Train Loss: 0.268 Vali Loss: 1.305 Vali Acc: 0.799 Test Loss: 1.305 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.477731227874756
Epoch: 6, Steps: 89 | Train Loss: 0.385 Vali Loss: 0.508 Vali Acc: 0.918 Test Loss: 0.508 Test Acc: 0.918
Validation loss decreased (-0.855841 --> -0.917822).  Saving model ...
Epoch: 7 cost time: 25.813721895217896
Epoch: 7, Steps: 89 | Train Loss: 0.311 Vali Loss: 1.338 Vali Acc: 0.812 Test Loss: 1.338 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.71218705177307
Epoch: 8, Steps: 89 | Train Loss: 0.342 Vali Loss: 1.651 Vali Acc: 0.807 Test Loss: 1.651 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.063642501831055
Epoch: 9, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.801 Vali Acc: 0.901 Test Loss: 0.801 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 26.753331422805786
Epoch: 10, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.746 Vali Acc: 0.917 Test Loss: 0.746 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 26.317065238952637
Epoch: 11, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.579 Vali Acc: 0.923 Test Loss: 0.579 Test Acc: 0.923
Validation loss decreased (-0.917822 --> -0.922696).  Saving model ...
Epoch: 12 cost time: 27.143678665161133
Epoch: 12, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.961 Vali Acc: 0.872 Test Loss: 0.961 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 26.34892511367798
Epoch: 13, Steps: 89 | Train Loss: 0.226 Vali Loss: 1.205 Vali Acc: 0.884 Test Loss: 1.205 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 28.03473973274231
Epoch: 14, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.693 Vali Acc: 0.924 Test Loss: 0.693 Test Acc: 0.924
Validation loss decreased (-0.922696 --> -0.924088).  Saving model ...
Epoch: 15 cost time: 26.828263998031616
Epoch: 15, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.608 Vali Acc: 0.935 Test Loss: 0.608 Test Acc: 0.935
Validation loss decreased (-0.924088 --> -0.935231).  Saving model ...
Epoch: 16 cost time: 26.7353458404541
Epoch: 16, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.660 Vali Acc: 0.917 Test Loss: 0.660 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 27.086662769317627
Epoch: 17, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.935231 --> -0.949856).  Saving model ...
Epoch: 18 cost time: 27.509601593017578
Epoch: 18, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.405 Vali Acc: 0.948 Test Loss: 0.405 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 24.404844999313354
Epoch: 19, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.714 Vali Acc: 0.917 Test Loss: 0.714 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 23.721240997314453
Epoch: 20, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.593 Vali Acc: 0.942 Test Loss: 0.593 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 24.71133780479431
Epoch: 21, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.539 Vali Acc: 0.932 Test Loss: 0.539 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 25.41780161857605
Epoch: 22, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.405 Vali Acc: 0.946 Test Loss: 0.405 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 24.00815176963806
Epoch: 23, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.707 Vali Acc: 0.930 Test Loss: 0.707 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 26.677431106567383
Epoch: 24, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.455 Vali Acc: 0.947 Test Loss: 0.455 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 26.011189937591553
Epoch: 25, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.408 Vali Acc: 0.945 Test Loss: 0.408 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 23.654763221740723
Epoch: 26, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.674 Vali Acc: 0.946 Test Loss: 0.674 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 24.217918634414673
Epoch: 27, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.372 Vali Acc: 0.959 Test Loss: 0.372 Test Acc: 0.959
Validation loss decreased (-0.949856 --> -0.958910).  Saving model ...
Epoch: 28 cost time: 26.15753412246704
Epoch: 28, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.762 Vali Acc: 0.930 Test Loss: 0.762 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 25.96413016319275
Epoch: 29, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.460 Vali Acc: 0.955 Test Loss: 0.460 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 24.505504846572876
Epoch: 30, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.493 Vali Acc: 0.949 Test Loss: 0.493 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 26.040110111236572
Epoch: 31, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.463 Vali Acc: 0.956 Test Loss: 0.463 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 24.87523889541626
Epoch: 32, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.534 Vali Acc: 0.949 Test Loss: 0.534 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 24.023045539855957
Epoch: 33, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.873 Vali Acc: 0.914 Test Loss: 0.873 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 24.36089277267456
Epoch: 34, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.508 Vali Acc: 0.951 Test Loss: 0.508 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 26.39578080177307
Epoch: 35, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.498 Vali Acc: 0.949 Test Loss: 0.498 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 25.05736207962036
Epoch: 36, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.414 Vali Acc: 0.955 Test Loss: 0.414 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 25.29475450515747
Epoch: 37, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.518 Vali Acc: 0.951 Test Loss: 0.518 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.71779990196228
Epoch: 1, Steps: 89 | Train Loss: 1.784 Vali Loss: 1.026 Vali Acc: 0.679 Test Loss: 1.026 Test Acc: 0.679
Validation loss decreased (inf --> -0.678959).  Saving model ...
Epoch: 2 cost time: 26.511624574661255
Epoch: 2, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.622 Vali Acc: 0.820 Test Loss: 0.622 Test Acc: 0.820
Validation loss decreased (-0.678959 --> -0.819632).  Saving model ...
Epoch: 3 cost time: 25.617584228515625
Epoch: 3, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.960 Vali Acc: 0.784 Test Loss: 0.960 Test Acc: 0.784
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 25.705474853515625
Epoch: 4, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.731 Vali Acc: 0.857 Test Loss: 0.731 Test Acc: 0.857
Validation loss decreased (-0.819632 --> -0.857235).  Saving model ...
Epoch: 5 cost time: 26.45014476776123
Epoch: 5, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.563 Vali Acc: 0.897 Test Loss: 0.563 Test Acc: 0.897
Validation loss decreased (-0.857235 --> -0.896930).  Saving model ...
Epoch: 6 cost time: 25.006488800048828
Epoch: 6, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.663 Vali Acc: 0.889 Test Loss: 0.663 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.31021237373352
Epoch: 7, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.754 Vali Acc: 0.875 Test Loss: 0.754 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.260348558425903
Epoch: 8, Steps: 89 | Train Loss: 0.322 Vali Loss: 1.103 Vali Acc: 0.850 Test Loss: 1.103 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.28359842300415
Epoch: 9, Steps: 89 | Train Loss: 0.359 Vali Loss: 1.272 Vali Acc: 0.838 Test Loss: 1.272 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 25.49777626991272
Epoch: 10, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.894 Vali Acc: 0.886 Test Loss: 0.894 Test Acc: 0.886
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.29847288131714
Epoch: 11, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.941 Vali Acc: 0.870 Test Loss: 0.941 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.931034326553345
Epoch: 12, Steps: 89 | Train Loss: 0.304 Vali Loss: 1.039 Vali Acc: 0.868 Test Loss: 1.039 Test Acc: 0.868
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 26.187657594680786
Epoch: 13, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.783 Vali Acc: 0.906 Test Loss: 0.783 Test Acc: 0.906
Validation loss decreased (-0.896930 --> -0.905981).  Saving model ...
Epoch: 14 cost time: 26.209300994873047
Epoch: 14, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.520 Vali Acc: 0.931 Test Loss: 0.520 Test Acc: 0.931
Validation loss decreased (-0.905981 --> -0.931053).  Saving model ...
Epoch: 15 cost time: 25.85380744934082
Epoch: 15, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.761 Vali Acc: 0.920 Test Loss: 0.761 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 26.328622817993164
Epoch: 16, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.471 Vali Acc: 0.955 Test Loss: 0.471 Test Acc: 0.955
Validation loss decreased (-0.931053 --> -0.955427).  Saving model ...
Epoch: 17 cost time: 26.671969413757324
Epoch: 17, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.495 Vali Acc: 0.948 Test Loss: 0.495 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 24.044708490371704
Epoch: 18, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.543 Vali Acc: 0.942 Test Loss: 0.543 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 24.596951007843018
Epoch: 19, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.858 Vali Acc: 0.896 Test Loss: 0.858 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 25.77531909942627
Epoch: 20, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.885 Vali Acc: 0.914 Test Loss: 0.885 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 26.39276647567749
Epoch: 21, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.415 Vali Acc: 0.960 Test Loss: 0.415 Test Acc: 0.960
Validation loss decreased (-0.955427 --> -0.960302).  Saving model ...
Epoch: 22 cost time: 27.15534996986389
Epoch: 22, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.377 Vali Acc: 0.966 Test Loss: 0.377 Test Acc: 0.966
Validation loss decreased (-0.960302 --> -0.965874).  Saving model ...
Epoch: 23 cost time: 27.221348524093628
Epoch: 23, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.487 Vali Acc: 0.955 Test Loss: 0.487 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 27.08931541442871
Epoch: 24, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.374 Vali Acc: 0.964 Test Loss: 0.374 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 26.294928312301636
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.480 Vali Acc: 0.952 Test Loss: 0.480 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 27.95816159248352
Epoch: 26, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.427 Vali Acc: 0.953 Test Loss: 0.427 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 27.986572980880737
Epoch: 27, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.384 Vali Acc: 0.964 Test Loss: 0.384 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 26.925554513931274
Epoch: 28, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.538 Vali Acc: 0.951 Test Loss: 0.538 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 28.119514226913452
Epoch: 29, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.528 Vali Acc: 0.958 Test Loss: 0.528 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 28.3144314289093
Epoch: 30, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.377 Vali Acc: 0.960 Test Loss: 0.377 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 28.000109672546387
Epoch: 31, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.708 Vali Acc: 0.940 Test Loss: 0.708 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 26.618098258972168
Epoch: 32, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.400 Vali Acc: 0.952 Test Loss: 0.400 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.668685913085938
Epoch: 1, Steps: 89 | Train Loss: 1.800 Vali Loss: 1.154 Vali Acc: 0.620 Test Loss: 1.154 Test Acc: 0.620
Validation loss decreased (inf --> -0.620462).  Saving model ...
Epoch: 2 cost time: 26.25532341003418
Epoch: 2, Steps: 89 | Train Loss: 0.449 Vali Loss: 0.874 Vali Acc: 0.768 Test Loss: 0.874 Test Acc: 0.768
Validation loss decreased (-0.620462 --> -0.768097).  Saving model ...
Epoch: 3 cost time: 26.782655239105225
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 1.191 Vali Acc: 0.740 Test Loss: 1.191 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.750810146331787
Epoch: 4, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.772 Vali Acc: 0.843 Test Loss: 0.772 Test Acc: 0.843
Validation loss decreased (-0.768097 --> -0.842611).  Saving model ...
Epoch: 5 cost time: 26.423470735549927
Epoch: 5, Steps: 89 | Train Loss: 0.230 Vali Loss: 1.038 Vali Acc: 0.811 Test Loss: 1.038 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.919674158096313
Epoch: 6, Steps: 89 | Train Loss: 0.359 Vali Loss: 1.228 Vali Acc: 0.831 Test Loss: 1.228 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.205572366714478
Epoch: 7, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.855 Vali Acc: 0.867 Test Loss: 0.855 Test Acc: 0.867
Validation loss decreased (-0.842611 --> -0.866983).  Saving model ...
Epoch: 8 cost time: 26.098614931106567
Epoch: 8, Steps: 89 | Train Loss: 0.321 Vali Loss: 1.167 Vali Acc: 0.877 Test Loss: 1.167 Test Acc: 0.877
Validation loss decreased (-0.866983 --> -0.877426).  Saving model ...
Epoch: 9 cost time: 26.11337661743164
Epoch: 9, Steps: 89 | Train Loss: 0.287 Vali Loss: 1.022 Vali Acc: 0.852 Test Loss: 1.022 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.42805814743042
Epoch: 10, Steps: 89 | Train Loss: 0.360 Vali Loss: 1.271 Vali Acc: 0.862 Test Loss: 1.271 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.921302318572998
Epoch: 11, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.447 Vali Acc: 0.935 Test Loss: 0.447 Test Acc: 0.935
Validation loss decreased (-0.877426 --> -0.934536).  Saving model ...
Epoch: 12 cost time: 27.451038599014282
Epoch: 12, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.885 Vali Acc: 0.900 Test Loss: 0.885 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 26.760966062545776
Epoch: 13, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.756 Vali Acc: 0.916 Test Loss: 0.756 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 25.21959948539734
Epoch: 14, Steps: 89 | Train Loss: 0.494 Vali Loss: 0.580 Vali Acc: 0.942 Test Loss: 0.580 Test Acc: 0.942
Validation loss decreased (-0.934536 --> -0.941498).  Saving model ...
Epoch: 15 cost time: 26.210177898406982
Epoch: 15, Steps: 89 | Train Loss: 0.426 Vali Loss: 1.088 Vali Acc: 0.903 Test Loss: 1.088 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 27.619543313980103
Epoch: 16, Steps: 89 | Train Loss: 0.390 Vali Loss: 1.235 Vali Acc: 0.887 Test Loss: 1.235 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 27.965794324874878
Epoch: 17, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.632 Vali Acc: 0.935 Test Loss: 0.632 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 28.094863891601562
Epoch: 18, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.439 Vali Acc: 0.962 Test Loss: 0.439 Test Acc: 0.962
Validation loss decreased (-0.941498 --> -0.961695).  Saving model ...
Epoch: 19 cost time: 27.56145715713501
Epoch: 19, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.515 Vali Acc: 0.952 Test Loss: 0.515 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 26.686255931854248
Epoch: 20, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.666 Vali Acc: 0.933 Test Loss: 0.666 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 27.623178005218506
Epoch: 21, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.564 Vali Acc: 0.951 Test Loss: 0.564 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 26.978962421417236
Epoch: 22, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.632 Vali Acc: 0.951 Test Loss: 0.632 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 26.422982454299927
Epoch: 23, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.467 Vali Acc: 0.949 Test Loss: 0.467 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 25.982485055923462
Epoch: 24, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.476 Vali Acc: 0.945 Test Loss: 0.476 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 27.4775128364563
Epoch: 25, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.514 Vali Acc: 0.948 Test Loss: 0.514 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 27.002187967300415
Epoch: 26, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.479 Vali Acc: 0.953 Test Loss: 0.479 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 26.693495273590088
Epoch: 27, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.867 Vali Acc: 0.921 Test Loss: 0.867 Test Acc: 0.921
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 24.018470287322998
Epoch: 28, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.588 Vali Acc: 0.939 Test Loss: 0.588 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.40543556213379
Epoch: 1, Steps: 89 | Train Loss: 1.854 Vali Loss: 1.252 Vali Acc: 0.623 Test Loss: 1.252 Test Acc: 0.623
Validation loss decreased (inf --> -0.622550).  Saving model ...
Epoch: 2 cost time: 25.68324041366577
Epoch: 2, Steps: 89 | Train Loss: 0.459 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (-0.622550 --> -0.810579).  Saving model ...
Epoch: 3 cost time: 25.312549829483032
Epoch: 3, Steps: 89 | Train Loss: 0.305 Vali Loss: 1.275 Vali Acc: 0.733 Test Loss: 1.275 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.09691858291626
Epoch: 4, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.942 Vali Acc: 0.850 Test Loss: 0.942 Test Acc: 0.850
Validation loss decreased (-0.810579 --> -0.850269).  Saving model ...
Epoch: 5 cost time: 27.323397636413574
Epoch: 5, Steps: 89 | Train Loss: 0.210 Vali Loss: 1.125 Vali Acc: 0.835 Test Loss: 1.125 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.889957666397095
Epoch: 6, Steps: 89 | Train Loss: 0.342 Vali Loss: 1.012 Vali Acc: 0.833 Test Loss: 1.012 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.605509757995605
Epoch: 7, Steps: 89 | Train Loss: 0.381 Vali Loss: 1.069 Vali Acc: 0.834 Test Loss: 1.069 Test Acc: 0.834
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 25.501416206359863
Epoch: 8, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.719 Vali Acc: 0.912 Test Loss: 0.719 Test Acc: 0.912
Validation loss decreased (-0.850269 --> -0.911553).  Saving model ...
Epoch: 9 cost time: 25.63178253173828
Epoch: 9, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.722 Vali Acc: 0.896 Test Loss: 0.722 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.93296480178833
Epoch: 10, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.854 Vali Acc: 0.870 Test Loss: 0.854 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.533050537109375
Epoch: 11, Steps: 89 | Train Loss: 0.531 Vali Loss: 1.370 Vali Acc: 0.852 Test Loss: 1.370 Test Acc: 0.852
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 27.562456369400024
Epoch: 12, Steps: 89 | Train Loss: 0.393 Vali Loss: 1.457 Vali Acc: 0.870 Test Loss: 1.457 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.909209489822388
Epoch: 13, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.788 Vali Acc: 0.914 Test Loss: 0.788 Test Acc: 0.914
Validation loss decreased (-0.911553 --> -0.914338).  Saving model ...
Epoch: 14 cost time: 25.823498010635376
Epoch: 14, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.725 Vali Acc: 0.907 Test Loss: 0.725 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.7976496219635
Epoch: 15, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.523 Vali Acc: 0.943 Test Loss: 0.523 Test Acc: 0.943
Validation loss decreased (-0.914338 --> -0.942892).  Saving model ...
Epoch: 16 cost time: 25.42625093460083
Epoch: 16, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.439 Vali Acc: 0.958 Test Loss: 0.439 Test Acc: 0.958
Validation loss decreased (-0.942892 --> -0.957517).  Saving model ...
Epoch: 17 cost time: 25.890857934951782
Epoch: 17, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.515 Vali Acc: 0.943 Test Loss: 0.515 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 26.252408266067505
Epoch: 18, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.549 Vali Acc: 0.942 Test Loss: 0.549 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 26.101137399673462
Epoch: 19, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.807 Vali Acc: 0.936 Test Loss: 0.807 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 24.129619121551514
Epoch: 20, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.578 Vali Acc: 0.946 Test Loss: 0.578 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 25.75874400138855
Epoch: 21, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.568 Vali Acc: 0.951 Test Loss: 0.568 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 27.322035312652588
Epoch: 22, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.415 Vali Acc: 0.955 Test Loss: 0.415 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 26.434926986694336
Epoch: 23, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.605 Vali Acc: 0.945 Test Loss: 0.605 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 25.873553037643433
Epoch: 24, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.540 Vali Acc: 0.953 Test Loss: 0.540 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 27.069976568222046
Epoch: 25, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.499 Vali Acc: 0.959 Test Loss: 0.499 Test Acc: 0.959
Validation loss decreased (-0.957517 --> -0.958909).  Saving model ...
Epoch: 26 cost time: 25.464762449264526
Epoch: 26, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.433 Vali Acc: 0.958 Test Loss: 0.433 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 24.900110483169556
Epoch: 27, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.484 Vali Acc: 0.953 Test Loss: 0.484 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 25.700189352035522
Epoch: 28, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.559 Vali Acc: 0.956 Test Loss: 0.559 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 25.571527242660522
Epoch: 29, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.422 Vali Acc: 0.958 Test Loss: 0.422 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 26.77127504348755
Epoch: 30, Steps: 89 | Train Loss: 0.129 Vali Loss: 1.115 Vali Acc: 0.921 Test Loss: 1.115 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 24.651946306228638
Epoch: 31, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.674 Vali Acc: 0.932 Test Loss: 0.674 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 26.271892309188843
Epoch: 32, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.578 Vali Acc: 0.957 Test Loss: 0.578 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 26.595546007156372
Epoch: 33, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.546 Vali Acc: 0.962 Test Loss: 0.546 Test Acc: 0.962
Validation loss decreased (-0.958909 --> -0.962390).  Saving model ...
Epoch: 34 cost time: 26.03123140335083
Epoch: 34, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.465 Vali Acc: 0.958 Test Loss: 0.465 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 27.01883363723755
Epoch: 35, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.614 Vali Acc: 0.959 Test Loss: 0.614 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 26.352174997329712
Epoch: 36, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.690 Vali Acc: 0.951 Test Loss: 0.690 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 26.646655797958374
Epoch: 37, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.734 Vali Acc: 0.940 Test Loss: 0.734 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 26.16699719429016
Epoch: 38, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.553 Vali Acc: 0.957 Test Loss: 0.553 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 25.329582452774048
Epoch: 39, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.681 Vali Acc: 0.944 Test Loss: 0.681 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 26.5961697101593
Epoch: 40, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.373 Vali Acc: 0.966 Test Loss: 0.373 Test Acc: 0.966
Validation loss decreased (-0.962390 --> -0.965874).  Saving model ...
Epoch: 41 cost time: 25.718538761138916
Epoch: 41, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.450 Vali Acc: 0.960 Test Loss: 0.450 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 26.50740647315979
Epoch: 42, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.777 Vali Acc: 0.930 Test Loss: 0.777 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 26.658588409423828
Epoch: 43, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.519 Vali Acc: 0.955 Test Loss: 0.519 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 26.41648030281067
Epoch: 44, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.490 Vali Acc: 0.966 Test Loss: 0.490 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 26.211362600326538
Epoch: 45, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.611 Vali Acc: 0.946 Test Loss: 0.611 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 26.823790550231934
Epoch: 46, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.626 Vali Acc: 0.944 Test Loss: 0.626 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 26.36003088951111
Epoch: 47, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.616 Vali Acc: 0.955 Test Loss: 0.616 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 26.373281955718994
Epoch: 48, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.473 Vali Acc: 0.960 Test Loss: 0.473 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 26.135651350021362
Epoch: 49, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.521 Vali Acc: 0.948 Test Loss: 0.521 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 26.225724935531616
Epoch: 50, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.656 Vali Acc: 0.953 Test Loss: 0.656 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.911181449890137
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.060 Test Loss: 2.996 Test Acc: 0.060
Validation loss decreased (inf --> -0.059859).  Saving model ...
Epoch: 2 cost time: 25.401910305023193
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.059859 --> -0.059859).  Saving model ...
Epoch: 3 cost time: 25.81548833847046
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.059859 --> -0.059859).  Saving model ...
Epoch: 4 cost time: 26.480265378952026
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.059859 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 25.68993091583252
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 24.90477681159973
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 25.883800268173218
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 27.53155207633972
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 25.72242784500122
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 26.496827602386475
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 26.09721040725708
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 24.507944345474243
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 23.980748891830444
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 24.50489854812622
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 25.154078483581543
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 25.962583303451538
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 25.709006309509277
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 26.78989839553833
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 26.782449960708618
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 25.000439405441284
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 26.07218623161316
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 25.590625524520874
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 24.536455392837524
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 26.526530027389526
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 26.15047264099121
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 26.330817461013794
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 25.65116834640503
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 26.134124279022217
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 26.2830593585968
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 25.274827241897583
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 24.30677056312561
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 25.6743221282959
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 25.317631483078003
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 25.85465693473816
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 23.681187629699707
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 26.45821452140808
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 25.09968090057373
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 24.720064163208008
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 24.187800884246826
Epoch: 39, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 25.862351179122925
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 24.96350336074829
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 26.836060285568237
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 25.7997887134552
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 24.548384428024292
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 25.182183742523193
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 25.066320180892944
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 25.00858449935913
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 25.102375507354736
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 25.660834550857544
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 26.28304934501648
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 25.89433741569519
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 26.58633279800415
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 25.490107774734497
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 24.250840663909912
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 26.689366102218628
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 26.912755250930786
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 26.163522958755493
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 25.343088388442993
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 59 cost time: 27.176209688186646
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 60 cost time: 27.04753589630127
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 26.756178379058838
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 25.885798454284668
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 26.749900817871094
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 26.632121801376343
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 26.578450679779053
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 28.320489168167114
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 28.122135400772095
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 27.196876287460327
Epoch: 68, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 26.50166416168213
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 6713876
model size : 35.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.821133136749268
Epoch: 1, Steps: 89 | Train Loss: 1.035 Vali Loss: 0.482 Vali Acc: 0.859 Test Loss: 0.482 Test Acc: 0.859
Validation loss decreased (inf --> -0.859327).  Saving model ...
Epoch: 2 cost time: 27.778055906295776
Epoch: 2, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.859327 --> -0.888575).  Saving model ...
Epoch: 3 cost time: 27.949873685836792
Epoch: 3, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.521 Vali Acc: 0.896 Test Loss: 0.521 Test Acc: 0.896
Validation loss decreased (-0.888575 --> -0.896234).  Saving model ...
Epoch: 4 cost time: 28.222580432891846
Epoch: 4, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.625 Vali Acc: 0.897 Test Loss: 0.625 Test Acc: 0.897
Validation loss decreased (-0.896234 --> -0.896930).  Saving model ...
Epoch: 5 cost time: 27.86889147758484
Epoch: 5, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.630 Vali Acc: 0.905 Test Loss: 0.630 Test Acc: 0.905
Validation loss decreased (-0.896930 --> -0.904590).  Saving model ...
Epoch: 6 cost time: 27.301612377166748
Epoch: 6, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.558 Vali Acc: 0.930 Test Loss: 0.558 Test Acc: 0.930
Validation loss decreased (-0.904590 --> -0.930357).  Saving model ...
Epoch: 7 cost time: 27.111284017562866
Epoch: 7, Steps: 89 | Train Loss: 0.339 Vali Loss: 1.134 Vali Acc: 0.913 Test Loss: 1.134 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.55843687057495
Epoch: 8, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.647 Vali Acc: 0.911 Test Loss: 0.647 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.06659722328186
Epoch: 9, Steps: 89 | Train Loss: 0.372 Vali Loss: 1.097 Vali Acc: 0.858 Test Loss: 1.097 Test Acc: 0.858
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.383734703063965
Epoch: 10, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.576 Vali Acc: 0.918 Test Loss: 0.576 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 27.430936336517334
Epoch: 11, Steps: 89 | Train Loss: 0.247 Vali Loss: 1.277 Vali Acc: 0.901 Test Loss: 1.277 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 28.126158475875854
Epoch: 12, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.660 Vali Acc: 0.936 Test Loss: 0.660 Test Acc: 0.936
Validation loss decreased (-0.930357 --> -0.935927).  Saving model ...
Epoch: 13 cost time: 26.805595636367798
Epoch: 13, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.800 Vali Acc: 0.907 Test Loss: 0.800 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 28.801337242126465
Epoch: 14, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.648 Vali Acc: 0.936 Test Loss: 0.648 Test Acc: 0.936
Validation loss decreased (-0.935927 --> -0.935927).  Saving model ...
Epoch: 15 cost time: 26.99136972427368
Epoch: 15, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.658 Vali Acc: 0.930 Test Loss: 0.658 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 25.37268829345703
Epoch: 16, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.233 Vali Acc: 0.899 Test Loss: 1.233 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 27.312267303466797
Epoch: 17, Steps: 89 | Train Loss: 0.206 Vali Loss: 1.135 Vali Acc: 0.914 Test Loss: 1.135 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 26.939831495285034
Epoch: 18, Steps: 89 | Train Loss: 0.275 Vali Loss: 1.020 Vali Acc: 0.922 Test Loss: 1.020 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 27.36960005760193
Epoch: 19, Steps: 89 | Train Loss: 0.218 Vali Loss: 1.014 Vali Acc: 0.905 Test Loss: 1.014 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 28.01139760017395
Epoch: 20, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.862 Vali Acc: 0.937 Test Loss: 0.862 Test Acc: 0.937
Validation loss decreased (-0.935927 --> -0.937317).  Saving model ...
Epoch: 21 cost time: 27.710211515426636
Epoch: 21, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.883 Vali Acc: 0.925 Test Loss: 0.883 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 27.04430890083313
Epoch: 22, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.701 Vali Acc: 0.953 Test Loss: 0.701 Test Acc: 0.953
Validation loss decreased (-0.937317 --> -0.953336).  Saving model ...
Epoch: 23 cost time: 27.160396575927734
Epoch: 23, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.681 Vali Acc: 0.946 Test Loss: 0.681 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 28.024293422698975
Epoch: 24, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.806 Vali Acc: 0.939 Test Loss: 0.806 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 28.233911752700806
Epoch: 25, Steps: 89 | Train Loss: 0.271 Vali Loss: 1.047 Vali Acc: 0.915 Test Loss: 1.047 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 27.83518075942993
Epoch: 26, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.875 Vali Acc: 0.923 Test Loss: 0.875 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 28.940871000289917
Epoch: 27, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.830 Vali Acc: 0.947 Test Loss: 0.830 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 28.691301107406616
Epoch: 28, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.726 Vali Acc: 0.950 Test Loss: 0.726 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 28.541149377822876
Epoch: 29, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.750 Vali Acc: 0.948 Test Loss: 0.750 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 28.9397189617157
Epoch: 30, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.872 Vali Acc: 0.937 Test Loss: 0.872 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 27.087708950042725
Epoch: 31, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.964 Vali Acc: 0.936 Test Loss: 0.964 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 28.22504234313965
Epoch: 32, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.914 Vali Acc: 0.947 Test Loss: 0.914 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 29.12633466720581
Epoch: 1, Steps: 89 | Train Loss: 1.107 Vali Loss: 0.560 Vali Acc: 0.844 Test Loss: 0.560 Test Acc: 0.844
Validation loss decreased (inf --> -0.844006).  Saving model ...
Epoch: 2 cost time: 27.305970430374146
Epoch: 2, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.732 Vali Acc: 0.802 Test Loss: 0.732 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.805967569351196
Epoch: 3, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.527 Vali Acc: 0.880 Test Loss: 0.527 Test Acc: 0.880
Validation loss decreased (-0.844006 --> -0.880218).  Saving model ...
Epoch: 4 cost time: 27.85140633583069
Epoch: 4, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.855 Vali Acc: 0.864 Test Loss: 0.855 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.724214792251587
Epoch: 5, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.496 Vali Acc: 0.916 Test Loss: 0.496 Test Acc: 0.916
Validation loss decreased (-0.880218 --> -0.916430).  Saving model ...
Epoch: 6 cost time: 27.176364421844482
Epoch: 6, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.903 Vali Acc: 0.888 Test Loss: 0.903 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.12326717376709
Epoch: 7, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.609 Vali Acc: 0.914 Test Loss: 0.609 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.877304792404175
Epoch: 8, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.783 Vali Acc: 0.903 Test Loss: 0.783 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.770211696624756
Epoch: 9, Steps: 89 | Train Loss: 0.343 Vali Loss: 1.814 Vali Acc: 0.875 Test Loss: 1.814 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 25.58665680885315
Epoch: 10, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.738 Vali Acc: 0.914 Test Loss: 0.738 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 26.623493671417236
Epoch: 11, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.838 Vali Acc: 0.916 Test Loss: 0.838 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 26.243874073028564
Epoch: 12, Steps: 89 | Train Loss: 0.330 Vali Loss: 0.682 Vali Acc: 0.936 Test Loss: 0.682 Test Acc: 0.936
Validation loss decreased (-0.916430 --> -0.935926).  Saving model ...
Epoch: 13 cost time: 26.355509757995605
Epoch: 13, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.961 Vali Acc: 0.918 Test Loss: 0.961 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.787865161895752
Epoch: 14, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.498 Vali Acc: 0.947 Test Loss: 0.498 Test Acc: 0.947
Validation loss decreased (-0.935926 --> -0.947070).  Saving model ...
Epoch: 15 cost time: 26.565773725509644
Epoch: 15, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.537 Vali Acc: 0.946 Test Loss: 0.537 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 26.675841808319092
Epoch: 16, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.793 Vali Acc: 0.923 Test Loss: 0.793 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 26.442474365234375
Epoch: 17, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.848 Vali Acc: 0.925 Test Loss: 0.848 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 25.609180688858032
Epoch: 18, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.781 Vali Acc: 0.935 Test Loss: 0.781 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 26.735421180725098
Epoch: 19, Steps: 89 | Train Loss: 0.172 Vali Loss: 1.201 Vali Acc: 0.923 Test Loss: 1.201 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 26.000791788101196
Epoch: 20, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.593 Vali Acc: 0.947 Test Loss: 0.593 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 26.926801919937134
Epoch: 21, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.591 Vali Acc: 0.943 Test Loss: 0.591 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 26.594388723373413
Epoch: 22, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.730 Vali Acc: 0.931 Test Loss: 0.730 Test Acc: 0.931
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 28.063623189926147
Epoch: 23, Steps: 89 | Train Loss: 0.272 Vali Loss: 1.109 Vali Acc: 0.900 Test Loss: 1.109 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 27.120327472686768
Epoch: 24, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.754 Vali Acc: 0.930 Test Loss: 0.754 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.947075208913649
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.09407329559326
Epoch: 1, Steps: 89 | Train Loss: 1.196 Vali Loss: 0.608 Vali Acc: 0.838 Test Loss: 0.608 Test Acc: 0.838
Validation loss decreased (inf --> -0.837738).  Saving model ...
Epoch: 2 cost time: 24.453176021575928
Epoch: 2, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.503 Vali Acc: 0.854 Test Loss: 0.503 Test Acc: 0.854
Validation loss decreased (-0.837738 --> -0.853755).  Saving model ...
Epoch: 3 cost time: 25.374639749526978
Epoch: 3, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
Validation loss decreased (-0.853755 --> -0.919216).  Saving model ...
Epoch: 4 cost time: 25.558571577072144
Epoch: 4, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.809 Vali Acc: 0.889 Test Loss: 0.809 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.345024585723877
Epoch: 5, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.574 Vali Acc: 0.900 Test Loss: 0.574 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.794554710388184
Epoch: 6, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.536 Vali Acc: 0.922 Test Loss: 0.536 Test Acc: 0.922
Validation loss decreased (-0.919216 --> -0.922000).  Saving model ...
Epoch: 7 cost time: 26.41658663749695
Epoch: 7, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.844 Vali Acc: 0.890 Test Loss: 0.844 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.074010610580444
Epoch: 8, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.877 Vali Acc: 0.881 Test Loss: 0.877 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.550657272338867
Epoch: 9, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.564 Vali Acc: 0.931 Test Loss: 0.564 Test Acc: 0.931
Validation loss decreased (-0.922000 --> -0.931053).  Saving model ...
Epoch: 10 cost time: 25.464224338531494
Epoch: 10, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.750 Vali Acc: 0.927 Test Loss: 0.750 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.73143482208252
Epoch: 11, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.835 Vali Acc: 0.919 Test Loss: 0.835 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 26.081711769104004
Epoch: 12, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.945 Vali Acc: 0.914 Test Loss: 0.945 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 26.895015478134155
Epoch: 13, Steps: 89 | Train Loss: 0.238 Vali Loss: 1.122 Vali Acc: 0.898 Test Loss: 1.122 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 25.79104518890381
Epoch: 14, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.627 Vali Acc: 0.942 Test Loss: 0.627 Test Acc: 0.942
Validation loss decreased (-0.931053 --> -0.941498).  Saving model ...
Epoch: 15 cost time: 26.71657633781433
Epoch: 15, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.704 Vali Acc: 0.922 Test Loss: 0.704 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 27.032498836517334
Epoch: 16, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.992 Vali Acc: 0.918 Test Loss: 0.992 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 27.205663919448853
Epoch: 17, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.988 Vali Acc: 0.916 Test Loss: 0.988 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 26.328045129776
Epoch: 18, Steps: 89 | Train Loss: 0.367 Vali Loss: 0.654 Vali Acc: 0.935 Test Loss: 0.654 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 27.322925567626953
Epoch: 19, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.852 Vali Acc: 0.926 Test Loss: 0.852 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 26.41305136680603
Epoch: 20, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.997 Vali Acc: 0.915 Test Loss: 0.997 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 27.65874934196472
Epoch: 21, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.746 Vali Acc: 0.937 Test Loss: 0.746 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 25.87885618209839
Epoch: 22, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.680 Vali Acc: 0.926 Test Loss: 0.680 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 28.33127737045288
Epoch: 23, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.539 Vali Acc: 0.944 Test Loss: 0.539 Test Acc: 0.944
Validation loss decreased (-0.941498 --> -0.943588).  Saving model ...
Epoch: 24 cost time: 27.01820158958435
Epoch: 24, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.815 Vali Acc: 0.923 Test Loss: 0.815 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 26.860530376434326
Epoch: 25, Steps: 89 | Train Loss: 0.158 Vali Loss: 1.203 Vali Acc: 0.924 Test Loss: 1.203 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 26.143413543701172
Epoch: 26, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.905 Vali Acc: 0.931 Test Loss: 0.905 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 27.03900957107544
Epoch: 27, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.588 Vali Acc: 0.948 Test Loss: 0.588 Test Acc: 0.948
Validation loss decreased (-0.943588 --> -0.948462).  Saving model ...
Epoch: 28 cost time: 27.25190806388855
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.561 Vali Acc: 0.954 Test Loss: 0.561 Test Acc: 0.954
Validation loss decreased (-0.948462 --> -0.954033).  Saving model ...
Epoch: 29 cost time: 29.029762983322144
Epoch: 29, Steps: 89 | Train Loss: 0.147 Vali Loss: 1.029 Vali Acc: 0.921 Test Loss: 1.029 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 27.13484287261963
Epoch: 30, Steps: 89 | Train Loss: 0.097 Vali Loss: 1.015 Vali Acc: 0.928 Test Loss: 1.015 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 27.196225881576538
Epoch: 31, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.724 Vali Acc: 0.953 Test Loss: 0.724 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 27.660907983779907
Epoch: 32, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.943 Vali Acc: 0.921 Test Loss: 0.943 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 25.639592170715332
Epoch: 33, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.784 Vali Acc: 0.942 Test Loss: 0.784 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 25.424954891204834
Epoch: 34, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.624 Vali Acc: 0.954 Test Loss: 0.624 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 26.64245891571045
Epoch: 35, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.793 Vali Acc: 0.946 Test Loss: 0.793 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 27.60876488685608
Epoch: 36, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.618 Vali Acc: 0.952 Test Loss: 0.618 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 27.364521503448486
Epoch: 37, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.728 Vali Acc: 0.934 Test Loss: 0.728 Test Acc: 0.934
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 25.652143955230713
Epoch: 38, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.616 Vali Acc: 0.963 Test Loss: 0.616 Test Acc: 0.963
Validation loss decreased (-0.954033 --> -0.963086).  Saving model ...
Epoch: 39 cost time: 25.51379418373108
Epoch: 39, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.514 Vali Acc: 0.958 Test Loss: 0.514 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 27.141412258148193
Epoch: 40, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.717 Vali Acc: 0.946 Test Loss: 0.717 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 27.490377187728882
Epoch: 41, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.465 Vali Acc: 0.962 Test Loss: 0.465 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 25.52450704574585
Epoch: 42, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.702 Vali Acc: 0.946 Test Loss: 0.702 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 25.468641757965088
Epoch: 43, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.840 Vali Acc: 0.944 Test Loss: 0.840 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 25.482364892959595
Epoch: 44, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.518 Vali Acc: 0.964 Test Loss: 0.518 Test Acc: 0.964
Validation loss decreased (-0.963086 --> -0.963783).  Saving model ...
Epoch: 45 cost time: 27.35044503211975
Epoch: 45, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.723 Vali Acc: 0.953 Test Loss: 0.723 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 27.78944754600525
Epoch: 46, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.425 Vali Acc: 0.966 Test Loss: 0.425 Test Acc: 0.966
Validation loss decreased (-0.963783 --> -0.965873).  Saving model ...
Epoch: 47 cost time: 25.62662625312805
Epoch: 47, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.888 Vali Acc: 0.935 Test Loss: 0.888 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 25.61282968521118
Epoch: 48, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.556 Vali Acc: 0.955 Test Loss: 0.556 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 26.802709817886353
Epoch: 49, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.582 Vali Acc: 0.950 Test Loss: 0.582 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 27.8717782497406
Epoch: 50, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.545 Vali Acc: 0.950 Test Loss: 0.545 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 28.012806177139282
Epoch: 51, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.677 Vali Acc: 0.952 Test Loss: 0.677 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 26.684369564056396
Epoch: 52, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.927 Vali Acc: 0.939 Test Loss: 0.927 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 27.2708957195282
Epoch: 53, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.609 Vali Acc: 0.957 Test Loss: 0.609 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 26.153595685958862
Epoch: 54, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.866 Vali Acc: 0.938 Test Loss: 0.866 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 24.779688835144043
Epoch: 55, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.535 Vali Acc: 0.960 Test Loss: 0.535 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 25.488688945770264
Epoch: 56, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.646 Vali Acc: 0.948 Test Loss: 0.646 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.421091318130493
Epoch: 1, Steps: 89 | Train Loss: 1.387 Vali Loss: 0.758 Vali Acc: 0.798 Test Loss: 0.758 Test Acc: 0.798
Validation loss decreased (inf --> -0.798043).  Saving model ...
Epoch: 2 cost time: 28.14674973487854
Epoch: 2, Steps: 89 | Train Loss: 0.482 Vali Loss: 0.491 Vali Acc: 0.869 Test Loss: 0.491 Test Acc: 0.869
Validation loss decreased (-0.798043 --> -0.869076).  Saving model ...
Epoch: 3 cost time: 26.594892024993896
Epoch: 3, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.348 Vali Acc: 0.914 Test Loss: 0.348 Test Acc: 0.914
Validation loss decreased (-0.869076 --> -0.914342).  Saving model ...
Epoch: 4 cost time: 26.410818338394165
Epoch: 4, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.548 Vali Acc: 0.909 Test Loss: 0.548 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.22482466697693
Epoch: 5, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.685 Vali Acc: 0.891 Test Loss: 0.685 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.544299364089966
Epoch: 6, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
Validation loss decreased (-0.914342 --> -0.925482).  Saving model ...
Epoch: 7 cost time: 25.6253559589386
Epoch: 7, Steps: 89 | Train Loss: 0.232 Vali Loss: 1.045 Vali Acc: 0.877 Test Loss: 1.045 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.494908571243286
Epoch: 8, Steps: 89 | Train Loss: 0.329 Vali Loss: 0.675 Vali Acc: 0.922 Test Loss: 0.675 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.90420699119568
Epoch: 9, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.032 Vali Acc: 0.898 Test Loss: 1.032 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.83247423171997
Epoch: 10, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.481 Vali Acc: 0.942 Test Loss: 0.481 Test Acc: 0.942
Validation loss decreased (-0.925482 --> -0.942196).  Saving model ...
Epoch: 11 cost time: 25.159769535064697
Epoch: 11, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.719 Vali Acc: 0.920 Test Loss: 0.719 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.46773099899292
Epoch: 12, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.749 Vali Acc: 0.929 Test Loss: 0.749 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.7842378616333
Epoch: 13, Steps: 89 | Train Loss: 0.234 Vali Loss: 1.154 Vali Acc: 0.912 Test Loss: 1.154 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.131090879440308
Epoch: 14, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.532 Vali Acc: 0.944 Test Loss: 0.532 Test Acc: 0.944
Validation loss decreased (-0.942196 --> -0.943588).  Saving model ...
Epoch: 15 cost time: 26.303523540496826
Epoch: 15, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.614 Vali Acc: 0.953 Test Loss: 0.614 Test Acc: 0.953
Validation loss decreased (-0.943588 --> -0.952640).  Saving model ...
Epoch: 16 cost time: 25.556010484695435
Epoch: 16, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.642 Vali Acc: 0.941 Test Loss: 0.642 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.95098090171814
Epoch: 17, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.779 Vali Acc: 0.933 Test Loss: 0.779 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 27.47262692451477
Epoch: 18, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.542 Vali Acc: 0.944 Test Loss: 0.542 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 25.91511631011963
Epoch: 19, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.710 Vali Acc: 0.940 Test Loss: 0.710 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.092316389083862
Epoch: 20, Steps: 89 | Train Loss: 0.174 Vali Loss: 1.126 Vali Acc: 0.909 Test Loss: 1.126 Test Acc: 0.909
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 26.735217094421387
Epoch: 21, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.905 Vali Acc: 0.925 Test Loss: 0.905 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 26.162510871887207
Epoch: 22, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.759 Vali Acc: 0.936 Test Loss: 0.759 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 25.457505464553833
Epoch: 23, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.620 Vali Acc: 0.953 Test Loss: 0.620 Test Acc: 0.953
Validation loss decreased (-0.952640 --> -0.953336).  Saving model ...
Epoch: 24 cost time: 25.570092916488647
Epoch: 24, Steps: 89 | Train Loss: 0.168 Vali Loss: 1.188 Vali Acc: 0.915 Test Loss: 1.188 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 25.92633056640625
Epoch: 25, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.695 Vali Acc: 0.937 Test Loss: 0.695 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 27.086023569107056
Epoch: 26, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.815 Vali Acc: 0.939 Test Loss: 0.815 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 27.099209308624268
Epoch: 27, Steps: 89 | Train Loss: 0.168 Vali Loss: 1.096 Vali Acc: 0.929 Test Loss: 1.096 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 27.3506178855896
Epoch: 28, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.968 Vali Acc: 0.932 Test Loss: 0.968 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 26.41155433654785
Epoch: 29, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.709 Vali Acc: 0.946 Test Loss: 0.709 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 25.468973398208618
Epoch: 30, Steps: 89 | Train Loss: 0.327 Vali Loss: 1.285 Vali Acc: 0.917 Test Loss: 1.285 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 26.270265340805054
Epoch: 31, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.161 Vali Acc: 0.920 Test Loss: 1.161 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 27.13229537010193
Epoch: 32, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.793 Vali Acc: 0.942 Test Loss: 0.793 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 26.993070125579834
Epoch: 33, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.762 Vali Acc: 0.944 Test Loss: 0.762 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.11051106452942
Epoch: 1, Steps: 89 | Train Loss: 1.766 Vali Loss: 1.035 Vali Acc: 0.746 Test Loss: 1.035 Test Acc: 0.746
Validation loss decreased (inf --> -0.745811).  Saving model ...
Epoch: 2 cost time: 26.55168914794922
Epoch: 2, Steps: 89 | Train Loss: 0.514 Vali Loss: 0.682 Vali Acc: 0.842 Test Loss: 0.682 Test Acc: 0.842
Validation loss decreased (-0.745811 --> -0.841915).  Saving model ...
Epoch: 3 cost time: 26.8407039642334
Epoch: 3, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.841915 --> -0.874647).  Saving model ...
Epoch: 4 cost time: 26.36353898048401
Epoch: 4, Steps: 89 | Train Loss: 0.235 Vali Loss: 1.302 Vali Acc: 0.838 Test Loss: 1.302 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.002845764160156
Epoch: 5, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.677 Vali Acc: 0.861 Test Loss: 0.677 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.852879762649536
Epoch: 6, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.887 Vali Acc: 0.896 Test Loss: 0.887 Test Acc: 0.896
Validation loss decreased (-0.874647 --> -0.895534).  Saving model ...
Epoch: 7 cost time: 26.709328174591064
Epoch: 7, Steps: 89 | Train Loss: 0.339 Vali Loss: 1.295 Vali Acc: 0.864 Test Loss: 1.295 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.852397680282593
Epoch: 8, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.497 Vali Acc: 0.922 Test Loss: 0.497 Test Acc: 0.922
Validation loss decreased (-0.895534 --> -0.922001).  Saving model ...
Epoch: 9 cost time: 26.067623615264893
Epoch: 9, Steps: 89 | Train Loss: 0.224 Vali Loss: 1.631 Vali Acc: 0.865 Test Loss: 1.631 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 26.6494722366333
Epoch: 10, Steps: 89 | Train Loss: 0.259 Vali Loss: 1.163 Vali Acc: 0.871 Test Loss: 1.163 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 27.104647397994995
Epoch: 11, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.733 Vali Acc: 0.921 Test Loss: 0.733 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 27.184915781021118
Epoch: 12, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.625 Vali Acc: 0.923 Test Loss: 0.625 Test Acc: 0.923
Validation loss decreased (-0.922001 --> -0.922696).  Saving model ...
Epoch: 13 cost time: 25.710161447525024
Epoch: 13, Steps: 89 | Train Loss: 0.250 Vali Loss: 1.068 Vali Acc: 0.883 Test Loss: 1.068 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.904989004135132
Epoch: 14, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.732 Vali Acc: 0.918 Test Loss: 0.732 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.735936164855957
Epoch: 15, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.999 Vali Acc: 0.910 Test Loss: 0.999 Test Acc: 0.910
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 26.648816108703613
Epoch: 16, Steps: 89 | Train Loss: 0.276 Vali Loss: 1.449 Vali Acc: 0.882 Test Loss: 1.449 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 25.165738344192505
Epoch: 17, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.874 Vali Acc: 0.919 Test Loss: 0.874 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 26.592254638671875
Epoch: 18, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.543 Vali Acc: 0.948 Test Loss: 0.543 Test Acc: 0.948
Validation loss decreased (-0.922696 --> -0.947766).  Saving model ...
Epoch: 19 cost time: 25.59980821609497
Epoch: 19, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.682 Vali Acc: 0.930 Test Loss: 0.682 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 25.539647340774536
Epoch: 20, Steps: 89 | Train Loss: 0.294 Vali Loss: 1.107 Vali Acc: 0.903 Test Loss: 1.107 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 25.732637643814087
Epoch: 21, Steps: 89 | Train Loss: 0.348 Vali Loss: 1.167 Vali Acc: 0.884 Test Loss: 1.167 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 26.088573694229126
Epoch: 22, Steps: 89 | Train Loss: 0.335 Vali Loss: 1.036 Vali Acc: 0.907 Test Loss: 1.036 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 26.50263476371765
Epoch: 23, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.902 Vali Acc: 0.928 Test Loss: 0.902 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 26.52407145500183
Epoch: 24, Steps: 89 | Train Loss: 0.159 Vali Loss: 1.197 Vali Acc: 0.891 Test Loss: 1.197 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 26.65255904197693
Epoch: 25, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.582 Vali Acc: 0.953 Test Loss: 0.582 Test Acc: 0.953
Validation loss decreased (-0.947766 --> -0.952640).  Saving model ...
Epoch: 26 cost time: 25.47146773338318
Epoch: 26, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.686 Vali Acc: 0.939 Test Loss: 0.686 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 26.73740577697754
Epoch: 27, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.786 Vali Acc: 0.933 Test Loss: 0.786 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 27.04994034767151
Epoch: 28, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.866 Vali Acc: 0.939 Test Loss: 0.866 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 26.598361253738403
Epoch: 29, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.694 Vali Acc: 0.942 Test Loss: 0.694 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 25.188987970352173
Epoch: 30, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.799 Vali Acc: 0.928 Test Loss: 0.799 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 26.973102569580078
Epoch: 31, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.818 Vali Acc: 0.951 Test Loss: 0.818 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 27.12234592437744
Epoch: 32, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.667 Vali Acc: 0.950 Test Loss: 0.667 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 25.62866997718811
Epoch: 33, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.922 Vali Acc: 0.930 Test Loss: 0.922 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 25.643733501434326
Epoch: 34, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.694 Vali Acc: 0.944 Test Loss: 0.694 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 25.693296194076538
Epoch: 35, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.541 Vali Acc: 0.960 Test Loss: 0.541 Test Acc: 0.960
Validation loss decreased (-0.952640 --> -0.960301).  Saving model ...
Epoch: 36 cost time: 26.16654133796692
Epoch: 36, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.555 Vali Acc: 0.955 Test Loss: 0.555 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 26.427279710769653
Epoch: 37, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.556 Vali Acc: 0.954 Test Loss: 0.556 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 26.683523416519165
Epoch: 38, Steps: 89 | Train Loss: 0.115 Vali Loss: 1.029 Vali Acc: 0.923 Test Loss: 1.029 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 26.400539875030518
Epoch: 39, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.796 Vali Acc: 0.928 Test Loss: 0.796 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 26.736693143844604
Epoch: 40, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.984 Vali Acc: 0.921 Test Loss: 0.984 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 27.050775289535522
Epoch: 41, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.547 Vali Acc: 0.951 Test Loss: 0.547 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 25.792396068572998
Epoch: 42, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.508 Vali Acc: 0.960 Test Loss: 0.508 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 25.00468945503235
Epoch: 43, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.562 Vali Acc: 0.952 Test Loss: 0.562 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 25.637810468673706
Epoch: 44, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.537 Vali Acc: 0.960 Test Loss: 0.537 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 25.83015537261963
Epoch: 45, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.584 Vali Acc: 0.948 Test Loss: 0.584 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.242608785629272
Epoch: 1, Steps: 89 | Train Loss: 1.749 Vali Loss: 1.177 Vali Acc: 0.685 Test Loss: 1.177 Test Acc: 0.685
Validation loss decreased (inf --> -0.685225).  Saving model ...
Epoch: 2 cost time: 26.48154878616333
Epoch: 2, Steps: 89 | Train Loss: 0.472 Vali Loss: 0.608 Vali Acc: 0.821 Test Loss: 0.608 Test Acc: 0.821
Validation loss decreased (-0.685225 --> -0.821025).  Saving model ...
Epoch: 3 cost time: 26.582839012145996
Epoch: 3, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.596 Vali Acc: 0.857 Test Loss: 0.596 Test Acc: 0.857
Validation loss decreased (-0.821025 --> -0.856540).  Saving model ...
Epoch: 4 cost time: 26.572566509246826
Epoch: 4, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.909 Vali Acc: 0.779 Test Loss: 0.909 Test Acc: 0.779
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.615217685699463
Epoch: 5, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.678 Vali Acc: 0.871 Test Loss: 0.678 Test Acc: 0.871
Validation loss decreased (-0.856540 --> -0.871163).  Saving model ...
Epoch: 6 cost time: 25.8094322681427
Epoch: 6, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.956 Vali Acc: 0.866 Test Loss: 0.956 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.440077543258667
Epoch: 7, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.871 Vali Acc: 0.870 Test Loss: 0.871 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.909197330474854
Epoch: 8, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.070 Vali Acc: 0.875 Test Loss: 1.070 Test Acc: 0.875
Validation loss decreased (-0.871163 --> -0.874641).  Saving model ...
Epoch: 9 cost time: 25.20299005508423
Epoch: 9, Steps: 89 | Train Loss: 0.234 Vali Loss: 1.253 Vali Acc: 0.857 Test Loss: 1.253 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.587924242019653
Epoch: 10, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.833 Vali Acc: 0.882 Test Loss: 0.833 Test Acc: 0.882
Validation loss decreased (-0.874641 --> -0.882304).  Saving model ...
Epoch: 11 cost time: 27.345056533813477
Epoch: 11, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.679 Vali Acc: 0.903 Test Loss: 0.679 Test Acc: 0.903
Validation loss decreased (-0.882304 --> -0.902500).  Saving model ...
Epoch: 12 cost time: 26.82640814781189
Epoch: 12, Steps: 89 | Train Loss: 0.300 Vali Loss: 1.808 Vali Acc: 0.805 Test Loss: 1.808 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 27.35475468635559
Epoch: 13, Steps: 89 | Train Loss: 0.439 Vali Loss: 1.707 Vali Acc: 0.876 Test Loss: 1.707 Test Acc: 0.876
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 27.25799536705017
Epoch: 14, Steps: 89 | Train Loss: 0.458 Vali Loss: 1.049 Vali Acc: 0.890 Test Loss: 1.049 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 27.220677137374878
Epoch: 15, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.511 Vali Acc: 0.944 Test Loss: 0.511 Test Acc: 0.944
Validation loss decreased (-0.902500 --> -0.943588).  Saving model ...
Epoch: 16 cost time: 26.421568870544434
Epoch: 16, Steps: 89 | Train Loss: 0.469 Vali Loss: 0.654 Vali Acc: 0.928 Test Loss: 0.654 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 26.21554946899414
Epoch: 17, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.771 Vali Acc: 0.937 Test Loss: 0.771 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.748440742492676
Epoch: 18, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.906 Vali Acc: 0.919 Test Loss: 0.906 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 25.787094116210938
Epoch: 19, Steps: 89 | Train Loss: 0.367 Vali Loss: 0.852 Vali Acc: 0.900 Test Loss: 0.852 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.278294801712036
Epoch: 20, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.805 Vali Acc: 0.924 Test Loss: 0.805 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 25.88163948059082
Epoch: 21, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.816 Vali Acc: 0.919 Test Loss: 0.816 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 25.631376266479492
Epoch: 22, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.629 Vali Acc: 0.942 Test Loss: 0.629 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 26.619027376174927
Epoch: 23, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.758 Vali Acc: 0.935 Test Loss: 0.758 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 25.87888741493225
Epoch: 24, Steps: 89 | Train Loss: 0.462 Vali Loss: 0.644 Vali Acc: 0.941 Test Loss: 0.644 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 25.985562801361084
Epoch: 25, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.836 Vali Acc: 0.925 Test Loss: 0.836 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9435933147632312
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.865600109100342
Epoch: 1, Steps: 89 | Train Loss: 1.718 Vali Loss: 1.201 Vali Acc: 0.665 Test Loss: 1.201 Test Acc: 0.665
Validation loss decreased (inf --> -0.665030).  Saving model ...
Epoch: 2 cost time: 25.9981906414032
Epoch: 2, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.750 Vali Acc: 0.801 Test Loss: 0.750 Test Acc: 0.801
Validation loss decreased (-0.665030 --> -0.800828).  Saving model ...
Epoch: 3 cost time: 26.615687608718872
Epoch: 3, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.761 Vali Acc: 0.832 Test Loss: 0.761 Test Acc: 0.832
Validation loss decreased (-0.800828 --> -0.832165).  Saving model ...
Epoch: 4 cost time: 25.99857783317566
Epoch: 4, Steps: 89 | Train Loss: 0.197 Vali Loss: 1.683 Vali Acc: 0.653 Test Loss: 1.683 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.9590163230896
Epoch: 5, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.559 Vali Acc: 0.883 Test Loss: 0.559 Test Acc: 0.883
Validation loss decreased (-0.832165 --> -0.883003).  Saving model ...
Epoch: 6 cost time: 27.14964723587036
Epoch: 6, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.733 Vali Acc: 0.863 Test Loss: 0.733 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.714337825775146
Epoch: 7, Steps: 89 | Train Loss: 0.221 Vali Loss: 1.094 Vali Acc: 0.829 Test Loss: 1.094 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.33015489578247
Epoch: 8, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.667 Vali Acc: 0.889 Test Loss: 0.667 Test Acc: 0.889
Validation loss decreased (-0.883003 --> -0.888573).  Saving model ...
Epoch: 9 cost time: 25.601059436798096
Epoch: 9, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.961 Vali Acc: 0.868 Test Loss: 0.961 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.15137028694153
Epoch: 10, Steps: 89 | Train Loss: 0.213 Vali Loss: 1.567 Vali Acc: 0.811 Test Loss: 1.567 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 27.225054025650024
Epoch: 11, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.844 Vali Acc: 0.888 Test Loss: 0.844 Test Acc: 0.888
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 26.035781621932983
Epoch: 12, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.920 Vali Acc: 0.878 Test Loss: 0.920 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 26.627821445465088
Epoch: 13, Steps: 89 | Train Loss: 0.336 Vali Loss: 1.701 Vali Acc: 0.844 Test Loss: 1.701 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 26.09279227256775
Epoch: 14, Steps: 89 | Train Loss: 0.366 Vali Loss: 1.611 Vali Acc: 0.852 Test Loss: 1.611 Test Acc: 0.852
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 27.051433324813843
Epoch: 15, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.885 Vali Acc: 0.905 Test Loss: 0.885 Test Acc: 0.905
Validation loss decreased (-0.888573 --> -0.905284).  Saving model ...
Epoch: 16 cost time: 25.628970861434937
Epoch: 16, Steps: 89 | Train Loss: 0.269 Vali Loss: 1.653 Vali Acc: 0.866 Test Loss: 1.653 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 27.07045316696167
Epoch: 17, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.805 Vali Acc: 0.930 Test Loss: 0.805 Test Acc: 0.930
Validation loss decreased (-0.905284 --> -0.930354).  Saving model ...
Epoch: 18 cost time: 27.14739990234375
Epoch: 18, Steps: 89 | Train Loss: 0.416 Vali Loss: 1.211 Vali Acc: 0.894 Test Loss: 1.211 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 27.557332277297974
Epoch: 19, Steps: 89 | Train Loss: 0.482 Vali Loss: 0.769 Vali Acc: 0.924 Test Loss: 0.769 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 26.80982494354248
Epoch: 20, Steps: 89 | Train Loss: 0.526 Vali Loss: 1.416 Vali Acc: 0.880 Test Loss: 1.416 Test Acc: 0.880
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 25.828458786010742
Epoch: 21, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.783 Vali Acc: 0.924 Test Loss: 0.783 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 26.3979229927063
Epoch: 22, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.813 Vali Acc: 0.938 Test Loss: 0.813 Test Acc: 0.938
Validation loss decreased (-0.930354 --> -0.938014).  Saving model ...
Epoch: 23 cost time: 27.67976403236389
Epoch: 23, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.611 Vali Acc: 0.950 Test Loss: 0.611 Test Acc: 0.950
Validation loss decreased (-0.938014 --> -0.949855).  Saving model ...
Epoch: 24 cost time: 24.93193817138672
Epoch: 24, Steps: 89 | Train Loss: 0.441 Vali Loss: 1.044 Vali Acc: 0.917 Test Loss: 1.044 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 26.69883131980896
Epoch: 25, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.554 Vali Acc: 0.950 Test Loss: 0.554 Test Acc: 0.950
Validation loss decreased (-0.949855 --> -0.949855).  Saving model ...
Epoch: 26 cost time: 28.04627251625061
Epoch: 26, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.714 Vali Acc: 0.953 Test Loss: 0.714 Test Acc: 0.953
Validation loss decreased (-0.949855 --> -0.953335).  Saving model ...
Epoch: 27 cost time: 25.534006118774414
Epoch: 27, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.866 Vali Acc: 0.942 Test Loss: 0.866 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 25.42113494873047
Epoch: 28, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.838 Vali Acc: 0.944 Test Loss: 0.838 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 26.80433964729309
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.518 Vali Acc: 0.954 Test Loss: 0.518 Test Acc: 0.954
Validation loss decreased (-0.953335 --> -0.954034).  Saving model ...
Epoch: 30 cost time: 24.8494291305542
Epoch: 30, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.578 Vali Acc: 0.958 Test Loss: 0.578 Test Acc: 0.958
Validation loss decreased (-0.954034 --> -0.958211).  Saving model ...
Epoch: 31 cost time: 24.249499082565308
Epoch: 31, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.661 Vali Acc: 0.954 Test Loss: 0.661 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 27.000243425369263
Epoch: 32, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.663 Vali Acc: 0.948 Test Loss: 0.663 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 27.510624170303345
Epoch: 33, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.615 Vali Acc: 0.953 Test Loss: 0.615 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 27.774111032485962
Epoch: 34, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.578 Vali Acc: 0.962 Test Loss: 0.578 Test Acc: 0.962
Validation loss decreased (-0.958211 --> -0.962390).  Saving model ...
Epoch: 35 cost time: 27.957422971725464
Epoch: 35, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.699 Vali Acc: 0.958 Test Loss: 0.699 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 27.418116331100464
Epoch: 36, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.652 Vali Acc: 0.947 Test Loss: 0.652 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 26.04780387878418
Epoch: 37, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.531 Vali Acc: 0.967 Test Loss: 0.531 Test Acc: 0.967
Validation loss decreased (-0.962390 --> -0.966569).  Saving model ...
Epoch: 38 cost time: 26.383472442626953
Epoch: 38, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.734 Vali Acc: 0.946 Test Loss: 0.734 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 25.633869647979736
Epoch: 39, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.552 Vali Acc: 0.963 Test Loss: 0.552 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 25.711368799209595
Epoch: 40, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.472 Vali Acc: 0.964 Test Loss: 0.472 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 26.56873631477356
Epoch: 41, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.723 Vali Acc: 0.939 Test Loss: 0.723 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 26.23082709312439
Epoch: 42, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.542 Vali Acc: 0.958 Test Loss: 0.542 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 25.415582418441772
Epoch: 43, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.721 Vali Acc: 0.957 Test Loss: 0.721 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 26.671947240829468
Epoch: 44, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.892 Vali Acc: 0.951 Test Loss: 0.892 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 26.611859798431396
Epoch: 45, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.591 Vali Acc: 0.962 Test Loss: 0.591 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 25.112616062164307
Epoch: 46, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.738 Vali Acc: 0.946 Test Loss: 0.738 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 26.53768277168274
Epoch: 47, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.677 Vali Acc: 0.958 Test Loss: 0.677 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.90825891494751
Epoch: 1, Steps: 89 | Train Loss: 1.771 Vali Loss: 1.448 Vali Acc: 0.638 Test Loss: 1.448 Test Acc: 0.638
Validation loss decreased (inf --> -0.637869).  Saving model ...
Epoch: 2 cost time: 26.099550247192383
Epoch: 2, Steps: 89 | Train Loss: 0.449 Vali Loss: 1.128 Vali Acc: 0.734 Test Loss: 1.128 Test Acc: 0.734
Validation loss decreased (-0.637869 --> -0.733972).  Saving model ...
Epoch: 3 cost time: 26.72900652885437
Epoch: 3, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.082 Vali Acc: 0.791 Test Loss: 1.082 Test Acc: 0.791
Validation loss decreased (-0.733972 --> -0.791076).  Saving model ...
Epoch: 4 cost time: 26.710044860839844
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 1.343 Vali Acc: 0.745 Test Loss: 1.343 Test Acc: 0.745
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.010949850082397
Epoch: 5, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.581 Vali Acc: 0.870 Test Loss: 0.581 Test Acc: 0.870
Validation loss decreased (-0.791076 --> -0.870468).  Saving model ...
Epoch: 6 cost time: 24.98692560195923
Epoch: 6, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.891 Vali Acc: 0.864 Test Loss: 0.891 Test Acc: 0.864
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.25632882118225
Epoch: 7, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.979 Vali Acc: 0.877 Test Loss: 0.979 Test Acc: 0.877
Validation loss decreased (-0.870468 --> -0.876731).  Saving model ...
Epoch: 8 cost time: 26.76991033554077
Epoch: 8, Steps: 89 | Train Loss: 0.222 Vali Loss: 1.069 Vali Acc: 0.839 Test Loss: 1.069 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.71895170211792
Epoch: 9, Steps: 89 | Train Loss: 0.186 Vali Loss: 1.947 Vali Acc: 0.765 Test Loss: 1.947 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.085740327835083
Epoch: 10, Steps: 89 | Train Loss: 0.349 Vali Loss: 1.245 Vali Acc: 0.817 Test Loss: 1.245 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.914141416549683
Epoch: 11, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.983 Vali Acc: 0.878 Test Loss: 0.983 Test Acc: 0.878
Validation loss decreased (-0.876731 --> -0.878124).  Saving model ...
Epoch: 12 cost time: 27.18955659866333
Epoch: 12, Steps: 89 | Train Loss: 0.231 Vali Loss: 1.683 Vali Acc: 0.826 Test Loss: 1.683 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 26.24893808364868
Epoch: 13, Steps: 89 | Train Loss: 0.328 Vali Loss: 1.228 Vali Acc: 0.880 Test Loss: 1.228 Test Acc: 0.880
Validation loss decreased (-0.878124 --> -0.879514).  Saving model ...
Epoch: 14 cost time: 25.07977032661438
Epoch: 14, Steps: 89 | Train Loss: 0.362 Vali Loss: 1.556 Vali Acc: 0.886 Test Loss: 1.556 Test Acc: 0.886
Validation loss decreased (-0.879514 --> -0.885778).  Saving model ...
Epoch: 15 cost time: 26.311445236206055
Epoch: 15, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.971 Vali Acc: 0.894 Test Loss: 0.971 Test Acc: 0.894
Validation loss decreased (-0.885778 --> -0.894141).  Saving model ...
Epoch: 16 cost time: 25.456226587295532
Epoch: 16, Steps: 89 | Train Loss: 0.386 Vali Loss: 1.269 Vali Acc: 0.868 Test Loss: 1.269 Test Acc: 0.868
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.550430297851562
Epoch: 17, Steps: 89 | Train Loss: 0.400 Vali Loss: 0.955 Vali Acc: 0.920 Test Loss: 0.955 Test Acc: 0.920
Validation loss decreased (-0.894141 --> -0.919907).  Saving model ...
Epoch: 18 cost time: 26.170231580734253
Epoch: 18, Steps: 89 | Train Loss: 0.355 Vali Loss: 1.246 Vali Acc: 0.891 Test Loss: 1.246 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 26.791957139968872
Epoch: 19, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.996 Vali Acc: 0.918 Test Loss: 0.996 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 25.784680366516113
Epoch: 20, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.969 Vali Acc: 0.923 Test Loss: 0.969 Test Acc: 0.923
Validation loss decreased (-0.919907 --> -0.922692).  Saving model ...
Epoch: 21 cost time: 26.20324444770813
Epoch: 21, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.987 Vali Acc: 0.932 Test Loss: 0.987 Test Acc: 0.932
Validation loss decreased (-0.922692 --> -0.931745).  Saving model ...
Epoch: 22 cost time: 26.317954301834106
Epoch: 22, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.915 Vali Acc: 0.935 Test Loss: 0.915 Test Acc: 0.935
Validation loss decreased (-0.931745 --> -0.934531).  Saving model ...
Epoch: 23 cost time: 25.785886764526367
Epoch: 23, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.880 Vali Acc: 0.926 Test Loss: 0.880 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 25.117003917694092
Epoch: 24, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.629 Vali Acc: 0.946 Test Loss: 0.629 Test Acc: 0.946
Validation loss decreased (-0.934531 --> -0.946373).  Saving model ...
Epoch: 25 cost time: 25.6759512424469
Epoch: 25, Steps: 89 | Train Loss: 0.258 Vali Loss: 1.412 Vali Acc: 0.910 Test Loss: 1.412 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 26.156582355499268
Epoch: 26, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.892 Vali Acc: 0.946 Test Loss: 0.892 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 24.959428310394287
Epoch: 27, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.608 Vali Acc: 0.953 Test Loss: 0.608 Test Acc: 0.953
Validation loss decreased (-0.946373 --> -0.953337).  Saving model ...
Epoch: 28 cost time: 26.831746339797974
Epoch: 28, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.653 Vali Acc: 0.958 Test Loss: 0.653 Test Acc: 0.958
Validation loss decreased (-0.953337 --> -0.958211).  Saving model ...
Epoch: 29 cost time: 27.31322455406189
Epoch: 29, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.884 Vali Acc: 0.942 Test Loss: 0.884 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 25.541152000427246
Epoch: 30, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.976 Vali Acc: 0.928 Test Loss: 0.976 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 25.968160152435303
Epoch: 31, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.570 Vali Acc: 0.959 Test Loss: 0.570 Test Acc: 0.959
Validation loss decreased (-0.958211 --> -0.958908).  Saving model ...
Epoch: 32 cost time: 26.635920763015747
Epoch: 32, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.711 Vali Acc: 0.956 Test Loss: 0.711 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 26.379520416259766
Epoch: 33, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.704 Vali Acc: 0.951 Test Loss: 0.704 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 25.527831077575684
Epoch: 34, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.837 Vali Acc: 0.945 Test Loss: 0.837 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 25.300854206085205
Epoch: 35, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.635 Vali Acc: 0.960 Test Loss: 0.635 Test Acc: 0.960
Validation loss decreased (-0.958908 --> -0.959604).  Saving model ...
Epoch: 36 cost time: 27.162538766860962
Epoch: 36, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.710 Vali Acc: 0.949 Test Loss: 0.710 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 26.878453016281128
Epoch: 37, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.621 Vali Acc: 0.958 Test Loss: 0.621 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 26.361807107925415
Epoch: 38, Steps: 89 | Train Loss: 0.086 Vali Loss: 1.030 Vali Acc: 0.939 Test Loss: 1.030 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 26.905431032180786
Epoch: 39, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.709 Vali Acc: 0.956 Test Loss: 0.709 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 26.832785606384277
Epoch: 40, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.549 Vali Acc: 0.962 Test Loss: 0.549 Test Acc: 0.962
Validation loss decreased (-0.959604 --> -0.962390).  Saving model ...
Epoch: 41 cost time: 25.85325789451599
Epoch: 41, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.722 Vali Acc: 0.955 Test Loss: 0.722 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 27.10144567489624
Epoch: 42, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.687 Vali Acc: 0.955 Test Loss: 0.687 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 27.321739435195923
Epoch: 43, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.618 Vali Acc: 0.965 Test Loss: 0.618 Test Acc: 0.965
Validation loss decreased (-0.962390 --> -0.965175).  Saving model ...
Epoch: 44 cost time: 25.936371326446533
Epoch: 44, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.962 Vali Acc: 0.938 Test Loss: 0.962 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 26.300508499145508
Epoch: 45, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.658 Vali Acc: 0.946 Test Loss: 0.658 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 26.10038161277771
Epoch: 46, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.736 Vali Acc: 0.953 Test Loss: 0.736 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 25.402267932891846
Epoch: 47, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.873 Vali Acc: 0.956 Test Loss: 0.873 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 25.346383571624756
Epoch: 48, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.592 Vali Acc: 0.966 Test Loss: 0.592 Test Acc: 0.966
Validation loss decreased (-0.965175 --> -0.965872).  Saving model ...
Epoch: 49 cost time: 27.439719676971436
Epoch: 49, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.813 Vali Acc: 0.944 Test Loss: 0.813 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 27.869622945785522
Epoch: 50, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.525 Vali Acc: 0.966 Test Loss: 0.525 Test Acc: 0.966
Validation loss decreased (-0.965872 --> -0.965872).  Saving model ...
Epoch: 51 cost time: 26.827454090118408
Epoch: 51, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.722 Vali Acc: 0.960 Test Loss: 0.722 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 27.60855531692505
Epoch: 52, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.617 Vali Acc: 0.957 Test Loss: 0.617 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 27.295796871185303
Epoch: 53, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.521 Vali Acc: 0.969 Test Loss: 0.521 Test Acc: 0.969
Validation loss decreased (-0.965872 --> -0.969354).  Saving model ...
Epoch: 54 cost time: 25.60818600654602
Epoch: 54, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.529 Vali Acc: 0.967 Test Loss: 0.529 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 25.372014045715332
Epoch: 55, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.639 Vali Acc: 0.958 Test Loss: 0.639 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 26.00091314315796
Epoch: 56, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.756 Vali Acc: 0.958 Test Loss: 0.756 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 25.697564601898193
Epoch: 57, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.717 Vali Acc: 0.959 Test Loss: 0.717 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 25.946417808532715
Epoch: 58, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.563 Vali Acc: 0.960 Test Loss: 0.563 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 27.18310236930847
Epoch: 59, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.823 Vali Acc: 0.953 Test Loss: 0.823 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 26.955129146575928
Epoch: 60, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.562 Vali Acc: 0.967 Test Loss: 0.562 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 25.29591155052185
Epoch: 61, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.548 Vali Acc: 0.962 Test Loss: 0.548 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 27.216269731521606
Epoch: 62, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.630 Vali Acc: 0.966 Test Loss: 0.630 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 25.731119871139526
Epoch: 63, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.589 Vali Acc: 0.965 Test Loss: 0.589 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.21841549873352
Epoch: 1, Steps: 89 | Train Loss: 1.816 Vali Loss: 1.273 Vali Acc: 0.675 Test Loss: 1.273 Test Acc: 0.675
Validation loss decreased (inf --> -0.675475).  Saving model ...
Epoch: 2 cost time: 27.120782375335693
Epoch: 2, Steps: 89 | Train Loss: 0.457 Vali Loss: 0.909 Vali Acc: 0.785 Test Loss: 0.909 Test Acc: 0.785
Validation loss decreased (-0.675475 --> -0.784810).  Saving model ...
Epoch: 3 cost time: 26.962743520736694
Epoch: 3, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.709 Vali Acc: 0.852 Test Loss: 0.709 Test Acc: 0.852
Validation loss decreased (-0.784810 --> -0.852361).  Saving model ...
Epoch: 4 cost time: 25.130033016204834
Epoch: 4, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.787 Vali Acc: 0.825 Test Loss: 0.787 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.048982858657837
Epoch: 5, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.491 Vali Acc: 0.905 Test Loss: 0.491 Test Acc: 0.905
Validation loss decreased (-0.852361 --> -0.904591).  Saving model ...
Epoch: 6 cost time: 25.755899906158447
Epoch: 6, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.817 Vali Acc: 0.867 Test Loss: 0.817 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.17654013633728
Epoch: 7, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.650 Vali Acc: 0.912 Test Loss: 0.650 Test Acc: 0.912
Validation loss decreased (-0.904591 --> -0.911553).  Saving model ...
Epoch: 8 cost time: 26.00249433517456
Epoch: 8, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.784 Vali Acc: 0.885 Test Loss: 0.784 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.447274684906006
Epoch: 9, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.514 Vali Acc: 0.796 Test Loss: 1.514 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.520044803619385
Epoch: 10, Steps: 89 | Train Loss: 0.231 Vali Loss: 1.613 Vali Acc: 0.813 Test Loss: 1.613 Test Acc: 0.813
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.18775177001953
Epoch: 11, Steps: 89 | Train Loss: 0.395 Vali Loss: 1.133 Vali Acc: 0.879 Test Loss: 1.133 Test Acc: 0.879
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.715304851531982
Epoch: 12, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.743 Vali Acc: 0.913 Test Loss: 0.743 Test Acc: 0.913
Validation loss decreased (-0.911553 --> -0.912945).  Saving model ...
Epoch: 13 cost time: 26.02792000770569
Epoch: 13, Steps: 89 | Train Loss: 0.413 Vali Loss: 1.370 Vali Acc: 0.904 Test Loss: 1.370 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.78049373626709
Epoch: 14, Steps: 89 | Train Loss: 0.371 Vali Loss: 1.332 Vali Acc: 0.873 Test Loss: 1.332 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.64186716079712
Epoch: 15, Steps: 89 | Train Loss: 0.395 Vali Loss: 1.209 Vali Acc: 0.891 Test Loss: 1.209 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 26.898293495178223
Epoch: 16, Steps: 89 | Train Loss: 0.572 Vali Loss: 1.019 Vali Acc: 0.912 Test Loss: 1.019 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 27.240598440170288
Epoch: 17, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.664 Vali Acc: 0.927 Test Loss: 0.664 Test Acc: 0.927
Validation loss decreased (-0.912945 --> -0.926874).  Saving model ...
Epoch: 18 cost time: 28.424821138381958
Epoch: 18, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.918 Vali Acc: 0.923 Test Loss: 0.918 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 28.786057949066162
Epoch: 19, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.595 Vali Acc: 0.946 Test Loss: 0.595 Test Acc: 0.946
Validation loss decreased (-0.926874 --> -0.946373).  Saving model ...
Epoch: 20 cost time: 26.43333673477173
Epoch: 20, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.984 Vali Acc: 0.915 Test Loss: 0.984 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 26.620821475982666
Epoch: 21, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.733 Vali Acc: 0.944 Test Loss: 0.733 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 26.642192602157593
Epoch: 22, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.589 Vali Acc: 0.949 Test Loss: 0.589 Test Acc: 0.949
Validation loss decreased (-0.946373 --> -0.949158).  Saving model ...
Epoch: 23 cost time: 26.095110416412354
Epoch: 23, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.771 Vali Acc: 0.923 Test Loss: 0.771 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 28.085213661193848
Epoch: 24, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.799 Vali Acc: 0.935 Test Loss: 0.799 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 27.482805490493774
Epoch: 25, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.567 Vali Acc: 0.954 Test Loss: 0.567 Test Acc: 0.954
Validation loss decreased (-0.949158 --> -0.954033).  Saving model ...
Epoch: 26 cost time: 28.323209762573242
Epoch: 26, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.898 Vali Acc: 0.954 Test Loss: 0.898 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 26.610676765441895
Epoch: 27, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.775 Vali Acc: 0.944 Test Loss: 0.775 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 26.402120113372803
Epoch: 28, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.749 Vali Acc: 0.951 Test Loss: 0.749 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 24.046835899353027
Epoch: 29, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.861 Vali Acc: 0.916 Test Loss: 0.861 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 24.986121892929077
Epoch: 30, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.564 Vali Acc: 0.945 Test Loss: 0.564 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 25.67097043991089
Epoch: 31, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.683 Vali Acc: 0.950 Test Loss: 0.683 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 25.51586413383484
Epoch: 32, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.629 Vali Acc: 0.955 Test Loss: 0.629 Test Acc: 0.955
Validation loss decreased (-0.954033 --> -0.954729).  Saving model ...
Epoch: 33 cost time: 26.86122727394104
Epoch: 33, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.488 Vali Acc: 0.962 Test Loss: 0.488 Test Acc: 0.962
Validation loss decreased (-0.954729 --> -0.962391).  Saving model ...
Epoch: 34 cost time: 26.041725873947144
Epoch: 34, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.521 Vali Acc: 0.958 Test Loss: 0.521 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 27.844976663589478
Epoch: 35, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.660 Vali Acc: 0.956 Test Loss: 0.660 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 26.486581802368164
Epoch: 36, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.568 Vali Acc: 0.958 Test Loss: 0.568 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 27.356895208358765
Epoch: 37, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.543 Vali Acc: 0.957 Test Loss: 0.543 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 29.22910237312317
Epoch: 38, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.808 Vali Acc: 0.944 Test Loss: 0.808 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 27.372390270233154
Epoch: 39, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.594 Vali Acc: 0.960 Test Loss: 0.594 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 26.194937467575073
Epoch: 40, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.593 Vali Acc: 0.955 Test Loss: 0.593 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 25.948662042617798
Epoch: 41, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.679 Vali Acc: 0.953 Test Loss: 0.679 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 24.651827573776245
Epoch: 42, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.901 Vali Acc: 0.926 Test Loss: 0.901 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 25.204532623291016
Epoch: 43, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.728 Vali Acc: 0.948 Test Loss: 0.728 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.19395899772644
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.065 Test Loss: 2.996 Test Acc: 0.065
Validation loss decreased (inf --> -0.064733).  Saving model ...
Epoch: 2 cost time: 26.535603523254395
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 28.086803436279297
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 26.389675855636597
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 25.755735397338867
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 26.395905256271362
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 27.589974403381348
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 26.300211668014526
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 26.82524037361145
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 26.60308337211609
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 25.65401840209961
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 25.385830879211426
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 26.066012620925903
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 27.278674125671387
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 26.191476583480835
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 27.498639345169067
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 25.87797212600708
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 25.5023193359375
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.640170335769653
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 25.60739493370056
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 26.273146390914917
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 26.559436798095703
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 27.341797351837158
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 26.89879274368286
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 25.624959230422974
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 26.138882875442505
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 27.035114288330078
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 26.144644498825073
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 25.528096437454224
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 26.10977077484131
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 25.850867986679077
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 25.22410011291504
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 25.66428542137146
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 25.529247283935547
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 26.513521671295166
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 25.499886989593506
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 25.484718084335327
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 25.647843599319458
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 24.732170581817627
Epoch: 39, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 25.189988374710083
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 25.332029342651367
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 25.912916898727417
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 26.28942584991455
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 26.47518539428711
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 25.883092641830444
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 25.338747262954712
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 23.64510154724121
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 24.547532320022583
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 25.35228705406189
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 25.704946994781494
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 24.587928533554077
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 24.835966110229492
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 25.347986698150635
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 25.665612936019897
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 26.122188568115234
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 26.999812364578247
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 26.14898943901062
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 25.918331384658813
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 25.33530044555664
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 24.417072772979736
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 25.388906002044678
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 62 cost time: 25.70302653312683
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 26.021807432174683
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 25.27631902694702
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 65 cost time: 24.801108837127686
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 66 cost time: 24.924842596054077
Epoch: 66, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 24.67333483695984
Epoch: 67, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 23.281969785690308
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 24.40356683731079
Epoch: 69, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 25.176510334014893
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 24.634279489517212
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 72 cost time: 24.5489182472229
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 23.268704414367676
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 23.972843647003174
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 24.40064764022827
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 24.163419485092163
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 23.013086080551147
Epoch: 77, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 23.179237127304077
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 24.16276717185974
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 24.190552234649658
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 25.8205406665802
Epoch: 81, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 5141012
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.138141632080078
Epoch: 1, Steps: 89 | Train Loss: 1.052 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
Validation loss decreased (inf --> -0.883701).  Saving model ...
Epoch: 2 cost time: 23.4879150390625
Epoch: 2, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.437 Vali Acc: 0.909 Test Loss: 0.437 Test Acc: 0.909
Validation loss decreased (-0.883701 --> -0.908770).  Saving model ...
Epoch: 3 cost time: 23.90882182121277
Epoch: 3, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.501 Vali Acc: 0.894 Test Loss: 0.501 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.318992376327515
Epoch: 4, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.523 Vali Acc: 0.893 Test Loss: 0.523 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.94268035888672
Epoch: 5, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.445 Vali Acc: 0.928 Test Loss: 0.445 Test Acc: 0.928
Validation loss decreased (-0.908770 --> -0.927572).  Saving model ...
Epoch: 6 cost time: 26.901443481445312
Epoch: 6, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.611 Vali Acc: 0.915 Test Loss: 0.611 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.65503716468811
Epoch: 7, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.702 Vali Acc: 0.907 Test Loss: 0.702 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.617496252059937
Epoch: 8, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.633 Vali Acc: 0.918 Test Loss: 0.633 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 26.64492893218994
Epoch: 9, Steps: 89 | Train Loss: 0.388 Vali Loss: 1.117 Vali Acc: 0.887 Test Loss: 1.117 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.701573610305786
Epoch: 10, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.872 Vali Acc: 0.906 Test Loss: 0.872 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.799944400787354
Epoch: 11, Steps: 89 | Train Loss: 0.261 Vali Loss: 1.006 Vali Acc: 0.912 Test Loss: 1.006 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 26.227136850357056
Epoch: 12, Steps: 89 | Train Loss: 0.259 Vali Loss: 1.071 Vali Acc: 0.893 Test Loss: 1.071 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 27.863030433654785
Epoch: 13, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.841 Vali Acc: 0.931 Test Loss: 0.841 Test Acc: 0.931
Validation loss decreased (-0.927572 --> -0.931050).  Saving model ...
Epoch: 14 cost time: 27.6452796459198
Epoch: 14, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.964 Vali Acc: 0.922 Test Loss: 0.964 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.598631620407104
Epoch: 15, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.664 Vali Acc: 0.928 Test Loss: 0.664 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 27.41316509246826
Epoch: 16, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.793 Vali Acc: 0.941 Test Loss: 0.793 Test Acc: 0.941
Validation loss decreased (-0.931050 --> -0.940800).  Saving model ...
Epoch: 17 cost time: 27.00259304046631
Epoch: 17, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.963 Vali Acc: 0.928 Test Loss: 0.963 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 25.3286452293396
Epoch: 18, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.676 Vali Acc: 0.945 Test Loss: 0.676 Test Acc: 0.945
Validation loss decreased (-0.940800 --> -0.944979).  Saving model ...
Epoch: 19 cost time: 27.063411951065063
Epoch: 19, Steps: 89 | Train Loss: 0.194 Vali Loss: 1.277 Vali Acc: 0.907 Test Loss: 1.277 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 26.411845207214355
Epoch: 20, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.762 Vali Acc: 0.937 Test Loss: 0.762 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 28.43866539001465
Epoch: 21, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.738 Vali Acc: 0.946 Test Loss: 0.738 Test Acc: 0.946
Validation loss decreased (-0.944979 --> -0.946371).  Saving model ...
Epoch: 22 cost time: 27.78369116783142
Epoch: 22, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.903 Vali Acc: 0.932 Test Loss: 0.903 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 25.174165964126587
Epoch: 23, Steps: 89 | Train Loss: 0.254 Vali Loss: 1.036 Vali Acc: 0.929 Test Loss: 1.036 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 25.079463243484497
Epoch: 24, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.893 Vali Acc: 0.927 Test Loss: 0.893 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 24.62201738357544
Epoch: 25, Steps: 89 | Train Loss: 0.243 Vali Loss: 1.226 Vali Acc: 0.915 Test Loss: 1.226 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 26.257280111312866
Epoch: 26, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.741 Vali Acc: 0.946 Test Loss: 0.741 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 27.37185525894165
Epoch: 27, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.775 Vali Acc: 0.946 Test Loss: 0.775 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 27.40042781829834
Epoch: 28, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.835 Vali Acc: 0.942 Test Loss: 0.835 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 25.87811803817749
Epoch: 29, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.689 Vali Acc: 0.947 Test Loss: 0.689 Test Acc: 0.947
Validation loss decreased (-0.946371 --> -0.947068).  Saving model ...
Epoch: 30 cost time: 24.973400354385376
Epoch: 30, Steps: 89 | Train Loss: 0.120 Vali Loss: 1.616 Vali Acc: 0.896 Test Loss: 1.616 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 25.543058156967163
Epoch: 31, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.703 Vali Acc: 0.946 Test Loss: 0.703 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 27.15324091911316
Epoch: 32, Steps: 89 | Train Loss: 0.172 Vali Loss: 1.389 Vali Acc: 0.918 Test Loss: 1.389 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 27.672035932540894
Epoch: 33, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.667 Vali Acc: 0.949 Test Loss: 0.667 Test Acc: 0.949
Validation loss decreased (-0.947068 --> -0.949158).  Saving model ...
Epoch: 34 cost time: 27.801854372024536
Epoch: 34, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.810 Vali Acc: 0.935 Test Loss: 0.810 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 27.57378125190735
Epoch: 35, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.778 Vali Acc: 0.944 Test Loss: 0.778 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 25.70853543281555
Epoch: 36, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.840 Vali Acc: 0.945 Test Loss: 0.840 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 25.287201166152954
Epoch: 37, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.863 Vali Acc: 0.946 Test Loss: 0.863 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 26.006906509399414
Epoch: 38, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.879 Vali Acc: 0.938 Test Loss: 0.879 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 25.29497194290161
Epoch: 39, Steps: 89 | Train Loss: 0.117 Vali Loss: 1.203 Vali Acc: 0.923 Test Loss: 1.203 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 24.192561626434326
Epoch: 40, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.951 Vali Acc: 0.923 Test Loss: 0.951 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 26.76448678970337
Epoch: 41, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.810 Vali Acc: 0.957 Test Loss: 0.810 Test Acc: 0.957
Validation loss decreased (-0.949158 --> -0.956816).  Saving model ...
Epoch: 42 cost time: 27.25716781616211
Epoch: 42, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.819 Vali Acc: 0.951 Test Loss: 0.819 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 26.20957040786743
Epoch: 43, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.932 Vali Acc: 0.933 Test Loss: 0.932 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 25.369636297225952
Epoch: 44, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.879 Vali Acc: 0.944 Test Loss: 0.879 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 24.10385513305664
Epoch: 45, Steps: 89 | Train Loss: 0.045 Vali Loss: 1.048 Vali Acc: 0.930 Test Loss: 1.048 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 24.270803451538086
Epoch: 46, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.973 Vali Acc: 0.937 Test Loss: 0.973 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 26.337899208068848
Epoch: 47, Steps: 89 | Train Loss: 0.271 Vali Loss: 1.355 Vali Acc: 0.919 Test Loss: 1.355 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 27.54622983932495
Epoch: 48, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.947 Vali Acc: 0.935 Test Loss: 0.947 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 27.946147680282593
Epoch: 49, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.823 Vali Acc: 0.951 Test Loss: 0.823 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 25.471932888031006
Epoch: 50, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.797 Vali Acc: 0.945 Test Loss: 0.797 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 24.43736696243286
Epoch: 51, Steps: 89 | Train Loss: 0.115 Vali Loss: 1.214 Vali Acc: 0.929 Test Loss: 1.214 Test Acc: 0.929
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.373849630355835
Epoch: 1, Steps: 89 | Train Loss: 1.129 Vali Loss: 0.481 Vali Acc: 0.866 Test Loss: 0.481 Test Acc: 0.866
Validation loss decreased (inf --> -0.866290).  Saving model ...
Epoch: 2 cost time: 24.60818862915039
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
Validation loss decreased (-0.866290 --> -0.900414).  Saving model ...
Epoch: 3 cost time: 26.181624174118042
Epoch: 3, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.537 Vali Acc: 0.873 Test Loss: 0.537 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.832525730133057
Epoch: 4, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.575 Vali Acc: 0.891 Test Loss: 0.575 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.77144694328308
Epoch: 5, Steps: 89 | Train Loss: 0.278 Vali Loss: 1.508 Vali Acc: 0.872 Test Loss: 1.508 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.292241096496582
Epoch: 6, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.454 Vali Acc: 0.924 Test Loss: 0.454 Test Acc: 0.924
Validation loss decreased (-0.900414 --> -0.924090).  Saving model ...
Epoch: 7 cost time: 24.198346614837646
Epoch: 7, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.818 Vali Acc: 0.891 Test Loss: 0.818 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.262420415878296
Epoch: 8, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.638 Vali Acc: 0.919 Test Loss: 0.638 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.591461658477783
Epoch: 9, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.605 Vali Acc: 0.918 Test Loss: 0.605 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.349766492843628
Epoch: 10, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.679 Vali Acc: 0.926 Test Loss: 0.679 Test Acc: 0.926
Validation loss decreased (-0.924090 --> -0.926177).  Saving model ...
Epoch: 11 cost time: 25.092020988464355
Epoch: 11, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.675 Vali Acc: 0.925 Test Loss: 0.675 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.06968331336975
Epoch: 12, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.656 Vali Acc: 0.925 Test Loss: 0.656 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 24.486595630645752
Epoch: 13, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.762 Vali Acc: 0.912 Test Loss: 0.762 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.54002022743225
Epoch: 14, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.736 Vali Acc: 0.933 Test Loss: 0.736 Test Acc: 0.933
Validation loss decreased (-0.926177 --> -0.933140).  Saving model ...
Epoch: 15 cost time: 24.71861457824707
Epoch: 15, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.906 Vali Acc: 0.911 Test Loss: 0.906 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 26.14900517463684
Epoch: 16, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.823 Vali Acc: 0.939 Test Loss: 0.823 Test Acc: 0.939
Validation loss decreased (-0.933140 --> -0.938710).  Saving model ...
Epoch: 17 cost time: 26.710152864456177
Epoch: 17, Steps: 89 | Train Loss: 0.358 Vali Loss: 1.164 Vali Acc: 0.896 Test Loss: 1.164 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.586169242858887
Epoch: 18, Steps: 89 | Train Loss: 0.347 Vali Loss: 1.058 Vali Acc: 0.916 Test Loss: 1.058 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.831587314605713
Epoch: 19, Steps: 89 | Train Loss: 0.316 Vali Loss: 1.041 Vali Acc: 0.919 Test Loss: 1.041 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 23.0718195438385
Epoch: 20, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.691 Vali Acc: 0.925 Test Loss: 0.691 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 24.68379306793213
Epoch: 21, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.847 Vali Acc: 0.924 Test Loss: 0.847 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 24.21054434776306
Epoch: 22, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.747 Vali Acc: 0.942 Test Loss: 0.747 Test Acc: 0.942
Validation loss decreased (-0.938710 --> -0.941497).  Saving model ...
Epoch: 23 cost time: 26.304506301879883
Epoch: 23, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.951 Vali Acc: 0.935 Test Loss: 0.951 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 26.29920220375061
Epoch: 24, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.598 Vali Acc: 0.948 Test Loss: 0.598 Test Acc: 0.948
Validation loss decreased (-0.941497 --> -0.948462).  Saving model ...
Epoch: 25 cost time: 24.449655771255493
Epoch: 25, Steps: 89 | Train Loss: 0.243 Vali Loss: 2.377 Vali Acc: 0.889 Test Loss: 2.377 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.527756214141846
Epoch: 26, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.664 Vali Acc: 0.924 Test Loss: 0.664 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 23.75076961517334
Epoch: 27, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.545 Vali Acc: 0.949 Test Loss: 0.545 Test Acc: 0.949
Validation loss decreased (-0.948462 --> -0.949159).  Saving model ...
Epoch: 28 cost time: 24.243103742599487
Epoch: 28, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.546 Vali Acc: 0.946 Test Loss: 0.546 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 24.031534671783447
Epoch: 29, Steps: 89 | Train Loss: 0.213 Vali Loss: 1.075 Vali Acc: 0.914 Test Loss: 1.075 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 26.61978554725647
Epoch: 30, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.902 Vali Acc: 0.926 Test Loss: 0.902 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 24.762678146362305
Epoch: 31, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.930 Vali Acc: 0.924 Test Loss: 0.930 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 25.478660821914673
Epoch: 32, Steps: 89 | Train Loss: 0.419 Vali Loss: 1.049 Vali Acc: 0.921 Test Loss: 1.049 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 27.22948956489563
Epoch: 33, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.996 Vali Acc: 0.928 Test Loss: 0.996 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 26.089649438858032
Epoch: 34, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.966 Vali Acc: 0.930 Test Loss: 0.966 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 26.579071283340454
Epoch: 35, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.912 Vali Acc: 0.930 Test Loss: 0.912 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 26.966432571411133
Epoch: 36, Steps: 89 | Train Loss: 0.227 Vali Loss: 1.487 Vali Acc: 0.918 Test Loss: 1.487 Test Acc: 0.918
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 25.013288736343384
Epoch: 37, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.923 Vali Acc: 0.914 Test Loss: 0.923 Test Acc: 0.914
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9491643454038997
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.11629891395569
Epoch: 1, Steps: 89 | Train Loss: 1.227 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
Validation loss decreased (inf --> -0.825899).  Saving model ...
Epoch: 2 cost time: 24.121217012405396
Epoch: 2, Steps: 89 | Train Loss: 0.476 Vali Loss: 0.480 Vali Acc: 0.875 Test Loss: 0.480 Test Acc: 0.875
Validation loss decreased (-0.825899 --> -0.875343).  Saving model ...
Epoch: 3 cost time: 24.28963017463684
Epoch: 3, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.421 Vali Acc: 0.912 Test Loss: 0.421 Test Acc: 0.912
Validation loss decreased (-0.875343 --> -0.912252).  Saving model ...
Epoch: 4 cost time: 25.376821756362915
Epoch: 4, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.429 Vali Acc: 0.905 Test Loss: 0.429 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.925719738006592
Epoch: 5, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.536 Vali Acc: 0.923 Test Loss: 0.536 Test Acc: 0.923
Validation loss decreased (-0.912252 --> -0.923393).  Saving model ...
Epoch: 6 cost time: 25.678913831710815
Epoch: 6, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.526 Vali Acc: 0.929 Test Loss: 0.526 Test Acc: 0.929
Validation loss decreased (-0.923393 --> -0.928964).  Saving model ...
Epoch: 7 cost time: 26.787967681884766
Epoch: 7, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.608 Vali Acc: 0.910 Test Loss: 0.608 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 26.00990390777588
Epoch: 8, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.748 Vali Acc: 0.921 Test Loss: 0.748 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 26.317659616470337
Epoch: 9, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.667 Vali Acc: 0.919 Test Loss: 0.667 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 26.47467303276062
Epoch: 10, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.764 Vali Acc: 0.916 Test Loss: 0.764 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 26.580036640167236
Epoch: 11, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.838 Vali Acc: 0.908 Test Loss: 0.838 Test Acc: 0.908
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 26.142228603363037
Epoch: 12, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.996 Vali Acc: 0.906 Test Loss: 0.996 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 24.217047691345215
Epoch: 13, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.849 Vali Acc: 0.915 Test Loss: 0.849 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 24.976824283599854
Epoch: 14, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.599 Vali Acc: 0.939 Test Loss: 0.599 Test Acc: 0.939
Validation loss decreased (-0.928964 --> -0.938713).  Saving model ...
Epoch: 15 cost time: 24.87329649925232
Epoch: 15, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.815 Vali Acc: 0.930 Test Loss: 0.815 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 25.906383991241455
Epoch: 16, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.724 Vali Acc: 0.937 Test Loss: 0.724 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 25.676040172576904
Epoch: 17, Steps: 89 | Train Loss: 0.235 Vali Loss: 1.046 Vali Acc: 0.909 Test Loss: 1.046 Test Acc: 0.909
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 25.785537481307983
Epoch: 18, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.769 Vali Acc: 0.932 Test Loss: 0.769 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 26.059685230255127
Epoch: 19, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.844 Vali Acc: 0.930 Test Loss: 0.844 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 24.159571409225464
Epoch: 20, Steps: 89 | Train Loss: 0.214 Vali Loss: 1.279 Vali Acc: 0.879 Test Loss: 1.279 Test Acc: 0.879
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 24.384084939956665
Epoch: 21, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.744 Vali Acc: 0.934 Test Loss: 0.744 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 23.865204095840454
Epoch: 22, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.779 Vali Acc: 0.938 Test Loss: 0.779 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 23.50390315055847
Epoch: 23, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.697 Vali Acc: 0.957 Test Loss: 0.697 Test Acc: 0.957
Validation loss decreased (-0.938713 --> -0.956818).  Saving model ...
Epoch: 24 cost time: 24.37314462661743
Epoch: 24, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.116 Vali Acc: 0.918 Test Loss: 1.116 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 25.173696517944336
Epoch: 25, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.861 Vali Acc: 0.943 Test Loss: 0.861 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 24.04417395591736
Epoch: 26, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.790 Vali Acc: 0.936 Test Loss: 0.790 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 22.28915786743164
Epoch: 27, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.993 Vali Acc: 0.926 Test Loss: 0.993 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 22.719637632369995
Epoch: 28, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.874 Vali Acc: 0.935 Test Loss: 0.874 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 22.87515115737915
Epoch: 29, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.695 Vali Acc: 0.946 Test Loss: 0.695 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 23.328168392181396
Epoch: 30, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.654 Vali Acc: 0.953 Test Loss: 0.654 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 25.112958192825317
Epoch: 31, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.659 Vali Acc: 0.930 Test Loss: 0.659 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 24.779555797576904
Epoch: 32, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.713 Vali Acc: 0.956 Test Loss: 0.713 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 24.451149940490723
Epoch: 33, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.737 Vali Acc: 0.950 Test Loss: 0.737 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.8060941696167
Epoch: 1, Steps: 89 | Train Loss: 1.451 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
Validation loss decreased (inf --> -0.821721).  Saving model ...
Epoch: 2 cost time: 24.578848838806152
Epoch: 2, Steps: 89 | Train Loss: 0.449 Vali Loss: 0.543 Vali Acc: 0.864 Test Loss: 0.543 Test Acc: 0.864
Validation loss decreased (-0.821721 --> -0.864201).  Saving model ...
Epoch: 3 cost time: 26.76315450668335
Epoch: 3, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.428 Vali Acc: 0.903 Test Loss: 0.428 Test Acc: 0.903
Validation loss decreased (-0.864201 --> -0.903199).  Saving model ...
Epoch: 4 cost time: 27.06934952735901
Epoch: 4, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.768 Vali Acc: 0.870 Test Loss: 0.768 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.924119472503662
Epoch: 5, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.388 Vali Acc: 0.928 Test Loss: 0.388 Test Acc: 0.928
Validation loss decreased (-0.903199 --> -0.928269).  Saving model ...
Epoch: 6 cost time: 25.88610005378723
Epoch: 6, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.77076244354248
Epoch: 7, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.787 Vali Acc: 0.907 Test Loss: 0.787 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.965240478515625
Epoch: 8, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.655 Vali Acc: 0.924 Test Loss: 0.655 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 26.141968965530396
Epoch: 9, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.892 Vali Acc: 0.897 Test Loss: 0.892 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.401211261749268
Epoch: 10, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.736 Vali Acc: 0.926 Test Loss: 0.736 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.44699239730835
Epoch: 11, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.745 Vali Acc: 0.921 Test Loss: 0.745 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.72583556175232
Epoch: 12, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.746 Vali Acc: 0.930 Test Loss: 0.746 Test Acc: 0.930
Validation loss decreased (-0.928269 --> -0.930355).  Saving model ...
Epoch: 13 cost time: 26.47028660774231
Epoch: 13, Steps: 89 | Train Loss: 0.230 Vali Loss: 1.035 Vali Acc: 0.910 Test Loss: 1.035 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 26.46460223197937
Epoch: 14, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.931 Vali Acc: 0.922 Test Loss: 0.931 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 25.484618425369263
Epoch: 15, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.843 Vali Acc: 0.919 Test Loss: 0.843 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 27.551970720291138
Epoch: 16, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.792 Vali Acc: 0.939 Test Loss: 0.792 Test Acc: 0.939
Validation loss decreased (-0.930355 --> -0.938711).  Saving model ...
Epoch: 17 cost time: 25.753207683563232
Epoch: 17, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.977 Vali Acc: 0.935 Test Loss: 0.977 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.846854209899902
Epoch: 18, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.817 Vali Acc: 0.935 Test Loss: 0.817 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 24.880388498306274
Epoch: 19, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.899 Vali Acc: 0.937 Test Loss: 0.899 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 23.11818528175354
Epoch: 20, Steps: 89 | Train Loss: 0.208 Vali Loss: 1.002 Vali Acc: 0.923 Test Loss: 1.002 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 22.668026208877563
Epoch: 21, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.709 Vali Acc: 0.955 Test Loss: 0.709 Test Acc: 0.955
Validation loss decreased (-0.938711 --> -0.955425).  Saving model ...
Epoch: 22 cost time: 24.604788541793823
Epoch: 22, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.828 Vali Acc: 0.939 Test Loss: 0.828 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 24.613284826278687
Epoch: 23, Steps: 89 | Train Loss: 0.198 Vali Loss: 1.129 Vali Acc: 0.928 Test Loss: 1.129 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 26.048059940338135
Epoch: 24, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.593 Vali Acc: 0.955 Test Loss: 0.593 Test Acc: 0.955
Validation loss decreased (-0.955425 --> -0.955426).  Saving model ...
Epoch: 25 cost time: 24.596949100494385
Epoch: 25, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.939 Vali Acc: 0.938 Test Loss: 0.939 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 25.00391459465027
Epoch: 26, Steps: 89 | Train Loss: 0.263 Vali Loss: 1.258 Vali Acc: 0.907 Test Loss: 1.258 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 24.902954578399658
Epoch: 27, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.840 Vali Acc: 0.939 Test Loss: 0.840 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 25.463767766952515
Epoch: 28, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.878 Vali Acc: 0.944 Test Loss: 0.878 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 26.135114908218384
Epoch: 29, Steps: 89 | Train Loss: 0.159 Vali Loss: 1.157 Vali Acc: 0.939 Test Loss: 1.157 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 26.356878757476807
Epoch: 30, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.844 Vali Acc: 0.945 Test Loss: 0.844 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 24.71787977218628
Epoch: 31, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.680 Vali Acc: 0.957 Test Loss: 0.680 Test Acc: 0.957
Validation loss decreased (-0.955426 --> -0.956818).  Saving model ...
Epoch: 32 cost time: 24.74412775039673
Epoch: 32, Steps: 89 | Train Loss: 0.106 Vali Loss: 1.085 Vali Acc: 0.932 Test Loss: 1.085 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 24.71880292892456
Epoch: 33, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.764 Vali Acc: 0.945 Test Loss: 0.764 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 24.347708225250244
Epoch: 34, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.850 Vali Acc: 0.944 Test Loss: 0.850 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 23.862786293029785
Epoch: 35, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.925 Vali Acc: 0.937 Test Loss: 0.925 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 25.20382308959961
Epoch: 36, Steps: 89 | Train Loss: 0.221 Vali Loss: 1.198 Vali Acc: 0.917 Test Loss: 1.198 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 25.8927059173584
Epoch: 37, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.915 Vali Acc: 0.934 Test Loss: 0.915 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 25.14537525177002
Epoch: 38, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.768 Vali Acc: 0.951 Test Loss: 0.768 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 25.402753353118896
Epoch: 39, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.754 Vali Acc: 0.951 Test Loss: 0.754 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 24.633708477020264
Epoch: 40, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.760 Vali Acc: 0.954 Test Loss: 0.760 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 24.642863750457764
Epoch: 41, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.108 Vali Acc: 0.919 Test Loss: 1.108 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.58889937400818
Epoch: 1, Steps: 89 | Train Loss: 1.822 Vali Loss: 0.881 Vali Acc: 0.745 Test Loss: 0.881 Test Acc: 0.745
Validation loss decreased (inf --> -0.745117).  Saving model ...
Epoch: 2 cost time: 26.61544442176819
Epoch: 2, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.512 Vali Acc: 0.873 Test Loss: 0.512 Test Acc: 0.873
Validation loss decreased (-0.745117 --> -0.873254).  Saving model ...
Epoch: 3 cost time: 25.148773670196533
Epoch: 3, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.361 Vali Acc: 0.921 Test Loss: 0.361 Test Acc: 0.921
Validation loss decreased (-0.873254 --> -0.920609).  Saving model ...
Epoch: 4 cost time: 25.104416847229004
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 1.168 Vali Acc: 0.838 Test Loss: 1.168 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.45719337463379
Epoch: 5, Steps: 89 | Train Loss: 0.305 Vali Loss: 1.054 Vali Acc: 0.834 Test Loss: 1.054 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.85528302192688
Epoch: 6, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.567 Vali Acc: 0.919 Test Loss: 0.567 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.879388570785522
Epoch: 7, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.482 Vali Acc: 0.932 Test Loss: 0.482 Test Acc: 0.932
Validation loss decreased (-0.920609 --> -0.931750).  Saving model ...
Epoch: 8 cost time: 26.289552450180054
Epoch: 8, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.507 Vali Acc: 0.934 Test Loss: 0.507 Test Acc: 0.934
Validation loss decreased (-0.931750 --> -0.933839).  Saving model ...
Epoch: 9 cost time: 26.33975386619568
Epoch: 9, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.659 Vali Acc: 0.905 Test Loss: 0.659 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.655611515045166
Epoch: 10, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.650 Vali Acc: 0.916 Test Loss: 0.650 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.597692489624023
Epoch: 11, Steps: 89 | Train Loss: 0.300 Vali Loss: 1.475 Vali Acc: 0.862 Test Loss: 1.475 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 25.578039407730103
Epoch: 12, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.899 Vali Acc: 0.918 Test Loss: 0.899 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 26.592235803604126
Epoch: 13, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.537 Vali Acc: 0.941 Test Loss: 0.537 Test Acc: 0.941
Validation loss decreased (-0.933839 --> -0.940802).  Saving model ...
Epoch: 14 cost time: 28.258095502853394
Epoch: 14, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.578 Vali Acc: 0.944 Test Loss: 0.578 Test Acc: 0.944
Validation loss decreased (-0.940802 --> -0.944284).  Saving model ...
Epoch: 15 cost time: 26.32132887840271
Epoch: 15, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.654 Vali Acc: 0.944 Test Loss: 0.654 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 24.083367824554443
Epoch: 16, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.679 Vali Acc: 0.936 Test Loss: 0.679 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.859389543533325
Epoch: 17, Steps: 89 | Train Loss: 0.341 Vali Loss: 1.125 Vali Acc: 0.901 Test Loss: 1.125 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 23.661526918411255
Epoch: 18, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.650 Vali Acc: 0.934 Test Loss: 0.650 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 24.793270349502563
Epoch: 19, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.614 Vali Acc: 0.944 Test Loss: 0.614 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 25.00405263900757
Epoch: 20, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.940 Vali Acc: 0.921 Test Loss: 0.940 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 24.438692331314087
Epoch: 21, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.430 Vali Acc: 0.956 Test Loss: 0.430 Test Acc: 0.956
Validation loss decreased (-0.944284 --> -0.956124).  Saving model ...
Epoch: 22 cost time: 24.286508798599243
Epoch: 22, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.767 Vali Acc: 0.936 Test Loss: 0.767 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 25.26778817176819
Epoch: 23, Steps: 89 | Train Loss: 0.257 Vali Loss: 1.024 Vali Acc: 0.934 Test Loss: 1.024 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 23.128598928451538
Epoch: 24, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.760 Vali Acc: 0.932 Test Loss: 0.760 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 23.227110624313354
Epoch: 25, Steps: 89 | Train Loss: 0.183 Vali Loss: 1.087 Vali Acc: 0.919 Test Loss: 1.087 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 24.707339763641357
Epoch: 26, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.577 Vali Acc: 0.952 Test Loss: 0.577 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 23.904683589935303
Epoch: 27, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.907 Vali Acc: 0.930 Test Loss: 0.907 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 23.383535146713257
Epoch: 28, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.829 Vali Acc: 0.928 Test Loss: 0.829 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 22.50300431251526
Epoch: 29, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.634 Vali Acc: 0.942 Test Loss: 0.634 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 23.023921966552734
Epoch: 30, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.693 Vali Acc: 0.938 Test Loss: 0.693 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 22.825228452682495
Epoch: 31, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.736 Vali Acc: 0.940 Test Loss: 0.736 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9561281337047354
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.771445751190186
Epoch: 1, Steps: 89 | Train Loss: 1.806 Vali Loss: 1.146 Vali Acc: 0.632 Test Loss: 1.146 Test Acc: 0.632
Validation loss decreased (inf --> -0.631604).  Saving model ...
Epoch: 2 cost time: 23.72985529899597
Epoch: 2, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.573 Vali Acc: 0.845 Test Loss: 0.573 Test Acc: 0.845
Validation loss decreased (-0.631604 --> -0.845398).  Saving model ...
Epoch: 3 cost time: 23.300525903701782
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.629 Vali Acc: 0.831 Test Loss: 0.629 Test Acc: 0.831
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.000073194503784
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 1.505 Vali Acc: 0.750 Test Loss: 1.505 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.66292452812195
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.971 Vali Acc: 0.813 Test Loss: 0.971 Test Acc: 0.813
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.127357959747314
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 1.071 Vali Acc: 0.831 Test Loss: 1.071 Test Acc: 0.831
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 24.51271104812622
Epoch: 7, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.587 Vali Acc: 0.893 Test Loss: 0.587 Test Acc: 0.893
Validation loss decreased (-0.845398 --> -0.892752).  Saving model ...
Epoch: 8 cost time: 25.66710329055786
Epoch: 8, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.921 Vali Acc: 0.839 Test Loss: 0.921 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.14731788635254
Epoch: 9, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.780 Vali Acc: 0.868 Test Loss: 0.780 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.21894907951355
Epoch: 10, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.708 Vali Acc: 0.893 Test Loss: 0.708 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 25.335325717926025
Epoch: 11, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.789 Vali Acc: 0.895 Test Loss: 0.789 Test Acc: 0.895
Validation loss decreased (-0.892752 --> -0.894839).  Saving model ...
Epoch: 12 cost time: 25.598374605178833
Epoch: 12, Steps: 89 | Train Loss: 0.254 Vali Loss: 2.113 Vali Acc: 0.776 Test Loss: 2.113 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 24.3216392993927
Epoch: 13, Steps: 89 | Train Loss: 0.220 Vali Loss: 1.706 Vali Acc: 0.830 Test Loss: 1.706 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.68498730659485
Epoch: 14, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.996 Vali Acc: 0.891 Test Loss: 0.996 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 24.452677011489868
Epoch: 15, Steps: 89 | Train Loss: 0.158 Vali Loss: 1.515 Vali Acc: 0.845 Test Loss: 1.515 Test Acc: 0.845
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 24.74672245979309
Epoch: 16, Steps: 89 | Train Loss: 0.385 Vali Loss: 0.934 Vali Acc: 0.896 Test Loss: 0.934 Test Acc: 0.896
Validation loss decreased (-0.894839 --> -0.896230).  Saving model ...
Epoch: 17 cost time: 25.020220041275024
Epoch: 17, Steps: 89 | Train Loss: 0.202 Vali Loss: 2.706 Vali Acc: 0.836 Test Loss: 2.706 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 24.658164978027344
Epoch: 18, Steps: 89 | Train Loss: 0.213 Vali Loss: 1.811 Vali Acc: 0.849 Test Loss: 1.811 Test Acc: 0.849
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.92743968963623
Epoch: 19, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.901 Vali Acc: 0.914 Test Loss: 0.901 Test Acc: 0.914
Validation loss decreased (-0.896230 --> -0.913640).  Saving model ...
Epoch: 20 cost time: 23.86251401901245
Epoch: 20, Steps: 89 | Train Loss: 0.255 Vali Loss: 1.778 Vali Acc: 0.907 Test Loss: 1.778 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 23.06661820411682
Epoch: 21, Steps: 89 | Train Loss: 0.232 Vali Loss: 1.048 Vali Acc: 0.923 Test Loss: 1.048 Test Acc: 0.923
Validation loss decreased (-0.913640 --> -0.923388).  Saving model ...
Epoch: 22 cost time: 23.904393672943115
Epoch: 22, Steps: 89 | Train Loss: 0.307 Vali Loss: 1.010 Vali Acc: 0.915 Test Loss: 1.010 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 24.490870714187622
Epoch: 23, Steps: 89 | Train Loss: 0.287 Vali Loss: 1.470 Vali Acc: 0.869 Test Loss: 1.470 Test Acc: 0.869
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 24.808125019073486
Epoch: 24, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.005 Vali Acc: 0.931 Test Loss: 1.005 Test Acc: 0.931
Validation loss decreased (-0.923388 --> -0.931048).  Saving model ...
Epoch: 25 cost time: 22.89760661125183
Epoch: 25, Steps: 89 | Train Loss: 0.193 Vali Loss: 1.743 Vali Acc: 0.887 Test Loss: 1.743 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.921643495559692
Epoch: 26, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.839 Vali Acc: 0.944 Test Loss: 0.839 Test Acc: 0.944
Validation loss decreased (-0.931048 --> -0.944281).  Saving model ...
Epoch: 27 cost time: 23.481530904769897
Epoch: 27, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.824 Vali Acc: 0.892 Test Loss: 1.824 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 23.131271600723267
Epoch: 28, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.963 Vali Acc: 0.936 Test Loss: 0.963 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 23.854604721069336
Epoch: 29, Steps: 89 | Train Loss: 0.123 Vali Loss: 1.044 Vali Acc: 0.928 Test Loss: 1.044 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 24.885223865509033
Epoch: 30, Steps: 89 | Train Loss: 0.227 Vali Loss: 1.084 Vali Acc: 0.918 Test Loss: 1.084 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 23.53872060775757
Epoch: 31, Steps: 89 | Train Loss: 0.336 Vali Loss: 1.593 Vali Acc: 0.907 Test Loss: 1.593 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 23.207720279693604
Epoch: 32, Steps: 89 | Train Loss: 0.177 Vali Loss: 2.311 Vali Acc: 0.898 Test Loss: 2.311 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 22.993570566177368
Epoch: 33, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.919 Vali Acc: 0.940 Test Loss: 0.919 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 23.377613306045532
Epoch: 34, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.929 Vali Acc: 0.945 Test Loss: 0.929 Test Acc: 0.945
Validation loss decreased (-0.944281 --> -0.944977).  Saving model ...
Epoch: 35 cost time: 22.80028510093689
Epoch: 35, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.722 Vali Acc: 0.893 Test Loss: 1.722 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 23.38936161994934
Epoch: 36, Steps: 89 | Train Loss: 0.288 Vali Loss: 1.390 Vali Acc: 0.923 Test Loss: 1.390 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 24.276779890060425
Epoch: 37, Steps: 89 | Train Loss: 0.222 Vali Loss: 1.073 Vali Acc: 0.950 Test Loss: 1.073 Test Acc: 0.950
Validation loss decreased (-0.944977 --> -0.949850).  Saving model ...
Epoch: 38 cost time: 24.649263381958008
Epoch: 38, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.850 Vali Acc: 0.946 Test Loss: 0.850 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 24.291931629180908
Epoch: 39, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.889 Vali Acc: 0.946 Test Loss: 0.889 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 23.537338972091675
Epoch: 40, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.952 Vali Acc: 0.931 Test Loss: 0.952 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 23.280874252319336
Epoch: 41, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.657 Vali Acc: 0.953 Test Loss: 0.657 Test Acc: 0.953
Validation loss decreased (-0.949850 --> -0.952640).  Saving model ...
Epoch: 42 cost time: 22.525429010391235
Epoch: 42, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.586 Vali Acc: 0.960 Test Loss: 0.586 Test Acc: 0.960
Validation loss decreased (-0.952640 --> -0.959604).  Saving model ...
Epoch: 43 cost time: 23.45064878463745
Epoch: 43, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.822 Vali Acc: 0.951 Test Loss: 0.822 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 24.349276781082153
Epoch: 44, Steps: 89 | Train Loss: 0.233 Vali Loss: 1.049 Vali Acc: 0.945 Test Loss: 1.049 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 24.523110389709473
Epoch: 45, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.720 Vali Acc: 0.958 Test Loss: 0.720 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 24.382960319519043
Epoch: 46, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.697 Vali Acc: 0.962 Test Loss: 0.697 Test Acc: 0.962
Validation loss decreased (-0.959604 --> -0.962389).  Saving model ...
Epoch: 47 cost time: 24.604788303375244
Epoch: 47, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.953 Vali Acc: 0.952 Test Loss: 0.953 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 24.610097646713257
Epoch: 48, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.802 Vali Acc: 0.944 Test Loss: 0.802 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 23.171857118606567
Epoch: 49, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.904 Vali Acc: 0.946 Test Loss: 0.904 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 23.47438669204712
Epoch: 50, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.852 Vali Acc: 0.946 Test Loss: 0.852 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 25.443424701690674
Epoch: 51, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.791 Vali Acc: 0.958 Test Loss: 0.791 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 24.500975370407104
Epoch: 52, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.884 Vali Acc: 0.954 Test Loss: 0.884 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 23.75544023513794
Epoch: 53, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.125 Vali Acc: 0.936 Test Loss: 1.125 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 22.578829765319824
Epoch: 54, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.449 Vali Acc: 0.969 Test Loss: 0.449 Test Acc: 0.969
Validation loss decreased (-0.962389 --> -0.968658).  Saving model ...
Epoch: 55 cost time: 22.293344020843506
Epoch: 55, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.593 Vali Acc: 0.954 Test Loss: 0.593 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 22.77056646347046
Epoch: 56, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.600 Vali Acc: 0.959 Test Loss: 0.600 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 22.503994703292847
Epoch: 57, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.653 Vali Acc: 0.958 Test Loss: 0.653 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 22.910130500793457
Epoch: 58, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.605 Vali Acc: 0.962 Test Loss: 0.605 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 25.17731785774231
Epoch: 59, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.767 Vali Acc: 0.958 Test Loss: 0.767 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 24.754652738571167
Epoch: 60, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.663 Vali Acc: 0.971 Test Loss: 0.663 Test Acc: 0.971
Validation loss decreased (-0.968658 --> -0.970745).  Saving model ...
Epoch: 61 cost time: 24.03109359741211
Epoch: 61, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.980 Vali Acc: 0.946 Test Loss: 0.980 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 23.602455615997314
Epoch: 62, Steps: 89 | Train Loss: 0.117 Vali Loss: 1.010 Vali Acc: 0.945 Test Loss: 1.010 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 23.607724905014038
Epoch: 63, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.720 Vali Acc: 0.958 Test Loss: 0.720 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 23.00562071800232
Epoch: 64, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.750 Vali Acc: 0.948 Test Loss: 0.750 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 24.114578008651733
Epoch: 65, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.527 Vali Acc: 0.967 Test Loss: 0.527 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 24.338377475738525
Epoch: 66, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.514 Vali Acc: 0.973 Test Loss: 0.514 Test Acc: 0.973
Validation loss decreased (-0.970745 --> -0.972836).  Saving model ...
Epoch: 67 cost time: 23.92113184928894
Epoch: 67, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.732 Vali Acc: 0.960 Test Loss: 0.732 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 23.518876791000366
Epoch: 68, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.579 Vali Acc: 0.971 Test Loss: 0.579 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 23.586421489715576
Epoch: 69, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.589 Vali Acc: 0.967 Test Loss: 0.589 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 23.903187036514282
Epoch: 70, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.508 Vali Acc: 0.967 Test Loss: 0.508 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 23.049948930740356
Epoch: 71, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.800 Vali Acc: 0.954 Test Loss: 0.800 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 23.574840784072876
Epoch: 72, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.729 Vali Acc: 0.957 Test Loss: 0.729 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 23.2526433467865
Epoch: 73, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.596 Vali Acc: 0.960 Test Loss: 0.596 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 25.415827751159668
Epoch: 74, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.702 Vali Acc: 0.959 Test Loss: 0.702 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 25.14304828643799
Epoch: 75, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.617 Vali Acc: 0.961 Test Loss: 0.617 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 25.30780816078186
Epoch: 76, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.571 Vali Acc: 0.964 Test Loss: 0.571 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.82411527633667
Epoch: 1, Steps: 89 | Train Loss: 1.746 Vali Loss: 0.942 Vali Acc: 0.733 Test Loss: 0.942 Test Acc: 0.733
Validation loss decreased (inf --> -0.733277).  Saving model ...
Epoch: 2 cost time: 24.150174617767334
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.642 Vali Acc: 0.820 Test Loss: 0.642 Test Acc: 0.820
Validation loss decreased (-0.733277 --> -0.820328).  Saving model ...
Epoch: 3 cost time: 24.544480323791504
Epoch: 3, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.871 Vali Acc: 0.785 Test Loss: 0.871 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.676748037338257
Epoch: 4, Steps: 89 | Train Loss: 0.196 Vali Loss: 1.089 Vali Acc: 0.802 Test Loss: 1.089 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.554388284683228
Epoch: 5, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.199 Vali Acc: 0.803 Test Loss: 1.199 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.596595287322998
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 1.030 Vali Acc: 0.805 Test Loss: 1.030 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.616156816482544
Epoch: 7, Steps: 89 | Train Loss: 0.172 Vali Loss: 1.322 Vali Acc: 0.824 Test Loss: 1.322 Test Acc: 0.824
Validation loss decreased (-0.820328 --> -0.823803).  Saving model ...
Epoch: 8 cost time: 24.301493644714355
Epoch: 8, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.896 Vali Acc: 0.855 Test Loss: 0.896 Test Acc: 0.855
Validation loss decreased (-0.823803 --> -0.855144).  Saving model ...
Epoch: 9 cost time: 23.35186743736267
Epoch: 9, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.739 Vali Acc: 0.881 Test Loss: 0.739 Test Acc: 0.881
Validation loss decreased (-0.855144 --> -0.880912).  Saving model ...
Epoch: 10 cost time: 23.536770343780518
Epoch: 10, Steps: 89 | Train Loss: 0.221 Vali Loss: 1.400 Vali Acc: 0.861 Test Loss: 1.400 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.41157364845276
Epoch: 11, Steps: 89 | Train Loss: 0.188 Vali Loss: 1.194 Vali Acc: 0.836 Test Loss: 1.194 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.711918592453003
Epoch: 12, Steps: 89 | Train Loss: 0.257 Vali Loss: 1.280 Vali Acc: 0.827 Test Loss: 1.280 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.779422760009766
Epoch: 13, Steps: 89 | Train Loss: 0.188 Vali Loss: 1.449 Vali Acc: 0.802 Test Loss: 1.449 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 24.590213298797607
Epoch: 14, Steps: 89 | Train Loss: 0.252 Vali Loss: 1.083 Vali Acc: 0.870 Test Loss: 1.083 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 23.981162309646606
Epoch: 15, Steps: 89 | Train Loss: 0.212 Vali Loss: 2.880 Vali Acc: 0.759 Test Loss: 2.880 Test Acc: 0.759
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 25.148375988006592
Epoch: 16, Steps: 89 | Train Loss: 0.277 Vali Loss: 1.137 Vali Acc: 0.883 Test Loss: 1.137 Test Acc: 0.883
Validation loss decreased (-0.880912 --> -0.882997).  Saving model ...
Epoch: 17 cost time: 25.173199892044067
Epoch: 17, Steps: 89 | Train Loss: 0.335 Vali Loss: 2.041 Vali Acc: 0.822 Test Loss: 2.041 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.00824546813965
Epoch: 18, Steps: 89 | Train Loss: 0.121 Vali Loss: 1.066 Vali Acc: 0.888 Test Loss: 1.066 Test Acc: 0.888
Validation loss decreased (-0.882997 --> -0.887872).  Saving model ...
Epoch: 19 cost time: 24.04902958869934
Epoch: 19, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.777 Vali Acc: 0.933 Test Loss: 0.777 Test Acc: 0.933
Validation loss decreased (-0.887872 --> -0.933140).  Saving model ...
Epoch: 20 cost time: 24.175509214401245
Epoch: 20, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.901 Vali Acc: 0.916 Test Loss: 0.901 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.189809560775757
Epoch: 21, Steps: 89 | Train Loss: 0.258 Vali Loss: 2.160 Vali Acc: 0.806 Test Loss: 2.160 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 24.184908390045166
Epoch: 22, Steps: 89 | Train Loss: 0.227 Vali Loss: 2.210 Vali Acc: 0.812 Test Loss: 2.210 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 25.832063674926758
Epoch: 23, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.695 Vali Acc: 0.873 Test Loss: 1.695 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 25.566237926483154
Epoch: 24, Steps: 89 | Train Loss: 0.325 Vali Loss: 1.299 Vali Acc: 0.903 Test Loss: 1.299 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 25.961093187332153
Epoch: 25, Steps: 89 | Train Loss: 0.268 Vali Loss: 1.537 Vali Acc: 0.883 Test Loss: 1.537 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 25.235426902770996
Epoch: 26, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.639 Vali Acc: 0.939 Test Loss: 0.639 Test Acc: 0.939
Validation loss decreased (-0.933140 --> -0.939409).  Saving model ...
Epoch: 27 cost time: 23.996213912963867
Epoch: 27, Steps: 89 | Train Loss: 0.262 Vali Loss: 1.214 Vali Acc: 0.909 Test Loss: 1.214 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 24.065854787826538
Epoch: 28, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.625 Vali Acc: 0.942 Test Loss: 0.625 Test Acc: 0.942
Validation loss decreased (-0.939409 --> -0.942194).  Saving model ...
Epoch: 29 cost time: 24.144715070724487
Epoch: 29, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.912 Vali Acc: 0.932 Test Loss: 0.912 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 24.8180570602417
Epoch: 30, Steps: 89 | Train Loss: 0.455 Vali Loss: 0.888 Vali Acc: 0.930 Test Loss: 0.888 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 26.373567819595337
Epoch: 31, Steps: 89 | Train Loss: 0.326 Vali Loss: 1.468 Vali Acc: 0.907 Test Loss: 1.468 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 25.811445474624634
Epoch: 32, Steps: 89 | Train Loss: 0.270 Vali Loss: 1.092 Vali Acc: 0.934 Test Loss: 1.092 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 23.08382773399353
Epoch: 33, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.773 Vali Acc: 0.948 Test Loss: 0.773 Test Acc: 0.948
Validation loss decreased (-0.942194 --> -0.948460).  Saving model ...
Epoch: 34 cost time: 22.510930061340332
Epoch: 34, Steps: 89 | Train Loss: 0.218 Vali Loss: 1.286 Vali Acc: 0.929 Test Loss: 1.286 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 23.59900212287903
Epoch: 35, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.726 Vali Acc: 0.944 Test Loss: 0.726 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 24.247665643692017
Epoch: 36, Steps: 89 | Train Loss: 0.361 Vali Loss: 1.250 Vali Acc: 0.921 Test Loss: 1.250 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 24.667617797851562
Epoch: 37, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.751 Vali Acc: 0.953 Test Loss: 0.751 Test Acc: 0.953
Validation loss decreased (-0.948460 --> -0.952639).  Saving model ...
Epoch: 38 cost time: 24.214519262313843
Epoch: 38, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.867 Vali Acc: 0.939 Test Loss: 0.867 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 23.875786542892456
Epoch: 39, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.885 Vali Acc: 0.944 Test Loss: 0.885 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 23.193461179733276
Epoch: 40, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.960 Vali Acc: 0.941 Test Loss: 0.960 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 23.334239721298218
Epoch: 41, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.614 Vali Acc: 0.961 Test Loss: 0.614 Test Acc: 0.961
Validation loss decreased (-0.952639 --> -0.960997).  Saving model ...
Epoch: 42 cost time: 24.069416522979736
Epoch: 42, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.670 Vali Acc: 0.952 Test Loss: 0.670 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 24.271628618240356
Epoch: 43, Steps: 89 | Train Loss: 0.135 Vali Loss: 1.184 Vali Acc: 0.932 Test Loss: 1.184 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 24.626255989074707
Epoch: 44, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.833 Vali Acc: 0.950 Test Loss: 0.833 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 24.091576099395752
Epoch: 45, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.810 Vali Acc: 0.939 Test Loss: 0.810 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 23.320326328277588
Epoch: 46, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.714 Vali Acc: 0.962 Test Loss: 0.714 Test Acc: 0.962
Validation loss decreased (-0.960997 --> -0.961692).  Saving model ...
Epoch: 47 cost time: 23.543466567993164
Epoch: 47, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.781 Vali Acc: 0.948 Test Loss: 0.781 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 23.03526282310486
Epoch: 48, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.803 Vali Acc: 0.953 Test Loss: 0.803 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 22.90167498588562
Epoch: 49, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.628 Vali Acc: 0.960 Test Loss: 0.628 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 23.525868892669678
Epoch: 50, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.770 Vali Acc: 0.951 Test Loss: 0.770 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 24.41624665260315
Epoch: 51, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.921 Vali Acc: 0.951 Test Loss: 0.921 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 24.636382341384888
Epoch: 52, Steps: 89 | Train Loss: 0.057 Vali Loss: 1.588 Vali Acc: 0.933 Test Loss: 1.588 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 23.15878701210022
Epoch: 53, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.714 Vali Acc: 0.958 Test Loss: 0.714 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 22.605635404586792
Epoch: 54, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.640 Vali Acc: 0.960 Test Loss: 0.640 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 23.826810836791992
Epoch: 55, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.651 Vali Acc: 0.962 Test Loss: 0.651 Test Acc: 0.962
Validation loss decreased (-0.961692 --> -0.962389).  Saving model ...
Epoch: 56 cost time: 22.64753246307373
Epoch: 56, Steps: 89 | Train Loss: 0.072 Vali Loss: 1.122 Vali Acc: 0.938 Test Loss: 1.122 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 23.940128087997437
Epoch: 57, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.660 Vali Acc: 0.948 Test Loss: 0.660 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 24.03440237045288
Epoch: 58, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.663 Vali Acc: 0.964 Test Loss: 0.663 Test Acc: 0.964
Validation loss decreased (-0.962389 --> -0.964478).  Saving model ...
Epoch: 59 cost time: 23.557684421539307
Epoch: 59, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.774 Vali Acc: 0.962 Test Loss: 0.774 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 23.115179538726807
Epoch: 60, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.689 Vali Acc: 0.967 Test Loss: 0.689 Test Acc: 0.967
Validation loss decreased (-0.964478 --> -0.966567).  Saving model ...
Epoch: 61 cost time: 23.32936406135559
Epoch: 61, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.912 Vali Acc: 0.951 Test Loss: 0.912 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 23.864948987960815
Epoch: 62, Steps: 89 | Train Loss: 0.126 Vali Loss: 1.216 Vali Acc: 0.935 Test Loss: 1.216 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 23.088681936264038
Epoch: 63, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.732 Vali Acc: 0.943 Test Loss: 0.732 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 24.832958936691284
Epoch: 64, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.924 Vali Acc: 0.947 Test Loss: 0.924 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 24.22207474708557
Epoch: 65, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.815 Vali Acc: 0.946 Test Loss: 0.815 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 23.46173644065857
Epoch: 66, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.841 Vali Acc: 0.951 Test Loss: 0.841 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 23.156343936920166
Epoch: 67, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.593 Vali Acc: 0.964 Test Loss: 0.593 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 22.4607675075531
Epoch: 68, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.452 Vali Acc: 0.971 Test Loss: 0.452 Test Acc: 0.971
Validation loss decreased (-0.966567 --> -0.970748).  Saving model ...
Epoch: 69 cost time: 23.256178379058838
Epoch: 69, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.914 Vali Acc: 0.939 Test Loss: 0.914 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 22.79813528060913
Epoch: 70, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.585 Vali Acc: 0.965 Test Loss: 0.585 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 24.425445079803467
Epoch: 71, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.611 Vali Acc: 0.962 Test Loss: 0.611 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 24.988226890563965
Epoch: 72, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.484 Vali Acc: 0.965 Test Loss: 0.484 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 25.1368989944458
Epoch: 73, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.636 Vali Acc: 0.960 Test Loss: 0.636 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 23.94572114944458
Epoch: 74, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.625 Vali Acc: 0.958 Test Loss: 0.625 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 23.74174737930298
Epoch: 75, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.855 Vali Acc: 0.944 Test Loss: 0.855 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 23.368348121643066
Epoch: 76, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.516 Vali Acc: 0.958 Test Loss: 0.516 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 23.27841567993164
Epoch: 77, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.720 Vali Acc: 0.966 Test Loss: 0.720 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 23.487263202667236
Epoch: 78, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.554 Vali Acc: 0.963 Test Loss: 0.554 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.075031757354736
Epoch: 1, Steps: 89 | Train Loss: 1.794 Vali Loss: 0.962 Vali Acc: 0.712 Test Loss: 0.962 Test Acc: 0.712
Validation loss decreased (inf --> -0.711690).  Saving model ...
Epoch: 2 cost time: 23.20583939552307
Epoch: 2, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.740 Vali Acc: 0.788 Test Loss: 0.740 Test Acc: 0.788
Validation loss decreased (-0.711690 --> -0.787597).  Saving model ...
Epoch: 3 cost time: 22.7806978225708
Epoch: 3, Steps: 89 | Train Loss: 0.229 Vali Loss: 1.257 Vali Acc: 0.754 Test Loss: 1.257 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.734346866607666
Epoch: 4, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.928 Vali Acc: 0.785 Test Loss: 0.928 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.369544982910156
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 1.936 Vali Acc: 0.749 Test Loss: 1.936 Test Acc: 0.749
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 23.820446968078613
Epoch: 6, Steps: 89 | Train Loss: 0.167 Vali Loss: 1.460 Vali Acc: 0.753 Test Loss: 1.460 Test Acc: 0.753
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 23.834528923034668
Epoch: 7, Steps: 89 | Train Loss: 0.163 Vali Loss: 1.260 Vali Acc: 0.822 Test Loss: 1.260 Test Acc: 0.822
Validation loss decreased (-0.787597 --> -0.821714).  Saving model ...
Epoch: 8 cost time: 24.53040361404419
Epoch: 8, Steps: 89 | Train Loss: 0.174 Vali Loss: 1.749 Vali Acc: 0.824 Test Loss: 1.749 Test Acc: 0.824
Validation loss decreased (-0.821714 --> -0.823799).  Saving model ...
Epoch: 9 cost time: 23.99728775024414
Epoch: 9, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.034 Vali Acc: 0.834 Test Loss: 1.034 Test Acc: 0.834
Validation loss decreased (-0.823799 --> -0.834251).  Saving model ...
Epoch: 10 cost time: 22.833915948867798
Epoch: 10, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.764 Vali Acc: 0.891 Test Loss: 0.764 Test Acc: 0.891
Validation loss decreased (-0.834251 --> -0.890661).  Saving model ...
Epoch: 11 cost time: 22.991698741912842
Epoch: 11, Steps: 89 | Train Loss: 0.220 Vali Loss: 2.292 Vali Acc: 0.758 Test Loss: 2.292 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.162123203277588
Epoch: 12, Steps: 89 | Train Loss: 0.172 Vali Loss: 1.389 Vali Acc: 0.809 Test Loss: 1.389 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.860255479812622
Epoch: 13, Steps: 89 | Train Loss: 0.180 Vali Loss: 1.791 Vali Acc: 0.799 Test Loss: 1.791 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 23.653135538101196
Epoch: 14, Steps: 89 | Train Loss: 0.253 Vali Loss: 1.125 Vali Acc: 0.884 Test Loss: 1.125 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.597835779190063
Epoch: 15, Steps: 89 | Train Loss: 0.335 Vali Loss: 1.934 Vali Acc: 0.845 Test Loss: 1.934 Test Acc: 0.845
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 25.135798454284668
Epoch: 16, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.423 Vali Acc: 0.840 Test Loss: 1.423 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 22.111058712005615
Epoch: 17, Steps: 89 | Train Loss: 0.155 Vali Loss: 1.412 Vali Acc: 0.873 Test Loss: 1.412 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 22.46869993209839
Epoch: 18, Steps: 89 | Train Loss: 0.211 Vali Loss: 2.070 Vali Acc: 0.841 Test Loss: 2.070 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 23.257691860198975
Epoch: 19, Steps: 89 | Train Loss: 0.197 Vali Loss: 1.314 Vali Acc: 0.889 Test Loss: 1.314 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 24.152465105056763
Epoch: 20, Steps: 89 | Train Loss: 0.454 Vali Loss: 1.801 Vali Acc: 0.853 Test Loss: 1.801 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.8906685236768802
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.38646125793457
Epoch: 1, Steps: 89 | Train Loss: 1.838 Vali Loss: 0.954 Vali Acc: 0.710 Test Loss: 0.954 Test Acc: 0.710
Validation loss decreased (inf --> -0.709600).  Saving model ...
Epoch: 2 cost time: 26.623756885528564
Epoch: 2, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.627 Vali Acc: 0.842 Test Loss: 0.627 Test Acc: 0.842
Validation loss decreased (-0.709600 --> -0.841916).  Saving model ...
Epoch: 3 cost time: 25.125049352645874
Epoch: 3, Steps: 89 | Train Loss: 0.240 Vali Loss: 1.208 Vali Acc: 0.758 Test Loss: 1.208 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.131178379058838
Epoch: 4, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.841916 --> -0.874644).  Saving model ...
Epoch: 5 cost time: 25.203708171844482
Epoch: 5, Steps: 89 | Train Loss: 0.145 Vali Loss: 1.007 Vali Acc: 0.836 Test Loss: 1.007 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.656243324279785
Epoch: 6, Steps: 89 | Train Loss: 0.154 Vali Loss: 1.013 Vali Acc: 0.835 Test Loss: 1.013 Test Acc: 0.835
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.266036987304688
Epoch: 7, Steps: 89 | Train Loss: 0.189 Vali Loss: 1.612 Vali Acc: 0.822 Test Loss: 1.612 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.254823207855225
Epoch: 8, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.153 Vali Acc: 0.842 Test Loss: 1.153 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 24.45079755783081
Epoch: 9, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.681 Vali Acc: 0.888 Test Loss: 0.681 Test Acc: 0.888
Validation loss decreased (-0.874644 --> -0.887876).  Saving model ...
Epoch: 10 cost time: 24.068101406097412
Epoch: 10, Steps: 89 | Train Loss: 0.193 Vali Loss: 1.301 Vali Acc: 0.859 Test Loss: 1.301 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.48913049697876
Epoch: 11, Steps: 89 | Train Loss: 0.217 Vali Loss: 1.151 Vali Acc: 0.858 Test Loss: 1.151 Test Acc: 0.858
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.73414945602417
Epoch: 12, Steps: 89 | Train Loss: 0.256 Vali Loss: 1.889 Vali Acc: 0.792 Test Loss: 1.889 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.77457880973816
Epoch: 13, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.975 Vali Acc: 0.908 Test Loss: 0.975 Test Acc: 0.908
Validation loss decreased (-0.887876 --> -0.908068).  Saving model ...
Epoch: 14 cost time: 24.523857831954956
Epoch: 14, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.847 Vali Acc: 0.902 Test Loss: 0.847 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.66459560394287
Epoch: 15, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.054 Vali Acc: 0.862 Test Loss: 1.054 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.919748783111572
Epoch: 16, Steps: 89 | Train Loss: 0.280 Vali Loss: 1.207 Vali Acc: 0.873 Test Loss: 1.207 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 25.04071831703186
Epoch: 17, Steps: 89 | Train Loss: 0.292 Vali Loss: 1.579 Vali Acc: 0.870 Test Loss: 1.579 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.220763206481934
Epoch: 18, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.742 Vali Acc: 0.942 Test Loss: 0.742 Test Acc: 0.942
Validation loss decreased (-0.908068 --> -0.942193).  Saving model ...
Epoch: 19 cost time: 25.79966950416565
Epoch: 19, Steps: 89 | Train Loss: 0.326 Vali Loss: 1.418 Vali Acc: 0.866 Test Loss: 1.418 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 24.28080701828003
Epoch: 20, Steps: 89 | Train Loss: 0.338 Vali Loss: 1.116 Vali Acc: 0.903 Test Loss: 1.116 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.680317640304565
Epoch: 21, Steps: 89 | Train Loss: 0.314 Vali Loss: 0.893 Vali Acc: 0.914 Test Loss: 0.893 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 25.49421525001526
Epoch: 22, Steps: 89 | Train Loss: 0.180 Vali Loss: 1.022 Vali Acc: 0.919 Test Loss: 1.022 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 26.10708785057068
Epoch: 23, Steps: 89 | Train Loss: 0.200 Vali Loss: 1.031 Vali Acc: 0.919 Test Loss: 1.031 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 24.996960639953613
Epoch: 24, Steps: 89 | Train Loss: 0.364 Vali Loss: 1.887 Vali Acc: 0.894 Test Loss: 1.887 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 23.695436716079712
Epoch: 25, Steps: 89 | Train Loss: 0.320 Vali Loss: 3.016 Vali Acc: 0.862 Test Loss: 3.016 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 23.711490869522095
Epoch: 26, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.963 Vali Acc: 0.930 Test Loss: 0.963 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 23.10041046142578
Epoch: 27, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.846 Vali Acc: 0.940 Test Loss: 0.846 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 25.29376220703125
Epoch: 28, Steps: 89 | Train Loss: 0.324 Vali Loss: 1.099 Vali Acc: 0.904 Test Loss: 1.099 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.942200557103064
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.677281379699707
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (inf --> -0.059859).  Saving model ...
Epoch: 2 cost time: 22.568310260772705
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.059859 --> -0.059859).  Saving model ...
Epoch: 3 cost time: 21.8153293132782
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.059859 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 22.367107629776
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 22.607080221176147
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 23.288965225219727
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 23.33229422569275
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 23.882530450820923
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 21.85613489151001
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 22.793496131896973
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 24.548245429992676
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 23.87560534477234
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 23.11405920982361
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 21.664535522460938
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 23.63652467727661
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 23.304144144058228
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 25.16300940513611
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 25.912965774536133
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 23.631601095199585
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 22.85653519630432
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 22.131912231445312
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 23.901261806488037
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 24.725637435913086
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 23.327807903289795
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 21.53404402732849
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 22.820536136627197
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 21.884870529174805
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 23.57364797592163
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 24.247815132141113
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 21.656890392303467
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 21.71511220932007
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 21.694895267486572
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 23.120225191116333
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 24.903383255004883
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.66210103034973
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 22.635293006896973
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 22.87329339981079
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 21.88919711112976
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 23.809725999832153
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 25.45477271080017
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 23.754281282424927
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 23.178662300109863
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 22.768664836883545
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 23.163485765457153
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 22.8700532913208
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 22.379987955093384
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 22.930296182632446
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 22.952375888824463
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 23.862321853637695
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 23.892683506011963
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 22.453905820846558
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 22.406737327575684
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 22.42944598197937
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 54 cost time: 23.615138292312622
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 23.679662704467773
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 22.64651346206665
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 22.329379320144653
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 58 cost time: 22.42159938812256
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 22.866019248962402
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 22.62817883491516
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 61 cost time: 25.18096375465393
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 24.32768440246582
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 23.433252334594727
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 22.530797958374023
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 23.774855613708496
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 25.116432189941406
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 25.225523471832275
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 24.621490478515625
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 24.34591579437256
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 23.315423488616943
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 4354580
model size : 26.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.611446380615234
Epoch: 1, Steps: 89 | Train Loss: 1.108 Vali Loss: 0.410 Vali Acc: 0.879 Test Loss: 0.410 Test Acc: 0.879
Validation loss decreased (inf --> -0.878826).  Saving model ...
Epoch: 2 cost time: 25.777454137802124
Epoch: 2, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.329 Vali Acc: 0.918 Test Loss: 0.329 Test Acc: 0.918
Validation loss decreased (-0.878826 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 24.336822032928467
Epoch: 3, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.582 Vali Acc: 0.885 Test Loss: 0.582 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.044044733047485
Epoch: 4, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.917824 --> -0.924787).  Saving model ...
Epoch: 5 cost time: 22.518667221069336
Epoch: 5, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.470 Vali Acc: 0.914 Test Loss: 0.470 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.949033498764038
Epoch: 6, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.496 Vali Acc: 0.933 Test Loss: 0.496 Test Acc: 0.933
Validation loss decreased (-0.924787 --> -0.933143).  Saving model ...
Epoch: 7 cost time: 24.982694625854492
Epoch: 7, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.821 Vali Acc: 0.900 Test Loss: 0.821 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.321413040161133
Epoch: 8, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.718 Vali Acc: 0.922 Test Loss: 0.718 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.92185640335083
Epoch: 9, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.549 Vali Acc: 0.920 Test Loss: 0.549 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.906858205795288
Epoch: 10, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.934 Vali Acc: 0.905 Test Loss: 0.934 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.06813621520996
Epoch: 11, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.502 Vali Acc: 0.948 Test Loss: 0.502 Test Acc: 0.948
Validation loss decreased (-0.933143 --> -0.947767).  Saving model ...
Epoch: 12 cost time: 25.006726264953613
Epoch: 12, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.801 Vali Acc: 0.921 Test Loss: 0.801 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.121224403381348
Epoch: 13, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.604 Vali Acc: 0.945 Test Loss: 0.604 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.94387674331665
Epoch: 14, Steps: 89 | Train Loss: 0.261 Vali Loss: 1.644 Vali Acc: 0.886 Test Loss: 1.644 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 21.204277276992798
Epoch: 15, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.587 Vali Acc: 0.950 Test Loss: 0.587 Test Acc: 0.950
Validation loss decreased (-0.947767 --> -0.949855).  Saving model ...
Epoch: 16 cost time: 22.6031334400177
Epoch: 16, Steps: 89 | Train Loss: 0.109 Vali Loss: 1.078 Vali Acc: 0.914 Test Loss: 1.078 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.068763732910156
Epoch: 17, Steps: 89 | Train Loss: 0.367 Vali Loss: 1.009 Vali Acc: 0.926 Test Loss: 1.009 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.069796323776245
Epoch: 18, Steps: 89 | Train Loss: 0.343 Vali Loss: 1.138 Vali Acc: 0.934 Test Loss: 1.138 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 26.114640712738037
Epoch: 19, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.767 Vali Acc: 0.939 Test Loss: 0.767 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 22.96158456802368
Epoch: 20, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.955 Vali Acc: 0.930 Test Loss: 0.955 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 22.28062152862549
Epoch: 21, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.946 Vali Acc: 0.942 Test Loss: 0.946 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.64148998260498
Epoch: 22, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.832 Vali Acc: 0.955 Test Loss: 0.832 Test Acc: 0.955
Validation loss decreased (-0.949855 --> -0.955423).  Saving model ...
Epoch: 23 cost time: 25.416659832000732
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.608 Vali Acc: 0.963 Test Loss: 0.608 Test Acc: 0.963
Validation loss decreased (-0.955423 --> -0.963086).  Saving model ...
Epoch: 24 cost time: 27.33872961997986
Epoch: 24, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.711 Vali Acc: 0.955 Test Loss: 0.711 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 25.341801404953003
Epoch: 25, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.723 Vali Acc: 0.961 Test Loss: 0.723 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 23.970248699188232
Epoch: 26, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.589 Vali Acc: 0.894 Test Loss: 1.589 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 22.520073175430298
Epoch: 27, Steps: 89 | Train Loss: 0.385 Vali Loss: 1.202 Vali Acc: 0.927 Test Loss: 1.202 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 24.240867614746094
Epoch: 28, Steps: 89 | Train Loss: 0.147 Vali Loss: 1.070 Vali Acc: 0.928 Test Loss: 1.070 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 24.78341007232666
Epoch: 29, Steps: 89 | Train Loss: 0.198 Vali Loss: 1.223 Vali Acc: 0.928 Test Loss: 1.223 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 24.363510370254517
Epoch: 30, Steps: 89 | Train Loss: 0.377 Vali Loss: 1.265 Vali Acc: 0.930 Test Loss: 1.265 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 22.669042110443115
Epoch: 31, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.907 Vali Acc: 0.944 Test Loss: 0.907 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 22.185262441635132
Epoch: 32, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.716 Vali Acc: 0.948 Test Loss: 0.716 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 22.728068828582764
Epoch: 33, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.840 Vali Acc: 0.943 Test Loss: 0.840 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.756787300109863
Epoch: 1, Steps: 89 | Train Loss: 1.168 Vali Loss: 0.489 Vali Acc: 0.866 Test Loss: 0.489 Test Acc: 0.866
Validation loss decreased (inf --> -0.866290).  Saving model ...
Epoch: 2 cost time: 25.254472255706787
Epoch: 2, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.366 Vali Acc: 0.903 Test Loss: 0.366 Test Acc: 0.903
Validation loss decreased (-0.866290 --> -0.902503).  Saving model ...
Epoch: 3 cost time: 23.79432225227356
Epoch: 3, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.855 Vali Acc: 0.855 Test Loss: 0.855 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.629127264022827
Epoch: 4, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.764 Vali Acc: 0.873 Test Loss: 0.764 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.293678522109985
Epoch: 5, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.470 Vali Acc: 0.930 Test Loss: 0.470 Test Acc: 0.930
Validation loss decreased (-0.902503 --> -0.929661).  Saving model ...
Epoch: 6 cost time: 22.381441593170166
Epoch: 6, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.463 Vali Acc: 0.922 Test Loss: 0.463 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.779342889785767
Epoch: 7, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.538 Vali Acc: 0.918 Test Loss: 0.538 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.30157446861267
Epoch: 8, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.494 Vali Acc: 0.935 Test Loss: 0.494 Test Acc: 0.935
Validation loss decreased (-0.929661 --> -0.935232).  Saving model ...
Epoch: 9 cost time: 24.313258171081543
Epoch: 9, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.567 Vali Acc: 0.925 Test Loss: 0.567 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.22122836112976
Epoch: 10, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.505 Vali Acc: 0.955 Test Loss: 0.505 Test Acc: 0.955
Validation loss decreased (-0.935232 --> -0.954730).  Saving model ...
Epoch: 11 cost time: 23.963458776474
Epoch: 11, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.842 Vali Acc: 0.916 Test Loss: 0.842 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.087791442871094
Epoch: 12, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.962 Vali Acc: 0.900 Test Loss: 0.962 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.81215262413025
Epoch: 13, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.528 Vali Acc: 0.951 Test Loss: 0.528 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 25.223347663879395
Epoch: 14, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.704 Vali Acc: 0.937 Test Loss: 0.704 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.24310302734375
Epoch: 15, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.543 Vali Acc: 0.944 Test Loss: 0.543 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 22.916269063949585
Epoch: 16, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.680 Vali Acc: 0.941 Test Loss: 0.680 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 22.893712759017944
Epoch: 17, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.608 Vali Acc: 0.944 Test Loss: 0.608 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 23.209322452545166
Epoch: 18, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.874 Vali Acc: 0.935 Test Loss: 0.874 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 22.66858172416687
Epoch: 19, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.768 Vali Acc: 0.939 Test Loss: 0.768 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 22.304601669311523
Epoch: 20, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.885 Vali Acc: 0.930 Test Loss: 0.885 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9547353760445683
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.706228017807007
Epoch: 1, Steps: 89 | Train Loss: 1.236 Vali Loss: 0.593 Vali Acc: 0.847 Test Loss: 0.593 Test Acc: 0.847
Validation loss decreased (inf --> -0.846791).  Saving model ...
Epoch: 2 cost time: 23.802807092666626
Epoch: 2, Steps: 89 | Train Loss: 0.457 Vali Loss: 0.582 Vali Acc: 0.859 Test Loss: 0.582 Test Acc: 0.859
Validation loss decreased (-0.846791 --> -0.858629).  Saving model ...
Epoch: 3 cost time: 24.421568155288696
Epoch: 3, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.516 Vali Acc: 0.888 Test Loss: 0.516 Test Acc: 0.888
Validation loss decreased (-0.858629 --> -0.887878).  Saving model ...
Epoch: 4 cost time: 22.998711585998535
Epoch: 4, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.409 Vali Acc: 0.916 Test Loss: 0.409 Test Acc: 0.916
Validation loss decreased (-0.887878 --> -0.916430).  Saving model ...
Epoch: 5 cost time: 22.54162836074829
Epoch: 5, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.513 Vali Acc: 0.896 Test Loss: 0.513 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.213080644607544
Epoch: 6, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.627 Vali Acc: 0.908 Test Loss: 0.627 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.49211049079895
Epoch: 7, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.510 Vali Acc: 0.928 Test Loss: 0.510 Test Acc: 0.928
Validation loss decreased (-0.916430 --> -0.928268).  Saving model ...
Epoch: 8 cost time: 23.913953065872192
Epoch: 8, Steps: 89 | Train Loss: 0.265 Vali Loss: 1.169 Vali Acc: 0.895 Test Loss: 1.169 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.41792893409729
Epoch: 9, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.599 Vali Acc: 0.919 Test Loss: 0.599 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.520897150039673
Epoch: 10, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.609 Vali Acc: 0.940 Test Loss: 0.609 Test Acc: 0.940
Validation loss decreased (-0.928268 --> -0.940105).  Saving model ...
Epoch: 11 cost time: 24.114304065704346
Epoch: 11, Steps: 89 | Train Loss: 0.313 Vali Loss: 1.925 Vali Acc: 0.849 Test Loss: 1.925 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.02080988883972
Epoch: 12, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.859 Vali Acc: 0.921 Test Loss: 0.859 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 24.048783540725708
Epoch: 13, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.644 Vali Acc: 0.948 Test Loss: 0.644 Test Acc: 0.948
Validation loss decreased (-0.940105 --> -0.948462).  Saving model ...
Epoch: 14 cost time: 23.782718420028687
Epoch: 14, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.711 Vali Acc: 0.944 Test Loss: 0.711 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.35911989212036
Epoch: 15, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.570 Vali Acc: 0.951 Test Loss: 0.570 Test Acc: 0.951
Validation loss decreased (-0.948462 --> -0.950551).  Saving model ...
Epoch: 16 cost time: 22.86755108833313
Epoch: 16, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.628 Vali Acc: 0.951 Test Loss: 0.628 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.865408420562744
Epoch: 17, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.629 Vali Acc: 0.948 Test Loss: 0.629 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.063574075698853
Epoch: 18, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.656 Vali Acc: 0.953 Test Loss: 0.656 Test Acc: 0.953
Validation loss decreased (-0.950551 --> -0.952640).  Saving model ...
Epoch: 19 cost time: 24.457961559295654
Epoch: 19, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.911 Vali Acc: 0.931 Test Loss: 0.911 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.15242886543274
Epoch: 20, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.747 Vali Acc: 0.941 Test Loss: 0.747 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.80810809135437
Epoch: 21, Steps: 89 | Train Loss: 0.125 Vali Loss: 1.013 Vali Acc: 0.936 Test Loss: 1.013 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 20.72710371017456
Epoch: 22, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.661 Vali Acc: 0.947 Test Loss: 0.661 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 23.13504695892334
Epoch: 23, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.703 Vali Acc: 0.949 Test Loss: 0.703 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 23.583659172058105
Epoch: 24, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.904 Vali Acc: 0.924 Test Loss: 0.904 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 23.069559574127197
Epoch: 25, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.973 Vali Acc: 0.928 Test Loss: 0.973 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 23.71903419494629
Epoch: 26, Steps: 89 | Train Loss: 0.334 Vali Loss: 1.105 Vali Acc: 0.933 Test Loss: 1.105 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 23.77013897895813
Epoch: 27, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.677 Vali Acc: 0.955 Test Loss: 0.677 Test Acc: 0.955
Validation loss decreased (-0.952640 --> -0.954729).  Saving model ...
Epoch: 28 cost time: 23.128981113433838
Epoch: 28, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.860 Vali Acc: 0.950 Test Loss: 0.860 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 24.251941919326782
Epoch: 29, Steps: 89 | Train Loss: 0.153 Vali Loss: 1.153 Vali Acc: 0.925 Test Loss: 1.153 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 24.829339504241943
Epoch: 30, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.831 Vali Acc: 0.948 Test Loss: 0.831 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 23.42224407196045
Epoch: 31, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.811 Vali Acc: 0.952 Test Loss: 0.811 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 23.47891664505005
Epoch: 32, Steps: 89 | Train Loss: 0.183 Vali Loss: 1.026 Vali Acc: 0.938 Test Loss: 1.026 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 23.954772472381592
Epoch: 33, Steps: 89 | Train Loss: 0.199 Vali Loss: 1.667 Vali Acc: 0.929 Test Loss: 1.667 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 24.12976574897766
Epoch: 34, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.747 Vali Acc: 0.962 Test Loss: 0.747 Test Acc: 0.962
Validation loss decreased (-0.954729 --> -0.962388).  Saving model ...
Epoch: 35 cost time: 24.833213806152344
Epoch: 35, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.731 Vali Acc: 0.954 Test Loss: 0.731 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 24.84077763557434
Epoch: 36, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.742 Vali Acc: 0.953 Test Loss: 0.742 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 22.580592155456543
Epoch: 37, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.745 Vali Acc: 0.955 Test Loss: 0.745 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 24.18386673927307
Epoch: 38, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.886 Vali Acc: 0.946 Test Loss: 0.886 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 23.547041654586792
Epoch: 39, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.738 Vali Acc: 0.948 Test Loss: 0.738 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 25.51122736930847
Epoch: 40, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.784 Vali Acc: 0.953 Test Loss: 0.784 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 25.311496257781982
Epoch: 41, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.803 Vali Acc: 0.951 Test Loss: 0.803 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 25.727744340896606
Epoch: 42, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.661 Vali Acc: 0.960 Test Loss: 0.661 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 22.64273691177368
Epoch: 43, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.929 Vali Acc: 0.945 Test Loss: 0.929 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 22.82925844192505
Epoch: 44, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.984 Vali Acc: 0.946 Test Loss: 0.984 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.963524341583252
Epoch: 1, Steps: 89 | Train Loss: 1.420 Vali Loss: 0.637 Vali Acc: 0.825 Test Loss: 0.637 Test Acc: 0.825
Validation loss decreased (inf --> -0.824506).  Saving model ...
Epoch: 2 cost time: 23.297542810440063
Epoch: 2, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
Validation loss decreased (-0.824506 --> -0.838434).  Saving model ...
Epoch: 3 cost time: 24.03255534172058
Epoch: 3, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.595 Vali Acc: 0.883 Test Loss: 0.595 Test Acc: 0.883
Validation loss decreased (-0.838434 --> -0.883002).  Saving model ...
Epoch: 4 cost time: 23.088433265686035
Epoch: 4, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.384 Vali Acc: 0.924 Test Loss: 0.384 Test Acc: 0.924
Validation loss decreased (-0.883002 --> -0.924091).  Saving model ...
Epoch: 5 cost time: 23.23549485206604
Epoch: 5, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.874 Vali Acc: 0.884 Test Loss: 0.874 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.945362091064453
Epoch: 6, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.375 Vali Acc: 0.935 Test Loss: 0.375 Test Acc: 0.935
Validation loss decreased (-0.924091 --> -0.935233).  Saving model ...
Epoch: 7 cost time: 23.5449640750885
Epoch: 7, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.536 Vali Acc: 0.908 Test Loss: 0.536 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.93691658973694
Epoch: 8, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.844 Vali Acc: 0.907 Test Loss: 0.844 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.761471033096313
Epoch: 9, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.442 Vali Acc: 0.945 Test Loss: 0.442 Test Acc: 0.945
Validation loss decreased (-0.935233 --> -0.944982).  Saving model ...
Epoch: 10 cost time: 25.269379138946533
Epoch: 10, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.640 Vali Acc: 0.925 Test Loss: 0.640 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.263598680496216
Epoch: 11, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.556 Vali Acc: 0.935 Test Loss: 0.556 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.49686861038208
Epoch: 12, Steps: 89 | Train Loss: 0.252 Vali Loss: 1.256 Vali Acc: 0.894 Test Loss: 1.256 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.896687030792236
Epoch: 13, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.895 Vali Acc: 0.907 Test Loss: 0.895 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 25.830897331237793
Epoch: 14, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.730 Vali Acc: 0.939 Test Loss: 0.730 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 25.29762864112854
Epoch: 15, Steps: 89 | Train Loss: 0.360 Vali Loss: 1.037 Vali Acc: 0.924 Test Loss: 1.037 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 24.98489475250244
Epoch: 16, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.985 Vali Acc: 0.912 Test Loss: 0.985 Test Acc: 0.912
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 24.098787784576416
Epoch: 17, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.717 Vali Acc: 0.947 Test Loss: 0.717 Test Acc: 0.947
Validation loss decreased (-0.944982 --> -0.947068).  Saving model ...
Epoch: 18 cost time: 23.12826657295227
Epoch: 18, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.765 Vali Acc: 0.944 Test Loss: 0.765 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 24.25997281074524
Epoch: 19, Steps: 89 | Train Loss: 0.130 Vali Loss: 1.451 Vali Acc: 0.900 Test Loss: 1.451 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 25.44136691093445
Epoch: 20, Steps: 89 | Train Loss: 0.267 Vali Loss: 1.034 Vali Acc: 0.924 Test Loss: 1.034 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.176557540893555
Epoch: 21, Steps: 89 | Train Loss: 0.242 Vali Loss: 1.416 Vali Acc: 0.914 Test Loss: 1.416 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 24.10150647163391
Epoch: 22, Steps: 89 | Train Loss: 0.217 Vali Loss: 1.011 Vali Acc: 0.925 Test Loss: 1.011 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 23.884324073791504
Epoch: 23, Steps: 89 | Train Loss: 0.179 Vali Loss: 1.015 Vali Acc: 0.938 Test Loss: 1.015 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 24.718069076538086
Epoch: 24, Steps: 89 | Train Loss: 0.260 Vali Loss: 1.155 Vali Acc: 0.929 Test Loss: 1.155 Test Acc: 0.929
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 24.899394273757935
Epoch: 25, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.940 Vali Acc: 0.956 Test Loss: 0.940 Test Acc: 0.956
Validation loss decreased (-0.947068 --> -0.956119).  Saving model ...
Epoch: 26 cost time: 25.01526975631714
Epoch: 26, Steps: 89 | Train Loss: 0.188 Vali Loss: 1.149 Vali Acc: 0.940 Test Loss: 1.149 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 23.551841259002686
Epoch: 27, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.757 Vali Acc: 0.960 Test Loss: 0.757 Test Acc: 0.960
Validation loss decreased (-0.956119 --> -0.959602).  Saving model ...
Epoch: 28 cost time: 22.66093111038208
Epoch: 28, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.844 Vali Acc: 0.952 Test Loss: 0.844 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 22.594290733337402
Epoch: 29, Steps: 89 | Train Loss: 0.146 Vali Loss: 1.113 Vali Acc: 0.934 Test Loss: 1.113 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 23.998154878616333
Epoch: 30, Steps: 89 | Train Loss: 0.276 Vali Loss: 1.016 Vali Acc: 0.937 Test Loss: 1.016 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 25.775140285491943
Epoch: 31, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.718 Vali Acc: 0.950 Test Loss: 0.718 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 25.007947206497192
Epoch: 32, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.914 Vali Acc: 0.939 Test Loss: 0.914 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 22.9677631855011
Epoch: 33, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.960 Vali Acc: 0.944 Test Loss: 0.960 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 21.71772789955139
Epoch: 34, Steps: 89 | Train Loss: 0.097 Vali Loss: 1.346 Vali Acc: 0.930 Test Loss: 1.346 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 23.75727868080139
Epoch: 35, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.713 Vali Acc: 0.962 Test Loss: 0.713 Test Acc: 0.962
Validation loss decreased (-0.959602 --> -0.961692).  Saving model ...
Epoch: 36 cost time: 24.307467937469482
Epoch: 36, Steps: 89 | Train Loss: 0.147 Vali Loss: 1.319 Vali Acc: 0.916 Test Loss: 1.319 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 25.550624132156372
Epoch: 37, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.860 Vali Acc: 0.960 Test Loss: 0.860 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 26.17933940887451
Epoch: 38, Steps: 89 | Train Loss: 0.387 Vali Loss: 1.604 Vali Acc: 0.906 Test Loss: 1.604 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 24.24885869026184
Epoch: 39, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.788 Vali Acc: 0.952 Test Loss: 0.788 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 24.262778282165527
Epoch: 40, Steps: 89 | Train Loss: 0.291 Vali Loss: 1.651 Vali Acc: 0.907 Test Loss: 1.651 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 26.335516691207886
Epoch: 41, Steps: 89 | Train Loss: 0.460 Vali Loss: 0.832 Vali Acc: 0.947 Test Loss: 0.832 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 25.149619102478027
Epoch: 42, Steps: 89 | Train Loss: 0.126 Vali Loss: 1.110 Vali Acc: 0.938 Test Loss: 1.110 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 24.24290418624878
Epoch: 43, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.878 Vali Acc: 0.948 Test Loss: 0.878 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 23.979292631149292
Epoch: 44, Steps: 89 | Train Loss: 0.157 Vali Loss: 1.353 Vali Acc: 0.930 Test Loss: 1.353 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 27.26419472694397
Epoch: 45, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.745 Vali Acc: 0.960 Test Loss: 0.745 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.642964363098145
Epoch: 1, Steps: 89 | Train Loss: 1.808 Vali Loss: 1.009 Vali Acc: 0.690 Test Loss: 1.009 Test Acc: 0.690
Validation loss decreased (inf --> -0.690101).  Saving model ...
Epoch: 2 cost time: 22.425793409347534
Epoch: 2, Steps: 89 | Train Loss: 0.511 Vali Loss: 0.561 Vali Acc: 0.847 Test Loss: 0.561 Test Acc: 0.847
Validation loss decreased (-0.690101 --> -0.847487).  Saving model ...
Epoch: 3 cost time: 25.284578561782837
Epoch: 3, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.580 Vali Acc: 0.860 Test Loss: 0.580 Test Acc: 0.860
Validation loss decreased (-0.847487 --> -0.860022).  Saving model ...
Epoch: 4 cost time: 25.13837242126465
Epoch: 4, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.357 Vali Acc: 0.921 Test Loss: 0.357 Test Acc: 0.921
Validation loss decreased (-0.860022 --> -0.920609).  Saving model ...
Epoch: 5 cost time: 24.538578987121582
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.516 Vali Acc: 0.907 Test Loss: 0.516 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.61866784095764
Epoch: 6, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.628 Vali Acc: 0.881 Test Loss: 0.628 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.83041214942932
Epoch: 7, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.794 Vali Acc: 0.870 Test Loss: 0.794 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.69063377380371
Epoch: 8, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.551 Vali Acc: 0.923 Test Loss: 0.551 Test Acc: 0.923
Validation loss decreased (-0.920609 --> -0.923393).  Saving model ...
Epoch: 9 cost time: 26.12537980079651
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.655 Vali Acc: 0.907 Test Loss: 0.655 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.685868978500366
Epoch: 10, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.516 Vali Acc: 0.943 Test Loss: 0.516 Test Acc: 0.943
Validation loss decreased (-0.923393 --> -0.942892).  Saving model ...
Epoch: 11 cost time: 25.20345711708069
Epoch: 11, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.700 Vali Acc: 0.910 Test Loss: 0.700 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.69456124305725
Epoch: 12, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.786 Vali Acc: 0.922 Test Loss: 0.786 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 24.35275363922119
Epoch: 13, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.598 Vali Acc: 0.939 Test Loss: 0.598 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 25.135032415390015
Epoch: 14, Steps: 89 | Train Loss: 0.224 Vali Loss: 1.208 Vali Acc: 0.903 Test Loss: 1.208 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 27.034647226333618
Epoch: 15, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.690 Vali Acc: 0.949 Test Loss: 0.690 Test Acc: 0.949
Validation loss decreased (-0.942892 --> -0.949157).  Saving model ...
Epoch: 16 cost time: 25.528714895248413
Epoch: 16, Steps: 89 | Train Loss: 0.189 Vali Loss: 1.174 Vali Acc: 0.898 Test Loss: 1.174 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.37704825401306
Epoch: 17, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.941 Vali Acc: 0.914 Test Loss: 0.941 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.358033418655396
Epoch: 18, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.774 Vali Acc: 0.923 Test Loss: 0.774 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 26.401606559753418
Epoch: 19, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.639 Vali Acc: 0.962 Test Loss: 0.639 Test Acc: 0.962
Validation loss decreased (-0.949157 --> -0.961693).  Saving model ...
Epoch: 20 cost time: 24.6325466632843
Epoch: 20, Steps: 89 | Train Loss: 0.199 Vali Loss: 1.145 Vali Acc: 0.908 Test Loss: 1.145 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 23.96060037612915
Epoch: 21, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.761 Vali Acc: 0.943 Test Loss: 0.761 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.39349937438965
Epoch: 22, Steps: 89 | Train Loss: 0.247 Vali Loss: 1.293 Vali Acc: 0.891 Test Loss: 1.293 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 26.681793451309204
Epoch: 23, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.948 Vali Acc: 0.919 Test Loss: 0.948 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 26.410993576049805
Epoch: 24, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.792 Vali Acc: 0.941 Test Loss: 0.792 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 25.192283391952515
Epoch: 25, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.938 Vali Acc: 0.940 Test Loss: 0.938 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.68916964530945
Epoch: 26, Steps: 89 | Train Loss: 0.325 Vali Loss: 1.253 Vali Acc: 0.909 Test Loss: 1.253 Test Acc: 0.909
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 23.422995805740356
Epoch: 27, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.720 Vali Acc: 0.955 Test Loss: 0.720 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.28456735610962
Epoch: 28, Steps: 89 | Train Loss: 0.306 Vali Loss: 1.607 Vali Acc: 0.912 Test Loss: 1.607 Test Acc: 0.912
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 21.476762771606445
Epoch: 29, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.957 Vali Acc: 0.936 Test Loss: 0.957 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.724843502044678
Epoch: 1, Steps: 89 | Train Loss: 1.792 Vali Loss: 1.198 Vali Acc: 0.627 Test Loss: 1.198 Test Acc: 0.627
Validation loss decreased (inf --> -0.626729).  Saving model ...
Epoch: 2 cost time: 26.120319843292236
Epoch: 2, Steps: 89 | Train Loss: 0.471 Vali Loss: 0.517 Vali Acc: 0.843 Test Loss: 0.517 Test Acc: 0.843
Validation loss decreased (-0.626729 --> -0.843310).  Saving model ...
Epoch: 3 cost time: 24.923518419265747
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.584 Vali Acc: 0.851 Test Loss: 0.584 Test Acc: 0.851
Validation loss decreased (-0.843310 --> -0.850969).  Saving model ...
Epoch: 4 cost time: 27.911431789398193
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.865 Vali Acc: 0.826 Test Loss: 0.865 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.765112161636353
Epoch: 5, Steps: 89 | Train Loss: 0.186 Vali Loss: 1.049 Vali Acc: 0.742 Test Loss: 1.049 Test Acc: 0.742
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.95235323905945
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.990 Vali Acc: 0.847 Test Loss: 0.990 Test Acc: 0.847
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.433712005615234
Epoch: 7, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.805 Vali Acc: 0.846 Test Loss: 0.805 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.786348342895508
Epoch: 8, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.703 Vali Acc: 0.882 Test Loss: 0.703 Test Acc: 0.882
Validation loss decreased (-0.850969 --> -0.881609).  Saving model ...
Epoch: 9 cost time: 26.433010816574097
Epoch: 9, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.814 Vali Acc: 0.887 Test Loss: 0.814 Test Acc: 0.887
Validation loss decreased (-0.881609 --> -0.887178).  Saving model ...
Epoch: 10 cost time: 25.00750207901001
Epoch: 10, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.560 Vali Acc: 0.916 Test Loss: 0.560 Test Acc: 0.916
Validation loss decreased (-0.887178 --> -0.916429).  Saving model ...
Epoch: 11 cost time: 25.1357364654541
Epoch: 11, Steps: 89 | Train Loss: 0.183 Vali Loss: 1.043 Vali Acc: 0.903 Test Loss: 1.043 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.587042808532715
Epoch: 12, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.674 Vali Acc: 0.912 Test Loss: 0.674 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.063934326171875
Epoch: 13, Steps: 89 | Train Loss: 0.169 Vali Loss: 1.499 Vali Acc: 0.838 Test Loss: 1.499 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 23.903536081314087
Epoch: 14, Steps: 89 | Train Loss: 0.240 Vali Loss: 1.580 Vali Acc: 0.833 Test Loss: 1.580 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 24.90897297859192
Epoch: 15, Steps: 89 | Train Loss: 0.305 Vali Loss: 2.050 Vali Acc: 0.863 Test Loss: 2.050 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 24.150357961654663
Epoch: 16, Steps: 89 | Train Loss: 0.370 Vali Loss: 1.150 Vali Acc: 0.907 Test Loss: 1.150 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 23.488380670547485
Epoch: 17, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.782 Vali Acc: 0.926 Test Loss: 0.782 Test Acc: 0.926
Validation loss decreased (-0.916429 --> -0.926176).  Saving model ...
Epoch: 18 cost time: 23.489081382751465
Epoch: 18, Steps: 89 | Train Loss: 0.177 Vali Loss: 2.218 Vali Acc: 0.854 Test Loss: 2.218 Test Acc: 0.854
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 25.317293167114258
Epoch: 19, Steps: 89 | Train Loss: 0.224 Vali Loss: 1.225 Vali Acc: 0.889 Test Loss: 1.225 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 25.240171670913696
Epoch: 20, Steps: 89 | Train Loss: 0.106 Vali Loss: 1.282 Vali Acc: 0.896 Test Loss: 1.282 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 24.320454597473145
Epoch: 21, Steps: 89 | Train Loss: 0.274 Vali Loss: 2.348 Vali Acc: 0.861 Test Loss: 2.348 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 25.088179111480713
Epoch: 22, Steps: 89 | Train Loss: 0.293 Vali Loss: 1.341 Vali Acc: 0.891 Test Loss: 1.341 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 25.518514394760132
Epoch: 23, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.767 Vali Acc: 0.936 Test Loss: 0.767 Test Acc: 0.936
Validation loss decreased (-0.926176 --> -0.935925).  Saving model ...
Epoch: 24 cost time: 23.34695529937744
Epoch: 24, Steps: 89 | Train Loss: 0.150 Vali Loss: 1.624 Vali Acc: 0.884 Test Loss: 1.624 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 24.070043563842773
Epoch: 25, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.131 Vali Acc: 0.922 Test Loss: 1.131 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 25.516202211380005
Epoch: 26, Steps: 89 | Train Loss: 0.286 Vali Loss: 1.004 Vali Acc: 0.919 Test Loss: 1.004 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 25.31143617630005
Epoch: 27, Steps: 89 | Train Loss: 0.176 Vali Loss: 1.107 Vali Acc: 0.930 Test Loss: 1.107 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 24.654638528823853
Epoch: 28, Steps: 89 | Train Loss: 0.126 Vali Loss: 1.197 Vali Acc: 0.915 Test Loss: 1.197 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 23.32969355583191
Epoch: 29, Steps: 89 | Train Loss: 0.233 Vali Loss: 2.105 Vali Acc: 0.907 Test Loss: 2.105 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 26.769129753112793
Epoch: 30, Steps: 89 | Train Loss: 0.187 Vali Loss: 2.234 Vali Acc: 0.847 Test Loss: 2.234 Test Acc: 0.847
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 27.083415269851685
Epoch: 31, Steps: 89 | Train Loss: 0.182 Vali Loss: 1.154 Vali Acc: 0.911 Test Loss: 1.154 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 24.165093898773193
Epoch: 32, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.872 Vali Acc: 0.936 Test Loss: 0.872 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 24.54063367843628
Epoch: 33, Steps: 89 | Train Loss: 0.155 Vali Loss: 1.077 Vali Acc: 0.923 Test Loss: 1.077 Test Acc: 0.923
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.935933147632312
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.524885416030884
Epoch: 1, Steps: 89 | Train Loss: 1.743 Vali Loss: 1.027 Vali Acc: 0.716 Test Loss: 1.027 Test Acc: 0.716
Validation loss decreased (inf --> -0.715867).  Saving model ...
Epoch: 2 cost time: 24.17549991607666
Epoch: 2, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.536 Vali Acc: 0.831 Test Loss: 0.536 Test Acc: 0.831
Validation loss decreased (-0.715867 --> -0.830775).  Saving model ...
Epoch: 3 cost time: 26.729465007781982
Epoch: 3, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.664 Vali Acc: 0.870 Test Loss: 0.664 Test Acc: 0.870
Validation loss decreased (-0.830775 --> -0.869771).  Saving model ...
Epoch: 4 cost time: 24.947743892669678
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.720 Vali Acc: 0.827 Test Loss: 0.720 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.616785526275635
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 1.317 Vali Acc: 0.746 Test Loss: 1.317 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.89491367340088
Epoch: 6, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.962 Vali Acc: 0.818 Test Loss: 0.962 Test Acc: 0.818
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.893446683883667
Epoch: 7, Steps: 89 | Train Loss: 0.180 Vali Loss: 1.408 Vali Acc: 0.785 Test Loss: 1.408 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.388946771621704
Epoch: 8, Steps: 89 | Train Loss: 0.207 Vali Loss: 1.524 Vali Acc: 0.720 Test Loss: 1.524 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 24.399053812026978
Epoch: 9, Steps: 89 | Train Loss: 0.157 Vali Loss: 1.626 Vali Acc: 0.804 Test Loss: 1.626 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 23.554394960403442
Epoch: 10, Steps: 89 | Train Loss: 0.188 Vali Loss: 2.216 Vali Acc: 0.726 Test Loss: 2.216 Test Acc: 0.726
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.63975954055786
Epoch: 11, Steps: 89 | Train Loss: 0.225 Vali Loss: 2.386 Vali Acc: 0.753 Test Loss: 2.386 Test Acc: 0.753
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 22.590735912322998
Epoch: 12, Steps: 89 | Train Loss: 0.180 Vali Loss: 2.809 Vali Acc: 0.778 Test Loss: 2.809 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.993983507156372
Epoch: 13, Steps: 89 | Train Loss: 0.222 Vali Loss: 1.357 Vali Acc: 0.839 Test Loss: 1.357 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.8697771587743732
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.161155462265015
Epoch: 1, Steps: 89 | Train Loss: 1.766 Vali Loss: 1.310 Vali Acc: 0.633 Test Loss: 1.310 Test Acc: 0.633
Validation loss decreased (inf --> -0.632995).  Saving model ...
Epoch: 2 cost time: 24.761695861816406
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.705 Vali Acc: 0.802 Test Loss: 0.705 Test Acc: 0.802
Validation loss decreased (-0.632995 --> -0.801525).  Saving model ...
Epoch: 3 cost time: 21.873457431793213
Epoch: 3, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.818 Vali Acc: 0.834 Test Loss: 0.818 Test Acc: 0.834
Validation loss decreased (-0.801525 --> -0.833557).  Saving model ...
Epoch: 4 cost time: 22.873188495635986
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.958 Vali Acc: 0.812 Test Loss: 0.958 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.279873371124268
Epoch: 5, Steps: 89 | Train Loss: 0.181 Vali Loss: 1.086 Vali Acc: 0.766 Test Loss: 1.086 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.17557454109192
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 1.990 Vali Acc: 0.743 Test Loss: 1.990 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 25.587971687316895
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 1.580 Vali Acc: 0.811 Test Loss: 1.580 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.962990045547485
Epoch: 8, Steps: 89 | Train Loss: 0.188 Vali Loss: 1.382 Vali Acc: 0.811 Test Loss: 1.382 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.245226860046387
Epoch: 9, Steps: 89 | Train Loss: 0.181 Vali Loss: 1.284 Vali Acc: 0.818 Test Loss: 1.284 Test Acc: 0.818
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.076722860336304
Epoch: 10, Steps: 89 | Train Loss: 0.217 Vali Loss: 1.554 Vali Acc: 0.814 Test Loss: 1.554 Test Acc: 0.814
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 23.200642585754395
Epoch: 11, Steps: 89 | Train Loss: 0.246 Vali Loss: 1.667 Vali Acc: 0.855 Test Loss: 1.667 Test Acc: 0.855
Validation loss decreased (-0.833557 --> -0.855137).  Saving model ...
Epoch: 12 cost time: 24.14373803138733
Epoch: 12, Steps: 89 | Train Loss: 0.138 Vali Loss: 1.869 Vali Acc: 0.805 Test Loss: 1.869 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.515974044799805
Epoch: 13, Steps: 89 | Train Loss: 0.174 Vali Loss: 1.592 Vali Acc: 0.831 Test Loss: 1.592 Test Acc: 0.831
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.094858407974243
Epoch: 14, Steps: 89 | Train Loss: 0.358 Vali Loss: 2.162 Vali Acc: 0.819 Test Loss: 2.162 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.780535221099854
Epoch: 15, Steps: 89 | Train Loss: 0.241 Vali Loss: 1.870 Vali Acc: 0.842 Test Loss: 1.870 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.750959873199463
Epoch: 16, Steps: 89 | Train Loss: 0.119 Vali Loss: 1.245 Vali Acc: 0.877 Test Loss: 1.245 Test Acc: 0.877
Validation loss decreased (-0.855137 --> -0.876728).  Saving model ...
Epoch: 17 cost time: 23.55182123184204
Epoch: 17, Steps: 89 | Train Loss: 0.185 Vali Loss: 1.955 Vali Acc: 0.847 Test Loss: 1.955 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 24.852614879608154
Epoch: 18, Steps: 89 | Train Loss: 0.198 Vali Loss: 1.233 Vali Acc: 0.893 Test Loss: 1.233 Test Acc: 0.893
Validation loss decreased (-0.876728 --> -0.892745).  Saving model ...
Epoch: 19 cost time: 25.33463144302368
Epoch: 19, Steps: 89 | Train Loss: 0.170 Vali Loss: 1.277 Vali Acc: 0.880 Test Loss: 1.277 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 26.093192100524902
Epoch: 20, Steps: 89 | Train Loss: 0.284 Vali Loss: 2.072 Vali Acc: 0.838 Test Loss: 2.072 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.996891975402832
Epoch: 21, Steps: 89 | Train Loss: 0.303 Vali Loss: 1.149 Vali Acc: 0.914 Test Loss: 1.149 Test Acc: 0.914
Validation loss decreased (-0.892745 --> -0.914334).  Saving model ...
Epoch: 22 cost time: 23.439904928207397
Epoch: 22, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.755 Vali Acc: 0.926 Test Loss: 0.755 Test Acc: 0.926
Validation loss decreased (-0.914334 --> -0.926176).  Saving model ...
Epoch: 23 cost time: 24.44779872894287
Epoch: 23, Steps: 89 | Train Loss: 0.359 Vali Loss: 1.603 Vali Acc: 0.886 Test Loss: 1.603 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 23.20105218887329
Epoch: 24, Steps: 89 | Train Loss: 0.432 Vali Loss: 1.186 Vali Acc: 0.896 Test Loss: 1.186 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 25.44792127609253
Epoch: 25, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.920 Vali Acc: 0.923 Test Loss: 0.920 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 26.19266152381897
Epoch: 26, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.932 Vali Acc: 0.935 Test Loss: 0.932 Test Acc: 0.935
Validation loss decreased (-0.926176 --> -0.935227).  Saving model ...
Epoch: 27 cost time: 25.86380434036255
Epoch: 27, Steps: 89 | Train Loss: 0.175 Vali Loss: 1.524 Vali Acc: 0.900 Test Loss: 1.524 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 25.274341821670532
Epoch: 28, Steps: 89 | Train Loss: 0.296 Vali Loss: 1.731 Vali Acc: 0.903 Test Loss: 1.731 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 23.70163607597351
Epoch: 29, Steps: 89 | Train Loss: 0.193 Vali Loss: 1.092 Vali Acc: 0.921 Test Loss: 1.092 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 23.369783878326416
Epoch: 30, Steps: 89 | Train Loss: 0.364 Vali Loss: 1.399 Vali Acc: 0.912 Test Loss: 1.399 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 24.647447109222412
Epoch: 31, Steps: 89 | Train Loss: 0.330 Vali Loss: 0.992 Vali Acc: 0.924 Test Loss: 0.992 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 25.787317276000977
Epoch: 32, Steps: 89 | Train Loss: 0.268 Vali Loss: 1.441 Vali Acc: 0.907 Test Loss: 1.441 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 25.243524312973022
Epoch: 33, Steps: 89 | Train Loss: 0.313 Vali Loss: 1.302 Vali Acc: 0.911 Test Loss: 1.302 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 23.82784080505371
Epoch: 34, Steps: 89 | Train Loss: 0.225 Vali Loss: 1.803 Vali Acc: 0.898 Test Loss: 1.803 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 23.696356296539307
Epoch: 35, Steps: 89 | Train Loss: 0.358 Vali Loss: 1.195 Vali Acc: 0.920 Test Loss: 1.195 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 22.857316970825195
Epoch: 36, Steps: 89 | Train Loss: 0.244 Vali Loss: 1.183 Vali Acc: 0.926 Test Loss: 1.183 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9352367688022284
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.13928198814392
Epoch: 1, Steps: 89 | Train Loss: 1.818 Vali Loss: 1.270 Vali Acc: 0.649 Test Loss: 1.270 Test Acc: 0.649
Validation loss decreased (inf --> -0.649012).  Saving model ...
Epoch: 2 cost time: 25.898800373077393
Epoch: 2, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.590 Vali Acc: 0.831 Test Loss: 0.590 Test Acc: 0.831
Validation loss decreased (-0.649012 --> -0.831470).  Saving model ...
Epoch: 3 cost time: 22.980114936828613
Epoch: 3, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.998 Vali Acc: 0.832 Test Loss: 0.998 Test Acc: 0.832
Validation loss decreased (-0.831470 --> -0.832163).  Saving model ...
Epoch: 4 cost time: 22.69489550590515
Epoch: 4, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.694 Vali Acc: 0.851 Test Loss: 0.694 Test Acc: 0.851
Validation loss decreased (-0.832163 --> -0.850968).  Saving model ...
Epoch: 5 cost time: 22.97526979446411
Epoch: 5, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.897 Vali Acc: 0.825 Test Loss: 0.897 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.286493062973022
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.837 Vali Acc: 0.827 Test Loss: 0.837 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 25.769241333007812
Epoch: 7, Steps: 89 | Train Loss: 0.160 Vali Loss: 1.183 Vali Acc: 0.827 Test Loss: 1.183 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 26.743134260177612
Epoch: 8, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.621 Vali Acc: 0.891 Test Loss: 0.621 Test Acc: 0.891
Validation loss decreased (-0.850968 --> -0.890662).  Saving model ...
Epoch: 9 cost time: 24.777791500091553
Epoch: 9, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.578 Vali Acc: 0.909 Test Loss: 0.578 Test Acc: 0.909
Validation loss decreased (-0.890662 --> -0.908769).  Saving model ...
Epoch: 10 cost time: 23.2915096282959
Epoch: 10, Steps: 89 | Train Loss: 0.317 Vali Loss: 1.051 Vali Acc: 0.848 Test Loss: 1.051 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.302334308624268
Epoch: 11, Steps: 89 | Train Loss: 0.226 Vali Loss: 1.330 Vali Acc: 0.841 Test Loss: 1.330 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 26.231987237930298
Epoch: 12, Steps: 89 | Train Loss: 0.197 Vali Loss: 1.729 Vali Acc: 0.833 Test Loss: 1.729 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.68854832649231
Epoch: 13, Steps: 89 | Train Loss: 0.258 Vali Loss: 1.610 Vali Acc: 0.828 Test Loss: 1.610 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 24.94351577758789
Epoch: 14, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.747 Vali Acc: 0.870 Test Loss: 1.747 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 22.861245155334473
Epoch: 15, Steps: 89 | Train Loss: 0.260 Vali Loss: 1.573 Vali Acc: 0.868 Test Loss: 1.573 Test Acc: 0.868
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 22.946075916290283
Epoch: 16, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.858 Vali Acc: 0.903 Test Loss: 0.858 Test Acc: 0.903
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 24.74742293357849
Epoch: 17, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.999 Vali Acc: 0.893 Test Loss: 0.999 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 25.588064908981323
Epoch: 18, Steps: 89 | Train Loss: 0.182 Vali Loss: 1.751 Vali Acc: 0.847 Test Loss: 1.751 Test Acc: 0.847
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 24.530639171600342
Epoch: 19, Steps: 89 | Train Loss: 0.230 Vali Loss: 1.993 Vali Acc: 0.816 Test Loss: 1.993 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.908774373259053
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.99895405769348
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.061 Test Loss: 2.996 Test Acc: 0.061
Validation loss decreased (inf --> -0.060555).  Saving model ...
Epoch: 2 cost time: 23.179176092147827
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 3 cost time: 23.44511651992798
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 4 cost time: 25.00921940803528
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.061 Test Loss: 2.994 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 5 cost time: 25.445101737976074
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.060555 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 25.71251082420349
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 23.878371953964233
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 23.333423376083374
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 24.83175826072693
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 23.38219904899597
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 23.780672788619995
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 23.346709966659546
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 21.77715754508972
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 22.649657487869263
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 22.2762508392334
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 24.827971935272217
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 23.02386212348938
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 25.390785694122314
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 24.323458433151245
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 24.651883602142334
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 24.990789890289307
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 25.373856782913208
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 23.999380350112915
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 25.067548513412476
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 22.902560234069824
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 24.44025707244873
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 23.364747524261475
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 23.97150468826294
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 25.37495470046997
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 24.09774351119995
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 22.709519147872925
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 22.32153558731079
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 23.406180381774902
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 23.547789812088013
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.406951665878296
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 24.19539451599121
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 22.767231702804565
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 23.021995782852173
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 24.942555904388428
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 26.13002038002014
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 25.602104425430298
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 23.396268367767334
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 23.562907218933105
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 23.51238703727722
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 25.423706769943237
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 25.596757650375366
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 25.583271265029907
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 24.356308698654175
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 24.494207859039307
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 27.008521556854248
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 26.276142120361328
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 24.317280054092407
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 23.155540704727173
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 54 cost time: 23.591370344161987
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 55 cost time: 24.525580883026123
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 25.388668060302734
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 24.825610160827637
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 58 cost time: 23.10026717185974
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 23.006385564804077
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 24.52391481399536
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 61 cost time: 26.014010190963745
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 22.556652545928955
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 24.610002040863037
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 22.5485258102417
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 23.40595507621765
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 66 cost time: 23.57818841934204
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 25.98932456970215
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 68 cost time: 25.01510238647461
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 23.167685508728027
Epoch: 69, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 24.650559663772583
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 25.262834548950195
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 24.786406755447388
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 23.726437091827393
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 22.76439332962036
Epoch: 74, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 23.0407452583313
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 23.448854446411133
Epoch: 76, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 24.115473747253418
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 3961364
model size : 24.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.030659675598145
Epoch: 1, Steps: 89 | Train Loss: 1.080 Vali Loss: 0.525 Vali Acc: 0.866 Test Loss: 0.525 Test Acc: 0.866
Validation loss decreased (inf --> -0.865594).  Saving model ...
Epoch: 2 cost time: 22.50078558921814
Epoch: 2, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.574 Vali Acc: 0.857 Test Loss: 0.574 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.627367734909058
Epoch: 3, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.383 Vali Acc: 0.916 Test Loss: 0.383 Test Acc: 0.916
Validation loss decreased (-0.865594 --> -0.915734).  Saving model ...
Epoch: 4 cost time: 24.867615222930908
Epoch: 4, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.775 Vali Acc: 0.891 Test Loss: 0.775 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.003149271011353
Epoch: 5, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.475 Vali Acc: 0.923 Test Loss: 0.475 Test Acc: 0.923
Validation loss decreased (-0.915734 --> -0.923394).  Saving model ...
Epoch: 6 cost time: 23.314287424087524
Epoch: 6, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.991 Vali Acc: 0.880 Test Loss: 0.991 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.997244358062744
Epoch: 7, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.428 Vali Acc: 0.946 Test Loss: 0.428 Test Acc: 0.946
Validation loss decreased (-0.923394 --> -0.946375).  Saving model ...
Epoch: 8 cost time: 25.679223775863647
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.476 Vali Acc: 0.943 Test Loss: 0.476 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.59421181678772
Epoch: 9, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.637 Vali Acc: 0.928 Test Loss: 0.637 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.30990242958069
Epoch: 10, Steps: 89 | Train Loss: 0.241 Vali Loss: 1.241 Vali Acc: 0.905 Test Loss: 1.241 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.434467315673828
Epoch: 11, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.601 Vali Acc: 0.933 Test Loss: 0.601 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.679844617843628
Epoch: 12, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.531 Vali Acc: 0.948 Test Loss: 0.531 Test Acc: 0.948
Validation loss decreased (-0.946375 --> -0.947766).  Saving model ...
Epoch: 13 cost time: 26.084349870681763
Epoch: 13, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.641 Vali Acc: 0.935 Test Loss: 0.641 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.378000259399414
Epoch: 14, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.932 Vali Acc: 0.935 Test Loss: 0.932 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.882225036621094
Epoch: 15, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.832 Vali Acc: 0.922 Test Loss: 0.832 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 26.285207986831665
Epoch: 16, Steps: 89 | Train Loss: 0.213 Vali Loss: 1.161 Vali Acc: 0.917 Test Loss: 1.161 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.314695358276367
Epoch: 17, Steps: 89 | Train Loss: 0.135 Vali Loss: 1.325 Vali Acc: 0.914 Test Loss: 1.325 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 25.350056409835815
Epoch: 18, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.863 Vali Acc: 0.937 Test Loss: 0.863 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.087647438049316
Epoch: 19, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.780 Vali Acc: 0.942 Test Loss: 0.780 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 25.44881319999695
Epoch: 20, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.859 Vali Acc: 0.937 Test Loss: 0.859 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 24.407881259918213
Epoch: 21, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.974 Vali Acc: 0.938 Test Loss: 0.974 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 25.967496633529663
Epoch: 22, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.758 Vali Acc: 0.952 Test Loss: 0.758 Test Acc: 0.952
Validation loss decreased (-0.947766 --> -0.951942).  Saving model ...
Epoch: 23 cost time: 25.189874172210693
Epoch: 23, Steps: 89 | Train Loss: 0.092 Vali Loss: 1.125 Vali Acc: 0.920 Test Loss: 1.125 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 23.768174648284912
Epoch: 24, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.832 Vali Acc: 0.951 Test Loss: 0.832 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 25.541017055511475
Epoch: 25, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.865 Vali Acc: 0.953 Test Loss: 0.865 Test Acc: 0.953
Validation loss decreased (-0.951942 --> -0.953334).  Saving model ...
Epoch: 26 cost time: 25.099470615386963
Epoch: 26, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.966 Vali Acc: 0.946 Test Loss: 0.966 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 24.91960620880127
Epoch: 27, Steps: 89 | Train Loss: 0.194 Vali Loss: 1.242 Vali Acc: 0.928 Test Loss: 1.242 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 23.747334957122803
Epoch: 28, Steps: 89 | Train Loss: 0.206 Vali Loss: 1.029 Vali Acc: 0.946 Test Loss: 1.029 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 24.65748643875122
Epoch: 29, Steps: 89 | Train Loss: 0.093 Vali Loss: 1.146 Vali Acc: 0.941 Test Loss: 1.146 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 25.029132604599
Epoch: 30, Steps: 89 | Train Loss: 0.123 Vali Loss: 1.193 Vali Acc: 0.945 Test Loss: 1.193 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 24.379974603652954
Epoch: 31, Steps: 89 | Train Loss: 0.184 Vali Loss: 1.087 Vali Acc: 0.935 Test Loss: 1.087 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 24.06800675392151
Epoch: 32, Steps: 89 | Train Loss: 0.215 Vali Loss: 1.033 Vali Acc: 0.951 Test Loss: 1.033 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 24.27178716659546
Epoch: 33, Steps: 89 | Train Loss: 0.137 Vali Loss: 1.117 Vali Acc: 0.934 Test Loss: 1.117 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 25.914022207260132
Epoch: 34, Steps: 89 | Train Loss: 0.177 Vali Loss: 1.541 Vali Acc: 0.914 Test Loss: 1.541 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 25.247472286224365
Epoch: 35, Steps: 89 | Train Loss: 0.166 Vali Loss: 1.447 Vali Acc: 0.928 Test Loss: 1.447 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.995943307876587
Epoch: 1, Steps: 89 | Train Loss: 1.142 Vali Loss: 0.762 Vali Acc: 0.779 Test Loss: 0.762 Test Acc: 0.779
Validation loss decreased (inf --> -0.778544).  Saving model ...
Epoch: 2 cost time: 24.491683959960938
Epoch: 2, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.498 Vali Acc: 0.870 Test Loss: 0.498 Test Acc: 0.870
Validation loss decreased (-0.778544 --> -0.869772).  Saving model ...
Epoch: 3 cost time: 24.114800453186035
Epoch: 3, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.569 Vali Acc: 0.889 Test Loss: 0.569 Test Acc: 0.889
Validation loss decreased (-0.869772 --> -0.889270).  Saving model ...
Epoch: 4 cost time: 22.43311858177185
Epoch: 4, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.779 Vali Acc: 0.869 Test Loss: 0.779 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.417330503463745
Epoch: 5, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.503 Vali Acc: 0.923 Test Loss: 0.503 Test Acc: 0.923
Validation loss decreased (-0.889270 --> -0.923393).  Saving model ...
Epoch: 6 cost time: 24.09388518333435
Epoch: 6, Steps: 89 | Train Loss: 0.326 Vali Loss: 0.808 Vali Acc: 0.899 Test Loss: 0.808 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.910017251968384
Epoch: 7, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.473 Vali Acc: 0.943 Test Loss: 0.473 Test Acc: 0.943
Validation loss decreased (-0.923393 --> -0.942892).  Saving model ...
Epoch: 8 cost time: 24.900277853012085
Epoch: 8, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.624 Vali Acc: 0.915 Test Loss: 0.624 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.23078489303589
Epoch: 9, Steps: 89 | Train Loss: 0.253 Vali Loss: 1.201 Vali Acc: 0.882 Test Loss: 1.201 Test Acc: 0.882
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.153653383255005
Epoch: 10, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.549 Vali Acc: 0.939 Test Loss: 0.549 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.330192804336548
Epoch: 11, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.024 Vali Acc: 0.898 Test Loss: 1.024 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.799243450164795
Epoch: 12, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.835 Vali Acc: 0.927 Test Loss: 0.835 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.911954641342163
Epoch: 13, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.784 Vali Acc: 0.937 Test Loss: 0.784 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.931288480758667
Epoch: 14, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.907 Vali Acc: 0.911 Test Loss: 0.907 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 23.186948776245117
Epoch: 15, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.840 Vali Acc: 0.928 Test Loss: 0.840 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 21.87020969390869
Epoch: 16, Steps: 89 | Train Loss: 0.276 Vali Loss: 1.004 Vali Acc: 0.916 Test Loss: 1.004 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 23.417985200881958
Epoch: 17, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.899 Vali Acc: 0.939 Test Loss: 0.899 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9428969359331476
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.376904010772705
Epoch: 1, Steps: 89 | Train Loss: 1.229 Vali Loss: 0.811 Vali Acc: 0.774 Test Loss: 0.811 Test Acc: 0.774
Validation loss decreased (inf --> -0.773669).  Saving model ...
Epoch: 2 cost time: 23.927826166152954
Epoch: 2, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.527 Vali Acc: 0.858 Test Loss: 0.527 Test Acc: 0.858
Validation loss decreased (-0.773669 --> -0.857933).  Saving model ...
Epoch: 3 cost time: 23.191130876541138
Epoch: 3, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.370 Vali Acc: 0.920 Test Loss: 0.370 Test Acc: 0.920
Validation loss decreased (-0.857933 --> -0.919913).  Saving model ...
Epoch: 4 cost time: 23.371667623519897
Epoch: 4, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.626 Vali Acc: 0.891 Test Loss: 0.626 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.847582817077637
Epoch: 5, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.298505067825317
Epoch: 6, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.599 Vali Acc: 0.920 Test Loss: 0.599 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.940738916397095
Epoch: 7, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.809 Vali Acc: 0.896 Test Loss: 0.809 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 25.007850646972656
Epoch: 8, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.506 Vali Acc: 0.932 Test Loss: 0.506 Test Acc: 0.932
Validation loss decreased (-0.919913 --> -0.931750).  Saving model ...
Epoch: 9 cost time: 25.350067615509033
Epoch: 9, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.759 Vali Acc: 0.924 Test Loss: 0.759 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.005964517593384
Epoch: 10, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.604 Vali Acc: 0.930 Test Loss: 0.604 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 24.096419095993042
Epoch: 11, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.964 Vali Acc: 0.905 Test Loss: 0.964 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.48220682144165
Epoch: 12, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.648 Vali Acc: 0.932 Test Loss: 0.648 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.792935371398926
Epoch: 13, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.572 Vali Acc: 0.951 Test Loss: 0.572 Test Acc: 0.951
Validation loss decreased (-0.931750 --> -0.950551).  Saving model ...
Epoch: 14 cost time: 25.569708824157715
Epoch: 14, Steps: 89 | Train Loss: 0.195 Vali Loss: 1.504 Vali Acc: 0.887 Test Loss: 1.504 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.10722517967224
Epoch: 15, Steps: 89 | Train Loss: 0.371 Vali Loss: 1.564 Vali Acc: 0.887 Test Loss: 1.564 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 23.016353607177734
Epoch: 16, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.625 Vali Acc: 0.946 Test Loss: 0.625 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 24.226604461669922
Epoch: 17, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.669 Vali Acc: 0.939 Test Loss: 0.669 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.217849016189575
Epoch: 18, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.514 Vali Acc: 0.964 Test Loss: 0.514 Test Acc: 0.964
Validation loss decreased (-0.950551 --> -0.963783).  Saving model ...
Epoch: 19 cost time: 25.8461172580719
Epoch: 19, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.610 Vali Acc: 0.954 Test Loss: 0.610 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 25.945622444152832
Epoch: 20, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.032 Vali Acc: 0.929 Test Loss: 1.032 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.89664125442505
Epoch: 21, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.895 Vali Acc: 0.945 Test Loss: 0.895 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 23.632288217544556
Epoch: 22, Steps: 89 | Train Loss: 0.275 Vali Loss: 1.746 Vali Acc: 0.887 Test Loss: 1.746 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 25.328394412994385
Epoch: 23, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.826 Vali Acc: 0.935 Test Loss: 0.826 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 25.19942617416382
Epoch: 24, Steps: 89 | Train Loss: 0.387 Vali Loss: 1.249 Vali Acc: 0.932 Test Loss: 1.249 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 23.149030208587646
Epoch: 25, Steps: 89 | Train Loss: 0.250 Vali Loss: 1.003 Vali Acc: 0.937 Test Loss: 1.003 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 22.994577646255493
Epoch: 26, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.815 Vali Acc: 0.948 Test Loss: 0.815 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 23.42236852645874
Epoch: 27, Steps: 89 | Train Loss: 0.207 Vali Loss: 1.085 Vali Acc: 0.930 Test Loss: 1.085 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 25.75466823577881
Epoch: 28, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.899 Vali Acc: 0.948 Test Loss: 0.899 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.56564712524414
Epoch: 1, Steps: 89 | Train Loss: 1.456 Vali Loss: 0.889 Vali Acc: 0.756 Test Loss: 0.889 Test Acc: 0.756
Validation loss decreased (inf --> -0.755562).  Saving model ...
Epoch: 2 cost time: 23.354422330856323
Epoch: 2, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.628 Vali Acc: 0.836 Test Loss: 0.628 Test Acc: 0.836
Validation loss decreased (-0.755562 --> -0.836345).  Saving model ...
Epoch: 3 cost time: 22.68126630783081
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.355 Vali Acc: 0.923 Test Loss: 0.355 Test Acc: 0.923
Validation loss decreased (-0.836345 --> -0.923395).  Saving model ...
Epoch: 4 cost time: 24.413666248321533
Epoch: 4, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.501 Vali Acc: 0.890 Test Loss: 0.501 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.062788724899292
Epoch: 5, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.373 Vali Acc: 0.934 Test Loss: 0.373 Test Acc: 0.934
Validation loss decreased (-0.923395 --> -0.933840).  Saving model ...
Epoch: 6 cost time: 23.367183923721313
Epoch: 6, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.632 Vali Acc: 0.907 Test Loss: 0.632 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.860573053359985
Epoch: 7, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.517 Vali Acc: 0.928 Test Loss: 0.517 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.564224004745483
Epoch: 8, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.699 Vali Acc: 0.919 Test Loss: 0.699 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 25.027769804000854
Epoch: 9, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.688 Vali Acc: 0.922 Test Loss: 0.688 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 25.31551718711853
Epoch: 10, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.529 Vali Acc: 0.942 Test Loss: 0.529 Test Acc: 0.942
Validation loss decreased (-0.933840 --> -0.942195).  Saving model ...
Epoch: 11 cost time: 25.430429935455322
Epoch: 11, Steps: 89 | Train Loss: 0.172 Vali Loss: 1.252 Vali Acc: 0.889 Test Loss: 1.252 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.694920778274536
Epoch: 12, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.933 Vali Acc: 0.919 Test Loss: 0.933 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 26.273645401000977
Epoch: 13, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.745 Vali Acc: 0.935 Test Loss: 0.745 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.120445728302002
Epoch: 14, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.844 Vali Acc: 0.935 Test Loss: 0.844 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 24.722360134124756
Epoch: 15, Steps: 89 | Train Loss: 0.328 Vali Loss: 1.758 Vali Acc: 0.889 Test Loss: 1.758 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 23.45087218284607
Epoch: 16, Steps: 89 | Train Loss: 0.260 Vali Loss: 1.285 Vali Acc: 0.926 Test Loss: 1.285 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 22.27730917930603
Epoch: 17, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.748 Vali Acc: 0.927 Test Loss: 0.748 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 23.61004376411438
Epoch: 18, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.955 Vali Acc: 0.934 Test Loss: 0.955 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 23.601067066192627
Epoch: 19, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.737 Vali Acc: 0.943 Test Loss: 0.737 Test Acc: 0.943
Validation loss decreased (-0.942195 --> -0.942890).  Saving model ...
Epoch: 20 cost time: 22.89601182937622
Epoch: 20, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.986 Vali Acc: 0.949 Test Loss: 0.986 Test Acc: 0.949
Validation loss decreased (-0.942890 --> -0.949154).  Saving model ...
Epoch: 21 cost time: 22.355279207229614
Epoch: 21, Steps: 89 | Train Loss: 0.283 Vali Loss: 1.521 Vali Acc: 0.913 Test Loss: 1.521 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 21.799680948257446
Epoch: 22, Steps: 89 | Train Loss: 0.150 Vali Loss: 1.073 Vali Acc: 0.932 Test Loss: 1.073 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 23.507144451141357
Epoch: 23, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.003 Vali Acc: 0.937 Test Loss: 1.003 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 24.17604422569275
Epoch: 24, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.853 Vali Acc: 0.945 Test Loss: 0.853 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 23.51010537147522
Epoch: 25, Steps: 89 | Train Loss: 0.261 Vali Loss: 1.315 Vali Acc: 0.919 Test Loss: 1.315 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 23.742249488830566
Epoch: 26, Steps: 89 | Train Loss: 0.166 Vali Loss: 1.812 Vali Acc: 0.905 Test Loss: 1.812 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 24.231149673461914
Epoch: 27, Steps: 89 | Train Loss: 0.206 Vali Loss: 1.019 Vali Acc: 0.942 Test Loss: 1.019 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 24.248775482177734
Epoch: 28, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.969 Vali Acc: 0.950 Test Loss: 0.969 Test Acc: 0.950
Validation loss decreased (-0.949154 --> -0.949851).  Saving model ...
Epoch: 29 cost time: 25.934218168258667
Epoch: 29, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.907 Vali Acc: 0.950 Test Loss: 0.907 Test Acc: 0.950
Validation loss decreased (-0.949851 --> -0.949852).  Saving model ...
Epoch: 30 cost time: 23.73918890953064
Epoch: 30, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.954 Vali Acc: 0.948 Test Loss: 0.954 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 23.872546434402466
Epoch: 31, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.804 Vali Acc: 0.953 Test Loss: 0.804 Test Acc: 0.953
Validation loss decreased (-0.949852 --> -0.953335).  Saving model ...
Epoch: 32 cost time: 23.7765531539917
Epoch: 32, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.752 Vali Acc: 0.957 Test Loss: 0.752 Test Acc: 0.957
Validation loss decreased (-0.953335 --> -0.956817).  Saving model ...
Epoch: 33 cost time: 25.875823736190796
Epoch: 33, Steps: 89 | Train Loss: 0.186 Vali Loss: 2.095 Vali Acc: 0.923 Test Loss: 2.095 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 25.655133485794067
Epoch: 34, Steps: 89 | Train Loss: 0.161 Vali Loss: 1.009 Vali Acc: 0.948 Test Loss: 1.009 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 25.119211435317993
Epoch: 35, Steps: 89 | Train Loss: 0.137 Vali Loss: 1.257 Vali Acc: 0.930 Test Loss: 1.257 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.904842853546143
Epoch: 36, Steps: 89 | Train Loss: 0.193 Vali Loss: 1.165 Vali Acc: 0.939 Test Loss: 1.165 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 23.336798191070557
Epoch: 37, Steps: 89 | Train Loss: 0.226 Vali Loss: 1.247 Vali Acc: 0.928 Test Loss: 1.247 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 24.509007692337036
Epoch: 38, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.995 Vali Acc: 0.953 Test Loss: 0.995 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 25.384326457977295
Epoch: 39, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.391 Vali Acc: 0.936 Test Loss: 1.391 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 24.84846019744873
Epoch: 40, Steps: 89 | Train Loss: 0.207 Vali Loss: 1.453 Vali Acc: 0.942 Test Loss: 1.453 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 25.916381120681763
Epoch: 41, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.956 Vali Acc: 0.943 Test Loss: 0.956 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 25.422825574874878
Epoch: 42, Steps: 89 | Train Loss: 0.051 Vali Loss: 1.376 Vali Acc: 0.941 Test Loss: 1.376 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.232041120529175
Epoch: 1, Steps: 89 | Train Loss: 1.813 Vali Loss: 1.236 Vali Acc: 0.638 Test Loss: 1.236 Test Acc: 0.638
Validation loss decreased (inf --> -0.637871).  Saving model ...
Epoch: 2 cost time: 27.502909660339355
Epoch: 2, Steps: 89 | Train Loss: 0.468 Vali Loss: 0.528 Vali Acc: 0.854 Test Loss: 0.528 Test Acc: 0.854
Validation loss decreased (-0.637871 --> -0.854452).  Saving model ...
Epoch: 3 cost time: 24.51642942428589
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.461 Vali Acc: 0.879 Test Loss: 0.461 Test Acc: 0.879
Validation loss decreased (-0.854452 --> -0.878825).  Saving model ...
Epoch: 4 cost time: 24.570175647735596
Epoch: 4, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.473 Vali Acc: 0.895 Test Loss: 0.473 Test Acc: 0.895
Validation loss decreased (-0.878825 --> -0.894842).  Saving model ...
Epoch: 5 cost time: 24.27777886390686
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.485 Vali Acc: 0.918 Test Loss: 0.485 Test Acc: 0.918
Validation loss decreased (-0.894842 --> -0.917822).  Saving model ...
Epoch: 6 cost time: 24.368335008621216
Epoch: 6, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.634 Vali Acc: 0.896 Test Loss: 0.634 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.917617321014404
Epoch: 7, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.840 Vali Acc: 0.880 Test Loss: 0.840 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.777828216552734
Epoch: 8, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.967 Vali Acc: 0.895 Test Loss: 0.967 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.514941692352295
Epoch: 9, Steps: 89 | Train Loss: 0.412 Vali Loss: 1.016 Vali Acc: 0.893 Test Loss: 1.016 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.22133779525757
Epoch: 10, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.675 Vali Acc: 0.912 Test Loss: 0.675 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.397127628326416
Epoch: 11, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.875 Vali Acc: 0.913 Test Loss: 0.875 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.00823974609375
Epoch: 12, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.805 Vali Acc: 0.919 Test Loss: 0.805 Test Acc: 0.919
Validation loss decreased (-0.917822 --> -0.919212).  Saving model ...
Epoch: 13 cost time: 23.8122136592865
Epoch: 13, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.627 Vali Acc: 0.933 Test Loss: 0.627 Test Acc: 0.933
Validation loss decreased (-0.919212 --> -0.933141).  Saving model ...
Epoch: 14 cost time: 22.929432153701782
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.754 Vali Acc: 0.920 Test Loss: 0.754 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.833123445510864
Epoch: 15, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.986 Vali Acc: 0.903 Test Loss: 0.986 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 25.591729402542114
Epoch: 16, Steps: 89 | Train Loss: 0.237 Vali Loss: 1.071 Vali Acc: 0.907 Test Loss: 1.071 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 24.591779470443726
Epoch: 17, Steps: 89 | Train Loss: 0.317 Vali Loss: 1.084 Vali Acc: 0.917 Test Loss: 1.084 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.174859523773193
Epoch: 18, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.784 Vali Acc: 0.930 Test Loss: 0.784 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 25.264126539230347
Epoch: 19, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.952 Vali Acc: 0.925 Test Loss: 0.952 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 25.260844707489014
Epoch: 20, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.759 Vali Acc: 0.942 Test Loss: 0.759 Test Acc: 0.942
Validation loss decreased (-0.933141 --> -0.942193).  Saving model ...
Epoch: 21 cost time: 24.123997449874878
Epoch: 21, Steps: 89 | Train Loss: 0.204 Vali Loss: 1.008 Vali Acc: 0.921 Test Loss: 1.008 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 24.959451913833618
Epoch: 22, Steps: 89 | Train Loss: 0.242 Vali Loss: 1.322 Vali Acc: 0.893 Test Loss: 1.322 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 24.074028253555298
Epoch: 23, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.092 Vali Acc: 0.914 Test Loss: 1.092 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 25.337382078170776
Epoch: 24, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.670 Vali Acc: 0.948 Test Loss: 0.670 Test Acc: 0.948
Validation loss decreased (-0.942193 --> -0.947765).  Saving model ...
Epoch: 25 cost time: 26.02603578567505
Epoch: 25, Steps: 89 | Train Loss: 0.311 Vali Loss: 1.002 Vali Acc: 0.921 Test Loss: 1.002 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 24.164992570877075
Epoch: 26, Steps: 89 | Train Loss: 0.169 Vali Loss: 1.428 Vali Acc: 0.929 Test Loss: 1.428 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 25.31836438179016
Epoch: 27, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.961 Vali Acc: 0.935 Test Loss: 0.961 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 23.36221694946289
Epoch: 28, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.884 Vali Acc: 0.927 Test Loss: 0.884 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 28.037890911102295
Epoch: 29, Steps: 89 | Train Loss: 0.186 Vali Loss: 1.621 Vali Acc: 0.911 Test Loss: 1.621 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 25.646965503692627
Epoch: 30, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.823 Vali Acc: 0.948 Test Loss: 0.823 Test Acc: 0.948
Validation loss decreased (-0.947765 --> -0.948460).  Saving model ...
Epoch: 31 cost time: 25.331543922424316
Epoch: 31, Steps: 89 | Train Loss: 0.149 Vali Loss: 1.190 Vali Acc: 0.923 Test Loss: 1.190 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 25.703843116760254
Epoch: 32, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.745 Vali Acc: 0.958 Test Loss: 0.745 Test Acc: 0.958
Validation loss decreased (-0.948460 --> -0.958210).  Saving model ...
Epoch: 33 cost time: 25.54952836036682
Epoch: 33, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.870 Vali Acc: 0.947 Test Loss: 0.870 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 25.819542169570923
Epoch: 34, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.783 Vali Acc: 0.953 Test Loss: 0.783 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 24.77411150932312
Epoch: 35, Steps: 89 | Train Loss: 0.056 Vali Loss: 1.325 Vali Acc: 0.932 Test Loss: 1.325 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.309077262878418
Epoch: 36, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.842 Vali Acc: 0.955 Test Loss: 0.842 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 24.324861526489258
Epoch: 37, Steps: 89 | Train Loss: 0.116 Vali Loss: 1.093 Vali Acc: 0.936 Test Loss: 1.093 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 25.86378264427185
Epoch: 38, Steps: 89 | Train Loss: 0.227 Vali Loss: 1.129 Vali Acc: 0.923 Test Loss: 1.129 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 25.740836143493652
Epoch: 39, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.826 Vali Acc: 0.953 Test Loss: 0.826 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 22.543978691101074
Epoch: 40, Steps: 89 | Train Loss: 0.132 Vali Loss: 1.991 Vali Acc: 0.896 Test Loss: 1.991 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 23.583842992782593
Epoch: 41, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.738 Vali Acc: 0.958 Test Loss: 0.738 Test Acc: 0.958
Validation loss decreased (-0.958210 --> -0.958210).  Saving model ...
Epoch: 42 cost time: 24.62781572341919
Epoch: 42, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.827 Vali Acc: 0.953 Test Loss: 0.827 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 26.56110954284668
Epoch: 43, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.730 Vali Acc: 0.955 Test Loss: 0.730 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 25.38826823234558
Epoch: 44, Steps: 89 | Train Loss: 0.257 Vali Loss: 1.022 Vali Acc: 0.937 Test Loss: 1.022 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 24.889936923980713
Epoch: 45, Steps: 89 | Train Loss: 0.066 Vali Loss: 1.249 Vali Acc: 0.944 Test Loss: 1.249 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 26.733760356903076
Epoch: 46, Steps: 89 | Train Loss: 0.187 Vali Loss: 1.114 Vali Acc: 0.947 Test Loss: 1.114 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 24.98278284072876
Epoch: 47, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.786 Vali Acc: 0.953 Test Loss: 0.786 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 25.16232657432556
Epoch: 48, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.665 Vali Acc: 0.955 Test Loss: 0.665 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 24.192572832107544
Epoch: 49, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.781 Vali Acc: 0.955 Test Loss: 0.781 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 25.163660287857056
Epoch: 50, Steps: 89 | Train Loss: 0.253 Vali Loss: 1.139 Vali Acc: 0.936 Test Loss: 1.139 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 25.0990252494812
Epoch: 51, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.772 Vali Acc: 0.958 Test Loss: 0.772 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.391988277435303
Epoch: 1, Steps: 89 | Train Loss: 1.817 Vali Loss: 1.569 Vali Acc: 0.552 Test Loss: 1.569 Test Acc: 0.552
Validation loss decreased (inf --> -0.551516).  Saving model ...
Epoch: 2 cost time: 23.085424184799194
Epoch: 2, Steps: 89 | Train Loss: 0.430 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
Validation loss decreased (-0.551516 --> -0.782723).  Saving model ...
Epoch: 3 cost time: 22.539462566375732
Epoch: 3, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.504 Vali Acc: 0.857 Test Loss: 0.504 Test Acc: 0.857
Validation loss decreased (-0.782723 --> -0.856541).  Saving model ...
Epoch: 4 cost time: 25.849582195281982
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.788 Vali Acc: 0.836 Test Loss: 0.788 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.252546310424805
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.376 Vali Acc: 0.919 Test Loss: 0.376 Test Acc: 0.919
Validation loss decreased (-0.856541 --> -0.918520).  Saving model ...
Epoch: 6 cost time: 24.342451810836792
Epoch: 6, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.868 Vali Acc: 0.840 Test Loss: 0.868 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.474771738052368
Epoch: 7, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.610 Vali Acc: 0.909 Test Loss: 0.610 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.877380847930908
Epoch: 8, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.671 Vali Acc: 0.913 Test Loss: 0.671 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.634992599487305
Epoch: 9, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.672 Vali Acc: 0.889 Test Loss: 0.672 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.67263674736023
Epoch: 10, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.840 Vali Acc: 0.880 Test Loss: 0.840 Test Acc: 0.880
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 25.002397537231445
Epoch: 11, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.509 Vali Acc: 0.931 Test Loss: 0.509 Test Acc: 0.931
Validation loss decreased (-0.918520 --> -0.931053).  Saving model ...
Epoch: 12 cost time: 24.043827772140503
Epoch: 12, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.782 Vali Acc: 0.894 Test Loss: 0.782 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.97747802734375
Epoch: 13, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.289 Vali Acc: 0.854 Test Loss: 1.289 Test Acc: 0.854
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 23.353864192962646
Epoch: 14, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.647 Vali Acc: 0.923 Test Loss: 0.647 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 21.452182292938232
Epoch: 15, Steps: 89 | Train Loss: 0.140 Vali Loss: 1.118 Vali Acc: 0.879 Test Loss: 1.118 Test Acc: 0.879
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 24.886175870895386
Epoch: 16, Steps: 89 | Train Loss: 0.340 Vali Loss: 1.395 Vali Acc: 0.875 Test Loss: 1.395 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 26.130603075027466
Epoch: 17, Steps: 89 | Train Loss: 0.203 Vali Loss: 1.016 Vali Acc: 0.912 Test Loss: 1.016 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 22.46165895462036
Epoch: 18, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.878 Vali Acc: 0.912 Test Loss: 0.878 Test Acc: 0.912
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 23.826295375823975
Epoch: 19, Steps: 89 | Train Loss: 0.194 Vali Loss: 1.027 Vali Acc: 0.907 Test Loss: 1.027 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 24.937756538391113
Epoch: 20, Steps: 89 | Train Loss: 0.147 Vali Loss: 1.677 Vali Acc: 0.872 Test Loss: 1.677 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 25.365928888320923
Epoch: 21, Steps: 89 | Train Loss: 0.178 Vali Loss: 1.499 Vali Acc: 0.878 Test Loss: 1.499 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9310584958217271
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.83815622329712
Epoch: 1, Steps: 89 | Train Loss: 1.769 Vali Loss: 1.054 Vali Acc: 0.687 Test Loss: 1.054 Test Acc: 0.687
Validation loss decreased (inf --> -0.686619).  Saving model ...
Epoch: 2 cost time: 26.50264620780945
Epoch: 2, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.856 Vali Acc: 0.744 Test Loss: 0.856 Test Acc: 0.744
Validation loss decreased (-0.686619 --> -0.744420).  Saving model ...
Epoch: 3 cost time: 25.92210626602173
Epoch: 3, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.655 Vali Acc: 0.831 Test Loss: 0.655 Test Acc: 0.831
Validation loss decreased (-0.744420 --> -0.830773).  Saving model ...
Epoch: 4 cost time: 23.700175285339355
Epoch: 4, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.988 Vali Acc: 0.836 Test Loss: 0.988 Test Acc: 0.836
Validation loss decreased (-0.830773 --> -0.836341).  Saving model ...
Epoch: 5 cost time: 26.305558443069458
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.677 Vali Acc: 0.865 Test Loss: 0.677 Test Acc: 0.865
Validation loss decreased (-0.836341 --> -0.864896).  Saving model ...
Epoch: 6 cost time: 26.873158931732178
Epoch: 6, Steps: 89 | Train Loss: 0.171 Vali Loss: 1.239 Vali Acc: 0.800 Test Loss: 1.239 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.12604284286499
Epoch: 7, Steps: 89 | Train Loss: 0.140 Vali Loss: 1.153 Vali Acc: 0.823 Test Loss: 1.153 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.643558263778687
Epoch: 8, Steps: 89 | Train Loss: 0.185 Vali Loss: 1.098 Vali Acc: 0.837 Test Loss: 1.098 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 26.503066778182983
Epoch: 9, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.904 Vali Acc: 0.846 Test Loss: 0.904 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.2115478515625
Epoch: 10, Steps: 89 | Train Loss: 0.110 Vali Loss: 1.111 Vali Acc: 0.804 Test Loss: 1.111 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 23.93253779411316
Epoch: 11, Steps: 89 | Train Loss: 0.142 Vali Loss: 1.588 Vali Acc: 0.763 Test Loss: 1.588 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 25.108998775482178
Epoch: 12, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.518 Vali Acc: 0.823 Test Loss: 1.518 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 26.844526052474976
Epoch: 13, Steps: 89 | Train Loss: 0.178 Vali Loss: 1.800 Vali Acc: 0.773 Test Loss: 1.800 Test Acc: 0.773
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 25.0907039642334
Epoch: 14, Steps: 89 | Train Loss: 0.177 Vali Loss: 2.411 Vali Acc: 0.789 Test Loss: 2.411 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 24.917502403259277
Epoch: 15, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.413 Vali Acc: 0.850 Test Loss: 1.413 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.8649025069637883
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.888861656188965
Epoch: 1, Steps: 89 | Train Loss: 1.803 Vali Loss: 0.945 Vali Acc: 0.724 Test Loss: 0.945 Test Acc: 0.724
Validation loss decreased (inf --> -0.724225).  Saving model ...
Epoch: 2 cost time: 23.001651525497437
Epoch: 2, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.934 Vali Acc: 0.743 Test Loss: 0.934 Test Acc: 0.743
Validation loss decreased (-0.724225 --> -0.743027).  Saving model ...
Epoch: 3 cost time: 24.02134680747986
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 1.245 Vali Acc: 0.775 Test Loss: 1.245 Test Acc: 0.775
Validation loss decreased (-0.743027 --> -0.775057).  Saving model ...
Epoch: 4 cost time: 25.257567167282104
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 1.229 Vali Acc: 0.788 Test Loss: 1.229 Test Acc: 0.788
Validation loss decreased (-0.775057 --> -0.787592).  Saving model ...
Epoch: 5 cost time: 24.31147313117981
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 1.064 Vali Acc: 0.841 Test Loss: 1.064 Test Acc: 0.841
Validation loss decreased (-0.787592 --> -0.840519).  Saving model ...
Epoch: 6 cost time: 22.540587663650513
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 2.277 Vali Acc: 0.738 Test Loss: 2.277 Test Acc: 0.738
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.5774142742157
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 1.140 Vali Acc: 0.824 Test Loss: 1.140 Test Acc: 0.824
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.68524670600891
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 1.495 Vali Acc: 0.766 Test Loss: 1.495 Test Acc: 0.766
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.358368635177612
Epoch: 9, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.982 Vali Acc: 0.851 Test Loss: 0.982 Test Acc: 0.851
Validation loss decreased (-0.840519 --> -0.850965).  Saving model ...
Epoch: 10 cost time: 23.410810947418213
Epoch: 10, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.822 Vali Acc: 0.873 Test Loss: 0.822 Test Acc: 0.873
Validation loss decreased (-0.850965 --> -0.872554).  Saving model ...
Epoch: 11 cost time: 26.401591062545776
Epoch: 11, Steps: 89 | Train Loss: 0.154 Vali Loss: 1.525 Vali Acc: 0.815 Test Loss: 1.525 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.168747663497925
Epoch: 12, Steps: 89 | Train Loss: 0.217 Vali Loss: 2.477 Vali Acc: 0.724 Test Loss: 2.477 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.33129358291626
Epoch: 13, Steps: 89 | Train Loss: 0.185 Vali Loss: 3.184 Vali Acc: 0.719 Test Loss: 3.184 Test Acc: 0.719
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 25.10907816886902
Epoch: 14, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.382 Vali Acc: 0.856 Test Loss: 1.382 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.570595026016235
Epoch: 15, Steps: 89 | Train Loss: 0.228 Vali Loss: 2.748 Vali Acc: 0.814 Test Loss: 2.748 Test Acc: 0.814
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 23.4919011592865
Epoch: 16, Steps: 89 | Train Loss: 0.197 Vali Loss: 1.446 Vali Acc: 0.876 Test Loss: 1.446 Test Acc: 0.876
Validation loss decreased (-0.872554 --> -0.876030).  Saving model ...
Epoch: 17 cost time: 24.75606369972229
Epoch: 17, Steps: 89 | Train Loss: 0.200 Vali Loss: 2.410 Vali Acc: 0.825 Test Loss: 2.410 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 25.81942057609558
Epoch: 18, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.978 Vali Acc: 0.888 Test Loss: 0.978 Test Acc: 0.888
Validation loss decreased (-0.876030 --> -0.887873).  Saving model ...
Epoch: 19 cost time: 22.65700674057007
Epoch: 19, Steps: 89 | Train Loss: 0.274 Vali Loss: 2.046 Vali Acc: 0.815 Test Loss: 2.046 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.459239959716797
Epoch: 20, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.754 Vali Acc: 0.854 Test Loss: 1.754 Test Acc: 0.854
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.820744276046753
Epoch: 21, Steps: 89 | Train Loss: 0.248 Vali Loss: 1.547 Vali Acc: 0.886 Test Loss: 1.547 Test Acc: 0.886
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 25.672195434570312
Epoch: 22, Steps: 89 | Train Loss: 0.218 Vali Loss: 2.021 Vali Acc: 0.833 Test Loss: 2.021 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 22.22768998146057
Epoch: 23, Steps: 89 | Train Loss: 0.235 Vali Loss: 1.626 Vali Acc: 0.861 Test Loss: 1.626 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 23.52018094062805
Epoch: 24, Steps: 89 | Train Loss: 0.128 Vali Loss: 1.569 Vali Acc: 0.859 Test Loss: 1.569 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 24.788169622421265
Epoch: 25, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.880 Vali Acc: 0.924 Test Loss: 0.880 Test Acc: 0.924
Validation loss decreased (-0.887873 --> -0.924086).  Saving model ...
Epoch: 26 cost time: 24.184996366500854
Epoch: 26, Steps: 89 | Train Loss: 0.249 Vali Loss: 1.260 Vali Acc: 0.896 Test Loss: 1.260 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 23.599876165390015
Epoch: 27, Steps: 89 | Train Loss: 0.238 Vali Loss: 1.731 Vali Acc: 0.886 Test Loss: 1.731 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 25.42118191719055
Epoch: 28, Steps: 89 | Train Loss: 0.219 Vali Loss: 2.469 Vali Acc: 0.866 Test Loss: 2.469 Test Acc: 0.866
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 22.73381209373474
Epoch: 29, Steps: 89 | Train Loss: 0.197 Vali Loss: 1.098 Vali Acc: 0.916 Test Loss: 1.098 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 23.88490390777588
Epoch: 30, Steps: 89 | Train Loss: 0.170 Vali Loss: 1.180 Vali Acc: 0.926 Test Loss: 1.180 Test Acc: 0.926
Validation loss decreased (-0.924086 --> -0.926172).  Saving model ...
Epoch: 31 cost time: 24.794854402542114
Epoch: 31, Steps: 89 | Train Loss: 0.223 Vali Loss: 3.127 Vali Acc: 0.854 Test Loss: 3.127 Test Acc: 0.854
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 21.65361499786377
Epoch: 32, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.969 Vali Acc: 0.935 Test Loss: 0.969 Test Acc: 0.935
Validation loss decreased (-0.926172 --> -0.934531).  Saving model ...
Epoch: 33 cost time: 25.309884786605835
Epoch: 33, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.016 Vali Acc: 0.918 Test Loss: 1.016 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 24.216304540634155
Epoch: 34, Steps: 89 | Train Loss: 0.183 Vali Loss: 1.457 Vali Acc: 0.901 Test Loss: 1.457 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 23.618104696273804
Epoch: 35, Steps: 89 | Train Loss: 0.202 Vali Loss: 1.202 Vali Acc: 0.926 Test Loss: 1.202 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.707812547683716
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 1.227 Vali Acc: 0.919 Test Loss: 1.227 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 22.04911708831787
Epoch: 37, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.925 Vali Acc: 0.946 Test Loss: 0.925 Test Acc: 0.946
Validation loss decreased (-0.934531 --> -0.946370).  Saving model ...
Epoch: 38 cost time: 24.157147645950317
Epoch: 38, Steps: 89 | Train Loss: 0.143 Vali Loss: 1.343 Vali Acc: 0.933 Test Loss: 1.343 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 24.25355362892151
Epoch: 39, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.738 Vali Acc: 0.950 Test Loss: 0.738 Test Acc: 0.950
Validation loss decreased (-0.946370 --> -0.949853).  Saving model ...
Epoch: 40 cost time: 24.0860595703125
Epoch: 40, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.995 Vali Acc: 0.949 Test Loss: 0.995 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 25.630152463912964
Epoch: 41, Steps: 89 | Train Loss: 0.182 Vali Loss: 1.108 Vali Acc: 0.933 Test Loss: 1.108 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 23.451897621154785
Epoch: 42, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.964 Vali Acc: 0.949 Test Loss: 0.964 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 22.596901655197144
Epoch: 43, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.957 Vali Acc: 0.942 Test Loss: 0.957 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 23.84368896484375
Epoch: 44, Steps: 89 | Train Loss: 0.174 Vali Loss: 1.469 Vali Acc: 0.904 Test Loss: 1.469 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 22.892423152923584
Epoch: 45, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.384 Vali Acc: 0.928 Test Loss: 1.384 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 26.674661874771118
Epoch: 46, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.265 Vali Acc: 0.936 Test Loss: 1.265 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 25.133689165115356
Epoch: 47, Steps: 89 | Train Loss: 0.146 Vali Loss: 2.493 Vali Acc: 0.891 Test Loss: 2.493 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 24.745688676834106
Epoch: 48, Steps: 89 | Train Loss: 0.171 Vali Loss: 1.015 Vali Acc: 0.958 Test Loss: 1.015 Test Acc: 0.958
Validation loss decreased (-0.949853 --> -0.958207).  Saving model ...
Epoch: 49 cost time: 24.4753360748291
Epoch: 49, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.410 Vali Acc: 0.931 Test Loss: 1.410 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 22.526381254196167
Epoch: 50, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.883 Vali Acc: 0.958 Test Loss: 0.883 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 23.5886971950531
Epoch: 51, Steps: 89 | Train Loss: 0.156 Vali Loss: 1.158 Vali Acc: 0.939 Test Loss: 1.158 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 25.1233389377594
Epoch: 52, Steps: 89 | Train Loss: 0.174 Vali Loss: 1.279 Vali Acc: 0.932 Test Loss: 1.279 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 23.713616847991943
Epoch: 53, Steps: 89 | Train Loss: 0.200 Vali Loss: 2.320 Vali Acc: 0.895 Test Loss: 2.320 Test Acc: 0.895
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 24.130991220474243
Epoch: 54, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.954 Vali Acc: 0.948 Test Loss: 0.954 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 23.64146590232849
Epoch: 55, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.721 Vali Acc: 0.965 Test Loss: 0.721 Test Acc: 0.965
Validation loss decreased (-0.958207 --> -0.965174).  Saving model ...
Epoch: 56 cost time: 23.212855339050293
Epoch: 56, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.983 Vali Acc: 0.948 Test Loss: 0.983 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 23.256711721420288
Epoch: 57, Steps: 89 | Train Loss: 0.101 Vali Loss: 1.012 Vali Acc: 0.947 Test Loss: 1.012 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 22.045349836349487
Epoch: 58, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.712 Vali Acc: 0.964 Test Loss: 0.712 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 24.34473991394043
Epoch: 59, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.814 Vali Acc: 0.964 Test Loss: 0.814 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 25.08890175819397
Epoch: 60, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.855 Vali Acc: 0.958 Test Loss: 0.855 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 23.39625906944275
Epoch: 61, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.883 Vali Acc: 0.962 Test Loss: 0.883 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 22.344116926193237
Epoch: 62, Steps: 89 | Train Loss: 0.088 Vali Loss: 1.028 Vali Acc: 0.954 Test Loss: 1.028 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 20.414655685424805
Epoch: 63, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.964 Vali Acc: 0.951 Test Loss: 0.964 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 23.939402103424072
Epoch: 64, Steps: 89 | Train Loss: 0.173 Vali Loss: 1.220 Vali Acc: 0.930 Test Loss: 1.220 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 23.913666009902954
Epoch: 65, Steps: 89 | Train Loss: 0.290 Vali Loss: 1.472 Vali Acc: 0.919 Test Loss: 1.472 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.08535599708557
Epoch: 1, Steps: 89 | Train Loss: 1.840 Vali Loss: 0.946 Vali Acc: 0.720 Test Loss: 0.946 Test Acc: 0.720
Validation loss decreased (inf --> -0.720046).  Saving model ...
Epoch: 2 cost time: 24.394790410995483
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.725 Vali Acc: 0.794 Test Loss: 0.725 Test Acc: 0.794
Validation loss decreased (-0.720046 --> -0.793865).  Saving model ...
Epoch: 3 cost time: 24.155888557434082
Epoch: 3, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.839 Vali Acc: 0.839 Test Loss: 0.839 Test Acc: 0.839
Validation loss decreased (-0.793865 --> -0.839128).  Saving model ...
Epoch: 4 cost time: 23.030884504318237
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 1.151 Vali Acc: 0.818 Test Loss: 1.151 Test Acc: 0.818
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.78029465675354
Epoch: 5, Steps: 89 | Train Loss: 0.193 Vali Loss: 1.112 Vali Acc: 0.841 Test Loss: 1.112 Test Acc: 0.841
Validation loss decreased (-0.839128 --> -0.840518).  Saving model ...
Epoch: 6 cost time: 25.839569568634033
Epoch: 6, Steps: 89 | Train Loss: 0.201 Vali Loss: 1.958 Vali Acc: 0.753 Test Loss: 1.958 Test Acc: 0.753
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.496601343154907
Epoch: 7, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.206 Vali Acc: 0.834 Test Loss: 1.206 Test Acc: 0.834
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.611982583999634
Epoch: 8, Steps: 89 | Train Loss: 0.173 Vali Loss: 1.733 Vali Acc: 0.725 Test Loss: 1.733 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.59909677505493
Epoch: 9, Steps: 89 | Train Loss: 0.181 Vali Loss: 1.090 Vali Acc: 0.867 Test Loss: 1.090 Test Acc: 0.867
Validation loss decreased (-0.840518 --> -0.866981).  Saving model ...
Epoch: 10 cost time: 24.56006932258606
Epoch: 10, Steps: 89 | Train Loss: 0.183 Vali Loss: 2.313 Vali Acc: 0.731 Test Loss: 2.313 Test Acc: 0.731
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.287615060806274
Epoch: 11, Steps: 89 | Train Loss: 0.229 Vali Loss: 1.717 Vali Acc: 0.809 Test Loss: 1.717 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.724430084228516
Epoch: 12, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.938 Vali Acc: 0.889 Test Loss: 0.938 Test Acc: 0.889
Validation loss decreased (-0.866981 --> -0.889266).  Saving model ...
Epoch: 13 cost time: 25.45354676246643
Epoch: 13, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.384 Vali Acc: 0.818 Test Loss: 1.384 Test Acc: 0.818
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.65010380744934
Epoch: 14, Steps: 89 | Train Loss: 0.164 Vali Loss: 1.954 Vali Acc: 0.850 Test Loss: 1.954 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.865485191345215
Epoch: 15, Steps: 89 | Train Loss: 0.139 Vali Loss: 1.330 Vali Acc: 0.896 Test Loss: 1.330 Test Acc: 0.896
Validation loss decreased (-0.889266 --> -0.896226).  Saving model ...
Epoch: 16 cost time: 22.393138885498047
Epoch: 16, Steps: 89 | Train Loss: 0.267 Vali Loss: 1.394 Vali Acc: 0.836 Test Loss: 1.394 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.46205973625183
Epoch: 17, Steps: 89 | Train Loss: 0.213 Vali Loss: 1.498 Vali Acc: 0.829 Test Loss: 1.498 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.630749225616455
Epoch: 18, Steps: 89 | Train Loss: 0.136 Vali Loss: 1.413 Vali Acc: 0.852 Test Loss: 1.413 Test Acc: 0.852
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 22.022770643234253
Epoch: 19, Steps: 89 | Train Loss: 0.184 Vali Loss: 2.745 Vali Acc: 0.824 Test Loss: 2.745 Test Acc: 0.824
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.384692907333374
Epoch: 20, Steps: 89 | Train Loss: 0.173 Vali Loss: 1.656 Vali Acc: 0.837 Test Loss: 1.656 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 23.153726816177368
Epoch: 21, Steps: 89 | Train Loss: 0.284 Vali Loss: 1.015 Vali Acc: 0.898 Test Loss: 1.015 Test Acc: 0.898
Validation loss decreased (-0.896226 --> -0.898319).  Saving model ...
Epoch: 22 cost time: 23.22412347793579
Epoch: 22, Steps: 89 | Train Loss: 0.162 Vali Loss: 1.052 Vali Acc: 0.894 Test Loss: 1.052 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.16984534263611
Epoch: 23, Steps: 89 | Train Loss: 0.224 Vali Loss: 1.433 Vali Acc: 0.865 Test Loss: 1.433 Test Acc: 0.865
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 23.141170501708984
Epoch: 24, Steps: 89 | Train Loss: 0.196 Vali Loss: 1.205 Vali Acc: 0.908 Test Loss: 1.205 Test Acc: 0.908
Validation loss decreased (-0.898319 --> -0.908066).  Saving model ...
Epoch: 25 cost time: 22.84277629852295
Epoch: 25, Steps: 89 | Train Loss: 0.255 Vali Loss: 1.892 Vali Acc: 0.855 Test Loss: 1.892 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.962769985198975
Epoch: 26, Steps: 89 | Train Loss: 0.345 Vali Loss: 1.867 Vali Acc: 0.873 Test Loss: 1.867 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 23.242388010025024
Epoch: 27, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.939 Vali Acc: 0.919 Test Loss: 0.939 Test Acc: 0.919
Validation loss decreased (-0.908066 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 23.155154943466187
Epoch: 28, Steps: 89 | Train Loss: 0.344 Vali Loss: 1.258 Vali Acc: 0.899 Test Loss: 1.258 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 25.419509172439575
Epoch: 29, Steps: 89 | Train Loss: 0.285 Vali Loss: 1.293 Vali Acc: 0.907 Test Loss: 1.293 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 27.08709406852722
Epoch: 30, Steps: 89 | Train Loss: 0.260 Vali Loss: 1.698 Vali Acc: 0.880 Test Loss: 1.698 Test Acc: 0.880
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 24.17641043663025
Epoch: 31, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.989 Vali Acc: 0.916 Test Loss: 0.989 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 26.14092206954956
Epoch: 32, Steps: 89 | Train Loss: 0.231 Vali Loss: 1.326 Vali Acc: 0.903 Test Loss: 1.326 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 25.08638048171997
Epoch: 33, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.845 Vali Acc: 0.949 Test Loss: 0.845 Test Acc: 0.949
Validation loss decreased (-0.918514 --> -0.949156).  Saving model ...
Epoch: 34 cost time: 22.904943466186523
Epoch: 34, Steps: 89 | Train Loss: 0.156 Vali Loss: 1.311 Vali Acc: 0.918 Test Loss: 1.311 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 22.3318989276886
Epoch: 35, Steps: 89 | Train Loss: 0.164 Vali Loss: 2.165 Vali Acc: 0.885 Test Loss: 2.165 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 24.057525873184204
Epoch: 36, Steps: 89 | Train Loss: 0.237 Vali Loss: 1.248 Vali Acc: 0.915 Test Loss: 1.248 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 23.17964267730713
Epoch: 37, Steps: 89 | Train Loss: 0.143 Vali Loss: 1.342 Vali Acc: 0.916 Test Loss: 1.342 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 24.099806308746338
Epoch: 38, Steps: 89 | Train Loss: 0.130 Vali Loss: 1.717 Vali Acc: 0.903 Test Loss: 1.717 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 22.896437168121338
Epoch: 39, Steps: 89 | Train Loss: 0.150 Vali Loss: 1.122 Vali Acc: 0.923 Test Loss: 1.122 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 24.495126724243164
Epoch: 40, Steps: 89 | Train Loss: 0.223 Vali Loss: 1.448 Vali Acc: 0.921 Test Loss: 1.448 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 23.27689266204834
Epoch: 41, Steps: 89 | Train Loss: 0.201 Vali Loss: 1.045 Vali Acc: 0.939 Test Loss: 1.045 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 22.421858072280884
Epoch: 42, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.859 Vali Acc: 0.944 Test Loss: 0.859 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 23.235316514968872
Epoch: 43, Steps: 89 | Train Loss: 0.151 Vali Loss: 1.440 Vali Acc: 0.930 Test Loss: 1.440 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9491643454038997
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.391213417053223
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (inf --> -0.064733).  Saving model ...
Epoch: 2 cost time: 23.45077896118164
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 25.37911629676819
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 25.144973754882812
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 25.77731680870056
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 22.24807906150818
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 23.535895586013794
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 23.082605600357056
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 22.240527391433716
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 22.788411140441895
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 24.396483898162842
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 24.937121152877808
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 24.07953429222107
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 23.107019186019897
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 25.27422571182251
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 24.33659267425537
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 25.215789318084717
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 24.42944598197937
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.712321281433105
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 25.678990364074707
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 23.95281958580017
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 21.98044204711914
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 23.268794059753418
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 23.698259353637695
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 23.165977478027344
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 21.734784841537476
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 24.300557136535645
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 24.07778811454773
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 24.429834604263306
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 24.47852611541748
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 24.60626769065857
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 25.954802751541138
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 23.851296424865723
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 23.68349313735962
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.804199934005737
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 22.966576099395752
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 22.863510370254517
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 25.208245277404785
Epoch: 38, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 23.032428979873657
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 21.433090448379517
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 23.77520489692688
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 23.650388479232788
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 22.15352153778076
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 22.26461148262024
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 24.957340955734253
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 23.933675289154053
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 21.935198545455933
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 23.264135360717773
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 24.751739025115967
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 24.149744033813477
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 25.064186334609985
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 25.78289532661438
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 23.728009462356567
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 21.85584306716919
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 55 cost time: 23.19999647140503
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 22.568490982055664
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 21.798489093780518
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 24.10908579826355
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 25.853361129760742
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 23.91364860534668
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 23.73491406440735
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 24.501365661621094
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 23.878259897232056
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 24.808250427246094
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 25.6104736328125
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 66 cost time: 25.766664505004883
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 23.617121696472168
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 68 cost time: 22.178298711776733
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 24.259992837905884
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 22.05063557624817
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 24.35668110847473
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 24.73967981338501
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 73 cost time: 24.43271565437317
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 24.09711790084839
Epoch: 74, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 75 cost time: 26.154215812683105
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 24.352188110351562
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 21.87392544746399
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 23.85234022140503
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 23.257725954055786
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 23.084131717681885
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 21.910777807235718
Epoch: 81, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 25.57709050178528
Epoch: 82, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 25.181291580200195
Epoch: 83, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 21.383431673049927
Epoch: 84, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 3764756
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.55316662788391
Epoch: 1, Steps: 89 | Train Loss: 1.175 Vali Loss: 0.411 Vali Acc: 0.878 Test Loss: 0.411 Test Acc: 0.878
Validation loss decreased (inf --> -0.878130).  Saving model ...
Epoch: 2 cost time: 24.814996004104614
Epoch: 2, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.292 Vali Acc: 0.918 Test Loss: 0.292 Test Acc: 0.918
Validation loss decreased (-0.878130 --> -0.917824).  Saving model ...
Epoch: 3 cost time: 25.405313730239868
Epoch: 3, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.917824 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 25.6977858543396
Epoch: 4, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.467 Vali Acc: 0.886 Test Loss: 0.467 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.98873209953308
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.78388285636902
Epoch: 6, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.370 Vali Acc: 0.926 Test Loss: 0.370 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.69745445251465
Epoch: 7, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.368 Vali Acc: 0.932 Test Loss: 0.368 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.9706027507782
Epoch: 8, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.506 Vali Acc: 0.919 Test Loss: 0.506 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 25.22296118736267
Epoch: 9, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.362 Vali Acc: 0.938 Test Loss: 0.362 Test Acc: 0.938
Validation loss decreased (-0.933145 --> -0.938019).  Saving model ...
Epoch: 10 cost time: 25.544768571853638
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.332 Vali Acc: 0.952 Test Loss: 0.332 Test Acc: 0.952
Validation loss decreased (-0.938019 --> -0.951947).  Saving model ...
Epoch: 11 cost time: 26.629417657852173
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.334 Vali Acc: 0.952 Test Loss: 0.334 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.544557809829712
Epoch: 12, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.543 Vali Acc: 0.930 Test Loss: 0.543 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 24.752660274505615
Epoch: 13, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.51116180419922
Epoch: 14, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.715 Vali Acc: 0.921 Test Loss: 0.715 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.48589539527893
Epoch: 15, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.548 Vali Acc: 0.927 Test Loss: 0.548 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 25.729714393615723
Epoch: 16, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.523 Vali Acc: 0.931 Test Loss: 0.523 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 26.254156589508057
Epoch: 17, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.489 Vali Acc: 0.940 Test Loss: 0.489 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 25.896477699279785
Epoch: 18, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.403 Vali Acc: 0.957 Test Loss: 0.403 Test Acc: 0.957
Validation loss decreased (-0.951947 --> -0.956820).  Saving model ...
Epoch: 19 cost time: 24.614066123962402
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.601 Vali Acc: 0.939 Test Loss: 0.601 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 24.86359167098999
Epoch: 20, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.565 Vali Acc: 0.943 Test Loss: 0.565 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.574484825134277
Epoch: 21, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.541 Vali Acc: 0.938 Test Loss: 0.541 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.11818838119507
Epoch: 22, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.593 Vali Acc: 0.936 Test Loss: 0.593 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 25.810607194900513
Epoch: 23, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.550 Vali Acc: 0.942 Test Loss: 0.550 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 26.192610025405884
Epoch: 24, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.740 Vali Acc: 0.940 Test Loss: 0.740 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 23.327286958694458
Epoch: 25, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.566 Vali Acc: 0.946 Test Loss: 0.566 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 23.31049609184265
Epoch: 26, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.649 Vali Acc: 0.938 Test Loss: 0.649 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 25.901981830596924
Epoch: 27, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.701 Vali Acc: 0.930 Test Loss: 0.701 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 26.10611128807068
Epoch: 28, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.454 Vali Acc: 0.958 Test Loss: 0.454 Test Acc: 0.958
Validation loss decreased (-0.956820 --> -0.957516).  Saving model ...
Epoch: 29 cost time: 24.25755548477173
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.546 Vali Acc: 0.955 Test Loss: 0.546 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 26.480995655059814
Epoch: 30, Steps: 89 | Train Loss: 0.105 Vali Loss: 1.076 Vali Acc: 0.918 Test Loss: 1.076 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 24.915687561035156
Epoch: 31, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.656 Vali Acc: 0.946 Test Loss: 0.656 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 23.81264567375183
Epoch: 32, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.571 Vali Acc: 0.954 Test Loss: 0.571 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 23.764443397521973
Epoch: 33, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.565 Vali Acc: 0.949 Test Loss: 0.565 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 21.701353073120117
Epoch: 34, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.605 Vali Acc: 0.951 Test Loss: 0.605 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 24.657267093658447
Epoch: 35, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.569 Vali Acc: 0.949 Test Loss: 0.569 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 26.418937921524048
Epoch: 36, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.697 Vali Acc: 0.932 Test Loss: 0.697 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 23.838189125061035
Epoch: 37, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.588 Vali Acc: 0.944 Test Loss: 0.588 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 20.743871688842773
Epoch: 38, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.657 Vali Acc: 0.938 Test Loss: 0.657 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.77738118171692
Epoch: 1, Steps: 89 | Train Loss: 1.243 Vali Loss: 0.488 Vali Acc: 0.854 Test Loss: 0.488 Test Acc: 0.854
Validation loss decreased (inf --> -0.854452).  Saving model ...
Epoch: 2 cost time: 26.53307604789734
Epoch: 2, Steps: 89 | Train Loss: 0.409 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
Validation loss decreased (-0.854452 --> -0.890665).  Saving model ...
Epoch: 3 cost time: 25.962077617645264
Epoch: 3, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.270 Vali Acc: 0.921 Test Loss: 0.270 Test Acc: 0.921
Validation loss decreased (-0.890665 --> -0.921306).  Saving model ...
Epoch: 4 cost time: 26.6267032623291
Epoch: 4, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.327 Vali Acc: 0.917 Test Loss: 0.327 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.18667435646057
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.340 Vali Acc: 0.920 Test Loss: 0.340 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.2584331035614
Epoch: 6, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
Validation loss decreased (-0.921306 --> -0.948465).  Saving model ...
Epoch: 7 cost time: 22.034312963485718
Epoch: 7, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.524 Vali Acc: 0.896 Test Loss: 0.524 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.292606592178345
Epoch: 8, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.341 Vali Acc: 0.942 Test Loss: 0.341 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.854331254959106
Epoch: 9, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.376 Vali Acc: 0.934 Test Loss: 0.376 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.721495628356934
Epoch: 10, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.400 Vali Acc: 0.930 Test Loss: 0.400 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.543742418289185
Epoch: 11, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.385 Vali Acc: 0.935 Test Loss: 0.385 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 23.12470316886902
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.706 Vali Acc: 0.903 Test Loss: 0.706 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.60423493385315
Epoch: 13, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.381 Vali Acc: 0.936 Test Loss: 0.381 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 22.8831148147583
Epoch: 14, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.416 Vali Acc: 0.944 Test Loss: 0.416 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 24.915436506271362
Epoch: 15, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.392 Vali Acc: 0.942 Test Loss: 0.392 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 27.836411237716675
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.540 Vali Acc: 0.938 Test Loss: 0.540 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9484679665738162
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.49391460418701
Epoch: 1, Steps: 89 | Train Loss: 1.340 Vali Loss: 0.611 Vali Acc: 0.825 Test Loss: 0.611 Test Acc: 0.825
Validation loss decreased (inf --> -0.824506).  Saving model ...
Epoch: 2 cost time: 24.92670774459839
Epoch: 2, Steps: 89 | Train Loss: 0.436 Vali Loss: 0.394 Vali Acc: 0.886 Test Loss: 0.394 Test Acc: 0.886
Validation loss decreased (-0.824506 --> -0.886486).  Saving model ...
Epoch: 3 cost time: 27.125498294830322
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.292 Vali Acc: 0.928 Test Loss: 0.292 Test Acc: 0.928
Validation loss decreased (-0.886486 --> -0.928270).  Saving model ...
Epoch: 4 cost time: 25.296865940093994
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.363 Vali Acc: 0.909 Test Loss: 0.363 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.79789686203003
Epoch: 5, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.385 Vali Acc: 0.915 Test Loss: 0.385 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.365970134735107
Epoch: 6, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.476 Vali Acc: 0.907 Test Loss: 0.476 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.544620513916016
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.627244234085083
Epoch: 8, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.665220022201538
Epoch: 9, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.540 Vali Acc: 0.914 Test Loss: 0.540 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 23.423954248428345
Epoch: 10, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.635 Vali Acc: 0.911 Test Loss: 0.635 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.784891605377197
Epoch: 11, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.681 Vali Acc: 0.901 Test Loss: 0.681 Test Acc: 0.901
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 24.974379539489746
Epoch: 12, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 26.263737440109253
Epoch: 13, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.451 Vali Acc: 0.932 Test Loss: 0.451 Test Acc: 0.932
Validation loss decreased (-0.928270 --> -0.932447).  Saving model ...
Epoch: 14 cost time: 27.51667881011963
Epoch: 14, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.539 Vali Acc: 0.937 Test Loss: 0.539 Test Acc: 0.937
Validation loss decreased (-0.932447 --> -0.937321).  Saving model ...
Epoch: 15 cost time: 24.633763074874878
Epoch: 15, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.565 Vali Acc: 0.911 Test Loss: 0.565 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 25.23161506652832
Epoch: 16, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.555 Vali Acc: 0.937 Test Loss: 0.555 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 26.01148533821106
Epoch: 17, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.491 Vali Acc: 0.937 Test Loss: 0.491 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 26.680749893188477
Epoch: 18, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.651 Vali Acc: 0.930 Test Loss: 0.651 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 25.957686185836792
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.513 Vali Acc: 0.944 Test Loss: 0.513 Test Acc: 0.944
Validation loss decreased (-0.937321 --> -0.943588).  Saving model ...
Epoch: 20 cost time: 24.953263521194458
Epoch: 20, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.708 Vali Acc: 0.914 Test Loss: 0.708 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 23.65168595314026
Epoch: 21, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.483 Vali Acc: 0.940 Test Loss: 0.483 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 24.120661973953247
Epoch: 22, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.551 Vali Acc: 0.946 Test Loss: 0.551 Test Acc: 0.946
Validation loss decreased (-0.943588 --> -0.945677).  Saving model ...
Epoch: 23 cost time: 23.932245016098022
Epoch: 23, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.515 Vali Acc: 0.939 Test Loss: 0.515 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 23.70202398300171
Epoch: 24, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.545 Vali Acc: 0.942 Test Loss: 0.545 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 25.715183973312378
Epoch: 25, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.565 Vali Acc: 0.945 Test Loss: 0.565 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 24.280842542648315
Epoch: 26, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.524 Vali Acc: 0.951 Test Loss: 0.524 Test Acc: 0.951
Validation loss decreased (-0.945677 --> -0.951248).  Saving model ...
Epoch: 27 cost time: 24.083892583847046
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.580 Vali Acc: 0.947 Test Loss: 0.580 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 26.225008487701416
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.494 Vali Acc: 0.953 Test Loss: 0.494 Test Acc: 0.953
Validation loss decreased (-0.951248 --> -0.952641).  Saving model ...
Epoch: 29 cost time: 26.89688277244568
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.513 Vali Acc: 0.948 Test Loss: 0.513 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 25.828954696655273
Epoch: 30, Steps: 89 | Train Loss: 0.092 Vali Loss: 1.005 Vali Acc: 0.908 Test Loss: 1.005 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 24.339867115020752
Epoch: 31, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.596 Vali Acc: 0.943 Test Loss: 0.596 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 26.310123205184937
Epoch: 32, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.626 Vali Acc: 0.948 Test Loss: 0.626 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 25.546597719192505
Epoch: 33, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.699 Vali Acc: 0.937 Test Loss: 0.699 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 24.359260320663452
Epoch: 34, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.618 Vali Acc: 0.943 Test Loss: 0.618 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 26.43574285507202
Epoch: 35, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.716 Vali Acc: 0.944 Test Loss: 0.716 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 27.293647050857544
Epoch: 36, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.483 Vali Acc: 0.949 Test Loss: 0.483 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 25.58492350578308
Epoch: 37, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.581 Vali Acc: 0.953 Test Loss: 0.581 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 26.18390440940857
Epoch: 38, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.575 Vali Acc: 0.949 Test Loss: 0.575 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9526462395543176
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.83674907684326
Epoch: 1, Steps: 89 | Train Loss: 1.642 Vali Loss: 0.792 Vali Acc: 0.781 Test Loss: 0.792 Test Acc: 0.781
Validation loss decreased (inf --> -0.780633).  Saving model ...
Epoch: 2 cost time: 26.451441287994385
Epoch: 2, Steps: 89 | Train Loss: 0.474 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
Validation loss decreased (-0.780633 --> -0.889272).  Saving model ...
Epoch: 3 cost time: 27.211907148361206
Epoch: 3, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.393 Vali Acc: 0.887 Test Loss: 0.393 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.1386878490448
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.393 Vali Acc: 0.911 Test Loss: 0.393 Test Acc: 0.911
Validation loss decreased (-0.889272 --> -0.910860).  Saving model ...
Epoch: 5 cost time: 24.661870002746582
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.423 Vali Acc: 0.917 Test Loss: 0.423 Test Acc: 0.917
Validation loss decreased (-0.910860 --> -0.917127).  Saving model ...
Epoch: 6 cost time: 26.98068594932556
Epoch: 6, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.362 Vali Acc: 0.930 Test Loss: 0.362 Test Acc: 0.930
Validation loss decreased (-0.917127 --> -0.929662).  Saving model ...
Epoch: 7 cost time: 27.924508094787598
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.319 Vali Acc: 0.944 Test Loss: 0.319 Test Acc: 0.944
Validation loss decreased (-0.929662 --> -0.943590).  Saving model ...
Epoch: 8 cost time: 26.273919343948364
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.399 Vali Acc: 0.921 Test Loss: 0.399 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.339309453964233
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.346 Vali Acc: 0.929 Test Loss: 0.346 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.305904865264893
Epoch: 10, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.404 Vali Acc: 0.921 Test Loss: 0.404 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 26.473700761795044
Epoch: 11, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.379 Vali Acc: 0.936 Test Loss: 0.379 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 26.63715672492981
Epoch: 12, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.380 Vali Acc: 0.938 Test Loss: 0.380 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 26.69275712966919
Epoch: 13, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.414 Vali Acc: 0.940 Test Loss: 0.414 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 25.39564323425293
Epoch: 14, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.554 Vali Acc: 0.921 Test Loss: 0.554 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 25.784008741378784
Epoch: 15, Steps: 89 | Train Loss: 0.193 Vali Loss: 1.115 Vali Acc: 0.876 Test Loss: 1.115 Test Acc: 0.876
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 27.575281858444214
Epoch: 16, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.448 Vali Acc: 0.940 Test Loss: 0.448 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 23.379236221313477
Epoch: 17, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.579 Vali Acc: 0.937 Test Loss: 0.579 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9435933147632312
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.114356756210327
Epoch: 1, Steps: 89 | Train Loss: 2.165 Vali Loss: 1.259 Vali Acc: 0.611 Test Loss: 1.259 Test Acc: 0.611
Validation loss decreased (inf --> -0.611408).  Saving model ...
Epoch: 2 cost time: 27.305480241775513
Epoch: 2, Steps: 89 | Train Loss: 0.632 Vali Loss: 0.417 Vali Acc: 0.878 Test Loss: 0.417 Test Acc: 0.878
Validation loss decreased (-0.611408 --> -0.878130).  Saving model ...
Epoch: 3 cost time: 25.929171085357666
Epoch: 3, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.280 Vali Acc: 0.921 Test Loss: 0.280 Test Acc: 0.921
Validation loss decreased (-0.878130 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 27.409940481185913
Epoch: 4, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.59123158454895
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.255 Vali Acc: 0.947 Test Loss: 0.255 Test Acc: 0.947
Validation loss decreased (-0.920610 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 27.055787801742554
Epoch: 6, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.68485140800476
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.826274871826172
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.427 Vali Acc: 0.914 Test Loss: 0.427 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 27.516741037368774
Epoch: 9, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.390 Vali Acc: 0.932 Test Loss: 0.390 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 27.477294206619263
Epoch: 10, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
Validation loss decreased (-0.947073 --> -0.950555).  Saving model ...
Epoch: 11 cost time: 25.417171001434326
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.438 Vali Acc: 0.932 Test Loss: 0.438 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.201932668685913
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.586 Vali Acc: 0.908 Test Loss: 0.586 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 27.5877046585083
Epoch: 13, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.450 Vali Acc: 0.935 Test Loss: 0.450 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.766569137573242
Epoch: 14, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.423 Vali Acc: 0.935 Test Loss: 0.423 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 24.079187154769897
Epoch: 15, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.720 Vali Acc: 0.921 Test Loss: 0.720 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 25.47333002090454
Epoch: 16, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.389 Vali Acc: 0.955 Test Loss: 0.389 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.955428).  Saving model ...
Epoch: 17 cost time: 27.39438223838806
Epoch: 17, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.314 Vali Acc: 0.955 Test Loss: 0.314 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.19273805618286
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.322 Vali Acc: 0.960 Test Loss: 0.322 Test Acc: 0.960
Validation loss decreased (-0.955428 --> -0.959607).  Saving model ...
Epoch: 19 cost time: 25.612913846969604
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.516 Vali Acc: 0.939 Test Loss: 0.516 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 24.71766710281372
Epoch: 20, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.369 Vali Acc: 0.956 Test Loss: 0.369 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 25.960739374160767
Epoch: 21, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.560 Vali Acc: 0.928 Test Loss: 0.560 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 26.359404802322388
Epoch: 22, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.534 Vali Acc: 0.939 Test Loss: 0.534 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 25.94792628288269
Epoch: 23, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.469 Vali Acc: 0.948 Test Loss: 0.469 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 25.05134868621826
Epoch: 24, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.507 Vali Acc: 0.945 Test Loss: 0.507 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 24.67874574661255
Epoch: 25, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.692 Vali Acc: 0.927 Test Loss: 0.692 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 27.230480194091797
Epoch: 26, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.472 Vali Acc: 0.952 Test Loss: 0.472 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 26.101133108139038
Epoch: 27, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.444 Vali Acc: 0.955 Test Loss: 0.444 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 25.43870997428894
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.414 Vali Acc: 0.960 Test Loss: 0.414 Test Acc: 0.960
Validation loss decreased (-0.959607 --> -0.960302).  Saving model ...
Epoch: 29 cost time: 25.474939107894897
Epoch: 29, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.439 Vali Acc: 0.960 Test Loss: 0.439 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 26.611464023590088
Epoch: 30, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.524 Vali Acc: 0.951 Test Loss: 0.524 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 26.313678979873657
Epoch: 31, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.424 Vali Acc: 0.955 Test Loss: 0.424 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 25.653173446655273
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.399 Vali Acc: 0.965 Test Loss: 0.399 Test Acc: 0.965
Validation loss decreased (-0.960302 --> -0.965177).  Saving model ...
Epoch: 33 cost time: 25.071618795394897
Epoch: 33, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.398 Vali Acc: 0.958 Test Loss: 0.398 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 27.14551091194153
Epoch: 34, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.517 Vali Acc: 0.955 Test Loss: 0.517 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 26.37168288230896
Epoch: 35, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.547 Vali Acc: 0.948 Test Loss: 0.547 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.181125164031982
Epoch: 36, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.454 Vali Acc: 0.960 Test Loss: 0.454 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 26.457608699798584
Epoch: 37, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.388 Vali Acc: 0.965 Test Loss: 0.388 Test Acc: 0.965
Validation loss decreased (-0.965177 --> -0.965177).  Saving model ...
Epoch: 38 cost time: 27.264147520065308
Epoch: 38, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.487 Vali Acc: 0.959 Test Loss: 0.487 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 26.922914266586304
Epoch: 39, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.413 Vali Acc: 0.963 Test Loss: 0.413 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 25.534914255142212
Epoch: 40, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.582 Vali Acc: 0.950 Test Loss: 0.582 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 26.439351320266724
Epoch: 41, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.552 Vali Acc: 0.944 Test Loss: 0.552 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 27.032657146453857
Epoch: 42, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.654 Vali Acc: 0.938 Test Loss: 0.654 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 26.29642105102539
Epoch: 43, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.953 Test Loss: 0.514 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 24.416028261184692
Epoch: 44, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.471 Vali Acc: 0.958 Test Loss: 0.471 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 27.140581607818604
Epoch: 45, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.595 Vali Acc: 0.958 Test Loss: 0.595 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 26.203365325927734
Epoch: 46, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.504 Vali Acc: 0.962 Test Loss: 0.504 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 24.766239643096924
Epoch: 47, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.634 Vali Acc: 0.954 Test Loss: 0.634 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.715640783309937
Epoch: 1, Steps: 89 | Train Loss: 2.185 Vali Loss: 1.465 Vali Acc: 0.529 Test Loss: 1.465 Test Acc: 0.529
Validation loss decreased (inf --> -0.528537).  Saving model ...
Epoch: 2 cost time: 25.282293558120728
Epoch: 2, Steps: 89 | Train Loss: 0.629 Vali Loss: 0.430 Vali Acc: 0.868 Test Loss: 0.430 Test Acc: 0.868
Validation loss decreased (-0.528537 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 26.46114993095398
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.868380 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 26.710958003997803
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.572067975997925
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.197 Vali Acc: 0.947 Test Loss: 0.197 Test Acc: 0.947
Validation loss decreased (-0.942895 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 24.66432285308838
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.26940131187439
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 27.24012327194214
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.431 Vali Acc: 0.924 Test Loss: 0.431 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 25.516204357147217
Epoch: 9, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 26.278535842895508
Epoch: 10, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.334 Vali Acc: 0.937 Test Loss: 0.334 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 27.023796319961548
Epoch: 11, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.625 Vali Acc: 0.909 Test Loss: 0.625 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 27.387988805770874
Epoch: 12, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.487 Vali Acc: 0.923 Test Loss: 0.487 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.619384050369263
Epoch: 13, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.293 Vali Acc: 0.960 Test Loss: 0.293 Test Acc: 0.960
Validation loss decreased (-0.947073 --> -0.960303).  Saving model ...
Epoch: 14 cost time: 26.045526027679443
Epoch: 14, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.345 Vali Acc: 0.949 Test Loss: 0.345 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 27.760751008987427
Epoch: 15, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.556 Vali Acc: 0.927 Test Loss: 0.556 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.37515377998352
Epoch: 16, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.380 Vali Acc: 0.958 Test Loss: 0.380 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 26.41205644607544
Epoch: 17, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.475 Vali Acc: 0.944 Test Loss: 0.475 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.93362021446228
Epoch: 18, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.334 Vali Acc: 0.961 Test Loss: 0.334 Test Acc: 0.961
Validation loss decreased (-0.960303 --> -0.960999).  Saving model ...
Epoch: 19 cost time: 25.746105909347534
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.506 Vali Acc: 0.937 Test Loss: 0.506 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 26.21853756904602
Epoch: 20, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.367 Vali Acc: 0.959 Test Loss: 0.367 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 27.127290964126587
Epoch: 21, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.466 Vali Acc: 0.948 Test Loss: 0.466 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.7286217212677
Epoch: 22, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.474 Vali Acc: 0.951 Test Loss: 0.474 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.860583543777466
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.380 Vali Acc: 0.957 Test Loss: 0.380 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 27.18689513206482
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.518 Vali Acc: 0.944 Test Loss: 0.518 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 23.698846578598022
Epoch: 25, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.357 Vali Acc: 0.955 Test Loss: 0.357 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 23.675647497177124
Epoch: 26, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 25.113701343536377
Epoch: 27, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.363 Vali Acc: 0.964 Test Loss: 0.363 Test Acc: 0.964
Validation loss decreased (-0.960999 --> -0.964481).  Saving model ...
Epoch: 28 cost time: 25.67254662513733
Epoch: 28, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.668 Vali Acc: 0.929 Test Loss: 0.668 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 24.540233850479126
Epoch: 29, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.423 Vali Acc: 0.954 Test Loss: 0.423 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 24.297887086868286
Epoch: 30, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.616 Vali Acc: 0.942 Test Loss: 0.616 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 26.82259750366211
Epoch: 31, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.397 Vali Acc: 0.951 Test Loss: 0.397 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 25.27616024017334
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.287 Vali Acc: 0.969 Test Loss: 0.287 Test Acc: 0.969
Validation loss decreased (-0.964481 --> -0.969356).  Saving model ...
Epoch: 33 cost time: 25.762195587158203
Epoch: 33, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.395 Vali Acc: 0.957 Test Loss: 0.395 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 26.163082599639893
Epoch: 34, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.350 Vali Acc: 0.961 Test Loss: 0.350 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 25.146994590759277
Epoch: 35, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.352 Vali Acc: 0.961 Test Loss: 0.352 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 26.510444164276123
Epoch: 36, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.360 Vali Acc: 0.961 Test Loss: 0.360 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 25.37714195251465
Epoch: 37, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.391 Vali Acc: 0.963 Test Loss: 0.391 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 26.735849380493164
Epoch: 38, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.392 Vali Acc: 0.962 Test Loss: 0.392 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 25.777451276779175
Epoch: 39, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.383 Vali Acc: 0.964 Test Loss: 0.383 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 26.36040449142456
Epoch: 40, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.424 Vali Acc: 0.958 Test Loss: 0.424 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 26.562644481658936
Epoch: 41, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.431 Vali Acc: 0.962 Test Loss: 0.431 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 24.28954768180847
Epoch: 42, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.413 Vali Acc: 0.965 Test Loss: 0.413 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.84603261947632
Epoch: 1, Steps: 89 | Train Loss: 2.162 Vali Loss: 1.404 Vali Acc: 0.561 Test Loss: 1.404 Test Acc: 0.561
Validation loss decreased (inf --> -0.560571).  Saving model ...
Epoch: 2 cost time: 24.81419849395752
Epoch: 2, Steps: 89 | Train Loss: 0.621 Vali Loss: 0.550 Vali Acc: 0.853 Test Loss: 0.550 Test Acc: 0.853
Validation loss decreased (-0.560571 --> -0.853059).  Saving model ...
Epoch: 3 cost time: 26.209300994873047
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.310 Vali Acc: 0.905 Test Loss: 0.310 Test Acc: 0.905
Validation loss decreased (-0.853059 --> -0.904593).  Saving model ...
Epoch: 4 cost time: 24.270299196243286
Epoch: 4, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.216 Vali Acc: 0.934 Test Loss: 0.216 Test Acc: 0.934
Validation loss decreased (-0.904593 --> -0.933842).  Saving model ...
Epoch: 5 cost time: 25.09830093383789
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
Validation loss decreased (-0.933842 --> -0.934538).  Saving model ...
Epoch: 6 cost time: 25.236209392547607
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.934538 --> -0.943591).  Saving model ...
Epoch: 7 cost time: 23.77071762084961
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.286 Vali Acc: 0.934 Test Loss: 0.286 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.893388271331787
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.365 Vali Acc: 0.930 Test Loss: 0.365 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.462953805923462
Epoch: 9, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.259 Vali Acc: 0.953 Test Loss: 0.259 Test Acc: 0.953
Validation loss decreased (-0.943591 --> -0.953340).  Saving model ...
Epoch: 10 cost time: 25.46974778175354
Epoch: 10, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.357 Vali Acc: 0.939 Test Loss: 0.357 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.99636697769165
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.339 Vali Acc: 0.945 Test Loss: 0.339 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.08346962928772
Epoch: 12, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.97675657272339
Epoch: 13, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.275 Vali Acc: 0.947 Test Loss: 0.275 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 22.26453447341919
Epoch: 14, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.565 Vali Acc: 0.924 Test Loss: 0.565 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.524420261383057
Epoch: 15, Steps: 89 | Train Loss: 0.184 Vali Loss: 1.068 Vali Acc: 0.870 Test Loss: 1.068 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 23.666278839111328
Epoch: 16, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.398 Vali Acc: 0.955 Test Loss: 0.398 Test Acc: 0.955
Validation loss decreased (-0.953340 --> -0.955428).  Saving model ...
Epoch: 17 cost time: 24.511082410812378
Epoch: 17, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.278 Vali Acc: 0.963 Test Loss: 0.278 Test Acc: 0.963
Validation loss decreased (-0.955428 --> -0.963089).  Saving model ...
Epoch: 18 cost time: 24.456704139709473
Epoch: 18, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.330 Vali Acc: 0.961 Test Loss: 0.330 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 24.78818917274475
Epoch: 19, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.455 Vali Acc: 0.945 Test Loss: 0.455 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 24.80292582511902
Epoch: 20, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.462 Vali Acc: 0.955 Test Loss: 0.462 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.891920566558838
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.284 Vali Acc: 0.961 Test Loss: 0.284 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 22.559927701950073
Epoch: 22, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.321 Vali Acc: 0.959 Test Loss: 0.321 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 25.20429229736328
Epoch: 23, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.453 Vali Acc: 0.956 Test Loss: 0.453 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 23.765470504760742
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.326 Vali Acc: 0.968 Test Loss: 0.326 Test Acc: 0.968
Validation loss decreased (-0.963089 --> -0.967963).  Saving model ...
Epoch: 25 cost time: 23.08041262626648
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.302 Vali Acc: 0.971 Test Loss: 0.302 Test Acc: 0.971
Validation loss decreased (-0.967963 --> -0.971445).  Saving model ...
Epoch: 26 cost time: 25.245640993118286
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 24.63351058959961
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.497 Vali Acc: 0.939 Test Loss: 0.497 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 22.611268043518066
Epoch: 28, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.545 Vali Acc: 0.939 Test Loss: 0.545 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 24.368502616882324
Epoch: 29, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 24.298630475997925
Epoch: 30, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.414 Vali Acc: 0.960 Test Loss: 0.414 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 21.891353130340576
Epoch: 31, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.512 Vali Acc: 0.952 Test Loss: 0.512 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 24.272610425949097
Epoch: 32, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.367 Vali Acc: 0.961 Test Loss: 0.367 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 25.54251003265381
Epoch: 33, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.322 Vali Acc: 0.964 Test Loss: 0.322 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 24.106698513031006
Epoch: 34, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.319 Vali Acc: 0.967 Test Loss: 0.319 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 24.466068267822266
Epoch: 35, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.525 Vali Acc: 0.951 Test Loss: 0.525 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.04948401451111
Epoch: 1, Steps: 89 | Train Loss: 2.195 Vali Loss: 1.495 Vali Acc: 0.546 Test Loss: 1.495 Test Acc: 0.546
Validation loss decreased (inf --> -0.545946).  Saving model ...
Epoch: 2 cost time: 22.81205129623413
Epoch: 2, Steps: 89 | Train Loss: 0.651 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
Validation loss decreased (-0.545946 --> -0.783419).  Saving model ...
Epoch: 3 cost time: 23.816641569137573
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
Validation loss decreased (-0.783419 --> -0.841220).  Saving model ...
Epoch: 4 cost time: 23.59102511405945
Epoch: 4, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.308 Vali Acc: 0.904 Test Loss: 0.308 Test Acc: 0.904
Validation loss decreased (-0.841220 --> -0.903897).  Saving model ...
Epoch: 5 cost time: 22.938941478729248
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.848639011383057
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.395 Vali Acc: 0.903 Test Loss: 0.395 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.657009840011597
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.515 Vali Acc: 0.893 Test Loss: 0.515 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.399499654769897
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.382 Vali Acc: 0.921 Test Loss: 0.382 Test Acc: 0.921
Validation loss decreased (-0.903897 --> -0.920609).  Saving model ...
Epoch: 9 cost time: 22.086203575134277
Epoch: 9, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.304 Vali Acc: 0.946 Test Loss: 0.304 Test Acc: 0.946
Validation loss decreased (-0.920609 --> -0.945679).  Saving model ...
Epoch: 10 cost time: 23.832985401153564
Epoch: 10, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.269 Vali Acc: 0.945 Test Loss: 0.269 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.18643856048584
Epoch: 11, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.318 Vali Acc: 0.942 Test Loss: 0.318 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.30570149421692
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.453 Vali Acc: 0.933 Test Loss: 0.453 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.741263389587402
Epoch: 13, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.301 Vali Acc: 0.947 Test Loss: 0.301 Test Acc: 0.947
Validation loss decreased (-0.945679 --> -0.947072).  Saving model ...
Epoch: 14 cost time: 24.771260261535645
Epoch: 14, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.575 Vali Acc: 0.908 Test Loss: 0.575 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.679240465164185
Epoch: 15, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.775 Vali Acc: 0.908 Test Loss: 0.775 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.408178567886353
Epoch: 16, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.341 Vali Acc: 0.948 Test Loss: 0.341 Test Acc: 0.948
Validation loss decreased (-0.947072 --> -0.948465).  Saving model ...
Epoch: 17 cost time: 25.24390172958374
Epoch: 17, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.450 Vali Acc: 0.948 Test Loss: 0.450 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 21.964038848876953
Epoch: 18, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.407 Vali Acc: 0.946 Test Loss: 0.407 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.852076530456543
Epoch: 19, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.462 Vali Acc: 0.938 Test Loss: 0.462 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 23.545751571655273
Epoch: 20, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.400 Vali Acc: 0.947 Test Loss: 0.400 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 22.54011082649231
Epoch: 21, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.723 Vali Acc: 0.924 Test Loss: 0.723 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 23.606199264526367
Epoch: 22, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.520 Vali Acc: 0.930 Test Loss: 0.520 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 24.683568716049194
Epoch: 23, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.549 Vali Acc: 0.937 Test Loss: 0.549 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 22.82160186767578
Epoch: 24, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.433 Vali Acc: 0.955 Test Loss: 0.433 Test Acc: 0.955
Validation loss decreased (-0.948465 --> -0.954731).  Saving model ...
Epoch: 25 cost time: 22.508880853652954
Epoch: 25, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.311 Vali Acc: 0.965 Test Loss: 0.311 Test Acc: 0.965
Validation loss decreased (-0.954731 --> -0.965178).  Saving model ...
Epoch: 26 cost time: 22.921627283096313
Epoch: 26, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.441 Vali Acc: 0.952 Test Loss: 0.441 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 24.835649728775024
Epoch: 27, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.416 Vali Acc: 0.962 Test Loss: 0.416 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 24.262669563293457
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.605 Vali Acc: 0.936 Test Loss: 0.605 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 23.631616830825806
Epoch: 29, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.503 Vali Acc: 0.935 Test Loss: 0.503 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 25.905179500579834
Epoch: 30, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.568 Vali Acc: 0.944 Test Loss: 0.568 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 24.628085613250732
Epoch: 31, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.430 Vali Acc: 0.957 Test Loss: 0.430 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 23.528900146484375
Epoch: 32, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.402 Vali Acc: 0.964 Test Loss: 0.402 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 24.445363759994507
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.508 Vali Acc: 0.950 Test Loss: 0.508 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 22.608561515808105
Epoch: 34, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.401 Vali Acc: 0.962 Test Loss: 0.401 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 23.36154866218567
Epoch: 35, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.702 Vali Acc: 0.935 Test Loss: 0.702 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.175949573516846
Epoch: 1, Steps: 89 | Train Loss: 2.255 Vali Loss: 1.527 Vali Acc: 0.525 Test Loss: 1.527 Test Acc: 0.525
Validation loss decreased (inf --> -0.525054).  Saving model ...
Epoch: 2 cost time: 23.431222677230835
Epoch: 2, Steps: 89 | Train Loss: 0.695 Vali Loss: 0.674 Vali Acc: 0.781 Test Loss: 0.674 Test Acc: 0.781
Validation loss decreased (-0.525054 --> -0.780634).  Saving model ...
Epoch: 3 cost time: 24.608973503112793
Epoch: 3, Steps: 89 | Train Loss: 0.304 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
Validation loss decreased (-0.780634 --> -0.890665).  Saving model ...
Epoch: 4 cost time: 24.6899151802063
Epoch: 4, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.293 Vali Acc: 0.912 Test Loss: 0.293 Test Acc: 0.912
Validation loss decreased (-0.890665 --> -0.911557).  Saving model ...
Epoch: 5 cost time: 23.28224492073059
Epoch: 5, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
Validation loss decreased (-0.911557 --> -0.917128).  Saving model ...
Epoch: 6 cost time: 23.795513153076172
Epoch: 6, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.407 Vali Acc: 0.907 Test Loss: 0.407 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.86519742012024
Epoch: 7, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.304 Vali Acc: 0.914 Test Loss: 0.304 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.61712908744812
Epoch: 8, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.744 Vali Acc: 0.883 Test Loss: 0.744 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 25.3540780544281
Epoch: 9, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.358 Vali Acc: 0.935 Test Loss: 0.358 Test Acc: 0.935
Validation loss decreased (-0.917128 --> -0.935233).  Saving model ...
Epoch: 10 cost time: 24.69529104232788
Epoch: 10, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.278 Vali Acc: 0.946 Test Loss: 0.278 Test Acc: 0.946
Validation loss decreased (-0.935233 --> -0.945680).  Saving model ...
Epoch: 11 cost time: 24.289063930511475
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.324 Vali Acc: 0.940 Test Loss: 0.324 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.81834840774536
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.383 Vali Acc: 0.942 Test Loss: 0.383 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.29208993911743
Epoch: 13, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.306 Vali Acc: 0.953 Test Loss: 0.306 Test Acc: 0.953
Validation loss decreased (-0.945680 --> -0.952643).  Saving model ...
Epoch: 14 cost time: 23.12883734703064
Epoch: 14, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.337 Vali Acc: 0.948 Test Loss: 0.337 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.11148715019226
Epoch: 15, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.347 Vali Acc: 0.953 Test Loss: 0.347 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 23.06398916244507
Epoch: 16, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.388 Vali Acc: 0.947 Test Loss: 0.388 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 24.040214776992798
Epoch: 17, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.444 Vali Acc: 0.930 Test Loss: 0.444 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.763675689697266
Epoch: 18, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.309 Vali Acc: 0.962 Test Loss: 0.309 Test Acc: 0.962
Validation loss decreased (-0.952643 --> -0.962392).  Saving model ...
Epoch: 19 cost time: 23.23706316947937
Epoch: 19, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.483 Vali Acc: 0.921 Test Loss: 0.483 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 25.602084159851074
Epoch: 20, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.663012742996216
Epoch: 21, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.681 Vali Acc: 0.905 Test Loss: 0.681 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 23.001680374145508
Epoch: 22, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.418 Vali Acc: 0.948 Test Loss: 0.418 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 25.517793893814087
Epoch: 23, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.396 Vali Acc: 0.956 Test Loss: 0.396 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 27.02907395362854
Epoch: 24, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.472 Vali Acc: 0.948 Test Loss: 0.472 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 24.871509552001953
Epoch: 25, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.424 Vali Acc: 0.953 Test Loss: 0.424 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 26.372721195220947
Epoch: 26, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.411 Vali Acc: 0.955 Test Loss: 0.411 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 23.273561239242554
Epoch: 27, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.487 Vali Acc: 0.944 Test Loss: 0.487 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 24.062995433807373
Epoch: 28, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.386 Vali Acc: 0.954 Test Loss: 0.386 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.03499698638916
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.060 Test Loss: 2.996 Test Acc: 0.060
Validation loss decreased (inf --> -0.059859).  Saving model ...
Epoch: 2 cost time: 23.838451623916626
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.059859 --> -0.059859).  Saving model ...
Epoch: 3 cost time: 25.714070796966553
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.059859 --> -0.059859).  Saving model ...
Epoch: 4 cost time: 23.62706685066223
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.061 Test Loss: 2.994 Test Acc: 0.061
Validation loss decreased (-0.059859 --> -0.060555).  Saving model ...
Epoch: 5 cost time: 23.67330312728882
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.061 Test Loss: 2.994 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 6 cost time: 25.78377413749695
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.061 Test Loss: 2.993 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 7 cost time: 25.329735279083252
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.060555 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 23.82841181755066
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 22.924062967300415
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 24.338440418243408
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 24.414613246917725
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 24.82665514945984
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 25.957638025283813
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 25.077444314956665
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 24.478625059127808
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 24.339261770248413
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 24.827982425689697
Epoch: 17, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 25.684253931045532
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.45538306236267
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 24.64934754371643
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 24.22658920288086
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 24.715946912765503
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 24.649877309799194
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 23.24659752845764
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 24.998167753219604
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 26.0580575466156
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 23.40173316001892
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 23.99653196334839
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 24.76477575302124
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 25.155288219451904
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 25.99533176422119
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 25.498058795928955
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 25.422242164611816
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 23.524805784225464
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.798972606658936
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 24.699182748794556
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 23.181387662887573
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 24.797685861587524
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 25.954347133636475
Epoch: 39, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 24.050811052322388
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 23.837263822555542
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 24.40394401550293
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 23.032207250595093
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 24.455387115478516
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 25.850592136383057
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 24.788388967514038
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 23.772385120391846
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 24.921754837036133
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 24.339688777923584
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 23.46346426010132
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 24.302043199539185
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 23.794742584228516
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 23.68051528930664
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 24.557775020599365
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 22.054352045059204
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 22.690317392349243
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 25.39232087135315
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 26.464101791381836
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 24.52645254135132
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 60 cost time: 21.8219256401062
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 23.865442037582397
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 24.615222215652466
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 63 cost time: 24.017792224884033
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 23.749778270721436
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 24.541353702545166
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 24.332597970962524
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 23.68421697616577
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 22.893298387527466
Epoch: 68, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 22.98224425315857
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 70 cost time: 23.603903770446777
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 25.643136262893677
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 23.497913599014282
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 25.251578330993652
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 23.80980944633484
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 24.215501070022583
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 22.06599235534668
Epoch: 76, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 22.66107439994812
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 23.02992582321167
Epoch: 78, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 79 cost time: 23.65431785583496
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 22.60553216934204
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 21.715043783187866
Epoch: 81, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 24.39207911491394
Epoch: 82, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 23.05555534362793
Epoch: 83, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 22.789348602294922
Epoch: 84, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 85 cost time: 22.897114515304565
Epoch: 85, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 23.941049337387085
Epoch: 86, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 21.711525678634644
Epoch: 87, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 21.71163249015808
Epoch: 88, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 22.626203536987305
Epoch: 89, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 22.788044214248657
Epoch: 90, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 21.503909587860107
Epoch: 91, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 19.66100835800171
Epoch: 92, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 20.273019552230835
Epoch: 93, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 19.55522918701172
Epoch: 94, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 2701588
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.393455982208252
Epoch: 1, Steps: 89 | Train Loss: 1.186 Vali Loss: 0.476 Vali Acc: 0.873 Test Loss: 0.476 Test Acc: 0.873
Validation loss decreased (inf --> -0.872558).  Saving model ...
Epoch: 2 cost time: 21.46740436553955
Epoch: 2, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.387 Vali Acc: 0.888 Test Loss: 0.387 Test Acc: 0.888
Validation loss decreased (-0.872558 --> -0.887879).  Saving model ...
Epoch: 3 cost time: 20.837621927261353
Epoch: 3, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.887879 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 20.86928415298462
Epoch: 4, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.96334195137024
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.305 Vali Acc: 0.929 Test Loss: 0.305 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.090526580810547
Epoch: 6, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.419 Vali Acc: 0.907 Test Loss: 0.419 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.575016021728516
Epoch: 7, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.351 Vali Acc: 0.928 Test Loss: 0.351 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 22.241230726242065
Epoch: 8, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.64421582221985
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.624 Vali Acc: 0.918 Test Loss: 0.624 Test Acc: 0.918
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.035691022872925
Epoch: 10, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.411 Vali Acc: 0.932 Test Loss: 0.411 Test Acc: 0.932
Validation loss decreased (-0.929663 --> -0.932447).  Saving model ...
Epoch: 11 cost time: 22.241026163101196
Epoch: 11, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.381 Vali Acc: 0.940 Test Loss: 0.381 Test Acc: 0.940
Validation loss decreased (-0.932447 --> -0.940108).  Saving model ...
Epoch: 12 cost time: 22.87270450592041
Epoch: 12, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.618 Vali Acc: 0.892 Test Loss: 0.618 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.37672233581543
Epoch: 13, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.461 Vali Acc: 0.943 Test Loss: 0.461 Test Acc: 0.943
Validation loss decreased (-0.940108 --> -0.942892).  Saving model ...
Epoch: 14 cost time: 23.5390887260437
Epoch: 14, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.494 Vali Acc: 0.948 Test Loss: 0.494 Test Acc: 0.948
Validation loss decreased (-0.942892 --> -0.947767).  Saving model ...
Epoch: 15 cost time: 23.683874368667603
Epoch: 15, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.475 Vali Acc: 0.946 Test Loss: 0.475 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.251477479934692
Epoch: 16, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.462 Vali Acc: 0.940 Test Loss: 0.462 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.84137487411499
Epoch: 17, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.413 Vali Acc: 0.953 Test Loss: 0.413 Test Acc: 0.953
Validation loss decreased (-0.947767 --> -0.953338).  Saving model ...
Epoch: 18 cost time: 21.93484354019165
Epoch: 18, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.440 Vali Acc: 0.944 Test Loss: 0.440 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.961977243423462
Epoch: 19, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.463 Vali Acc: 0.937 Test Loss: 0.463 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.344298124313354
Epoch: 20, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.505 Vali Acc: 0.949 Test Loss: 0.505 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 21.72398328781128
Epoch: 21, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.703 Vali Acc: 0.949 Test Loss: 0.703 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 21.68765664100647
Epoch: 22, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.532 Vali Acc: 0.946 Test Loss: 0.532 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 20.594682693481445
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.608 Vali Acc: 0.948 Test Loss: 0.608 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 20.50493288040161
Epoch: 24, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.519 Vali Acc: 0.949 Test Loss: 0.519 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 22.506147146224976
Epoch: 25, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.546 Vali Acc: 0.948 Test Loss: 0.546 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 21.586573123931885
Epoch: 26, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.513 Vali Acc: 0.948 Test Loss: 0.513 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 22.911096334457397
Epoch: 27, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.617 Vali Acc: 0.933 Test Loss: 0.617 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.374045610427856
Epoch: 1, Steps: 89 | Train Loss: 1.246 Vali Loss: 0.550 Vali Acc: 0.841 Test Loss: 0.550 Test Acc: 0.841
Validation loss decreased (inf --> -0.840524).  Saving model ...
Epoch: 2 cost time: 22.232438564300537
Epoch: 2, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.413 Vali Acc: 0.874 Test Loss: 0.413 Test Acc: 0.874
Validation loss decreased (-0.840524 --> -0.873951).  Saving model ...
Epoch: 3 cost time: 22.12739896774292
Epoch: 3, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.279 Vali Acc: 0.923 Test Loss: 0.279 Test Acc: 0.923
Validation loss decreased (-0.873951 --> -0.922699).  Saving model ...
Epoch: 4 cost time: 23.672202825546265
Epoch: 4, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.364 Vali Acc: 0.905 Test Loss: 0.364 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.1916606426239
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.922699 --> -0.937324).  Saving model ...
Epoch: 6 cost time: 21.55231475830078
Epoch: 6, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.533 Vali Acc: 0.901 Test Loss: 0.533 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.18344807624817
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.464 Vali Acc: 0.901 Test Loss: 0.464 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.25112009048462
Epoch: 8, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.435 Vali Acc: 0.912 Test Loss: 0.435 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.019691467285156
Epoch: 9, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.560 Vali Acc: 0.906 Test Loss: 0.560 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 21.791221141815186
Epoch: 10, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.23897409439087
Epoch: 11, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.427 Vali Acc: 0.935 Test Loss: 0.427 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 21.87580633163452
Epoch: 12, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.363 Vali Acc: 0.948 Test Loss: 0.363 Test Acc: 0.948
Validation loss decreased (-0.937324 --> -0.948464).  Saving model ...
Epoch: 13 cost time: 21.9129958152771
Epoch: 13, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.503 Vali Acc: 0.930 Test Loss: 0.503 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.775333404541016
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.475 Vali Acc: 0.951 Test Loss: 0.475 Test Acc: 0.951
Validation loss decreased (-0.948464 --> -0.950552).  Saving model ...
Epoch: 15 cost time: 21.668723583221436
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.386 Vali Acc: 0.953 Test Loss: 0.386 Test Acc: 0.953
Validation loss decreased (-0.950552 --> -0.952642).  Saving model ...
Epoch: 16 cost time: 20.792843341827393
Epoch: 16, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.464 Vali Acc: 0.941 Test Loss: 0.464 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.472214460372925
Epoch: 17, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.682 Vali Acc: 0.934 Test Loss: 0.682 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.512638807296753
Epoch: 18, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.465 Vali Acc: 0.953 Test Loss: 0.465 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.67533779144287
Epoch: 19, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.376 Vali Acc: 0.955 Test Loss: 0.376 Test Acc: 0.955
Validation loss decreased (-0.952642 --> -0.955428).  Saving model ...
Epoch: 20 cost time: 22.81320834159851
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.569 Vali Acc: 0.925 Test Loss: 0.569 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 22.530115127563477
Epoch: 21, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.507 Vali Acc: 0.945 Test Loss: 0.507 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 21.005693197250366
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.414 Vali Acc: 0.955 Test Loss: 0.414 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 23.164509057998657
Epoch: 23, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.389 Vali Acc: 0.948 Test Loss: 0.389 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 22.913358449935913
Epoch: 24, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.421 Vali Acc: 0.945 Test Loss: 0.421 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 22.916046142578125
Epoch: 25, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.453 Vali Acc: 0.950 Test Loss: 0.453 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.526225328445435
Epoch: 26, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.576 Vali Acc: 0.943 Test Loss: 0.576 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 22.973617553710938
Epoch: 27, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.490 Vali Acc: 0.946 Test Loss: 0.490 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.629133462905884
Epoch: 28, Steps: 89 | Train Loss: 0.135 Vali Loss: 1.023 Vali Acc: 0.914 Test Loss: 1.023 Test Acc: 0.914
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 23.115379333496094
Epoch: 29, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.397 Vali Acc: 0.964 Test Loss: 0.397 Test Acc: 0.964
Validation loss decreased (-0.955428 --> -0.964481).  Saving model ...
Epoch: 30 cost time: 22.84537386894226
Epoch: 30, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.432 Vali Acc: 0.963 Test Loss: 0.432 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 23.718749523162842
Epoch: 31, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.514 Vali Acc: 0.953 Test Loss: 0.514 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 23.023436784744263
Epoch: 32, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.522 Vali Acc: 0.957 Test Loss: 0.522 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 22.659587383270264
Epoch: 33, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.601 Vali Acc: 0.949 Test Loss: 0.601 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 22.9930100440979
Epoch: 34, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.504 Vali Acc: 0.960 Test Loss: 0.504 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 23.944689989089966
Epoch: 35, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.564 Vali Acc: 0.953 Test Loss: 0.564 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 25.891563653945923
Epoch: 36, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.664 Vali Acc: 0.939 Test Loss: 0.664 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 26.002373695373535
Epoch: 37, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.547 Vali Acc: 0.950 Test Loss: 0.547 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 24.504040002822876
Epoch: 38, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.704 Vali Acc: 0.935 Test Loss: 0.704 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 24.13973641395569
Epoch: 39, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.442 Vali Acc: 0.960 Test Loss: 0.442 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.02364683151245
Epoch: 1, Steps: 89 | Train Loss: 1.341 Vali Loss: 0.609 Vali Acc: 0.822 Test Loss: 0.609 Test Acc: 0.822
Validation loss decreased (inf --> -0.822417).  Saving model ...
Epoch: 2 cost time: 25.506330251693726
Epoch: 2, Steps: 89 | Train Loss: 0.455 Vali Loss: 0.501 Vali Acc: 0.845 Test Loss: 0.501 Test Acc: 0.845
Validation loss decreased (-0.822417 --> -0.844703).  Saving model ...
Epoch: 3 cost time: 26.412500858306885
Epoch: 3, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.323 Vali Acc: 0.912 Test Loss: 0.323 Test Acc: 0.912
Validation loss decreased (-0.844703 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 24.378506183624268
Epoch: 4, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.444 Vali Acc: 0.893 Test Loss: 0.444 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.7183735370636
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.297 Vali Acc: 0.931 Test Loss: 0.297 Test Acc: 0.931
Validation loss decreased (-0.912253 --> -0.931056).  Saving model ...
Epoch: 6 cost time: 24.58087944984436
Epoch: 6, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.600 Vali Acc: 0.890 Test Loss: 0.600 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.96351194381714
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.338 Vali Acc: 0.936 Test Loss: 0.338 Test Acc: 0.936
Validation loss decreased (-0.931056 --> -0.935930).  Saving model ...
Epoch: 8 cost time: 23.46035599708557
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.781 Vali Acc: 0.874 Test Loss: 0.781 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.918670415878296
Epoch: 9, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.642 Vali Acc: 0.905 Test Loss: 0.642 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.060590982437134
Epoch: 10, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.379 Vali Acc: 0.947 Test Loss: 0.379 Test Acc: 0.947
Validation loss decreased (-0.935930 --> -0.947071).  Saving model ...
Epoch: 11 cost time: 22.511641263961792
Epoch: 11, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.467 Vali Acc: 0.910 Test Loss: 0.467 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.39264225959778
Epoch: 12, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.488 Vali Acc: 0.945 Test Loss: 0.488 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.364811420440674
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.324 Vali Acc: 0.948 Test Loss: 0.324 Test Acc: 0.948
Validation loss decreased (-0.947071 --> -0.948465).  Saving model ...
Epoch: 14 cost time: 23.340471267700195
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.475 Vali Acc: 0.936 Test Loss: 0.475 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.683274030685425
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.376 Vali Acc: 0.951 Test Loss: 0.376 Test Acc: 0.951
Validation loss decreased (-0.948465 --> -0.951250).  Saving model ...
Epoch: 16 cost time: 24.974729299545288
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.384 Vali Acc: 0.948 Test Loss: 0.384 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.284969806671143
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.488 Vali Acc: 0.932 Test Loss: 0.488 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.28551435470581
Epoch: 18, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.568 Vali Acc: 0.923 Test Loss: 0.568 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.006924629211426
Epoch: 19, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.437 Vali Acc: 0.957 Test Loss: 0.437 Test Acc: 0.957
Validation loss decreased (-0.951250 --> -0.956820).  Saving model ...
Epoch: 20 cost time: 24.83706259727478
Epoch: 20, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.449 Vali Acc: 0.948 Test Loss: 0.449 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 26.140401363372803
Epoch: 21, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.489 Vali Acc: 0.941 Test Loss: 0.489 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.59353518486023
Epoch: 22, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.539 Vali Acc: 0.936 Test Loss: 0.539 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 21.125488996505737
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.503 Vali Acc: 0.948 Test Loss: 0.503 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 21.33341646194458
Epoch: 24, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.444 Vali Acc: 0.952 Test Loss: 0.444 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 22.35197162628174
Epoch: 25, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.520 Vali Acc: 0.944 Test Loss: 0.520 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 24.676870346069336
Epoch: 26, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.574 Vali Acc: 0.937 Test Loss: 0.574 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 23.803037881851196
Epoch: 27, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.665 Vali Acc: 0.941 Test Loss: 0.665 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.04872155189514
Epoch: 28, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.569 Vali Acc: 0.946 Test Loss: 0.569 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 20.16763138771057
Epoch: 29, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.480 Vali Acc: 0.946 Test Loss: 0.480 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.045339107513428
Epoch: 1, Steps: 89 | Train Loss: 1.632 Vali Loss: 0.729 Vali Acc: 0.796 Test Loss: 0.729 Test Acc: 0.796
Validation loss decreased (inf --> -0.795954).  Saving model ...
Epoch: 2 cost time: 24.74252963066101
Epoch: 2, Steps: 89 | Train Loss: 0.465 Vali Loss: 0.428 Vali Acc: 0.869 Test Loss: 0.428 Test Acc: 0.869
Validation loss decreased (-0.795954 --> -0.869076).  Saving model ...
Epoch: 3 cost time: 24.29969358444214
Epoch: 3, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (-0.869076 --> -0.924789).  Saving model ...
Epoch: 4 cost time: 24.867866277694702
Epoch: 4, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.471994400024414
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.253 Vali Acc: 0.939 Test Loss: 0.253 Test Acc: 0.939
Validation loss decreased (-0.924789 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 22.606215000152588
Epoch: 6, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.938716 --> -0.940805).  Saving model ...
Epoch: 7 cost time: 23.63458514213562
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.378 Vali Acc: 0.923 Test Loss: 0.378 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.74420690536499
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.434 Vali Acc: 0.914 Test Loss: 0.434 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.13054347038269
Epoch: 9, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.647 Vali Acc: 0.896 Test Loss: 0.647 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 24.575197458267212
Epoch: 10, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 25.1877601146698
Epoch: 11, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.465 Vali Acc: 0.919 Test Loss: 0.465 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 25.82554006576538
Epoch: 12, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.631 Vali Acc: 0.919 Test Loss: 0.631 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 24.529257774353027
Epoch: 13, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.321 Vali Acc: 0.946 Test Loss: 0.321 Test Acc: 0.946
Validation loss decreased (-0.940805 --> -0.945679).  Saving model ...
Epoch: 14 cost time: 23.464698553085327
Epoch: 14, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.363 Vali Acc: 0.948 Test Loss: 0.363 Test Acc: 0.948
Validation loss decreased (-0.945679 --> -0.948464).  Saving model ...
Epoch: 15 cost time: 23.0094997882843
Epoch: 15, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.443 Vali Acc: 0.944 Test Loss: 0.443 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 24.0818510055542
Epoch: 16, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.616 Vali Acc: 0.926 Test Loss: 0.616 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.6730899810791
Epoch: 17, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.601 Vali Acc: 0.928 Test Loss: 0.601 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 24.514560222625732
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.442 Vali Acc: 0.951 Test Loss: 0.442 Test Acc: 0.951
Validation loss decreased (-0.948464 --> -0.951249).  Saving model ...
Epoch: 19 cost time: 24.333590507507324
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.529 Vali Acc: 0.932 Test Loss: 0.529 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 22.95039463043213
Epoch: 20, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.403 Vali Acc: 0.944 Test Loss: 0.403 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.28104066848755
Epoch: 21, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.624 Vali Acc: 0.925 Test Loss: 0.624 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.368654489517212
Epoch: 22, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.433 Vali Acc: 0.949 Test Loss: 0.433 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.433746814727783
Epoch: 23, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.581 Vali Acc: 0.935 Test Loss: 0.581 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 23.205604076385498
Epoch: 24, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.397 Vali Acc: 0.958 Test Loss: 0.397 Test Acc: 0.958
Validation loss decreased (-0.951249 --> -0.957517).  Saving model ...
Epoch: 25 cost time: 23.606266498565674
Epoch: 25, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.629 Vali Acc: 0.937 Test Loss: 0.629 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 22.707738161087036
Epoch: 26, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.409 Vali Acc: 0.958 Test Loss: 0.409 Test Acc: 0.958
Validation loss decreased (-0.957517 --> -0.958213).  Saving model ...
Epoch: 27 cost time: 24.619455337524414
Epoch: 27, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.576 Vali Acc: 0.940 Test Loss: 0.576 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 24.319326400756836
Epoch: 28, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.600 Vali Acc: 0.939 Test Loss: 0.600 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 23.651148080825806
Epoch: 29, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.612 Vali Acc: 0.936 Test Loss: 0.612 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 23.917779445648193
Epoch: 30, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.488 Vali Acc: 0.955 Test Loss: 0.488 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 25.733646869659424
Epoch: 31, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.475 Vali Acc: 0.959 Test Loss: 0.475 Test Acc: 0.959
Validation loss decreased (-0.958213 --> -0.958909).  Saving model ...
Epoch: 32 cost time: 24.68007493019104
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.587 Vali Acc: 0.946 Test Loss: 0.587 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 23.402483224868774
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.499 Vali Acc: 0.952 Test Loss: 0.499 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 22.193851947784424
Epoch: 34, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.511 Vali Acc: 0.950 Test Loss: 0.511 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 22.771912097930908
Epoch: 35, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.574 Vali Acc: 0.941 Test Loss: 0.574 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 25.74902057647705
Epoch: 36, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.414 Vali Acc: 0.956 Test Loss: 0.414 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 24.053216457366943
Epoch: 37, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.528 Vali Acc: 0.953 Test Loss: 0.528 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 23.335928201675415
Epoch: 38, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.748 Vali Acc: 0.947 Test Loss: 0.748 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 21.619590520858765
Epoch: 39, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.480 Vali Acc: 0.960 Test Loss: 0.480 Test Acc: 0.960
Validation loss decreased (-0.958909 --> -0.960302).  Saving model ...
Epoch: 40 cost time: 22.66184115409851
Epoch: 40, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.616 Vali Acc: 0.954 Test Loss: 0.616 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 23.73085117340088
Epoch: 41, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.698 Vali Acc: 0.943 Test Loss: 0.698 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 25.123499870300293
Epoch: 42, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.652 Vali Acc: 0.950 Test Loss: 0.652 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 24.542121171951294
Epoch: 43, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.764 Vali Acc: 0.942 Test Loss: 0.764 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 22.07560706138611
Epoch: 44, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.541 Vali Acc: 0.961 Test Loss: 0.541 Test Acc: 0.961
Validation loss decreased (-0.960302 --> -0.960997).  Saving model ...
Epoch: 45 cost time: 21.823742628097534
Epoch: 45, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.682 Vali Acc: 0.949 Test Loss: 0.682 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 22.656539916992188
Epoch: 46, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.582 Vali Acc: 0.953 Test Loss: 0.582 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 24.052387714385986
Epoch: 47, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.858 Vali Acc: 0.928 Test Loss: 0.858 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 25.245344161987305
Epoch: 48, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.949 Vali Acc: 0.928 Test Loss: 0.949 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 23.430928468704224
Epoch: 49, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.777 Vali Acc: 0.939 Test Loss: 0.777 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 21.99360942840576
Epoch: 50, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.758 Vali Acc: 0.944 Test Loss: 0.758 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 23.854540586471558
Epoch: 51, Steps: 89 | Train Loss: 0.069 Vali Loss: 1.256 Vali Acc: 0.912 Test Loss: 1.256 Test Acc: 0.912
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 23.502193450927734
Epoch: 52, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.727 Vali Acc: 0.946 Test Loss: 0.727 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 25.10345149040222
Epoch: 53, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.782 Vali Acc: 0.940 Test Loss: 0.782 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 22.53441071510315
Epoch: 54, Steps: 89 | Train Loss: 0.058 Vali Loss: 1.292 Vali Acc: 0.916 Test Loss: 1.292 Test Acc: 0.916
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.14906620979309
Epoch: 1, Steps: 89 | Train Loss: 2.156 Vali Loss: 1.272 Vali Acc: 0.625 Test Loss: 1.272 Test Acc: 0.625
Validation loss decreased (inf --> -0.625335).  Saving model ...
Epoch: 2 cost time: 23.32388663291931
Epoch: 2, Steps: 89 | Train Loss: 0.587 Vali Loss: 0.551 Vali Acc: 0.828 Test Loss: 0.551 Test Acc: 0.828
Validation loss decreased (-0.625335 --> -0.827989).  Saving model ...
Epoch: 3 cost time: 23.50074338912964
Epoch: 3, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.301 Vali Acc: 0.916 Test Loss: 0.301 Test Acc: 0.916
Validation loss decreased (-0.827989 --> -0.916432).  Saving model ...
Epoch: 4 cost time: 24.45855975151062
Epoch: 4, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.383 Vali Acc: 0.916 Test Loss: 0.383 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.46252155303955
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
Validation loss decreased (-0.916432 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 23.950104236602783
Epoch: 6, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.538 Vali Acc: 0.895 Test Loss: 0.538 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.41647481918335
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.325 Vali Acc: 0.923 Test Loss: 0.325 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.42967176437378
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.325 Vali Acc: 0.938 Test Loss: 0.325 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.871275424957275
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.468 Vali Acc: 0.923 Test Loss: 0.468 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.14490509033203
Epoch: 10, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.387 Vali Acc: 0.930 Test Loss: 0.387 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 23.412386894226074
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.315 Vali Acc: 0.947 Test Loss: 0.315 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 25.941176652908325
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.403 Vali Acc: 0.942 Test Loss: 0.403 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 25.019752740859985
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.326 Vali Acc: 0.951 Test Loss: 0.326 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.951250).  Saving model ...
Epoch: 14 cost time: 23.6086688041687
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.257 Vali Acc: 0.955 Test Loss: 0.257 Test Acc: 0.955
Validation loss decreased (-0.951250 --> -0.955429).  Saving model ...
Epoch: 15 cost time: 22.50426721572876
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.309 Vali Acc: 0.958 Test Loss: 0.309 Test Acc: 0.958
Validation loss decreased (-0.955429 --> -0.958214).  Saving model ...
Epoch: 16 cost time: 21.61568522453308
Epoch: 16, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.417 Vali Acc: 0.946 Test Loss: 0.417 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.16550326347351
Epoch: 17, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.415 Vali Acc: 0.954 Test Loss: 0.415 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.141765117645264
Epoch: 18, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.449 Vali Acc: 0.929 Test Loss: 0.449 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.680781364440918
Epoch: 19, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.569 Vali Acc: 0.933 Test Loss: 0.569 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.828758716583252
Epoch: 20, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.391 Vali Acc: 0.953 Test Loss: 0.391 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 25.02022957801819
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.390 Vali Acc: 0.958 Test Loss: 0.390 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 23.991315126419067
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.363 Vali Acc: 0.948 Test Loss: 0.363 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 23.115970373153687
Epoch: 23, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.464 Vali Acc: 0.946 Test Loss: 0.464 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 25.4894437789917
Epoch: 24, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.508 Vali Acc: 0.938 Test Loss: 0.508 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 24.331220388412476
Epoch: 25, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.449 Vali Acc: 0.944 Test Loss: 0.449 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.20638632774353
Epoch: 1, Steps: 89 | Train Loss: 2.173 Vali Loss: 1.451 Vali Acc: 0.552 Test Loss: 1.451 Test Acc: 0.552
Validation loss decreased (inf --> -0.552214).  Saving model ...
Epoch: 2 cost time: 23.547380208969116
Epoch: 2, Steps: 89 | Train Loss: 0.595 Vali Loss: 0.579 Vali Acc: 0.800 Test Loss: 0.579 Test Acc: 0.800
Validation loss decreased (-0.552214 --> -0.800133).  Saving model ...
Epoch: 3 cost time: 23.813573122024536
Epoch: 3, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
Validation loss decreased (-0.800133 --> -0.890665).  Saving model ...
Epoch: 4 cost time: 23.618215799331665
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.574 Vali Acc: 0.884 Test Loss: 0.574 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.96846842765808
Epoch: 5, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
Validation loss decreased (-0.890665 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 22.93014407157898
Epoch: 6, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.374 Vali Acc: 0.898 Test Loss: 0.374 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.333693504333496
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.710598468780518
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.321 Vali Acc: 0.936 Test Loss: 0.321 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.421903610229492
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.467 Vali Acc: 0.903 Test Loss: 0.467 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.87681245803833
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.388 Vali Acc: 0.920 Test Loss: 0.388 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.91194486618042
Epoch: 11, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.76078200340271
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.238 Vali Acc: 0.954 Test Loss: 0.238 Test Acc: 0.954
Validation loss decreased (-0.938716 --> -0.954037).  Saving model ...
Epoch: 13 cost time: 24.406787395477295
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.330342292785645
Epoch: 14, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.527 Vali Acc: 0.916 Test Loss: 0.527 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.204549074172974
Epoch: 15, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.360 Vali Acc: 0.936 Test Loss: 0.360 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.74072027206421
Epoch: 16, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.296 Vali Acc: 0.955 Test Loss: 0.296 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954732).  Saving model ...
Epoch: 17 cost time: 24.93216633796692
Epoch: 17, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
Validation loss decreased (-0.954732 --> -0.960304).  Saving model ...
Epoch: 18 cost time: 23.9558424949646
Epoch: 18, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.269 Vali Acc: 0.945 Test Loss: 0.269 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.334684133529663
Epoch: 19, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.424 Vali Acc: 0.941 Test Loss: 0.424 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.951553344726562
Epoch: 20, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.585 Vali Acc: 0.924 Test Loss: 0.585 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 22.49258804321289
Epoch: 21, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.465 Vali Acc: 0.927 Test Loss: 0.465 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 22.676371812820435
Epoch: 22, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.538 Vali Acc: 0.931 Test Loss: 0.538 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 23.0013530254364
Epoch: 23, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.452 Vali Acc: 0.937 Test Loss: 0.452 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 23.05075430870056
Epoch: 24, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.402 Vali Acc: 0.953 Test Loss: 0.402 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 23.11244249343872
Epoch: 25, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.712 Vali Acc: 0.898 Test Loss: 0.712 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 22.996955633163452
Epoch: 26, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.365 Vali Acc: 0.958 Test Loss: 0.365 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 23.781357288360596
Epoch: 27, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.465 Vali Acc: 0.946 Test Loss: 0.465 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.83346438407898
Epoch: 1, Steps: 89 | Train Loss: 2.130 Vali Loss: 1.422 Vali Acc: 0.547 Test Loss: 1.422 Test Acc: 0.547
Validation loss decreased (inf --> -0.547340).  Saving model ...
Epoch: 2 cost time: 21.993594646453857
Epoch: 2, Steps: 89 | Train Loss: 0.623 Vali Loss: 0.525 Vali Acc: 0.830 Test Loss: 0.525 Test Acc: 0.830
Validation loss decreased (-0.547340 --> -0.830078).  Saving model ...
Epoch: 3 cost time: 20.262393712997437
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
Validation loss decreased (-0.830078 --> -0.927574).  Saving model ...
Epoch: 4 cost time: 22.37722396850586
Epoch: 4, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.387 Vali Acc: 0.898 Test Loss: 0.387 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.598376750946045
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.428746461868286
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.761 Vali Acc: 0.882 Test Loss: 0.761 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.432130575180054
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.384 Vali Acc: 0.923 Test Loss: 0.384 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.923514366149902
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.315 Vali Acc: 0.923 Test Loss: 0.315 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.36659002304077
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.670 Vali Acc: 0.843 Test Loss: 0.670 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 20.965303659439087
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
Validation loss decreased (-0.927574 --> -0.936627).  Saving model ...
Epoch: 11 cost time: 22.984781980514526
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.354 Vali Acc: 0.933 Test Loss: 0.354 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.684202432632446
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.469 Vali Acc: 0.920 Test Loss: 0.469 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.09876275062561
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.304 Vali Acc: 0.948 Test Loss: 0.304 Test Acc: 0.948
Validation loss decreased (-0.936627 --> -0.948465).  Saving model ...
Epoch: 14 cost time: 22.182901620864868
Epoch: 14, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.468 Vali Acc: 0.921 Test Loss: 0.468 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 21.733441829681396
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.385 Vali Acc: 0.948 Test Loss: 0.385 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.768335103988647
Epoch: 16, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.424 Vali Acc: 0.928 Test Loss: 0.424 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 21.45285677909851
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.443 Vali Acc: 0.931 Test Loss: 0.443 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 21.169628143310547
Epoch: 18, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.447 Vali Acc: 0.942 Test Loss: 0.447 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 21.889561653137207
Epoch: 19, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.621 Vali Acc: 0.927 Test Loss: 0.621 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 22.52552819252014
Epoch: 20, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.379 Vali Acc: 0.951 Test Loss: 0.379 Test Acc: 0.951
Validation loss decreased (-0.948465 --> -0.950553).  Saving model ...
Epoch: 21 cost time: 22.354111433029175
Epoch: 21, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.353 Vali Acc: 0.951 Test Loss: 0.353 Test Acc: 0.951
Validation loss decreased (-0.950553 --> -0.951250).  Saving model ...
Epoch: 22 cost time: 21.544984817504883
Epoch: 22, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.486 Vali Acc: 0.937 Test Loss: 0.486 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 21.93940258026123
Epoch: 23, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.410 Vali Acc: 0.953 Test Loss: 0.410 Test Acc: 0.953
Validation loss decreased (-0.951250 --> -0.953339).  Saving model ...
Epoch: 24 cost time: 22.120108366012573
Epoch: 24, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.511 Vali Acc: 0.931 Test Loss: 0.511 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 21.6514892578125
Epoch: 25, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.558 Vali Acc: 0.940 Test Loss: 0.558 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 22.359622716903687
Epoch: 26, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.495 Vali Acc: 0.942 Test Loss: 0.495 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 23.00284695625305
Epoch: 27, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.580 Vali Acc: 0.948 Test Loss: 0.580 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 22.686075448989868
Epoch: 28, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.472 Vali Acc: 0.960 Test Loss: 0.472 Test Acc: 0.960
Validation loss decreased (-0.953339 --> -0.959605).  Saving model ...
Epoch: 29 cost time: 21.58916664123535
Epoch: 29, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.457 Vali Acc: 0.951 Test Loss: 0.457 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 21.173840522766113
Epoch: 30, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.536 Vali Acc: 0.946 Test Loss: 0.536 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 22.639256715774536
Epoch: 31, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.404 Vali Acc: 0.964 Test Loss: 0.404 Test Acc: 0.964
Validation loss decreased (-0.959605 --> -0.964481).  Saving model ...
Epoch: 32 cost time: 22.53589940071106
Epoch: 32, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.548 Vali Acc: 0.948 Test Loss: 0.548 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 22.647705554962158
Epoch: 33, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.888 Vali Acc: 0.932 Test Loss: 0.888 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 22.275398015975952
Epoch: 34, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.441 Vali Acc: 0.958 Test Loss: 0.441 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 23.05217456817627
Epoch: 35, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.408 Vali Acc: 0.955 Test Loss: 0.408 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 19.951357126235962
Epoch: 36, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.599 Vali Acc: 0.951 Test Loss: 0.599 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 21.273219108581543
Epoch: 37, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.471 Vali Acc: 0.957 Test Loss: 0.471 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 20.955670595169067
Epoch: 38, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.887 Vali Acc: 0.936 Test Loss: 0.887 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 22.20271348953247
Epoch: 39, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.439 Vali Acc: 0.962 Test Loss: 0.439 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 23.075711011886597
Epoch: 40, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.470 Vali Acc: 0.960 Test Loss: 0.470 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 22.31810450553894
Epoch: 41, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.618 Vali Acc: 0.953 Test Loss: 0.618 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.394410610198975
Epoch: 1, Steps: 89 | Train Loss: 2.169 Vali Loss: 1.486 Vali Acc: 0.541 Test Loss: 1.486 Test Acc: 0.541
Validation loss decreased (inf --> -0.541071).  Saving model ...
Epoch: 2 cost time: 24.18589472770691
Epoch: 2, Steps: 89 | Train Loss: 0.634 Vali Loss: 0.604 Vali Acc: 0.792 Test Loss: 0.604 Test Acc: 0.792
Validation loss decreased (-0.541071 --> -0.791777).  Saving model ...
Epoch: 3 cost time: 23.57556414604187
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
Validation loss decreased (-0.791777 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 24.20708155632019
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.456 Vali Acc: 0.871 Test Loss: 0.456 Test Acc: 0.871
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.500810384750366
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.582 Vali Acc: 0.883 Test Loss: 0.582 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.17226266860962
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.897 Vali Acc: 0.868 Test Loss: 0.897 Test Acc: 0.868
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 22.61850070953369
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.389 Vali Acc: 0.913 Test Loss: 0.389 Test Acc: 0.913
Validation loss decreased (-0.910860 --> -0.912949).  Saving model ...
Epoch: 8 cost time: 21.41967225074768
Epoch: 8, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.315 Vali Acc: 0.935 Test Loss: 0.315 Test Acc: 0.935
Validation loss decreased (-0.912949 --> -0.935234).  Saving model ...
Epoch: 9 cost time: 22.429197549819946
Epoch: 9, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.523 Vali Acc: 0.898 Test Loss: 0.523 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.822197198867798
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.427 Vali Acc: 0.915 Test Loss: 0.427 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.891416788101196
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.370 Vali Acc: 0.923 Test Loss: 0.370 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.9761745929718
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.574 Vali Acc: 0.906 Test Loss: 0.574 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.905179023742676
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.473 Vali Acc: 0.922 Test Loss: 0.473 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 24.502180814743042
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.487 Vali Acc: 0.905 Test Loss: 0.487 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 22.49333357810974
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.435 Vali Acc: 0.934 Test Loss: 0.435 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 22.140936613082886
Epoch: 16, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.418 Vali Acc: 0.936 Test Loss: 0.418 Test Acc: 0.936
Validation loss decreased (-0.935234 --> -0.935929).  Saving model ...
Epoch: 17 cost time: 22.061081171035767
Epoch: 17, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.762 Vali Acc: 0.891 Test Loss: 0.762 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.85855269432068
Epoch: 18, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.507 Vali Acc: 0.935 Test Loss: 0.507 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.193058013916016
Epoch: 19, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.449 Vali Acc: 0.932 Test Loss: 0.449 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 22.968834161758423
Epoch: 20, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.423 Vali Acc: 0.942 Test Loss: 0.423 Test Acc: 0.942
Validation loss decreased (-0.935929 --> -0.942196).  Saving model ...
Epoch: 21 cost time: 23.375590085983276
Epoch: 21, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 21.949737310409546
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.366 Vali Acc: 0.955 Test Loss: 0.366 Test Acc: 0.955
Validation loss decreased (-0.942196 --> -0.955428).  Saving model ...
Epoch: 23 cost time: 22.102959871292114
Epoch: 23, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 21.74213194847107
Epoch: 24, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.505 Vali Acc: 0.939 Test Loss: 0.505 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.684722900390625
Epoch: 25, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.424 Vali Acc: 0.948 Test Loss: 0.424 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.524216890335083
Epoch: 26, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.439 Vali Acc: 0.949 Test Loss: 0.439 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 22.820152759552002
Epoch: 27, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.739 Vali Acc: 0.926 Test Loss: 0.739 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 23.606322765350342
Epoch: 28, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.514 Vali Acc: 0.947 Test Loss: 0.514 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 21.753418684005737
Epoch: 29, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.517 Vali Acc: 0.951 Test Loss: 0.517 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 23.52341890335083
Epoch: 30, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.443 Vali Acc: 0.956 Test Loss: 0.443 Test Acc: 0.956
Validation loss decreased (-0.955428 --> -0.956124).  Saving model ...
Epoch: 31 cost time: 23.110628366470337
Epoch: 31, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.540 Vali Acc: 0.949 Test Loss: 0.540 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 22.189821243286133
Epoch: 32, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.442 Vali Acc: 0.949 Test Loss: 0.442 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 22.429859161376953
Epoch: 33, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.595 Vali Acc: 0.941 Test Loss: 0.595 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 23.53871488571167
Epoch: 34, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.443 Vali Acc: 0.955 Test Loss: 0.443 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 23.210941553115845
Epoch: 35, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.469 Vali Acc: 0.955 Test Loss: 0.469 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 22.159613370895386
Epoch: 36, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.496 Vali Acc: 0.960 Test Loss: 0.496 Test Acc: 0.960
Validation loss decreased (-0.956124 --> -0.959605).  Saving model ...
Epoch: 37 cost time: 21.94745397567749
Epoch: 37, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.388 Vali Acc: 0.960 Test Loss: 0.388 Test Acc: 0.960
Validation loss decreased (-0.959605 --> -0.960303).  Saving model ...
Epoch: 38 cost time: 23.49618649482727
Epoch: 38, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.562 Vali Acc: 0.952 Test Loss: 0.562 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 22.151773691177368
Epoch: 39, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.502 Vali Acc: 0.958 Test Loss: 0.502 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 23.048041343688965
Epoch: 40, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.461 Vali Acc: 0.958 Test Loss: 0.461 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 23.313698530197144
Epoch: 41, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.866 Vali Acc: 0.934 Test Loss: 0.866 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 23.40483546257019
Epoch: 42, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.508 Vali Acc: 0.952 Test Loss: 0.508 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 22.588690757751465
Epoch: 43, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.402 Vali Acc: 0.964 Test Loss: 0.402 Test Acc: 0.964
Validation loss decreased (-0.960303 --> -0.964481).  Saving model ...
Epoch: 44 cost time: 22.511638641357422
Epoch: 44, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.418 Vali Acc: 0.964 Test Loss: 0.418 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 22.96200132369995
Epoch: 45, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.578 Vali Acc: 0.950 Test Loss: 0.578 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 23.18764615058899
Epoch: 46, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.492 Vali Acc: 0.953 Test Loss: 0.492 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 23.750179767608643
Epoch: 47, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.572 Vali Acc: 0.946 Test Loss: 0.572 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 24.2330539226532
Epoch: 48, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.637 Vali Acc: 0.945 Test Loss: 0.637 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 23.37509775161743
Epoch: 49, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.403 Vali Acc: 0.964 Test Loss: 0.403 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 21.408149480819702
Epoch: 50, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.444 Vali Acc: 0.961 Test Loss: 0.444 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 21.330557346343994
Epoch: 51, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.434 Vali Acc: 0.963 Test Loss: 0.434 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 21.227237939834595
Epoch: 52, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.960 Test Loss: 0.529 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 22.452756643295288
Epoch: 53, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.421 Vali Acc: 0.961 Test Loss: 0.421 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.216372966766357
Epoch: 1, Steps: 89 | Train Loss: 2.231 Vali Loss: 1.529 Vali Acc: 0.537 Test Loss: 1.529 Test Acc: 0.537
Validation loss decreased (inf --> -0.536893).  Saving model ...
Epoch: 2 cost time: 22.610717296600342
Epoch: 2, Steps: 89 | Train Loss: 0.660 Vali Loss: 0.610 Vali Acc: 0.797 Test Loss: 0.610 Test Acc: 0.797
Validation loss decreased (-0.536893 --> -0.797348).  Saving model ...
Epoch: 3 cost time: 22.215673446655273
Epoch: 3, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.335 Vali Acc: 0.900 Test Loss: 0.335 Test Acc: 0.900
Validation loss decreased (-0.797348 --> -0.900414).  Saving model ...
Epoch: 4 cost time: 21.933178663253784
Epoch: 4, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.501 Vali Acc: 0.866 Test Loss: 0.501 Test Acc: 0.866
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.78757381439209
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.541 Vali Acc: 0.896 Test Loss: 0.541 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.23810648918152
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.686 Vali Acc: 0.870 Test Loss: 0.686 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.986485958099365
Epoch: 7, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.356 Vali Acc: 0.921 Test Loss: 0.356 Test Acc: 0.921
Validation loss decreased (-0.900414 --> -0.921306).  Saving model ...
Epoch: 8 cost time: 23.894620895385742
Epoch: 8, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.303 Vali Acc: 0.923 Test Loss: 0.303 Test Acc: 0.923
Validation loss decreased (-0.921306 --> -0.923395).  Saving model ...
Epoch: 9 cost time: 23.734596014022827
Epoch: 9, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.445 Vali Acc: 0.890 Test Loss: 0.445 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.47933030128479
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.301 Vali Acc: 0.942 Test Loss: 0.301 Test Acc: 0.942
Validation loss decreased (-0.923395 --> -0.942198).  Saving model ...
Epoch: 11 cost time: 22.01172709465027
Epoch: 11, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.415 Vali Acc: 0.912 Test Loss: 0.415 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.0281822681427
Epoch: 12, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.893 Vali Acc: 0.871 Test Loss: 0.893 Test Acc: 0.871
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.447312831878662
Epoch: 13, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.399 Vali Acc: 0.942 Test Loss: 0.399 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 25.080735445022583
Epoch: 14, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.569 Vali Acc: 0.917 Test Loss: 0.569 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.5575168132782
Epoch: 15, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.461 Vali Acc: 0.934 Test Loss: 0.461 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 22.853395700454712
Epoch: 16, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.373 Vali Acc: 0.951 Test Loss: 0.373 Test Acc: 0.951
Validation loss decreased (-0.942198 --> -0.950553).  Saving model ...
Epoch: 17 cost time: 21.67611575126648
Epoch: 17, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.401 Vali Acc: 0.937 Test Loss: 0.401 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.015843391418457
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.510 Vali Acc: 0.935 Test Loss: 0.510 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 20.46969699859619
Epoch: 19, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.484 Vali Acc: 0.944 Test Loss: 0.484 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 23.085737228393555
Epoch: 20, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.396 Vali Acc: 0.951 Test Loss: 0.396 Test Acc: 0.951
Validation loss decreased (-0.950553 --> -0.951250).  Saving model ...
Epoch: 21 cost time: 22.878932237625122
Epoch: 21, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.323 Vali Acc: 0.965 Test Loss: 0.323 Test Acc: 0.965
Validation loss decreased (-0.951250 --> -0.965178).  Saving model ...
Epoch: 22 cost time: 23.16946053504944
Epoch: 22, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.510 Vali Acc: 0.939 Test Loss: 0.510 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 24.20411515235901
Epoch: 23, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.373 Vali Acc: 0.951 Test Loss: 0.373 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 24.512571811676025
Epoch: 24, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.439 Vali Acc: 0.948 Test Loss: 0.439 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.914567708969116
Epoch: 25, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.526 Vali Acc: 0.935 Test Loss: 0.526 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 22.816213846206665
Epoch: 26, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.406 Vali Acc: 0.959 Test Loss: 0.406 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 22.74682331085205
Epoch: 27, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.592 Vali Acc: 0.945 Test Loss: 0.592 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 22.312875032424927
Epoch: 28, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.677 Vali Acc: 0.930 Test Loss: 0.677 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 22.827358961105347
Epoch: 29, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.384 Vali Acc: 0.958 Test Loss: 0.384 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 22.4781711101532
Epoch: 30, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.538 Vali Acc: 0.951 Test Loss: 0.538 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 21.840359926223755
Epoch: 31, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.387 Vali Acc: 0.964 Test Loss: 0.387 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.01443099975586
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.048 Test Loss: 2.996 Test Acc: 0.048
Validation loss decreased (inf --> -0.048020).  Saving model ...
Epoch: 2 cost time: 21.258396863937378
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.048020 --> -0.060555).  Saving model ...
Epoch: 3 cost time: 21.725744485855103
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 4 cost time: 22.580403566360474
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.061 Test Loss: 2.994 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 5 cost time: 23.378454446792603
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.060555 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 21.779150009155273
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 22.387526273727417
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 21.420238971710205
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 21.894550323486328
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 22.322648763656616
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 22.213501691818237
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 22.908722400665283
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 21.621842861175537
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 21.84997534751892
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 21.282828330993652
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 21.88621425628662
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 22.128278732299805
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 23.91978669166565
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 23.079373598098755
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 21.688480377197266
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 21.82765007019043
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 21.42946481704712
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 21.81991958618164
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 20.825100898742676
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 21.306963443756104
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 22.240415573120117
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 22.6740505695343
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 22.385266542434692
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 21.228411197662354
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 21.77390718460083
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 21.2417471408844
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 22.811599016189575
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 22.644487142562866
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 22.940037965774536
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 22.75840449333191
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 22.021930694580078
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 21.752589225769043
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 21.532792806625366
Epoch: 38, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.803359031677246
Epoch: 39, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 22.030213117599487
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 22.605767488479614
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 21.29980158805847
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 21.21578884124756
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 20.608741521835327
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 22.20798087120056
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 23.71441411972046
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 22.877020597457886
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 22.408731698989868
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 22.061706066131592
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 21.033337593078613
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 20.96444034576416
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 21.355048418045044
Epoch: 52, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 22.901835918426514
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 22.023294687271118
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 55 cost time: 21.17140483856201
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 21.47300362586975
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 21.46810030937195
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 58 cost time: 21.45909023284912
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 21.94320845603943
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 60 cost time: 24.324800491333008
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 61 cost time: 23.234444856643677
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 21.644266366958618
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 21.692006587982178
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 64 cost time: 21.490272998809814
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 65 cost time: 21.232930898666382
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 22.38838529586792
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 22.695666551589966
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 22.57667589187622
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 21.628623723983765
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 21.519816398620605
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 21.855103254318237
Epoch: 71, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 22.748762130737305
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 23.152153968811035
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 24.15350580215454
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 1915156
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.32500672340393
Epoch: 1, Steps: 89 | Train Loss: 1.211 Vali Loss: 0.509 Vali Acc: 0.835 Test Loss: 0.509 Test Acc: 0.835
Validation loss decreased (inf --> -0.834953).  Saving model ...
Epoch: 2 cost time: 22.39518141746521
Epoch: 2, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.348 Vali Acc: 0.904 Test Loss: 0.348 Test Acc: 0.904
Validation loss decreased (-0.834953 --> -0.903896).  Saving model ...
Epoch: 3 cost time: 21.081896781921387
Epoch: 3, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.297 Vali Acc: 0.917 Test Loss: 0.297 Test Acc: 0.917
Validation loss decreased (-0.903896 --> -0.917128).  Saving model ...
Epoch: 4 cost time: 22.38934826850891
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.346 Vali Acc: 0.908 Test Loss: 0.346 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.734180450439453
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.444 Vali Acc: 0.905 Test Loss: 0.444 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.190988302230835
Epoch: 6, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.279 Vali Acc: 0.946 Test Loss: 0.279 Test Acc: 0.946
Validation loss decreased (-0.917128 --> -0.945680).  Saving model ...
Epoch: 7 cost time: 21.20655131340027
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.347 Vali Acc: 0.923 Test Loss: 0.347 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.272691011428833
Epoch: 8, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.312 Vali Acc: 0.931 Test Loss: 0.312 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.915000438690186
Epoch: 9, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.621 Vali Acc: 0.893 Test Loss: 0.621 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.909595012664795
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.367 Vali Acc: 0.932 Test Loss: 0.367 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.78136444091797
Epoch: 11, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.338 Vali Acc: 0.942 Test Loss: 0.338 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 23.308944940567017
Epoch: 12, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.328 Vali Acc: 0.958 Test Loss: 0.328 Test Acc: 0.958
Validation loss decreased (-0.945680 --> -0.957518).  Saving model ...
Epoch: 13 cost time: 23.45946216583252
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.361 Vali Acc: 0.946 Test Loss: 0.361 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.917964935302734
Epoch: 14, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.528 Vali Acc: 0.912 Test Loss: 0.528 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 20.547411680221558
Epoch: 15, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.592 Vali Acc: 0.938 Test Loss: 0.592 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.22286105155945
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.558 Vali Acc: 0.931 Test Loss: 0.558 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 21.205331563949585
Epoch: 17, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.912 Vali Acc: 0.918 Test Loss: 0.912 Test Acc: 0.918
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.73904824256897
Epoch: 18, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.629 Vali Acc: 0.938 Test Loss: 0.629 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.644558429718018
Epoch: 19, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.562 Vali Acc: 0.948 Test Loss: 0.562 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 21.098066329956055
Epoch: 20, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.494 Vali Acc: 0.939 Test Loss: 0.494 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 21.670661687850952
Epoch: 21, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.515 Vali Acc: 0.934 Test Loss: 0.515 Test Acc: 0.934
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 20.664371967315674
Epoch: 22, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.638 Vali Acc: 0.937 Test Loss: 0.638 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.73643445968628
Epoch: 1, Steps: 89 | Train Loss: 1.286 Vali Loss: 0.617 Vali Acc: 0.794 Test Loss: 0.617 Test Acc: 0.794
Validation loss decreased (inf --> -0.793866).  Saving model ...
Epoch: 2 cost time: 22.555299758911133
Epoch: 2, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.419 Vali Acc: 0.879 Test Loss: 0.419 Test Acc: 0.879
Validation loss decreased (-0.793866 --> -0.878826).  Saving model ...
Epoch: 3 cost time: 22.357863187789917
Epoch: 3, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.329 Vali Acc: 0.905 Test Loss: 0.329 Test Acc: 0.905
Validation loss decreased (-0.878826 --> -0.904593).  Saving model ...
Epoch: 4 cost time: 22.895471811294556
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
Validation loss decreased (-0.904593 --> -0.915039).  Saving model ...
Epoch: 5 cost time: 22.033321857452393
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.295 Vali Acc: 0.940 Test Loss: 0.295 Test Acc: 0.940
Validation loss decreased (-0.915039 --> -0.940108).  Saving model ...
Epoch: 6 cost time: 22.462706565856934
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.516 Vali Acc: 0.906 Test Loss: 0.516 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.607481718063354
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.384 Vali Acc: 0.917 Test Loss: 0.384 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.33700132369995
Epoch: 8, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.468 Vali Acc: 0.916 Test Loss: 0.468 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.80417251586914
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.444 Vali Acc: 0.914 Test Loss: 0.444 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 23.118942260742188
Epoch: 10, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.393 Vali Acc: 0.923 Test Loss: 0.393 Test Acc: 0.923
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 21.839425325393677
Epoch: 11, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.327 Vali Acc: 0.948 Test Loss: 0.327 Test Acc: 0.948
Validation loss decreased (-0.940108 --> -0.948465).  Saving model ...
Epoch: 12 cost time: 20.85851812362671
Epoch: 12, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.371 Vali Acc: 0.943 Test Loss: 0.371 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.427263736724854
Epoch: 13, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.492 Vali Acc: 0.924 Test Loss: 0.492 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 21.59358835220337
Epoch: 14, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.802 Vali Acc: 0.903 Test Loss: 0.802 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.36805748939514
Epoch: 15, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.402 Vali Acc: 0.953 Test Loss: 0.402 Test Acc: 0.953
Validation loss decreased (-0.948465 --> -0.952642).  Saving model ...
Epoch: 16 cost time: 22.690014123916626
Epoch: 16, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.666 Vali Acc: 0.906 Test Loss: 0.666 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 23.687822818756104
Epoch: 17, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.480 Vali Acc: 0.936 Test Loss: 0.480 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.32873821258545
Epoch: 18, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 21.80946183204651
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.383 Vali Acc: 0.955 Test Loss: 0.383 Test Acc: 0.955
Validation loss decreased (-0.952642 --> -0.955428).  Saving model ...
Epoch: 20 cost time: 21.39905285835266
Epoch: 20, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.518 Vali Acc: 0.948 Test Loss: 0.518 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 23.651318788528442
Epoch: 21, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.531 Vali Acc: 0.937 Test Loss: 0.531 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 22.958595752716064
Epoch: 22, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.619 Vali Acc: 0.934 Test Loss: 0.619 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 24.644774675369263
Epoch: 23, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.499 Vali Acc: 0.947 Test Loss: 0.499 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 22.491799354553223
Epoch: 24, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.540 Vali Acc: 0.950 Test Loss: 0.540 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 21.350619077682495
Epoch: 25, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.429 Vali Acc: 0.958 Test Loss: 0.429 Test Acc: 0.958
Validation loss decreased (-0.955428 --> -0.958213).  Saving model ...
Epoch: 26 cost time: 21.410804510116577
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.569 Vali Acc: 0.951 Test Loss: 0.569 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 22.25957202911377
Epoch: 27, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.612 Vali Acc: 0.937 Test Loss: 0.612 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 22.55973982810974
Epoch: 28, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.579 Vali Acc: 0.932 Test Loss: 0.579 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 22.580114603042603
Epoch: 29, Steps: 89 | Train Loss: 0.109 Vali Loss: 1.232 Vali Acc: 0.905 Test Loss: 1.232 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 22.756601095199585
Epoch: 30, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.538 Vali Acc: 0.946 Test Loss: 0.538 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 22.66006112098694
Epoch: 31, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.851 Vali Acc: 0.923 Test Loss: 0.851 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 22.00988268852234
Epoch: 32, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.939 Vali Acc: 0.925 Test Loss: 0.939 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 22.5676007270813
Epoch: 33, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.603 Vali Acc: 0.952 Test Loss: 0.603 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 24.537051916122437
Epoch: 34, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.674 Vali Acc: 0.939 Test Loss: 0.674 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 22.71877145767212
Epoch: 35, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.619 Vali Acc: 0.942 Test Loss: 0.619 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.584747314453125
Epoch: 1, Steps: 89 | Train Loss: 1.384 Vali Loss: 0.679 Vali Acc: 0.788 Test Loss: 0.679 Test Acc: 0.788
Validation loss decreased (inf --> -0.788294).  Saving model ...
Epoch: 2 cost time: 22.87312912940979
Epoch: 2, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.382 Vali Acc: 0.889 Test Loss: 0.382 Test Acc: 0.889
Validation loss decreased (-0.788294 --> -0.889272).  Saving model ...
Epoch: 3 cost time: 21.351747512817383
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.435 Vali Acc: 0.881 Test Loss: 0.435 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.772935152053833
Epoch: 4, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.461 Vali Acc: 0.896 Test Loss: 0.461 Test Acc: 0.896
Validation loss decreased (-0.889272 --> -0.895539).  Saving model ...
Epoch: 5 cost time: 23.615705251693726
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.300 Vali Acc: 0.932 Test Loss: 0.300 Test Acc: 0.932
Validation loss decreased (-0.895539 --> -0.932448).  Saving model ...
Epoch: 6 cost time: 23.44875407218933
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.355 Vali Acc: 0.923 Test Loss: 0.355 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.506465196609497
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.428 Vali Acc: 0.907 Test Loss: 0.428 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.017933130264282
Epoch: 8, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.356 Vali Acc: 0.934 Test Loss: 0.356 Test Acc: 0.934
Validation loss decreased (-0.932448 --> -0.933840).  Saving model ...
Epoch: 9 cost time: 23.772746562957764
Epoch: 9, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.339 Vali Acc: 0.932 Test Loss: 0.339 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.81340789794922
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.400 Vali Acc: 0.927 Test Loss: 0.400 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.372210264205933
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.268 Vali Acc: 0.947 Test Loss: 0.268 Test Acc: 0.947
Validation loss decreased (-0.933840 --> -0.947073).  Saving model ...
Epoch: 12 cost time: 23.99043369293213
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.330 Vali Acc: 0.948 Test Loss: 0.330 Test Acc: 0.948
Validation loss decreased (-0.947073 --> -0.948465).  Saving model ...
Epoch: 13 cost time: 22.76543879508972
Epoch: 13, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.413 Vali Acc: 0.938 Test Loss: 0.413 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.873679161071777
Epoch: 14, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.745 Vali Acc: 0.927 Test Loss: 0.745 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 20.23806643486023
Epoch: 15, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.527 Vali Acc: 0.940 Test Loss: 0.527 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.16872525215149
Epoch: 16, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.405 Vali Acc: 0.943 Test Loss: 0.405 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.760189056396484
Epoch: 17, Steps: 89 | Train Loss: 0.121 Vali Loss: 1.077 Vali Acc: 0.925 Test Loss: 1.077 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.303714752197266
Epoch: 18, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.570 Vali Acc: 0.926 Test Loss: 0.570 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.34343409538269
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.425 Vali Acc: 0.952 Test Loss: 0.425 Test Acc: 0.952
Validation loss decreased (-0.948465 --> -0.951946).  Saving model ...
Epoch: 20 cost time: 20.75917100906372
Epoch: 20, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.427 Vali Acc: 0.948 Test Loss: 0.427 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.473093509674072
Epoch: 21, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.494 Vali Acc: 0.946 Test Loss: 0.494 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 21.839128732681274
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.362 Vali Acc: 0.960 Test Loss: 0.362 Test Acc: 0.960
Validation loss decreased (-0.951946 --> -0.959606).  Saving model ...
Epoch: 23 cost time: 22.76187014579773
Epoch: 23, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.416 Vali Acc: 0.952 Test Loss: 0.416 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 23.13895344734192
Epoch: 24, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.407 Vali Acc: 0.951 Test Loss: 0.407 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.703547477722168
Epoch: 25, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.812 Vali Acc: 0.921 Test Loss: 0.812 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 21.66685152053833
Epoch: 26, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.726 Vali Acc: 0.932 Test Loss: 0.726 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 21.25265383720398
Epoch: 27, Steps: 89 | Train Loss: 0.105 Vali Loss: 1.158 Vali Acc: 0.921 Test Loss: 1.158 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 20.334901809692383
Epoch: 28, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.608 Vali Acc: 0.948 Test Loss: 0.608 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 20.338510274887085
Epoch: 29, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.655 Vali Acc: 0.944 Test Loss: 0.655 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 20.916378021240234
Epoch: 30, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.653 Vali Acc: 0.936 Test Loss: 0.653 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 22.56415319442749
Epoch: 31, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.613 Vali Acc: 0.947 Test Loss: 0.613 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 22.16434407234192
Epoch: 32, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.586 Vali Acc: 0.948 Test Loss: 0.586 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9596100278551533
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.418389320373535
Epoch: 1, Steps: 89 | Train Loss: 1.673 Vali Loss: 0.878 Vali Acc: 0.745 Test Loss: 0.878 Test Acc: 0.745
Validation loss decreased (inf --> -0.745117).  Saving model ...
Epoch: 2 cost time: 23.33608317375183
Epoch: 2, Steps: 89 | Train Loss: 0.489 Vali Loss: 0.451 Vali Acc: 0.868 Test Loss: 0.451 Test Acc: 0.868
Validation loss decreased (-0.745117 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 21.955607175827026
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.335 Vali Acc: 0.910 Test Loss: 0.335 Test Acc: 0.910
Validation loss decreased (-0.868380 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 21.76578688621521
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
Validation loss decreased (-0.910164 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 22.52584195137024
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.919217 --> -0.933145).  Saving model ...
Epoch: 6 cost time: 22.321863174438477
Epoch: 6, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.315 Vali Acc: 0.934 Test Loss: 0.315 Test Acc: 0.934
Validation loss decreased (-0.933145 --> -0.933841).  Saving model ...
Epoch: 7 cost time: 21.174251794815063
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.317 Vali Acc: 0.923 Test Loss: 0.317 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.92136263847351
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.309 Vali Acc: 0.938 Test Loss: 0.309 Test Acc: 0.938
Validation loss decreased (-0.933841 --> -0.938019).  Saving model ...
Epoch: 9 cost time: 22.317707538604736
Epoch: 9, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.442 Vali Acc: 0.926 Test Loss: 0.442 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.861857175827026
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.379 Vali Acc: 0.937 Test Loss: 0.379 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.035645246505737
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.339 Vali Acc: 0.957 Test Loss: 0.339 Test Acc: 0.957
Validation loss decreased (-0.938019 --> -0.956821).  Saving model ...
Epoch: 12 cost time: 22.00496006011963
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.453 Vali Acc: 0.939 Test Loss: 0.453 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.014201164245605
Epoch: 13, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.578 Vali Acc: 0.916 Test Loss: 0.578 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.708611726760864
Epoch: 14, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.473 Vali Acc: 0.946 Test Loss: 0.473 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.556559562683105
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.536 Vali Acc: 0.940 Test Loss: 0.536 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.577271699905396
Epoch: 16, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.508 Vali Acc: 0.939 Test Loss: 0.508 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.311676740646362
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.817 Vali Acc: 0.922 Test Loss: 0.817 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 21.651607990264893
Epoch: 18, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.436 Vali Acc: 0.948 Test Loss: 0.436 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 22.12094020843506
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.620 Vali Acc: 0.928 Test Loss: 0.620 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 23.055379152297974
Epoch: 20, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.556 Vali Acc: 0.937 Test Loss: 0.556 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 22.219671964645386
Epoch: 21, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.488 Vali Acc: 0.947 Test Loss: 0.488 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.183768033981323
Epoch: 1, Steps: 89 | Train Loss: 2.169 Vali Loss: 1.338 Vali Acc: 0.600 Test Loss: 1.338 Test Acc: 0.600
Validation loss decreased (inf --> -0.600265).  Saving model ...
Epoch: 2 cost time: 21.080917835235596
Epoch: 2, Steps: 89 | Train Loss: 0.624 Vali Loss: 0.483 Vali Acc: 0.860 Test Loss: 0.483 Test Acc: 0.860
Validation loss decreased (-0.600265 --> -0.860023).  Saving model ...
Epoch: 3 cost time: 19.655744314193726
Epoch: 3, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.413 Vali Acc: 0.866 Test Loss: 0.413 Test Acc: 0.866
Validation loss decreased (-0.860023 --> -0.865595).  Saving model ...
Epoch: 4 cost time: 20.27905821800232
Epoch: 4, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.258 Vali Acc: 0.940 Test Loss: 0.258 Test Acc: 0.940
Validation loss decreased (-0.865595 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 23.118772268295288
Epoch: 5, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.296 Vali Acc: 0.927 Test Loss: 0.296 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.25000786781311
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
Validation loss decreased (-0.940109 --> -0.942894).  Saving model ...
Epoch: 7 cost time: 23.805980682373047
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.298 Vali Acc: 0.935 Test Loss: 0.298 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.95955991744995
Epoch: 8, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.381 Vali Acc: 0.908 Test Loss: 0.381 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.070246934890747
Epoch: 9, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.240431308746338
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
Validation loss decreased (-0.942894 --> -0.948465).  Saving model ...
Epoch: 11 cost time: 23.943715810775757
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.288 Vali Acc: 0.952 Test Loss: 0.288 Test Acc: 0.952
Validation loss decreased (-0.948465 --> -0.951947).  Saving model ...
Epoch: 12 cost time: 24.905038356781006
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.287 Vali Acc: 0.954 Test Loss: 0.287 Test Acc: 0.954
Validation loss decreased (-0.951947 --> -0.954036).  Saving model ...
Epoch: 13 cost time: 22.62635326385498
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.556 Vali Acc: 0.928 Test Loss: 0.556 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.228307008743286
Epoch: 14, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.648 Vali Acc: 0.880 Test Loss: 0.648 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 20.165419578552246
Epoch: 15, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.491 Vali Acc: 0.918 Test Loss: 0.491 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.17047691345215
Epoch: 16, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.444 Vali Acc: 0.932 Test Loss: 0.444 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.19783878326416
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.546 Vali Acc: 0.921 Test Loss: 0.546 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 21.08843183517456
Epoch: 18, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 21.053481578826904
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 20.06085181236267
Epoch: 20, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.463 Vali Acc: 0.935 Test Loss: 0.463 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 21.713077783584595
Epoch: 21, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.481 Vali Acc: 0.948 Test Loss: 0.481 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 21.865001678466797
Epoch: 22, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.285 Vali Acc: 0.960 Test Loss: 0.285 Test Acc: 0.960
Validation loss decreased (-0.954036 --> -0.960304).  Saving model ...
Epoch: 23 cost time: 23.748565196990967
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.558 Vali Acc: 0.944 Test Loss: 0.558 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.854701280593872
Epoch: 24, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.623 Vali Acc: 0.923 Test Loss: 0.623 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.935274839401245
Epoch: 25, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.573 Vali Acc: 0.942 Test Loss: 0.573 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 21.108803749084473
Epoch: 26, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.391 Vali Acc: 0.955 Test Loss: 0.391 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 24.361987352371216
Epoch: 27, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.559 Vali Acc: 0.937 Test Loss: 0.559 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 21.451862573623657
Epoch: 28, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.470 Vali Acc: 0.956 Test Loss: 0.470 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 22.129690170288086
Epoch: 29, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.725 Vali Acc: 0.933 Test Loss: 0.725 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 21.365626335144043
Epoch: 30, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.539 Vali Acc: 0.944 Test Loss: 0.539 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 20.070297479629517
Epoch: 31, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.527 Vali Acc: 0.958 Test Loss: 0.527 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 21.266550540924072
Epoch: 32, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.729 Vali Acc: 0.939 Test Loss: 0.729 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.436545372009277
Epoch: 1, Steps: 89 | Train Loss: 2.184 Vali Loss: 1.555 Vali Acc: 0.504 Test Loss: 1.555 Test Acc: 0.504
Validation loss decreased (inf --> -0.504163).  Saving model ...
Epoch: 2 cost time: 22.2424373626709
Epoch: 2, Steps: 89 | Train Loss: 0.650 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
Validation loss decreased (-0.504163 --> -0.839131).  Saving model ...
Epoch: 3 cost time: 23.80037569999695
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
Validation loss decreased (-0.839131 --> -0.858631).  Saving model ...
Epoch: 4 cost time: 25.899888277053833
Epoch: 4, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.424 Vali Acc: 0.877 Test Loss: 0.424 Test Acc: 0.877
Validation loss decreased (-0.858631 --> -0.876737).  Saving model ...
Epoch: 5 cost time: 23.715167760849
Epoch: 5, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.876737 --> -0.940805).  Saving model ...
Epoch: 6 cost time: 23.66634440422058
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.792560577392578
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.402 Vali Acc: 0.898 Test Loss: 0.402 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.394047498703003
Epoch: 8, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.528 Vali Acc: 0.899 Test Loss: 0.528 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 23.869121074676514
Epoch: 9, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.377 Vali Acc: 0.918 Test Loss: 0.377 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 22.788915872573853
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.608 Vali Acc: 0.897 Test Loss: 0.608 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 23.523945093154907
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.447 Vali Acc: 0.914 Test Loss: 0.447 Test Acc: 0.914
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.444950580596924
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.421 Vali Acc: 0.918 Test Loss: 0.421 Test Acc: 0.918
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 23.332672119140625
Epoch: 13, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.696 Vali Acc: 0.889 Test Loss: 0.696 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 24.18391251564026
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.409 Vali Acc: 0.923 Test Loss: 0.409 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 23.55452871322632
Epoch: 15, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.307 Vali Acc: 0.949 Test Loss: 0.307 Test Acc: 0.949
Validation loss decreased (-0.940805 --> -0.949161).  Saving model ...
Epoch: 16 cost time: 22.588098764419556
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.519 Vali Acc: 0.912 Test Loss: 0.519 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.50497841835022
Epoch: 17, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.596 Vali Acc: 0.929 Test Loss: 0.596 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.34680962562561
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.403 Vali Acc: 0.938 Test Loss: 0.403 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 22.9285888671875
Epoch: 19, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.593 Vali Acc: 0.908 Test Loss: 0.593 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 23.629011869430542
Epoch: 20, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.519 Vali Acc: 0.933 Test Loss: 0.519 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 23.78386616706848
Epoch: 21, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.318 Vali Acc: 0.958 Test Loss: 0.318 Test Acc: 0.958
Validation loss decreased (-0.949161 --> -0.958214).  Saving model ...
Epoch: 22 cost time: 22.94695520401001
Epoch: 22, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.524 Vali Acc: 0.930 Test Loss: 0.524 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.09746527671814
Epoch: 23, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.419 Vali Acc: 0.944 Test Loss: 0.419 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 22.821064233779907
Epoch: 24, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.526 Vali Acc: 0.942 Test Loss: 0.526 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 22.27799916267395
Epoch: 25, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.630 Vali Acc: 0.937 Test Loss: 0.630 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 21.212257623672485
Epoch: 26, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.479 Vali Acc: 0.946 Test Loss: 0.479 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 22.21003484725952
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.650 Vali Acc: 0.940 Test Loss: 0.650 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 23.608293294906616
Epoch: 28, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.474 Vali Acc: 0.957 Test Loss: 0.474 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 22.939738988876343
Epoch: 29, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.440 Vali Acc: 0.955 Test Loss: 0.440 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 23.945807456970215
Epoch: 30, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.854 Vali Acc: 0.929 Test Loss: 0.854 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 25.12845206260681
Epoch: 31, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.403 Vali Acc: 0.962 Test Loss: 0.403 Test Acc: 0.962
Validation loss decreased (-0.958214 --> -0.961695).  Saving model ...
Epoch: 32 cost time: 23.21402144432068
Epoch: 32, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.412 Vali Acc: 0.953 Test Loss: 0.412 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 23.270509958267212
Epoch: 33, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.613 Vali Acc: 0.947 Test Loss: 0.613 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 22.526363611221313
Epoch: 34, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.435 Vali Acc: 0.951 Test Loss: 0.435 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 21.63713550567627
Epoch: 35, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.358 Vali Acc: 0.969 Test Loss: 0.358 Test Acc: 0.969
Validation loss decreased (-0.961695 --> -0.968659).  Saving model ...
Epoch: 36 cost time: 21.48726511001587
Epoch: 36, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.507 Vali Acc: 0.945 Test Loss: 0.507 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 22.009047031402588
Epoch: 37, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.360 Vali Acc: 0.958 Test Loss: 0.360 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 22.448216438293457
Epoch: 38, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.356 Vali Acc: 0.965 Test Loss: 0.356 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 21.608225345611572
Epoch: 39, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.955 Test Loss: 0.362 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 21.74490761756897
Epoch: 40, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.458 Vali Acc: 0.955 Test Loss: 0.458 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 23.34595036506653
Epoch: 41, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.422 Vali Acc: 0.952 Test Loss: 0.422 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 23.10184407234192
Epoch: 42, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.345 Vali Acc: 0.970 Test Loss: 0.345 Test Acc: 0.970
Validation loss decreased (-0.968659 --> -0.970052).  Saving model ...
Epoch: 43 cost time: 23.35369896888733
Epoch: 43, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.535 Vali Acc: 0.943 Test Loss: 0.535 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 22.78138518333435
Epoch: 44, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.440 Vali Acc: 0.962 Test Loss: 0.440 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 22.97074818611145
Epoch: 45, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.458 Vali Acc: 0.966 Test Loss: 0.458 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 22.241942644119263
Epoch: 46, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.568 Vali Acc: 0.953 Test Loss: 0.568 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 21.986106872558594
Epoch: 47, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.433 Vali Acc: 0.965 Test Loss: 0.433 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 20.845409393310547
Epoch: 48, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.482 Vali Acc: 0.964 Test Loss: 0.482 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 21.591354846954346
Epoch: 49, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.473 Vali Acc: 0.966 Test Loss: 0.473 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 21.57914686203003
Epoch: 50, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.623 Vali Acc: 0.952 Test Loss: 0.623 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 22.864729642868042
Epoch: 51, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.516 Vali Acc: 0.957 Test Loss: 0.516 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 22.763386964797974
Epoch: 52, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.780 Vali Acc: 0.937 Test Loss: 0.780 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.16196608543396
Epoch: 1, Steps: 89 | Train Loss: 2.162 Vali Loss: 1.520 Vali Acc: 0.544 Test Loss: 1.520 Test Acc: 0.544
Validation loss decreased (inf --> -0.543857).  Saving model ...
Epoch: 2 cost time: 22.775643348693848
Epoch: 2, Steps: 89 | Train Loss: 0.617 Vali Loss: 0.629 Vali Acc: 0.804 Test Loss: 0.629 Test Acc: 0.804
Validation loss decreased (-0.543857 --> -0.803615).  Saving model ...
Epoch: 3 cost time: 22.77074408531189
Epoch: 3, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
Validation loss decreased (-0.803615 --> -0.877433).  Saving model ...
Epoch: 4 cost time: 22.85504698753357
Epoch: 4, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.773759126663208
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.511 Vali Acc: 0.873 Test Loss: 0.511 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.912354946136475
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.327 Vali Acc: 0.921 Test Loss: 0.327 Test Acc: 0.921
Validation loss decreased (-0.877433 --> -0.921306).  Saving model ...
Epoch: 7 cost time: 21.141368865966797
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.383 Vali Acc: 0.913 Test Loss: 0.383 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.353745460510254
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.458 Vali Acc: 0.893 Test Loss: 0.458 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.043687343597412
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.476 Vali Acc: 0.916 Test Loss: 0.476 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.25537419319153
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.480 Vali Acc: 0.901 Test Loss: 0.480 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.908037662506104
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.322 Vali Acc: 0.935 Test Loss: 0.322 Test Acc: 0.935
Validation loss decreased (-0.921306 --> -0.935234).  Saving model ...
Epoch: 12 cost time: 21.157012701034546
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.455 Vali Acc: 0.893 Test Loss: 0.455 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.225468158721924
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.444 Vali Acc: 0.916 Test Loss: 0.444 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 21.22114658355713
Epoch: 14, Steps: 89 | Train Loss: 0.135 Vali Loss: 1.074 Vali Acc: 0.882 Test Loss: 1.074 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 22.168784379959106
Epoch: 15, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.520 Vali Acc: 0.934 Test Loss: 0.520 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.132505655288696
Epoch: 16, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.517 Vali Acc: 0.911 Test Loss: 0.517 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.763933181762695
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.533 Vali Acc: 0.917 Test Loss: 0.533 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 21.488675117492676
Epoch: 18, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.752 Vali Acc: 0.895 Test Loss: 0.752 Test Acc: 0.895
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 22.112263917922974
Epoch: 19, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.715 Vali Acc: 0.913 Test Loss: 0.715 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 23.370943069458008
Epoch: 20, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.827 Vali Acc: 0.892 Test Loss: 0.827 Test Acc: 0.892
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 21.1738178730011
Epoch: 21, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.412 Vali Acc: 0.949 Test Loss: 0.412 Test Acc: 0.949
Validation loss decreased (-0.935234 --> -0.949160).  Saving model ...
Epoch: 22 cost time: 21.956169366836548
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.579 Vali Acc: 0.933 Test Loss: 0.579 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 21.819759130477905
Epoch: 23, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.770 Vali Acc: 0.921 Test Loss: 0.770 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 21.309866189956665
Epoch: 24, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.943 Vali Acc: 0.914 Test Loss: 0.943 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.721232891082764
Epoch: 25, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.811 Vali Acc: 0.925 Test Loss: 0.811 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 22.54502534866333
Epoch: 26, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.421 Vali Acc: 0.951 Test Loss: 0.421 Test Acc: 0.951
Validation loss decreased (-0.949160 --> -0.950553).  Saving model ...
Epoch: 27 cost time: 22.272428274154663
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.805 Vali Acc: 0.917 Test Loss: 0.805 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 22.17008399963379
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.788 Vali Acc: 0.923 Test Loss: 0.788 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 22.943707942962646
Epoch: 29, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.554 Vali Acc: 0.945 Test Loss: 0.554 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 23.682034254074097
Epoch: 30, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.750 Vali Acc: 0.924 Test Loss: 0.750 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 23.492019414901733
Epoch: 31, Steps: 89 | Train Loss: 0.130 Vali Loss: 1.445 Vali Acc: 0.859 Test Loss: 1.445 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 24.15671181678772
Epoch: 32, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.580 Vali Acc: 0.929 Test Loss: 0.580 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 22.97825860977173
Epoch: 33, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.709 Vali Acc: 0.927 Test Loss: 0.709 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 22.28408718109131
Epoch: 34, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.713 Vali Acc: 0.932 Test Loss: 0.713 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 21.642325401306152
Epoch: 35, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.766 Vali Acc: 0.942 Test Loss: 0.766 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 21.161316394805908
Epoch: 36, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.691 Vali Acc: 0.939 Test Loss: 0.691 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9505571030640668
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.317312479019165
Epoch: 1, Steps: 89 | Train Loss: 2.199 Vali Loss: 1.630 Vali Acc: 0.521 Test Loss: 1.630 Test Acc: 0.521
Validation loss decreased (inf --> -0.520875).  Saving model ...
Epoch: 2 cost time: 20.737435340881348
Epoch: 2, Steps: 89 | Train Loss: 0.653 Vali Loss: 0.763 Vali Acc: 0.782 Test Loss: 0.763 Test Acc: 0.782
Validation loss decreased (-0.520875 --> -0.782026).  Saving model ...
Epoch: 3 cost time: 21.28991675376892
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
Validation loss decreased (-0.782026 --> -0.822418).  Saving model ...
Epoch: 4 cost time: 20.893375158309937
Epoch: 4, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.690 Vali Acc: 0.824 Test Loss: 0.690 Test Acc: 0.824
Validation loss decreased (-0.822418 --> -0.823809).  Saving model ...
Epoch: 5 cost time: 22.343236207962036
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.678 Vali Acc: 0.841 Test Loss: 0.678 Test Acc: 0.841
Validation loss decreased (-0.823809 --> -0.841219).  Saving model ...
Epoch: 6 cost time: 22.8764226436615
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.688 Vali Acc: 0.847 Test Loss: 0.688 Test Acc: 0.847
Validation loss decreased (-0.841219 --> -0.846790).  Saving model ...
Epoch: 7 cost time: 22.053420782089233
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.564 Vali Acc: 0.880 Test Loss: 0.564 Test Acc: 0.880
Validation loss decreased (-0.846790 --> -0.880217).  Saving model ...
Epoch: 8 cost time: 22.065706968307495
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.358 Vali Acc: 0.924 Test Loss: 0.358 Test Acc: 0.924
Validation loss decreased (-0.880217 --> -0.924091).  Saving model ...
Epoch: 9 cost time: 22.41846799850464
Epoch: 9, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.597 Vali Acc: 0.876 Test Loss: 0.597 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.04091238975525
Epoch: 10, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.515 Vali Acc: 0.898 Test Loss: 0.515 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.369140148162842
Epoch: 11, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.483 Vali Acc: 0.902 Test Loss: 0.483 Test Acc: 0.902
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.968671560287476
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.676 Vali Acc: 0.862 Test Loss: 0.676 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.86389422416687
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.642 Vali Acc: 0.885 Test Loss: 0.642 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 21.77550482749939
Epoch: 14, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.534 Vali Acc: 0.916 Test Loss: 0.534 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.851348638534546
Epoch: 15, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.418 Vali Acc: 0.928 Test Loss: 0.418 Test Acc: 0.928
Validation loss decreased (-0.924091 --> -0.928269).  Saving model ...
Epoch: 16 cost time: 22.316820859909058
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.411 Vali Acc: 0.932 Test Loss: 0.411 Test Acc: 0.932
Validation loss decreased (-0.928269 --> -0.931751).  Saving model ...
Epoch: 17 cost time: 22.486966609954834
Epoch: 17, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.912 Vali Acc: 0.889 Test Loss: 0.912 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.008230686187744
Epoch: 18, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.419 Vali Acc: 0.939 Test Loss: 0.419 Test Acc: 0.939
Validation loss decreased (-0.931751 --> -0.939411).  Saving model ...
Epoch: 19 cost time: 22.484285354614258
Epoch: 19, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.497 Vali Acc: 0.928 Test Loss: 0.497 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.479474782943726
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.899 Vali Acc: 0.908 Test Loss: 0.899 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 21.900787115097046
Epoch: 21, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.555 Vali Acc: 0.944 Test Loss: 0.555 Test Acc: 0.944
Validation loss decreased (-0.939411 --> -0.944284).  Saving model ...
Epoch: 22 cost time: 21.854429006576538
Epoch: 22, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.648 Vali Acc: 0.932 Test Loss: 0.648 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 22.203675270080566
Epoch: 23, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.640 Vali Acc: 0.928 Test Loss: 0.640 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 22.357513189315796
Epoch: 24, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.546 Vali Acc: 0.937 Test Loss: 0.546 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.699450254440308
Epoch: 25, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.414 Vali Acc: 0.951 Test Loss: 0.414 Test Acc: 0.951
Validation loss decreased (-0.944284 --> -0.950553).  Saving model ...
Epoch: 26 cost time: 22.260527849197388
Epoch: 26, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.386 Vali Acc: 0.958 Test Loss: 0.386 Test Acc: 0.958
Validation loss decreased (-0.950553 --> -0.957517).  Saving model ...
Epoch: 27 cost time: 22.80665922164917
Epoch: 27, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.803 Vali Acc: 0.911 Test Loss: 0.803 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 21.433266639709473
Epoch: 28, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.470 Vali Acc: 0.948 Test Loss: 0.470 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 21.577879190444946
Epoch: 29, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.483 Vali Acc: 0.951 Test Loss: 0.483 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 21.857612133026123
Epoch: 30, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.667 Vali Acc: 0.936 Test Loss: 0.667 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 22.14821219444275
Epoch: 31, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.754 Vali Acc: 0.933 Test Loss: 0.754 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 22.440945148468018
Epoch: 32, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.645 Vali Acc: 0.944 Test Loss: 0.645 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 22.92636203765869
Epoch: 33, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.697 Vali Acc: 0.931 Test Loss: 0.697 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 23.478779792785645
Epoch: 34, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.500 Vali Acc: 0.948 Test Loss: 0.500 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 22.137866973876953
Epoch: 35, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.731 Vali Acc: 0.943 Test Loss: 0.731 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 21.873061418533325
Epoch: 36, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.842 Vali Acc: 0.905 Test Loss: 0.842 Test Acc: 0.905
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.960364818572998
Epoch: 1, Steps: 89 | Train Loss: 2.250 Vali Loss: 1.709 Vali Acc: 0.505 Test Loss: 1.709 Test Acc: 0.505
Validation loss decreased (inf --> -0.504858).  Saving model ...
Epoch: 2 cost time: 20.282505989074707
Epoch: 2, Steps: 89 | Train Loss: 0.674 Vali Loss: 0.837 Vali Acc: 0.741 Test Loss: 0.837 Test Acc: 0.741
Validation loss decreased (-0.504858 --> -0.740939).  Saving model ...
Epoch: 3 cost time: 20.07002305984497
Epoch: 3, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.740939 --> -0.832863).  Saving model ...
Epoch: 4 cost time: 21.435481548309326
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.911 Vali Acc: 0.811 Test Loss: 0.911 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.917810201644897
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.832863 --> -0.899717).  Saving model ...
Epoch: 6 cost time: 20.835903644561768
Epoch: 6, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.9061336517334
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.448 Vali Acc: 0.895 Test Loss: 0.448 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.250880002975464
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.899717 --> -0.924787).  Saving model ...
Epoch: 9 cost time: 19.25170874595642
Epoch: 9, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.713 Vali Acc: 0.873 Test Loss: 0.713 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.385698080062866
Epoch: 10, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.729 Vali Acc: 0.879 Test Loss: 0.729 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.044618129730225
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.258 Vali Acc: 0.947 Test Loss: 0.258 Test Acc: 0.947
Validation loss decreased (-0.924787 --> -0.947073).  Saving model ...
Epoch: 12 cost time: 22.37626028060913
Epoch: 12, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.599 Vali Acc: 0.886 Test Loss: 0.599 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.0738308429718
Epoch: 13, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.763 Vali Acc: 0.875 Test Loss: 0.763 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.91956615447998
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 21.935821771621704
Epoch: 15, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.462 Vali Acc: 0.909 Test Loss: 0.462 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 21.433939695358276
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.812 Vali Acc: 0.863 Test Loss: 0.812 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 21.025734186172485
Epoch: 17, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.745 Vali Acc: 0.898 Test Loss: 0.745 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 21.244449853897095
Epoch: 18, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.837 Vali Acc: 0.902 Test Loss: 0.837 Test Acc: 0.902
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 21.257341861724854
Epoch: 19, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.675 Vali Acc: 0.910 Test Loss: 0.675 Test Acc: 0.910
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.24529719352722
Epoch: 20, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.690 Vali Acc: 0.906 Test Loss: 0.690 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.455183744430542
Epoch: 21, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.592 Vali Acc: 0.924 Test Loss: 0.592 Test Acc: 0.924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.947075208913649
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.203991174697876
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.046 Test Loss: 2.996 Test Acc: 0.046
Validation loss decreased (inf --> -0.045931).  Saving model ...
Epoch: 2 cost time: 21.002264261245728
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.045931 --> -0.059859).  Saving model ...
Epoch: 3 cost time: 21.94760274887085
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.059859 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 21.751741647720337
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 21.7598819732666
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 22.55487322807312
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 21.78171682357788
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 21.09323287010193
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 20.76435613632202
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 21.379591703414917
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 21.229863166809082
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 21.943477630615234
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 22.131352186203003
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 21.512847185134888
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 21.65265965461731
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 22.155582427978516
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 22.864652633666992
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 21.451924562454224
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 21.780031442642212
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 22.897387266159058
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 21.315450429916382
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 20.24709129333496
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 21.732572555541992
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 21.534053802490234
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 21.964903354644775
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 22.415192127227783
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 20.867794036865234
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 21.010815858840942
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 20.704139709472656
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 22.024179697036743
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 24.811540126800537
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 23.571959495544434
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 23.5385639667511
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 24.21089243888855
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 22.399068117141724
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 21.507620573043823
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 22.126528024673462
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 22.819599628448486
Epoch: 38, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 21.74123787879944
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 21.961528778076172
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 23.42110538482666
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 24.039610624313354
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 22.295769214630127
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 23.233888864517212
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 22.43802785873413
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 24.029282093048096
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 23.828264713287354
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 23.02612543106079
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 22.34251093864441
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 22.05105948448181
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 22.524082899093628
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 22.986984491348267
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 23.05643343925476
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 54 cost time: 22.610406398773193
Epoch: 54, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 23.1916606426239
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 22.792721271514893
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 24.747546672821045
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 22.648239374160767
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 59 cost time: 23.85812211036682
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 25.08156657218933
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 23.335981130599976
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 24.88111114501953
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 21.528696298599243
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 23.054867029190063
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 65 cost time: 22.302844524383545
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 22.422545194625854
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 24.49504590034485
Epoch: 67, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 25.700590133666992
Epoch: 68, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 25.00355815887451
Epoch: 69, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 23.918708562850952
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 24.7241268157959
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 24.18741226196289
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 23.84439206123352
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 74 cost time: 21.953640699386597
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 22.311976194381714
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 23.139520168304443
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 22.390769004821777
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 22.931355953216553
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 22.92447519302368
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 23.68743872642517
Epoch: 80, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 23.91113591194153
Epoch: 81, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 22.157554388046265
Epoch: 82, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 24.388357639312744
Epoch: 83, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 84 cost time: 23.877289533615112
Epoch: 84, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 85 cost time: 22.950331449508667
Epoch: 85, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 23.698573112487793
Epoch: 86, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 21.686516284942627
Epoch: 87, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 21.582613229751587
Epoch: 88, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 21.72887134552002
Epoch: 89, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 21.02620506286621
Epoch: 90, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 23.169968366622925
Epoch: 91, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 23.160133361816406
Epoch: 92, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 22.646240711212158
Epoch: 93, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 22.347803115844727
Epoch: 94, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 1521940
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.870511770248413
Epoch: 1, Steps: 89 | Train Loss: 1.261 Vali Loss: 0.570 Vali Acc: 0.811 Test Loss: 0.570 Test Acc: 0.811
Validation loss decreased (inf --> -0.810579).  Saving model ...
Epoch: 2 cost time: 24.594011306762695
Epoch: 2, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.261 Vali Acc: 0.934 Test Loss: 0.261 Test Acc: 0.934
Validation loss decreased (-0.810579 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 24.247193098068237
Epoch: 3, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.003170251846313
Epoch: 4, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.933841 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 24.55175232887268
Epoch: 5, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.417 Vali Acc: 0.898 Test Loss: 0.417 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.458450317382812
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.227 Vali Acc: 0.955 Test Loss: 0.227 Test Acc: 0.955
Validation loss decreased (-0.936627 --> -0.954733).  Saving model ...
Epoch: 7 cost time: 23.73216938972473
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.336 Vali Acc: 0.937 Test Loss: 0.336 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.885298490524292
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.61913514137268
Epoch: 9, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.306857585906982
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.366 Vali Acc: 0.935 Test Loss: 0.366 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.26666784286499
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.347 Vali Acc: 0.951 Test Loss: 0.347 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.01790142059326
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.400 Vali Acc: 0.935 Test Loss: 0.400 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 24.574584484100342
Epoch: 13, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.495 Vali Acc: 0.933 Test Loss: 0.495 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 25.20631742477417
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.379 Vali Acc: 0.945 Test Loss: 0.379 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 24.328630924224854
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.420 Vali Acc: 0.952 Test Loss: 0.420 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 23.646451473236084
Epoch: 16, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.458 Vali Acc: 0.943 Test Loss: 0.458 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9547353760445683
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.734461307525635
Epoch: 1, Steps: 89 | Train Loss: 1.321 Vali Loss: 0.646 Vali Acc: 0.793 Test Loss: 0.646 Test Acc: 0.793
Validation loss decreased (inf --> -0.793169).  Saving model ...
Epoch: 2 cost time: 25.64814782142639
Epoch: 2, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.345 Vali Acc: 0.899 Test Loss: 0.345 Test Acc: 0.899
Validation loss decreased (-0.793169 --> -0.899022).  Saving model ...
Epoch: 3 cost time: 23.410212516784668
Epoch: 3, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.899022 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 23.996457815170288
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.337 Vali Acc: 0.903 Test Loss: 0.337 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.383862018585205
Epoch: 5, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.410 Vali Acc: 0.890 Test Loss: 0.410 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.533284902572632
Epoch: 6, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.187074661254883
Epoch: 7, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.217 Vali Acc: 0.947 Test Loss: 0.217 Test Acc: 0.947
Validation loss decreased (-0.926181 --> -0.947073).  Saving model ...
Epoch: 8 cost time: 21.603841543197632
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.322 Vali Acc: 0.934 Test Loss: 0.322 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.3960862159729
Epoch: 9, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.421 Vali Acc: 0.921 Test Loss: 0.421 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.051174640655518
Epoch: 10, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.406 Vali Acc: 0.932 Test Loss: 0.406 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.57108187675476
Epoch: 11, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.216942071914673
Epoch: 12, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.368 Vali Acc: 0.939 Test Loss: 0.368 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.653748035430908
Epoch: 13, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.460 Vali Acc: 0.944 Test Loss: 0.460 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 22.59083890914917
Epoch: 14, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.509 Vali Acc: 0.927 Test Loss: 0.509 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.390544176101685
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.309 Vali Acc: 0.955 Test Loss: 0.309 Test Acc: 0.955
Validation loss decreased (-0.947073 --> -0.955429).  Saving model ...
Epoch: 16 cost time: 24.038601636886597
Epoch: 16, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.319 Vali Acc: 0.953 Test Loss: 0.319 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.986658573150635
Epoch: 17, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
Validation loss decreased (-0.955429 --> -0.960304).  Saving model ...
Epoch: 18 cost time: 22.097447395324707
Epoch: 18, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.348 Vali Acc: 0.948 Test Loss: 0.348 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 21.911537408828735
Epoch: 19, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.565 Vali Acc: 0.926 Test Loss: 0.565 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.738614320755005
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.365 Vali Acc: 0.948 Test Loss: 0.365 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 21.804779291152954
Epoch: 21, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.334 Vali Acc: 0.963 Test Loss: 0.334 Test Acc: 0.963
Validation loss decreased (-0.960304 --> -0.963089).  Saving model ...
Epoch: 22 cost time: 21.20912194252014
Epoch: 22, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.525 Vali Acc: 0.944 Test Loss: 0.525 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 20.98550319671631
Epoch: 23, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.354 Vali Acc: 0.966 Test Loss: 0.354 Test Acc: 0.966
Validation loss decreased (-0.963089 --> -0.965874).  Saving model ...
Epoch: 24 cost time: 21.096514463424683
Epoch: 24, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.389 Vali Acc: 0.960 Test Loss: 0.389 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 20.36784267425537
Epoch: 25, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.476 Vali Acc: 0.958 Test Loss: 0.476 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 22.499093770980835
Epoch: 26, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.503 Vali Acc: 0.951 Test Loss: 0.503 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 23.342179775238037
Epoch: 27, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.561 Vali Acc: 0.944 Test Loss: 0.561 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 24.373238801956177
Epoch: 28, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.402 Vali Acc: 0.951 Test Loss: 0.402 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 23.955938577651978
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.639 Vali Acc: 0.937 Test Loss: 0.639 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 21.68051815032959
Epoch: 30, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.469 Vali Acc: 0.960 Test Loss: 0.469 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 22.0896418094635
Epoch: 31, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.459 Vali Acc: 0.951 Test Loss: 0.459 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 22.715627670288086
Epoch: 32, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.403 Vali Acc: 0.957 Test Loss: 0.403 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 23.196196794509888
Epoch: 33, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.485 Vali Acc: 0.952 Test Loss: 0.485 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.41688299179077
Epoch: 1, Steps: 89 | Train Loss: 1.413 Vali Loss: 0.685 Vali Acc: 0.790 Test Loss: 0.685 Test Acc: 0.790
Validation loss decreased (inf --> -0.790383).  Saving model ...
Epoch: 2 cost time: 22.38616919517517
Epoch: 2, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
Validation loss decreased (-0.790383 --> -0.855149).  Saving model ...
Epoch: 3 cost time: 23.921677827835083
Epoch: 3, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.322 Vali Acc: 0.909 Test Loss: 0.322 Test Acc: 0.909
Validation loss decreased (-0.855149 --> -0.909468).  Saving model ...
Epoch: 4 cost time: 23.255308389663696
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
Validation loss decreased (-0.909468 --> -0.914342).  Saving model ...
Epoch: 5 cost time: 23.547001600265503
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.914342 --> -0.915038).  Saving model ...
Epoch: 6 cost time: 23.421608924865723
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.274 Vali Acc: 0.935 Test Loss: 0.274 Test Acc: 0.935
Validation loss decreased (-0.915038 --> -0.935234).  Saving model ...
Epoch: 7 cost time: 23.97497296333313
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.274 Vali Acc: 0.939 Test Loss: 0.274 Test Acc: 0.939
Validation loss decreased (-0.935234 --> -0.939412).  Saving model ...
Epoch: 8 cost time: 24.017004013061523
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.401 Vali Acc: 0.910 Test Loss: 0.401 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.394442558288574
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.330 Vali Acc: 0.942 Test Loss: 0.330 Test Acc: 0.942
Validation loss decreased (-0.939412 --> -0.941501).  Saving model ...
Epoch: 10 cost time: 21.503068208694458
Epoch: 10, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.350 Vali Acc: 0.939 Test Loss: 0.350 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.584745407104492
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.380 Vali Acc: 0.931 Test Loss: 0.380 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.49160122871399
Epoch: 12, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.420 Vali Acc: 0.933 Test Loss: 0.420 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.750640869140625
Epoch: 13, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.364 Vali Acc: 0.947 Test Loss: 0.364 Test Acc: 0.947
Validation loss decreased (-0.941501 --> -0.947072).  Saving model ...
Epoch: 14 cost time: 22.4051570892334
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.353 Vali Acc: 0.947 Test Loss: 0.353 Test Acc: 0.947
Validation loss decreased (-0.947072 --> -0.947072).  Saving model ...
Epoch: 15 cost time: 22.866117238998413
Epoch: 15, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.491 Vali Acc: 0.932 Test Loss: 0.491 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.470831394195557
Epoch: 16, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.486 Vali Acc: 0.932 Test Loss: 0.486 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 22.54197883605957
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.536 Vali Acc: 0.942 Test Loss: 0.536 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 23.247506380081177
Epoch: 18, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.331 Vali Acc: 0.954 Test Loss: 0.331 Test Acc: 0.954
Validation loss decreased (-0.947072 --> -0.954036).  Saving model ...
Epoch: 19 cost time: 22.891545057296753
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.466 Vali Acc: 0.941 Test Loss: 0.466 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.810030698776245
Epoch: 20, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.502 Vali Acc: 0.931 Test Loss: 0.502 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.668565034866333
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.410 Vali Acc: 0.951 Test Loss: 0.410 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 21.982337951660156
Epoch: 22, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.499 Vali Acc: 0.943 Test Loss: 0.499 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 25.582688570022583
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.417 Vali Acc: 0.955 Test Loss: 0.417 Test Acc: 0.955
Validation loss decreased (-0.954036 --> -0.955428).  Saving model ...
Epoch: 24 cost time: 23.808881759643555
Epoch: 24, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.404 Vali Acc: 0.956 Test Loss: 0.404 Test Acc: 0.956
Validation loss decreased (-0.955428 --> -0.956124).  Saving model ...
Epoch: 25 cost time: 25.294692754745483
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.374 Vali Acc: 0.965 Test Loss: 0.374 Test Acc: 0.965
Validation loss decreased (-0.956124 --> -0.965177).  Saving model ...
Epoch: 26 cost time: 23.04585027694702
Epoch: 26, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.396 Vali Acc: 0.960 Test Loss: 0.396 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 23.238932132720947
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.573 Vali Acc: 0.944 Test Loss: 0.573 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 22.25290608406067
Epoch: 28, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.764 Vali Acc: 0.937 Test Loss: 0.764 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 22.210009813308716
Epoch: 29, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.626 Vali Acc: 0.933 Test Loss: 0.626 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 21.714123010635376
Epoch: 30, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.845 Vali Acc: 0.930 Test Loss: 0.845 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 22.483524084091187
Epoch: 31, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.738 Vali Acc: 0.948 Test Loss: 0.738 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 22.902079582214355
Epoch: 32, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.901 Vali Acc: 0.921 Test Loss: 0.901 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 22.6609628200531
Epoch: 33, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.785 Vali Acc: 0.935 Test Loss: 0.785 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 22.38713026046753
Epoch: 34, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.537 Vali Acc: 0.949 Test Loss: 0.537 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 22.2908718585968
Epoch: 35, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.456 Vali Acc: 0.960 Test Loss: 0.456 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.721564054489136
Epoch: 1, Steps: 89 | Train Loss: 1.707 Vali Loss: 0.847 Vali Acc: 0.770 Test Loss: 0.847 Test Acc: 0.770
Validation loss decreased (inf --> -0.770187).  Saving model ...
Epoch: 2 cost time: 21.357993841171265
Epoch: 2, Steps: 89 | Train Loss: 0.526 Vali Loss: 0.412 Vali Acc: 0.882 Test Loss: 0.412 Test Acc: 0.882
Validation loss decreased (-0.770187 --> -0.882308).  Saving model ...
Epoch: 3 cost time: 20.71025013923645
Epoch: 3, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
Validation loss decreased (-0.882308 --> -0.924789).  Saving model ...
Epoch: 4 cost time: 20.152199506759644
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.257 Vali Acc: 0.934 Test Loss: 0.257 Test Acc: 0.934
Validation loss decreased (-0.924789 --> -0.933841).  Saving model ...
Epoch: 5 cost time: 24.22703790664673
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.329 Vali Acc: 0.914 Test Loss: 0.329 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.981124877929688
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 22.63568615913391
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
Validation loss decreased (-0.933841 --> -0.956126).  Saving model ...
Epoch: 8 cost time: 22.083928108215332
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.225 Vali Acc: 0.947 Test Loss: 0.225 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.773179054260254
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.306 Vali Acc: 0.939 Test Loss: 0.306 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.648868799209595
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.316 Vali Acc: 0.944 Test Loss: 0.316 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.660776138305664
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.433 Vali Acc: 0.937 Test Loss: 0.433 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.505319833755493
Epoch: 12, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.371 Vali Acc: 0.942 Test Loss: 0.371 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.871074199676514
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.413 Vali Acc: 0.946 Test Loss: 0.413 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 24.3645122051239
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.680 Vali Acc: 0.910 Test Loss: 0.680 Test Acc: 0.910
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.97703719139099
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.378 Vali Acc: 0.955 Test Loss: 0.378 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 22.215211391448975
Epoch: 16, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.536 Vali Acc: 0.932 Test Loss: 0.536 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 21.99313974380493
Epoch: 17, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.714 Vali Acc: 0.925 Test Loss: 0.714 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9561281337047354
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.310942888259888
Epoch: 1, Steps: 89 | Train Loss: 2.173 Vali Loss: 1.384 Vali Acc: 0.600 Test Loss: 1.384 Test Acc: 0.600
Validation loss decreased (inf --> -0.599568).  Saving model ...
Epoch: 2 cost time: 26.01342797279358
Epoch: 2, Steps: 89 | Train Loss: 0.680 Vali Loss: 0.593 Vali Acc: 0.816 Test Loss: 0.593 Test Acc: 0.816
Validation loss decreased (-0.599568 --> -0.816150).  Saving model ...
Epoch: 3 cost time: 25.039294719696045
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.322 Vali Acc: 0.905 Test Loss: 0.322 Test Acc: 0.905
Validation loss decreased (-0.816150 --> -0.904593).  Saving model ...
Epoch: 4 cost time: 22.982401609420776
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
Validation loss decreased (-0.904593 --> -0.942198).  Saving model ...
Epoch: 5 cost time: 24.60599660873413
Epoch: 5, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.888354539871216
Epoch: 6, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
Validation loss decreased (-0.942198 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 24.78077459335327
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.381 Vali Acc: 0.917 Test Loss: 0.381 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.26168203353882
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.366 Vali Acc: 0.916 Test Loss: 0.366 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.699288606643677
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.622 Vali Acc: 0.891 Test Loss: 0.622 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 24.73796844482422
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.356 Vali Acc: 0.931 Test Loss: 0.356 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.292206287384033
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.279 Vali Acc: 0.943 Test Loss: 0.279 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 23.489343881607056
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.372 Vali Acc: 0.949 Test Loss: 0.372 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 24.446443796157837
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.695 Vali Acc: 0.907 Test Loss: 0.695 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 25.345536708831787
Epoch: 14, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.486 Vali Acc: 0.939 Test Loss: 0.486 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 25.245883464813232
Epoch: 15, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.614 Vali Acc: 0.929 Test Loss: 0.614 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 23.725962162017822
Epoch: 16, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.604 Vali Acc: 0.923 Test Loss: 0.604 Test Acc: 0.923
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9526462395543176
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.176695585250854
Epoch: 1, Steps: 89 | Train Loss: 2.184 Vali Loss: 1.551 Vali Acc: 0.513 Test Loss: 1.551 Test Acc: 0.513
Validation loss decreased (inf --> -0.513216).  Saving model ...
Epoch: 2 cost time: 22.29318904876709
Epoch: 2, Steps: 89 | Train Loss: 0.641 Vali Loss: 0.562 Vali Acc: 0.824 Test Loss: 0.562 Test Acc: 0.824
Validation loss decreased (-0.513216 --> -0.823811).  Saving model ...
Epoch: 3 cost time: 23.78414225578308
Epoch: 3, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.301 Vali Acc: 0.909 Test Loss: 0.301 Test Acc: 0.909
Validation loss decreased (-0.823811 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 22.04575800895691
Epoch: 4, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
Validation loss decreased (-0.908771 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 22.723520755767822
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.350 Vali Acc: 0.909 Test Loss: 0.350 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.612552165985107
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.944984 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 22.70961594581604
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.257 Vali Acc: 0.943 Test Loss: 0.257 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.6546471118927
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.332 Vali Acc: 0.923 Test Loss: 0.332 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.42100191116333
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.467 Vali Acc: 0.896 Test Loss: 0.467 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.804108142852783
Epoch: 10, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.401 Vali Acc: 0.919 Test Loss: 0.401 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.91355037689209
Epoch: 11, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.333 Vali Acc: 0.940 Test Loss: 0.333 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 21.678646326065063
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.690 Vali Acc: 0.897 Test Loss: 0.690 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 22.773387908935547
Epoch: 13, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.415 Vali Acc: 0.937 Test Loss: 0.415 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 22.22231411933899
Epoch: 14, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.549 Vali Acc: 0.937 Test Loss: 0.549 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 21.336629152297974
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.662 Vali Acc: 0.920 Test Loss: 0.662 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.305274724960327
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.424 Vali Acc: 0.941 Test Loss: 0.424 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.58294415473938
Epoch: 1, Steps: 89 | Train Loss: 2.166 Vali Loss: 1.433 Vali Acc: 0.563 Test Loss: 1.433 Test Acc: 0.563
Validation loss decreased (inf --> -0.562660).  Saving model ...
Epoch: 2 cost time: 22.221678018569946
Epoch: 2, Steps: 89 | Train Loss: 0.629 Vali Loss: 0.525 Vali Acc: 0.851 Test Loss: 0.525 Test Acc: 0.851
Validation loss decreased (-0.562660 --> -0.850970).  Saving model ...
Epoch: 3 cost time: 22.99363684654236
Epoch: 3, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.457 Vali Acc: 0.885 Test Loss: 0.457 Test Acc: 0.885
Validation loss decreased (-0.850970 --> -0.885093).  Saving model ...
Epoch: 4 cost time: 24.22832441329956
Epoch: 4, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.367 Vali Acc: 0.896 Test Loss: 0.367 Test Acc: 0.896
Validation loss decreased (-0.885093 --> -0.895540).  Saving model ...
Epoch: 5 cost time: 23.193150520324707
Epoch: 5, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.285 Vali Acc: 0.932 Test Loss: 0.285 Test Acc: 0.932
Validation loss decreased (-0.895540 --> -0.931752).  Saving model ...
Epoch: 6 cost time: 23.952451467514038
Epoch: 6, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.267 Vali Acc: 0.945 Test Loss: 0.267 Test Acc: 0.945
Validation loss decreased (-0.931752 --> -0.944983).  Saving model ...
Epoch: 7 cost time: 24.437990188598633
Epoch: 7, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.416 Vali Acc: 0.906 Test Loss: 0.416 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.25089120864868
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
Validation loss decreased (-0.944983 --> -0.946376).  Saving model ...
Epoch: 9 cost time: 23.13572907447815
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.593 Vali Acc: 0.902 Test Loss: 0.593 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.301748752593994
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.323 Vali Acc: 0.929 Test Loss: 0.323 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.897760152816772
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.517 Vali Acc: 0.905 Test Loss: 0.517 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.15921664237976
Epoch: 12, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.566 Vali Acc: 0.912 Test Loss: 0.566 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.930164575576782
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.836 Vali Acc: 0.899 Test Loss: 0.836 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 23.182363033294678
Epoch: 14, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.400 Vali Acc: 0.928 Test Loss: 0.400 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 22.303991556167603
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
Validation loss decreased (-0.946376 --> -0.947768).  Saving model ...
Epoch: 16 cost time: 21.904807329177856
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.552 Vali Acc: 0.920 Test Loss: 0.552 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.18486499786377
Epoch: 17, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.479 Vali Acc: 0.925 Test Loss: 0.479 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.84734344482422
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.442 Vali Acc: 0.944 Test Loss: 0.442 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.223968505859375
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.415 Vali Acc: 0.931 Test Loss: 0.415 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 24.023359775543213
Epoch: 20, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.469 Vali Acc: 0.935 Test Loss: 0.469 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.05182194709778
Epoch: 21, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.820 Vali Acc: 0.896 Test Loss: 0.820 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 23.152164697647095
Epoch: 22, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.386 Vali Acc: 0.951 Test Loss: 0.386 Test Acc: 0.951
Validation loss decreased (-0.947768 --> -0.951250).  Saving model ...
Epoch: 23 cost time: 22.135358095169067
Epoch: 23, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.516 Vali Acc: 0.939 Test Loss: 0.516 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 23.578935146331787
Epoch: 24, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.634 Vali Acc: 0.925 Test Loss: 0.634 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.833935499191284
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.659 Vali Acc: 0.937 Test Loss: 0.659 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.378098964691162
Epoch: 26, Steps: 89 | Train Loss: 0.091 Vali Loss: 1.035 Vali Acc: 0.917 Test Loss: 1.035 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 22.871806144714355
Epoch: 27, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.544 Vali Acc: 0.943 Test Loss: 0.544 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 21.733965396881104
Epoch: 28, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.803 Vali Acc: 0.916 Test Loss: 0.803 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 21.908838033676147
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.554 Vali Acc: 0.949 Test Loss: 0.554 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 23.566070795059204
Epoch: 30, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.612 Vali Acc: 0.934 Test Loss: 0.612 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 22.932943105697632
Epoch: 31, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.664 Vali Acc: 0.940 Test Loss: 0.664 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 22.694717168807983
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9512534818941504
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.031524181365967
Epoch: 1, Steps: 89 | Train Loss: 2.185 Vali Loss: 1.528 Vali Acc: 0.515 Test Loss: 1.528 Test Acc: 0.515
Validation loss decreased (inf --> -0.515305).  Saving model ...
Epoch: 2 cost time: 20.604746103286743
Epoch: 2, Steps: 89 | Train Loss: 0.666 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
Validation loss decreased (-0.515305 --> -0.811275).  Saving model ...
Epoch: 3 cost time: 21.103031873703003
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.539 Vali Acc: 0.858 Test Loss: 0.539 Test Acc: 0.858
Validation loss decreased (-0.811275 --> -0.857933).  Saving model ...
Epoch: 4 cost time: 20.587653398513794
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.527 Vali Acc: 0.868 Test Loss: 0.527 Test Acc: 0.868
Validation loss decreased (-0.857933 --> -0.867683).  Saving model ...
Epoch: 5 cost time: 20.172144174575806
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.415 Vali Acc: 0.885 Test Loss: 0.415 Test Acc: 0.885
Validation loss decreased (-0.867683 --> -0.885093).  Saving model ...
Epoch: 6 cost time: 20.441933155059814
Epoch: 6, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.409 Vali Acc: 0.895 Test Loss: 0.409 Test Acc: 0.895
Validation loss decreased (-0.885093 --> -0.894843).  Saving model ...
Epoch: 7 cost time: 20.345255613327026
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.894843 --> -0.933145).  Saving model ...
Epoch: 8 cost time: 20.894872903823853
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.19343614578247
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 1.334 Vali Acc: 0.829 Test Loss: 1.334 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.549758434295654
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.483 Vali Acc: 0.894 Test Loss: 0.483 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.999963521957397
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.609 Vali Acc: 0.909 Test Loss: 0.609 Test Acc: 0.909
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.880820274353027
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.537 Vali Acc: 0.898 Test Loss: 0.537 Test Acc: 0.898
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.92939782142639
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 1.022 Vali Acc: 0.872 Test Loss: 1.022 Test Acc: 0.872
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 22.29539465904236
Epoch: 14, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.965 Vali Acc: 0.863 Test Loss: 0.965 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 21.707483291625977
Epoch: 15, Steps: 89 | Train Loss: 0.110 Vali Loss: 1.214 Vali Acc: 0.848 Test Loss: 1.214 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 20.941838264465332
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.750 Vali Acc: 0.884 Test Loss: 0.750 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 21.393654108047485
Epoch: 17, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.870 Vali Acc: 0.880 Test Loss: 0.870 Test Acc: 0.880
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9331476323119777
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.609097003936768
Epoch: 1, Steps: 89 | Train Loss: 2.247 Vali Loss: 1.639 Vali Acc: 0.490 Test Loss: 1.639 Test Acc: 0.490
Validation loss decreased (inf --> -0.489538).  Saving model ...
Epoch: 2 cost time: 22.08235788345337
Epoch: 2, Steps: 89 | Train Loss: 0.703 Vali Loss: 0.693 Vali Acc: 0.795 Test Loss: 0.693 Test Acc: 0.795
Validation loss decreased (-0.489538 --> -0.794561).  Saving model ...
Epoch: 3 cost time: 21.037070274353027
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.590 Vali Acc: 0.857 Test Loss: 0.590 Test Acc: 0.857
Validation loss decreased (-0.794561 --> -0.856540).  Saving model ...
Epoch: 4 cost time: 21.95447039604187
Epoch: 4, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.660 Vali Acc: 0.840 Test Loss: 0.660 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.205460786819458
Epoch: 5, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.415 Vali Acc: 0.886 Test Loss: 0.415 Test Acc: 0.886
Validation loss decreased (-0.856540 --> -0.885790).  Saving model ...
Epoch: 6 cost time: 23.145249128341675
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.352 Vali Acc: 0.923 Test Loss: 0.352 Test Acc: 0.923
Validation loss decreased (-0.885790 --> -0.922698).  Saving model ...
Epoch: 7 cost time: 24.182305574417114
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.473 Vali Acc: 0.895 Test Loss: 0.473 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.42780041694641
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.474 Vali Acc: 0.904 Test Loss: 0.474 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.105019330978394
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.828 Vali Acc: 0.837 Test Loss: 0.828 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.34975028038025
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.395 Vali Acc: 0.921 Test Loss: 0.395 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.16041135787964
Epoch: 11, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.746 Vali Acc: 0.902 Test Loss: 0.746 Test Acc: 0.902
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 21.883452653884888
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.922698 --> -0.924787).  Saving model ...
Epoch: 13 cost time: 21.76954984664917
Epoch: 13, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.586 Vali Acc: 0.893 Test Loss: 0.586 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.83328604698181
Epoch: 14, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.662 Vali Acc: 0.899 Test Loss: 0.662 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.561448335647583
Epoch: 15, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.748 Vali Acc: 0.890 Test Loss: 0.748 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 22.547807693481445
Epoch: 16, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.528 Vali Acc: 0.917 Test Loss: 0.528 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.38643479347229
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.614 Vali Acc: 0.916 Test Loss: 0.614 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.574279069900513
Epoch: 18, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.912 Test Loss: 0.517 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 25.499019861221313
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.752 Vali Acc: 0.895 Test Loss: 0.752 Test Acc: 0.895
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 22.05576467514038
Epoch: 20, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.427 Vali Acc: 0.942 Test Loss: 0.427 Test Acc: 0.942
Validation loss decreased (-0.924787 --> -0.942196).  Saving model ...
Epoch: 21 cost time: 23.893352508544922
Epoch: 21, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.954 Vali Acc: 0.882 Test Loss: 0.954 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 23.345240116119385
Epoch: 22, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.482 Vali Acc: 0.946 Test Loss: 0.482 Test Acc: 0.946
Validation loss decreased (-0.942196 --> -0.945678).  Saving model ...
Epoch: 23 cost time: 22.610920429229736
Epoch: 23, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.677 Vali Acc: 0.937 Test Loss: 0.677 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.549098014831543
Epoch: 24, Steps: 89 | Train Loss: 0.139 Vali Loss: 1.224 Vali Acc: 0.903 Test Loss: 1.224 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.060394287109375
Epoch: 25, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.767 Vali Acc: 0.930 Test Loss: 0.767 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.79279851913452
Epoch: 26, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.882 Vali Acc: 0.914 Test Loss: 0.882 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 23.280477285385132
Epoch: 27, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.506 Vali Acc: 0.942 Test Loss: 0.506 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 22.870659351348877
Epoch: 28, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.567 Vali Acc: 0.946 Test Loss: 0.567 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 22.987152099609375
Epoch: 29, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.397 Vali Acc: 0.943 Test Loss: 0.397 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 22.132095098495483
Epoch: 30, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.767 Vali Acc: 0.923 Test Loss: 0.767 Test Acc: 0.923
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 23.05813765525818
Epoch: 31, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.763 Vali Acc: 0.926 Test Loss: 0.763 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 22.19053363800049
Epoch: 32, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.667 Vali Acc: 0.929 Test Loss: 0.667 Test Acc: 0.929
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9456824512534819
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.36025333404541
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (inf --> -0.064733).  Saving model ...
Epoch: 2 cost time: 21.95219111442566
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 22.901690244674683
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 21.814544916152954
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 22.16765022277832
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 23.645559072494507
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 22.405254125595093
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 20.7597439289093
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 20.94135355949402
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 20.43929934501648
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 22.747785568237305
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 22.56416368484497
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 22.9406795501709
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 22.283017873764038
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 22.280019521713257
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 21.015108108520508
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 21.077170848846436
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 21.34702777862549
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 21.995510578155518
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 20.061119556427002
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 21.292428255081177
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 21.63307523727417
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 21.975114107131958
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 21.84327507019043
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 21.592508792877197
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 21.483901500701904
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 22.11554980278015
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 23.276095390319824
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 21.978091716766357
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 21.5681414604187
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 21.270184993743896
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 21.12417960166931
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 21.373446941375732
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 20.53610897064209
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 21.433549165725708
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 21.536340951919556
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 21.858785390853882
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 22.295064449310303
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.812561750411987
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 21.601475954055786
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 21.9395854473114
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 21.608102321624756
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 21.242741584777832
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 21.581085920333862
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 24.360487699508667
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 22.9499614238739
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 22.90944766998291
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 21.68889856338501
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 21.87257742881775
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 21.915283679962158
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 22.228345155715942
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 21.888267755508423
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 22.25279402732849
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 22.903648614883423
Epoch: 54, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 55 cost time: 20.990482330322266
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 21.220550537109375
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 20.278055667877197
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 20.33889651298523
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 20.89814257621765
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 60 cost time: 21.113189935684204
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 20.888768911361694
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 20.593472480773926
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 23.80494499206543
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 22.52641749382019
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 22.025837421417236
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 22.888797283172607
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 22.428308248519897
Epoch: 67, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 22.961711883544922
Epoch: 68, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 69 cost time: 22.31917095184326
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 70 cost time: 22.669941902160645
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 71 cost time: 22.419378995895386
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 21.698060989379883
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 21.50416088104248
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 74 cost time: 20.816807985305786
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 20.634615182876587
Epoch: 75, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 22.296409845352173
Epoch: 76, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 21.366671323776245
Epoch: 77, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 22.139713525772095
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 21.768550872802734
Epoch: 79, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 21.27105164527893
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 20.171298265457153
Epoch: 81, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 82 cost time: 20.799673557281494
Epoch: 82, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 20.882448434829712
Epoch: 83, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 20.936497449874878
Epoch: 84, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 21.429147720336914
Epoch: 85, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 22.297877550125122
Epoch: 86, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 22.104323387145996
Epoch: 87, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 21.642125129699707
Epoch: 88, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 22.40373134613037
Epoch: 89, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 22.962708234786987
Epoch: 90, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 22.175199031829834
Epoch: 91, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 1325332
model size : 9.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.357527017593384
Epoch: 1, Steps: 89 | Train Loss: 1.274 Vali Loss: 0.507 Vali Acc: 0.849 Test Loss: 0.507 Test Acc: 0.849
Validation loss decreased (inf --> -0.848881).  Saving model ...
Epoch: 2 cost time: 22.557363271713257
Epoch: 2, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.326 Vali Acc: 0.903 Test Loss: 0.326 Test Acc: 0.903
Validation loss decreased (-0.848881 --> -0.902504).  Saving model ...
Epoch: 3 cost time: 22.023601055145264
Epoch: 3, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.267 Vali Acc: 0.921 Test Loss: 0.267 Test Acc: 0.921
Validation loss decreased (-0.902504 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 20.55757737159729
Epoch: 4, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.920610 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 20.7819766998291
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.283 Vali Acc: 0.936 Test Loss: 0.283 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.33902335166931
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.341 Vali Acc: 0.934 Test Loss: 0.341 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.938398122787476
Epoch: 7, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.308 Vali Acc: 0.938 Test Loss: 0.308 Test Acc: 0.938
Validation loss decreased (-0.936627 --> -0.938019).  Saving model ...
Epoch: 8 cost time: 21.900501012802124
Epoch: 8, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.382 Vali Acc: 0.932 Test Loss: 0.382 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.63482403755188
Epoch: 9, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.83958148956299
Epoch: 10, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.425 Vali Acc: 0.931 Test Loss: 0.425 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.605438470840454
Epoch: 11, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.361 Vali Acc: 0.939 Test Loss: 0.361 Test Acc: 0.939
Validation loss decreased (-0.938019 --> -0.939411).  Saving model ...
Epoch: 12 cost time: 22.058886766433716
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.395 Vali Acc: 0.943 Test Loss: 0.395 Test Acc: 0.943
Validation loss decreased (-0.939411 --> -0.942893).  Saving model ...
Epoch: 13 cost time: 21.145873308181763
Epoch: 13, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.457 Vali Acc: 0.929 Test Loss: 0.457 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.420133590698242
Epoch: 14, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.373 Vali Acc: 0.948 Test Loss: 0.373 Test Acc: 0.948
Validation loss decreased (-0.942893 --> -0.947768).  Saving model ...
Epoch: 15 cost time: 21.42152762413025
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.431 Vali Acc: 0.933 Test Loss: 0.431 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.4211528301239
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.358 Vali Acc: 0.958 Test Loss: 0.358 Test Acc: 0.958
Validation loss decreased (-0.947768 --> -0.957517).  Saving model ...
Epoch: 17 cost time: 20.70927596092224
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.434 Vali Acc: 0.943 Test Loss: 0.434 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.462299823760986
Epoch: 18, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.520 Vali Acc: 0.951 Test Loss: 0.520 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.477091312408447
Epoch: 19, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.705 Vali Acc: 0.939 Test Loss: 0.705 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 24.105247497558594
Epoch: 20, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.504 Vali Acc: 0.959 Test Loss: 0.504 Test Acc: 0.959
Validation loss decreased (-0.957517 --> -0.958909).  Saving model ...
Epoch: 21 cost time: 21.381954193115234
Epoch: 21, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.552 Vali Acc: 0.951 Test Loss: 0.552 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 21.170759916305542
Epoch: 22, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.423 Vali Acc: 0.949 Test Loss: 0.423 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 21.65040946006775
Epoch: 23, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.586 Vali Acc: 0.937 Test Loss: 0.586 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 23.515780925750732
Epoch: 24, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.569 Vali Acc: 0.951 Test Loss: 0.569 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 24.052547931671143
Epoch: 25, Steps: 89 | Train Loss: 0.071 Vali Loss: 1.061 Vali Acc: 0.916 Test Loss: 1.061 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 24.601105451583862
Epoch: 26, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.674 Vali Acc: 0.938 Test Loss: 0.674 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 23.541004180908203
Epoch: 27, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.643 Vali Acc: 0.948 Test Loss: 0.643 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 21.975137948989868
Epoch: 28, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.611 Vali Acc: 0.949 Test Loss: 0.611 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 23.230628728866577
Epoch: 29, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.583 Vali Acc: 0.960 Test Loss: 0.583 Test Acc: 0.960
Validation loss decreased (-0.958909 --> -0.959604).  Saving model ...
Epoch: 30 cost time: 23.37689781188965
Epoch: 30, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.448 Vali Acc: 0.966 Test Loss: 0.448 Test Acc: 0.966
Validation loss decreased (-0.959604 --> -0.965873).  Saving model ...
Epoch: 31 cost time: 23.75973343849182
Epoch: 31, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.512 Vali Acc: 0.955 Test Loss: 0.512 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 20.516645908355713
Epoch: 32, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.425 Vali Acc: 0.962 Test Loss: 0.425 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 21.688114881515503
Epoch: 33, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.445 Vali Acc: 0.967 Test Loss: 0.445 Test Acc: 0.967
Validation loss decreased (-0.965873 --> -0.967266).  Saving model ...
Epoch: 34 cost time: 21.247133255004883
Epoch: 34, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.566 Vali Acc: 0.957 Test Loss: 0.566 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 21.629421710968018
Epoch: 35, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.704 Vali Acc: 0.947 Test Loss: 0.704 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 23.864118576049805
Epoch: 36, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.451 Vali Acc: 0.957 Test Loss: 0.451 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 23.579137325286865
Epoch: 37, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.711 Vali Acc: 0.944 Test Loss: 0.711 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 23.316787719726562
Epoch: 38, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.577 Vali Acc: 0.960 Test Loss: 0.577 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 21.763972282409668
Epoch: 39, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.491 Vali Acc: 0.962 Test Loss: 0.491 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 21.85467004776001
Epoch: 40, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.583 Vali Acc: 0.955 Test Loss: 0.583 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 22.374460458755493
Epoch: 41, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.481 Vali Acc: 0.965 Test Loss: 0.481 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 22.065057277679443
Epoch: 42, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.956 Test Loss: 0.637 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 23.498037338256836
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.963 Test Loss: 0.541 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.40229344367981
Epoch: 1, Steps: 89 | Train Loss: 1.329 Vali Loss: 0.603 Vali Acc: 0.820 Test Loss: 0.603 Test Acc: 0.820
Validation loss decreased (inf --> -0.819632).  Saving model ...
Epoch: 2 cost time: 20.662199020385742
Epoch: 2, Steps: 89 | Train Loss: 0.421 Vali Loss: 0.469 Vali Acc: 0.866 Test Loss: 0.469 Test Acc: 0.866
Validation loss decreased (-0.819632 --> -0.865594).  Saving model ...
Epoch: 3 cost time: 21.569565057754517
Epoch: 3, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.301 Vali Acc: 0.916 Test Loss: 0.301 Test Acc: 0.916
Validation loss decreased (-0.865594 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 21.729613304138184
Epoch: 4, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.719605922698975
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.262 Vali Acc: 0.936 Test Loss: 0.262 Test Acc: 0.936
Validation loss decreased (-0.915735 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 24.915008544921875
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.295 Vali Acc: 0.939 Test Loss: 0.295 Test Acc: 0.939
Validation loss decreased (-0.935931 --> -0.938716).  Saving model ...
Epoch: 7 cost time: 23.749199390411377
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
Validation loss decreased (-0.938716 --> -0.951947).  Saving model ...
Epoch: 8 cost time: 22.857645988464355
Epoch: 8, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.118501901626587
Epoch: 9, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.421 Vali Acc: 0.928 Test Loss: 0.421 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.45255136489868
Epoch: 10, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.009376764297485
Epoch: 11, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.428 Vali Acc: 0.930 Test Loss: 0.428 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.031444787979126
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.307 Vali Acc: 0.955 Test Loss: 0.307 Test Acc: 0.955
Validation loss decreased (-0.951947 --> -0.955429).  Saving model ...
Epoch: 13 cost time: 21.18705105781555
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.398162841796875
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.276 Vali Acc: 0.963 Test Loss: 0.276 Test Acc: 0.963
Validation loss decreased (-0.955429 --> -0.963089).  Saving model ...
Epoch: 15 cost time: 22.278021097183228
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.619 Vali Acc: 0.928 Test Loss: 0.619 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.6676344871521
Epoch: 16, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.394 Vali Acc: 0.945 Test Loss: 0.394 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.362895250320435
Epoch: 17, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.539 Vali Acc: 0.938 Test Loss: 0.539 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.158084630966187
Epoch: 18, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.488 Vali Acc: 0.943 Test Loss: 0.488 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 24.100011348724365
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.561 Vali Acc: 0.942 Test Loss: 0.561 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 21.691861391067505
Epoch: 20, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.309 Vali Acc: 0.965 Test Loss: 0.309 Test Acc: 0.965
Validation loss decreased (-0.963089 --> -0.965178).  Saving model ...
Epoch: 21 cost time: 23.66649866104126
Epoch: 21, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.443 Vali Acc: 0.951 Test Loss: 0.443 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 22.138373613357544
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.573 Vali Acc: 0.941 Test Loss: 0.573 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 22.25155282020569
Epoch: 23, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.517 Vali Acc: 0.948 Test Loss: 0.517 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 20.338797569274902
Epoch: 24, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.382 Vali Acc: 0.964 Test Loss: 0.382 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 21.74230718612671
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.469 Vali Acc: 0.945 Test Loss: 0.469 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 21.638683557510376
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 22.04283833503723
Epoch: 27, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.623 Vali Acc: 0.941 Test Loss: 0.623 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 24.24724054336548
Epoch: 28, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.402 Vali Acc: 0.962 Test Loss: 0.402 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 22.811426162719727
Epoch: 29, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.403 Vali Acc: 0.959 Test Loss: 0.403 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 21.77042818069458
Epoch: 30, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.356 Vali Acc: 0.962 Test Loss: 0.356 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.151989459991455
Epoch: 1, Steps: 89 | Train Loss: 1.430 Vali Loss: 0.685 Vali Acc: 0.799 Test Loss: 0.685 Test Acc: 0.799
Validation loss decreased (inf --> -0.798740).  Saving model ...
Epoch: 2 cost time: 22.788907051086426
Epoch: 2, Steps: 89 | Train Loss: 0.453 Vali Loss: 0.573 Vali Acc: 0.857 Test Loss: 0.573 Test Acc: 0.857
Validation loss decreased (-0.798740 --> -0.856540).  Saving model ...
Epoch: 3 cost time: 25.255775451660156
Epoch: 3, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
Validation loss decreased (-0.856540 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 25.332698822021484
Epoch: 4, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.342 Vali Acc: 0.912 Test Loss: 0.342 Test Acc: 0.912
Validation loss decreased (-0.910860 --> -0.911556).  Saving model ...
Epoch: 5 cost time: 21.99113655090332
Epoch: 5, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.312 Vali Acc: 0.927 Test Loss: 0.312 Test Acc: 0.927
Validation loss decreased (-0.911556 --> -0.926877).  Saving model ...
Epoch: 6 cost time: 21.592084407806396
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.354 Vali Acc: 0.931 Test Loss: 0.354 Test Acc: 0.931
Validation loss decreased (-0.926877 --> -0.931055).  Saving model ...
Epoch: 7 cost time: 21.61999797821045
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.269 Vali Acc: 0.939 Test Loss: 0.269 Test Acc: 0.939
Validation loss decreased (-0.931055 --> -0.939412).  Saving model ...
Epoch: 8 cost time: 24.693902730941772
Epoch: 8, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.327 Vali Acc: 0.934 Test Loss: 0.327 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.783583164215088
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.501 Vali Acc: 0.930 Test Loss: 0.501 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.881617546081543
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.351 Vali Acc: 0.952 Test Loss: 0.351 Test Acc: 0.952
Validation loss decreased (-0.939412 --> -0.951946).  Saving model ...
Epoch: 11 cost time: 21.600897550582886
Epoch: 11, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.315 Vali Acc: 0.946 Test Loss: 0.315 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.40972638130188
Epoch: 12, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.370 Vali Acc: 0.942 Test Loss: 0.370 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.80692410469055
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.378 Vali Acc: 0.945 Test Loss: 0.378 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.38740348815918
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.277 Vali Acc: 0.962 Test Loss: 0.277 Test Acc: 0.962
Validation loss decreased (-0.951946 --> -0.962393).  Saving model ...
Epoch: 15 cost time: 25.158601760864258
Epoch: 15, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.322 Vali Acc: 0.956 Test Loss: 0.322 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.326030015945435
Epoch: 16, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.415 Vali Acc: 0.946 Test Loss: 0.415 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 22.101885557174683
Epoch: 17, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.697 Vali Acc: 0.919 Test Loss: 0.697 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 21.601452350616455
Epoch: 18, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.522 Vali Acc: 0.939 Test Loss: 0.522 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 22.103108406066895
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.450 Vali Acc: 0.953 Test Loss: 0.450 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 21.761204719543457
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.354 Vali Acc: 0.954 Test Loss: 0.354 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 23.965909004211426
Epoch: 21, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.532 Vali Acc: 0.930 Test Loss: 0.532 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 21.023446559906006
Epoch: 22, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.503 Vali Acc: 0.939 Test Loss: 0.503 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 21.2632999420166
Epoch: 23, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.543 Vali Acc: 0.948 Test Loss: 0.543 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 22.831393241882324
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.452 Vali Acc: 0.956 Test Loss: 0.452 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.00170874595642
Epoch: 1, Steps: 89 | Train Loss: 1.723 Vali Loss: 0.808 Vali Acc: 0.774 Test Loss: 0.808 Test Acc: 0.774
Validation loss decreased (inf --> -0.774365).  Saving model ...
Epoch: 2 cost time: 24.836129426956177
Epoch: 2, Steps: 89 | Train Loss: 0.487 Vali Loss: 0.508 Vali Acc: 0.854 Test Loss: 0.508 Test Acc: 0.854
Validation loss decreased (-0.774365 --> -0.853755).  Saving model ...
Epoch: 3 cost time: 23.73157286643982
Epoch: 3, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.853755 --> -0.925485).  Saving model ...
Epoch: 4 cost time: 22.242355823516846
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
Validation loss decreased (-0.925485 --> -0.932449).  Saving model ...
Epoch: 5 cost time: 21.857861042022705
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.249 Vali Acc: 0.932 Test Loss: 0.249 Test Acc: 0.932
Validation loss decreased (-0.932449 --> -0.932449).  Saving model ...
Epoch: 6 cost time: 23.3684561252594
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.338 Vali Acc: 0.924 Test Loss: 0.338 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.552231073379517
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.932449 --> -0.937323).  Saving model ...
Epoch: 8 cost time: 22.616467237472534
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.276 Vali Acc: 0.946 Test Loss: 0.276 Test Acc: 0.946
Validation loss decreased (-0.937323 --> -0.946376).  Saving model ...
Epoch: 9 cost time: 20.772618770599365
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.93390917778015
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
Validation loss decreased (-0.946376 --> -0.951947).  Saving model ...
Epoch: 11 cost time: 20.348899364471436
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.562 Vali Acc: 0.905 Test Loss: 0.562 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.34319233894348
Epoch: 12, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.316 Vali Acc: 0.938 Test Loss: 0.316 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.774810314178467
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.363 Vali Acc: 0.945 Test Loss: 0.363 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.369898319244385
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.427 Vali Acc: 0.930 Test Loss: 0.427 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 19.55299973487854
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.423 Vali Acc: 0.938 Test Loss: 0.423 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 21.740208387374878
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.426 Vali Acc: 0.948 Test Loss: 0.426 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 21.856595754623413
Epoch: 17, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.428 Vali Acc: 0.934 Test Loss: 0.428 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 21.325424909591675
Epoch: 18, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.471 Vali Acc: 0.940 Test Loss: 0.471 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 21.495113134384155
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.424 Vali Acc: 0.942 Test Loss: 0.424 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 22.17853355407715
Epoch: 20, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.395 Vali Acc: 0.955 Test Loss: 0.395 Test Acc: 0.955
Validation loss decreased (-0.951947 --> -0.955428).  Saving model ...
Epoch: 21 cost time: 20.586936235427856
Epoch: 21, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.601 Vali Acc: 0.937 Test Loss: 0.601 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 19.747102975845337
Epoch: 22, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.427 Vali Acc: 0.949 Test Loss: 0.427 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 20.999325037002563
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.587 Vali Acc: 0.931 Test Loss: 0.587 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 20.451280117034912
Epoch: 24, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.569 Vali Acc: 0.945 Test Loss: 0.569 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 21.04617738723755
Epoch: 25, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.399 Vali Acc: 0.958 Test Loss: 0.399 Test Acc: 0.958
Validation loss decreased (-0.955428 --> -0.958213).  Saving model ...
Epoch: 26 cost time: 22.185407400131226
Epoch: 26, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.512 Vali Acc: 0.957 Test Loss: 0.512 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 21.661437273025513
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.525 Vali Acc: 0.946 Test Loss: 0.525 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 23.02358102798462
Epoch: 28, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.590 Vali Acc: 0.933 Test Loss: 0.590 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 22.320083141326904
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.491 Vali Acc: 0.956 Test Loss: 0.491 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 23.422922372817993
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.581 Vali Acc: 0.941 Test Loss: 0.581 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 22.158697843551636
Epoch: 31, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.554 Vali Acc: 0.952 Test Loss: 0.554 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 21.420026302337646
Epoch: 32, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.629 Vali Acc: 0.943 Test Loss: 0.629 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 20.70122718811035
Epoch: 33, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.602 Vali Acc: 0.945 Test Loss: 0.602 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 20.118204593658447
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.638 Vali Acc: 0.945 Test Loss: 0.638 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 20.861772775650024
Epoch: 35, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.625 Vali Acc: 0.944 Test Loss: 0.625 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.575104236602783
Epoch: 1, Steps: 89 | Train Loss: 2.195 Vali Loss: 1.384 Vali Acc: 0.578 Test Loss: 1.384 Test Acc: 0.578
Validation loss decreased (inf --> -0.577981).  Saving model ...
Epoch: 2 cost time: 21.387510299682617
Epoch: 2, Steps: 89 | Train Loss: 0.628 Vali Loss: 0.698 Vali Acc: 0.779 Test Loss: 0.698 Test Acc: 0.779
Validation loss decreased (-0.577981 --> -0.778545).  Saving model ...
Epoch: 3 cost time: 21.375221729278564
Epoch: 3, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
Validation loss decreased (-0.778545 --> -0.891362).  Saving model ...
Epoch: 4 cost time: 20.87717866897583
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
Validation loss decreased (-0.891362 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 21.705626249313354
Epoch: 5, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.437 Vali Acc: 0.892 Test Loss: 0.437 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.693302154541016
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.21549081802368
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.254 Vali Acc: 0.942 Test Loss: 0.254 Test Acc: 0.942
Validation loss decreased (-0.938020 --> -0.942198).  Saving model ...
Epoch: 8 cost time: 21.6806480884552
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.942198 --> -0.944287).  Saving model ...
Epoch: 9 cost time: 20.171425342559814
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.298 Vali Acc: 0.932 Test Loss: 0.298 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.222925662994385
Epoch: 10, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.432 Vali Acc: 0.930 Test Loss: 0.432 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.76587963104248
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.517642736434937
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.414 Vali Acc: 0.933 Test Loss: 0.414 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.518731832504272
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.417 Vali Acc: 0.933 Test Loss: 0.417 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 20.05509924888611
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.522 Vali Acc: 0.930 Test Loss: 0.522 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 20.924595594406128
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.361 Vali Acc: 0.944 Test Loss: 0.361 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 21.86199927330017
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.559 Vali Acc: 0.924 Test Loss: 0.559 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 20.145618677139282
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.580 Vali Acc: 0.917 Test Loss: 0.580 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 19.84444546699524
Epoch: 18, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
Validation loss decreased (-0.944287 --> -0.949856).  Saving model ...
Epoch: 19 cost time: 20.976136922836304
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.600 Vali Acc: 0.919 Test Loss: 0.600 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 21.0435848236084
Epoch: 20, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.411 Vali Acc: 0.951 Test Loss: 0.411 Test Acc: 0.951
Validation loss decreased (-0.949856 --> -0.951249).  Saving model ...
Epoch: 21 cost time: 20.44768738746643
Epoch: 21, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.418 Vali Acc: 0.944 Test Loss: 0.418 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 20.10554027557373
Epoch: 22, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.441 Vali Acc: 0.947 Test Loss: 0.441 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 21.318594932556152
Epoch: 23, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.687 Vali Acc: 0.942 Test Loss: 0.687 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 21.36660099029541
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.342 Vali Acc: 0.961 Test Loss: 0.342 Test Acc: 0.961
Validation loss decreased (-0.951249 --> -0.960999).  Saving model ...
Epoch: 25 cost time: 20.47746515274048
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 21.714422464370728
Epoch: 26, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.471 Vali Acc: 0.953 Test Loss: 0.471 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 20.78023862838745
Epoch: 27, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.594 Vali Acc: 0.933 Test Loss: 0.594 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 20.80460524559021
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.402 Vali Acc: 0.963 Test Loss: 0.402 Test Acc: 0.963
Validation loss decreased (-0.960999 --> -0.963088).  Saving model ...
Epoch: 29 cost time: 20.88363742828369
Epoch: 29, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.448 Vali Acc: 0.951 Test Loss: 0.448 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 21.395176887512207
Epoch: 30, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.522 Vali Acc: 0.946 Test Loss: 0.522 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 21.51847505569458
Epoch: 31, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.488 Vali Acc: 0.953 Test Loss: 0.488 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 21.41484260559082
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.535 Vali Acc: 0.953 Test Loss: 0.535 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 22.37349581718445
Epoch: 33, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.385 Vali Acc: 0.960 Test Loss: 0.385 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 22.270201683044434
Epoch: 34, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.496 Vali Acc: 0.957 Test Loss: 0.496 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 21.30538010597229
Epoch: 35, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.554 Vali Acc: 0.951 Test Loss: 0.554 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 20.854599237442017
Epoch: 36, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.803 Vali Acc: 0.928 Test Loss: 0.803 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 21.27280044555664
Epoch: 37, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.673 Vali Acc: 0.955 Test Loss: 0.673 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 20.156014919281006
Epoch: 38, Steps: 89 | Train Loss: 0.110 Vali Loss: 1.249 Vali Acc: 0.923 Test Loss: 1.249 Test Acc: 0.923
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.42168641090393
Epoch: 1, Steps: 89 | Train Loss: 2.213 Vali Loss: 1.571 Vali Acc: 0.481 Test Loss: 1.571 Test Acc: 0.481
Validation loss decreased (inf --> -0.481182).  Saving model ...
Epoch: 2 cost time: 20.28968834877014
Epoch: 2, Steps: 89 | Train Loss: 0.663 Vali Loss: 0.757 Vali Acc: 0.740 Test Loss: 0.757 Test Acc: 0.740
Validation loss decreased (-0.481182 --> -0.740243).  Saving model ...
Epoch: 3 cost time: 19.176859855651855
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.327 Vali Acc: 0.902 Test Loss: 0.327 Test Acc: 0.902
Validation loss decreased (-0.740243 --> -0.901807).  Saving model ...
Epoch: 4 cost time: 18.8785719871521
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.299 Vali Acc: 0.921 Test Loss: 0.299 Test Acc: 0.921
Validation loss decreased (-0.901807 --> -0.921306).  Saving model ...
Epoch: 5 cost time: 20.186403036117554
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.353 Vali Acc: 0.902 Test Loss: 0.353 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.568671226501465
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.279 Vali Acc: 0.935 Test Loss: 0.279 Test Acc: 0.935
Validation loss decreased (-0.921306 --> -0.934538).  Saving model ...
Epoch: 7 cost time: 21.15833854675293
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.934538 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 20.786018133163452
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.264 Vali Acc: 0.940 Test Loss: 0.264 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.805883169174194
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.577965021133423
Epoch: 10, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.326 Vali Acc: 0.923 Test Loss: 0.326 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.178963661193848
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.452 Vali Acc: 0.916 Test Loss: 0.452 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.37533950805664
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.420 Vali Acc: 0.929 Test Loss: 0.420 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 20.779773712158203
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.667 Vali Acc: 0.918 Test Loss: 0.667 Test Acc: 0.918
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.120048999786377
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.376 Vali Acc: 0.943 Test Loss: 0.376 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 19.932332754135132
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.340 Vali Acc: 0.951 Test Loss: 0.340 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 20.161710023880005
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.674 Vali Acc: 0.907 Test Loss: 0.674 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.906935214996338
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.560 Vali Acc: 0.929 Test Loss: 0.560 Test Acc: 0.929
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.521549940109253
Epoch: 1, Steps: 89 | Train Loss: 2.171 Vali Loss: 1.482 Vali Acc: 0.591 Test Loss: 1.482 Test Acc: 0.591
Validation loss decreased (inf --> -0.591211).  Saving model ...
Epoch: 2 cost time: 22.589540481567383
Epoch: 2, Steps: 89 | Train Loss: 0.652 Vali Loss: 0.610 Vali Acc: 0.802 Test Loss: 0.610 Test Acc: 0.802
Validation loss decreased (-0.591211 --> -0.801526).  Saving model ...
Epoch: 3 cost time: 23.043455600738525
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.426 Vali Acc: 0.872 Test Loss: 0.426 Test Acc: 0.872
Validation loss decreased (-0.801526 --> -0.871862).  Saving model ...
Epoch: 4 cost time: 21.21710705757141
Epoch: 4, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.372 Vali Acc: 0.886 Test Loss: 0.372 Test Acc: 0.886
Validation loss decreased (-0.871862 --> -0.885790).  Saving model ...
Epoch: 5 cost time: 20.859270334243774
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.414 Vali Acc: 0.903 Test Loss: 0.414 Test Acc: 0.903
Validation loss decreased (-0.885790 --> -0.902503).  Saving model ...
Epoch: 6 cost time: 19.89954924583435
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.267 Vali Acc: 0.939 Test Loss: 0.267 Test Acc: 0.939
Validation loss decreased (-0.902503 --> -0.939412).  Saving model ...
Epoch: 7 cost time: 20.7977774143219
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.330 Vali Acc: 0.923 Test Loss: 0.330 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.928337812423706
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.372 Vali Acc: 0.919 Test Loss: 0.372 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.08095145225525
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.474 Vali Acc: 0.917 Test Loss: 0.474 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.69484281539917
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.384 Vali Acc: 0.929 Test Loss: 0.384 Test Acc: 0.929
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.748886585235596
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.663 Vali Acc: 0.890 Test Loss: 0.663 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 20.907577991485596
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.367 Vali Acc: 0.934 Test Loss: 0.367 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 24.110103845596313
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.307 Vali Acc: 0.953 Test Loss: 0.307 Test Acc: 0.953
Validation loss decreased (-0.939412 --> -0.952643).  Saving model ...
Epoch: 14 cost time: 22.99001908302307
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.586 Vali Acc: 0.892 Test Loss: 0.586 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.588613986968994
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.755 Vali Acc: 0.889 Test Loss: 0.755 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.82507014274597
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.481 Vali Acc: 0.920 Test Loss: 0.481 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 20.643531560897827
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.809 Vali Acc: 0.892 Test Loss: 0.809 Test Acc: 0.892
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 21.297525644302368
Epoch: 18, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.499 Vali Acc: 0.912 Test Loss: 0.499 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 20.51368761062622
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.497 Vali Acc: 0.930 Test Loss: 0.497 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 21.762266397476196
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.935 Vali Acc: 0.889 Test Loss: 0.935 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 20.835089206695557
Epoch: 21, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.524 Vali Acc: 0.936 Test Loss: 0.524 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 20.492964506149292
Epoch: 22, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.638 Vali Acc: 0.925 Test Loss: 0.638 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 21.66635751724243
Epoch: 23, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.658 Vali Acc: 0.928 Test Loss: 0.658 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9526462395543176
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.56590509414673
Epoch: 1, Steps: 89 | Train Loss: 2.214 Vali Loss: 1.530 Vali Acc: 0.530 Test Loss: 1.530 Test Acc: 0.530
Validation loss decreased (inf --> -0.529929).  Saving model ...
Epoch: 2 cost time: 22.992068767547607
Epoch: 2, Steps: 89 | Train Loss: 0.671 Vali Loss: 0.701 Vali Acc: 0.796 Test Loss: 0.701 Test Acc: 0.796
Validation loss decreased (-0.529929 --> -0.795954).  Saving model ...
Epoch: 3 cost time: 23.860018968582153
Epoch: 3, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
Validation loss decreased (-0.795954 --> -0.802919).  Saving model ...
Epoch: 4 cost time: 23.05088210105896
Epoch: 4, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.555 Vali Acc: 0.855 Test Loss: 0.555 Test Acc: 0.855
Validation loss decreased (-0.802919 --> -0.855148).  Saving model ...
Epoch: 5 cost time: 21.313070058822632
Epoch: 5, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
Validation loss decreased (-0.855148 --> -0.894146).  Saving model ...
Epoch: 6 cost time: 20.621783018112183
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.721 Vali Acc: 0.861 Test Loss: 0.721 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.321991443634033
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.367 Vali Acc: 0.920 Test Loss: 0.367 Test Acc: 0.920
Validation loss decreased (-0.894146 --> -0.919913).  Saving model ...
Epoch: 8 cost time: 21.735076904296875
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.671 Vali Acc: 0.853 Test Loss: 0.671 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.429012775421143
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.726 Vali Acc: 0.861 Test Loss: 0.726 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.157172918319702
Epoch: 10, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.530 Vali Acc: 0.892 Test Loss: 0.530 Test Acc: 0.892
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.231943368911743
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.295020580291748
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.791 Vali Acc: 0.877 Test Loss: 0.791 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 21.020523071289062
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.550 Vali Acc: 0.903 Test Loss: 0.550 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 21.220327854156494
Epoch: 14, Steps: 89 | Train Loss: 0.114 Vali Loss: 1.288 Vali Acc: 0.844 Test Loss: 1.288 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 21.415140867233276
Epoch: 15, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.573 Vali Acc: 0.901 Test Loss: 0.573 Test Acc: 0.901
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 21.419268369674683
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.723 Vali Acc: 0.898 Test Loss: 0.723 Test Acc: 0.898
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.542362928390503
Epoch: 17, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.775 Vali Acc: 0.882 Test Loss: 0.775 Test Acc: 0.882
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.91991643454039
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.116268634796143
Epoch: 1, Steps: 89 | Train Loss: 2.248 Vali Loss: 1.525 Vali Acc: 0.532 Test Loss: 1.525 Test Acc: 0.532
Validation loss decreased (inf --> -0.532018).  Saving model ...
Epoch: 2 cost time: 20.41334319114685
Epoch: 2, Steps: 89 | Train Loss: 0.714 Vali Loss: 0.738 Vali Acc: 0.776 Test Loss: 0.738 Test Acc: 0.776
Validation loss decreased (-0.532018 --> -0.776455).  Saving model ...
Epoch: 3 cost time: 20.57953667640686
Epoch: 3, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.759 Vali Acc: 0.755 Test Loss: 0.759 Test Acc: 0.755
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.13804054260254
Epoch: 4, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.828 Vali Acc: 0.811 Test Loss: 0.828 Test Acc: 0.811
Validation loss decreased (-0.776455 --> -0.811273).  Saving model ...
Epoch: 5 cost time: 21.933406829833984
Epoch: 5, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.439 Vali Acc: 0.886 Test Loss: 0.439 Test Acc: 0.886
Validation loss decreased (-0.811273 --> -0.885789).  Saving model ...
Epoch: 6 cost time: 21.876211643218994
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.727 Vali Acc: 0.862 Test Loss: 0.727 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.57606530189514
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.737244606018066
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.376 Vali Acc: 0.908 Test Loss: 0.376 Test Acc: 0.908
Validation loss decreased (-0.885789 --> -0.908074).  Saving model ...
Epoch: 9 cost time: 21.609946966171265
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.468 Vali Acc: 0.891 Test Loss: 0.468 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.898643970489502
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.899 Vali Acc: 0.827 Test Loss: 0.899 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.283801078796387
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.660 Vali Acc: 0.859 Test Loss: 0.660 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.579681158065796
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.458 Vali Acc: 0.911 Test Loss: 0.458 Test Acc: 0.911
Validation loss decreased (-0.908074 --> -0.910859).  Saving model ...
Epoch: 13 cost time: 20.9031023979187
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 1.030 Vali Acc: 0.878 Test Loss: 1.030 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.187676906585693
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
Validation loss decreased (-0.910859 --> -0.918519).  Saving model ...
Epoch: 15 cost time: 21.0807466506958
Epoch: 15, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.582 Vali Acc: 0.901 Test Loss: 0.582 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.380285501480103
Epoch: 16, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.950 Vali Acc: 0.874 Test Loss: 0.950 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.73160457611084
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 1.371 Vali Acc: 0.875 Test Loss: 1.371 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 21.87664484977722
Epoch: 18, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.692 Vali Acc: 0.906 Test Loss: 0.692 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.69900608062744
Epoch: 19, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.836 Vali Acc: 0.882 Test Loss: 0.836 Test Acc: 0.882
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 21.798325061798096
Epoch: 20, Steps: 89 | Train Loss: 0.124 Vali Loss: 1.018 Vali Acc: 0.882 Test Loss: 1.018 Test Acc: 0.882
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 21.044726371765137
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.701 Vali Acc: 0.905 Test Loss: 0.701 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 21.968169927597046
Epoch: 22, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.987 Vali Acc: 0.870 Test Loss: 0.987 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 21.93235945701599
Epoch: 23, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.727 Vali Acc: 0.905 Test Loss: 0.727 Test Acc: 0.905
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 21.74584412574768
Epoch: 24, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.828 Vali Acc: 0.898 Test Loss: 0.828 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9185236768802229
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.94870948791504
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.054 Test Loss: 2.996 Test Acc: 0.054
Validation loss decreased (inf --> -0.054288).  Saving model ...
Epoch: 2 cost time: 22.509833097457886
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.054288 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 20.880484104156494
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 22.568254470825195
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 21.8854079246521
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 20.71192693710327
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 22.462228775024414
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 21.667802810668945
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 19.58914828300476
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 21.18900179862976
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 21.487300157546997
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 22.039909601211548
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 22.149966955184937
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 20.624338150024414
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 21.894439697265625
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 22.80181860923767
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 19.683652639389038
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 22.451157569885254
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 20.86858057975769
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 20.992700338363647
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 22.75660228729248
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 23.795862436294556
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 22.671015977859497
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 23.955623149871826
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 24.09091281890869
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 21.19865083694458
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 21.448425769805908
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 20.41046142578125
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 21.74428701400757
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 23.645211935043335
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 23.29523539543152
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 21.5429105758667
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 21.312394857406616
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 22.954986810684204
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 22.08725643157959
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 22.861741304397583
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 22.31311869621277
Epoch: 37, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 21.312648057937622
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.3490047454834
Epoch: 39, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 21.094635009765625
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 21.086440324783325
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 21.34677743911743
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 23.18511199951172
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 22.93226671218872
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 23.127779722213745
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 24.42735266685486
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 24.24000644683838
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 23.291252613067627
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 22.895617485046387
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 22.364238262176514
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 20.33931303024292
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 21.61166763305664
Epoch: 52, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 22.092085361480713
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 54 cost time: 20.458784103393555
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 21.600716590881348
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 20.513416051864624
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 22.024296045303345
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 22.27844786643982
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 21.184924602508545
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 60 cost time: 24.135737419128418
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 22.344334363937378
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 22.820624589920044
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 21.98314905166626
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 22.733229160308838
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 21.611043691635132
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 22.630341291427612
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 22.01554226875305
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 68 cost time: 24.211681604385376
Epoch: 68, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 24.23686909675598
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 24.306172847747803
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 25.03279399871826
Epoch: 71, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 22.190879106521606
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 22.88102960586548
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 74 cost time: 25.337834358215332
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 21.644093990325928
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 21.396772384643555
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 21.659005880355835
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 23.20926070213318
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 23.787328004837036
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 22.086227416992188
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 22.926340341567993
Epoch: 81, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 21.366984605789185
Epoch: 82, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 21.90078568458557
Epoch: 83, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 1227028
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.27257513999939
Epoch: 1, Steps: 89 | Train Loss: 1.446 Vali Loss: 0.597 Vali Acc: 0.849 Test Loss: 0.597 Test Acc: 0.849
Validation loss decreased (inf --> -0.848880).  Saving model ...
Epoch: 2 cost time: 23.886150360107422
Epoch: 2, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.335 Vali Acc: 0.902 Test Loss: 0.335 Test Acc: 0.902
Validation loss decreased (-0.848880 --> -0.901807).  Saving model ...
Epoch: 3 cost time: 21.68506383895874
Epoch: 3, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.901807 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 21.78937005996704
Epoch: 4, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.933145 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 24.619438886642456
Epoch: 5, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (-0.944288 --> -0.959609).  Saving model ...
Epoch: 6 cost time: 21.985525369644165
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.006667852401733
Epoch: 7, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.235 Vali Acc: 0.942 Test Loss: 0.235 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.351713180541992
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.959609 --> -0.965179).  Saving model ...
Epoch: 9 cost time: 20.521388292312622
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.258355855941772
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.982704639434814
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.249 Vali Acc: 0.951 Test Loss: 0.249 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.000396490097046
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.324 Vali Acc: 0.938 Test Loss: 0.324 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.083532333374023
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.251 Vali Acc: 0.955 Test Loss: 0.251 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 22.68466329574585
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.40326428413391
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.235 Vali Acc: 0.964 Test Loss: 0.235 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 22.411509037017822
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 21.787959575653076
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 22.678516626358032
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.10147261619568
Epoch: 1, Steps: 89 | Train Loss: 1.503 Vali Loss: 0.665 Vali Acc: 0.819 Test Loss: 0.665 Test Acc: 0.819
Validation loss decreased (inf --> -0.818935).  Saving model ...
Epoch: 2 cost time: 20.855985403060913
Epoch: 2, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.393 Vali Acc: 0.883 Test Loss: 0.393 Test Acc: 0.883
Validation loss decreased (-0.818935 --> -0.883004).  Saving model ...
Epoch: 3 cost time: 22.561484336853027
Epoch: 3, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.273 Vali Acc: 0.918 Test Loss: 0.273 Test Acc: 0.918
Validation loss decreased (-0.883004 --> -0.917825).  Saving model ...
Epoch: 4 cost time: 22.28227472305298
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.283 Vali Acc: 0.918 Test Loss: 0.283 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.27005958557129
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.225 Vali Acc: 0.931 Test Loss: 0.225 Test Acc: 0.931
Validation loss decreased (-0.917825 --> -0.931056).  Saving model ...
Epoch: 6 cost time: 22.782286405563354
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.234 Vali Acc: 0.939 Test Loss: 0.234 Test Acc: 0.939
Validation loss decreased (-0.931056 --> -0.939413).  Saving model ...
Epoch: 7 cost time: 23.960331916809082
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.64404821395874
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.558105945587158
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.939413 --> -0.942895).  Saving model ...
Epoch: 10 cost time: 20.409533739089966
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 20.0662841796875
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.246 Vali Acc: 0.940 Test Loss: 0.246 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.111586093902588
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.295 Vali Acc: 0.932 Test Loss: 0.295 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 21.187647819519043
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 21.27802538871765
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.323 Vali Acc: 0.937 Test Loss: 0.323 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 20.920064210891724
Epoch: 15, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.414 Vali Acc: 0.921 Test Loss: 0.414 Test Acc: 0.921
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 20.523783445358276
Epoch: 16, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 22.102585792541504
Epoch: 17, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.406 Vali Acc: 0.937 Test Loss: 0.406 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 21.359595775604248
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.942895 --> -0.949857).  Saving model ...
Epoch: 19 cost time: 20.872230291366577
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
Validation loss decreased (-0.949857 --> -0.963786).  Saving model ...
Epoch: 20 cost time: 21.262502193450928
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.319 Vali Acc: 0.956 Test Loss: 0.319 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.308335065841675
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.303 Vali Acc: 0.947 Test Loss: 0.303 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 20.85769009590149
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.961 Test Loss: 0.243 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 20.45856809616089
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.256 Vali Acc: 0.954 Test Loss: 0.256 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 22.435017585754395
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 21.289393186569214
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.283 Vali Acc: 0.953 Test Loss: 0.283 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.349032878875732
Epoch: 26, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.300 Vali Acc: 0.960 Test Loss: 0.300 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 20.327220916748047
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 21.125587224960327
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.343 Vali Acc: 0.946 Test Loss: 0.343 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 20.913230180740356
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.391 Vali Acc: 0.939 Test Loss: 0.391 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.631266593933105
Epoch: 1, Steps: 89 | Train Loss: 1.613 Vali Loss: 0.746 Vali Acc: 0.798 Test Loss: 0.746 Test Acc: 0.798
Validation loss decreased (inf --> -0.798043).  Saving model ...
Epoch: 2 cost time: 23.691341876983643
Epoch: 2, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.446 Vali Acc: 0.868 Test Loss: 0.446 Test Acc: 0.868
Validation loss decreased (-0.798043 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 20.97753405570984
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.375 Vali Acc: 0.890 Test Loss: 0.375 Test Acc: 0.890
Validation loss decreased (-0.868380 --> -0.889968).  Saving model ...
Epoch: 4 cost time: 22.966353178024292
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.264 Vali Acc: 0.927 Test Loss: 0.264 Test Acc: 0.927
Validation loss decreased (-0.889968 --> -0.926878).  Saving model ...
Epoch: 5 cost time: 20.57159423828125
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.301 Vali Acc: 0.920 Test Loss: 0.301 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.07758402824402
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.926878 --> -0.942895).  Saving model ...
Epoch: 7 cost time: 20.848392009735107
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.264 Vali Acc: 0.934 Test Loss: 0.264 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.892947673797607
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.226 Vali Acc: 0.936 Test Loss: 0.226 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.673441886901855
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.89342713356018
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.266 Vali Acc: 0.940 Test Loss: 0.266 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.78295660018921
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 22.931132316589355
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 23.753249645233154
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.242 Vali Acc: 0.946 Test Loss: 0.242 Test Acc: 0.946
Validation loss decreased (-0.942895 --> -0.946376).  Saving model ...
Epoch: 14 cost time: 23.42876410484314
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.267 Vali Acc: 0.942 Test Loss: 0.267 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.563783168792725
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.331 Vali Acc: 0.932 Test Loss: 0.331 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.01671290397644
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.395 Vali Acc: 0.921 Test Loss: 0.395 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 21.684340476989746
Epoch: 17, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.341 Vali Acc: 0.940 Test Loss: 0.341 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 23.186084508895874
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.4836266040802
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.946376 --> -0.949857).  Saving model ...
Epoch: 20 cost time: 23.37908935546875
Epoch: 20, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.617 Vali Acc: 0.896 Test Loss: 0.617 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.767990589141846
Epoch: 21, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.388 Vali Acc: 0.947 Test Loss: 0.388 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.96223473548889
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.362 Vali Acc: 0.942 Test Loss: 0.362 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 23.41118288040161
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.381 Vali Acc: 0.946 Test Loss: 0.381 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 21.498289346694946
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.422 Vali Acc: 0.930 Test Loss: 0.422 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 23.2602756023407
Epoch: 25, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.393 Vali Acc: 0.937 Test Loss: 0.393 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 23.364108085632324
Epoch: 26, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.471 Vali Acc: 0.928 Test Loss: 0.471 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 22.25806450843811
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.597 Vali Acc: 0.934 Test Loss: 0.597 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.138657808303833
Epoch: 28, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.445 Vali Acc: 0.940 Test Loss: 0.445 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 23.510311365127563
Epoch: 29, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.339 Vali Acc: 0.959 Test Loss: 0.339 Test Acc: 0.959
Validation loss decreased (-0.949857 --> -0.958910).  Saving model ...
Epoch: 30 cost time: 23.349653005599976
Epoch: 30, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.354 Vali Acc: 0.959 Test Loss: 0.354 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 22.948343515396118
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.374 Vali Acc: 0.951 Test Loss: 0.374 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 21.47767734527588
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.424 Vali Acc: 0.943 Test Loss: 0.424 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 20.861919164657593
Epoch: 33, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.466 Vali Acc: 0.936 Test Loss: 0.466 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 21.2510769367218
Epoch: 34, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.450 Vali Acc: 0.944 Test Loss: 0.450 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 22.63326120376587
Epoch: 35, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.419 Vali Acc: 0.948 Test Loss: 0.419 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 22.83163046836853
Epoch: 36, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.351 Vali Acc: 0.958 Test Loss: 0.351 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 21.832653522491455
Epoch: 37, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.347 Vali Acc: 0.949 Test Loss: 0.347 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 21.29541516304016
Epoch: 38, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.397 Vali Acc: 0.945 Test Loss: 0.397 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 22.958869218826294
Epoch: 39, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.369 Vali Acc: 0.948 Test Loss: 0.369 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.04042363166809
Epoch: 1, Steps: 89 | Train Loss: 1.980 Vali Loss: 0.928 Vali Acc: 0.760 Test Loss: 0.928 Test Acc: 0.760
Validation loss decreased (inf --> -0.760436).  Saving model ...
Epoch: 2 cost time: 24.240282773971558
Epoch: 2, Steps: 89 | Train Loss: 0.617 Vali Loss: 0.457 Vali Acc: 0.867 Test Loss: 0.457 Test Acc: 0.867
Validation loss decreased (-0.760436 --> -0.866987).  Saving model ...
Epoch: 3 cost time: 22.465734004974365
Epoch: 3, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.380 Vali Acc: 0.883 Test Loss: 0.380 Test Acc: 0.883
Validation loss decreased (-0.866987 --> -0.883005).  Saving model ...
Epoch: 4 cost time: 21.815740823745728
Epoch: 4, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.269 Vali Acc: 0.915 Test Loss: 0.269 Test Acc: 0.915
Validation loss decreased (-0.883005 --> -0.915039).  Saving model ...
Epoch: 5 cost time: 24.053587198257446
Epoch: 5, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.268 Vali Acc: 0.921 Test Loss: 0.268 Test Acc: 0.921
Validation loss decreased (-0.915039 --> -0.921307).  Saving model ...
Epoch: 6 cost time: 22.04041314125061
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
Validation loss decreased (-0.921307 --> -0.925485).  Saving model ...
Epoch: 7 cost time: 24.19737935066223
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.925485 --> -0.940805).  Saving model ...
Epoch: 8 cost time: 24.19090485572815
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.534658670425415
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.575953483581543
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.288 Vali Acc: 0.932 Test Loss: 0.288 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.86113953590393
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.382 Vali Acc: 0.908 Test Loss: 0.382 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.589060068130493
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.297 Vali Acc: 0.935 Test Loss: 0.297 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.872216939926147
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.267 Vali Acc: 0.946 Test Loss: 0.267 Test Acc: 0.946
Validation loss decreased (-0.940805 --> -0.945680).  Saving model ...
Epoch: 14 cost time: 23.951510190963745
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
Validation loss decreased (-0.945680 --> -0.958215).  Saving model ...
Epoch: 15 cost time: 21.769989490509033
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 20.42712926864624
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.357 Vali Acc: 0.924 Test Loss: 0.357 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 19.97537612915039
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.306 Vali Acc: 0.939 Test Loss: 0.306 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.693015575408936
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.268 Vali Acc: 0.954 Test Loss: 0.268 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 23.58565926551819
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.362 Vali Acc: 0.930 Test Loss: 0.362 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 23.408490896224976
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.389 Vali Acc: 0.941 Test Loss: 0.389 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 22.324750900268555
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.386 Vali Acc: 0.949 Test Loss: 0.386 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 21.248291492462158
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.452 Vali Acc: 0.935 Test Loss: 0.452 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 22.059406042099
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.444 Vali Acc: 0.932 Test Loss: 0.444 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 21.87118172645569
Epoch: 24, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.352 Vali Acc: 0.951 Test Loss: 0.352 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.958217270194986
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.047266960144043
Epoch: 1, Steps: 89 | Train Loss: 2.519 Vali Loss: 1.874 Vali Acc: 0.460 Test Loss: 1.874 Test Acc: 0.460
Validation loss decreased (inf --> -0.459591).  Saving model ...
Epoch: 2 cost time: 20.94599223136902
Epoch: 2, Steps: 89 | Train Loss: 1.009 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
Validation loss decreased (-0.459591 --> -0.804311).  Saving model ...
Epoch: 3 cost time: 20.915045022964478
Epoch: 3, Steps: 89 | Train Loss: 0.377 Vali Loss: 0.335 Vali Acc: 0.909 Test Loss: 0.335 Test Acc: 0.909
Validation loss decreased (-0.804311 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 20.993193864822388
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.232 Vali Acc: 0.934 Test Loss: 0.232 Test Acc: 0.934
Validation loss decreased (-0.908771 --> -0.933842).  Saving model ...
Epoch: 5 cost time: 23.753124713897705
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.207 Vali Acc: 0.939 Test Loss: 0.207 Test Acc: 0.939
Validation loss decreased (-0.933842 --> -0.938717).  Saving model ...
Epoch: 6 cost time: 23.740765810012817
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
Validation loss decreased (-0.938717 --> -0.953341).  Saving model ...
Epoch: 7 cost time: 23.25805401802063
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.236 Vali Acc: 0.939 Test Loss: 0.236 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.123231649398804
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
Validation loss decreased (-0.953341 --> -0.954037).  Saving model ...
Epoch: 9 cost time: 20.949087858200073
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.17734980583191
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958215).  Saving model ...
Epoch: 11 cost time: 22.176562309265137
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.96267819404602
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.220181703567505
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
Validation loss decreased (-0.958215 --> -0.960305).  Saving model ...
Epoch: 14 cost time: 21.197591304779053
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.966572).  Saving model ...
Epoch: 15 cost time: 21.36786913871765
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.955 Test Loss: 0.227 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 23.13560438156128
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.295 Vali Acc: 0.939 Test Loss: 0.295 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.570818424224854
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.250 Vali Acc: 0.940 Test Loss: 0.250 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 21.90547752380371
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 20.33086895942688
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 22.361830234527588
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.296 Vali Acc: 0.939 Test Loss: 0.296 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 22.68489670753479
Epoch: 21, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.329 Vali Acc: 0.935 Test Loss: 0.329 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 22.883365631103516
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.962 Test Loss: 0.209 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 23.58023953437805
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.287 Vali Acc: 0.954 Test Loss: 0.287 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 22.43336510658264
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.959 Test Loss: 0.236 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.39657711982727
Epoch: 1, Steps: 89 | Train Loss: 2.544 Vali Loss: 2.337 Vali Acc: 0.281 Test Loss: 2.337 Test Acc: 0.281
Validation loss decreased (inf --> -0.280617).  Saving model ...
Epoch: 2 cost time: 22.852569103240967
Epoch: 2, Steps: 89 | Train Loss: 1.074 Vali Loss: 0.694 Vali Acc: 0.799 Test Loss: 0.694 Test Acc: 0.799
Validation loss decreased (-0.280617 --> -0.798740).  Saving model ...
Epoch: 3 cost time: 23.817352533340454
Epoch: 3, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.369 Vali Acc: 0.898 Test Loss: 0.369 Test Acc: 0.898
Validation loss decreased (-0.798740 --> -0.898325).  Saving model ...
Epoch: 4 cost time: 22.393413543701172
Epoch: 4, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.356 Vali Acc: 0.890 Test Loss: 0.356 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.286947011947632
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
Validation loss decreased (-0.898325 --> -0.945681).  Saving model ...
Epoch: 6 cost time: 20.639246463775635
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.254 Vali Acc: 0.942 Test Loss: 0.254 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.728036642074585
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.945681 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 21.489078283309937
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.951948 --> -0.963090).  Saving model ...
Epoch: 9 cost time: 22.078246355056763
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.192168712615967
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.978495836257935
Epoch: 11, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.5635724067688
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.017234086990356
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 22.752475261688232
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 22.96907663345337
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 22.54790496826172
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 21.493475675582886
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 21.14043688774109
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
Validation loss decreased (-0.963090 --> -0.965179).  Saving model ...
Epoch: 19 cost time: 20.489864349365234
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.321 Vali Acc: 0.955 Test Loss: 0.321 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 21.811265230178833
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.06860089302063
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.419 Vali Acc: 0.932 Test Loss: 0.419 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 21.9233660697937
Epoch: 22, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.259 Vali Acc: 0.958 Test Loss: 0.259 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 20.54376459121704
Epoch: 23, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.418 Vali Acc: 0.943 Test Loss: 0.418 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 21.723175048828125
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.292 Vali Acc: 0.958 Test Loss: 0.292 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 18.824263095855713
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.281 Vali Acc: 0.958 Test Loss: 0.281 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 21.764479160308838
Epoch: 26, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.271 Vali Acc: 0.962 Test Loss: 0.271 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 20.406374216079712
Epoch: 27, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 20.85596990585327
Epoch: 28, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.771873950958252
Epoch: 1, Steps: 89 | Train Loss: 2.521 Vali Loss: 2.151 Vali Acc: 0.403 Test Loss: 2.151 Test Acc: 0.403
Validation loss decreased (inf --> -0.402485).  Saving model ...
Epoch: 2 cost time: 21.592201948165894
Epoch: 2, Steps: 89 | Train Loss: 1.103 Vali Loss: 0.931 Vali Acc: 0.723 Test Loss: 0.931 Test Acc: 0.723
Validation loss decreased (-0.402485 --> -0.722832).  Saving model ...
Epoch: 3 cost time: 23.654846906661987
Epoch: 3, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.493 Vali Acc: 0.847 Test Loss: 0.493 Test Acc: 0.847
Validation loss decreased (-0.722832 --> -0.847488).  Saving model ...
Epoch: 4 cost time: 24.06696391105652
Epoch: 4, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.558 Vali Acc: 0.830 Test Loss: 0.558 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.430923461914062
Epoch: 5, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.231 Vali Acc: 0.931 Test Loss: 0.231 Test Acc: 0.931
Validation loss decreased (-0.847488 --> -0.931056).  Saving model ...
Epoch: 6 cost time: 22.453493356704712
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
Validation loss decreased (-0.931056 --> -0.942895).  Saving model ...
Epoch: 7 cost time: 21.169259309768677
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.574822664260864
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.217504739761353
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.935 Test Loss: 0.254 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.97328281402588
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 20.13926386833191
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.942895 --> -0.944287).  Saving model ...
Epoch: 12 cost time: 20.852110624313354
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
Validation loss decreased (-0.944287 --> -0.947769).  Saving model ...
Epoch: 13 cost time: 21.800080060958862
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.220 Vali Acc: 0.954 Test Loss: 0.220 Test Acc: 0.954
Validation loss decreased (-0.947769 --> -0.954037).  Saving model ...
Epoch: 14 cost time: 21.77968716621399
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
Validation loss decreased (-0.954037 --> -0.961001).  Saving model ...
Epoch: 15 cost time: 22.689577341079712
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.202 Vali Acc: 0.962 Test Loss: 0.202 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 16 cost time: 22.934733629226685
Epoch: 16, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 20.913079500198364
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.269 Vali Acc: 0.960 Test Loss: 0.269 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 20.039575576782227
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.234 Vali Acc: 0.958 Test Loss: 0.234 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 20.260655164718628
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.298 Vali Acc: 0.955 Test Loss: 0.298 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.74747323989868
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.293 Vali Acc: 0.959 Test Loss: 0.293 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 21.031071186065674
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.273 Vali Acc: 0.960 Test Loss: 0.273 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.06124472618103
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.310 Vali Acc: 0.959 Test Loss: 0.310 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 21.372518301010132
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.340 Vali Acc: 0.948 Test Loss: 0.340 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 20.24599051475525
Epoch: 24, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.284 Vali Acc: 0.958 Test Loss: 0.284 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 20.961961030960083
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.333 Vali Acc: 0.946 Test Loss: 0.333 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.913033723831177
Epoch: 1, Steps: 89 | Train Loss: 2.566 Vali Loss: 1.983 Vali Acc: 0.436 Test Loss: 1.983 Test Acc: 0.436
Validation loss decreased (inf --> -0.435913).  Saving model ...
Epoch: 2 cost time: 21.789809703826904
Epoch: 2, Steps: 89 | Train Loss: 1.180 Vali Loss: 1.138 Vali Acc: 0.649 Test Loss: 1.138 Test Acc: 0.649
Validation loss decreased (-0.435913 --> -0.649014).  Saving model ...
Epoch: 3 cost time: 20.342285871505737
Epoch: 3, Steps: 89 | Train Loss: 0.506 Vali Loss: 0.847 Vali Acc: 0.742 Test Loss: 0.847 Test Acc: 0.742
Validation loss decreased (-0.649014 --> -0.741635).  Saving model ...
Epoch: 4 cost time: 20.33485436439514
Epoch: 4, Steps: 89 | Train Loss: 0.316 Vali Loss: 1.082 Vali Acc: 0.693 Test Loss: 1.082 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.169917106628418
Epoch: 5, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
Validation loss decreased (-0.741635 --> -0.832864).  Saving model ...
Epoch: 6 cost time: 20.583083152770996
Epoch: 6, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.466 Vali Acc: 0.857 Test Loss: 0.466 Test Acc: 0.857
Validation loss decreased (-0.832864 --> -0.856541).  Saving model ...
Epoch: 7 cost time: 22.036091566085815
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.495 Vali Acc: 0.865 Test Loss: 0.495 Test Acc: 0.865
Validation loss decreased (-0.856541 --> -0.864898).  Saving model ...
Epoch: 8 cost time: 21.911131143569946
Epoch: 8, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.344 Vali Acc: 0.889 Test Loss: 0.344 Test Acc: 0.889
Validation loss decreased (-0.864898 --> -0.889272).  Saving model ...
Epoch: 9 cost time: 20.191375255584717
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.407 Vali Acc: 0.879 Test Loss: 0.407 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.23630714416504
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.404 Vali Acc: 0.894 Test Loss: 0.404 Test Acc: 0.894
Validation loss decreased (-0.889272 --> -0.894146).  Saving model ...
Epoch: 11 cost time: 22.215542316436768
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.340 Vali Acc: 0.902 Test Loss: 0.340 Test Acc: 0.902
Validation loss decreased (-0.894146 --> -0.901807).  Saving model ...
Epoch: 12 cost time: 23.092828273773193
Epoch: 12, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.395 Vali Acc: 0.905 Test Loss: 0.395 Test Acc: 0.905
Validation loss decreased (-0.901807 --> -0.905289).  Saving model ...
Epoch: 13 cost time: 22.437203645706177
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.905289 --> -0.944288).  Saving model ...
Epoch: 14 cost time: 20.43824076652527
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.701736211776733
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.274 Vali Acc: 0.936 Test Loss: 0.274 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.728124618530273
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.351 Vali Acc: 0.921 Test Loss: 0.351 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 22.323349237442017
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.280 Vali Acc: 0.947 Test Loss: 0.280 Test Acc: 0.947
Validation loss decreased (-0.944288 --> -0.947072).  Saving model ...
Epoch: 18 cost time: 22.36292052268982
Epoch: 18, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.218 Vali Acc: 0.960 Test Loss: 0.218 Test Acc: 0.960
Validation loss decreased (-0.947072 --> -0.959608).  Saving model ...
Epoch: 19 cost time: 22.3805832862854
Epoch: 19, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.406 Vali Acc: 0.922 Test Loss: 0.406 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 20.95054531097412
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 21.562978267669678
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.283 Vali Acc: 0.956 Test Loss: 0.283 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 21.187385320663452
Epoch: 22, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.330 Vali Acc: 0.943 Test Loss: 0.330 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 22.518903255462646
Epoch: 23, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 21.396268606185913
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.322 Vali Acc: 0.951 Test Loss: 0.322 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 20.997236728668213
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.290 Vali Acc: 0.959 Test Loss: 0.290 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 19.793641805648804
Epoch: 26, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.275 Vali Acc: 0.949 Test Loss: 0.275 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 20.40380024909973
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.275 Vali Acc: 0.959 Test Loss: 0.275 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 21.195930004119873
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.271 Vali Acc: 0.960 Test Loss: 0.271 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9596100278551533
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.146706342697144
Epoch: 1, Steps: 89 | Train Loss: 2.616 Vali Loss: 2.019 Vali Acc: 0.428 Test Loss: 2.019 Test Acc: 0.428
Validation loss decreased (inf --> -0.428253).  Saving model ...
Epoch: 2 cost time: 23.550121068954468
Epoch: 2, Steps: 89 | Train Loss: 1.200 Vali Loss: 1.068 Vali Acc: 0.687 Test Loss: 1.068 Test Acc: 0.687
Validation loss decreased (-0.428253 --> -0.686619).  Saving model ...
Epoch: 3 cost time: 22.411912202835083
Epoch: 3, Steps: 89 | Train Loss: 0.522 Vali Loss: 0.714 Vali Acc: 0.760 Test Loss: 0.714 Test Acc: 0.760
Validation loss decreased (-0.686619 --> -0.760439).  Saving model ...
Epoch: 4 cost time: 23.590988397598267
Epoch: 4, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.1089506149292
Epoch: 5, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
Validation loss decreased (-0.760439 --> -0.894147).  Saving model ...
Epoch: 6 cost time: 24.502187728881836
Epoch: 6, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.394 Vali Acc: 0.892 Test Loss: 0.394 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.645314931869507
Epoch: 7, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.306 Vali Acc: 0.923 Test Loss: 0.306 Test Acc: 0.923
Validation loss decreased (-0.894147 --> -0.923395).  Saving model ...
Epoch: 8 cost time: 23.04245352745056
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.294 Vali Acc: 0.915 Test Loss: 0.294 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.39312767982483
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.454 Vali Acc: 0.868 Test Loss: 0.454 Test Acc: 0.868
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.51930332183838
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.448 Vali Acc: 0.899 Test Loss: 0.448 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.000521898269653
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.923395 --> -0.947769).  Saving model ...
Epoch: 12 cost time: 22.233028888702393
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.285 Vali Acc: 0.935 Test Loss: 0.285 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.113964796066284
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.447 Vali Acc: 0.879 Test Loss: 0.447 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.994768381118774
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
Validation loss decreased (-0.947769 --> -0.948465).  Saving model ...
Epoch: 15 cost time: 21.82913374900818
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.355 Vali Acc: 0.921 Test Loss: 0.355 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.946390867233276
Epoch: 16, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.476429224014282
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.948465 --> -0.949858).  Saving model ...
Epoch: 18 cost time: 21.258570671081543
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 22.726274251937866
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.356 Vali Acc: 0.942 Test Loss: 0.356 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 24.511847019195557
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.295 Vali Acc: 0.948 Test Loss: 0.295 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.881475925445557
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.261 Vali Acc: 0.957 Test Loss: 0.261 Test Acc: 0.957
Validation loss decreased (-0.949858 --> -0.956822).  Saving model ...
Epoch: 22 cost time: 20.587071418762207
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
Validation loss decreased (-0.956822 --> -0.958911).  Saving model ...
Epoch: 23 cost time: 21.66563391685486
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.313 Vali Acc: 0.951 Test Loss: 0.313 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 24.300714254379272
Epoch: 24, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.395 Vali Acc: 0.932 Test Loss: 0.395 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 23.987928867340088
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.302 Vali Acc: 0.956 Test Loss: 0.302 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 24.425030946731567
Epoch: 26, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.426 Vali Acc: 0.932 Test Loss: 0.426 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 23.613687753677368
Epoch: 27, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.379 Vali Acc: 0.946 Test Loss: 0.379 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 23.3880352973938
Epoch: 28, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.458 Vali Acc: 0.930 Test Loss: 0.458 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 23.91483187675476
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.467 Vali Acc: 0.939 Test Loss: 0.467 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 26.097917556762695
Epoch: 30, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.400 Vali Acc: 0.943 Test Loss: 0.400 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 23.081104516983032
Epoch: 31, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.554 Vali Acc: 0.928 Test Loss: 0.554 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 21.902316331863403
Epoch: 32, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.332 Vali Acc: 0.957 Test Loss: 0.332 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.11694312095642
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.042 Test Loss: 2.996 Test Acc: 0.042
Validation loss decreased (inf --> -0.041753).  Saving model ...
Epoch: 2 cost time: 23.847477912902832
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.041753 --> -0.059859).  Saving model ...
Epoch: 3 cost time: 22.860431432724
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (-0.059859 --> -0.059859).  Saving model ...
Epoch: 4 cost time: 22.0340518951416
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.060 Test Loss: 2.994 Test Acc: 0.060
Validation loss decreased (-0.059859 --> -0.059859).  Saving model ...
Epoch: 5 cost time: 20.997823238372803
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.059859 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 20.466081380844116
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 20.153592348098755
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 20.84212374687195
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 22.23106837272644
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 21.97087073326111
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 21.748629808425903
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 21.751773595809937
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 22.4884991645813
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 23.96625018119812
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 22.341090440750122
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 20.10218381881714
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 21.276390075683594
Epoch: 17, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 20.116811275482178
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 19.960654973983765
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 21.708269119262695
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 21.959824085235596
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 21.618319749832153
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 21.189132928848267
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 22.5150887966156
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 22.53258180618286
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 24.016913890838623
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 25.169899940490723
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 23.819372177124023
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 21.597508668899536
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 23.149226665496826
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 23.847734212875366
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 25.038292169570923
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 24.019619703292847
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 24.040143489837646
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 22.59389090538025
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 23.012115716934204
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 23.829182386398315
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 21.491212606430054
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.706557750701904
Epoch: 39, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 21.313464403152466
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 23.979211807250977
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 22.709378242492676
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 22.0735125541687
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 21.62845492362976
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 22.187771320343018
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 23.367725610733032
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 22.18985390663147
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 23.384774446487427
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 22.156141996383667
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 21.37728476524353
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 22.915069341659546
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 22.868608713150024
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 23.782522439956665
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 23.245940923690796
Epoch: 54, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 55 cost time: 24.07441759109497
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 21.57446265220642
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 22.440289974212646
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 23.116177558898926
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 20.828836679458618
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 20.948099613189697
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 22.074245929718018
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 24.872325897216797
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 24.03385615348816
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 21.925235748291016
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 1186964
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.27327823638916
Epoch: 1, Steps: 89 | Train Loss: 1.486 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
Validation loss decreased (inf --> -0.838435).  Saving model ...
Epoch: 2 cost time: 25.276596784591675
Epoch: 2, Steps: 89 | Train Loss: 0.377 Vali Loss: 0.322 Vali Acc: 0.904 Test Loss: 0.322 Test Acc: 0.904
Validation loss decreased (-0.838435 --> -0.903896).  Saving model ...
Epoch: 3 cost time: 22.378395080566406
Epoch: 3, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.286 Vali Acc: 0.916 Test Loss: 0.286 Test Acc: 0.916
Validation loss decreased (-0.903896 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 24.326331615447998
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.915735 --> -0.934538).  Saving model ...
Epoch: 5 cost time: 20.532776594161987
Epoch: 5, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.934538 --> -0.946377).  Saving model ...
Epoch: 6 cost time: 21.583571672439575
Epoch: 6, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.946377 --> -0.965179).  Saving model ...
Epoch: 7 cost time: 22.404403686523438
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.364269733428955
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.264 Vali Acc: 0.928 Test Loss: 0.264 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.78447198867798
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.239 Vali Acc: 0.942 Test Loss: 0.239 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.632428646087646
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.303 Vali Acc: 0.939 Test Loss: 0.303 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.718682050704956
Epoch: 11, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.306 Vali Acc: 0.946 Test Loss: 0.306 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.28122639656067
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.316 Vali Acc: 0.946 Test Loss: 0.316 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 22.674312353134155
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.264 Vali Acc: 0.957 Test Loss: 0.264 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 23.60143494606018
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.265 Vali Acc: 0.951 Test Loss: 0.265 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 24.535253047943115
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.249 Vali Acc: 0.961 Test Loss: 0.249 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 24.379032850265503
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.360 Vali Acc: 0.936 Test Loss: 0.360 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.33312225341797
Epoch: 1, Steps: 89 | Train Loss: 1.550 Vali Loss: 0.627 Vali Acc: 0.802 Test Loss: 0.627 Test Acc: 0.802
Validation loss decreased (inf --> -0.802222).  Saving model ...
Epoch: 2 cost time: 22.724015712738037
Epoch: 2, Steps: 89 | Train Loss: 0.449 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.802222 --> -0.888576).  Saving model ...
Epoch: 3 cost time: 24.269575595855713
Epoch: 3, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.382 Vali Acc: 0.887 Test Loss: 0.382 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.74188756942749
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
Validation loss decreased (-0.888576 --> -0.927574).  Saving model ...
Epoch: 5 cost time: 24.225372791290283
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
Validation loss decreased (-0.927574 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 22.800734996795654
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
Validation loss decreased (-0.942895 --> -0.950555).  Saving model ...
Epoch: 7 cost time: 22.348959922790527
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.84116816520691
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.259 Vali Acc: 0.935 Test Loss: 0.259 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.276845455169678
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.014813899993896
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 24.842085361480713
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.249320030212402
Epoch: 12, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.428 Vali Acc: 0.912 Test Loss: 0.428 Test Acc: 0.912
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 25.056551694869995
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.317 Vali Acc: 0.939 Test Loss: 0.317 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 26.019635438919067
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.296 Vali Acc: 0.946 Test Loss: 0.296 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.324610710144043
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
Validation loss decreased (-0.950555 --> -0.951947).  Saving model ...
Epoch: 16 cost time: 22.135734796524048
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.267 Vali Acc: 0.955 Test Loss: 0.267 Test Acc: 0.955
Validation loss decreased (-0.951947 --> -0.954733).  Saving model ...
Epoch: 17 cost time: 21.463823795318604
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.270 Vali Acc: 0.953 Test Loss: 0.270 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 21.307098388671875
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
Validation loss decreased (-0.954733 --> -0.956126).  Saving model ...
Epoch: 19 cost time: 23.042967319488525
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.444 Vali Acc: 0.922 Test Loss: 0.444 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 21.759698390960693
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.285 Vali Acc: 0.955 Test Loss: 0.285 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.53038787841797
Epoch: 21, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.386 Vali Acc: 0.941 Test Loss: 0.386 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 23.62271237373352
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.423 Vali Acc: 0.942 Test Loss: 0.423 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 23.3643798828125
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.380 Vali Acc: 0.937 Test Loss: 0.380 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 21.785656929016113
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.304 Vali Acc: 0.956 Test Loss: 0.304 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 21.94128704071045
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.333 Vali Acc: 0.946 Test Loss: 0.333 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 23.423230171203613
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.380 Vali Acc: 0.946 Test Loss: 0.380 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 23.44102668762207
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.355 Vali Acc: 0.945 Test Loss: 0.355 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 24.75803017616272
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.459 Vali Acc: 0.943 Test Loss: 0.459 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9561281337047354
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.043570518493652
Epoch: 1, Steps: 89 | Train Loss: 1.671 Vali Loss: 0.740 Vali Acc: 0.777 Test Loss: 0.740 Test Acc: 0.777
Validation loss decreased (inf --> -0.777151).  Saving model ...
Epoch: 2 cost time: 21.678416967391968
Epoch: 2, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
Validation loss decreased (-0.777151 --> -0.883701).  Saving model ...
Epoch: 3 cost time: 20.019951343536377
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.303 Vali Acc: 0.916 Test Loss: 0.303 Test Acc: 0.916
Validation loss decreased (-0.883701 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 21.17198133468628
Epoch: 4, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.297 Vali Acc: 0.923 Test Loss: 0.297 Test Acc: 0.923
Validation loss decreased (-0.915735 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 20.256463766098022
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
Validation loss decreased (-0.922699 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 21.784553289413452
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.233 Vali Acc: 0.928 Test Loss: 0.233 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.284857273101807
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.226 Vali Acc: 0.936 Test Loss: 0.226 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.7016499042511
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.248 Vali Acc: 0.940 Test Loss: 0.248 Test Acc: 0.940
Validation loss decreased (-0.938716 --> -0.940109).  Saving model ...
Epoch: 9 cost time: 20.60401487350464
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
Validation loss decreased (-0.940109 --> -0.950555).  Saving model ...
Epoch: 10 cost time: 20.66559100151062
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.285 Vali Acc: 0.920 Test Loss: 0.285 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.241337299346924
Epoch: 11, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 23.608497858047485
Epoch: 12, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.418 Vali Acc: 0.895 Test Loss: 0.418 Test Acc: 0.895
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 20.901774406433105
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.334 Vali Acc: 0.926 Test Loss: 0.334 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 22.622182607650757
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.543074131011963
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.296 Vali Acc: 0.945 Test Loss: 0.296 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.538089513778687
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.278 Vali Acc: 0.953 Test Loss: 0.278 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.953340).  Saving model ...
Epoch: 17 cost time: 21.521965265274048
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
Validation loss decreased (-0.953340 --> -0.960304).  Saving model ...
Epoch: 18 cost time: 21.744940757751465
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.957 Test Loss: 0.200 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 21.030433893203735
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.297 Vali Acc: 0.945 Test Loss: 0.297 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 20.69351863861084
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.289 Vali Acc: 0.949 Test Loss: 0.289 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 20.057855367660522
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.323 Vali Acc: 0.941 Test Loss: 0.323 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 22.522961378097534
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.430 Vali Acc: 0.932 Test Loss: 0.430 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 23.925809383392334
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.379 Vali Acc: 0.944 Test Loss: 0.379 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 23.10582137107849
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.256 Vali Acc: 0.953 Test Loss: 0.256 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 21.49349546432495
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.380 Vali Acc: 0.941 Test Loss: 0.380 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 19.749054193496704
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.334 Vali Acc: 0.949 Test Loss: 0.334 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 19.666494131088257
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.325 Vali Acc: 0.955 Test Loss: 0.325 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.99918818473816
Epoch: 1, Steps: 89 | Train Loss: 2.023 Vali Loss: 0.992 Vali Acc: 0.710 Test Loss: 0.992 Test Acc: 0.710
Validation loss decreased (inf --> -0.710296).  Saving model ...
Epoch: 2 cost time: 22.870255947113037
Epoch: 2, Steps: 89 | Train Loss: 0.666 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
Validation loss decreased (-0.710296 --> -0.866987).  Saving model ...
Epoch: 3 cost time: 20.724629878997803
Epoch: 3, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.366 Vali Acc: 0.886 Test Loss: 0.366 Test Acc: 0.886
Validation loss decreased (-0.866987 --> -0.885790).  Saving model ...
Epoch: 4 cost time: 19.64165949821472
Epoch: 4, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
Validation loss decreased (-0.885790 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 22.237640380859375
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.220 Vali Acc: 0.947 Test Loss: 0.220 Test Acc: 0.947
Validation loss decreased (-0.938020 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 22.44442319869995
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.225 Vali Acc: 0.936 Test Loss: 0.225 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.860807180404663
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.239 Vali Acc: 0.938 Test Loss: 0.239 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.21106481552124
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.00495409965515
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
Validation loss decreased (-0.947073 --> -0.954037).  Saving model ...
Epoch: 10 cost time: 22.398293495178223
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.264 Vali Acc: 0.931 Test Loss: 0.264 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.54954171180725
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.04994487762451
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.323 Vali Acc: 0.926 Test Loss: 0.323 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 21.47021508216858
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.369 Vali Acc: 0.919 Test Loss: 0.369 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 24.967257738113403
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.237 Vali Acc: 0.945 Test Loss: 0.237 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 24.288203239440918
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.375 Vali Acc: 0.922 Test Loss: 0.375 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 23.262290239334106
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 22.900824546813965
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.262 Vali Acc: 0.951 Test Loss: 0.262 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 20.895628690719604
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.322 Vali Acc: 0.945 Test Loss: 0.322 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 22.843759298324585
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.283 Vali Acc: 0.946 Test Loss: 0.283 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.926714181900024
Epoch: 1, Steps: 89 | Train Loss: 2.515 Vali Loss: 1.981 Vali Acc: 0.428 Test Loss: 1.981 Test Acc: 0.428
Validation loss decreased (inf --> -0.427557).  Saving model ...
Epoch: 2 cost time: 21.504614114761353
Epoch: 2, Steps: 89 | Train Loss: 1.060 Vali Loss: 0.708 Vali Acc: 0.818 Test Loss: 0.708 Test Acc: 0.818
Validation loss decreased (-0.427557 --> -0.818238).  Saving model ...
Epoch: 3 cost time: 21.15202307701111
Epoch: 3, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.393 Vali Acc: 0.887 Test Loss: 0.393 Test Acc: 0.887
Validation loss decreased (-0.818238 --> -0.887183).  Saving model ...
Epoch: 4 cost time: 20.53424835205078
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.259 Vali Acc: 0.932 Test Loss: 0.259 Test Acc: 0.932
Validation loss decreased (-0.887183 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 24.561987161636353
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.931752 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 23.677908420562744
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.910961866378784
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
Validation loss decreased (-0.943591 --> -0.951251).  Saving model ...
Epoch: 8 cost time: 20.747050285339355
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
Validation loss decreased (-0.951251 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 22.85423707962036
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.94720697402954
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.110414743423462
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.13266682624817
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.520 Vali Acc: 0.912 Test Loss: 0.520 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.80873990058899
Epoch: 13, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.953341 --> -0.956126).  Saving model ...
Epoch: 14 cost time: 22.922223806381226
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.908321857452393
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
Validation loss decreased (-0.956126 --> -0.963786).  Saving model ...
Epoch: 16 cost time: 23.788975477218628
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.946 Test Loss: 0.287 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 23.881778717041016
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.955 Test Loss: 0.234 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.393571138381958
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 22.152575492858887
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 22.577073574066162
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 22.246424436569214
Epoch: 21, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.326 Vali Acc: 0.932 Test Loss: 0.326 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 21.53074836730957
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 21.357829809188843
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.963786 --> -0.966572).  Saving model ...
Epoch: 24 cost time: 21.909925937652588
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 20.845404148101807
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 20.30794620513916
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.466 Vali Acc: 0.926 Test Loss: 0.466 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 21.979180335998535
Epoch: 27, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.465 Vali Acc: 0.937 Test Loss: 0.465 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 22.942294359207153
Epoch: 28, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.314 Vali Acc: 0.955 Test Loss: 0.314 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 22.341351747512817
Epoch: 29, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.252 Vali Acc: 0.962 Test Loss: 0.252 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 21.101589679718018
Epoch: 30, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.302 Vali Acc: 0.953 Test Loss: 0.302 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 22.42415738105774
Epoch: 31, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.415 Vali Acc: 0.945 Test Loss: 0.415 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 21.60811686515808
Epoch: 32, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.366 Vali Acc: 0.951 Test Loss: 0.366 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 21.269718647003174
Epoch: 33, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.310 Vali Acc: 0.959 Test Loss: 0.310 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.98684859275818
Epoch: 1, Steps: 89 | Train Loss: 2.555 Vali Loss: 2.291 Vali Acc: 0.326 Test Loss: 2.291 Test Acc: 0.326
Validation loss decreased (inf --> -0.325882).  Saving model ...
Epoch: 2 cost time: 22.935836791992188
Epoch: 2, Steps: 89 | Train Loss: 1.098 Vali Loss: 0.855 Vali Acc: 0.743 Test Loss: 0.855 Test Acc: 0.743
Validation loss decreased (-0.325882 --> -0.743028).  Saving model ...
Epoch: 3 cost time: 21.22015690803528
Epoch: 3, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.403 Vali Acc: 0.876 Test Loss: 0.403 Test Acc: 0.876
Validation loss decreased (-0.743028 --> -0.876041).  Saving model ...
Epoch: 4 cost time: 22.734979152679443
Epoch: 4, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.256 Vali Acc: 0.923 Test Loss: 0.256 Test Acc: 0.923
Validation loss decreased (-0.876041 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 24.577033281326294
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
Validation loss decreased (-0.922699 --> -0.931753).  Saving model ...
Epoch: 6 cost time: 22.14655590057373
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.209 Vali Acc: 0.942 Test Loss: 0.209 Test Acc: 0.942
Validation loss decreased (-0.931753 --> -0.941502).  Saving model ...
Epoch: 7 cost time: 23.36394214630127
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.245 Vali Acc: 0.934 Test Loss: 0.245 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.43949866294861
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.359658241271973
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.941502 --> -0.963090).  Saving model ...
Epoch: 10 cost time: 20.933773279190063
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.445411205291748
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.185648202896118
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.230 Vali Acc: 0.947 Test Loss: 0.230 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.84856629371643
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.13555932044983
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
Validation loss decreased (-0.963090 --> -0.965876).  Saving model ...
Epoch: 15 cost time: 23.193268299102783
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.305 Vali Acc: 0.939 Test Loss: 0.305 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.917238473892212
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.285 Vali Acc: 0.945 Test Loss: 0.285 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 20.74434494972229
Epoch: 17, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.17923927307129
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.29533362388611
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.259 Vali Acc: 0.955 Test Loss: 0.259 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 21.499425649642944
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.239 Vali Acc: 0.960 Test Loss: 0.239 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 21.620226860046387
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.947 Test Loss: 0.261 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 22.001187086105347
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.250 Vali Acc: 0.957 Test Loss: 0.250 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 21.984042406082153
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.394 Vali Acc: 0.939 Test Loss: 0.394 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 23.048781394958496
Epoch: 24, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.307 Vali Acc: 0.946 Test Loss: 0.307 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.50707197189331
Epoch: 1, Steps: 89 | Train Loss: 2.544 Vali Loss: 2.254 Vali Acc: 0.387 Test Loss: 2.254 Test Acc: 0.387
Validation loss decreased (inf --> -0.387164).  Saving model ...
Epoch: 2 cost time: 20.568427562713623
Epoch: 2, Steps: 89 | Train Loss: 1.126 Vali Loss: 1.013 Vali Acc: 0.666 Test Loss: 1.013 Test Acc: 0.666
Validation loss decreased (-0.387164 --> -0.666424).  Saving model ...
Epoch: 3 cost time: 21.871504306793213
Epoch: 3, Steps: 89 | Train Loss: 0.494 Vali Loss: 0.460 Vali Acc: 0.867 Test Loss: 0.460 Test Acc: 0.867
Validation loss decreased (-0.666424 --> -0.866987).  Saving model ...
Epoch: 4 cost time: 20.268956184387207
Epoch: 4, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.520 Vali Acc: 0.854 Test Loss: 0.520 Test Acc: 0.854
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.217071056365967
Epoch: 5, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
Validation loss decreased (-0.866987 --> -0.870470).  Saving model ...
Epoch: 6 cost time: 23.659085035324097
Epoch: 6, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.450 Vali Acc: 0.911 Test Loss: 0.450 Test Acc: 0.911
Validation loss decreased (-0.870470 --> -0.910859).  Saving model ...
Epoch: 7 cost time: 23.70525622367859
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
Validation loss decreased (-0.910859 --> -0.922003).  Saving model ...
Epoch: 8 cost time: 25.000093698501587
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
Validation loss decreased (-0.922003 --> -0.942198).  Saving model ...
Epoch: 9 cost time: 23.36968970298767
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.325 Vali Acc: 0.912 Test Loss: 0.325 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.64672303199768
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.799927234649658
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.265 Vali Acc: 0.939 Test Loss: 0.265 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.870699405670166
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.262 Vali Acc: 0.942 Test Loss: 0.262 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.711462020874023
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.229 Vali Acc: 0.947 Test Loss: 0.229 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947073).  Saving model ...
Epoch: 14 cost time: 23.671762228012085
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.11915397644043
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.445 Vali Acc: 0.927 Test Loss: 0.445 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 23.482963800430298
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.342 Vali Acc: 0.921 Test Loss: 0.342 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 22.837291955947876
Epoch: 17, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.304 Vali Acc: 0.948 Test Loss: 0.304 Test Acc: 0.948
Validation loss decreased (-0.947073 --> -0.947769).  Saving model ...
Epoch: 18 cost time: 22.039988040924072
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.415 Vali Acc: 0.914 Test Loss: 0.415 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 21.551347732543945
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.272 Vali Acc: 0.956 Test Loss: 0.272 Test Acc: 0.956
Validation loss decreased (-0.947769 --> -0.956125).  Saving model ...
Epoch: 20 cost time: 21.812809467315674
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.347 Vali Acc: 0.942 Test Loss: 0.347 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 23.13382840156555
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.309 Vali Acc: 0.942 Test Loss: 0.309 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 22.75018048286438
Epoch: 22, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.428 Vali Acc: 0.937 Test Loss: 0.428 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 23.897841215133667
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.286 Vali Acc: 0.954 Test Loss: 0.286 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.06276273727417
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
Validation loss decreased (-0.956125 --> -0.963090).  Saving model ...
Epoch: 25 cost time: 23.3238205909729
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.707009315490723
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.301 Vali Acc: 0.946 Test Loss: 0.301 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 21.572510480880737
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.339 Vali Acc: 0.943 Test Loss: 0.339 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 22.1835355758667
Epoch: 28, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 24.182236194610596
Epoch: 29, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.325 Vali Acc: 0.951 Test Loss: 0.325 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 22.434221506118774
Epoch: 30, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.242 Vali Acc: 0.964 Test Loss: 0.242 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964482).  Saving model ...
Epoch: 31 cost time: 22.42728614807129
Epoch: 31, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.958 Test Loss: 0.307 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 22.717607021331787
Epoch: 32, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.967 Test Loss: 0.261 Test Acc: 0.967
Validation loss decreased (-0.964482 --> -0.967268).  Saving model ...
Epoch: 33 cost time: 23.81675672531128
Epoch: 33, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.337 Vali Acc: 0.955 Test Loss: 0.337 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 22.742852449417114
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.292 Vali Acc: 0.960 Test Loss: 0.292 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 21.568928718566895
Epoch: 35, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.958 Test Loss: 0.271 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 22.324439764022827
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.298 Vali Acc: 0.958 Test Loss: 0.298 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 21.65102767944336
Epoch: 37, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.961 Test Loss: 0.357 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 22.366567134857178
Epoch: 38, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 21.939080953598022
Epoch: 39, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.252 Vali Acc: 0.962 Test Loss: 0.252 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 21.247637033462524
Epoch: 40, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.317 Vali Acc: 0.953 Test Loss: 0.317 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 21.98865509033203
Epoch: 41, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.429 Vali Acc: 0.951 Test Loss: 0.429 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 22.03236198425293
Epoch: 42, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.444 Vali Acc: 0.952 Test Loss: 0.444 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9672701949860725
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.308892488479614
Epoch: 1, Steps: 89 | Train Loss: 2.575 Vali Loss: 2.030 Vali Acc: 0.425 Test Loss: 2.030 Test Acc: 0.425
Validation loss decreased (inf --> -0.424771).  Saving model ...
Epoch: 2 cost time: 21.676210641860962
Epoch: 2, Steps: 89 | Train Loss: 1.201 Vali Loss: 1.414 Vali Acc: 0.558 Test Loss: 1.414 Test Acc: 0.558
Validation loss decreased (-0.424771 --> -0.558482).  Saving model ...
Epoch: 3 cost time: 23.021127223968506
Epoch: 3, Steps: 89 | Train Loss: 0.567 Vali Loss: 0.775 Vali Acc: 0.767 Test Loss: 0.775 Test Acc: 0.767
Validation loss decreased (-0.558482 --> -0.767402).  Saving model ...
Epoch: 4 cost time: 23.78742265701294
Epoch: 4, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.849 Vali Acc: 0.742 Test Loss: 0.849 Test Acc: 0.742
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.565027952194214
Epoch: 5, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.763 Vali Acc: 0.774 Test Loss: 0.763 Test Acc: 0.774
Validation loss decreased (-0.767402 --> -0.774366).  Saving model ...
Epoch: 6 cost time: 22.994678258895874
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.664 Vali Acc: 0.826 Test Loss: 0.664 Test Acc: 0.826
Validation loss decreased (-0.774366 --> -0.825899).  Saving model ...
Epoch: 7 cost time: 22.655159950256348
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.618 Vali Acc: 0.818 Test Loss: 0.618 Test Acc: 0.818
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.345926761627197
Epoch: 8, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.867 Vali Acc: 0.786 Test Loss: 0.867 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.184486627578735
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.447 Vali Acc: 0.868 Test Loss: 0.447 Test Acc: 0.868
Validation loss decreased (-0.825899 --> -0.868380).  Saving model ...
Epoch: 10 cost time: 22.58203125
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.590 Vali Acc: 0.841 Test Loss: 0.590 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.793065547943115
Epoch: 11, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.714 Vali Acc: 0.843 Test Loss: 0.714 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.088987112045288
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
Validation loss decreased (-0.868380 --> -0.903200).  Saving model ...
Epoch: 13 cost time: 22.400885343551636
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
Validation loss decreased (-0.903200 --> -0.919913).  Saving model ...
Epoch: 14 cost time: 21.66632628440857
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.523 Vali Acc: 0.886 Test Loss: 0.523 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.373669385910034
Epoch: 15, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.730554819107056
Epoch: 16, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.650 Vali Acc: 0.877 Test Loss: 0.650 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 21.634554862976074
Epoch: 17, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
Validation loss decreased (-0.919913 --> -0.922002).  Saving model ...
Epoch: 18 cost time: 20.62708806991577
Epoch: 18, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.576 Vali Acc: 0.876 Test Loss: 0.576 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.19148302078247
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.476 Vali Acc: 0.905 Test Loss: 0.476 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.393299341201782
Epoch: 20, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.627 Vali Acc: 0.870 Test Loss: 0.627 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 20.855491161346436
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.360 Vali Acc: 0.935 Test Loss: 0.360 Test Acc: 0.935
Validation loss decreased (-0.922002 --> -0.934537).  Saving model ...
Epoch: 22 cost time: 22.145009756088257
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.507 Vali Acc: 0.916 Test Loss: 0.507 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 22.740406036376953
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.326 Vali Acc: 0.943 Test Loss: 0.326 Test Acc: 0.943
Validation loss decreased (-0.934537 --> -0.942894).  Saving model ...
Epoch: 24 cost time: 23.743139505386353
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.342 Vali Acc: 0.928 Test Loss: 0.342 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 23.235595226287842
Epoch: 25, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.296 Vali Acc: 0.949 Test Loss: 0.296 Test Acc: 0.949
Validation loss decreased (-0.942894 --> -0.949161).  Saving model ...
Epoch: 26 cost time: 25.074206352233887
Epoch: 26, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.457 Vali Acc: 0.918 Test Loss: 0.457 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 22.537605047225952
Epoch: 27, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.331 Vali Acc: 0.952 Test Loss: 0.331 Test Acc: 0.952
Validation loss decreased (-0.949161 --> -0.951947).  Saving model ...
Epoch: 28 cost time: 23.324705839157104
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.426 Vali Acc: 0.941 Test Loss: 0.426 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 23.874730587005615
Epoch: 29, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.369 Vali Acc: 0.946 Test Loss: 0.369 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 24.146341800689697
Epoch: 30, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.342 Vali Acc: 0.945 Test Loss: 0.342 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 22.455435037612915
Epoch: 31, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 21.78859567642212
Epoch: 32, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.418 Vali Acc: 0.936 Test Loss: 0.418 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 25.812743425369263
Epoch: 33, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.383 Vali Acc: 0.946 Test Loss: 0.383 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 23.310829877853394
Epoch: 34, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.536 Vali Acc: 0.923 Test Loss: 0.536 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 22.672252893447876
Epoch: 35, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.562 Vali Acc: 0.926 Test Loss: 0.562 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 22.128296613693237
Epoch: 36, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.471 Vali Acc: 0.930 Test Loss: 0.471 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 24.505113124847412
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.417 Vali Acc: 0.952 Test Loss: 0.417 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.160133123397827
Epoch: 1, Steps: 89 | Train Loss: 2.623 Vali Loss: 1.985 Vali Acc: 0.432 Test Loss: 1.985 Test Acc: 0.432
Validation loss decreased (inf --> -0.431735).  Saving model ...
Epoch: 2 cost time: 23.701435327529907
Epoch: 2, Steps: 89 | Train Loss: 1.243 Vali Loss: 1.298 Vali Acc: 0.591 Test Loss: 1.298 Test Acc: 0.591
Validation loss decreased (-0.431735 --> -0.590516).  Saving model ...
Epoch: 3 cost time: 23.235020637512207
Epoch: 3, Steps: 89 | Train Loss: 0.578 Vali Loss: 0.653 Vali Acc: 0.782 Test Loss: 0.653 Test Acc: 0.782
Validation loss decreased (-0.590516 --> -0.782027).  Saving model ...
Epoch: 4 cost time: 21.012943983078003
Epoch: 4, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.807 Vali Acc: 0.772 Test Loss: 0.807 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.998795986175537
Epoch: 5, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.651 Vali Acc: 0.793 Test Loss: 0.651 Test Acc: 0.793
Validation loss decreased (-0.782027 --> -0.793169).  Saving model ...
Epoch: 6 cost time: 22.12327480316162
Epoch: 6, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.440 Vali Acc: 0.886 Test Loss: 0.440 Test Acc: 0.886
Validation loss decreased (-0.793169 --> -0.886486).  Saving model ...
Epoch: 7 cost time: 22.5675265789032
Epoch: 7, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.517 Vali Acc: 0.854 Test Loss: 0.517 Test Acc: 0.854
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.458250999450684
Epoch: 8, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.431 Vali Acc: 0.883 Test Loss: 0.431 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.958327054977417
Epoch: 9, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.451 Vali Acc: 0.887 Test Loss: 0.451 Test Acc: 0.887
Validation loss decreased (-0.886486 --> -0.887182).  Saving model ...
Epoch: 10 cost time: 22.46199345588684
Epoch: 10, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.423 Vali Acc: 0.886 Test Loss: 0.423 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.02012848854065
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.471 Vali Acc: 0.893 Test Loss: 0.471 Test Acc: 0.893
Validation loss decreased (-0.887182 --> -0.892753).  Saving model ...
Epoch: 12 cost time: 22.20724582672119
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.381 Vali Acc: 0.912 Test Loss: 0.381 Test Acc: 0.912
Validation loss decreased (-0.892753 --> -0.911556).  Saving model ...
Epoch: 13 cost time: 22.447871208190918
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.399 Vali Acc: 0.903 Test Loss: 0.399 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.88178586959839
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.369 Vali Acc: 0.928 Test Loss: 0.369 Test Acc: 0.928
Validation loss decreased (-0.911556 --> -0.927573).  Saving model ...
Epoch: 15 cost time: 21.989216566085815
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.361 Vali Acc: 0.931 Test Loss: 0.361 Test Acc: 0.931
Validation loss decreased (-0.927573 --> -0.931055).  Saving model ...
Epoch: 16 cost time: 20.843703508377075
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.339 Vali Acc: 0.932 Test Loss: 0.339 Test Acc: 0.932
Validation loss decreased (-0.931055 --> -0.931751).  Saving model ...
Epoch: 17 cost time: 22.405496835708618
Epoch: 17, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.440 Vali Acc: 0.921 Test Loss: 0.440 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.57042670249939
Epoch: 18, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.465 Vali Acc: 0.912 Test Loss: 0.465 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 20.53941559791565
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
Validation loss decreased (-0.931751 --> -0.937323).  Saving model ...
Epoch: 20 cost time: 21.078280925750732
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.490 Vali Acc: 0.910 Test Loss: 0.490 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 22.706594944000244
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.335 Vali Acc: 0.945 Test Loss: 0.335 Test Acc: 0.945
Validation loss decreased (-0.937323 --> -0.944983).  Saving model ...
Epoch: 22 cost time: 22.222328424453735
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.645 Vali Acc: 0.903 Test Loss: 0.645 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.68148136138916
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.324 Vali Acc: 0.939 Test Loss: 0.324 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 20.868440866470337
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.505 Vali Acc: 0.916 Test Loss: 0.505 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 21.39842414855957
Epoch: 25, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.404 Vali Acc: 0.923 Test Loss: 0.404 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 21.307584762573242
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.372 Vali Acc: 0.937 Test Loss: 0.372 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 21.15785050392151
Epoch: 27, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.367 Vali Acc: 0.939 Test Loss: 0.367 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 22.525516271591187
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.320 Vali Acc: 0.953 Test Loss: 0.320 Test Acc: 0.953
Validation loss decreased (-0.944983 --> -0.952643).  Saving model ...
Epoch: 29 cost time: 21.953928232192993
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.421 Vali Acc: 0.938 Test Loss: 0.421 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 24.31511378288269
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.508 Vali Acc: 0.926 Test Loss: 0.508 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 23.260754346847534
Epoch: 31, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.434 Vali Acc: 0.942 Test Loss: 0.434 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 21.732975244522095
Epoch: 32, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.594 Vali Acc: 0.937 Test Loss: 0.594 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 23.829838514328003
Epoch: 33, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.379 Vali Acc: 0.952 Test Loss: 0.379 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 21.620384454727173
Epoch: 34, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.534 Vali Acc: 0.931 Test Loss: 0.534 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 21.97190022468567
Epoch: 35, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.373 Vali Acc: 0.944 Test Loss: 0.373 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 22.443843603134155
Epoch: 36, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.468 Vali Acc: 0.943 Test Loss: 0.468 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 22.315375328063965
Epoch: 37, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.407 Vali Acc: 0.944 Test Loss: 0.407 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 23.257768392562866
Epoch: 38, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.350 Vali Acc: 0.958 Test Loss: 0.350 Test Acc: 0.958
Validation loss decreased (-0.952643 --> -0.958214).  Saving model ...
Epoch: 39 cost time: 23.1927969455719
Epoch: 39, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.557 Vali Acc: 0.937 Test Loss: 0.557 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 22.17685031890869
Epoch: 40, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.487 Vali Acc: 0.942 Test Loss: 0.487 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 20.290146112442017
Epoch: 41, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.366 Vali Acc: 0.961 Test Loss: 0.366 Test Acc: 0.961
Validation loss decreased (-0.958214 --> -0.960999).  Saving model ...
Epoch: 42 cost time: 21.86471176147461
Epoch: 42, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.939 Test Loss: 0.546 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 25.431017875671387
Epoch: 43, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.372 Vali Acc: 0.962 Test Loss: 0.372 Test Acc: 0.962
Validation loss decreased (-0.960999 --> -0.961695).  Saving model ...
Epoch: 44 cost time: 22.72107744216919
Epoch: 44, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.378 Vali Acc: 0.960 Test Loss: 0.378 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 22.74952793121338
Epoch: 45, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.601 Vali Acc: 0.943 Test Loss: 0.601 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 23.156705856323242
Epoch: 46, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.448 Vali Acc: 0.946 Test Loss: 0.448 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 23.15229630470276
Epoch: 47, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.402 Vali Acc: 0.955 Test Loss: 0.402 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 24.55281710624695
Epoch: 48, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.484 Vali Acc: 0.946 Test Loss: 0.484 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 23.003373622894287
Epoch: 49, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.490 Vali Acc: 0.958 Test Loss: 0.490 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 21.06929874420166
Epoch: 50, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.436 Vali Acc: 0.953 Test Loss: 0.436 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 21.95879888534546
Epoch: 51, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.496 Vali Acc: 0.942 Test Loss: 0.496 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 22.523287534713745
Epoch: 52, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.446 Vali Acc: 0.962 Test Loss: 0.446 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 25.00915288925171
Epoch: 53, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.396 Vali Acc: 0.959 Test Loss: 0.396 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.801085948944092
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.049 Test Loss: 2.996 Test Acc: 0.049
Validation loss decreased (inf --> -0.049413).  Saving model ...
Epoch: 2 cost time: 24.230491161346436
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.049 Test Loss: 2.995 Test Acc: 0.049
Validation loss decreased (-0.049413 --> -0.049413).  Saving model ...
Epoch: 3 cost time: 21.45186424255371
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.049413 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 21.071163654327393
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 21.19207501411438
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 21.103818655014038
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 21.702118396759033
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 22.201199054718018
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 23.411426782608032
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 22.163001775741577
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 22.54345679283142
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 23.598872423171997
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 22.42836594581604
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 22.71160316467285
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 22.267709732055664
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 20.608546257019043
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 21.128212451934814
Epoch: 17, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 21.22203779220581
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 22.012067556381226
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 22.999959230422974
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 21.743551015853882
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 21.270785093307495
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 21.421956777572632
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 20.543813467025757
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 19.942620754241943
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 21.432147979736328
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 23.283618211746216
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 24.381344318389893
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 24.046010971069336
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 21.718404531478882
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 21.337770462036133
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 21.933111429214478
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 23.025232076644897
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 20.99101686477661
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 22.238443613052368
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 22.13697123527527
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 21.397085666656494
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 21.221576690673828
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.034759998321533
Epoch: 39, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 22.223304510116577
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 21.408034324645996
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 21.393089294433594
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 21.44843316078186
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 21.88202476501465
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 23.457722663879395
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 23.666028261184692
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 23.892561435699463
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 23.155033826828003
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 21.939385652542114
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 21.997129917144775
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 21.963265895843506
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 20.936399221420288
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 22.63921856880188
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 22.897693634033203
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 22.832708597183228
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 20.614014863967896
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 21.067307710647583
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 21.713659286499023
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 59 cost time: 22.32276964187622
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 22.004700660705566
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 21.96555519104004
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 62 cost time: 21.43260645866394
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 21.78558349609375
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 64 cost time: 23.656630277633667
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 23.694421529769897
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 22.548193216323853
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 22.81312394142151
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 21.30266499519348
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 19.757819175720215
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 20.209127187728882
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 20.618239402770996
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 21.378265857696533
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 21.643431425094604
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 793748
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.24520516395569
Epoch: 1, Steps: 89 | Train Loss: 1.459 Vali Loss: 0.558 Vali Acc: 0.834 Test Loss: 0.558 Test Acc: 0.834
Validation loss decreased (inf --> -0.833560).  Saving model ...
Epoch: 2 cost time: 22.09613871574402
Epoch: 2, Steps: 89 | Train Loss: 0.367 Vali Loss: 0.276 Vali Acc: 0.920 Test Loss: 0.276 Test Acc: 0.920
Validation loss decreased (-0.833560 --> -0.919914).  Saving model ...
Epoch: 3 cost time: 22.45580506324768
Epoch: 3, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.300 Vali Acc: 0.924 Test Loss: 0.300 Test Acc: 0.924
Validation loss decreased (-0.919914 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 22.52697253227234
Epoch: 4, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
Validation loss decreased (-0.924092 --> -0.931753).  Saving model ...
Epoch: 5 cost time: 22.01472759246826
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.201 Vali Acc: 0.942 Test Loss: 0.201 Test Acc: 0.942
Validation loss decreased (-0.931753 --> -0.942199).  Saving model ...
Epoch: 6 cost time: 22.1421480178833
Epoch: 6, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.665191173553467
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
Validation loss decreased (-0.942199 --> -0.951252).  Saving model ...
Epoch: 8 cost time: 22.45560598373413
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
Validation loss decreased (-0.951252 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 21.863624095916748
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
Validation loss decreased (-0.961001 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 24.07667112350464
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.99729824066162
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.887823820114136
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.128403186798096
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.428380012512207
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.9050931930542
Epoch: 15, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.278 Vali Acc: 0.946 Test Loss: 0.278 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.009516954421997
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.294 Vali Acc: 0.953 Test Loss: 0.294 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 21.662404537200928
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.394 Vali Acc: 0.942 Test Loss: 0.394 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 21.331478357315063
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.513 Vali Acc: 0.921 Test Loss: 0.513 Test Acc: 0.921
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 22.0343017578125
Epoch: 19, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.259362936019897
Epoch: 1, Steps: 89 | Train Loss: 1.520 Vali Loss: 0.641 Vali Acc: 0.802 Test Loss: 0.641 Test Acc: 0.802
Validation loss decreased (inf --> -0.802222).  Saving model ...
Epoch: 2 cost time: 21.953155994415283
Epoch: 2, Steps: 89 | Train Loss: 0.426 Vali Loss: 0.334 Vali Acc: 0.898 Test Loss: 0.334 Test Acc: 0.898
Validation loss decreased (-0.802222 --> -0.898325).  Saving model ...
Epoch: 3 cost time: 20.68244981765747
Epoch: 3, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
Validation loss decreased (-0.898325 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 21.932554483413696
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.230 Vali Acc: 0.932 Test Loss: 0.230 Test Acc: 0.932
Validation loss decreased (-0.924788 --> -0.931753).  Saving model ...
Epoch: 5 cost time: 20.766737461090088
Epoch: 5, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.251 Vali Acc: 0.916 Test Loss: 0.251 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.556036949157715
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.356 Vali Acc: 0.903 Test Loss: 0.356 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.247189044952393
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.49388313293457
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.931753 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 21.62367582321167
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.181175231933594
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 21.907862663269043
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.03575611114502
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.319 Vali Acc: 0.923 Test Loss: 0.319 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.95396327972412
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 21.48316240310669
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 19.613354921340942
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.264 Vali Acc: 0.945 Test Loss: 0.264 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.58595633506775
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.245 Vali Acc: 0.945 Test Loss: 0.245 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 21.463980436325073
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.587 Vali Acc: 0.908 Test Loss: 0.587 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 22.5598464012146
Epoch: 18, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.459 Vali Acc: 0.924 Test Loss: 0.459 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 22.402843952178955
Epoch: 19, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.357 Vali Acc: 0.936 Test Loss: 0.357 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 21.24836039543152
Epoch: 20, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.306 Vali Acc: 0.939 Test Loss: 0.306 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.319223165512085
Epoch: 1, Steps: 89 | Train Loss: 1.635 Vali Loss: 0.747 Vali Acc: 0.776 Test Loss: 0.747 Test Acc: 0.776
Validation loss decreased (inf --> -0.776455).  Saving model ...
Epoch: 2 cost time: 21.28974437713623
Epoch: 2, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.412 Vali Acc: 0.875 Test Loss: 0.412 Test Acc: 0.875
Validation loss decreased (-0.776455 --> -0.874648).  Saving model ...
Epoch: 3 cost time: 21.652150869369507
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.288 Vali Acc: 0.921 Test Loss: 0.288 Test Acc: 0.921
Validation loss decreased (-0.874648 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 21.602691650390625
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.251 Vali Acc: 0.924 Test Loss: 0.251 Test Acc: 0.924
Validation loss decreased (-0.920610 --> -0.924092).  Saving model ...
Epoch: 5 cost time: 22.95389151573181
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.326 Vali Acc: 0.899 Test Loss: 0.326 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.52149724960327
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.331 Vali Acc: 0.916 Test Loss: 0.331 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 23.35547947883606
Epoch: 7, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.242 Vali Acc: 0.929 Test Loss: 0.242 Test Acc: 0.929
Validation loss decreased (-0.924092 --> -0.928967).  Saving model ...
Epoch: 8 cost time: 21.371864080429077
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
Validation loss decreased (-0.928967 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 20.80626392364502
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.879765033721924
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.394984245300293
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.014561414718628
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.301 Vali Acc: 0.928 Test Loss: 0.301 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 20.55533266067505
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.953341 --> -0.956126).  Saving model ...
Epoch: 14 cost time: 23.84869146347046
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.164015531539917
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.957 Test Loss: 0.244 Test Acc: 0.957
Validation loss decreased (-0.956126 --> -0.956822).  Saving model ...
Epoch: 16 cost time: 22.832205295562744
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 20.12444233894348
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.241 Vali Acc: 0.951 Test Loss: 0.241 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.39442229270935
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.261 Vali Acc: 0.946 Test Loss: 0.261 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 20.766724586486816
Epoch: 19, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.439 Vali Acc: 0.914 Test Loss: 0.439 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.593157291412354
Epoch: 20, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.370 Vali Acc: 0.942 Test Loss: 0.370 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 20.775245428085327
Epoch: 21, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.299 Vali Acc: 0.953 Test Loss: 0.299 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.8975567817688
Epoch: 22, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.495 Vali Acc: 0.923 Test Loss: 0.495 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 23.53841757774353
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.340 Vali Acc: 0.952 Test Loss: 0.340 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 23.57742404937744
Epoch: 24, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.525 Vali Acc: 0.939 Test Loss: 0.525 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 21.257086038589478
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.960 Test Loss: 0.236 Test Acc: 0.960
Validation loss decreased (-0.956822 --> -0.959608).  Saving model ...
Epoch: 26 cost time: 23.1140296459198
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.410 Vali Acc: 0.932 Test Loss: 0.410 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 21.963379383087158
Epoch: 27, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.403 Vali Acc: 0.943 Test Loss: 0.403 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 22.127090215682983
Epoch: 28, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.291 Vali Acc: 0.959 Test Loss: 0.291 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 23.57709002494812
Epoch: 29, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.464 Vali Acc: 0.932 Test Loss: 0.464 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 21.591489791870117
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.358 Vali Acc: 0.954 Test Loss: 0.358 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 23.99092435836792
Epoch: 31, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.294 Vali Acc: 0.958 Test Loss: 0.294 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 21.860257625579834
Epoch: 32, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.348 Vali Acc: 0.951 Test Loss: 0.348 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 22.814695835113525
Epoch: 33, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.383 Vali Acc: 0.951 Test Loss: 0.383 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 22.982545852661133
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.317 Vali Acc: 0.954 Test Loss: 0.317 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 20.85061264038086
Epoch: 35, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.309 Vali Acc: 0.962 Test Loss: 0.309 Test Acc: 0.962
Validation loss decreased (-0.959608 --> -0.962392).  Saving model ...
Epoch: 36 cost time: 21.757063388824463
Epoch: 36, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.360 Vali Acc: 0.959 Test Loss: 0.360 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 21.107357501983643
Epoch: 37, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.323 Vali Acc: 0.960 Test Loss: 0.323 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 22.695845127105713
Epoch: 38, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.334 Vali Acc: 0.960 Test Loss: 0.334 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 22.471542358398438
Epoch: 39, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.316 Vali Acc: 0.952 Test Loss: 0.316 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 23.023664712905884
Epoch: 40, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 22.93596076965332
Epoch: 41, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.316 Vali Acc: 0.955 Test Loss: 0.316 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 23.1121084690094
Epoch: 42, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.964 Test Loss: 0.277 Test Acc: 0.964
Validation loss decreased (-0.962392 --> -0.964482).  Saving model ...
Epoch: 43 cost time: 20.243120908737183
Epoch: 43, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.645 Vali Acc: 0.930 Test Loss: 0.645 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 20.589523553848267
Epoch: 44, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.495 Vali Acc: 0.941 Test Loss: 0.495 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 21.900630950927734
Epoch: 45, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.528 Vali Acc: 0.942 Test Loss: 0.528 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 21.129066944122314
Epoch: 46, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.491 Vali Acc: 0.948 Test Loss: 0.491 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 21.10270380973816
Epoch: 47, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.606 Vali Acc: 0.939 Test Loss: 0.606 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 21.883808612823486
Epoch: 48, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.505 Vali Acc: 0.945 Test Loss: 0.505 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 24.996710538864136
Epoch: 49, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.460 Vali Acc: 0.952 Test Loss: 0.460 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 24.104414224624634
Epoch: 50, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.426 Vali Acc: 0.955 Test Loss: 0.426 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 22.685431480407715
Epoch: 51, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.428 Vali Acc: 0.957 Test Loss: 0.428 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 21.82086491584778
Epoch: 52, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.441 Vali Acc: 0.956 Test Loss: 0.441 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.31967306137085
Epoch: 1, Steps: 89 | Train Loss: 2.020 Vali Loss: 1.001 Vali Acc: 0.746 Test Loss: 1.001 Test Acc: 0.746
Validation loss decreased (inf --> -0.745812).  Saving model ...
Epoch: 2 cost time: 24.39196538925171
Epoch: 2, Steps: 89 | Train Loss: 0.656 Vali Loss: 0.537 Vali Acc: 0.820 Test Loss: 0.537 Test Acc: 0.820
Validation loss decreased (-0.745812 --> -0.819633).  Saving model ...
Epoch: 3 cost time: 22.842641592025757
Epoch: 3, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
Validation loss decreased (-0.819633 --> -0.900415).  Saving model ...
Epoch: 4 cost time: 23.27031445503235
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.900415 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 22.94456958770752
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.877195358276367
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.270 Vali Acc: 0.923 Test Loss: 0.270 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.067809343338013
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.237 Vali Acc: 0.940 Test Loss: 0.237 Test Acc: 0.940
Validation loss decreased (-0.933145 --> -0.940109).  Saving model ...
Epoch: 8 cost time: 23.41923999786377
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.938 Test Loss: 0.238 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.521629571914673
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.70283818244934
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
Validation loss decreased (-0.940109 --> -0.949162).  Saving model ...
Epoch: 11 cost time: 23.40244746208191
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.525011777877808
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.949162 --> -0.951948).  Saving model ...
Epoch: 13 cost time: 23.262598276138306
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.415 Vali Acc: 0.923 Test Loss: 0.415 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.31089162826538
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.66535973548889
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.266 Vali Acc: 0.939 Test Loss: 0.266 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.058249711990356
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.415 Vali Acc: 0.923 Test Loss: 0.415 Test Acc: 0.923
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.882282495498657
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.347 Vali Acc: 0.941 Test Loss: 0.347 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.164767026901245
Epoch: 18, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.479 Vali Acc: 0.905 Test Loss: 0.479 Test Acc: 0.905
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 23.06576180458069
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.283 Vali Acc: 0.947 Test Loss: 0.283 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 23.361544847488403
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.338 Vali Acc: 0.942 Test Loss: 0.338 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 23.759546279907227
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 23.113142490386963
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.280 Vali Acc: 0.955 Test Loss: 0.280 Test Acc: 0.955
Validation loss decreased (-0.951948 --> -0.955429).  Saving model ...
Epoch: 23 cost time: 23.90790581703186
Epoch: 23, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.53016757965088
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.369 Vali Acc: 0.951 Test Loss: 0.369 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.84208059310913
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.369 Vali Acc: 0.939 Test Loss: 0.369 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.511507987976074
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.359 Vali Acc: 0.948 Test Loss: 0.359 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 21.492496013641357
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 23.230421543121338
Epoch: 28, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.469 Vali Acc: 0.931 Test Loss: 0.469 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 21.855495929718018
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.474 Vali Acc: 0.935 Test Loss: 0.474 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 24.55637812614441
Epoch: 30, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.403 Vali Acc: 0.948 Test Loss: 0.403 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 23.026915311813354
Epoch: 31, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.353 Vali Acc: 0.957 Test Loss: 0.353 Test Acc: 0.957
Validation loss decreased (-0.955429 --> -0.956821).  Saving model ...
Epoch: 32 cost time: 24.242345571517944
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.349 Vali Acc: 0.954 Test Loss: 0.349 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 21.88075304031372
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.329 Vali Acc: 0.963 Test Loss: 0.329 Test Acc: 0.963
Validation loss decreased (-0.956821 --> -0.963089).  Saving model ...
Epoch: 34 cost time: 22.289302110671997
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.357 Vali Acc: 0.957 Test Loss: 0.357 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 21.500851154327393
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.341 Vali Acc: 0.966 Test Loss: 0.341 Test Acc: 0.966
Validation loss decreased (-0.963089 --> -0.965874).  Saving model ...
Epoch: 36 cost time: 22.53079652786255
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.339 Vali Acc: 0.967 Test Loss: 0.339 Test Acc: 0.967
Validation loss decreased (-0.965874 --> -0.966570).  Saving model ...
Epoch: 37 cost time: 23.36439824104309
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.965 Test Loss: 0.326 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 24.97192621231079
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.968 Test Loss: 0.320 Test Acc: 0.968
Validation loss decreased (-0.966570 --> -0.967963).  Saving model ...
Epoch: 39 cost time: 24.764848709106445
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.317 Vali Acc: 0.969 Test Loss: 0.317 Test Acc: 0.969
Validation loss decreased (-0.967963 --> -0.969356).  Saving model ...
Epoch: 40 cost time: 24.101786375045776
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.968 Test Loss: 0.320 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 24.200597763061523
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.321 Vali Acc: 0.968 Test Loss: 0.321 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 24.7767117023468
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.969 Test Loss: 0.322 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 24.903281450271606
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.968 Test Loss: 0.320 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 24.586549520492554
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.968 Test Loss: 0.322 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 25.700397491455078
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.967 Test Loss: 0.330 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 24.7514591217041
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.968 Test Loss: 0.326 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 24.32615900039673
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.325 Vali Acc: 0.968 Test Loss: 0.325 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 23.058048963546753
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.968 Test Loss: 0.324 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 23.543324947357178
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.968 Test Loss: 0.323 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.230226039886475
Epoch: 1, Steps: 89 | Train Loss: 2.509 Vali Loss: 1.979 Vali Acc: 0.424 Test Loss: 1.979 Test Acc: 0.424
Validation loss decreased (inf --> -0.424075).  Saving model ...
Epoch: 2 cost time: 21.17307758331299
Epoch: 2, Steps: 89 | Train Loss: 1.076 Vali Loss: 0.871 Vali Acc: 0.726 Test Loss: 0.871 Test Acc: 0.726
Validation loss decreased (-0.424075 --> -0.725618).  Saving model ...
Epoch: 3 cost time: 22.35685968399048
Epoch: 3, Steps: 89 | Train Loss: 0.433 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
Validation loss decreased (-0.725618 --> -0.866987).  Saving model ...
Epoch: 4 cost time: 22.19276189804077
Epoch: 4, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.350 Vali Acc: 0.898 Test Loss: 0.350 Test Acc: 0.898
Validation loss decreased (-0.866987 --> -0.897629).  Saving model ...
Epoch: 5 cost time: 22.26459527015686
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.222 Vali Acc: 0.931 Test Loss: 0.222 Test Acc: 0.931
Validation loss decreased (-0.897629 --> -0.931056).  Saving model ...
Epoch: 6 cost time: 23.538817405700684
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.931056 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 21.43744444847107
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.278 Vali Acc: 0.921 Test Loss: 0.278 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.37160587310791
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.949859 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 19.927218675613403
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.25241446495056
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.947 Test Loss: 0.210 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.61686134338379
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961697).  Saving model ...
Epoch: 12 cost time: 22.0033962726593
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 21.163928985595703
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.81296467781067
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.228 Vali Acc: 0.949 Test Loss: 0.228 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 22.255661249160767
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.297 Vali Acc: 0.939 Test Loss: 0.297 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 22.79648995399475
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 22.628220558166504
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
Validation loss decreased (-0.961697 --> -0.965179).  Saving model ...
Epoch: 18 cost time: 22.01504373550415
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.350 Vali Acc: 0.931 Test Loss: 0.350 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.216487169265747
Epoch: 19, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.273 Vali Acc: 0.939 Test Loss: 0.273 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.222228050231934
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.255 Vali Acc: 0.953 Test Loss: 0.255 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.955307483673096
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.964 Test Loss: 0.238 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 21.795112371444702
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.958 Test Loss: 0.262 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 22.105857610702515
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.196 Vali Acc: 0.971 Test Loss: 0.196 Test Acc: 0.971
Validation loss decreased (-0.965179 --> -0.970750).  Saving model ...
Epoch: 24 cost time: 22.46081042289734
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 20.499287605285645
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.257 Vali Acc: 0.966 Test Loss: 0.257 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 20.813215732574463
Epoch: 26, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.390 Vali Acc: 0.941 Test Loss: 0.390 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 21.559393405914307
Epoch: 27, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.291 Vali Acc: 0.953 Test Loss: 0.291 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 22.3915536403656
Epoch: 28, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 23.849481105804443
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.377 Vali Acc: 0.946 Test Loss: 0.377 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 22.142229557037354
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.285 Vali Acc: 0.960 Test Loss: 0.285 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 21.374454259872437
Epoch: 31, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.963 Test Loss: 0.261 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 22.980361223220825
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.962 Test Loss: 0.268 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 19.565174102783203
Epoch: 33, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.271 Vali Acc: 0.963 Test Loss: 0.271 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.729184865951538
Epoch: 1, Steps: 89 | Train Loss: 2.547 Vali Loss: 2.371 Vali Acc: 0.240 Test Loss: 2.371 Test Acc: 0.240
Validation loss decreased (inf --> -0.240227).  Saving model ...
Epoch: 2 cost time: 24.672123432159424
Epoch: 2, Steps: 89 | Train Loss: 1.137 Vali Loss: 1.004 Vali Acc: 0.670 Test Loss: 1.004 Test Acc: 0.670
Validation loss decreased (-0.240227 --> -0.669906).  Saving model ...
Epoch: 3 cost time: 24.42319679260254
Epoch: 3, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.449 Vali Acc: 0.867 Test Loss: 0.449 Test Acc: 0.867
Validation loss decreased (-0.669906 --> -0.866987).  Saving model ...
Epoch: 4 cost time: 21.6719868183136
Epoch: 4, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
Validation loss decreased (-0.866987 --> -0.918521).  Saving model ...
Epoch: 5 cost time: 21.851251363754272
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.215 Vali Acc: 0.927 Test Loss: 0.215 Test Acc: 0.927
Validation loss decreased (-0.918521 --> -0.926878).  Saving model ...
Epoch: 6 cost time: 21.93020510673523
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
Validation loss decreased (-0.926878 --> -0.936627).  Saving model ...
Epoch: 7 cost time: 20.918936729431152
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.936627 --> -0.936627).  Saving model ...
Epoch: 8 cost time: 22.088457345962524
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.936627 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 24.046891450881958
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.218 Vali Acc: 0.942 Test Loss: 0.218 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.93179225921631
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.71748185157776
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.951 Test Loss: 0.238 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.015785455703735
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 24.03435254096985
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 21.13676428794861
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.011576175689697
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 22.906330823898315
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.954 Test Loss: 0.238 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 25.108070611953735
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.278 Vali Acc: 0.951 Test Loss: 0.278 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.765811681747437
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.812 Vali Acc: 0.905 Test Loss: 0.812 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 22.712785005569458
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.256 Vali Acc: 0.953 Test Loss: 0.256 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 22.597463607788086
Epoch: 20, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.296 Vali Acc: 0.948 Test Loss: 0.296 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 23.237319946289062
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.292 Vali Acc: 0.953 Test Loss: 0.292 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 25.10362696647644
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.358 Vali Acc: 0.948 Test Loss: 0.358 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 25.334943771362305
Epoch: 23, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.394 Vali Acc: 0.942 Test Loss: 0.394 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.56038761138916
Epoch: 1, Steps: 89 | Train Loss: 2.533 Vali Loss: 2.266 Vali Acc: 0.361 Test Loss: 2.266 Test Acc: 0.361
Validation loss decreased (inf --> -0.360702).  Saving model ...
Epoch: 2 cost time: 24.115848064422607
Epoch: 2, Steps: 89 | Train Loss: 1.151 Vali Loss: 1.094 Vali Acc: 0.625 Test Loss: 1.094 Test Acc: 0.625
Validation loss decreased (-0.360702 --> -0.624641).  Saving model ...
Epoch: 3 cost time: 22.407403469085693
Epoch: 3, Steps: 89 | Train Loss: 0.498 Vali Loss: 0.534 Vali Acc: 0.845 Test Loss: 0.534 Test Acc: 0.845
Validation loss decreased (-0.624641 --> -0.845399).  Saving model ...
Epoch: 4 cost time: 22.997453212738037
Epoch: 4, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.307 Vali Acc: 0.914 Test Loss: 0.307 Test Acc: 0.914
Validation loss decreased (-0.845399 --> -0.914342).  Saving model ...
Epoch: 5 cost time: 23.690369844436646
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
Validation loss decreased (-0.914342 --> -0.919217).  Saving model ...
Epoch: 6 cost time: 22.992365837097168
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.458 Vali Acc: 0.880 Test Loss: 0.458 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.00938105583191
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.279 Vali Acc: 0.916 Test Loss: 0.279 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 25.918090105056763
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.251 Vali Acc: 0.935 Test Loss: 0.251 Test Acc: 0.935
Validation loss decreased (-0.919217 --> -0.934538).  Saving model ...
Epoch: 9 cost time: 25.35944962501526
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.305 Vali Acc: 0.916 Test Loss: 0.305 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.869643688201904
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
Validation loss decreased (-0.934538 --> -0.953340).  Saving model ...
Epoch: 11 cost time: 23.542195558547974
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.118382692337036
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.953340 --> -0.958912).  Saving model ...
Epoch: 13 cost time: 23.978999376296997
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.51172661781311
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.253 Vali Acc: 0.938 Test Loss: 0.253 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.63130211830139
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.351 Vali Acc: 0.923 Test Loss: 0.351 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.72511625289917
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.276 Vali Acc: 0.942 Test Loss: 0.276 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 24.643296718597412
Epoch: 17, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.306 Vali Acc: 0.928 Test Loss: 0.306 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 27.217405080795288
Epoch: 18, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.498 Vali Acc: 0.919 Test Loss: 0.498 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 25.94389772415161
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.255 Vali Acc: 0.948 Test Loss: 0.255 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 26.629331827163696
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 21.93893575668335
Epoch: 21, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.352 Vali Acc: 0.940 Test Loss: 0.352 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 24.019351720809937
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.309 Vali Acc: 0.955 Test Loss: 0.309 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.59428906440735
Epoch: 1, Steps: 89 | Train Loss: 2.574 Vali Loss: 2.102 Vali Acc: 0.372 Test Loss: 2.102 Test Acc: 0.372
Validation loss decreased (inf --> -0.371845).  Saving model ...
Epoch: 2 cost time: 25.01200532913208
Epoch: 2, Steps: 89 | Train Loss: 1.213 Vali Loss: 1.208 Vali Acc: 0.606 Test Loss: 1.208 Test Acc: 0.606
Validation loss decreased (-0.371845 --> -0.605838).  Saving model ...
Epoch: 3 cost time: 25.47410249710083
Epoch: 3, Steps: 89 | Train Loss: 0.547 Vali Loss: 0.814 Vali Acc: 0.754 Test Loss: 0.814 Test Acc: 0.754
Validation loss decreased (-0.605838 --> -0.754170).  Saving model ...
Epoch: 4 cost time: 23.847711324691772
Epoch: 4, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.540 Vali Acc: 0.849 Test Loss: 0.540 Test Acc: 0.849
Validation loss decreased (-0.754170 --> -0.848880).  Saving model ...
Epoch: 5 cost time: 23.734538793563843
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.554 Vali Acc: 0.818 Test Loss: 0.554 Test Acc: 0.818
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.431013345718384
Epoch: 6, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.751 Vali Acc: 0.802 Test Loss: 0.751 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.694181203842163
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.671 Vali Acc: 0.815 Test Loss: 0.671 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.562458038330078
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.634 Vali Acc: 0.821 Test Loss: 0.634 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 22.96043634414673
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.512 Vali Acc: 0.861 Test Loss: 0.512 Test Acc: 0.861
Validation loss decreased (-0.848880 --> -0.860719).  Saving model ...
Epoch: 10 cost time: 23.91262936592102
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.503 Vali Acc: 0.860 Test Loss: 0.503 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.37172818183899
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.386 Vali Acc: 0.899 Test Loss: 0.386 Test Acc: 0.899
Validation loss decreased (-0.860719 --> -0.899021).  Saving model ...
Epoch: 12 cost time: 22.435891151428223
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.344 Vali Acc: 0.911 Test Loss: 0.344 Test Acc: 0.911
Validation loss decreased (-0.899021 --> -0.910860).  Saving model ...
Epoch: 13 cost time: 23.762784719467163
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.461 Vali Acc: 0.893 Test Loss: 0.461 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.415461540222168
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.378 Vali Acc: 0.908 Test Loss: 0.378 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.914071798324585
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.479 Vali Acc: 0.894 Test Loss: 0.479 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.570889234542847
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.327 Vali Acc: 0.928 Test Loss: 0.327 Test Acc: 0.928
Validation loss decreased (-0.910860 --> -0.927573).  Saving model ...
Epoch: 17 cost time: 21.866333484649658
Epoch: 17, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.550 Vali Acc: 0.890 Test Loss: 0.550 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.602503061294556
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.429 Vali Acc: 0.916 Test Loss: 0.429 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.199321746826172
Epoch: 19, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.304 Vali Acc: 0.936 Test Loss: 0.304 Test Acc: 0.936
Validation loss decreased (-0.927573 --> -0.935930).  Saving model ...
Epoch: 20 cost time: 22.892923593521118
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.296 Vali Acc: 0.942 Test Loss: 0.296 Test Acc: 0.942
Validation loss decreased (-0.935930 --> -0.941501).  Saving model ...
Epoch: 21 cost time: 23.212554931640625
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.288 Vali Acc: 0.942 Test Loss: 0.288 Test Acc: 0.942
Validation loss decreased (-0.941501 --> -0.942198).  Saving model ...
Epoch: 22 cost time: 22.970747470855713
Epoch: 22, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 24.599684715270996
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.270 Vali Acc: 0.953 Test Loss: 0.270 Test Acc: 0.953
Validation loss decreased (-0.942198 --> -0.952644).  Saving model ...
Epoch: 24 cost time: 23.56147027015686
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.346 Vali Acc: 0.952 Test Loss: 0.346 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 23.13559103012085
Epoch: 25, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 24.286240100860596
Epoch: 26, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.287 Vali Acc: 0.951 Test Loss: 0.287 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 23.61068320274353
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.362 Vali Acc: 0.939 Test Loss: 0.362 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 25.770442247390747
Epoch: 28, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.658 Vali Acc: 0.903 Test Loss: 0.658 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 25.617528438568115
Epoch: 29, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.434 Vali Acc: 0.939 Test Loss: 0.434 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 21.960740566253662
Epoch: 30, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.267 Vali Acc: 0.960 Test Loss: 0.267 Test Acc: 0.960
Validation loss decreased (-0.952644 --> -0.960304).  Saving model ...
Epoch: 31 cost time: 23.57027530670166
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 23.438081741333008
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.298 Vali Acc: 0.959 Test Loss: 0.298 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 22.33886480331421
Epoch: 33, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.498 Vali Acc: 0.935 Test Loss: 0.498 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 26.111774921417236
Epoch: 34, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.373 Vali Acc: 0.953 Test Loss: 0.373 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 23.398043870925903
Epoch: 35, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.498 Vali Acc: 0.933 Test Loss: 0.498 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 22.9697105884552
Epoch: 36, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.448 Vali Acc: 0.951 Test Loss: 0.448 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 21.845526933670044
Epoch: 37, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 22.14503526687622
Epoch: 38, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.408 Vali Acc: 0.958 Test Loss: 0.408 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 24.89858889579773
Epoch: 39, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.467 Vali Acc: 0.948 Test Loss: 0.467 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 24.038691520690918
Epoch: 40, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.441 Vali Acc: 0.946 Test Loss: 0.441 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 21.956894636154175
Epoch: 1, Steps: 89 | Train Loss: 2.623 Vali Loss: 2.101 Vali Acc: 0.370 Test Loss: 2.101 Test Acc: 0.370
Validation loss decreased (inf --> -0.370453).  Saving model ...
Epoch: 2 cost time: 21.016745805740356
Epoch: 2, Steps: 89 | Train Loss: 1.249 Vali Loss: 1.029 Vali Acc: 0.670 Test Loss: 1.029 Test Acc: 0.670
Validation loss decreased (-0.370453 --> -0.669906).  Saving model ...
Epoch: 3 cost time: 22.669879913330078
Epoch: 3, Steps: 89 | Train Loss: 0.529 Vali Loss: 0.792 Vali Acc: 0.767 Test Loss: 0.792 Test Acc: 0.767
Validation loss decreased (-0.669906 --> -0.767402).  Saving model ...
Epoch: 4 cost time: 23.870564460754395
Epoch: 4, Steps: 89 | Train Loss: 0.306 Vali Loss: 0.443 Vali Acc: 0.857 Test Loss: 0.443 Test Acc: 0.857
Validation loss decreased (-0.767402 --> -0.856542).  Saving model ...
Epoch: 5 cost time: 23.55134344100952
Epoch: 5, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
Validation loss decreased (-0.856542 --> -0.876737).  Saving model ...
Epoch: 6 cost time: 21.112343311309814
Epoch: 6, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.897 Vali Acc: 0.787 Test Loss: 0.897 Test Acc: 0.787
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.79017424583435
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.566 Vali Acc: 0.843 Test Loss: 0.566 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.942917823791504
Epoch: 8, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.549 Vali Acc: 0.853 Test Loss: 0.549 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 25.258248567581177
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.600 Vali Acc: 0.843 Test Loss: 0.600 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 25.582671642303467
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.629 Vali Acc: 0.838 Test Loss: 0.629 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 24.398672580718994
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.715 Vali Acc: 0.842 Test Loss: 0.715 Test Acc: 0.842
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 22.392239570617676
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.663 Vali Acc: 0.849 Test Loss: 0.663 Test Acc: 0.849
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 23.558136701583862
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.491 Vali Acc: 0.880 Test Loss: 0.491 Test Acc: 0.880
Validation loss decreased (-0.876737 --> -0.880218).  Saving model ...
Epoch: 14 cost time: 25.34575629234314
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.462350845336914
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.518 Vali Acc: 0.893 Test Loss: 0.518 Test Acc: 0.893
Validation loss decreased (-0.880218 --> -0.892752).  Saving model ...
Epoch: 16 cost time: 23.543869018554688
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.372 Vali Acc: 0.905 Test Loss: 0.372 Test Acc: 0.905
Validation loss decreased (-0.892752 --> -0.905289).  Saving model ...
Epoch: 17 cost time: 23.623051404953003
Epoch: 17, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.458 Vali Acc: 0.901 Test Loss: 0.458 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 24.415430784225464
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.489 Vali Acc: 0.892 Test Loss: 0.489 Test Acc: 0.892
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 24.54833459854126
Epoch: 19, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.676 Vali Acc: 0.852 Test Loss: 0.676 Test Acc: 0.852
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 25.227372884750366
Epoch: 20, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.495 Vali Acc: 0.905 Test Loss: 0.495 Test Acc: 0.905
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 21.092573404312134
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.384 Vali Acc: 0.920 Test Loss: 0.384 Test Acc: 0.920
Validation loss decreased (-0.905289 --> -0.919913).  Saving model ...
Epoch: 22 cost time: 21.318891525268555
Epoch: 22, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.398 Vali Acc: 0.931 Test Loss: 0.398 Test Acc: 0.931
Validation loss decreased (-0.919913 --> -0.931055).  Saving model ...
Epoch: 23 cost time: 23.365755796432495
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.313 Vali Acc: 0.951 Test Loss: 0.313 Test Acc: 0.951
Validation loss decreased (-0.931055 --> -0.951250).  Saving model ...
Epoch: 24 cost time: 23.035300970077515
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.380 Vali Acc: 0.930 Test Loss: 0.380 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 22.811509132385254
Epoch: 25, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.459 Vali Acc: 0.932 Test Loss: 0.459 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 20.877965450286865
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.365 Vali Acc: 0.938 Test Loss: 0.365 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 21.97255253791809
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.441 Vali Acc: 0.927 Test Loss: 0.441 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 22.2311692237854
Epoch: 28, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.614 Vali Acc: 0.915 Test Loss: 0.614 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 22.114826202392578
Epoch: 29, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.466 Vali Acc: 0.928 Test Loss: 0.466 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 21.953215837478638
Epoch: 30, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.813 Vali Acc: 0.900 Test Loss: 0.813 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 24.16879630088806
Epoch: 31, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 19.775431871414185
Epoch: 32, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.354 Vali Acc: 0.939 Test Loss: 0.354 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 22.150893688201904
Epoch: 33, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.693 Vali Acc: 0.900 Test Loss: 0.693 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9512534818941504
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.243393421173096
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.049 Test Loss: 2.996 Test Acc: 0.049
Validation loss decreased (inf --> -0.049413).  Saving model ...
Epoch: 2 cost time: 23.125762701034546
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.049413 --> -0.060555).  Saving model ...
Epoch: 3 cost time: 23.232767343521118
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.060555 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 23.381822109222412
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 24.603171825408936
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 25.54865050315857
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 23.247575521469116
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 23.93634033203125
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 24.284126043319702
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 26.23071265220642
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 25.3443763256073
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 26.531779527664185
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 26.065107107162476
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 23.45791721343994
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 24.12509322166443
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 24.118016719818115
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 24.761348247528076
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 25.876874685287476
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.237590551376343
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 25.323488235473633
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 26.265191793441772
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 25.095855951309204
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 23.810445308685303
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 24.815297842025757
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 25.491705179214478
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 27.56845450401306
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 25.23099946975708
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 25.443448543548584
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 26.008335828781128
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 26.010172605514526
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 25.419753551483154
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 24.26449155807495
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 24.69250750541687
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 25.993303537368774
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.77780055999756
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 24.526742696762085
Epoch: 36, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 24.33504295349121
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 22.962055444717407
Epoch: 38, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.546627521514893
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 25.284308433532715
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 25.4260036945343
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 24.072991371154785
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 24.49257755279541
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 23.79585576057434
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 24.85746741294861
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 24.45345401763916
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 22.809444904327393
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 24.548222303390503
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 23.91614007949829
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 26.214505434036255
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 24.523799657821655
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 27.64406681060791
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 24.0418918132782
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 23.946959018707275
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 25.421517848968506
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 24.466488122940063
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 24.551689863204956
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 25.451616287231445
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 22.681363821029663
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 21.967348337173462
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 24.311386823654175
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 25.38417649269104
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 63 cost time: 24.412294626235962
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 23.6081759929657
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 23.457273721694946
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 23.174615383148193
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 22.642828702926636
Epoch: 67, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 22.787389039993286
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 24.198371171951294
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 21.791382312774658
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 24.70096778869629
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 23.99829888343811
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 597140
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.77112627029419
Epoch: 1, Steps: 89 | Train Loss: 1.477 Vali Loss: 0.581 Vali Acc: 0.845 Test Loss: 0.581 Test Acc: 0.845
Validation loss decreased (inf --> -0.844702).  Saving model ...
Epoch: 2 cost time: 23.88923716545105
Epoch: 2, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.355 Vali Acc: 0.886 Test Loss: 0.355 Test Acc: 0.886
Validation loss decreased (-0.844702 --> -0.886487).  Saving model ...
Epoch: 3 cost time: 24.15142273902893
Epoch: 3, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.272 Vali Acc: 0.924 Test Loss: 0.272 Test Acc: 0.924
Validation loss decreased (-0.886487 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 22.17452096939087
Epoch: 4, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.924092 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 23.00107216835022
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.947770 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 21.210230112075806
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 22.71072030067444
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.166680574417114
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.945 Test Loss: 0.215 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.79216957092285
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.416659355163574
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.05139708518982
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 22.018024444580078
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.269 Vali Acc: 0.954 Test Loss: 0.269 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 21.921048879623413
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.945 Test Loss: 0.268 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 22.731728553771973
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.946 Test Loss: 0.285 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 24.74445414543152
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 24.09587025642395
Epoch: 16, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.373 Vali Acc: 0.942 Test Loss: 0.373 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.33823871612549
Epoch: 1, Steps: 89 | Train Loss: 1.537 Vali Loss: 0.659 Vali Acc: 0.818 Test Loss: 0.659 Test Acc: 0.818
Validation loss decreased (inf --> -0.817542).  Saving model ...
Epoch: 2 cost time: 25.96430802345276
Epoch: 2, Steps: 89 | Train Loss: 0.470 Vali Loss: 0.430 Vali Acc: 0.854 Test Loss: 0.430 Test Acc: 0.854
Validation loss decreased (-0.817542 --> -0.853756).  Saving model ...
Epoch: 3 cost time: 24.734918117523193
Epoch: 3, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.349 Vali Acc: 0.899 Test Loss: 0.349 Test Acc: 0.899
Validation loss decreased (-0.853756 --> -0.899022).  Saving model ...
Epoch: 4 cost time: 24.511874675750732
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.899022 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 23.828259706497192
Epoch: 5, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.236 Vali Acc: 0.935 Test Loss: 0.236 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.991153955459595
Epoch: 6, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 23.6515531539917
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.736051082611084
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.940806 --> -0.948466).  Saving model ...
Epoch: 9 cost time: 22.269151210784912
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (-0.948466 --> -0.954037).  Saving model ...
Epoch: 10 cost time: 23.353055000305176
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.53703808784485
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 26.90984845161438
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.245 Vali Acc: 0.946 Test Loss: 0.245 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 26.75961685180664
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 25.376783847808838
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.250 Vali Acc: 0.947 Test Loss: 0.250 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 24.82949423789978
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.957519).  Saving model ...
Epoch: 16 cost time: 25.47563886642456
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.415 Vali Acc: 0.921 Test Loss: 0.415 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.927349090576172
Epoch: 17, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.518033266067505
Epoch: 18, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.330 Vali Acc: 0.947 Test Loss: 0.330 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 25.183396577835083
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.320 Vali Acc: 0.945 Test Loss: 0.320 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.24304437637329
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.328 Vali Acc: 0.953 Test Loss: 0.328 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 25.895320653915405
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.310 Vali Acc: 0.955 Test Loss: 0.310 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 26.312798023223877
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.361 Vali Acc: 0.948 Test Loss: 0.361 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 24.27250576019287
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.350 Vali Acc: 0.957 Test Loss: 0.350 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 25.662604093551636
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.249 Vali Acc: 0.959 Test Loss: 0.249 Test Acc: 0.959
Validation loss decreased (-0.957519 --> -0.958911).  Saving model ...
Epoch: 25 cost time: 23.14961528778076
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.323 Vali Acc: 0.953 Test Loss: 0.323 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 24.213789701461792
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.322 Vali Acc: 0.957 Test Loss: 0.322 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 27.24815535545349
Epoch: 27, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.275 Vali Acc: 0.961 Test Loss: 0.275 Test Acc: 0.961
Validation loss decreased (-0.958911 --> -0.961000).  Saving model ...
Epoch: 28 cost time: 27.606833457946777
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.344 Vali Acc: 0.949 Test Loss: 0.344 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 26.356135368347168
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.329 Vali Acc: 0.956 Test Loss: 0.329 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 27.06324577331543
Epoch: 30, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.465 Vali Acc: 0.939 Test Loss: 0.465 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 24.00203013420105
Epoch: 31, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.381 Vali Acc: 0.946 Test Loss: 0.381 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 24.01981520652771
Epoch: 32, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.388 Vali Acc: 0.946 Test Loss: 0.388 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 24.375035762786865
Epoch: 33, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.386 Vali Acc: 0.955 Test Loss: 0.386 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 25.93796968460083
Epoch: 34, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.319 Vali Acc: 0.963 Test Loss: 0.319 Test Acc: 0.963
Validation loss decreased (-0.961000 --> -0.963089).  Saving model ...
Epoch: 35 cost time: 25.854034185409546
Epoch: 35, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.438 Vali Acc: 0.949 Test Loss: 0.438 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 26.16946530342102
Epoch: 36, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.379 Vali Acc: 0.953 Test Loss: 0.379 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 24.609288930892944
Epoch: 37, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.406 Vali Acc: 0.947 Test Loss: 0.406 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 23.8292338848114
Epoch: 38, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.421 Vali Acc: 0.947 Test Loss: 0.421 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 22.986236333847046
Epoch: 39, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.433 Vali Acc: 0.951 Test Loss: 0.433 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 26.012601613998413
Epoch: 40, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.480 Vali Acc: 0.949 Test Loss: 0.480 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 25.513604879379272
Epoch: 41, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.356 Vali Acc: 0.962 Test Loss: 0.356 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 24.755460739135742
Epoch: 42, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.339 Vali Acc: 0.963 Test Loss: 0.339 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 23.047416925430298
Epoch: 43, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.403 Vali Acc: 0.968 Test Loss: 0.403 Test Acc: 0.968
Validation loss decreased (-0.963089 --> -0.967963).  Saving model ...
Epoch: 44 cost time: 22.687267065048218
Epoch: 44, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.964 Test Loss: 0.338 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 22.435449838638306
Epoch: 45, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.718 Vali Acc: 0.933 Test Loss: 0.718 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 22.316821575164795
Epoch: 46, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.365 Vali Acc: 0.967 Test Loss: 0.365 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 25.258649110794067
Epoch: 47, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.381 Vali Acc: 0.962 Test Loss: 0.381 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 25.81335949897766
Epoch: 48, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.337 Vali Acc: 0.969 Test Loss: 0.337 Test Acc: 0.969
Validation loss decreased (-0.967963 --> -0.969356).  Saving model ...
Epoch: 49 cost time: 23.63078761100769
Epoch: 49, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.471 Vali Acc: 0.953 Test Loss: 0.471 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 24.998096227645874
Epoch: 50, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.563 Vali Acc: 0.942 Test Loss: 0.563 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 22.96091651916504
Epoch: 51, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.683 Vali Acc: 0.939 Test Loss: 0.683 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 22.54385995864868
Epoch: 52, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.684 Vali Acc: 0.942 Test Loss: 0.684 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 24.312363862991333
Epoch: 53, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.487 Vali Acc: 0.955 Test Loss: 0.487 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 24.58795952796936
Epoch: 54, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.447 Vali Acc: 0.960 Test Loss: 0.447 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 25.93550753593445
Epoch: 55, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.429 Vali Acc: 0.960 Test Loss: 0.429 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 25.055776357650757
Epoch: 56, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.384 Vali Acc: 0.961 Test Loss: 0.384 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 25.54685616493225
Epoch: 57, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.347 Vali Acc: 0.962 Test Loss: 0.347 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 22.975672960281372
Epoch: 58, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.393 Vali Acc: 0.957 Test Loss: 0.393 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.964184284210205
Epoch: 1, Steps: 89 | Train Loss: 1.661 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
Validation loss decreased (inf --> -0.782722).  Saving model ...
Epoch: 2 cost time: 24.889254093170166
Epoch: 2, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.505 Vali Acc: 0.831 Test Loss: 0.505 Test Acc: 0.831
Validation loss decreased (-0.782722 --> -0.830775).  Saving model ...
Epoch: 3 cost time: 23.092316150665283
Epoch: 3, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
Validation loss decreased (-0.830775 --> -0.890664).  Saving model ...
Epoch: 4 cost time: 22.82208490371704
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.264 Vali Acc: 0.923 Test Loss: 0.264 Test Acc: 0.923
Validation loss decreased (-0.890664 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 24.537155151367188
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.278 Vali Acc: 0.918 Test Loss: 0.278 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.462646961212158
Epoch: 6, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.922699 --> -0.941502).  Saving model ...
Epoch: 7 cost time: 23.672476530075073
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.941502 --> -0.948466).  Saving model ...
Epoch: 8 cost time: 24.515572786331177
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.042307376861572
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.67596411705017
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
Validation loss decreased (-0.948466 --> -0.954733).  Saving model ...
Epoch: 11 cost time: 24.80095386505127
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.047255516052246
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.263 Vali Acc: 0.949 Test Loss: 0.263 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.031903743743896
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 25.55040454864502
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.289 Vali Acc: 0.943 Test Loss: 0.289 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 25.025630235671997
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.374 Vali Acc: 0.934 Test Loss: 0.374 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 22.931421995162964
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.450 Vali Acc: 0.933 Test Loss: 0.450 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 24.01180911064148
Epoch: 17, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 25.418860912322998
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 25.56420350074768
Epoch: 19, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.331 Vali Acc: 0.936 Test Loss: 0.331 Test Acc: 0.936
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 23.766664028167725
Epoch: 20, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.366 Vali Acc: 0.947 Test Loss: 0.366 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9547353760445683
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.31376600265503
Epoch: 1, Steps: 89 | Train Loss: 2.043 Vali Loss: 1.102 Vali Acc: 0.703 Test Loss: 1.102 Test Acc: 0.703
Validation loss decreased (inf --> -0.703332).  Saving model ...
Epoch: 2 cost time: 22.08441686630249
Epoch: 2, Steps: 89 | Train Loss: 0.721 Vali Loss: 0.623 Vali Acc: 0.821 Test Loss: 0.623 Test Acc: 0.821
Validation loss decreased (-0.703332 --> -0.821024).  Saving model ...
Epoch: 3 cost time: 22.620399713516235
Epoch: 3, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.412 Vali Acc: 0.880 Test Loss: 0.412 Test Acc: 0.880
Validation loss decreased (-0.821024 --> -0.879522).  Saving model ...
Epoch: 4 cost time: 22.032033920288086
Epoch: 4, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.879522 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 24.368335962295532
Epoch: 5, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
Validation loss decreased (-0.929663 --> -0.938020).  Saving model ...
Epoch: 6 cost time: 23.73434090614319
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.833077669143677
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.938020 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 22.78131604194641
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.757898807525635
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.00156545639038
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 25.99443221092224
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.512580633163452
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.40657901763916
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 21.907602071762085
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.283 Vali Acc: 0.938 Test Loss: 0.283 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 23.48897695541382
Epoch: 15, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.283 Vali Acc: 0.951 Test Loss: 0.283 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 25.34040093421936
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 27.174992322921753
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.961 Test Loss: 0.220 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 18 cost time: 27.068666696548462
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.346 Vali Acc: 0.943 Test Loss: 0.346 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 25.509565353393555
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.846580743789673
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 24.091304063796997
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.397 Vali Acc: 0.933 Test Loss: 0.397 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 25.303581953048706
Epoch: 22, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.356 Vali Acc: 0.934 Test Loss: 0.356 Test Acc: 0.934
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 25.854202032089233
Epoch: 23, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.436 Vali Acc: 0.944 Test Loss: 0.436 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 24.363516807556152
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.314 Vali Acc: 0.951 Test Loss: 0.314 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 24.224115133285522
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.320 Vali Acc: 0.951 Test Loss: 0.320 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 25.117032527923584
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.378 Vali Acc: 0.946 Test Loss: 0.378 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 23.59687304496765
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.399 Vali Acc: 0.947 Test Loss: 0.399 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.37270760536194
Epoch: 1, Steps: 89 | Train Loss: 2.529 Vali Loss: 2.067 Vali Acc: 0.407 Test Loss: 2.067 Test Acc: 0.407
Validation loss decreased (inf --> -0.406665).  Saving model ...
Epoch: 2 cost time: 23.39294958114624
Epoch: 2, Steps: 89 | Train Loss: 1.101 Vali Loss: 0.810 Vali Acc: 0.751 Test Loss: 0.810 Test Acc: 0.751
Validation loss decreased (-0.406665 --> -0.750688).  Saving model ...
Epoch: 3 cost time: 23.51177668571472
Epoch: 3, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
Validation loss decreased (-0.750688 --> -0.859326).  Saving model ...
Epoch: 4 cost time: 24.26670503616333
Epoch: 4, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.245 Vali Acc: 0.931 Test Loss: 0.245 Test Acc: 0.931
Validation loss decreased (-0.859326 --> -0.931056).  Saving model ...
Epoch: 5 cost time: 23.667163610458374
Epoch: 5, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.245 Vali Acc: 0.924 Test Loss: 0.245 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.98740553855896
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
Validation loss decreased (-0.931056 --> -0.939413).  Saving model ...
Epoch: 7 cost time: 25.540607452392578
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
Validation loss decreased (-0.939413 --> -0.944984).  Saving model ...
Epoch: 8 cost time: 26.0637149810791
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.205 Vali Acc: 0.947 Test Loss: 0.205 Test Acc: 0.947
Validation loss decreased (-0.944984 --> -0.947073).  Saving model ...
Epoch: 9 cost time: 24.995538234710693
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.947073 --> -0.950555).  Saving model ...
Epoch: 10 cost time: 25.262685775756836
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
Validation loss decreased (-0.950555 --> -0.961001).  Saving model ...
Epoch: 11 cost time: 25.854248762130737
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.493364334106445
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.948 Test Loss: 0.268 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 24.716004133224487
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961697).  Saving model ...
Epoch: 14 cost time: 24.818214178085327
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.4022114276886
Epoch: 15, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
Validation loss decreased (-0.961697 --> -0.965179).  Saving model ...
Epoch: 16 cost time: 24.119686603546143
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 25.174378156661987
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.961 Test Loss: 0.192 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.9943745136261
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.559205293655396
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.286 Vali Acc: 0.938 Test Loss: 0.286 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 25.60590434074402
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.67175030708313
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.289 Vali Acc: 0.947 Test Loss: 0.289 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 25.54600715637207
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.932 Vali Acc: 0.907 Test Loss: 0.932 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 26.131344318389893
Epoch: 23, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.367 Vali Acc: 0.944 Test Loss: 0.367 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 26.431695222854614
Epoch: 24, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.335 Vali Acc: 0.951 Test Loss: 0.335 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 26.477463722229004
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.318 Vali Acc: 0.962 Test Loss: 0.318 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.398874521255493
Epoch: 1, Steps: 89 | Train Loss: 2.555 Vali Loss: 2.381 Vali Acc: 0.279 Test Loss: 2.381 Test Acc: 0.279
Validation loss decreased (inf --> -0.279224).  Saving model ...
Epoch: 2 cost time: 26.104102611541748
Epoch: 2, Steps: 89 | Train Loss: 1.156 Vali Loss: 0.926 Vali Acc: 0.684 Test Loss: 0.926 Test Acc: 0.684
Validation loss decreased (-0.279224 --> -0.683835).  Saving model ...
Epoch: 3 cost time: 26.56722903251648
Epoch: 3, Steps: 89 | Train Loss: 0.457 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
Validation loss decreased (-0.683835 --> -0.849577).  Saving model ...
Epoch: 4 cost time: 24.342134952545166
Epoch: 4, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.299 Vali Acc: 0.909 Test Loss: 0.299 Test Acc: 0.909
Validation loss decreased (-0.849577 --> -0.909468).  Saving model ...
Epoch: 5 cost time: 26.34906268119812
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.909468 --> -0.935235).  Saving model ...
Epoch: 6 cost time: 25.68939709663391
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.212 Vali Acc: 0.939 Test Loss: 0.212 Test Acc: 0.939
Validation loss decreased (-0.935235 --> -0.939413).  Saving model ...
Epoch: 7 cost time: 25.079506158828735
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.61208152770996
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.241 Vali Acc: 0.932 Test Loss: 0.241 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.8822283744812
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
Validation loss decreased (-0.939413 --> -0.950555).  Saving model ...
Epoch: 10 cost time: 25.573256731033325
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
Validation loss decreased (-0.950555 --> -0.954734).  Saving model ...
Epoch: 11 cost time: 24.577427625656128
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
Validation loss decreased (-0.954734 --> -0.963786).  Saving model ...
Epoch: 12 cost time: 24.059252500534058
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.64893126487732
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.83984375
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 25.403510093688965
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 25.601375102996826
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 24.245705604553223
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 26.31329107284546
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.220 Vali Acc: 0.962 Test Loss: 0.220 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 26.562211513519287
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.965 Test Loss: 0.192 Test Acc: 0.965
Validation loss decreased (-0.963786 --> -0.965179).  Saving model ...
Epoch: 20 cost time: 25.10325837135315
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.23402714729309
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.969 Test Loss: 0.172 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.968661).  Saving model ...
Epoch: 22 cost time: 25.33287787437439
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.287 Vali Acc: 0.942 Test Loss: 0.287 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 26.675467014312744
Epoch: 23, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.255 Vali Acc: 0.952 Test Loss: 0.255 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 25.48199701309204
Epoch: 24, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.476 Vali Acc: 0.899 Test Loss: 0.476 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 27.964897394180298
Epoch: 25, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.325 Vali Acc: 0.957 Test Loss: 0.325 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 27.2633113861084
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.281 Vali Acc: 0.954 Test Loss: 0.281 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 24.91155457496643
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.357 Vali Acc: 0.946 Test Loss: 0.357 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 24.598125219345093
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.425 Vali Acc: 0.937 Test Loss: 0.425 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 25.776880025863647
Epoch: 29, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.279 Vali Acc: 0.964 Test Loss: 0.279 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 26.34209442138672
Epoch: 30, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.243 Vali Acc: 0.972 Test Loss: 0.243 Test Acc: 0.972
Validation loss decreased (-0.968661 --> -0.972142).  Saving model ...
Epoch: 31 cost time: 25.659974813461304
Epoch: 31, Steps: 89 | Train Loss: 0.079 Vali Loss: 1.042 Vali Acc: 0.912 Test Loss: 1.042 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 24.736032962799072
Epoch: 32, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.277 Vali Acc: 0.955 Test Loss: 0.277 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 24.52776336669922
Epoch: 33, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.357 Vali Acc: 0.946 Test Loss: 0.357 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 25.734813690185547
Epoch: 34, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.318 Vali Acc: 0.953 Test Loss: 0.318 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 23.43193507194519
Epoch: 35, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.455 Vali Acc: 0.940 Test Loss: 0.455 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 25.22789716720581
Epoch: 36, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.574 Vali Acc: 0.938 Test Loss: 0.574 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 27.302499532699585
Epoch: 37, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.345 Vali Acc: 0.955 Test Loss: 0.345 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 25.34778642654419
Epoch: 38, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.327 Vali Acc: 0.958 Test Loss: 0.327 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 24.04344892501831
Epoch: 39, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 25.56373119354248
Epoch: 40, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.475 Vali Acc: 0.948 Test Loss: 0.475 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.596004247665405
Epoch: 1, Steps: 89 | Train Loss: 2.539 Vali Loss: 2.272 Vali Acc: 0.357 Test Loss: 2.272 Test Acc: 0.357
Validation loss decreased (inf --> -0.357220).  Saving model ...
Epoch: 2 cost time: 26.18624234199524
Epoch: 2, Steps: 89 | Train Loss: 1.156 Vali Loss: 1.127 Vali Acc: 0.619 Test Loss: 1.127 Test Acc: 0.619
Validation loss decreased (-0.357220 --> -0.619070).  Saving model ...
Epoch: 3 cost time: 25.386070489883423
Epoch: 3, Steps: 89 | Train Loss: 0.490 Vali Loss: 0.591 Vali Acc: 0.831 Test Loss: 0.591 Test Acc: 0.831
Validation loss decreased (-0.619070 --> -0.830774).  Saving model ...
Epoch: 4 cost time: 24.84526491165161
Epoch: 4, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.458 Vali Acc: 0.878 Test Loss: 0.458 Test Acc: 0.878
Validation loss decreased (-0.830774 --> -0.878129).  Saving model ...
Epoch: 5 cost time: 24.365294218063354
Epoch: 5, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.329 Vali Acc: 0.892 Test Loss: 0.329 Test Acc: 0.892
Validation loss decreased (-0.878129 --> -0.892058).  Saving model ...
Epoch: 6 cost time: 23.02345848083496
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.892058 --> -0.922003).  Saving model ...
Epoch: 7 cost time: 26.247480869293213
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.273 Vali Acc: 0.916 Test Loss: 0.273 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.619359493255615
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.268 Vali Acc: 0.936 Test Loss: 0.268 Test Acc: 0.936
Validation loss decreased (-0.922003 --> -0.935930).  Saving model ...
Epoch: 9 cost time: 24.72427988052368
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.935930 --> -0.937324).  Saving model ...
Epoch: 10 cost time: 25.185211896896362
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.692234992980957
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.425 Vali Acc: 0.910 Test Loss: 0.425 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 28.174967527389526
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.379531145095825
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.246 Vali Acc: 0.946 Test Loss: 0.246 Test Acc: 0.946
Validation loss decreased (-0.937324 --> -0.945680).  Saving model ...
Epoch: 14 cost time: 25.174596071243286
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.96288537979126
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 25.585670471191406
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.354 Vali Acc: 0.929 Test Loss: 0.354 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 25.188178539276123
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.087477207183838
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
Validation loss decreased (-0.945680 --> -0.956822).  Saving model ...
Epoch: 19 cost time: 25.433412790298462
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.291 Vali Acc: 0.939 Test Loss: 0.291 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 24.736199855804443
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.665340662002563
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 23.371628284454346
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.922 Vali Acc: 0.903 Test Loss: 0.922 Test Acc: 0.903
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 25.492038011550903
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.311 Vali Acc: 0.952 Test Loss: 0.311 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 25.76096534729004
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.376 Vali Acc: 0.934 Test Loss: 0.376 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 23.929293632507324
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.951 Test Loss: 0.336 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 24.095367908477783
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.321 Vali Acc: 0.946 Test Loss: 0.321 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 25.127397060394287
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.332 Vali Acc: 0.942 Test Loss: 0.332 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 25.521702527999878
Epoch: 28, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.914 Vali Acc: 0.871 Test Loss: 0.914 Test Acc: 0.871
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.79085898399353
Epoch: 1, Steps: 89 | Train Loss: 2.581 Vali Loss: 2.073 Vali Acc: 0.417 Test Loss: 2.073 Test Acc: 0.417
Validation loss decreased (inf --> -0.417110).  Saving model ...
Epoch: 2 cost time: 27.215266466140747
Epoch: 2, Steps: 89 | Train Loss: 1.236 Vali Loss: 1.561 Vali Acc: 0.515 Test Loss: 1.561 Test Acc: 0.515
Validation loss decreased (-0.417110 --> -0.515305).  Saving model ...
Epoch: 3 cost time: 26.846450805664062
Epoch: 3, Steps: 89 | Train Loss: 0.577 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
Validation loss decreased (-0.515305 --> -0.722136).  Saving model ...
Epoch: 4 cost time: 24.63292384147644
Epoch: 4, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.953 Vali Acc: 0.709 Test Loss: 0.953 Test Acc: 0.709
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.14948606491089
Epoch: 5, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.719 Vali Acc: 0.769 Test Loss: 0.719 Test Acc: 0.769
Validation loss decreased (-0.722136 --> -0.768795).  Saving model ...
Epoch: 6 cost time: 25.109788179397583
Epoch: 6, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
Validation loss decreased (-0.768795 --> -0.788990).  Saving model ...
Epoch: 7 cost time: 26.568232536315918
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.714 Vali Acc: 0.785 Test Loss: 0.714 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.622416496276855
Epoch: 8, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.827 Vali Acc: 0.764 Test Loss: 0.827 Test Acc: 0.764
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.781880617141724
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.807 Vali Acc: 0.765 Test Loss: 0.807 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.37135148048401
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.854 Vali Acc: 0.779 Test Loss: 0.854 Test Acc: 0.779
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 23.813989877700806
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.697 Vali Acc: 0.813 Test Loss: 0.697 Test Acc: 0.813
Validation loss decreased (-0.788990 --> -0.812667).  Saving model ...
Epoch: 12 cost time: 25.50032091140747
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.777 Vali Acc: 0.802 Test Loss: 0.777 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.00059962272644
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.466 Vali Acc: 0.886 Test Loss: 0.466 Test Acc: 0.886
Validation loss decreased (-0.812667 --> -0.886486).  Saving model ...
Epoch: 14 cost time: 24.245253086090088
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 1.018 Vali Acc: 0.779 Test Loss: 1.018 Test Acc: 0.779
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.015424489974976
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.836 Vali Acc: 0.832 Test Loss: 0.836 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 25.122835636138916
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.810 Vali Acc: 0.815 Test Loss: 0.810 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 26.31538701057434
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.757 Vali Acc: 0.843 Test Loss: 0.757 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.295069456100464
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.418 Vali Acc: 0.907 Test Loss: 0.418 Test Acc: 0.907
Validation loss decreased (-0.886486 --> -0.907377).  Saving model ...
Epoch: 19 cost time: 24.61041259765625
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.669 Vali Acc: 0.877 Test Loss: 0.669 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 24.280264616012573
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.719 Vali Acc: 0.865 Test Loss: 0.719 Test Acc: 0.865
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.434106826782227
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.569 Vali Acc: 0.871 Test Loss: 0.569 Test Acc: 0.871
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.922390937805176
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.991 Vali Acc: 0.857 Test Loss: 0.991 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.43514347076416
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.894 Vali Acc: 0.838 Test Loss: 0.894 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 24.390920162200928
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.774 Vali Acc: 0.877 Test Loss: 0.774 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 24.289377450942993
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.453 Vali Acc: 0.909 Test Loss: 0.453 Test Acc: 0.909
Validation loss decreased (-0.907377 --> -0.909466).  Saving model ...
Epoch: 26 cost time: 25.404657125473022
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.894 Vali Acc: 0.850 Test Loss: 0.894 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 24.366541862487793
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.909 Vali Acc: 0.857 Test Loss: 0.909 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 25.69560408592224
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.532 Vali Acc: 0.893 Test Loss: 0.532 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 26.37248682975769
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.424 Vali Acc: 0.918 Test Loss: 0.424 Test Acc: 0.918
Validation loss decreased (-0.909466 --> -0.917823).  Saving model ...
Epoch: 30 cost time: 25.205579042434692
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.643 Vali Acc: 0.893 Test Loss: 0.643 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 23.48358178138733
Epoch: 31, Steps: 89 | Train Loss: 0.057 Vali Loss: 1.458 Vali Acc: 0.813 Test Loss: 1.458 Test Acc: 0.813
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 25.11355948448181
Epoch: 32, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.895 Vali Acc: 0.867 Test Loss: 0.895 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 25.427364349365234
Epoch: 33, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.782 Vali Acc: 0.873 Test Loss: 0.782 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 25.268935203552246
Epoch: 34, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.726 Vali Acc: 0.897 Test Loss: 0.726 Test Acc: 0.897
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 23.868828535079956
Epoch: 35, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.681 Vali Acc: 0.909 Test Loss: 0.681 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 23.98404812812805
Epoch: 36, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.581 Vali Acc: 0.911 Test Loss: 0.581 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 26.025403261184692
Epoch: 37, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.737 Vali Acc: 0.900 Test Loss: 0.737 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 26.03156614303589
Epoch: 38, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.546 Vali Acc: 0.939 Test Loss: 0.546 Test Acc: 0.939
Validation loss decreased (-0.917823 --> -0.938713).  Saving model ...
Epoch: 39 cost time: 24.35502338409424
Epoch: 39, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.640 Vali Acc: 0.912 Test Loss: 0.640 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 24.930872440338135
Epoch: 40, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.503 Vali Acc: 0.928 Test Loss: 0.503 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 25.7011137008667
Epoch: 41, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.497 Vali Acc: 0.930 Test Loss: 0.497 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 26.653016328811646
Epoch: 42, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.477 Vali Acc: 0.942 Test Loss: 0.477 Test Acc: 0.942
Validation loss decreased (-0.938713 --> -0.941499).  Saving model ...
Epoch: 43 cost time: 26.332046270370483
Epoch: 43, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.409 Vali Acc: 0.944 Test Loss: 0.409 Test Acc: 0.944
Validation loss decreased (-0.941499 --> -0.943589).  Saving model ...
Epoch: 44 cost time: 24.924980878829956
Epoch: 44, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.456 Vali Acc: 0.943 Test Loss: 0.456 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 26.142588138580322
Epoch: 45, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.585 Vali Acc: 0.921 Test Loss: 0.585 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 26.46302103996277
Epoch: 46, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.500 Vali Acc: 0.939 Test Loss: 0.500 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 25.98136878013611
Epoch: 47, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.608 Vali Acc: 0.920 Test Loss: 0.608 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 26.274974822998047
Epoch: 48, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.451 Vali Acc: 0.941 Test Loss: 0.451 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 26.225930213928223
Epoch: 49, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.634 Vali Acc: 0.926 Test Loss: 0.634 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 26.006568908691406
Epoch: 50, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.576 Vali Acc: 0.937 Test Loss: 0.576 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 26.3748939037323
Epoch: 51, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.614 Vali Acc: 0.925 Test Loss: 0.614 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 25.940002918243408
Epoch: 52, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.413 Vali Acc: 0.955 Test Loss: 0.413 Test Acc: 0.955
Validation loss decreased (-0.943589 --> -0.954731).  Saving model ...
Epoch: 53 cost time: 26.307026147842407
Epoch: 53, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.470 Vali Acc: 0.949 Test Loss: 0.470 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 26.555876970291138
Epoch: 54, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.502 Vali Acc: 0.952 Test Loss: 0.502 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 24.178041458129883
Epoch: 55, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.568 Vali Acc: 0.931 Test Loss: 0.568 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 26.088589906692505
Epoch: 56, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.468 Vali Acc: 0.946 Test Loss: 0.468 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 27.04656672477722
Epoch: 57, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.561 Vali Acc: 0.935 Test Loss: 0.561 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 25.856953382492065
Epoch: 58, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.534 Vali Acc: 0.950 Test Loss: 0.534 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 24.57981538772583
Epoch: 59, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.587 Vali Acc: 0.946 Test Loss: 0.587 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 24.0776948928833
Epoch: 60, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.806 Vali Acc: 0.930 Test Loss: 0.806 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 26.17983102798462
Epoch: 61, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.438 Vali Acc: 0.959 Test Loss: 0.438 Test Acc: 0.959
Validation loss decreased (-0.954731 --> -0.958909).  Saving model ...
Epoch: 62 cost time: 26.130715370178223
Epoch: 62, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.418 Vali Acc: 0.956 Test Loss: 0.418 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 24.32679057121277
Epoch: 63, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.544 Vali Acc: 0.949 Test Loss: 0.544 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 23.827372074127197
Epoch: 64, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.516 Vali Acc: 0.951 Test Loss: 0.516 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 25.589442253112793
Epoch: 65, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.473 Vali Acc: 0.957 Test Loss: 0.473 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 27.036160707473755
Epoch: 66, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.762 Vali Acc: 0.936 Test Loss: 0.762 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 24.729671716690063
Epoch: 67, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.636 Vali Acc: 0.935 Test Loss: 0.636 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 24.859230279922485
Epoch: 68, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.471 Vali Acc: 0.960 Test Loss: 0.471 Test Acc: 0.960
Validation loss decreased (-0.958909 --> -0.959605).  Saving model ...
Epoch: 69 cost time: 25.19633960723877
Epoch: 69, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.550 Vali Acc: 0.946 Test Loss: 0.550 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 26.317323923110962
Epoch: 70, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.419 Vali Acc: 0.961 Test Loss: 0.419 Test Acc: 0.961
Validation loss decreased (-0.959605 --> -0.960999).  Saving model ...
Epoch: 71 cost time: 26.715716123580933
Epoch: 71, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.930 Test Loss: 0.641 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 25.3913152217865
Epoch: 72, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.451 Vali Acc: 0.958 Test Loss: 0.451 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 25.470418453216553
Epoch: 73, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.519 Vali Acc: 0.951 Test Loss: 0.519 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 24.740803956985474
Epoch: 74, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.470 Vali Acc: 0.958 Test Loss: 0.470 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 26.35009002685547
Epoch: 75, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.507 Vali Acc: 0.955 Test Loss: 0.507 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 26.87298345565796
Epoch: 76, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.481 Vali Acc: 0.961 Test Loss: 0.481 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 25.129101753234863
Epoch: 77, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.507 Vali Acc: 0.958 Test Loss: 0.507 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 24.46846842765808
Epoch: 78, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.485 Vali Acc: 0.954 Test Loss: 0.485 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 24.72815227508545
Epoch: 79, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.499 Vali Acc: 0.956 Test Loss: 0.499 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 25.40026617050171
Epoch: 80, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.441 Vali Acc: 0.964 Test Loss: 0.441 Test Acc: 0.964
Validation loss decreased (-0.960999 --> -0.963784).  Saving model ...
Epoch: 81 cost time: 26.207900762557983
Epoch: 81, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.401 Vali Acc: 0.964 Test Loss: 0.401 Test Acc: 0.964
Validation loss decreased (-0.963784 --> -0.963784).  Saving model ...
Epoch: 82 cost time: 25.29653310775757
Epoch: 82, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.435 Vali Acc: 0.971 Test Loss: 0.435 Test Acc: 0.971
Validation loss decreased (-0.963784 --> -0.971444).  Saving model ...
Epoch: 83 cost time: 25.760902643203735
Epoch: 83, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.467 Vali Acc: 0.962 Test Loss: 0.467 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 25.853001594543457
Epoch: 84, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.479 Vali Acc: 0.957 Test Loss: 0.479 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 26.253397464752197
Epoch: 85, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.576 Vali Acc: 0.949 Test Loss: 0.576 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 27.543953895568848
Epoch: 86, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.859 Vali Acc: 0.914 Test Loss: 0.859 Test Acc: 0.914
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 26.402690649032593
Epoch: 87, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.619 Vali Acc: 0.951 Test Loss: 0.619 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 25.769588947296143
Epoch: 88, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.750 Vali Acc: 0.940 Test Loss: 0.750 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 26.9016170501709
Epoch: 89, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.543 Vali Acc: 0.947 Test Loss: 0.543 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 26.84269142150879
Epoch: 90, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.582 Vali Acc: 0.949 Test Loss: 0.582 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 26.25610589981079
Epoch: 91, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.549 Vali Acc: 0.955 Test Loss: 0.549 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 26.411216974258423
Epoch: 92, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.415 Vali Acc: 0.953 Test Loss: 0.415 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.63696813583374
Epoch: 1, Steps: 89 | Train Loss: 2.616 Vali Loss: 2.053 Vali Acc: 0.363 Test Loss: 2.053 Test Acc: 0.363
Validation loss decreased (inf --> -0.362793).  Saving model ...
Epoch: 2 cost time: 27.69193172454834
Epoch: 2, Steps: 89 | Train Loss: 1.269 Vali Loss: 1.261 Vali Acc: 0.579 Test Loss: 1.261 Test Acc: 0.579
Validation loss decreased (-0.362793 --> -0.578678).  Saving model ...
Epoch: 3 cost time: 26.4083092212677
Epoch: 3, Steps: 89 | Train Loss: 0.567 Vali Loss: 0.689 Vali Acc: 0.795 Test Loss: 0.689 Test Acc: 0.795
Validation loss decreased (-0.578678 --> -0.794561).  Saving model ...
Epoch: 4 cost time: 27.0899019241333
Epoch: 4, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.709 Vali Acc: 0.790 Test Loss: 0.709 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.713714361190796
Epoch: 5, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
Validation loss decreased (-0.794561 --> -0.803615).  Saving model ...
Epoch: 6 cost time: 26.84832000732422
Epoch: 6, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
Validation loss decreased (-0.803615 --> -0.838435).  Saving model ...
Epoch: 7 cost time: 27.04212999343872
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.521 Vali Acc: 0.840 Test Loss: 0.521 Test Acc: 0.840
Validation loss decreased (-0.838435 --> -0.839828).  Saving model ...
Epoch: 8 cost time: 25.27839756011963
Epoch: 8, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.560 Vali Acc: 0.840 Test Loss: 0.560 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.5114848613739
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.478 Vali Acc: 0.864 Test Loss: 0.478 Test Acc: 0.864
Validation loss decreased (-0.839828 --> -0.864201).  Saving model ...
Epoch: 10 cost time: 26.35672664642334
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 27.95616579055786
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
Validation loss decreased (-0.864201 --> -0.876736).  Saving model ...
Epoch: 12 cost time: 26.51114797592163
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.517 Vali Acc: 0.873 Test Loss: 0.517 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 24.990000009536743
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.399 Vali Acc: 0.910 Test Loss: 0.399 Test Acc: 0.910
Validation loss decreased (-0.876736 --> -0.910163).  Saving model ...
Epoch: 14 cost time: 25.18847370147705
Epoch: 14, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.386 Vali Acc: 0.895 Test Loss: 0.386 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.025079011917114
Epoch: 15, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.453 Vali Acc: 0.901 Test Loss: 0.453 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 27.375186920166016
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.499 Vali Acc: 0.880 Test Loss: 0.499 Test Acc: 0.880
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 27.01883864402771
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.561 Vali Acc: 0.885 Test Loss: 0.561 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 26.203033208847046
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.878 Vali Acc: 0.834 Test Loss: 0.878 Test Acc: 0.834
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 27.68241834640503
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
Validation loss decreased (-0.910163 --> -0.922002).  Saving model ...
Epoch: 20 cost time: 25.94241213798523
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.514 Vali Acc: 0.898 Test Loss: 0.514 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 26.579681158065796
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
Validation loss decreased (-0.922002 --> -0.935234).  Saving model ...
Epoch: 22 cost time: 26.011550664901733
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.611 Vali Acc: 0.880 Test Loss: 0.611 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 24.57320261001587
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.531 Vali Acc: 0.901 Test Loss: 0.531 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 25.4765682220459
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.811 Vali Acc: 0.892 Test Loss: 0.811 Test Acc: 0.892
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 26.147663831710815
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.486 Vali Acc: 0.912 Test Loss: 0.486 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 26.5434250831604
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.464 Vali Acc: 0.905 Test Loss: 0.464 Test Acc: 0.905
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 25.12465476989746
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.392 Vali Acc: 0.932 Test Loss: 0.392 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 25.069763660430908
Epoch: 28, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.931 Vali Acc: 0.878 Test Loss: 0.931 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 26.426783084869385
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.424 Vali Acc: 0.932 Test Loss: 0.424 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 26.237064599990845
Epoch: 30, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.547 Vali Acc: 0.886 Test Loss: 0.547 Test Acc: 0.886
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 26.453094720840454
Epoch: 31, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.904 Test Loss: 0.658 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9352367688022284
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.301854133605957
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.060 Test Loss: 2.995 Test Acc: 0.060
Validation loss decreased (inf --> -0.059859).  Saving model ...
Epoch: 2 cost time: 27.699045658111572
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.059859 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 26.24941897392273
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 29.589184999465942
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 27.87886118888855
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 25.685242891311646
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 24.894163846969604
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 26.10659670829773
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 27.392938375473022
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 27.414804220199585
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 26.246654272079468
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 24.76371669769287
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 27.53001570701599
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 27.711164474487305
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 26.742282152175903
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 26.731894493103027
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 25.60076403617859
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 26.822511911392212
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 27.99535822868347
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 26.636350870132446
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 24.57084822654724
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 27.17510175704956
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 26.618239879608154
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 27.66158413887024
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 27.642295122146606
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 25.72849941253662
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 26.702409744262695
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 28.253434419631958
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 26.08952832221985
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 25.858776330947876
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 25.52296257019043
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 25.830809354782104
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 27.797046661376953
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 27.00580620765686
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 25.07438325881958
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 25.24831986427307
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 27.52538251876831
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 26.38894248008728
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 26.43490743637085
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 25.29991388320923
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 25.581736087799072
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 27.712294816970825
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 26.06958770751953
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 27.180575847625732
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 26.206453323364258
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 26.521227598190308
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 28.36084532737732
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 27.598395109176636
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 26.18977665901184
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 26.162583827972412
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 26.925360441207886
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 24.466570138931274
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 27.00864005088806
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 27.42158603668213
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 26.509520530700684
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 26.234309196472168
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 57 cost time: 25.84572672843933
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 26.16509747505188
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 26.64430570602417
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 27.903674602508545
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 26.765133142471313
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 26.695427417755127
Epoch: 62, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 25.093180656433105
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 25.292986392974854
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 28.017131567001343
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 25.87053394317627
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 498836
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.463116884231567
Epoch: 1, Steps: 89 | Train Loss: 1.508 Vali Loss: 0.642 Vali Acc: 0.805 Test Loss: 0.642 Test Acc: 0.805
Validation loss decreased (inf --> -0.805008).  Saving model ...
Epoch: 2 cost time: 25.9664945602417
Epoch: 2, Steps: 89 | Train Loss: 0.430 Vali Loss: 0.357 Vali Acc: 0.899 Test Loss: 0.357 Test Acc: 0.899
Validation loss decreased (-0.805008 --> -0.899021).  Saving model ...
Epoch: 3 cost time: 27.243845462799072
Epoch: 3, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.899021 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 27.08414912223816
Epoch: 4, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.357115507125854
Epoch: 5, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (-0.933145 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 26.790529012680054
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.945680 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 27.42585515975952
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
Validation loss decreased (-0.948466 --> -0.953341).  Saving model ...
Epoch: 8 cost time: 28.10361337661743
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.953341 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 25.980558156967163
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.773683071136475
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 26.852773904800415
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 27.23653483390808
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.393472909927368
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.03887104988098
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.961 Test Loss: 0.226 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 25.591808080673218
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.276 Vali Acc: 0.949 Test Loss: 0.276 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 27.05798840522766
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.259 Vali Acc: 0.955 Test Loss: 0.259 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 27.354482412338257
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.962 Test Loss: 0.214 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 25.97981905937195
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.342 Vali Acc: 0.945 Test Loss: 0.342 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 25.71924114227295
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.298 Vali Acc: 0.957 Test Loss: 0.298 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 27.375478744506836
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.397 Vali Acc: 0.943 Test Loss: 0.397 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 27.940324544906616
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.415 Vali Acc: 0.944 Test Loss: 0.415 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.55924892425537
Epoch: 1, Steps: 89 | Train Loss: 1.567 Vali Loss: 0.743 Vali Acc: 0.767 Test Loss: 0.743 Test Acc: 0.767
Validation loss decreased (inf --> -0.766706).  Saving model ...
Epoch: 2 cost time: 26.29609441757202
Epoch: 2, Steps: 89 | Train Loss: 0.504 Vali Loss: 0.450 Vali Acc: 0.859 Test Loss: 0.450 Test Acc: 0.859
Validation loss decreased (-0.766706 --> -0.858631).  Saving model ...
Epoch: 3 cost time: 28.212790727615356
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
Validation loss decreased (-0.858631 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 28.452297687530518
Epoch: 4, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.327 Vali Acc: 0.906 Test Loss: 0.327 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.150609731674194
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.233 Vali Acc: 0.939 Test Loss: 0.233 Test Acc: 0.939
Validation loss decreased (-0.922003 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 26.079953908920288
Epoch: 6, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.239 Vali Acc: 0.923 Test Loss: 0.239 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.095913887023926
Epoch: 7, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.938716 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 25.852643489837646
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.785810947418213
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 26.55326247215271
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.229 Vali Acc: 0.945 Test Loss: 0.229 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.546818256378174
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.958912 --> -0.958912).  Saving model ...
Epoch: 12 cost time: 25.94822096824646
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.951 Test Loss: 0.204 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 26.941589832305908
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.303 Vali Acc: 0.924 Test Loss: 0.303 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.818223237991333
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.383 Vali Acc: 0.930 Test Loss: 0.383 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 26.70378828048706
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.272 Vali Acc: 0.945 Test Loss: 0.272 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 28.129851579666138
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 26.931298971176147
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.958912 --> -0.966572).  Saving model ...
Epoch: 18 cost time: 26.522772073745728
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.291 Vali Acc: 0.953 Test Loss: 0.291 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 25.36522102355957
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.540 Vali Acc: 0.914 Test Loss: 0.540 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 25.259863138198853
Epoch: 20, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.342 Vali Acc: 0.942 Test Loss: 0.342 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.983999729156494
Epoch: 21, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.326 Vali Acc: 0.954 Test Loss: 0.326 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 25.102962017059326
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 24.44359850883484
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.422 Vali Acc: 0.938 Test Loss: 0.422 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 25.145704984664917
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.344 Vali Acc: 0.954 Test Loss: 0.344 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 25.336480855941772
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.409 Vali Acc: 0.942 Test Loss: 0.409 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 25.92043113708496
Epoch: 26, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.471 Vali Acc: 0.937 Test Loss: 0.471 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 25.844971895217896
Epoch: 27, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.962 Test Loss: 0.278 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.2799391746521
Epoch: 1, Steps: 89 | Train Loss: 1.681 Vali Loss: 0.837 Vali Acc: 0.742 Test Loss: 0.837 Test Acc: 0.742
Validation loss decreased (inf --> -0.742331).  Saving model ...
Epoch: 2 cost time: 23.78514266014099
Epoch: 2, Steps: 89 | Train Loss: 0.570 Vali Loss: 0.478 Vali Acc: 0.854 Test Loss: 0.478 Test Acc: 0.854
Validation loss decreased (-0.742331 --> -0.854452).  Saving model ...
Epoch: 3 cost time: 24.954838752746582
Epoch: 3, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.300 Vali Acc: 0.918 Test Loss: 0.300 Test Acc: 0.918
Validation loss decreased (-0.854452 --> -0.917824).  Saving model ...
Epoch: 4 cost time: 25.218673944473267
Epoch: 4, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.335 Vali Acc: 0.905 Test Loss: 0.335 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.149885892868042
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.917824 --> -0.940806).  Saving model ...
Epoch: 6 cost time: 24.08013653755188
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.246 Vali Acc: 0.927 Test Loss: 0.246 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.313867330551147
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
Validation loss decreased (-0.940806 --> -0.946377).  Saving model ...
Epoch: 8 cost time: 23.596829414367676
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.946377 --> -0.956823).  Saving model ...
Epoch: 9 cost time: 23.63080906867981
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.200 Vali Acc: 0.945 Test Loss: 0.200 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.347169160842896
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.70443558692932
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.858302354812622
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.957519).  Saving model ...
Epoch: 13 cost time: 24.16441512107849
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.285361766815186
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.004152297973633
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
Validation loss decreased (-0.957519 --> -0.963786).  Saving model ...
Epoch: 16 cost time: 24.63331151008606
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.257 Vali Acc: 0.949 Test Loss: 0.257 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.938987970352173
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.285 Vali Acc: 0.942 Test Loss: 0.285 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.328876972198486
Epoch: 18, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.366 Vali Acc: 0.938 Test Loss: 0.366 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.936645030975342
Epoch: 19, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.262 Vali Acc: 0.948 Test Loss: 0.262 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 24.795077323913574
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.286 Vali Acc: 0.958 Test Loss: 0.286 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 25.267136812210083
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.265 Vali Acc: 0.955 Test Loss: 0.265 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 24.608391523361206
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.283 Vali Acc: 0.955 Test Loss: 0.283 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 23.572585821151733
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.267 Vali Acc: 0.958 Test Loss: 0.267 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 23.717487335205078
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.956 Test Loss: 0.268 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 24.180463552474976
Epoch: 25, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.362 Vali Acc: 0.943 Test Loss: 0.362 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.739177942276
Epoch: 1, Steps: 89 | Train Loss: 2.048 Vali Loss: 1.115 Vali Acc: 0.700 Test Loss: 1.115 Test Acc: 0.700
Validation loss decreased (inf --> -0.699850).  Saving model ...
Epoch: 2 cost time: 25.082097053527832
Epoch: 2, Steps: 89 | Train Loss: 0.733 Vali Loss: 0.513 Vali Acc: 0.857 Test Loss: 0.513 Test Acc: 0.857
Validation loss decreased (-0.699850 --> -0.856541).  Saving model ...
Epoch: 3 cost time: 24.117858409881592
Epoch: 3, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.342 Vali Acc: 0.907 Test Loss: 0.342 Test Acc: 0.907
Validation loss decreased (-0.856541 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 25.669411420822144
Epoch: 4, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.626193046569824
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.230 Vali Acc: 0.936 Test Loss: 0.230 Test Acc: 0.936
Validation loss decreased (-0.907378 --> -0.935931).  Saving model ...
Epoch: 6 cost time: 23.966721534729004
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.935931 --> -0.936627).  Saving model ...
Epoch: 7 cost time: 24.398298978805542
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
Validation loss decreased (-0.936627 --> -0.945681).  Saving model ...
Epoch: 8 cost time: 25.958362102508545
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (-0.945681 --> -0.953341).  Saving model ...
Epoch: 9 cost time: 24.344773769378662
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (-0.953341 --> -0.954037).  Saving model ...
Epoch: 10 cost time: 24.652016639709473
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 24.302494764328003
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.600679636001587
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 25.79778242111206
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 26.063114404678345
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.286 Vali Acc: 0.945 Test Loss: 0.286 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 26.368399620056152
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.321 Vali Acc: 0.916 Test Loss: 0.321 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 25.779919862747192
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 25.37465524673462
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 25.637583255767822
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.327 Vali Acc: 0.942 Test Loss: 0.327 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 25.38681936264038
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.270 Vali Acc: 0.955 Test Loss: 0.270 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 25.47620677947998
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.341925382614136
Epoch: 1, Steps: 89 | Train Loss: 2.499 Vali Loss: 2.045 Vali Acc: 0.385 Test Loss: 2.045 Test Acc: 0.385
Validation loss decreased (inf --> -0.385077).  Saving model ...
Epoch: 2 cost time: 25.238585710525513
Epoch: 2, Steps: 89 | Train Loss: 1.087 Vali Loss: 0.745 Vali Acc: 0.788 Test Loss: 0.745 Test Acc: 0.788
Validation loss decreased (-0.385077 --> -0.788293).  Saving model ...
Epoch: 3 cost time: 24.729482173919678
Epoch: 3, Steps: 89 | Train Loss: 0.427 Vali Loss: 0.389 Vali Acc: 0.881 Test Loss: 0.389 Test Acc: 0.881
Validation loss decreased (-0.788293 --> -0.880915).  Saving model ...
Epoch: 4 cost time: 25.013668537139893
Epoch: 4, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.880915 --> -0.912950).  Saving model ...
Epoch: 5 cost time: 26.20627188682556
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.912950 --> -0.940805).  Saving model ...
Epoch: 6 cost time: 25.463708877563477
Epoch: 6, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.940805 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 24.587157726287842
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.948466 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 25.247577905654907
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.46851897239685
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.61090636253357
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.946 Test Loss: 0.217 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 25.923516988754272
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.455305576324463
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.419 Vali Acc: 0.928 Test Loss: 0.419 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 25.82112693786621
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 25.946818590164185
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 25.355388402938843
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.375 Vali Acc: 0.929 Test Loss: 0.375 Test Acc: 0.929
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 25.450204610824585
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.203 Vali Acc: 0.955 Test Loss: 0.203 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 24.97715711593628
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.971320867538452
Epoch: 1, Steps: 89 | Train Loss: 2.534 Vali Loss: 2.357 Vali Acc: 0.257 Test Loss: 2.357 Test Acc: 0.257
Validation loss decreased (inf --> -0.256940).  Saving model ...
Epoch: 2 cost time: 26.22202491760254
Epoch: 2, Steps: 89 | Train Loss: 1.135 Vali Loss: 0.857 Vali Acc: 0.761 Test Loss: 0.857 Test Acc: 0.761
Validation loss decreased (-0.256940 --> -0.761133).  Saving model ...
Epoch: 3 cost time: 25.820881128311157
Epoch: 3, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.472 Vali Acc: 0.854 Test Loss: 0.472 Test Acc: 0.854
Validation loss decreased (-0.761133 --> -0.853756).  Saving model ...
Epoch: 4 cost time: 24.685935258865356
Epoch: 4, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.349 Vali Acc: 0.901 Test Loss: 0.349 Test Acc: 0.901
Validation loss decreased (-0.853756 --> -0.901111).  Saving model ...
Epoch: 5 cost time: 25.395705699920654
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.901111 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 25.817852020263672
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.243 Vali Acc: 0.939 Test Loss: 0.243 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.004886627197266
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (-0.943591 --> -0.954037).  Saving model ...
Epoch: 8 cost time: 24.677907705307007
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.340791940689087
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.957519).  Saving model ...
Epoch: 10 cost time: 26.08124303817749
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.296 Vali Acc: 0.934 Test Loss: 0.296 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.58052349090576
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.957519 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 26.99709987640381
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 26.072537183761597
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 25.68197798728943
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 25.775552988052368
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.411 Vali Acc: 0.918 Test Loss: 0.411 Test Acc: 0.918
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 25.287142276763916
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 25.47647452354431
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.204 Vali Acc: 0.955 Test Loss: 0.204 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 26.149093866348267
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 25.02515482902527
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.945 Test Loss: 0.271 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 25.309396743774414
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 25.66218328475952
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.245 Vali Acc: 0.954 Test Loss: 0.245 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.024256706237793
Epoch: 1, Steps: 89 | Train Loss: 2.521 Vali Loss: 2.252 Vali Acc: 0.382 Test Loss: 2.252 Test Acc: 0.382
Validation loss decreased (inf --> -0.382289).  Saving model ...
Epoch: 2 cost time: 24.61376166343689
Epoch: 2, Steps: 89 | Train Loss: 1.156 Vali Loss: 1.160 Vali Acc: 0.657 Test Loss: 1.160 Test Acc: 0.657
Validation loss decreased (-0.382289 --> -0.656674).  Saving model ...
Epoch: 3 cost time: 25.02259063720703
Epoch: 3, Steps: 89 | Train Loss: 0.520 Vali Loss: 0.578 Vali Acc: 0.817 Test Loss: 0.578 Test Acc: 0.817
Validation loss decreased (-0.656674 --> -0.816847).  Saving model ...
Epoch: 4 cost time: 25.076427459716797
Epoch: 4, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.498 Vali Acc: 0.849 Test Loss: 0.498 Test Acc: 0.849
Validation loss decreased (-0.816847 --> -0.848881).  Saving model ...
Epoch: 5 cost time: 25.710512161254883
Epoch: 5, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.360 Vali Acc: 0.886 Test Loss: 0.360 Test Acc: 0.886
Validation loss decreased (-0.848881 --> -0.885790).  Saving model ...
Epoch: 6 cost time: 25.181010007858276
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.036799430847168
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.885790 --> -0.922003).  Saving model ...
Epoch: 8 cost time: 23.46458601951599
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.922003 --> -0.947770).  Saving model ...
Epoch: 9 cost time: 24.325816869735718
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.425 Vali Acc: 0.895 Test Loss: 0.425 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.61806869506836
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.276 Vali Acc: 0.932 Test Loss: 0.276 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.55385947227478
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.35365390777588
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.374 Vali Acc: 0.902 Test Loss: 0.374 Test Acc: 0.902
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.138348817825317
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.294 Vali Acc: 0.939 Test Loss: 0.294 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 25.14350414276123
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.476 Vali Acc: 0.897 Test Loss: 0.476 Test Acc: 0.897
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 24.599984645843506
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 25.603621006011963
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.478 Vali Acc: 0.906 Test Loss: 0.478 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 25.854325771331787
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.946 Test Loss: 0.279 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 24.525415182113647
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.365 Vali Acc: 0.923 Test Loss: 0.365 Test Acc: 0.923
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9477715877437326
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.011180639266968
Epoch: 1, Steps: 89 | Train Loss: 2.561 Vali Loss: 2.087 Vali Acc: 0.388 Test Loss: 2.087 Test Acc: 0.388
Validation loss decreased (inf --> -0.387862).  Saving model ...
Epoch: 2 cost time: 24.941842317581177
Epoch: 2, Steps: 89 | Train Loss: 1.218 Vali Loss: 1.578 Vali Acc: 0.540 Test Loss: 1.578 Test Acc: 0.540
Validation loss decreased (-0.387862 --> -0.540374).  Saving model ...
Epoch: 3 cost time: 24.526048183441162
Epoch: 3, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.926 Vali Acc: 0.673 Test Loss: 0.926 Test Acc: 0.673
Validation loss decreased (-0.540374 --> -0.673389).  Saving model ...
Epoch: 4 cost time: 23.85516667366028
Epoch: 4, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.977 Vali Acc: 0.741 Test Loss: 0.977 Test Acc: 0.741
Validation loss decreased (-0.673389 --> -0.740937).  Saving model ...
Epoch: 5 cost time: 23.455379009246826
Epoch: 5, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.967 Vali Acc: 0.726 Test Loss: 0.967 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.474618673324585
Epoch: 6, Steps: 89 | Train Loss: 0.164 Vali Loss: 1.080 Vali Acc: 0.744 Test Loss: 1.080 Test Acc: 0.744
Validation loss decreased (-0.740937 --> -0.743722).  Saving model ...
Epoch: 7 cost time: 24.466585874557495
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.841 Vali Acc: 0.767 Test Loss: 0.841 Test Acc: 0.767
Validation loss decreased (-0.743722 --> -0.767401).  Saving model ...
Epoch: 8 cost time: 24.316264629364014
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.719 Vali Acc: 0.797 Test Loss: 0.719 Test Acc: 0.797
Validation loss decreased (-0.767401 --> -0.797347).  Saving model ...
Epoch: 9 cost time: 24.201504945755005
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.881 Vali Acc: 0.763 Test Loss: 0.881 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.172156810760498
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.837 Vali Acc: 0.799 Test Loss: 0.837 Test Acc: 0.799
Validation loss decreased (-0.797347 --> -0.799435).  Saving model ...
Epoch: 11 cost time: 25.65654444694519
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.739 Vali Acc: 0.820 Test Loss: 0.739 Test Acc: 0.820
Validation loss decreased (-0.799435 --> -0.819630).  Saving model ...
Epoch: 12 cost time: 24.44979214668274
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 1.253 Vali Acc: 0.772 Test Loss: 1.253 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 24.32359004020691
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.646 Vali Acc: 0.843 Test Loss: 0.646 Test Acc: 0.843
Validation loss decreased (-0.819630 --> -0.842612).  Saving model ...
Epoch: 14 cost time: 24.544318199157715
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 1.003 Vali Acc: 0.792 Test Loss: 1.003 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.25139546394348
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.393 Vali Acc: 0.909 Test Loss: 0.393 Test Acc: 0.909
Validation loss decreased (-0.842612 --> -0.908770).  Saving model ...
Epoch: 16 cost time: 24.4207444190979
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.658 Vali Acc: 0.847 Test Loss: 0.658 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.490900993347168
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.907 Vali Acc: 0.828 Test Loss: 0.907 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.392926692962646
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.508 Vali Acc: 0.882 Test Loss: 0.508 Test Acc: 0.882
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.44605827331543
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.925 Vali Acc: 0.825 Test Loss: 0.925 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 24.37935972213745
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.681 Vali Acc: 0.853 Test Loss: 0.681 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.625248432159424
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 1.400 Vali Acc: 0.792 Test Loss: 1.400 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 25.02712845802307
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.510 Vali Acc: 0.908 Test Loss: 0.510 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 24.197913646697998
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.472 Vali Acc: 0.904 Test Loss: 0.472 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 23.790093898773193
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 1.125 Vali Acc: 0.815 Test Loss: 1.125 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 24.11685347557068
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.436 Vali Acc: 0.913 Test Loss: 0.436 Test Acc: 0.913
Validation loss decreased (-0.908770 --> -0.912948).  Saving model ...
Epoch: 26 cost time: 24.775380611419678
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.634 Vali Acc: 0.895 Test Loss: 0.634 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 24.036057233810425
Epoch: 27, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.646 Vali Acc: 0.889 Test Loss: 0.646 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 23.91781973838806
Epoch: 28, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.530 Vali Acc: 0.894 Test Loss: 0.530 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 23.73906707763672
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.739 Vali Acc: 0.882 Test Loss: 0.739 Test Acc: 0.882
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 23.61164689064026
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.802 Vali Acc: 0.885 Test Loss: 0.802 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 24.008048057556152
Epoch: 31, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.845 Vali Acc: 0.875 Test Loss: 0.845 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 23.541240692138672
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.837 Vali Acc: 0.880 Test Loss: 0.837 Test Acc: 0.880
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 24.5861976146698
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.617 Vali Acc: 0.914 Test Loss: 0.617 Test Acc: 0.914
Validation loss decreased (-0.912948 --> -0.914339).  Saving model ...
Epoch: 34 cost time: 23.60776376724243
Epoch: 34, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.816 Vali Acc: 0.888 Test Loss: 0.816 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 24.017834424972534
Epoch: 35, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.497 Vali Acc: 0.923 Test Loss: 0.497 Test Acc: 0.923
Validation loss decreased (-0.914339 --> -0.922697).  Saving model ...
Epoch: 36 cost time: 23.082908630371094
Epoch: 36, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.692 Vali Acc: 0.890 Test Loss: 0.692 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 23.6271755695343
Epoch: 37, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.441 Vali Acc: 0.935 Test Loss: 0.441 Test Acc: 0.935
Validation loss decreased (-0.922697 --> -0.934536).  Saving model ...
Epoch: 38 cost time: 23.538787364959717
Epoch: 38, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.752 Vali Acc: 0.888 Test Loss: 0.752 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 24.25197744369507
Epoch: 39, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.672 Vali Acc: 0.909 Test Loss: 0.672 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 23.62979531288147
Epoch: 40, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.582 Vali Acc: 0.907 Test Loss: 0.582 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 24.00307559967041
Epoch: 41, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.579 Vali Acc: 0.921 Test Loss: 0.579 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 24.367799520492554
Epoch: 42, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.542 Vali Acc: 0.937 Test Loss: 0.542 Test Acc: 0.937
Validation loss decreased (-0.934536 --> -0.937320).  Saving model ...
Epoch: 43 cost time: 24.682520627975464
Epoch: 43, Steps: 89 | Train Loss: 0.036 Vali Loss: 1.087 Vali Acc: 0.862 Test Loss: 1.087 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 24.18266248703003
Epoch: 44, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.746 Vali Acc: 0.895 Test Loss: 0.746 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 24.13111710548401
Epoch: 45, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.406 Vali Acc: 0.946 Test Loss: 0.406 Test Acc: 0.946
Validation loss decreased (-0.937320 --> -0.946375).  Saving model ...
Epoch: 46 cost time: 25.836232900619507
Epoch: 46, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.607 Vali Acc: 0.919 Test Loss: 0.607 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 24.075584411621094
Epoch: 47, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.691 Vali Acc: 0.912 Test Loss: 0.691 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 25.023900747299194
Epoch: 48, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.676 Vali Acc: 0.914 Test Loss: 0.676 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 25.76456069946289
Epoch: 49, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.763 Vali Acc: 0.916 Test Loss: 0.763 Test Acc: 0.916
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 26.903035879135132
Epoch: 50, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.462 Vali Acc: 0.947 Test Loss: 0.462 Test Acc: 0.947
Validation loss decreased (-0.946375 --> -0.947071).  Saving model ...
Epoch: 51 cost time: 27.128772974014282
Epoch: 51, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.421 Vali Acc: 0.948 Test Loss: 0.421 Test Acc: 0.948
Validation loss decreased (-0.947071 --> -0.948464).  Saving model ...
Epoch: 52 cost time: 26.794129133224487
Epoch: 52, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.590 Vali Acc: 0.930 Test Loss: 0.590 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 27.33139443397522
Epoch: 53, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.936 Test Loss: 0.564 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 26.89617395401001
Epoch: 54, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.906 Vali Acc: 0.893 Test Loss: 0.906 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 25.95829725265503
Epoch: 55, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.554 Vali Acc: 0.938 Test Loss: 0.554 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 24.836829662322998
Epoch: 56, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.639 Vali Acc: 0.929 Test Loss: 0.639 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 24.245535135269165
Epoch: 57, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.669 Vali Acc: 0.929 Test Loss: 0.669 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 25.362711668014526
Epoch: 58, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.634 Vali Acc: 0.930 Test Loss: 0.634 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 27.0817129611969
Epoch: 59, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.671 Vali Acc: 0.915 Test Loss: 0.671 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 26.643321752548218
Epoch: 60, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.551 Vali Acc: 0.945 Test Loss: 0.551 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 26.77164912223816
Epoch: 61, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.819 Vali Acc: 0.912 Test Loss: 0.819 Test Acc: 0.912
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9484679665738162
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 28.84019684791565
Epoch: 1, Steps: 89 | Train Loss: 2.619 Vali Loss: 2.076 Vali Acc: 0.416 Test Loss: 2.076 Test Acc: 0.416
Validation loss decreased (inf --> -0.416414).  Saving model ...
Epoch: 2 cost time: 25.938311100006104
Epoch: 2, Steps: 89 | Train Loss: 1.261 Vali Loss: 1.494 Vali Acc: 0.569 Test Loss: 1.494 Test Acc: 0.569
Validation loss decreased (-0.416414 --> -0.568927).  Saving model ...
Epoch: 3 cost time: 25.844363689422607
Epoch: 3, Steps: 89 | Train Loss: 0.575 Vali Loss: 0.709 Vali Acc: 0.779 Test Loss: 0.709 Test Acc: 0.779
Validation loss decreased (-0.568927 --> -0.778544).  Saving model ...
Epoch: 4 cost time: 25.35755968093872
Epoch: 4, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.607 Vali Acc: 0.825 Test Loss: 0.607 Test Acc: 0.825
Validation loss decreased (-0.778544 --> -0.824506).  Saving model ...
Epoch: 5 cost time: 26.16648578643799
Epoch: 5, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.581 Vali Acc: 0.840 Test Loss: 0.581 Test Acc: 0.840
Validation loss decreased (-0.824506 --> -0.839827).  Saving model ...
Epoch: 6 cost time: 25.89525270462036
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.499 Vali Acc: 0.854 Test Loss: 0.499 Test Acc: 0.854
Validation loss decreased (-0.839827 --> -0.854452).  Saving model ...
Epoch: 7 cost time: 24.457068920135498
Epoch: 7, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.384 Vali Acc: 0.896 Test Loss: 0.384 Test Acc: 0.896
Validation loss decreased (-0.854452 --> -0.896236).  Saving model ...
Epoch: 8 cost time: 26.17416763305664
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.309 Vali Acc: 0.913 Test Loss: 0.309 Test Acc: 0.913
Validation loss decreased (-0.896236 --> -0.912950).  Saving model ...
Epoch: 9 cost time: 26.171543836593628
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.610 Vali Acc: 0.847 Test Loss: 0.610 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.85025119781494
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.356 Vali Acc: 0.907 Test Loss: 0.356 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 24.383471727371216
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.541 Vali Acc: 0.867 Test Loss: 0.541 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.961985111236572
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.748 Vali Acc: 0.852 Test Loss: 0.748 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.461171627044678
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.327 Vali Acc: 0.920 Test Loss: 0.327 Test Acc: 0.920
Validation loss decreased (-0.912950 --> -0.919913).  Saving model ...
Epoch: 14 cost time: 23.658873319625854
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.424 Vali Acc: 0.909 Test Loss: 0.424 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.0114426612854
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.339 Vali Acc: 0.923 Test Loss: 0.339 Test Acc: 0.923
Validation loss decreased (-0.919913 --> -0.922699).  Saving model ...
Epoch: 16 cost time: 24.31031560897827
Epoch: 16, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.355 Vali Acc: 0.929 Test Loss: 0.355 Test Acc: 0.929
Validation loss decreased (-0.922699 --> -0.928966).  Saving model ...
Epoch: 17 cost time: 23.900126218795776
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.391 Vali Acc: 0.920 Test Loss: 0.391 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.803990364074707
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.314 Vali Acc: 0.932 Test Loss: 0.314 Test Acc: 0.932
Validation loss decreased (-0.928966 --> -0.932448).  Saving model ...
Epoch: 19 cost time: 23.222637176513672
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.697 Vali Acc: 0.889 Test Loss: 0.697 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.202782154083252
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.377 Vali Acc: 0.926 Test Loss: 0.377 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.086857080459595
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.386 Vali Acc: 0.931 Test Loss: 0.386 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.180717945098877
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.309 Vali Acc: 0.946 Test Loss: 0.309 Test Acc: 0.946
Validation loss decreased (-0.932448 --> -0.945679).  Saving model ...
Epoch: 23 cost time: 23.787296533584595
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.382 Vali Acc: 0.923 Test Loss: 0.382 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 23.86257815361023
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.590 Vali Acc: 0.898 Test Loss: 0.590 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 25.263296127319336
Epoch: 25, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.408 Vali Acc: 0.939 Test Loss: 0.408 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 24.98794651031494
Epoch: 26, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.478 Vali Acc: 0.920 Test Loss: 0.478 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 24.40936827659607
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.375 Vali Acc: 0.942 Test Loss: 0.375 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 24.835369348526
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.427 Vali Acc: 0.932 Test Loss: 0.427 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 25.158175230026245
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.315 Vali Acc: 0.953 Test Loss: 0.315 Test Acc: 0.953
Validation loss decreased (-0.945679 --> -0.953339).  Saving model ...
Epoch: 30 cost time: 24.963158130645752
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.544 Vali Acc: 0.931 Test Loss: 0.544 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 25.240809202194214
Epoch: 31, Steps: 89 | Train Loss: 0.038 Vali Loss: 1.310 Vali Acc: 0.872 Test Loss: 1.310 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 25.432911157608032
Epoch: 32, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.483 Vali Acc: 0.928 Test Loss: 0.483 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 25.02133083343506
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.491 Vali Acc: 0.928 Test Loss: 0.491 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 25.52349352836609
Epoch: 34, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.601 Vali Acc: 0.912 Test Loss: 0.601 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 25.82127094268799
Epoch: 35, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.442 Vali Acc: 0.939 Test Loss: 0.442 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 24.929572343826294
Epoch: 36, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.482 Vali Acc: 0.944 Test Loss: 0.482 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 25.600202322006226
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.660 Vali Acc: 0.919 Test Loss: 0.660 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 23.8462393283844
Epoch: 38, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.614 Vali Acc: 0.916 Test Loss: 0.614 Test Acc: 0.916
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 24.077956914901733
Epoch: 39, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.463 Vali Acc: 0.946 Test Loss: 0.463 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.18027400970459
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.054 Test Loss: 2.995 Test Acc: 0.054
Validation loss decreased (inf --> -0.054288).  Saving model ...
Epoch: 2 cost time: 23.943638563156128
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.054 Test Loss: 2.995 Test Acc: 0.054
Validation loss decreased (-0.054288 --> -0.054288).  Saving model ...
Epoch: 3 cost time: 24.0462429523468
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.054288 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 23.654320001602173
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 25.64316749572754
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 24.983327865600586
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 24.65299677848816
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 24.83012890815735
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 24.37854027748108
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 24.662034034729004
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 25.686190366744995
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 26.27098298072815
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 24.98345112800598
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 24.78221893310547
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 26.010434865951538
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 25.771830797195435
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 26.19413685798645
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 25.535789012908936
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.36494541168213
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 24.8342547416687
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 24.405943155288696
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 24.33187174797058
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 25.034786224365234
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 23.66531729698181
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 23.645002365112305
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 25.0410418510437
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 24.952646493911743
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 24.347480297088623
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 25.015773057937622
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 25.64849281311035
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 24.516260147094727
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 24.577068567276
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 26.078617095947266
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 26.033599376678467
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.346670866012573
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 25.65175223350525
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 25.50313091278076
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 25.545655012130737
Epoch: 38, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 25.9456205368042
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 24.97673535346985
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 27.490821361541748
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 25.367740392684937
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 24.65172290802002
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 25.77946972846985
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 25.59745693206787
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 24.888741970062256
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 24.595242023468018
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 23.95080876350403
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 25.11917805671692
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 24.523820877075195
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 24.778188467025757
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 24.57683300971985
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 24.6935977935791
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 24.210421085357666
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 55 cost time: 24.818347215652466
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 24.384058713912964
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 24.181418657302856
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 24.23924493789673
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 24.40573239326477
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 24.29621911048889
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 24.205535173416138
Epoch: 61, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 25.759480476379395
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 25.054527521133423
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 24.043890953063965
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 25.29382824897766
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 449684
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.773626565933228
Epoch: 1, Steps: 89 | Train Loss: 1.722 Vali Loss: 0.673 Vali Acc: 0.825 Test Loss: 0.673 Test Acc: 0.825
Validation loss decreased (inf --> -0.825202).  Saving model ...
Epoch: 2 cost time: 23.94920802116394
Epoch: 2, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
Validation loss decreased (-0.825202 --> -0.906682).  Saving model ...
Epoch: 3 cost time: 24.023598432540894
Epoch: 3, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.248 Vali Acc: 0.929 Test Loss: 0.248 Test Acc: 0.929
Validation loss decreased (-0.906682 --> -0.928967).  Saving model ...
Epoch: 4 cost time: 23.261541604995728
Epoch: 4, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.928967 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 22.71890091896057
Epoch: 5, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.202 Vali Acc: 0.939 Test Loss: 0.202 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.636645317077637
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.15083384513855
Epoch: 7, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.29348134994507
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 22.80799889564514
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.953 Test Loss: 0.161 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.328465461730957
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.592193365097046
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.991714477539062
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 24.344088077545166
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 23.40229058265686
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 24.702343940734863
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 23.76708722114563
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 23.441077947616577
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
Validation loss decreased (-0.961698 --> -0.965876).  Saving model ...
Epoch: 18 cost time: 24.38078498840332
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.314669609069824
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 24.64405655860901
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.264 Vali Acc: 0.936 Test Loss: 0.264 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 24.405139207839966
Epoch: 21, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 23.913331270217896
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 25.397477865219116
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 26.154144763946533
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.255 Vali Acc: 0.958 Test Loss: 0.255 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 27.546561002731323
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 24.592947721481323
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.953 Test Loss: 0.284 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 22.49820852279663
Epoch: 27, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.225 Vali Acc: 0.962 Test Loss: 0.225 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.537486791610718
Epoch: 1, Steps: 89 | Train Loss: 1.786 Vali Loss: 0.778 Vali Acc: 0.795 Test Loss: 0.778 Test Acc: 0.795
Validation loss decreased (inf --> -0.794560).  Saving model ...
Epoch: 2 cost time: 24.798585653305054
Epoch: 2, Steps: 89 | Train Loss: 0.567 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
Validation loss decreased (-0.794560 --> -0.866987).  Saving model ...
Epoch: 3 cost time: 25.041232109069824
Epoch: 3, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.298 Vali Acc: 0.909 Test Loss: 0.298 Test Acc: 0.909
Validation loss decreased (-0.866987 --> -0.909468).  Saving model ...
Epoch: 4 cost time: 23.520241022109985
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
Validation loss decreased (-0.909468 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 23.767613410949707
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.205 Vali Acc: 0.940 Test Loss: 0.205 Test Acc: 0.940
Validation loss decreased (-0.939413 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 25.27826428413391
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
Validation loss decreased (-0.940109 --> -0.945681).  Saving model ...
Epoch: 7 cost time: 24.517648220062256
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.193 Vali Acc: 0.939 Test Loss: 0.193 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.889870643615723
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.945681 --> -0.951251).  Saving model ...
Epoch: 9 cost time: 22.8119535446167
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.951251 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 23.679620027542114
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.189744472503662
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.45401883125305
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 13 cost time: 25.66716957092285
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.66040825843811
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.86190891265869
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 26.192957401275635
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 25.11207938194275
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 24.981460571289062
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.213459730148315
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 24.72382950782776
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 25.48202395439148
Epoch: 21, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.179 Vali Acc: 0.961 Test Loss: 0.179 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 24.491679430007935
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.403421640396118
Epoch: 1, Steps: 89 | Train Loss: 1.921 Vali Loss: 0.902 Vali Acc: 0.763 Test Loss: 0.902 Test Acc: 0.763
Validation loss decreased (inf --> -0.762526).  Saving model ...
Epoch: 2 cost time: 24.059240102767944
Epoch: 2, Steps: 89 | Train Loss: 0.663 Vali Loss: 0.540 Vali Acc: 0.836 Test Loss: 0.540 Test Acc: 0.836
Validation loss decreased (-0.762526 --> -0.836346).  Saving model ...
Epoch: 3 cost time: 23.156693696975708
Epoch: 3, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
Validation loss decreased (-0.836346 --> -0.899718).  Saving model ...
Epoch: 4 cost time: 22.66748595237732
Epoch: 4, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
Validation loss decreased (-0.899718 --> -0.919914).  Saving model ...
Epoch: 5 cost time: 24.259034156799316
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
Validation loss decreased (-0.919914 --> -0.936627).  Saving model ...
Epoch: 6 cost time: 24.590811491012573
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.90202808380127
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.41671895980835
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.268 Vali Acc: 0.926 Test Loss: 0.268 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 22.444791078567505
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.936627 --> -0.944287).  Saving model ...
Epoch: 10 cost time: 23.820074558258057
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.93710947036743
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.274 Vali Acc: 0.928 Test Loss: 0.274 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.23413848876953
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.805612564086914
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
Validation loss decreased (-0.944287 --> -0.949162).  Saving model ...
Epoch: 14 cost time: 25.00445055961609
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.461679458618164
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.149640560150146
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.229 Vali Acc: 0.947 Test Loss: 0.229 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 25.17660355567932
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.955 Test Loss: 0.202 Test Acc: 0.955
Validation loss decreased (-0.949162 --> -0.954733).  Saving model ...
Epoch: 18 cost time: 24.384467840194702
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 25.438676118850708
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.935 Test Loss: 0.277 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 26.004472017288208
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.304 Vali Acc: 0.935 Test Loss: 0.304 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 23.701875686645508
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.240 Vali Acc: 0.946 Test Loss: 0.240 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 24.522539854049683
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.308 Vali Acc: 0.932 Test Loss: 0.308 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 23.995944261550903
Epoch: 23, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 23.10069251060486
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.316 Vali Acc: 0.942 Test Loss: 0.316 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 23.267096519470215
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.265 Vali Acc: 0.951 Test Loss: 0.265 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 23.41778039932251
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.267 Vali Acc: 0.951 Test Loss: 0.267 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 22.47465491294861
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.957 Test Loss: 0.248 Test Acc: 0.957
Validation loss decreased (-0.954733 --> -0.956822).  Saving model ...
Epoch: 28 cost time: 24.583162307739258
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
Validation loss decreased (-0.956822 --> -0.963786).  Saving model ...
Epoch: 29 cost time: 24.903844833374023
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.961 Test Loss: 0.249 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 22.892659425735474
Epoch: 30, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.288 Vali Acc: 0.955 Test Loss: 0.288 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 23.464411735534668
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.293 Vali Acc: 0.951 Test Loss: 0.293 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 23.545145988464355
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.958 Test Loss: 0.262 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 23.452775239944458
Epoch: 33, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.350 Vali Acc: 0.942 Test Loss: 0.350 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 22.566341638565063
Epoch: 34, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.381 Vali Acc: 0.928 Test Loss: 0.381 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 22.58171033859253
Epoch: 35, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.432 Vali Acc: 0.930 Test Loss: 0.432 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 23.67270565032959
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.404 Vali Acc: 0.945 Test Loss: 0.404 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 23.05848264694214
Epoch: 37, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.388 Vali Acc: 0.945 Test Loss: 0.388 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 22.590571641921997
Epoch: 38, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.396 Vali Acc: 0.937 Test Loss: 0.396 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.93093991279602
Epoch: 1, Steps: 89 | Train Loss: 2.282 Vali Loss: 1.229 Vali Acc: 0.719 Test Loss: 1.229 Test Acc: 0.719
Validation loss decreased (inf --> -0.718651).  Saving model ...
Epoch: 2 cost time: 24.517727613449097
Epoch: 2, Steps: 89 | Train Loss: 0.889 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
Validation loss decreased (-0.718651 --> -0.821721).  Saving model ...
Epoch: 3 cost time: 22.889257431030273
Epoch: 3, Steps: 89 | Train Loss: 0.480 Vali Loss: 0.448 Vali Acc: 0.868 Test Loss: 0.448 Test Acc: 0.868
Validation loss decreased (-0.821721 --> -0.867684).  Saving model ...
Epoch: 4 cost time: 22.738720655441284
Epoch: 4, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.309 Vali Acc: 0.912 Test Loss: 0.309 Test Acc: 0.912
Validation loss decreased (-0.867684 --> -0.912253).  Saving model ...
Epoch: 5 cost time: 22.7177312374115
Epoch: 5, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.249 Vali Acc: 0.923 Test Loss: 0.249 Test Acc: 0.923
Validation loss decreased (-0.912253 --> -0.922699).  Saving model ...
Epoch: 6 cost time: 21.836148500442505
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.216 Vali Acc: 0.936 Test Loss: 0.216 Test Acc: 0.936
Validation loss decreased (-0.922699 --> -0.935931).  Saving model ...
Epoch: 7 cost time: 22.43227767944336
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.935931 --> -0.936627).  Saving model ...
Epoch: 8 cost time: 22.792075634002686
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.945 Test Loss: 0.195 Test Acc: 0.945
Validation loss decreased (-0.936627 --> -0.944984).  Saving model ...
Epoch: 9 cost time: 22.19259762763977
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.944984 --> -0.947770).  Saving model ...
Epoch: 10 cost time: 21.848066091537476
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.947770 --> -0.951252).  Saving model ...
Epoch: 11 cost time: 23.378725051879883
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.839329957962036
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951252 --> -0.951948).  Saving model ...
Epoch: 13 cost time: 22.553166389465332
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.910776138305664
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.957519).  Saving model ...
Epoch: 15 cost time: 23.032488584518433
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961698).  Saving model ...
Epoch: 16 cost time: 22.873085737228394
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.262491703033447
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.448853254318237
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 22.757062911987305
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 22.598662614822388
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 22.940391540527344
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.947 Test Loss: 0.218 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.803033351898193
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.294 Vali Acc: 0.939 Test Loss: 0.294 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 23.517526149749756
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.312 Vali Acc: 0.936 Test Loss: 0.312 Test Acc: 0.936
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 23.294798851013184
Epoch: 24, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 22.339537620544434
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.02411437034607
Epoch: 1, Steps: 89 | Train Loss: 2.703 Vali Loss: 2.261 Vali Acc: 0.388 Test Loss: 2.261 Test Acc: 0.388
Validation loss decreased (inf --> -0.387860).  Saving model ...
Epoch: 2 cost time: 23.700648069381714
Epoch: 2, Steps: 89 | Train Loss: 1.616 Vali Loss: 1.118 Vali Acc: 0.684 Test Loss: 1.118 Test Acc: 0.684
Validation loss decreased (-0.387860 --> -0.683833).  Saving model ...
Epoch: 3 cost time: 23.34293484687805
Epoch: 3, Steps: 89 | Train Loss: 0.680 Vali Loss: 0.535 Vali Acc: 0.841 Test Loss: 0.535 Test Acc: 0.841
Validation loss decreased (-0.683833 --> -0.841220).  Saving model ...
Epoch: 4 cost time: 23.53588366508484
Epoch: 4, Steps: 89 | Train Loss: 0.375 Vali Loss: 0.351 Vali Acc: 0.896 Test Loss: 0.351 Test Acc: 0.896
Validation loss decreased (-0.841220 --> -0.895540).  Saving model ...
Epoch: 5 cost time: 24.371262550354004
Epoch: 5, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.239 Vali Acc: 0.924 Test Loss: 0.239 Test Acc: 0.924
Validation loss decreased (-0.895540 --> -0.924092).  Saving model ...
Epoch: 6 cost time: 23.758151292800903
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
Validation loss decreased (-0.924092 --> -0.942895).  Saving model ...
Epoch: 7 cost time: 23.15275764465332
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.942895 --> -0.954038).  Saving model ...
Epoch: 8 cost time: 24.293978929519653
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.954038 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 23.43179178237915
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966573).  Saving model ...
Epoch: 10 cost time: 23.194836854934692
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.40438413619995
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 12 cost time: 23.647752046585083
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.84277653694153
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.056395769119263
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 24.372567892074585
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 24.640757083892822
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 24.640156269073486
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 23.9711594581604
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 24.475303649902344
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 20 cost time: 23.272695779800415
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.42770481109619
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.03870940208435
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 24.409661531448364
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 25.59655451774597
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 24.759193897247314
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.47136616706848
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.966 Test Loss: 0.177 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 22.36679196357727
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.964 Test Loss: 0.192 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 24.162904739379883
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.960 Test Loss: 0.213 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 23.188918352127075
Epoch: 29, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.283 Vali Acc: 0.946 Test Loss: 0.283 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.95561695098877
Epoch: 1, Steps: 89 | Train Loss: 2.749 Vali Loss: 2.503 Vali Acc: 0.246 Test Loss: 2.503 Test Acc: 0.246
Validation loss decreased (inf --> -0.245797).  Saving model ...
Epoch: 2 cost time: 24.643195867538452
Epoch: 2, Steps: 89 | Train Loss: 1.708 Vali Loss: 1.513 Vali Acc: 0.511 Test Loss: 1.513 Test Acc: 0.511
Validation loss decreased (-0.245797 --> -0.511127).  Saving model ...
Epoch: 3 cost time: 23.08438992500305
Epoch: 3, Steps: 89 | Train Loss: 0.770 Vali Loss: 0.840 Vali Acc: 0.740 Test Loss: 0.840 Test Acc: 0.740
Validation loss decreased (-0.511127 --> -0.740242).  Saving model ...
Epoch: 4 cost time: 23.052727937698364
Epoch: 4, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.551 Vali Acc: 0.834 Test Loss: 0.551 Test Acc: 0.834
Validation loss decreased (-0.740242 --> -0.834256).  Saving model ...
Epoch: 5 cost time: 25.618897676467896
Epoch: 5, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.834256 --> -0.900414).  Saving model ...
Epoch: 6 cost time: 23.99147081375122
Epoch: 6, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.900414 --> -0.922003).  Saving model ...
Epoch: 7 cost time: 25.15173888206482
Epoch: 7, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.227 Vali Acc: 0.936 Test Loss: 0.227 Test Acc: 0.936
Validation loss decreased (-0.922003 --> -0.935931).  Saving model ...
Epoch: 8 cost time: 24.490124225616455
Epoch: 8, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.360615968704224
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.935931 --> -0.951252).  Saving model ...
Epoch: 10 cost time: 24.703540325164795
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.224 Vali Acc: 0.936 Test Loss: 0.224 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.072110891342163
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.951252 --> -0.957519).  Saving model ...
Epoch: 12 cost time: 23.871950387954712
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.961 Test Loss: 0.153 Test Acc: 0.961
Validation loss decreased (-0.957519 --> -0.961001).  Saving model ...
Epoch: 13 cost time: 22.55201506614685
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 23.5793514251709
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.21686816215515
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.197585582733154
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 23.710604667663574
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 23.372955799102783
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.140798330307007
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 24.340030670166016
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.249 Vali Acc: 0.951 Test Loss: 0.249 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 23.307160139083862
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.967269).  Saving model ...
Epoch: 22 cost time: 23.853520154953003
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 24.212362051010132
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 23.361951112747192
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 25 cost time: 24.337246656417847
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970750).  Saving model ...
Epoch: 26 cost time: 24.51986002922058
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 23.335243701934814
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 23.42072319984436
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 23.895604848861694
Epoch: 29, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 23.389028787612915
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 23.35061001777649
Epoch: 31, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 23.21434450149536
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 22.74848175048828
Epoch: 33, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.283 Vali Acc: 0.943 Test Loss: 0.283 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 24.062610149383545
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.267 Vali Acc: 0.949 Test Loss: 0.267 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 23.020775079727173
Epoch: 35, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.65565252304077
Epoch: 1, Steps: 89 | Train Loss: 2.762 Vali Loss: 2.640 Vali Acc: 0.221 Test Loss: 2.640 Test Acc: 0.221
Validation loss decreased (inf --> -0.220726).  Saving model ...
Epoch: 2 cost time: 22.91643214225769
Epoch: 2, Steps: 89 | Train Loss: 1.773 Vali Loss: 1.749 Vali Acc: 0.456 Test Loss: 1.749 Test Acc: 0.456
Validation loss decreased (-0.220726 --> -0.456111).  Saving model ...
Epoch: 3 cost time: 22.37518882751465
Epoch: 3, Steps: 89 | Train Loss: 0.852 Vali Loss: 0.919 Vali Acc: 0.695 Test Loss: 0.919 Test Acc: 0.695
Validation loss decreased (-0.456111 --> -0.694977).  Saving model ...
Epoch: 4 cost time: 22.724781036376953
Epoch: 4, Steps: 89 | Train Loss: 0.508 Vali Loss: 0.646 Vali Acc: 0.815 Test Loss: 0.646 Test Acc: 0.815
Validation loss decreased (-0.694977 --> -0.814757).  Saving model ...
Epoch: 5 cost time: 23.348965644836426
Epoch: 5, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.469 Vali Acc: 0.869 Test Loss: 0.469 Test Acc: 0.869
Validation loss decreased (-0.814757 --> -0.869076).  Saving model ...
Epoch: 6 cost time: 24.19866442680359
Epoch: 6, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.869076 --> -0.899718).  Saving model ...
Epoch: 7 cost time: 22.71494960784912
Epoch: 7, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.275 Vali Acc: 0.918 Test Loss: 0.275 Test Acc: 0.918
Validation loss decreased (-0.899718 --> -0.917825).  Saving model ...
Epoch: 8 cost time: 23.37366557121277
Epoch: 8, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.917825 --> -0.930360).  Saving model ...
Epoch: 9 cost time: 23.528477430343628
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
Validation loss decreased (-0.930360 --> -0.942895).  Saving model ...
Epoch: 10 cost time: 24.21271514892578
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.813742637634277
Epoch: 11, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
Validation loss decreased (-0.942895 --> -0.952644).  Saving model ...
Epoch: 12 cost time: 24.778372764587402
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.300681352615356
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
Validation loss decreased (-0.952644 --> -0.954733).  Saving model ...
Epoch: 14 cost time: 23.254805088043213
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.139277458190918
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.97276759147644
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
Validation loss decreased (-0.954733 --> -0.957519).  Saving model ...
Epoch: 17 cost time: 25.094823360443115
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 24.081175088882446
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.959608).  Saving model ...
Epoch: 19 cost time: 23.301786184310913
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 22.65638256072998
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.286 Vali Acc: 0.939 Test Loss: 0.286 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.421493768692017
Epoch: 21, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.633015155792236
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.350358247756958
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.301 Vali Acc: 0.942 Test Loss: 0.301 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 25.577107191085815
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.246 Vali Acc: 0.953 Test Loss: 0.246 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 24.984763145446777
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.242 Vali Acc: 0.951 Test Loss: 0.242 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 25.592402935028076
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 25.500401973724365
Epoch: 27, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.955 Test Loss: 0.246 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 24.25886845588684
Epoch: 28, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.329 Vali Acc: 0.941 Test Loss: 0.329 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9596100278551533
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.440388679504395
Epoch: 1, Steps: 89 | Train Loss: 2.799 Vali Loss: 2.614 Vali Acc: 0.303 Test Loss: 2.614 Test Acc: 0.303
Validation loss decreased (inf --> -0.302899).  Saving model ...
Epoch: 2 cost time: 24.399560928344727
Epoch: 2, Steps: 89 | Train Loss: 1.844 Vali Loss: 1.823 Vali Acc: 0.440 Test Loss: 1.823 Test Acc: 0.440
Validation loss decreased (-0.302899 --> -0.440093).  Saving model ...
Epoch: 3 cost time: 25.86958622932434
Epoch: 3, Steps: 89 | Train Loss: 0.932 Vali Loss: 1.123 Vali Acc: 0.641 Test Loss: 1.123 Test Acc: 0.641
Validation loss decreased (-0.440093 --> -0.641354).  Saving model ...
Epoch: 4 cost time: 25.033371686935425
Epoch: 4, Steps: 89 | Train Loss: 0.589 Vali Loss: 0.750 Vali Acc: 0.769 Test Loss: 0.750 Test Acc: 0.769
Validation loss decreased (-0.641354 --> -0.768795).  Saving model ...
Epoch: 5 cost time: 24.090050220489502
Epoch: 5, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.634 Vali Acc: 0.804 Test Loss: 0.634 Test Acc: 0.804
Validation loss decreased (-0.768795 --> -0.803615).  Saving model ...
Epoch: 6 cost time: 23.868879318237305
Epoch: 6, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.548 Vali Acc: 0.839 Test Loss: 0.548 Test Acc: 0.839
Validation loss decreased (-0.803615 --> -0.839131).  Saving model ...
Epoch: 7 cost time: 25.72036385536194
Epoch: 7, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.426 Vali Acc: 0.876 Test Loss: 0.426 Test Acc: 0.876
Validation loss decreased (-0.839131 --> -0.876040).  Saving model ...
Epoch: 8 cost time: 23.38163423538208
Epoch: 8, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.369 Vali Acc: 0.890 Test Loss: 0.369 Test Acc: 0.890
Validation loss decreased (-0.876040 --> -0.889968).  Saving model ...
Epoch: 9 cost time: 22.4398455619812
Epoch: 9, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.889968 --> -0.891361).  Saving model ...
Epoch: 10 cost time: 23.864028692245483
Epoch: 10, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.385 Vali Acc: 0.896 Test Loss: 0.385 Test Acc: 0.896
Validation loss decreased (-0.891361 --> -0.895539).  Saving model ...
Epoch: 11 cost time: 24.54210615158081
Epoch: 11, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
Validation loss decreased (-0.895539 --> -0.925485).  Saving model ...
Epoch: 12 cost time: 23.23854923248291
Epoch: 12, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.379 Vali Acc: 0.903 Test Loss: 0.379 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 24.3011953830719
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.271 Vali Acc: 0.921 Test Loss: 0.271 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 23.49206852912903
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.45669436454773
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.389 Vali Acc: 0.912 Test Loss: 0.389 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 23.46412754058838
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.275 Vali Acc: 0.936 Test Loss: 0.275 Test Acc: 0.936
Validation loss decreased (-0.925485 --> -0.935930).  Saving model ...
Epoch: 17 cost time: 24.658372402191162
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.280 Vali Acc: 0.932 Test Loss: 0.280 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.701394081115723
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.235 Vali Acc: 0.949 Test Loss: 0.235 Test Acc: 0.949
Validation loss decreased (-0.935930 --> -0.949162).  Saving model ...
Epoch: 19 cost time: 24.028078317642212
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.60493278503418
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.279 Vali Acc: 0.939 Test Loss: 0.279 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.12286114692688
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.23655891418457
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.378 Vali Acc: 0.913 Test Loss: 0.378 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.37265157699585
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.319 Vali Acc: 0.929 Test Loss: 0.319 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 24.842409372329712
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.950555).  Saving model ...
Epoch: 25 cost time: 25.63996648788452
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 25.464640855789185
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 24.200175523757935
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
Validation loss decreased (-0.950555 --> -0.950555).  Saving model ...
Epoch: 28 cost time: 23.032681226730347
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.302 Vali Acc: 0.940 Test Loss: 0.302 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 23.3743155002594
Epoch: 29, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 22.382695198059082
Epoch: 30, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 22.285726070404053
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 23.308305263519287
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.283 Vali Acc: 0.954 Test Loss: 0.283 Test Acc: 0.954
Validation loss decreased (-0.950555 --> -0.954036).  Saving model ...
Epoch: 33 cost time: 23.29361343383789
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 23.065465211868286
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.298 Vali Acc: 0.948 Test Loss: 0.298 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 23.495631217956543
Epoch: 35, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.304 Vali Acc: 0.939 Test Loss: 0.304 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.63607907295227
Epoch: 36, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 23.75739884376526
Epoch: 37, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.393 Vali Acc: 0.942 Test Loss: 0.393 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 24.150577306747437
Epoch: 38, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.309 Vali Acc: 0.955 Test Loss: 0.309 Test Acc: 0.955
Validation loss decreased (-0.954036 --> -0.955429).  Saving model ...
Epoch: 39 cost time: 23.41995143890381
Epoch: 39, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.419 Vali Acc: 0.935 Test Loss: 0.419 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 22.93653917312622
Epoch: 40, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.454 Vali Acc: 0.943 Test Loss: 0.454 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 23.74286437034607
Epoch: 41, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.394 Vali Acc: 0.944 Test Loss: 0.394 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 23.85728096961975
Epoch: 42, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.362 Vali Acc: 0.953 Test Loss: 0.362 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 23.233068704605103
Epoch: 43, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.355 Vali Acc: 0.953 Test Loss: 0.355 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 23.322364568710327
Epoch: 44, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.379 Vali Acc: 0.946 Test Loss: 0.379 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 22.845017671585083
Epoch: 45, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.418 Vali Acc: 0.948 Test Loss: 0.418 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 23.910382509231567
Epoch: 46, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.436 Vali Acc: 0.945 Test Loss: 0.436 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 22.938268423080444
Epoch: 47, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.403 Vali Acc: 0.948 Test Loss: 0.403 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 23.597169399261475
Epoch: 48, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.343 Vali Acc: 0.961 Test Loss: 0.343 Test Acc: 0.961
Validation loss decreased (-0.955429 --> -0.960999).  Saving model ...
Epoch: 49 cost time: 24.238586902618408
Epoch: 49, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.371 Vali Acc: 0.953 Test Loss: 0.371 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 23.663227081298828
Epoch: 50, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.428 Vali Acc: 0.952 Test Loss: 0.428 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 22.553340673446655
Epoch: 51, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 22.901136875152588
Epoch: 52, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.551 Vali Acc: 0.941 Test Loss: 0.551 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 23.863011360168457
Epoch: 53, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.386 Vali Acc: 0.952 Test Loss: 0.386 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 23.099101305007935
Epoch: 54, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.324 Vali Acc: 0.962 Test Loss: 0.324 Test Acc: 0.962
Validation loss decreased (-0.960999 --> -0.962392).  Saving model ...
Epoch: 55 cost time: 23.13200092315674
Epoch: 55, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.387 Vali Acc: 0.951 Test Loss: 0.387 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 22.62798500061035
Epoch: 56, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.403 Vali Acc: 0.952 Test Loss: 0.403 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 23.343409538269043
Epoch: 57, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.433 Vali Acc: 0.948 Test Loss: 0.433 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 22.417234897613525
Epoch: 58, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.516 Vali Acc: 0.940 Test Loss: 0.516 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 23.17837142944336
Epoch: 59, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.483 Vali Acc: 0.943 Test Loss: 0.483 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 23.49472713470459
Epoch: 60, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.490 Vali Acc: 0.948 Test Loss: 0.490 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 23.581963300704956
Epoch: 61, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 23.42433190345764
Epoch: 62, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.423 Vali Acc: 0.959 Test Loss: 0.423 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 25.2455153465271
Epoch: 63, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.557 Vali Acc: 0.945 Test Loss: 0.557 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 25.128971338272095
Epoch: 64, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.430 Vali Acc: 0.955 Test Loss: 0.430 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9623955431754875
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 27.216212272644043
Epoch: 1, Steps: 89 | Train Loss: 2.817 Vali Loss: 2.642 Vali Acc: 0.263 Test Loss: 2.642 Test Acc: 0.263
Validation loss decreased (inf --> -0.263205).  Saving model ...
Epoch: 2 cost time: 25.394762992858887
Epoch: 2, Steps: 89 | Train Loss: 1.965 Vali Loss: 1.921 Vali Acc: 0.394 Test Loss: 1.921 Test Acc: 0.394
Validation loss decreased (-0.263205 --> -0.394131).  Saving model ...
Epoch: 3 cost time: 26.528477668762207
Epoch: 3, Steps: 89 | Train Loss: 1.078 Vali Loss: 1.442 Vali Acc: 0.545 Test Loss: 1.442 Test Acc: 0.545
Validation loss decreased (-0.394131 --> -0.545250).  Saving model ...
Epoch: 4 cost time: 25.393505811691284
Epoch: 4, Steps: 89 | Train Loss: 0.670 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.545250 --> -0.674781).  Saving model ...
Epoch: 5 cost time: 24.46085786819458
Epoch: 5, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.822 Vali Acc: 0.734 Test Loss: 0.822 Test Acc: 0.734
Validation loss decreased (-0.674781 --> -0.733975).  Saving model ...
Epoch: 6 cost time: 24.682169675827026
Epoch: 6, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.773 Vali Acc: 0.768 Test Loss: 0.773 Test Acc: 0.768
Validation loss decreased (-0.733975 --> -0.768098).  Saving model ...
Epoch: 7 cost time: 22.84593892097473
Epoch: 7, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.584 Vali Acc: 0.820 Test Loss: 0.584 Test Acc: 0.820
Validation loss decreased (-0.768098 --> -0.820328).  Saving model ...
Epoch: 8 cost time: 23.09681224822998
Epoch: 8, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.524 Vali Acc: 0.834 Test Loss: 0.524 Test Acc: 0.834
Validation loss decreased (-0.820328 --> -0.833560).  Saving model ...
Epoch: 9 cost time: 23.68666100502014
Epoch: 9, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.563 Vali Acc: 0.818 Test Loss: 0.563 Test Acc: 0.818
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.515944957733154
Epoch: 10, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.537 Vali Acc: 0.857 Test Loss: 0.537 Test Acc: 0.857
Validation loss decreased (-0.833560 --> -0.856541).  Saving model ...
Epoch: 11 cost time: 24.118075847625732
Epoch: 11, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.449 Vali Acc: 0.888 Test Loss: 0.449 Test Acc: 0.888
Validation loss decreased (-0.856541 --> -0.887879).  Saving model ...
Epoch: 12 cost time: 23.14864945411682
Epoch: 12, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.552 Vali Acc: 0.849 Test Loss: 0.552 Test Acc: 0.849
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.728051900863647
Epoch: 13, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.367 Vali Acc: 0.907 Test Loss: 0.367 Test Acc: 0.907
Validation loss decreased (-0.887879 --> -0.907378).  Saving model ...
Epoch: 14 cost time: 23.616266012191772
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.458 Vali Acc: 0.886 Test Loss: 0.458 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.84751796722412
Epoch: 15, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.423 Vali Acc: 0.896 Test Loss: 0.423 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 23.565428256988525
Epoch: 16, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.342 Vali Acc: 0.918 Test Loss: 0.342 Test Acc: 0.918
Validation loss decreased (-0.907378 --> -0.917824).  Saving model ...
Epoch: 17 cost time: 23.046249628067017
Epoch: 17, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.312 Vali Acc: 0.918 Test Loss: 0.312 Test Acc: 0.918
Validation loss decreased (-0.917824 --> -0.917824).  Saving model ...
Epoch: 18 cost time: 23.06690740585327
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.284 Vali Acc: 0.938 Test Loss: 0.284 Test Acc: 0.938
Validation loss decreased (-0.917824 --> -0.938019).  Saving model ...
Epoch: 19 cost time: 23.014020204544067
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.319 Vali Acc: 0.921 Test Loss: 0.319 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.416651725769043
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.304 Vali Acc: 0.934 Test Loss: 0.304 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.836889505386353
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.346 Vali Acc: 0.920 Test Loss: 0.346 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.24500060081482
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.298 Vali Acc: 0.936 Test Loss: 0.298 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.168932914733887
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.326 Vali Acc: 0.939 Test Loss: 0.326 Test Acc: 0.939
Validation loss decreased (-0.938019 --> -0.939412).  Saving model ...
Epoch: 24 cost time: 23.363921403884888
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.391 Vali Acc: 0.919 Test Loss: 0.391 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 24.84265112876892
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.418 Vali Acc: 0.918 Test Loss: 0.418 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 24.760352849960327
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 24.003218173980713
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.343 Vali Acc: 0.930 Test Loss: 0.343 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 23.19403886795044
Epoch: 28, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.414 Vali Acc: 0.921 Test Loss: 0.414 Test Acc: 0.921
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 23.98441982269287
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.399 Vali Acc: 0.916 Test Loss: 0.399 Test Acc: 0.916
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 23.478201627731323
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.352 Vali Acc: 0.928 Test Loss: 0.352 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 24.102608680725098
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.352 Vali Acc: 0.939 Test Loss: 0.352 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 22.81990885734558
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.359 Vali Acc: 0.939 Test Loss: 0.359 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 23.70816683769226
Epoch: 33, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.345 Vali Acc: 0.945 Test Loss: 0.345 Test Acc: 0.945
Validation loss decreased (-0.939412 --> -0.944983).  Saving model ...
Epoch: 34 cost time: 23.218751907348633
Epoch: 34, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.365 Vali Acc: 0.942 Test Loss: 0.365 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 23.571205139160156
Epoch: 35, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 24.267423629760742
Epoch: 36, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.388 Vali Acc: 0.934 Test Loss: 0.388 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 24.722928285598755
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.462 Vali Acc: 0.925 Test Loss: 0.462 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 24.09579586982727
Epoch: 38, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.424 Vali Acc: 0.935 Test Loss: 0.424 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 24.87995171546936
Epoch: 39, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.391 Vali Acc: 0.935 Test Loss: 0.391 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 24.501343250274658
Epoch: 40, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.454 Vali Acc: 0.928 Test Loss: 0.454 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 23.41024351119995
Epoch: 41, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.422 Vali Acc: 0.921 Test Loss: 0.422 Test Acc: 0.921
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 24.019525289535522
Epoch: 42, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 23.591588497161865
Epoch: 43, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.376 Vali Acc: 0.938 Test Loss: 0.376 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9449860724233984
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.82839560508728
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.055 Test Loss: 2.996 Test Acc: 0.055
Validation loss decreased (inf --> -0.054984).  Saving model ...
Epoch: 2 cost time: 23.953176021575928
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.055 Test Loss: 2.995 Test Acc: 0.055
Validation loss decreased (-0.054984 --> -0.054984).  Saving model ...
Epoch: 3 cost time: 24.34218955039978
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.054984 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 23.617586374282837
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 24.512445211410522
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 24.918376922607422
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 24.427115201950073
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 25.3801589012146
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 25.244498252868652
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 24.26966691017151
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 25.0352041721344
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 24.810492515563965
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 24.652487754821777
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 25.655112504959106
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 26.085525274276733
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 25.680172204971313
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 25.91637420654297
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 24.242984771728516
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.735100030899048
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 26.427809238433838
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 26.1078097820282
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 26.3165762424469
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 26.22497296333313
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 24.419788599014282
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 23.104000329971313
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 23.384050130844116
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 23.628466844558716
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 22.814786672592163
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 22.449490070343018
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 23.360141038894653
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 23.51012372970581
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 22.99993395805359
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 23.417032957077026
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 23.918161392211914
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 23.476815223693848
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 24.246017694473267
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 24.14199471473694
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 24.06915044784546
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 24.222352504730225
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 24.139668226242065
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 24.426530599594116
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 24.84897756576538
Epoch: 42, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 24.294984817504883
Epoch: 43, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 23.96477246284485
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 22.898029804229736
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 23.591278076171875
Epoch: 46, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 47 cost time: 23.696755409240723
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 23.586437702178955
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 23.607150077819824
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 24.30635643005371
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 24.029531002044678
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 23.508387327194214
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 24.44883942604065
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 23.371561527252197
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 55 cost time: 25.7448513507843
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 25.12416911125183
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 25.459668159484863
Epoch: 57, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 24.74406599998474
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 59 cost time: 24.689541339874268
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 23.921307802200317
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 23.888850688934326
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 24.608635187149048
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 23.16430139541626
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 64 cost time: 24.216770887374878
Epoch: 64, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 23.48343253135681
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 23.765357971191406
Epoch: 66, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 23.769686460494995
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 26.10215997695923
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 25.148826360702515
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 27.331139087677002
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 71 cost time: 25.59354567527771
Epoch: 71, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 25.84664559364319
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 25.200170516967773
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 25.20817232131958
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 25.49055528640747
Epoch: 75, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 26.22608518600464
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 25.003143787384033
Epoch: 77, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 24.346771478652954
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 25.03335928916931
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 24.24392342567444
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 552532
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.958354711532593
Epoch: 1, Steps: 89 | Train Loss: 1.787 Vali Loss: 0.722 Vali Acc: 0.795 Test Loss: 0.722 Test Acc: 0.795
Validation loss decreased (inf --> -0.795257).  Saving model ...
Epoch: 2 cost time: 24.637557983398438
Epoch: 2, Steps: 89 | Train Loss: 0.486 Vali Loss: 0.382 Vali Acc: 0.881 Test Loss: 0.382 Test Acc: 0.881
Validation loss decreased (-0.795257 --> -0.880915).  Saving model ...
Epoch: 3 cost time: 24.3378803730011
Epoch: 3, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.880915 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 25.272372007369995
Epoch: 4, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.937324 --> -0.949859).  Saving model ...
Epoch: 5 cost time: 24.541842699050903
Epoch: 5, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
Validation loss decreased (-0.949859 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 23.211748123168945
Epoch: 6, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.4968159198761
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 23.86945104598999
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.158 Vali Acc: 0.952 Test Loss: 0.158 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.502021551132202
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.960305 --> -0.963090).  Saving model ...
Epoch: 10 cost time: 23.993462324142456
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.100595712661743
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.65285086631775
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 24.323683738708496
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 22.786253929138184
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 23.90711283683777
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.277 Vali Acc: 0.932 Test Loss: 0.277 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 22.4529972076416
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 22.468911170959473
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 23.082738161087036
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.963787).  Saving model ...
Epoch: 19 cost time: 22.999967098236084
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 22.50034809112549
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.225 Vali Acc: 0.955 Test Loss: 0.225 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.544633626937866
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 21.6771559715271
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 21.95126438140869
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966572).  Saving model ...
Epoch: 24 cost time: 22.002050161361694
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 23.005970239639282
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 22.29055166244507
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 22.60969638824463
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.313 Vali Acc: 0.939 Test Loss: 0.313 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 24.52423620223999
Epoch: 28, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.255 Vali Acc: 0.953 Test Loss: 0.255 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 24.415063619613647
Epoch: 29, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.248 Vali Acc: 0.955 Test Loss: 0.248 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 24.98565173149109
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966572 --> -0.967268).  Saving model ...
Epoch: 31 cost time: 24.207090139389038
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 24.568461418151855
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 24.41650080680847
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 25.01213574409485
Epoch: 34, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 22.86481213569641
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.971 Test Loss: 0.183 Test Acc: 0.971
Validation loss decreased (-0.967268 --> -0.971447).  Saving model ...
Epoch: 36 cost time: 23.508171796798706
Epoch: 36, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.427 Vali Acc: 0.915 Test Loss: 0.427 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 23.27788472175598
Epoch: 37, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 22.159003257751465
Epoch: 38, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.250 Vali Acc: 0.961 Test Loss: 0.250 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 23.410489797592163
Epoch: 39, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 24.453014850616455
Epoch: 40, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.320 Vali Acc: 0.944 Test Loss: 0.320 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 24.43142294883728
Epoch: 41, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.320 Vali Acc: 0.953 Test Loss: 0.320 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 22.461339235305786
Epoch: 42, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 22.738767385482788
Epoch: 43, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.276 Vali Acc: 0.958 Test Loss: 0.276 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 22.947230339050293
Epoch: 44, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.257 Vali Acc: 0.966 Test Loss: 0.257 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 22.16752552986145
Epoch: 45, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.964 Test Loss: 0.234 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.829503297805786
Epoch: 1, Steps: 89 | Train Loss: 1.855 Vali Loss: 0.850 Vali Acc: 0.756 Test Loss: 0.850 Test Acc: 0.756
Validation loss decreased (inf --> -0.755563).  Saving model ...
Epoch: 2 cost time: 25.317495346069336
Epoch: 2, Steps: 89 | Train Loss: 0.581 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
Validation loss decreased (-0.755563 --> -0.861416).  Saving model ...
Epoch: 3 cost time: 24.034228086471558
Epoch: 3, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.294 Vali Acc: 0.914 Test Loss: 0.294 Test Acc: 0.914
Validation loss decreased (-0.861416 --> -0.913646).  Saving model ...
Epoch: 4 cost time: 23.994915008544922
Epoch: 4, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
Validation loss decreased (-0.913646 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 25.00613307952881
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.935234 --> -0.935235).  Saving model ...
Epoch: 6 cost time: 24.067283153533936
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.935235 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 23.99023413658142
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.9145348072052
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.700834035873413
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.693082571029663
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 22.83104157447815
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.957519).  Saving model ...
Epoch: 12 cost time: 23.139179468154907
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.953 Test Loss: 0.196 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.36948537826538
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 24.023271322250366
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 23.681816577911377
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.226 Vali Acc: 0.945 Test Loss: 0.226 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 23.888026237487793
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 23.13790488243103
Epoch: 17, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.960305).  Saving model ...
Epoch: 18 cost time: 23.187941789627075
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.958 Test Loss: 0.175 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 24.428621530532837
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 23.08462643623352
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961001).  Saving model ...
Epoch: 21 cost time: 23.593716144561768
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.964 Test Loss: 0.192 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.964483).  Saving model ...
Epoch: 22 cost time: 23.377376079559326
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 23 cost time: 23.58581805229187
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 23.224133729934692
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.893211603164673
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.282 Vali Acc: 0.942 Test Loss: 0.282 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 23.298566818237305
Epoch: 26, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.445 Vali Acc: 0.919 Test Loss: 0.445 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 24.03340482711792
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 23.869471311569214
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.257 Vali Acc: 0.955 Test Loss: 0.257 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 24.407350301742554
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 23.79014825820923
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.253 Vali Acc: 0.956 Test Loss: 0.253 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 23.551393508911133
Epoch: 31, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.958 Test Loss: 0.248 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 24.527026653289795
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.959 Test Loss: 0.235 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.377699375152588
Epoch: 1, Steps: 89 | Train Loss: 1.985 Vali Loss: 0.988 Vali Acc: 0.724 Test Loss: 0.988 Test Acc: 0.724
Validation loss decreased (inf --> -0.724224).  Saving model ...
Epoch: 2 cost time: 25.257050037384033
Epoch: 2, Steps: 89 | Train Loss: 0.688 Vali Loss: 0.523 Vali Acc: 0.859 Test Loss: 0.523 Test Acc: 0.859
Validation loss decreased (-0.724224 --> -0.859326).  Saving model ...
Epoch: 3 cost time: 24.872300386428833
Epoch: 3, Steps: 89 | Train Loss: 0.410 Vali Loss: 0.371 Vali Acc: 0.889 Test Loss: 0.371 Test Acc: 0.889
Validation loss decreased (-0.859326 --> -0.889272).  Saving model ...
Epoch: 4 cost time: 22.804033279418945
Epoch: 4, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
Validation loss decreased (-0.889272 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 23.74503469467163
Epoch: 5, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.270 Vali Acc: 0.924 Test Loss: 0.270 Test Acc: 0.924
Validation loss decreased (-0.919217 --> -0.924092).  Saving model ...
Epoch: 6 cost time: 22.484019994735718
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
Validation loss decreased (-0.924092 --> -0.939413).  Saving model ...
Epoch: 7 cost time: 23.10027241706848
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.75973343849182
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.939413 --> -0.944287).  Saving model ...
Epoch: 9 cost time: 22.220997095108032
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.944287 --> -0.946377).  Saving model ...
Epoch: 10 cost time: 21.68348503112793
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.278544902801514
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.277 Vali Acc: 0.929 Test Loss: 0.277 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.455708503723145
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.207 Vali Acc: 0.947 Test Loss: 0.207 Test Acc: 0.947
Validation loss decreased (-0.946377 --> -0.947073).  Saving model ...
Epoch: 13 cost time: 24.16371178627014
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.80838632583618
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.247 Vali Acc: 0.936 Test Loss: 0.247 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.3292818069458
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.58964967727661
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.947073 --> -0.951948).  Saving model ...
Epoch: 17 cost time: 23.590869665145874
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.947 Test Loss: 0.222 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.3996422290802
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.955 Test Loss: 0.217 Test Acc: 0.955
Validation loss decreased (-0.951948 --> -0.954733).  Saving model ...
Epoch: 19 cost time: 22.800448417663574
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.955 Test Loss: 0.219 Test Acc: 0.955
Validation loss decreased (-0.954733 --> -0.955430).  Saving model ...
Epoch: 20 cost time: 22.886985540390015
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.960304).  Saving model ...
Epoch: 21 cost time: 22.396158456802368
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.943 Test Loss: 0.262 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 22.625350952148438
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 23.439347505569458
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.231 Vali Acc: 0.946 Test Loss: 0.231 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 22.173211336135864
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 21.59353756904602
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.281 Vali Acc: 0.949 Test Loss: 0.281 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 22.249290704727173
Epoch: 26, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.472 Vali Acc: 0.911 Test Loss: 0.472 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 22.72560739517212
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.392 Vali Acc: 0.931 Test Loss: 0.392 Test Acc: 0.931
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 22.620590925216675
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 22.426904916763306
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.313 Vali Acc: 0.946 Test Loss: 0.313 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 23.331520557403564
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.939 Test Loss: 0.357 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9603064066852368
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.994190216064453
Epoch: 1, Steps: 89 | Train Loss: 2.337 Vali Loss: 1.321 Vali Acc: 0.682 Test Loss: 1.321 Test Acc: 0.682
Validation loss decreased (inf --> -0.681742).  Saving model ...
Epoch: 2 cost time: 22.429062366485596
Epoch: 2, Steps: 89 | Train Loss: 0.921 Vali Loss: 0.665 Vali Acc: 0.821 Test Loss: 0.665 Test Acc: 0.821
Validation loss decreased (-0.681742 --> -0.821024).  Saving model ...
Epoch: 3 cost time: 23.46601104736328
Epoch: 3, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.440 Vali Acc: 0.875 Test Loss: 0.440 Test Acc: 0.875
Validation loss decreased (-0.821024 --> -0.875344).  Saving model ...
Epoch: 4 cost time: 25.04927945137024
Epoch: 4, Steps: 89 | Train Loss: 0.301 Vali Loss: 0.316 Vali Acc: 0.904 Test Loss: 0.316 Test Acc: 0.904
Validation loss decreased (-0.875344 --> -0.903897).  Saving model ...
Epoch: 5 cost time: 24.24027109146118
Epoch: 5, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.279 Vali Acc: 0.916 Test Loss: 0.279 Test Acc: 0.916
Validation loss decreased (-0.903897 --> -0.916432).  Saving model ...
Epoch: 6 cost time: 25.299230575561523
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.220 Vali Acc: 0.935 Test Loss: 0.220 Test Acc: 0.935
Validation loss decreased (-0.916432 --> -0.934538).  Saving model ...
Epoch: 7 cost time: 24.751877546310425
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.236 Vali Acc: 0.929 Test Loss: 0.236 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.308748960494995
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.26037096977234
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.934538 --> -0.944288).  Saving model ...
Epoch: 10 cost time: 26.292460918426514
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.944288 --> -0.949859).  Saving model ...
Epoch: 11 cost time: 24.19791054725647
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.50658392906189
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.528392553329468
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.949859 --> -0.954037).  Saving model ...
Epoch: 14 cost time: 25.722684383392334
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.825326442718506
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954733).  Saving model ...
Epoch: 16 cost time: 22.870052576065063
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.954733 --> -0.956126).  Saving model ...
Epoch: 17 cost time: 24.20129656791687
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.936 Test Loss: 0.240 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.614354610443115
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 22.872225999832153
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 22.348979234695435
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.353 Vali Acc: 0.928 Test Loss: 0.353 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 25.8135187625885
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
Validation loss decreased (-0.956126 --> -0.958911).  Saving model ...
Epoch: 22 cost time: 24.44118571281433
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 24.488215684890747
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 25.109070301055908
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 24.18726634979248
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.958911 --> -0.958912).  Saving model ...
Epoch: 26 cost time: 23.529378414154053
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.961697).  Saving model ...
Epoch: 27 cost time: 23.86319875717163
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
Validation loss decreased (-0.961697 --> -0.963090).  Saving model ...
Epoch: 28 cost time: 23.22066879272461
Epoch: 28, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 21.84171223640442
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.299 Vali Acc: 0.946 Test Loss: 0.299 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 23.950191497802734
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.226 Vali Acc: 0.953 Test Loss: 0.226 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 22.910354614257812
Epoch: 31, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.307 Vali Acc: 0.940 Test Loss: 0.307 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 23.800764322280884
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 22.723527908325195
Epoch: 33, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 22.679962396621704
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 22.907093286514282
Epoch: 35, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 23.40228796005249
Epoch: 36, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.360 Vali Acc: 0.939 Test Loss: 0.360 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 23.293397426605225
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.58208155632019
Epoch: 1, Steps: 89 | Train Loss: 2.723 Vali Loss: 2.380 Vali Acc: 0.338 Test Loss: 2.380 Test Acc: 0.338
Validation loss decreased (inf --> -0.337720).  Saving model ...
Epoch: 2 cost time: 23.610519409179688
Epoch: 2, Steps: 89 | Train Loss: 1.648 Vali Loss: 1.179 Vali Acc: 0.650 Test Loss: 1.179 Test Acc: 0.650
Validation loss decreased (-0.337720 --> -0.650406).  Saving model ...
Epoch: 3 cost time: 25.227097511291504
Epoch: 3, Steps: 89 | Train Loss: 0.694 Vali Loss: 0.495 Vali Acc: 0.865 Test Loss: 0.495 Test Acc: 0.865
Validation loss decreased (-0.650406 --> -0.864898).  Saving model ...
Epoch: 4 cost time: 24.66783905029297
Epoch: 4, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.311 Vali Acc: 0.912 Test Loss: 0.311 Test Acc: 0.912
Validation loss decreased (-0.864898 --> -0.912253).  Saving model ...
Epoch: 5 cost time: 24.280930519104004
Epoch: 5, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.912253 --> -0.925485).  Saving model ...
Epoch: 6 cost time: 24.443830251693726
Epoch: 6, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
Validation loss decreased (-0.925485 --> -0.949162).  Saving model ...
Epoch: 7 cost time: 25.409816026687622
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.88728976249695
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 25.47082495689392
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (-0.950555 --> -0.954037).  Saving model ...
Epoch: 10 cost time: 26.041956186294556
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.954037 --> -0.956823).  Saving model ...
Epoch: 11 cost time: 24.55381488800049
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.493093252182007
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.956823 --> -0.956823).  Saving model ...
Epoch: 13 cost time: 26.432417631149292
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.438538074493408
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 25.2886962890625
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 25.710094928741455
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 25.054630756378174
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.177 Vali Acc: 0.961 Test Loss: 0.177 Test Acc: 0.961
Validation loss decreased (-0.956823 --> -0.961001).  Saving model ...
Epoch: 18 cost time: 25.939629554748535
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.219 Vali Acc: 0.945 Test Loss: 0.219 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 26.059978008270264
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.964483).  Saving model ...
Epoch: 20 cost time: 25.58725643157959
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 25.786192655563354
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 24.31351065635681
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 25.175392627716064
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.244 Vali Acc: 0.953 Test Loss: 0.244 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 23.803192615509033
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 23.406392097473145
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 25.48768138885498
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 24.600510358810425
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.50910186767578
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.188 Vali Acc: 0.961 Test Loss: 0.188 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 23.920330047607422
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9644846796657381
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.45430064201355
Epoch: 1, Steps: 89 | Train Loss: 2.754 Vali Loss: 2.606 Vali Acc: 0.251 Test Loss: 2.606 Test Acc: 0.251
Validation loss decreased (inf --> -0.251367).  Saving model ...
Epoch: 2 cost time: 22.406133890151978
Epoch: 2, Steps: 89 | Train Loss: 1.713 Vali Loss: 1.425 Vali Acc: 0.556 Test Loss: 1.425 Test Acc: 0.556
Validation loss decreased (-0.251367 --> -0.555696).  Saving model ...
Epoch: 3 cost time: 25.037121534347534
Epoch: 3, Steps: 89 | Train Loss: 0.786 Vali Loss: 0.708 Vali Acc: 0.798 Test Loss: 0.708 Test Acc: 0.798
Validation loss decreased (-0.555696 --> -0.798043).  Saving model ...
Epoch: 4 cost time: 24.479862689971924
Epoch: 4, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.549 Vali Acc: 0.834 Test Loss: 0.549 Test Acc: 0.834
Validation loss decreased (-0.798043 --> -0.834256).  Saving model ...
Epoch: 5 cost time: 23.63737988471985
Epoch: 5, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.424 Vali Acc: 0.858 Test Loss: 0.424 Test Acc: 0.858
Validation loss decreased (-0.834256 --> -0.857934).  Saving model ...
Epoch: 6 cost time: 24.181780576705933
Epoch: 6, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.270 Vali Acc: 0.929 Test Loss: 0.270 Test Acc: 0.929
Validation loss decreased (-0.857934 --> -0.928967).  Saving model ...
Epoch: 7 cost time: 23.79547429084778
Epoch: 7, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.216 Vali Acc: 0.938 Test Loss: 0.216 Test Acc: 0.938
Validation loss decreased (-0.928967 --> -0.938020).  Saving model ...
Epoch: 8 cost time: 23.791528940200806
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.938020 --> -0.940806).  Saving model ...
Epoch: 9 cost time: 22.325258255004883
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.0705246925354
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.211 Vali Acc: 0.935 Test Loss: 0.211 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.49616241455078
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.940806 --> -0.948466).  Saving model ...
Epoch: 12 cost time: 23.78981924057007
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 23.529308557510376
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.948466 --> -0.950555).  Saving model ...
Epoch: 14 cost time: 23.752359628677368
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.958215).  Saving model ...
Epoch: 15 cost time: 23.505700826644897
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 23.074922800064087
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
Validation loss decreased (-0.958215 --> -0.960305).  Saving model ...
Epoch: 17 cost time: 22.68106746673584
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.564449548721313
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961001).  Saving model ...
Epoch: 19 cost time: 24.046947240829468
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 24.129803895950317
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 24.955744981765747
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.953 Test Loss: 0.196 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 24.083346366882324
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.947 Test Loss: 0.232 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.55726981163025
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
Validation loss decreased (-0.961001 --> -0.963090).  Saving model ...
Epoch: 24 cost time: 25.043877124786377
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 24.445770502090454
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 24.073964834213257
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 24.783278226852417
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 25.787832021713257
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 24.994390726089478
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 24.442047119140625
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.951 Test Loss: 0.240 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 23.231764793395996
Epoch: 31, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.960 Test Loss: 0.211 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 24.934690475463867
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 24.76345658302307
Epoch: 33, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.60827326774597
Epoch: 1, Steps: 89 | Train Loss: 2.766 Vali Loss: 2.704 Vali Acc: 0.206 Test Loss: 2.704 Test Acc: 0.206
Validation loss decreased (inf --> -0.206101).  Saving model ...
Epoch: 2 cost time: 24.03011465072632
Epoch: 2, Steps: 89 | Train Loss: 1.777 Vali Loss: 1.565 Vali Acc: 0.527 Test Loss: 1.565 Test Acc: 0.527
Validation loss decreased (-0.206101 --> -0.527143).  Saving model ...
Epoch: 3 cost time: 24.011438131332397
Epoch: 3, Steps: 89 | Train Loss: 0.869 Vali Loss: 0.905 Vali Acc: 0.718 Test Loss: 0.905 Test Acc: 0.718
Validation loss decreased (-0.527143 --> -0.717958).  Saving model ...
Epoch: 4 cost time: 23.0755033493042
Epoch: 4, Steps: 89 | Train Loss: 0.486 Vali Loss: 0.662 Vali Acc: 0.804 Test Loss: 0.662 Test Acc: 0.804
Validation loss decreased (-0.717958 --> -0.804311).  Saving model ...
Epoch: 5 cost time: 24.060307025909424
Epoch: 5, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.539 Vali Acc: 0.839 Test Loss: 0.539 Test Acc: 0.839
Validation loss decreased (-0.804311 --> -0.839131).  Saving model ...
Epoch: 6 cost time: 23.081124544143677
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.361 Vali Acc: 0.903 Test Loss: 0.361 Test Acc: 0.903
Validation loss decreased (-0.839131 --> -0.902503).  Saving model ...
Epoch: 7 cost time: 23.802794933319092
Epoch: 7, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.345 Vali Acc: 0.902 Test Loss: 0.345 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.87728261947632
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.316 Vali Acc: 0.905 Test Loss: 0.316 Test Acc: 0.905
Validation loss decreased (-0.902503 --> -0.904593).  Saving model ...
Epoch: 9 cost time: 25.35533571243286
Epoch: 9, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.330 Vali Acc: 0.915 Test Loss: 0.330 Test Acc: 0.915
Validation loss decreased (-0.904593 --> -0.915038).  Saving model ...
Epoch: 10 cost time: 24.36762261390686
Epoch: 10, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.278 Vali Acc: 0.923 Test Loss: 0.278 Test Acc: 0.923
Validation loss decreased (-0.915038 --> -0.923396).  Saving model ...
Epoch: 11 cost time: 24.217501640319824
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.923396 --> -0.942895).  Saving model ...
Epoch: 12 cost time: 24.250648260116577
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.294 Vali Acc: 0.921 Test Loss: 0.294 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 26.45148015022278
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.247 Vali Acc: 0.942 Test Loss: 0.247 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 23.94180130958557
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.258 Vali Acc: 0.935 Test Loss: 0.258 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 24.24551749229431
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 25.126981019973755
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
Validation loss decreased (-0.942895 --> -0.948466).  Saving model ...
Epoch: 17 cost time: 24.623456478118896
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.910080194473267
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 24.66194748878479
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
Validation loss decreased (-0.948466 --> -0.951948).  Saving model ...
Epoch: 20 cost time: 24.575502395629883
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 25.001050233840942
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.940 Test Loss: 0.251 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 25.40498924255371
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.258 Vali Acc: 0.942 Test Loss: 0.258 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 26.087392330169678
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.753366470336914
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.242 Vali Acc: 0.949 Test Loss: 0.242 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 25.055946350097656
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.339 Vali Acc: 0.933 Test Loss: 0.339 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 25.069401264190674
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 23.70142126083374
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.338 Vali Acc: 0.938 Test Loss: 0.338 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 24.35057783126831
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 24.233182907104492
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.296 Vali Acc: 0.942 Test Loss: 0.296 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.67444348335266
Epoch: 1, Steps: 89 | Train Loss: 2.779 Vali Loss: 2.675 Vali Acc: 0.270 Test Loss: 2.675 Test Acc: 0.270
Validation loss decreased (inf --> -0.270168).  Saving model ...
Epoch: 2 cost time: 22.42532706260681
Epoch: 2, Steps: 89 | Train Loss: 1.872 Vali Loss: 1.725 Vali Acc: 0.438 Test Loss: 1.725 Test Acc: 0.438
Validation loss decreased (-0.270168 --> -0.438005).  Saving model ...
Epoch: 3 cost time: 22.520517110824585
Epoch: 3, Steps: 89 | Train Loss: 0.953 Vali Loss: 1.184 Vali Acc: 0.648 Test Loss: 1.184 Test Acc: 0.648
Validation loss decreased (-0.438005 --> -0.647620).  Saving model ...
Epoch: 4 cost time: 22.414315700531006
Epoch: 4, Steps: 89 | Train Loss: 0.543 Vali Loss: 0.857 Vali Acc: 0.728 Test Loss: 0.857 Test Acc: 0.728
Validation loss decreased (-0.647620 --> -0.728404).  Saving model ...
Epoch: 5 cost time: 22.443421840667725
Epoch: 5, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.686 Vali Acc: 0.797 Test Loss: 0.686 Test Acc: 0.797
Validation loss decreased (-0.728404 --> -0.796651).  Saving model ...
Epoch: 6 cost time: 22.894516468048096
Epoch: 6, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.499 Vali Acc: 0.871 Test Loss: 0.499 Test Acc: 0.871
Validation loss decreased (-0.796651 --> -0.871165).  Saving model ...
Epoch: 7 cost time: 22.089604377746582
Epoch: 7, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.400 Vali Acc: 0.892 Test Loss: 0.400 Test Acc: 0.892
Validation loss decreased (-0.871165 --> -0.892057).  Saving model ...
Epoch: 8 cost time: 23.745009660720825
Epoch: 8, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.399 Vali Acc: 0.886 Test Loss: 0.399 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.823293447494507
Epoch: 9, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.251440286636353
Epoch: 10, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.359 Vali Acc: 0.898 Test Loss: 0.359 Test Acc: 0.898
Validation loss decreased (-0.892057 --> -0.898325).  Saving model ...
Epoch: 11 cost time: 23.039197206497192
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.311 Vali Acc: 0.923 Test Loss: 0.311 Test Acc: 0.923
Validation loss decreased (-0.898325 --> -0.923395).  Saving model ...
Epoch: 12 cost time: 22.9698748588562
Epoch: 12, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.324 Vali Acc: 0.916 Test Loss: 0.324 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.973254919052124
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.433204889297485
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 22.536979913711548
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
Validation loss decreased (-0.923395 --> -0.936626).  Saving model ...
Epoch: 16 cost time: 24.34469723701477
Epoch: 16, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.313 Vali Acc: 0.935 Test Loss: 0.313 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 23.470051050186157
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.281 Vali Acc: 0.936 Test Loss: 0.281 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.1968035697937
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.936626 --> -0.943590).  Saving model ...
Epoch: 19 cost time: 22.49839687347412
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.292 Vali Acc: 0.939 Test Loss: 0.292 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.168480396270752
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.6702880859375
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.294 Vali Acc: 0.946 Test Loss: 0.294 Test Acc: 0.946
Validation loss decreased (-0.943590 --> -0.945680).  Saving model ...
Epoch: 22 cost time: 22.008280515670776
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.293 Vali Acc: 0.951 Test Loss: 0.293 Test Acc: 0.951
Validation loss decreased (-0.945680 --> -0.950554).  Saving model ...
Epoch: 23 cost time: 23.49184536933899
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 22.69495701789856
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.325 Vali Acc: 0.940 Test Loss: 0.325 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.261070728302002
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.291 Vali Acc: 0.948 Test Loss: 0.291 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.05387234687805
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 22.708159685134888
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.285 Vali Acc: 0.949 Test Loss: 0.285 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 22.57267165184021
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 21.792794466018677
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.948 Test Loss: 0.291 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 24.071978092193604
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.334 Vali Acc: 0.949 Test Loss: 0.334 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 22.8757381439209
Epoch: 31, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.314 Vali Acc: 0.943 Test Loss: 0.314 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 22.786944150924683
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.322 Vali Acc: 0.946 Test Loss: 0.322 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9505571030640668
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.426688194274902
Epoch: 1, Steps: 89 | Train Loss: 2.826 Vali Loss: 2.654 Vali Acc: 0.215 Test Loss: 2.654 Test Acc: 0.215
Validation loss decreased (inf --> -0.215155).  Saving model ...
Epoch: 2 cost time: 24.278363704681396
Epoch: 2, Steps: 89 | Train Loss: 1.966 Vali Loss: 1.756 Vali Acc: 0.443 Test Loss: 1.756 Test Acc: 0.443
Validation loss decreased (-0.215155 --> -0.442879).  Saving model ...
Epoch: 3 cost time: 23.664509296417236
Epoch: 3, Steps: 89 | Train Loss: 1.077 Vali Loss: 1.387 Vali Acc: 0.584 Test Loss: 1.387 Test Acc: 0.584
Validation loss decreased (-0.442879 --> -0.584248).  Saving model ...
Epoch: 4 cost time: 23.867048978805542
Epoch: 4, Steps: 89 | Train Loss: 0.639 Vali Loss: 1.107 Vali Acc: 0.656 Test Loss: 1.107 Test Acc: 0.656
Validation loss decreased (-0.584248 --> -0.655978).  Saving model ...
Epoch: 5 cost time: 23.689833402633667
Epoch: 5, Steps: 89 | Train Loss: 0.458 Vali Loss: 0.957 Vali Acc: 0.694 Test Loss: 0.957 Test Acc: 0.694
Validation loss decreased (-0.655978 --> -0.693584).  Saving model ...
Epoch: 6 cost time: 23.39609122276306
Epoch: 6, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
Validation loss decreased (-0.693584 --> -0.770188).  Saving model ...
Epoch: 7 cost time: 23.009325742721558
Epoch: 7, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.556 Vali Acc: 0.835 Test Loss: 0.556 Test Acc: 0.835
Validation loss decreased (-0.770188 --> -0.834953).  Saving model ...
Epoch: 8 cost time: 23.43208956718445
Epoch: 8, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.622 Vali Acc: 0.812 Test Loss: 0.622 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.44325590133667
Epoch: 9, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.630 Vali Acc: 0.802 Test Loss: 0.630 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.45408797264099
Epoch: 10, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.490 Vali Acc: 0.867 Test Loss: 0.490 Test Acc: 0.867
Validation loss decreased (-0.834953 --> -0.866987).  Saving model ...
Epoch: 11 cost time: 23.261063814163208
Epoch: 11, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.375 Vali Acc: 0.898 Test Loss: 0.375 Test Acc: 0.898
Validation loss decreased (-0.866987 --> -0.897629).  Saving model ...
Epoch: 12 cost time: 23.323812246322632
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.336 Vali Acc: 0.912 Test Loss: 0.336 Test Acc: 0.912
Validation loss decreased (-0.897629 --> -0.912253).  Saving model ...
Epoch: 13 cost time: 22.532838582992554
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.350 Vali Acc: 0.913 Test Loss: 0.350 Test Acc: 0.913
Validation loss decreased (-0.912253 --> -0.912949).  Saving model ...
Epoch: 14 cost time: 22.993990421295166
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.926008701324463
Epoch: 15, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.350 Vali Acc: 0.909 Test Loss: 0.350 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 23.336660623550415
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.322 Vali Acc: 0.912 Test Loss: 0.322 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 23.595237970352173
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
Validation loss decreased (-0.912949 --> -0.929663).  Saving model ...
Epoch: 18 cost time: 23.130119562149048
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.281 Vali Acc: 0.935 Test Loss: 0.281 Test Acc: 0.935
Validation loss decreased (-0.929663 --> -0.934538).  Saving model ...
Epoch: 19 cost time: 24.493796825408936
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.286 Vali Acc: 0.927 Test Loss: 0.286 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 26.137710332870483
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.263 Vali Acc: 0.939 Test Loss: 0.263 Test Acc: 0.939
Validation loss decreased (-0.934538 --> -0.938716).  Saving model ...
Epoch: 21 cost time: 27.787042379379272
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
Validation loss decreased (-0.938716 --> -0.940805).  Saving model ...
Epoch: 22 cost time: 23.388447284698486
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.294 Vali Acc: 0.936 Test Loss: 0.294 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 22.429542779922485
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.280 Vali Acc: 0.939 Test Loss: 0.280 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 23.51175856590271
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 23.759767293930054
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.296 Vali Acc: 0.936 Test Loss: 0.296 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 22.945521593093872
Epoch: 26, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.268 Vali Acc: 0.952 Test Loss: 0.268 Test Acc: 0.952
Validation loss decreased (-0.940805 --> -0.951947).  Saving model ...
Epoch: 27 cost time: 23.23807454109192
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.277 Vali Acc: 0.947 Test Loss: 0.277 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 22.134525299072266
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
Validation loss decreased (-0.951947 --> -0.956126).  Saving model ...
Epoch: 29 cost time: 23.525442838668823
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 23.202006578445435
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.257 Vali Acc: 0.955 Test Loss: 0.257 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 23.106558322906494
Epoch: 31, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.264 Vali Acc: 0.951 Test Loss: 0.264 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 24.395121574401855
Epoch: 32, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 23.538329601287842
Epoch: 33, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 24.136080026626587
Epoch: 34, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.314 Vali Acc: 0.935 Test Loss: 0.314 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 23.98918628692627
Epoch: 35, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.345 Vali Acc: 0.946 Test Loss: 0.345 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 23.539883852005005
Epoch: 36, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.326 Vali Acc: 0.945 Test Loss: 0.326 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 24.308029651641846
Epoch: 37, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.445 Vali Acc: 0.923 Test Loss: 0.445 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 23.412275791168213
Epoch: 38, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.293 Vali Acc: 0.947 Test Loss: 0.293 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9561281337047354
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.67169713973999
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.048 Test Loss: 2.996 Test Acc: 0.048
Validation loss decreased (inf --> -0.048020).  Saving model ...
Epoch: 2 cost time: 22.699118614196777
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.048020 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 23.377965927124023
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 22.1640522480011
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 22.14742350578308
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 22.669357776641846
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 24.10197687149048
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 22.40012788772583
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 22.60837435722351
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 22.56015968322754
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 22.505431413650513
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 21.63054323196411
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 22.5466206073761
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 24.670704126358032
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 24.51771306991577
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 24.287452220916748
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 26.089019298553467
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 25.6622371673584
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 22.84165930747986
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 22.988946437835693
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 23.216245651245117
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 23.950414419174194
Epoch: 22, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 22.78872299194336
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 22.884121894836426
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 22.973374128341675
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 22.258939504623413
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 24.901495933532715
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 23.82357358932495
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 22.354050159454346
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 23.45816731452942
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 22.71902084350586
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 22.28350830078125
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 22.27521562576294
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 22.56183385848999
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 22.735068559646606
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 21.51809000968933
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 21.066312313079834
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 21.017128467559814
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.080458402633667
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 21.377976655960083
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 21.9472873210907
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 22.53119421005249
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 21.439595699310303
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 21.496816158294678
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 22.19312810897827
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 21.257760286331177
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 22.650617599487305
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 22.571521520614624
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 23.489264011383057
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 23.09799337387085
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 22.930184364318848
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 22.678706645965576
Epoch: 52, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 22.556721687316895
Epoch: 53, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 22.41919231414795
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 21.562536239624023
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 22.177643537521362
Epoch: 56, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 20.881396293640137
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 21.473164319992065
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 59 cost time: 21.259181261062622
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 22.26873207092285
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 21.114338636398315
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 21.546151638031006
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 22.590198040008545
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 21.366263389587402
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 21.02059578895569
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 21.220442295074463
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 21.881826877593994
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 68 cost time: 22.940065622329712
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 21.32826519012451
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 22.089192152023315
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 22.838520288467407
Epoch: 71, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 22.115844249725342
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 22.024409294128418
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 22.333271503448486
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 21.254738330841064
Epoch: 75, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 21.810590744018555
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 21.32824158668518
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 355924
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.201096057891846
Epoch: 1, Steps: 89 | Train Loss: 1.858 Vali Loss: 0.757 Vali Acc: 0.813 Test Loss: 0.757 Test Acc: 0.813
Validation loss decreased (inf --> -0.812667).  Saving model ...
Epoch: 2 cost time: 20.866710901260376
Epoch: 2, Steps: 89 | Train Loss: 0.508 Vali Loss: 0.357 Vali Acc: 0.895 Test Loss: 0.357 Test Acc: 0.895
Validation loss decreased (-0.812667 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 21.51100444793701
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.301 Vali Acc: 0.910 Test Loss: 0.301 Test Acc: 0.910
Validation loss decreased (-0.894843 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 21.27536153793335
Epoch: 4, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
Validation loss decreased (-0.910164 --> -0.949162).  Saving model ...
Epoch: 5 cost time: 22.38864040374756
Epoch: 5, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.164 Vali Acc: 0.958 Test Loss: 0.164 Test Acc: 0.958
Validation loss decreased (-0.949162 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 21.021822690963745
Epoch: 6, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.958216 --> -0.958216).  Saving model ...
Epoch: 7 cost time: 24.840609550476074
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.806602478027344
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 23.16447353363037
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.742017030715942
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.813220739364624
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.222090244293213
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.964483).  Saving model ...
Epoch: 13 cost time: 24.249557495117188
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.413171768188477
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.964483 --> -0.964483).  Saving model ...
Epoch: 15 cost time: 23.394591569900513
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 16 cost time: 22.47400426864624
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.80974316596985
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.317566871643066
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.319462776184082
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968661).  Saving model ...
Epoch: 20 cost time: 23.206350088119507
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.940 Test Loss: 0.233 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 22.745204210281372
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.162582397460938
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 23.81087064743042
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.266 Vali Acc: 0.952 Test Loss: 0.266 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.041758060455322
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 22.829228162765503
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.273 Vali Acc: 0.946 Test Loss: 0.273 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 23.131083965301514
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 23.35036873817444
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.896930932998657
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 22.71716022491455
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.970751).  Saving model ...
Epoch: 30 cost time: 23.013585090637207
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 22.74663019180298
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 22.95433735847473
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 33 cost time: 22.599207162857056
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 34 cost time: 22.2774019241333
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972143).  Saving model ...
Epoch: 35 cost time: 21.584269523620605
Epoch: 35, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 22.197696924209595
Epoch: 36, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.337 Vali Acc: 0.942 Test Loss: 0.337 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 21.655389070510864
Epoch: 37, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.385 Vali Acc: 0.932 Test Loss: 0.385 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 21.336320877075195
Epoch: 38, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.368 Vali Acc: 0.939 Test Loss: 0.368 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 21.804703950881958
Epoch: 39, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.290 Vali Acc: 0.949 Test Loss: 0.290 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 21.967381954193115
Epoch: 40, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 21.991681337356567
Epoch: 41, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.291 Vali Acc: 0.949 Test Loss: 0.291 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 21.87835454940796
Epoch: 42, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.335 Vali Acc: 0.952 Test Loss: 0.335 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 22.78749942779541
Epoch: 43, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 23.587252616882324
Epoch: 44, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.253 Vali Acc: 0.963 Test Loss: 0.253 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.486286640167236
Epoch: 1, Steps: 89 | Train Loss: 1.916 Vali Loss: 0.877 Vali Acc: 0.771 Test Loss: 0.877 Test Acc: 0.771
Validation loss decreased (inf --> -0.770883).  Saving model ...
Epoch: 2 cost time: 24.326258420944214
Epoch: 2, Steps: 89 | Train Loss: 0.614 Vali Loss: 0.457 Vali Acc: 0.868 Test Loss: 0.457 Test Acc: 0.868
Validation loss decreased (-0.770883 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 25.299214601516724
Epoch: 3, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.329 Vali Acc: 0.910 Test Loss: 0.329 Test Acc: 0.910
Validation loss decreased (-0.868380 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 25.154664993286133
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.910164 --> -0.930360).  Saving model ...
Epoch: 5 cost time: 24.98503541946411
Epoch: 5, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.930360 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 24.240606546401978
Epoch: 6, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.198 Vali Acc: 0.945 Test Loss: 0.198 Test Acc: 0.945
Validation loss decreased (-0.943591 --> -0.944984).  Saving model ...
Epoch: 7 cost time: 24.017091751098633
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.944984 --> -0.951948).  Saving model ...
Epoch: 8 cost time: 24.63836979866028
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.955 Test Loss: 0.141 Test Acc: 0.955
Validation loss decreased (-0.951948 --> -0.954734).  Saving model ...
Epoch: 9 cost time: 24.89864206314087
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.954734 --> -0.959609).  Saving model ...
Epoch: 10 cost time: 25.21273159980774
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.253361701965332
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 23.357993364334106
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.959609 --> -0.961698).  Saving model ...
Epoch: 13 cost time: 24.60892915725708
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.199621438980103
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.723520278930664
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.898512363433838
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.28237223625183
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 22.58837890625
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 23.114173412322998
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 23.56124472618103
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 23.10964059829712
Epoch: 21, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 22.842042446136475
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9616991643454039
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.22766947746277
Epoch: 1, Steps: 89 | Train Loss: 2.038 Vali Loss: 1.014 Vali Acc: 0.746 Test Loss: 1.014 Test Acc: 0.746
Validation loss decreased (inf --> -0.745812).  Saving model ...
Epoch: 2 cost time: 22.481688976287842
Epoch: 2, Steps: 89 | Train Loss: 0.721 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
Validation loss decreased (-0.745812 --> -0.844006).  Saving model ...
Epoch: 3 cost time: 23.042123556137085
Epoch: 3, Steps: 89 | Train Loss: 0.393 Vali Loss: 0.391 Vali Acc: 0.890 Test Loss: 0.391 Test Acc: 0.890
Validation loss decreased (-0.844006 --> -0.889968).  Saving model ...
Epoch: 4 cost time: 22.833804607391357
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
Validation loss decreased (-0.889968 --> -0.915039).  Saving model ...
Epoch: 5 cost time: 22.500351905822754
Epoch: 5, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
Validation loss decreased (-0.915039 --> -0.932449).  Saving model ...
Epoch: 6 cost time: 22.063203811645508
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.258 Vali Acc: 0.921 Test Loss: 0.258 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.311976671218872
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.932449 --> -0.935235).  Saving model ...
Epoch: 8 cost time: 22.002896308898926
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.935235 --> -0.940806).  Saving model ...
Epoch: 9 cost time: 22.59764575958252
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.843443870544434
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.336867570877075
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.942 Test Loss: 0.198 Test Acc: 0.942
Validation loss decreased (-0.940806 --> -0.942199).  Saving model ...
Epoch: 12 cost time: 22.116793870925903
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
Validation loss decreased (-0.942199 --> -0.950555).  Saving model ...
Epoch: 13 cost time: 22.124213218688965
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.88724684715271
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.196 Vali Acc: 0.953 Test Loss: 0.196 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.952644).  Saving model ...
Epoch: 15 cost time: 22.115896463394165
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.201 Vali Acc: 0.955 Test Loss: 0.201 Test Acc: 0.955
Validation loss decreased (-0.952644 --> -0.955430).  Saving model ...
Epoch: 16 cost time: 21.51608967781067
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.461081504821777
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.69323205947876
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.959608).  Saving model ...
Epoch: 19 cost time: 22.687849044799805
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 22.817934036254883
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.398696660995483
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 22.524719953536987
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.274 Vali Acc: 0.947 Test Loss: 0.274 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 22.596646547317505
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 22.692964792251587
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.951 Test Loss: 0.245 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 23.04477858543396
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.946 Test Loss: 0.279 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 23.717907667160034
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.301 Vali Acc: 0.949 Test Loss: 0.301 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 24.440940856933594
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.259 Vali Acc: 0.951 Test Loss: 0.259 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 22.622599601745605
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9596100278551533
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.513843059539795
Epoch: 1, Steps: 89 | Train Loss: 2.363 Vali Loss: 1.386 Vali Acc: 0.689 Test Loss: 1.386 Test Acc: 0.689
Validation loss decreased (inf --> -0.689401).  Saving model ...
Epoch: 2 cost time: 24.810195922851562
Epoch: 2, Steps: 89 | Train Loss: 0.965 Vali Loss: 0.687 Vali Acc: 0.811 Test Loss: 0.687 Test Acc: 0.811
Validation loss decreased (-0.689401 --> -0.811274).  Saving model ...
Epoch: 3 cost time: 23.488630056381226
Epoch: 3, Steps: 89 | Train Loss: 0.497 Vali Loss: 0.461 Vali Acc: 0.876 Test Loss: 0.461 Test Acc: 0.876
Validation loss decreased (-0.811274 --> -0.876040).  Saving model ...
Epoch: 4 cost time: 24.080838918685913
Epoch: 4, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.876040 --> -0.900414).  Saving model ...
Epoch: 5 cost time: 24.883379459381104
Epoch: 5, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.259 Vali Acc: 0.932 Test Loss: 0.259 Test Acc: 0.932
Validation loss decreased (-0.900414 --> -0.932449).  Saving model ...
Epoch: 6 cost time: 24.72298765182495
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.285 Vali Acc: 0.918 Test Loss: 0.285 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.531709671020508
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.932449 --> -0.936627).  Saving model ...
Epoch: 8 cost time: 23.4169762134552
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.215 Vali Acc: 0.936 Test Loss: 0.215 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.37544012069702
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.207 Vali Acc: 0.947 Test Loss: 0.207 Test Acc: 0.947
Validation loss decreased (-0.936627 --> -0.947073).  Saving model ...
Epoch: 10 cost time: 24.72102975845337
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.202 Vali Acc: 0.946 Test Loss: 0.202 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.855443954467773
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.019911766052246
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.599400281906128
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.947073 --> -0.949859).  Saving model ...
Epoch: 14 cost time: 23.666913270950317
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.953341).  Saving model ...
Epoch: 15 cost time: 23.945961952209473
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.616707801818848
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 22.274410247802734
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.949 Test Loss: 0.206 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 22.41206645965576
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.207 Vali Acc: 0.947 Test Loss: 0.207 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 22.683539628982544
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 22.26948857307434
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.225 Vali Acc: 0.946 Test Loss: 0.225 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 21.824049711227417
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.946 Test Loss: 0.252 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 22.601529598236084
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.263 Vali Acc: 0.943 Test Loss: 0.263 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 22.499648809432983
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.293 Vali Acc: 0.945 Test Loss: 0.293 Test Acc: 0.945
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 21.860135793685913
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.284 Vali Acc: 0.942 Test Loss: 0.284 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9533426183844012
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.008684158325195
Epoch: 1, Steps: 89 | Train Loss: 2.731 Vali Loss: 2.401 Vali Acc: 0.312 Test Loss: 2.401 Test Acc: 0.312
Validation loss decreased (inf --> -0.311954).  Saving model ...
Epoch: 2 cost time: 24.159756422042847
Epoch: 2, Steps: 89 | Train Loss: 1.698 Vali Loss: 1.256 Vali Acc: 0.635 Test Loss: 1.256 Test Acc: 0.635
Validation loss decreased (-0.311954 --> -0.635085).  Saving model ...
Epoch: 3 cost time: 22.666600227355957
Epoch: 3, Steps: 89 | Train Loss: 0.699 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
Validation loss decreased (-0.635085 --> -0.837738).  Saving model ...
Epoch: 4 cost time: 23.2842378616333
Epoch: 4, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.299 Vali Acc: 0.918 Test Loss: 0.299 Test Acc: 0.918
Validation loss decreased (-0.837738 --> -0.917824).  Saving model ...
Epoch: 5 cost time: 24.432576179504395
Epoch: 5, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (-0.917824 --> -0.935234).  Saving model ...
Epoch: 6 cost time: 23.502180576324463
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.216 Vali Acc: 0.936 Test Loss: 0.216 Test Acc: 0.936
Validation loss decreased (-0.935234 --> -0.935931).  Saving model ...
Epoch: 7 cost time: 23.861499309539795
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
Validation loss decreased (-0.935931 --> -0.941502).  Saving model ...
Epoch: 8 cost time: 24.438198804855347
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.941502 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 23.441014051437378
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.021457195281982
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.806228160858154
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.55293321609497
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.128610610961914
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.962394 --> -0.965180).  Saving model ...
Epoch: 14 cost time: 23.20214080810547
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.09626054763794
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.803255319595337
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 22.93689203262329
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.965180 --> -0.965180).  Saving model ...
Epoch: 18 cost time: 23.697383403778076
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 22.481645584106445
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 20 cost time: 22.54038405418396
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 22.60564351081848
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 22.979413270950317
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 22.707367420196533
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 22.677261352539062
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 22.415087938308716
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 23.3392231464386
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 22.621439695358276
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 22.98324227333069
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.321 Vali Acc: 0.942 Test Loss: 0.321 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 23.88342046737671
Epoch: 29, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.216355562210083
Epoch: 1, Steps: 89 | Train Loss: 2.756 Vali Loss: 2.652 Vali Acc: 0.210 Test Loss: 2.652 Test Acc: 0.210
Validation loss decreased (inf --> -0.209584).  Saving model ...
Epoch: 2 cost time: 22.851402521133423
Epoch: 2, Steps: 89 | Train Loss: 1.769 Vali Loss: 1.593 Vali Acc: 0.483 Test Loss: 1.593 Test Acc: 0.483
Validation loss decreased (-0.209584 --> -0.483271).  Saving model ...
Epoch: 3 cost time: 23.229279041290283
Epoch: 3, Steps: 89 | Train Loss: 0.795 Vali Loss: 0.818 Vali Acc: 0.746 Test Loss: 0.818 Test Acc: 0.746
Validation loss decreased (-0.483271 --> -0.745814).  Saving model ...
Epoch: 4 cost time: 23.346110582351685
Epoch: 4, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.528 Vali Acc: 0.859 Test Loss: 0.528 Test Acc: 0.859
Validation loss decreased (-0.745814 --> -0.858630).  Saving model ...
Epoch: 5 cost time: 22.944556951522827
Epoch: 5, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.450 Vali Acc: 0.863 Test Loss: 0.450 Test Acc: 0.863
Validation loss decreased (-0.858630 --> -0.862809).  Saving model ...
Epoch: 6 cost time: 23.32376480102539
Epoch: 6, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.397 Vali Acc: 0.882 Test Loss: 0.397 Test Acc: 0.882
Validation loss decreased (-0.862809 --> -0.882308).  Saving model ...
Epoch: 7 cost time: 23.868549585342407
Epoch: 7, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
Validation loss decreased (-0.882308 --> -0.933145).  Saving model ...
Epoch: 8 cost time: 24.30493998527527
Epoch: 8, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.216 Vali Acc: 0.936 Test Loss: 0.216 Test Acc: 0.936
Validation loss decreased (-0.933145 --> -0.935931).  Saving model ...
Epoch: 9 cost time: 23.7245032787323
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.935931 --> -0.943591).  Saving model ...
Epoch: 10 cost time: 23.634852409362793
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.943591 --> -0.947770).  Saving model ...
Epoch: 11 cost time: 24.596474170684814
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.940 Test Loss: 0.208 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.937781810760498
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
Validation loss decreased (-0.947770 --> -0.960305).  Saving model ...
Epoch: 13 cost time: 24.465797424316406
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.239434719085693
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.99386954307556
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961001).  Saving model ...
Epoch: 16 cost time: 24.70462727546692
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 17 cost time: 25.44176983833313
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 25.060775995254517
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 25.037840843200684
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.962394 --> -0.963090).  Saving model ...
Epoch: 20 cost time: 24.93925428390503
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.165260076522827
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.855766534805298
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 23.30310344696045
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.65209436416626
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 24.96979022026062
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 25.881012439727783
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 25.397629261016846
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.953 Test Loss: 0.231 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 25.072685718536377
Epoch: 28, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 25.202099561691284
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.048235654830933
Epoch: 1, Steps: 89 | Train Loss: 2.761 Vali Loss: 2.747 Vali Acc: 0.185 Test Loss: 2.747 Test Acc: 0.185
Validation loss decreased (inf --> -0.184513).  Saving model ...
Epoch: 2 cost time: 25.55377507209778
Epoch: 2, Steps: 89 | Train Loss: 1.777 Vali Loss: 1.608 Vali Acc: 0.530 Test Loss: 1.608 Test Acc: 0.530
Validation loss decreased (-0.184513 --> -0.529928).  Saving model ...
Epoch: 3 cost time: 23.856863021850586
Epoch: 3, Steps: 89 | Train Loss: 0.843 Vali Loss: 0.961 Vali Acc: 0.682 Test Loss: 0.961 Test Acc: 0.682
Validation loss decreased (-0.529928 --> -0.682442).  Saving model ...
Epoch: 4 cost time: 25.09615159034729
Epoch: 4, Steps: 89 | Train Loss: 0.481 Vali Loss: 0.645 Vali Acc: 0.808 Test Loss: 0.645 Test Acc: 0.808
Validation loss decreased (-0.682442 --> -0.808489).  Saving model ...
Epoch: 5 cost time: 24.928239583969116
Epoch: 5, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.528 Vali Acc: 0.827 Test Loss: 0.528 Test Acc: 0.827
Validation loss decreased (-0.808489 --> -0.826596).  Saving model ...
Epoch: 6 cost time: 25.47109603881836
Epoch: 6, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
Validation loss decreased (-0.826596 --> -0.884397).  Saving model ...
Epoch: 7 cost time: 25.718705654144287
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.884397 --> -0.925484).  Saving model ...
Epoch: 8 cost time: 26.152191400527954
Epoch: 8, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.284 Vali Acc: 0.912 Test Loss: 0.284 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.899128198623657
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.293 Vali Acc: 0.909 Test Loss: 0.293 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.28397512435913
Epoch: 10, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
Validation loss decreased (-0.925484 --> -0.945680).  Saving model ...
Epoch: 11 cost time: 25.794339179992676
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.341 Vali Acc: 0.905 Test Loss: 0.341 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 25.986594676971436
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.945680 --> -0.951948).  Saving model ...
Epoch: 13 cost time: 25.41230297088623
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 25.349608898162842
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 26.24101161956787
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.945 Test Loss: 0.210 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 24.816598415374756
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 26.744693756103516
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.939 Test Loss: 0.233 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 24.79900622367859
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 25.465532541275024
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.962 Test Loss: 0.194 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.962394).  Saving model ...
Epoch: 20 cost time: 24.824976205825806
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 23.44847536087036
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 24.09416127204895
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 25.42169976234436
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.99625849723816
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
Validation loss decreased (-0.962394 --> -0.963090).  Saving model ...
Epoch: 25 cost time: 24.28287649154663
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 26.026506662368774
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.245 Vali Acc: 0.955 Test Loss: 0.245 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 24.77963924407959
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 24.641658782958984
Epoch: 28, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.301 Vali Acc: 0.946 Test Loss: 0.301 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 24.834554195404053
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.289 Vali Acc: 0.946 Test Loss: 0.289 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 24.91618585586548
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.958 Test Loss: 0.255 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 25.633251905441284
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.275 Vali Acc: 0.958 Test Loss: 0.275 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 25.592020988464355
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.964 Test Loss: 0.228 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.963786).  Saving model ...
Epoch: 33 cost time: 25.596981048583984
Epoch: 33, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.287 Vali Acc: 0.951 Test Loss: 0.287 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 25.785314321517944
Epoch: 34, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 23.552573919296265
Epoch: 35, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.964 Test Loss: 0.202 Test Acc: 0.964
Validation loss decreased (-0.963786 --> -0.963786).  Saving model ...
Epoch: 36 cost time: 24.632054090499878
Epoch: 36, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.277 Vali Acc: 0.948 Test Loss: 0.277 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 23.632471561431885
Epoch: 37, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.256 Vali Acc: 0.957 Test Loss: 0.256 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 24.737701892852783
Epoch: 38, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 24.866273641586304
Epoch: 39, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.403 Vali Acc: 0.937 Test Loss: 0.403 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 24.366493940353394
Epoch: 40, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.317 Vali Acc: 0.951 Test Loss: 0.317 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 23.10817265510559
Epoch: 41, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.357 Vali Acc: 0.937 Test Loss: 0.357 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 23.902541875839233
Epoch: 42, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.334 Vali Acc: 0.949 Test Loss: 0.334 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 22.286844730377197
Epoch: 43, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.289 Vali Acc: 0.962 Test Loss: 0.289 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 24.352847814559937
Epoch: 44, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.962 Test Loss: 0.279 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 24.280985593795776
Epoch: 45, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.318 Vali Acc: 0.959 Test Loss: 0.318 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.508291721343994
Epoch: 1, Steps: 89 | Train Loss: 2.788 Vali Loss: 2.642 Vali Acc: 0.281 Test Loss: 2.642 Test Acc: 0.281
Validation loss decreased (inf --> -0.280614).  Saving model ...
Epoch: 2 cost time: 23.274768352508545
Epoch: 2, Steps: 89 | Train Loss: 1.879 Vali Loss: 1.744 Vali Acc: 0.494 Test Loss: 1.744 Test Acc: 0.494
Validation loss decreased (-0.280614 --> -0.493715).  Saving model ...
Epoch: 3 cost time: 23.552462816238403
Epoch: 3, Steps: 89 | Train Loss: 0.953 Vali Loss: 1.239 Vali Acc: 0.617 Test Loss: 1.239 Test Acc: 0.617
Validation loss decreased (-0.493715 --> -0.616979).  Saving model ...
Epoch: 4 cost time: 23.690894842147827
Epoch: 4, Steps: 89 | Train Loss: 0.548 Vali Loss: 0.804 Vali Acc: 0.747 Test Loss: 0.804 Test Acc: 0.747
Validation loss decreased (-0.616979 --> -0.746510).  Saving model ...
Epoch: 5 cost time: 22.359684705734253
Epoch: 5, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
Validation loss decreased (-0.746510 --> -0.775063).  Saving model ...
Epoch: 6 cost time: 24.613975763320923
Epoch: 6, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.520 Vali Acc: 0.853 Test Loss: 0.520 Test Acc: 0.853
Validation loss decreased (-0.775063 --> -0.853059).  Saving model ...
Epoch: 7 cost time: 25.059586763381958
Epoch: 7, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.422 Vali Acc: 0.886 Test Loss: 0.422 Test Acc: 0.886
Validation loss decreased (-0.853059 --> -0.885790).  Saving model ...
Epoch: 8 cost time: 24.168846607208252
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.349 Vali Acc: 0.898 Test Loss: 0.349 Test Acc: 0.898
Validation loss decreased (-0.885790 --> -0.898325).  Saving model ...
Epoch: 9 cost time: 24.51681351661682
Epoch: 9, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.340 Vali Acc: 0.912 Test Loss: 0.340 Test Acc: 0.912
Validation loss decreased (-0.898325 --> -0.912253).  Saving model ...
Epoch: 10 cost time: 23.721458673477173
Epoch: 10, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.327 Vali Acc: 0.909 Test Loss: 0.327 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.06136679649353
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.091479063034058
Epoch: 12, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
Validation loss decreased (-0.912253 --> -0.935234).  Saving model ...
Epoch: 13 cost time: 23.7221257686615
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.239 Vali Acc: 0.940 Test Loss: 0.239 Test Acc: 0.940
Validation loss decreased (-0.935234 --> -0.940109).  Saving model ...
Epoch: 14 cost time: 23.853305339813232
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.276 Vali Acc: 0.935 Test Loss: 0.276 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.03751802444458
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.306 Vali Acc: 0.923 Test Loss: 0.306 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.94180130958557
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.257 Vali Acc: 0.942 Test Loss: 0.257 Test Acc: 0.942
Validation loss decreased (-0.940109 --> -0.941502).  Saving model ...
Epoch: 17 cost time: 21.443533182144165
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.385 Vali Acc: 0.910 Test Loss: 0.385 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.198989152908325
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 22.55402398109436
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.259 Vali Acc: 0.945 Test Loss: 0.259 Test Acc: 0.945
Validation loss decreased (-0.941502 --> -0.944983).  Saving model ...
Epoch: 20 cost time: 23.205446481704712
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.463 Vali Acc: 0.902 Test Loss: 0.463 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 22.683033227920532
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 21.564784049987793
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.252 Vali Acc: 0.946 Test Loss: 0.252 Test Acc: 0.946
Validation loss decreased (-0.944983 --> -0.946376).  Saving model ...
Epoch: 23 cost time: 22.505879163742065
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.940 Test Loss: 0.297 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 21.79228925704956
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.323 Vali Acc: 0.935 Test Loss: 0.323 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 22.021384954452515
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.313 Vali Acc: 0.940 Test Loss: 0.313 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 22.596208095550537
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.301 Vali Acc: 0.951 Test Loss: 0.301 Test Acc: 0.951
Validation loss decreased (-0.946376 --> -0.951250).  Saving model ...
Epoch: 27 cost time: 22.16466784477234
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.258 Vali Acc: 0.954 Test Loss: 0.258 Test Acc: 0.954
Validation loss decreased (-0.951250 --> -0.954036).  Saving model ...
Epoch: 28 cost time: 21.538178205490112
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.285 Vali Acc: 0.946 Test Loss: 0.285 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 22.411811351776123
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.280 Vali Acc: 0.947 Test Loss: 0.280 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 22.626383066177368
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.293 Vali Acc: 0.942 Test Loss: 0.293 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 22.348090648651123
Epoch: 31, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.297 Vali Acc: 0.945 Test Loss: 0.297 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 21.916245937347412
Epoch: 32, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.341 Vali Acc: 0.930 Test Loss: 0.341 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 22.400829315185547
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.301 Vali Acc: 0.949 Test Loss: 0.301 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 22.373292684555054
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.341 Vali Acc: 0.945 Test Loss: 0.341 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 21.79442858695984
Epoch: 35, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.349 Vali Acc: 0.939 Test Loss: 0.349 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 22.810338973999023
Epoch: 36, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.354 Vali Acc: 0.935 Test Loss: 0.354 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 22.94853973388672
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9540389972144847
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.455992221832275
Epoch: 1, Steps: 89 | Train Loss: 2.823 Vali Loss: 2.750 Vali Acc: 0.198 Test Loss: 2.750 Test Acc: 0.198
Validation loss decreased (inf --> -0.197744).  Saving model ...
Epoch: 2 cost time: 21.817176818847656
Epoch: 2, Steps: 89 | Train Loss: 2.013 Vali Loss: 1.899 Vali Acc: 0.404 Test Loss: 1.899 Test Acc: 0.404
Validation loss decreased (-0.197744 --> -0.403881).  Saving model ...
Epoch: 3 cost time: 23.791409730911255
Epoch: 3, Steps: 89 | Train Loss: 1.065 Vali Loss: 1.457 Vali Acc: 0.568 Test Loss: 1.457 Test Acc: 0.568
Validation loss decreased (-0.403881 --> -0.568231).  Saving model ...
Epoch: 4 cost time: 22.12380814552307
Epoch: 4, Steps: 89 | Train Loss: 0.624 Vali Loss: 0.999 Vali Acc: 0.683 Test Loss: 0.999 Test Acc: 0.683
Validation loss decreased (-0.568231 --> -0.683138).  Saving model ...
Epoch: 5 cost time: 23.67950463294983
Epoch: 5, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.755 Vali Acc: 0.765 Test Loss: 0.755 Test Acc: 0.765
Validation loss decreased (-0.683138 --> -0.765313).  Saving model ...
Epoch: 6 cost time: 24.969024896621704
Epoch: 6, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.672 Vali Acc: 0.799 Test Loss: 0.672 Test Acc: 0.799
Validation loss decreased (-0.765313 --> -0.798740).  Saving model ...
Epoch: 7 cost time: 23.417811632156372
Epoch: 7, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.569 Vali Acc: 0.839 Test Loss: 0.569 Test Acc: 0.839
Validation loss decreased (-0.798740 --> -0.839131).  Saving model ...
Epoch: 8 cost time: 23.63253664970398
Epoch: 8, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.509 Vali Acc: 0.835 Test Loss: 0.509 Test Acc: 0.835
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.642077445983887
Epoch: 9, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.495 Vali Acc: 0.861 Test Loss: 0.495 Test Acc: 0.861
Validation loss decreased (-0.839131 --> -0.861416).  Saving model ...
Epoch: 10 cost time: 24.11872625350952
Epoch: 10, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.861416 --> -0.875344).  Saving model ...
Epoch: 11 cost time: 23.50900149345398
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.522 Vali Acc: 0.847 Test Loss: 0.522 Test Acc: 0.847
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.332935571670532
Epoch: 12, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.399 Vali Acc: 0.886 Test Loss: 0.399 Test Acc: 0.886
Validation loss decreased (-0.875344 --> -0.885790).  Saving model ...
Epoch: 13 cost time: 25.250360250473022
Epoch: 13, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.349 Vali Acc: 0.901 Test Loss: 0.349 Test Acc: 0.901
Validation loss decreased (-0.885790 --> -0.901111).  Saving model ...
Epoch: 14 cost time: 25.45901584625244
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.389 Vali Acc: 0.896 Test Loss: 0.389 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.895262479782104
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.351 Vali Acc: 0.913 Test Loss: 0.351 Test Acc: 0.913
Validation loss decreased (-0.901111 --> -0.912949).  Saving model ...
Epoch: 16 cost time: 23.124729871749878
Epoch: 16, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.306 Vali Acc: 0.923 Test Loss: 0.306 Test Acc: 0.923
Validation loss decreased (-0.912949 --> -0.923395).  Saving model ...
Epoch: 17 cost time: 24.448927879333496
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 23.822590827941895
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.388 Vali Acc: 0.904 Test Loss: 0.388 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.29405641555786
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.414 Vali Acc: 0.898 Test Loss: 0.414 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 22.624138832092285
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.461 Vali Acc: 0.893 Test Loss: 0.461 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 22.14840269088745
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.381 Vali Acc: 0.907 Test Loss: 0.381 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 24.97423815727234
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.444 Vali Acc: 0.896 Test Loss: 0.444 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 22.516368627548218
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.923395 --> -0.930359).  Saving model ...
Epoch: 24 cost time: 22.12729287147522
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.308 Vali Acc: 0.935 Test Loss: 0.308 Test Acc: 0.935
Validation loss decreased (-0.930359 --> -0.935234).  Saving model ...
Epoch: 25 cost time: 23.330299615859985
Epoch: 25, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.396 Vali Acc: 0.916 Test Loss: 0.396 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.60405683517456
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 22.10446286201477
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.367 Vali Acc: 0.928 Test Loss: 0.367 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 22.427839756011963
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 23.199201583862305
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.384 Vali Acc: 0.935 Test Loss: 0.384 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 22.70226812362671
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.363 Vali Acc: 0.930 Test Loss: 0.363 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 22.092737436294556
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.354 Vali Acc: 0.928 Test Loss: 0.354 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 22.409775733947754
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.321 Vali Acc: 0.934 Test Loss: 0.321 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 23.6317036151886
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.395 Vali Acc: 0.921 Test Loss: 0.395 Test Acc: 0.921
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 22.58399772644043
Epoch: 34, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.333 Vali Acc: 0.942 Test Loss: 0.333 Test Acc: 0.942
Validation loss decreased (-0.935234 --> -0.941501).  Saving model ...
Epoch: 35 cost time: 22.881014823913574
Epoch: 35, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.418 Vali Acc: 0.921 Test Loss: 0.418 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 22.81913709640503
Epoch: 36, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.361 Vali Acc: 0.948 Test Loss: 0.361 Test Acc: 0.948
Validation loss decreased (-0.941501 --> -0.947768).  Saving model ...
Epoch: 37 cost time: 21.90987539291382
Epoch: 37, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.352 Vali Acc: 0.944 Test Loss: 0.352 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 22.222033262252808
Epoch: 38, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.378 Vali Acc: 0.944 Test Loss: 0.378 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 22.89214253425598
Epoch: 39, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.396 Vali Acc: 0.941 Test Loss: 0.396 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 23.188581943511963
Epoch: 40, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.340 Vali Acc: 0.942 Test Loss: 0.340 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 22.25453543663025
Epoch: 41, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 21.86345076560974
Epoch: 42, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.371 Vali Acc: 0.948 Test Loss: 0.371 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 21.833826065063477
Epoch: 43, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.355 Vali Acc: 0.948 Test Loss: 0.355 Test Acc: 0.948
Validation loss decreased (-0.947768 --> -0.948464).  Saving model ...
Epoch: 44 cost time: 22.368863582611084
Epoch: 44, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.371 Vali Acc: 0.942 Test Loss: 0.371 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 23.283527135849
Epoch: 45, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.448 Vali Acc: 0.937 Test Loss: 0.448 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 22.735875368118286
Epoch: 46, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 22.59479570388794
Epoch: 47, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.415 Vali Acc: 0.937 Test Loss: 0.415 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 23.354968786239624
Epoch: 48, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.358 Vali Acc: 0.946 Test Loss: 0.358 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 22.4751079082489
Epoch: 49, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.391 Vali Acc: 0.938 Test Loss: 0.391 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 22.080779790878296
Epoch: 50, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.454 Vali Acc: 0.942 Test Loss: 0.454 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 22.04640817642212
Epoch: 51, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.453 Vali Acc: 0.934 Test Loss: 0.453 Test Acc: 0.934
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 22.457457542419434
Epoch: 52, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.412 Vali Acc: 0.942 Test Loss: 0.412 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 22.00761580467224
Epoch: 53, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.441 Vali Acc: 0.936 Test Loss: 0.441 Test Acc: 0.936
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9484679665738162
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.893651723861694
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.047 Test Loss: 2.996 Test Acc: 0.047
Validation loss decreased (inf --> -0.046627).  Saving model ...
Epoch: 2 cost time: 23.436246871948242
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.046627 --> -0.064733).  Saving model ...
Epoch: 3 cost time: 21.829033851623535
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 22.58413290977478
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 22.725085496902466
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 22.626797914505005
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 23.2803692817688
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 23.89808464050293
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 23.331333875656128
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 23.59037470817566
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 24.32437252998352
Epoch: 11, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 22.445157766342163
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 21.180335998535156
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 21.96080994606018
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 21.787806272506714
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 21.722432374954224
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 22.075742483139038
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 22.450013637542725
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 22.818052768707275
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 24.328637838363647
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 23.45218515396118
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 21.638994932174683
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 23.385934829711914
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 23.45544171333313
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 23.204203605651855
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 22.73869824409485
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 24.16324758529663
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 22.77671456336975
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 21.89967393875122
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 22.628722190856934
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 22.97918176651001
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 22.38987922668457
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 22.338556051254272
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 24.200507402420044
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 24.326176166534424
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 24.160637140274048
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 24.20721197128296
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 22.301443338394165
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 22.749449968338013
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 23.120327711105347
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 24.492368936538696
Epoch: 41, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 24.300297260284424
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 24.49783682823181
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 23.67257571220398
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 24.16948652267456
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 24.304049730300903
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 25.50838303565979
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 22.791508197784424
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 49 cost time: 25.26463270187378
Epoch: 49, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 50 cost time: 23.820502758026123
Epoch: 50, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 24.735201120376587
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 24.02102565765381
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 23.204949378967285
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 22.48156476020813
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 23.10244059562683
Epoch: 55, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 56 cost time: 23.831077575683594
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 22.782922983169556
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 22.350378274917603
Epoch: 58, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 22.684203386306763
Epoch: 59, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 22.555619478225708
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 22.766685009002686
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 21.027358770370483
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 63 cost time: 23.64997172355652
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 24.244733572006226
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 65 cost time: 22.475038528442383
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 21.237924575805664
Epoch: 66, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 22.189009189605713
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 68 cost time: 23.13059687614441
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 21.460116147994995
Epoch: 69, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 22.64273762702942
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 25.140493154525757
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 23.67954397201538
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 24.06577444076538
Epoch: 73, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 23.612844944000244
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 22.703441858291626
Epoch: 75, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 22.91737127304077
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 22.756765127182007
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 257620
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.927438974380493
Epoch: 1, Steps: 89 | Train Loss: 1.869 Vali Loss: 0.793 Vali Acc: 0.801 Test Loss: 0.793 Test Acc: 0.801
Validation loss decreased (inf --> -0.800828).  Saving model ...
Epoch: 2 cost time: 22.522880792617798
Epoch: 2, Steps: 89 | Train Loss: 0.521 Vali Loss: 0.388 Vali Acc: 0.895 Test Loss: 0.388 Test Acc: 0.895
Validation loss decreased (-0.800828 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 25.11065363883972
Epoch: 3, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.250 Vali Acc: 0.934 Test Loss: 0.250 Test Acc: 0.934
Validation loss decreased (-0.894843 --> -0.933842).  Saving model ...
Epoch: 4 cost time: 22.28127121925354
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.446025133132935
Epoch: 5, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.933842 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 23.53603196144104
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.948466 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 23.914219856262207
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.171 Vali Acc: 0.945 Test Loss: 0.171 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.21125292778015
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.589910984039307
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 22.297146558761597
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 11 cost time: 22.31285572052002
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.576523065567017
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.29443621635437
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 21.69369339942932
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 15 cost time: 22.660747051239014
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 21.739311695098877
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.5617573261261
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 23.18801188468933
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.73550319671631
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 22.65298891067505
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.156 Vali Acc: 0.966 Test Loss: 0.156 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 22.081196069717407
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.127312660217285
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 22.259993314743042
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 21.671781539916992
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.962 Test Loss: 0.222 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 22.040403604507446
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.34368348121643
Epoch: 1, Steps: 89 | Train Loss: 1.917 Vali Loss: 0.898 Vali Acc: 0.774 Test Loss: 0.898 Test Acc: 0.774
Validation loss decreased (inf --> -0.774364).  Saving model ...
Epoch: 2 cost time: 22.81938076019287
Epoch: 2, Steps: 89 | Train Loss: 0.614 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.774364 --> -0.862809).  Saving model ...
Epoch: 3 cost time: 22.87137746810913
Epoch: 3, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.309 Vali Acc: 0.916 Test Loss: 0.309 Test Acc: 0.916
Validation loss decreased (-0.862809 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 23.894701957702637
Epoch: 4, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.311 Vali Acc: 0.897 Test Loss: 0.311 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.490209579467773
Epoch: 5, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.916431 --> -0.919217).  Saving model ...
Epoch: 6 cost time: 23.242822885513306
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.919217 --> -0.947770).  Saving model ...
Epoch: 7 cost time: 20.099742650985718
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.968549966812134
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.947770 --> -0.950555).  Saving model ...
Epoch: 9 cost time: 24.097804307937622
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.947 Test Loss: 0.206 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.886430501937866
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.960305).  Saving model ...
Epoch: 11 cost time: 22.361092567443848
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.473743438720703
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.009783506393433
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 22.687764167785645
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.953 Test Loss: 0.203 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 23.558554887771606
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 22.87639880180359
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 23.05726432800293
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.961698).  Saving model ...
Epoch: 18 cost time: 23.35738706588745
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 22.65114974975586
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.14295268058777
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 21.742401838302612
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 23.246771812438965
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 21.743860006332397
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 22.74888038635254
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 22.33941078186035
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 23.69790029525757
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
Validation loss decreased (-0.961698 --> -0.965876).  Saving model ...
Epoch: 27 cost time: 22.83406639099121
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 23.094101667404175
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 23.48880958557129
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 22.439663648605347
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 23.00567865371704
Epoch: 31, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 23.257614135742188
Epoch: 32, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.408 Vali Acc: 0.929 Test Loss: 0.408 Test Acc: 0.929
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 23.197998523712158
Epoch: 33, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.343 Vali Acc: 0.942 Test Loss: 0.343 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 22.42604970932007
Epoch: 34, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.311 Vali Acc: 0.946 Test Loss: 0.311 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 23.216639518737793
Epoch: 35, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.246 Vali Acc: 0.954 Test Loss: 0.246 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 22.962444067001343
Epoch: 36, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9658774373259053
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.687025785446167
Epoch: 1, Steps: 89 | Train Loss: 2.033 Vali Loss: 1.032 Vali Acc: 0.751 Test Loss: 1.032 Test Acc: 0.751
Validation loss decreased (inf --> -0.750686).  Saving model ...
Epoch: 2 cost time: 22.0952627658844
Epoch: 2, Steps: 89 | Train Loss: 0.733 Vali Loss: 0.603 Vali Acc: 0.820 Test Loss: 0.603 Test Acc: 0.820
Validation loss decreased (-0.750686 --> -0.819632).  Saving model ...
Epoch: 3 cost time: 21.439188718795776
Epoch: 3, Steps: 89 | Train Loss: 0.421 Vali Loss: 0.368 Vali Acc: 0.895 Test Loss: 0.368 Test Acc: 0.895
Validation loss decreased (-0.819632 --> -0.894843).  Saving model ...
Epoch: 4 cost time: 22.67963743209839
Epoch: 4, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.894843 --> -0.899022).  Saving model ...
Epoch: 5 cost time: 23.716390371322632
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.303 Vali Acc: 0.912 Test Loss: 0.303 Test Acc: 0.912
Validation loss decreased (-0.899022 --> -0.911557).  Saving model ...
Epoch: 6 cost time: 24.71758198738098
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
Validation loss decreased (-0.911557 --> -0.938020).  Saving model ...
Epoch: 7 cost time: 23.762986660003662
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.224 Vali Acc: 0.936 Test Loss: 0.224 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.941245079040527
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.938020 --> -0.944288).  Saving model ...
Epoch: 9 cost time: 24.856197118759155
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.944288 --> -0.951948).  Saving model ...
Epoch: 10 cost time: 23.68831753730774
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.47588801383972
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.225727558135986
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.54667377471924
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.481070280075073
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 24.509725332260132
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 25.485230922698975
Epoch: 16, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
Validation loss decreased (-0.951948 --> -0.954037).  Saving model ...
Epoch: 17 cost time: 23.782341241836548
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.054141998291016
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958216).  Saving model ...
Epoch: 19 cost time: 22.798352479934692
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
Validation loss decreased (-0.958216 --> -0.961001).  Saving model ...
Epoch: 20 cost time: 22.035945653915405
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 21.434873580932617
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 22.188422679901123
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.961 Test Loss: 0.198 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 22.080799341201782
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 21.64556884765625
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.968661).  Saving model ...
Epoch: 25 cost time: 21.66289758682251
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 21.65199303627014
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 22.084820985794067
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 22.411972761154175
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 22.532463550567627
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 22.81019949913025
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.232 Vali Acc: 0.957 Test Loss: 0.232 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 21.57083797454834
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 21.94852614402771
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.294 Vali Acc: 0.951 Test Loss: 0.294 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 22.46272611618042
Epoch: 33, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.284 Vali Acc: 0.942 Test Loss: 0.284 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 22.930534601211548
Epoch: 34, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.68860936164856
Epoch: 1, Steps: 89 | Train Loss: 2.389 Vali Loss: 1.434 Vali Acc: 0.693 Test Loss: 1.434 Test Acc: 0.693
Validation loss decreased (inf --> -0.692883).  Saving model ...
Epoch: 2 cost time: 23.34408926963806
Epoch: 2, Steps: 89 | Train Loss: 1.006 Vali Loss: 0.758 Vali Acc: 0.801 Test Loss: 0.758 Test Acc: 0.801
Validation loss decreased (-0.692883 --> -0.800828).  Saving model ...
Epoch: 3 cost time: 23.294010162353516
Epoch: 3, Steps: 89 | Train Loss: 0.527 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
Validation loss decreased (-0.800828 --> -0.877433).  Saving model ...
Epoch: 4 cost time: 23.06022047996521
Epoch: 4, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.347 Vali Acc: 0.901 Test Loss: 0.347 Test Acc: 0.901
Validation loss decreased (-0.877433 --> -0.901111).  Saving model ...
Epoch: 5 cost time: 23.055079698562622
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.307 Vali Acc: 0.903 Test Loss: 0.307 Test Acc: 0.903
Validation loss decreased (-0.901111 --> -0.903200).  Saving model ...
Epoch: 6 cost time: 23.304172039031982
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.201 Vali Acc: 0.940 Test Loss: 0.201 Test Acc: 0.940
Validation loss decreased (-0.903200 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 22.61544919013977
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.28457808494568
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.940109 --> -0.944288).  Saving model ...
Epoch: 9 cost time: 24.499292612075806
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
Validation loss decreased (-0.944288 --> -0.955430).  Saving model ...
Epoch: 10 cost time: 22.08529257774353
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.958216).  Saving model ...
Epoch: 11 cost time: 22.618028163909912
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.130226612091064
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.961698).  Saving model ...
Epoch: 13 cost time: 23.119083881378174
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.926735639572144
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.017927646636963
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.544466495513916
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 22.676298141479492
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.955 Test Loss: 0.200 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.72141432762146
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.09351134300232
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 20 cost time: 23.485941171646118
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965876).  Saving model ...
Epoch: 21 cost time: 26.211645364761353
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 23.642468452453613
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 23.303274869918823
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 24 cost time: 23.17136812210083
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 25 cost time: 23.95554232597351
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.24053382873535
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 23.634217023849487
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 23.923125743865967
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 23.850505352020264
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 23.45198631286621
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 24.497119426727295
Epoch: 31, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.370 Vali Acc: 0.927 Test Loss: 0.370 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 22.303661108016968
Epoch: 32, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 22.200058221817017
Epoch: 33, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.313 Vali Acc: 0.947 Test Loss: 0.313 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 21.896504878997803
Epoch: 34, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.257 Vali Acc: 0.951 Test Loss: 0.257 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.9888973236084
Epoch: 1, Steps: 89 | Train Loss: 2.743 Vali Loss: 2.395 Vali Acc: 0.326 Test Loss: 2.395 Test Acc: 0.326
Validation loss decreased (inf --> -0.325881).  Saving model ...
Epoch: 2 cost time: 23.114272832870483
Epoch: 2, Steps: 89 | Train Loss: 1.733 Vali Loss: 1.268 Vali Acc: 0.629 Test Loss: 1.268 Test Acc: 0.629
Validation loss decreased (-0.325881 --> -0.628817).  Saving model ...
Epoch: 3 cost time: 22.11245608329773
Epoch: 3, Steps: 89 | Train Loss: 0.733 Vali Loss: 0.557 Vali Acc: 0.834 Test Loss: 0.557 Test Acc: 0.834
Validation loss decreased (-0.628817 --> -0.833560).  Saving model ...
Epoch: 4 cost time: 22.3647038936615
Epoch: 4, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.378 Vali Acc: 0.891 Test Loss: 0.378 Test Acc: 0.891
Validation loss decreased (-0.833560 --> -0.891361).  Saving model ...
Epoch: 5 cost time: 23.160672903060913
Epoch: 5, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.891361 --> -0.918521).  Saving model ...
Epoch: 6 cost time: 22.389283657073975
Epoch: 6, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.204 Vali Acc: 0.940 Test Loss: 0.204 Test Acc: 0.940
Validation loss decreased (-0.918521 --> -0.940109).  Saving model ...
Epoch: 7 cost time: 22.784548044204712
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
Validation loss decreased (-0.940109 --> -0.952645).  Saving model ...
Epoch: 8 cost time: 21.96962308883667
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
Validation loss decreased (-0.952645 --> -0.956127).  Saving model ...
Epoch: 9 cost time: 22.918078184127808
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.956127 --> -0.958912).  Saving model ...
Epoch: 10 cost time: 21.78287434577942
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
Validation loss decreased (-0.958912 --> -0.965876).  Saving model ...
Epoch: 11 cost time: 22.979888439178467
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.34183621406555
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.947 Test Loss: 0.179 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 22.46967887878418
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 23.54027032852173
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 23.650825262069702
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 22.80305290222168
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 22.008742809295654
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 22.764918327331543
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 19 cost time: 22.831519603729248
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 22.122896432876587
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 21.684244871139526
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 22.325891256332397
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 21.87556743621826
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 21.944568395614624
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 22.725106716156006
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.966 Test Loss: 0.169 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 22.588152647018433
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 27 cost time: 22.519187688827515
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 22.818506479263306
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 23.167158126831055
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 22.192987203598022
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 22.906738758087158
Epoch: 31, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 23.55369734764099
Epoch: 32, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 23.79708766937256
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 23.5010929107666
Epoch: 34, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 23.73864459991455
Epoch: 35, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 21.903851747512817
Epoch: 36, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970054).  Saving model ...
Epoch: 37 cost time: 23.266183614730835
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.955 Test Loss: 0.215 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 22.490188121795654
Epoch: 38, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 23.045650720596313
Epoch: 39, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 22.996467113494873
Epoch: 40, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.270 Vali Acc: 0.951 Test Loss: 0.270 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 23.321616888046265
Epoch: 41, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.261 Vali Acc: 0.957 Test Loss: 0.261 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 22.38283896446228
Epoch: 42, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 24.923399686813354
Epoch: 43, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.266 Vali Acc: 0.955 Test Loss: 0.266 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 24.315925359725952
Epoch: 44, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.255 Vali Acc: 0.960 Test Loss: 0.255 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 24.517977237701416
Epoch: 45, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.959 Test Loss: 0.282 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 25.02393364906311
Epoch: 46, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.964 Test Loss: 0.233 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.18444561958313
Epoch: 1, Steps: 89 | Train Loss: 2.759 Vali Loss: 2.634 Vali Acc: 0.200 Test Loss: 2.634 Test Acc: 0.200
Validation loss decreased (inf --> -0.199834).  Saving model ...
Epoch: 2 cost time: 23.084791898727417
Epoch: 2, Steps: 89 | Train Loss: 1.806 Vali Loss: 1.499 Vali Acc: 0.487 Test Loss: 1.499 Test Acc: 0.487
Validation loss decreased (-0.199834 --> -0.486754).  Saving model ...
Epoch: 3 cost time: 24.018279552459717
Epoch: 3, Steps: 89 | Train Loss: 0.784 Vali Loss: 0.689 Vali Acc: 0.788 Test Loss: 0.689 Test Acc: 0.788
Validation loss decreased (-0.486754 --> -0.788294).  Saving model ...
Epoch: 4 cost time: 22.835719108581543
Epoch: 4, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.466 Vali Acc: 0.859 Test Loss: 0.466 Test Acc: 0.859
Validation loss decreased (-0.788294 --> -0.858630).  Saving model ...
Epoch: 5 cost time: 23.545764446258545
Epoch: 5, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
Validation loss decreased (-0.858630 --> -0.876737).  Saving model ...
Epoch: 6 cost time: 23.849920749664307
Epoch: 6, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.252 Vali Acc: 0.923 Test Loss: 0.252 Test Acc: 0.923
Validation loss decreased (-0.876737 --> -0.923396).  Saving model ...
Epoch: 7 cost time: 24.06752371788025
Epoch: 7, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.263 Vali Acc: 0.914 Test Loss: 0.263 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.89838218688965
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.210 Vali Acc: 0.942 Test Loss: 0.210 Test Acc: 0.942
Validation loss decreased (-0.923396 --> -0.941502).  Saving model ...
Epoch: 9 cost time: 24.70521378517151
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
Validation loss decreased (-0.941502 --> -0.955430).  Saving model ...
Epoch: 10 cost time: 23.766024351119995
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 23.47572374343872
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.54859209060669
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.045563459396362
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.49353337287903
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 24.090543270111084
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 24.76212787628174
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 23.36478567123413
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 22.256178617477417
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.959608).  Saving model ...
Epoch: 19 cost time: 23.059585571289062
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 21.57914447784424
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.209 Vali Acc: 0.955 Test Loss: 0.209 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.011948823928833
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
Validation loss decreased (-0.959608 --> -0.963090).  Saving model ...
Epoch: 22 cost time: 22.950665950775146
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.342 Vali Acc: 0.940 Test Loss: 0.342 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.359581470489502
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 26.81025505065918
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967965).  Saving model ...
Epoch: 25 cost time: 23.56563377380371
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.217333793640137
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 22.744370698928833
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.230 Vali Acc: 0.953 Test Loss: 0.230 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 22.84893226623535
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 23.29361128807068
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 23.11391258239746
Epoch: 30, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 22.0672447681427
Epoch: 31, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.955 Test Loss: 0.237 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 23.56125283241272
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 22.280036211013794
Epoch: 33, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 22.640787601470947
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.237 Vali Acc: 0.955 Test Loss: 0.237 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.274646759033203
Epoch: 1, Steps: 89 | Train Loss: 2.771 Vali Loss: 2.740 Vali Acc: 0.166 Test Loss: 2.740 Test Acc: 0.166
Validation loss decreased (inf --> -0.166407).  Saving model ...
Epoch: 2 cost time: 23.374408721923828
Epoch: 2, Steps: 89 | Train Loss: 1.837 Vali Loss: 1.754 Vali Acc: 0.429 Test Loss: 1.754 Test Acc: 0.429
Validation loss decreased (-0.166407 --> -0.428952).  Saving model ...
Epoch: 3 cost time: 22.713921546936035
Epoch: 3, Steps: 89 | Train Loss: 0.902 Vali Loss: 0.891 Vali Acc: 0.753 Test Loss: 0.891 Test Acc: 0.753
Validation loss decreased (-0.428952 --> -0.753473).  Saving model ...
Epoch: 4 cost time: 23.203136920928955
Epoch: 4, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.728 Vali Acc: 0.785 Test Loss: 0.728 Test Acc: 0.785
Validation loss decreased (-0.753473 --> -0.784812).  Saving model ...
Epoch: 5 cost time: 22.706058502197266
Epoch: 5, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.624 Vali Acc: 0.808 Test Loss: 0.624 Test Acc: 0.808
Validation loss decreased (-0.784812 --> -0.807793).  Saving model ...
Epoch: 6 cost time: 22.0439670085907
Epoch: 6, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
Validation loss decreased (-0.807793 --> -0.889272).  Saving model ...
Epoch: 7 cost time: 22.15953493118286
Epoch: 7, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.319 Vali Acc: 0.916 Test Loss: 0.319 Test Acc: 0.916
Validation loss decreased (-0.889272 --> -0.915735).  Saving model ...
Epoch: 8 cost time: 23.528446674346924
Epoch: 8, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.915735 --> -0.918521).  Saving model ...
Epoch: 9 cost time: 21.670172929763794
Epoch: 9, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.879732370376587
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.918521 --> -0.946377).  Saving model ...
Epoch: 11 cost time: 22.610369205474854
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.642677068710327
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.308 Vali Acc: 0.924 Test Loss: 0.308 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.72191286087036
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.946377 --> -0.948466).  Saving model ...
Epoch: 14 cost time: 21.39399290084839
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 21.768979787826538
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.206 Vali Acc: 0.943 Test Loss: 0.206 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 22.054145097732544
Epoch: 16, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.244 Vali Acc: 0.936 Test Loss: 0.244 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 21.874948501586914
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 22.612366437911987
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.948466 --> -0.948466).  Saving model ...
Epoch: 19 cost time: 21.827842235565186
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 21.716241359710693
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.241 Vali Acc: 0.940 Test Loss: 0.241 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.328940391540527
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.948466 --> -0.956126).  Saving model ...
Epoch: 22 cost time: 22.071186780929565
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 22.146162033081055
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
Validation loss decreased (-0.956126 --> -0.959608).  Saving model ...
Epoch: 24 cost time: 21.529898166656494
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 21.89129948616028
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 21.90975069999695
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 22.08586287498474
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.958 Test Loss: 0.212 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 22.10710096359253
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.280 Vali Acc: 0.936 Test Loss: 0.280 Test Acc: 0.936
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 21.43323802947998
Epoch: 29, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 22.306869506835938
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.243 Vali Acc: 0.949 Test Loss: 0.243 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 22.260123014450073
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.964 Test Loss: 0.194 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.963786).  Saving model ...
Epoch: 32 cost time: 22.56603693962097
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 22.381493091583252
Epoch: 33, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.952 Test Loss: 0.224 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 21.98831081390381
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.308 Vali Acc: 0.939 Test Loss: 0.308 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 21.342870950698853
Epoch: 35, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 20.7843976020813
Epoch: 36, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 22.304019689559937
Epoch: 37, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.337 Vali Acc: 0.948 Test Loss: 0.337 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 21.79630947113037
Epoch: 38, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.273 Vali Acc: 0.955 Test Loss: 0.273 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 21.872989177703857
Epoch: 39, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 21.967909336090088
Epoch: 40, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.296 Vali Acc: 0.942 Test Loss: 0.296 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 22.136636972427368
Epoch: 41, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.906491994857788
Epoch: 1, Steps: 89 | Train Loss: 2.808 Vali Loss: 2.695 Vali Acc: 0.164 Test Loss: 2.695 Test Acc: 0.164
Validation loss decreased (inf --> -0.164318).  Saving model ...
Epoch: 2 cost time: 22.35226058959961
Epoch: 2, Steps: 89 | Train Loss: 1.935 Vali Loss: 1.848 Vali Acc: 0.439 Test Loss: 1.848 Test Acc: 0.439
Validation loss decreased (-0.164318 --> -0.439397).  Saving model ...
Epoch: 3 cost time: 22.68816328048706
Epoch: 3, Steps: 89 | Train Loss: 1.010 Vali Loss: 1.112 Vali Acc: 0.658 Test Loss: 1.112 Test Acc: 0.658
Validation loss decreased (-0.439397 --> -0.658067).  Saving model ...
Epoch: 4 cost time: 21.422024488449097
Epoch: 4, Steps: 89 | Train Loss: 0.571 Vali Loss: 0.854 Vali Acc: 0.740 Test Loss: 0.854 Test Acc: 0.740
Validation loss decreased (-0.658067 --> -0.739546).  Saving model ...
Epoch: 5 cost time: 22.439491987228394
Epoch: 5, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.815 Vali Acc: 0.733 Test Loss: 0.815 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.274787425994873
Epoch: 6, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.739546 --> -0.838435).  Saving model ...
Epoch: 7 cost time: 22.752761840820312
Epoch: 7, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
Validation loss decreased (-0.838435 --> -0.849577).  Saving model ...
Epoch: 8 cost time: 21.960768222808838
Epoch: 8, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.466 Vali Acc: 0.845 Test Loss: 0.466 Test Acc: 0.845
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.684996366500854
Epoch: 9, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.371 Vali Acc: 0.892 Test Loss: 0.371 Test Acc: 0.892
Validation loss decreased (-0.849577 --> -0.892058).  Saving model ...
Epoch: 10 cost time: 23.09720230102539
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.364 Vali Acc: 0.894 Test Loss: 0.364 Test Acc: 0.894
Validation loss decreased (-0.892058 --> -0.894147).  Saving model ...
Epoch: 11 cost time: 21.9538996219635
Epoch: 11, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.440 Vali Acc: 0.867 Test Loss: 0.440 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.214693069458008
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.894147 --> -0.899718).  Saving model ...
Epoch: 13 cost time: 24.798327445983887
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.382 Vali Acc: 0.898 Test Loss: 0.382 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.16279149055481
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.388 Vali Acc: 0.895 Test Loss: 0.388 Test Acc: 0.895
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 21.530581951141357
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.363 Vali Acc: 0.900 Test Loss: 0.363 Test Acc: 0.900
Validation loss decreased (-0.899718 --> -0.900414).  Saving model ...
Epoch: 16 cost time: 24.135581254959106
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.72530245780945
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.329 Vali Acc: 0.918 Test Loss: 0.329 Test Acc: 0.918
Validation loss decreased (-0.900414 --> -0.917824).  Saving model ...
Epoch: 18 cost time: 23.225574731826782
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
Validation loss decreased (-0.917824 --> -0.938020).  Saving model ...
Epoch: 19 cost time: 23.37269139289856
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.335 Vali Acc: 0.911 Test Loss: 0.335 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.708163261413574
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 23.128390789031982
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.264 Vali Acc: 0.935 Test Loss: 0.264 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 25.2446129322052
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.938020 --> -0.943591).  Saving model ...
Epoch: 23 cost time: 23.399646997451782
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.301 Vali Acc: 0.935 Test Loss: 0.301 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 24.70397639274597
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 23.581926584243774
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
Validation loss decreased (-0.943591 --> -0.946376).  Saving model ...
Epoch: 26 cost time: 24.879743337631226
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 23.17550778388977
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.435 Vali Acc: 0.915 Test Loss: 0.435 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 22.72370958328247
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.476 Vali Acc: 0.916 Test Loss: 0.476 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 23.463274002075195
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.949 Test Loss: 0.258 Test Acc: 0.949
Validation loss decreased (-0.946376 --> -0.949162).  Saving model ...
Epoch: 30 cost time: 23.451465129852295
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.280 Vali Acc: 0.946 Test Loss: 0.280 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 24.095852375030518
Epoch: 31, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.243 Vali Acc: 0.949 Test Loss: 0.243 Test Acc: 0.949
Validation loss decreased (-0.949162 --> -0.949162).  Saving model ...
Epoch: 32 cost time: 23.17931628227234
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
Validation loss decreased (-0.949162 --> -0.951947).  Saving model ...
Epoch: 33 cost time: 24.085216522216797
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.266 Vali Acc: 0.951 Test Loss: 0.266 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 22.773826837539673
Epoch: 34, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 23.31301522254944
Epoch: 35, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.289 Vali Acc: 0.949 Test Loss: 0.289 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.361894369125366
Epoch: 36, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 24.41455101966858
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.365 Vali Acc: 0.926 Test Loss: 0.365 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 23.17108702659607
Epoch: 38, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.363 Vali Acc: 0.938 Test Loss: 0.363 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 23.491520166397095
Epoch: 39, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.291 Vali Acc: 0.946 Test Loss: 0.291 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 23.404971837997437
Epoch: 40, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 24.181929349899292
Epoch: 41, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.367 Vali Acc: 0.935 Test Loss: 0.367 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 22.930901288986206
Epoch: 42, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.351 Vali Acc: 0.937 Test Loss: 0.351 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.746661901474
Epoch: 1, Steps: 89 | Train Loss: 2.843 Vali Loss: 2.649 Vali Acc: 0.228 Test Loss: 2.649 Test Acc: 0.228
Validation loss decreased (inf --> -0.228386).  Saving model ...
Epoch: 2 cost time: 24.60945177078247
Epoch: 2, Steps: 89 | Train Loss: 2.018 Vali Loss: 1.817 Vali Acc: 0.439 Test Loss: 1.817 Test Acc: 0.439
Validation loss decreased (-0.228386 --> -0.439397).  Saving model ...
Epoch: 3 cost time: 24.99812150001526
Epoch: 3, Steps: 89 | Train Loss: 1.067 Vali Loss: 1.244 Vali Acc: 0.597 Test Loss: 1.244 Test Acc: 0.597
Validation loss decreased (-0.439397 --> -0.597481).  Saving model ...
Epoch: 4 cost time: 24.67101764678955
Epoch: 4, Steps: 89 | Train Loss: 0.609 Vali Loss: 0.933 Vali Acc: 0.714 Test Loss: 0.933 Test Acc: 0.714
Validation loss decreased (-0.597481 --> -0.714475).  Saving model ...
Epoch: 5 cost time: 23.632867097854614
Epoch: 5, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.682 Vali Acc: 0.786 Test Loss: 0.682 Test Acc: 0.786
Validation loss decreased (-0.714475 --> -0.785509).  Saving model ...
Epoch: 6 cost time: 22.250839233398438
Epoch: 6, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
Validation loss decreased (-0.785509 --> -0.847488).  Saving model ...
Epoch: 7 cost time: 25.25512385368347
Epoch: 7, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
Validation loss decreased (-0.847488 --> -0.890665).  Saving model ...
Epoch: 8 cost time: 25.306260347366333
Epoch: 8, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.744473695755005
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.377 Vali Acc: 0.904 Test Loss: 0.377 Test Acc: 0.904
Validation loss decreased (-0.890665 --> -0.903896).  Saving model ...
Epoch: 10 cost time: 24.335875272750854
Epoch: 10, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.311 Vali Acc: 0.921 Test Loss: 0.311 Test Acc: 0.921
Validation loss decreased (-0.903896 --> -0.920610).  Saving model ...
Epoch: 11 cost time: 23.439847707748413
Epoch: 11, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.391 Vali Acc: 0.901 Test Loss: 0.391 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.8355495929718
Epoch: 12, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.427 Vali Acc: 0.888 Test Loss: 0.427 Test Acc: 0.888
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.45253086090088
Epoch: 13, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.372 Vali Acc: 0.914 Test Loss: 0.372 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 23.175209760665894
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.920610 --> -0.925484).  Saving model ...
Epoch: 15 cost time: 23.08561110496521
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.300 Vali Acc: 0.928 Test Loss: 0.300 Test Acc: 0.928
Validation loss decreased (-0.925484 --> -0.928270).  Saving model ...
Epoch: 16 cost time: 22.91699481010437
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.274 Vali Acc: 0.942 Test Loss: 0.274 Test Acc: 0.942
Validation loss decreased (-0.928270 --> -0.942198).  Saving model ...
Epoch: 17 cost time: 23.534492254257202
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.289 Vali Acc: 0.936 Test Loss: 0.289 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.735904216766357
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.285 Vali Acc: 0.939 Test Loss: 0.285 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 22.26383399963379
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 23.620665788650513
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.383 Vali Acc: 0.912 Test Loss: 0.383 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 23.29564595222473
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.302 Vali Acc: 0.943 Test Loss: 0.302 Test Acc: 0.943
Validation loss decreased (-0.942198 --> -0.942894).  Saving model ...
Epoch: 22 cost time: 23.309503316879272
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.326 Vali Acc: 0.935 Test Loss: 0.326 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 23.13053321838379
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.341 Vali Acc: 0.928 Test Loss: 0.341 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 22.479978322982788
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 23.42019772529602
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.942894 --> -0.944286).  Saving model ...
Epoch: 26 cost time: 22.948920965194702
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.430 Vali Acc: 0.917 Test Loss: 0.430 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 23.071564435958862
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.297 Vali Acc: 0.936 Test Loss: 0.297 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 23.06206512451172
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.300 Vali Acc: 0.942 Test Loss: 0.300 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 23.464182376861572
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.278 Vali Acc: 0.947 Test Loss: 0.278 Test Acc: 0.947
Validation loss decreased (-0.944286 --> -0.947072).  Saving model ...
Epoch: 30 cost time: 23.25016212463379
Epoch: 30, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.304 Vali Acc: 0.945 Test Loss: 0.304 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 24.827744245529175
Epoch: 31, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.352 Vali Acc: 0.935 Test Loss: 0.352 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 24.561195135116577
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 25.631722688674927
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.296 Vali Acc: 0.949 Test Loss: 0.296 Test Acc: 0.949
Validation loss decreased (-0.947072 --> -0.949161).  Saving model ...
Epoch: 34 cost time: 25.84607219696045
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.299 Vali Acc: 0.948 Test Loss: 0.299 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 25.90805959701538
Epoch: 35, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 24.78945231437683
Epoch: 36, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 24.991795778274536
Epoch: 37, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.371 Vali Acc: 0.945 Test Loss: 0.371 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 25.0942440032959
Epoch: 38, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.322 Vali Acc: 0.939 Test Loss: 0.322 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 23.39228582382202
Epoch: 39, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.395 Vali Acc: 0.934 Test Loss: 0.395 Test Acc: 0.934
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 22.693373918533325
Epoch: 40, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 23.00085186958313
Epoch: 41, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949161 --> -0.949857).  Saving model ...
Epoch: 42 cost time: 23.16205382347107
Epoch: 42, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.392 Vali Acc: 0.930 Test Loss: 0.392 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 23.564879179000854
Epoch: 43, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.402 Vali Acc: 0.937 Test Loss: 0.402 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 23.63221311569214
Epoch: 44, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.421 Vali Acc: 0.940 Test Loss: 0.421 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 24.130730867385864
Epoch: 45, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.407 Vali Acc: 0.938 Test Loss: 0.407 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 24.390329122543335
Epoch: 46, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.311 Vali Acc: 0.959 Test Loss: 0.311 Test Acc: 0.959
Validation loss decreased (-0.949857 --> -0.958911).  Saving model ...
Epoch: 47 cost time: 23.53069567680359
Epoch: 47, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.381 Vali Acc: 0.944 Test Loss: 0.381 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 23.060680866241455
Epoch: 48, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 23.457300662994385
Epoch: 49, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.440 Vali Acc: 0.935 Test Loss: 0.440 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 23.502700805664062
Epoch: 50, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.479 Vali Acc: 0.944 Test Loss: 0.479 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 23.256179809570312
Epoch: 51, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.381 Vali Acc: 0.948 Test Loss: 0.381 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 23.259334802627563
Epoch: 52, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.359 Vali Acc: 0.948 Test Loss: 0.359 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 22.623905181884766
Epoch: 53, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.399 Vali Acc: 0.955 Test Loss: 0.399 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 22.63391375541687
Epoch: 54, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.473 Vali Acc: 0.939 Test Loss: 0.473 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 23.035568475723267
Epoch: 55, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.450 Vali Acc: 0.940 Test Loss: 0.450 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 23.307425022125244
Epoch: 56, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.455 Vali Acc: 0.940 Test Loss: 0.455 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9589136490250696
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 26.584683179855347
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (inf --> -0.060555).  Saving model ...
Epoch: 2 cost time: 24.202248573303223
Epoch: 2, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 3 cost time: 24.492921590805054
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.061 Test Loss: 2.995 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 4 cost time: 25.07816767692566
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.061 Test Loss: 2.994 Test Acc: 0.061
Validation loss decreased (-0.060555 --> -0.060555).  Saving model ...
Epoch: 5 cost time: 24.002204656600952
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.060555 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 24.48749017715454
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 23.70082950592041
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 22.564637184143066
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 24.375425338745117
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 23.91893982887268
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 23.398311138153076
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 24.100178003311157
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 23.188382148742676
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 23.035751581192017
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 22.15885090827942
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 22.416771411895752
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 23.747013330459595
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 23.461880683898926
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 25.04441213607788
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 23.210981845855713
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 23.53738498687744
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 22.961827516555786
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 23.514744520187378
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 23.23211932182312
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 23.58025050163269
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 23.75320291519165
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 22.818355798721313
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 24.232412576675415
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 24.122337102890015
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 23.538483381271362
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 24.219738006591797
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 22.769853830337524
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 23.016891956329346
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 23.42955446243286
Epoch: 34, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 23.971949100494385
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 24.536543130874634
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 24.655290126800537
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 24.78414297103882
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 23.73030114173889
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 23.78520369529724
Epoch: 40, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 24.176175832748413
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 24.722490549087524
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 22.943281412124634
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 22.960699319839478
Epoch: 44, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 23.3055260181427
Epoch: 45, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 24.274245023727417
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 24.370166778564453
Epoch: 47, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 23.476354122161865
Epoch: 48, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 23.978355646133423
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 23.52951955795288
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 24.378059148788452
Epoch: 51, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 52 cost time: 23.206401586532593
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 23.69495129585266
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 25.107179880142212
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 24.602008819580078
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 24.100980758666992
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 25.368896007537842
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 23.68745708465576
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 24.06636619567871
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 23.60581135749817
Epoch: 60, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 23.09954333305359
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 62 cost time: 22.929319143295288
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 24.032588005065918
Epoch: 63, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 23.983194589614868
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 23.44002366065979
Epoch: 65, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 23.71519136428833
Epoch: 66, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 67 cost time: 22.994813680648804
Epoch: 67, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 22.584238290786743
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 21.99926495552063
Epoch: 69, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 23.383941173553467
Epoch: 70, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 22.401797771453857
Epoch: 71, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 23.77049946784973
Epoch: 72, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 23.162976264953613
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 23.731185913085938
Epoch: 74, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 22.659295082092285
Epoch: 75, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 76 cost time: 22.994867086410522
Epoch: 76, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 23.567133903503418
Epoch: 77, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 23.742151260375977
Epoch: 78, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 23.56241750717163
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 23.526468992233276
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 22.61447310447693
Epoch: 81, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 22.55352759361267
Epoch: 82, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 22.876594305038452
Epoch: 83, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 23.56374430656433
Epoch: 84, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 24.982475757598877
Epoch: 85, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 208468
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         91                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.339083671569824
Epoch: 1, Steps: 89 | Train Loss: 1.887 Vali Loss: 0.862 Vali Acc: 0.783 Test Loss: 0.862 Test Acc: 0.783
Validation loss decreased (inf --> -0.782721).  Saving model ...
Epoch: 2 cost time: 24.72874927520752
Epoch: 2, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.438 Vali Acc: 0.865 Test Loss: 0.438 Test Acc: 0.865
Validation loss decreased (-0.782721 --> -0.864898).  Saving model ...
Epoch: 3 cost time: 23.444322109222412
Epoch: 3, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
Validation loss decreased (-0.864898 --> -0.910861).  Saving model ...
Epoch: 4 cost time: 24.55646324157715
Epoch: 4, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.910861 --> -0.928271).  Saving model ...
Epoch: 5 cost time: 24.99391222000122
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
Validation loss decreased (-0.928271 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 25.1184344291687
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.228 Vali Acc: 0.939 Test Loss: 0.228 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.27205181121826
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 23.70735478401184
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.959609).  Saving model ...
Epoch: 9 cost time: 23.33403182029724
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.959609 --> -0.963091).  Saving model ...
Epoch: 10 cost time: 24.494683027267456
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.744678735733032
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 25.89096426963806
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 23.887162685394287
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 22.885090351104736
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 23.55911898612976
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 24.649467706680298
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.963091 --> -0.967965).  Saving model ...
Epoch: 17 cost time: 24.358781337738037
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 18 cost time: 24.022034168243408
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 24.00742530822754
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 24.396068334579468
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 21 cost time: 23.56902766227722
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 24.95761466026306
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 24.125805616378784
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 22.998315811157227
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 23.671936511993408
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 24.32939577102661
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 24.98177194595337
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 23.29616665840149
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.949 Test Loss: 0.272 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 24.902076482772827
Epoch: 29, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.270 Vali Acc: 0.943 Test Loss: 0.270 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 23.74479055404663
Epoch: 30, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         73                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma73_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.23754858970642
Epoch: 1, Steps: 89 | Train Loss: 1.930 Vali Loss: 0.948 Vali Acc: 0.760 Test Loss: 0.948 Test Acc: 0.760
Validation loss decreased (inf --> -0.760436).  Saving model ...
Epoch: 2 cost time: 23.3920681476593
Epoch: 2, Steps: 89 | Train Loss: 0.660 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.760436 --> -0.840524).  Saving model ...
Epoch: 3 cost time: 23.94050407409668
Epoch: 3, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.374 Vali Acc: 0.887 Test Loss: 0.374 Test Acc: 0.887
Validation loss decreased (-0.840524 --> -0.887183).  Saving model ...
Epoch: 4 cost time: 24.209752559661865
Epoch: 4, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.283 Vali Acc: 0.908 Test Loss: 0.283 Test Acc: 0.908
Validation loss decreased (-0.887183 --> -0.908075).  Saving model ...
Epoch: 5 cost time: 24.271158695220947
Epoch: 5, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.908075 --> -0.943591).  Saving model ...
Epoch: 6 cost time: 23.569918394088745
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.00494360923767
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.200 Vali Acc: 0.942 Test Loss: 0.200 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.241353750228882
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.943591 --> -0.958216).  Saving model ...
Epoch: 9 cost time: 25.56853485107422
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.892444610595703
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.85475254058838
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.939 Test Loss: 0.188 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.352570295333862
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.974515199661255
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959609).  Saving model ...
Epoch: 14 cost time: 23.339064121246338
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.870771169662476
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.959609 --> -0.960305).  Saving model ...
Epoch: 16 cost time: 22.341272354125977
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.826297283172607
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.301687240600586
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.961698).  Saving model ...
Epoch: 19 cost time: 22.437933444976807
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.961698 --> -0.963090).  Saving model ...
Epoch: 20 cost time: 22.700456619262695
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964483).  Saving model ...
Epoch: 21 cost time: 22.549803256988525
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.942 Test Loss: 0.227 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 22.763127326965332
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 22.88430953025818
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 22.479521989822388
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 24.066548109054565
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 22.449975967407227
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.263 Vali Acc: 0.938 Test Loss: 0.263 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 23.091105937957764
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 28 cost time: 23.669366598129272
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 23.430255651474
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 23.988159656524658
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 23.731364011764526
Epoch: 31, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 32 cost time: 24.299646854400635
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 33 cost time: 23.330681562423706
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 23.133127689361572
Epoch: 34, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 22.333736658096313
Epoch: 35, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 23.69088125228882
Epoch: 36, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.309 Vali Acc: 0.939 Test Loss: 0.309 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 23.00329828262329
Epoch: 37, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.356 Vali Acc: 0.935 Test Loss: 0.356 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 23.173465967178345
Epoch: 38, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.355 Vali Acc: 0.949 Test Loss: 0.355 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 23.56175923347473
Epoch: 39, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 22.802865028381348
Epoch: 40, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 23.21829605102539
Epoch: 41, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 42 cost time: 23.76240634918213
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972143).  Saving model ...
Epoch: 43 cost time: 23.64103412628174
Epoch: 43, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 21.953845977783203
Epoch: 44, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.347 Vali Acc: 0.947 Test Loss: 0.347 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 22.717250108718872
Epoch: 45, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 22.784301042556763
Epoch: 46, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 23.915988206863403
Epoch: 47, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 22.965617656707764
Epoch: 48, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 24.328012228012085
Epoch: 49, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 23.079535007476807
Epoch: 50, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 24.125368356704712
Epoch: 51, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.963 Test Loss: 0.214 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 23.84598660469055
Epoch: 52, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.257 Vali Acc: 0.957 Test Loss: 0.257 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma73_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         55                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.689732313156128
Epoch: 1, Steps: 89 | Train Loss: 2.035 Vali Loss: 1.057 Vali Acc: 0.726 Test Loss: 1.057 Test Acc: 0.726
Validation loss decreased (inf --> -0.726313).  Saving model ...
Epoch: 2 cost time: 23.62207818031311
Epoch: 2, Steps: 89 | Train Loss: 0.758 Vali Loss: 0.586 Vali Acc: 0.827 Test Loss: 0.586 Test Acc: 0.827
Validation loss decreased (-0.726313 --> -0.826596).  Saving model ...
Epoch: 3 cost time: 24.505173683166504
Epoch: 3, Steps: 89 | Train Loss: 0.426 Vali Loss: 0.413 Vali Acc: 0.882 Test Loss: 0.413 Test Acc: 0.882
Validation loss decreased (-0.826596 --> -0.882308).  Saving model ...
Epoch: 4 cost time: 23.721989154815674
Epoch: 4, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.305 Vali Acc: 0.916 Test Loss: 0.305 Test Acc: 0.916
Validation loss decreased (-0.882308 --> -0.916431).  Saving model ...
Epoch: 5 cost time: 24.673577308654785
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
Validation loss decreased (-0.916431 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 24.47874689102173
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.227 Vali Acc: 0.931 Test Loss: 0.227 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.608765840530396
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
Validation loss decreased (-0.938716 --> -0.938716).  Saving model ...
Epoch: 8 cost time: 22.57040572166443
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.938716 --> -0.949162).  Saving model ...
Epoch: 9 cost time: 23.04741597175598
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.68248748779297
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.949162 --> -0.950555).  Saving model ...
Epoch: 11 cost time: 22.784173011779785
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.961698).  Saving model ...
Epoch: 12 cost time: 22.296117544174194
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.961698 --> -0.965180).  Saving model ...
Epoch: 13 cost time: 23.134601354599
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.402124404907227
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.94413709640503
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966572).  Saving model ...
Epoch: 16 cost time: 23.816872596740723
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.91715168952942
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 18 cost time: 22.962310314178467
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 23.698119401931763
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 23.601118087768555
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 22.942085027694702
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 22.712462186813354
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972143).  Saving model ...
Epoch: 23 cost time: 23.325854063034058
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 24.64461064338684
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 23.338964223861694
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 23.62948513031006
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
Validation loss decreased (-0.972143 --> -0.972143).  Saving model ...
Epoch: 27 cost time: 24.085989236831665
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 25.28975009918213
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 23.60535216331482
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 23.726417303085327
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 27.906491994857788
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 23.783632516860962
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.966 Test Loss: 0.178 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 22.79525327682495
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 22.67583656311035
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 22.875123977661133
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 21.45664930343628
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         37                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 24.47430181503296
Epoch: 1, Steps: 89 | Train Loss: 2.407 Vali Loss: 1.487 Vali Acc: 0.662 Test Loss: 1.487 Test Acc: 0.662
Validation loss decreased (inf --> -0.662241).  Saving model ...
Epoch: 2 cost time: 23.446560621261597
Epoch: 2, Steps: 89 | Train Loss: 1.048 Vali Loss: 0.745 Vali Acc: 0.802 Test Loss: 0.745 Test Acc: 0.802
Validation loss decreased (-0.662241 --> -0.802221).  Saving model ...
Epoch: 3 cost time: 22.220328092575073
Epoch: 3, Steps: 89 | Train Loss: 0.537 Vali Loss: 0.466 Vali Acc: 0.878 Test Loss: 0.466 Test Acc: 0.878
Validation loss decreased (-0.802221 --> -0.878129).  Saving model ...
Epoch: 4 cost time: 22.304478645324707
Epoch: 4, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.316 Vali Acc: 0.913 Test Loss: 0.316 Test Acc: 0.913
Validation loss decreased (-0.878129 --> -0.912949).  Saving model ...
Epoch: 5 cost time: 22.78256058692932
Epoch: 5, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.266 Vali Acc: 0.927 Test Loss: 0.266 Test Acc: 0.927
Validation loss decreased (-0.912949 --> -0.926878).  Saving model ...
Epoch: 6 cost time: 22.942626237869263
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
Validation loss decreased (-0.926878 --> -0.942895).  Saving model ...
Epoch: 7 cost time: 22.33786678314209
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.061424016952515
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.942895 --> -0.956126).  Saving model ...
Epoch: 9 cost time: 23.403977155685425
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.639782428741455
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 23.284838438034058
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.47269082069397
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.75046944618225
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.961698).  Saving model ...
Epoch: 14 cost time: 24.11956524848938
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.074598789215088
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.961698 --> -0.965180).  Saving model ...
Epoch: 16 cost time: 25.484182834625244
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.852659702301025
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.67594814300537
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 19 cost time: 23.618661880493164
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968661).  Saving model ...
Epoch: 20 cost time: 24.91711163520813
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.549696922302246
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 23.11597228050232
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 23.29081654548645
Epoch: 23, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 24.190065145492554
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.954 Test Loss: 0.237 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 24.345100164413452
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 24.47768235206604
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 23.922441959381104
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 24.06982183456421
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 24.284543752670288
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.968661 --> -0.969358).  Saving model ...
Epoch: 30 cost time: 23.558897018432617
Epoch: 30, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 25.69582486152649
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 24.306516647338867
Epoch: 32, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 24.301512479782104
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 23.422656059265137
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 35 cost time: 24.717734336853027
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.972 Test Loss: 0.164 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972143).  Saving model ...
Epoch: 36 cost time: 25.925644874572754
Epoch: 36, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 23.072096347808838
Epoch: 37, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.494 Vali Acc: 0.916 Test Loss: 0.494 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 23.527512311935425
Epoch: 38, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.379 Vali Acc: 0.939 Test Loss: 0.379 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 23.636787176132202
Epoch: 39, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.261 Vali Acc: 0.958 Test Loss: 0.261 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 21.472392082214355
Epoch: 40, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 22.645076990127563
Epoch: 41, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.962 Test Loss: 0.261 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 21.91841959953308
Epoch: 42, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.421 Vali Acc: 0.937 Test Loss: 0.421 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 23.03754687309265
Epoch: 43, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.267 Vali Acc: 0.961 Test Loss: 0.267 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 24.76290774345398
Epoch: 44, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.326 Vali Acc: 0.958 Test Loss: 0.326 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 22.861446142196655
Epoch: 45, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.271 Vali Acc: 0.964 Test Loss: 0.271 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.247117519378662
Epoch: 1, Steps: 89 | Train Loss: 2.759 Vali Loss: 2.461 Vali Acc: 0.260 Test Loss: 2.461 Test Acc: 0.260
Validation loss decreased (inf --> -0.260421).  Saving model ...
Epoch: 2 cost time: 24.614073991775513
Epoch: 2, Steps: 89 | Train Loss: 1.770 Vali Loss: 1.314 Vali Acc: 0.630 Test Loss: 1.314 Test Acc: 0.630
Validation loss decreased (-0.260421 --> -0.629513).  Saving model ...
Epoch: 3 cost time: 23.63830041885376
Epoch: 3, Steps: 89 | Train Loss: 0.785 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
Validation loss decreased (-0.629513 --> -0.855148).  Saving model ...
Epoch: 4 cost time: 24.167977809906006
Epoch: 4, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.330 Vali Acc: 0.903 Test Loss: 0.330 Test Acc: 0.903
Validation loss decreased (-0.855148 --> -0.902504).  Saving model ...
Epoch: 5 cost time: 23.588961601257324
Epoch: 5, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (-0.902504 --> -0.925485).  Saving model ...
Epoch: 6 cost time: 24.676366090774536
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.925485 --> -0.949162).  Saving model ...
Epoch: 7 cost time: 25.030779600143433
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.949162 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 24.33505654335022
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.961698).  Saving model ...
Epoch: 9 cost time: 21.95849609375
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962394).  Saving model ...
Epoch: 10 cost time: 24.858609676361084
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.97455072402954
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.003713130950928
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963787).  Saving model ...
Epoch: 13 cost time: 24.094491004943848
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.932482719421387
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.967269).  Saving model ...
Epoch: 15 cost time: 24.193607330322266
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 24.706063985824585
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.68913221359253
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 23.3589608669281
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968661).  Saving model ...
Epoch: 19 cost time: 24.760157346725464
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 22.59030032157898
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 22.949727535247803
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 23.576597929000854
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.966 Test Loss: 0.184 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 24.64398217201233
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.960 Test Loss: 0.210 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 25.152917623519897
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 24.359002590179443
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 23.629982471466064
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 23.789944171905518
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 24.08216643333435
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.970750).  Saving model ...
Epoch: 29 cost time: 24.69708490371704
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 23.96353507041931
Epoch: 30, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 23.89486002922058
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 23.473414659500122
Epoch: 32, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.419 Vali Acc: 0.941 Test Loss: 0.419 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 24.118951320648193
Epoch: 33, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.297 Vali Acc: 0.945 Test Loss: 0.297 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 23.97256350517273
Epoch: 34, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.405 Vali Acc: 0.933 Test Loss: 0.405 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 23.537238597869873
Epoch: 35, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.962 Test Loss: 0.198 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 23.679572343826294
Epoch: 36, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.955 Test Loss: 0.285 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 24.83415651321411
Epoch: 37, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.253 Vali Acc: 0.960 Test Loss: 0.253 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 23.34518837928772
Epoch: 38, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.273 Vali Acc: 0.959 Test Loss: 0.273 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.905454397201538
Epoch: 1, Steps: 89 | Train Loss: 2.788 Vali Loss: 2.664 Vali Acc: 0.205 Test Loss: 2.664 Test Acc: 0.205
Validation loss decreased (inf --> -0.204709).  Saving model ...
Epoch: 2 cost time: 22.120397090911865
Epoch: 2, Steps: 89 | Train Loss: 1.863 Vali Loss: 1.640 Vali Acc: 0.552 Test Loss: 1.640 Test Acc: 0.552
Validation loss decreased (-0.204709 --> -0.551516).  Saving model ...
Epoch: 3 cost time: 23.99063277244568
Epoch: 3, Steps: 89 | Train Loss: 0.911 Vali Loss: 0.783 Vali Acc: 0.774 Test Loss: 0.783 Test Acc: 0.774
Validation loss decreased (-0.551516 --> -0.774365).  Saving model ...
Epoch: 4 cost time: 22.576823711395264
Epoch: 4, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.507 Vali Acc: 0.846 Test Loss: 0.507 Test Acc: 0.846
Validation loss decreased (-0.774365 --> -0.846095).  Saving model ...
Epoch: 5 cost time: 22.84903383255005
Epoch: 5, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.436 Vali Acc: 0.882 Test Loss: 0.436 Test Acc: 0.882
Validation loss decreased (-0.846095 --> -0.881611).  Saving model ...
Epoch: 6 cost time: 22.63419485092163
Epoch: 6, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.314 Vali Acc: 0.912 Test Loss: 0.314 Test Acc: 0.912
Validation loss decreased (-0.881611 --> -0.911557).  Saving model ...
Epoch: 7 cost time: 22.85906195640564
Epoch: 7, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.269 Vali Acc: 0.920 Test Loss: 0.269 Test Acc: 0.920
Validation loss decreased (-0.911557 --> -0.919914).  Saving model ...
Epoch: 8 cost time: 23.226550579071045
Epoch: 8, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.224 Vali Acc: 0.935 Test Loss: 0.224 Test Acc: 0.935
Validation loss decreased (-0.919914 --> -0.934538).  Saving model ...
Epoch: 9 cost time: 23.085289478302002
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.202 Vali Acc: 0.945 Test Loss: 0.202 Test Acc: 0.945
Validation loss decreased (-0.934538 --> -0.944984).  Saving model ...
Epoch: 10 cost time: 22.58253502845764
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.402601718902588
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.260 Vali Acc: 0.931 Test Loss: 0.260 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.901803016662598
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
Validation loss decreased (-0.944984 --> -0.950555).  Saving model ...
Epoch: 13 cost time: 23.308157205581665
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.959608).  Saving model ...
Epoch: 14 cost time: 23.287957668304443
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
Validation loss decreased (-0.959608 --> -0.961001).  Saving model ...
Epoch: 15 cost time: 23.97136163711548
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 23.571542024612427
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.997947931289673
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 24.939286470413208
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 23.608057260513306
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 23.96241044998169
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 23.18074941635132
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.953 Test Loss: 0.207 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 22.89742660522461
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.238 Vali Acc: 0.957 Test Loss: 0.238 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 22.4136061668396
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.960 Test Loss: 0.232 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 22.618703842163086
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.88759160041809
Epoch: 1, Steps: 89 | Train Loss: 2.782 Vali Loss: 2.730 Vali Acc: 0.172 Test Loss: 2.730 Test Acc: 0.172
Validation loss decreased (inf --> -0.171978).  Saving model ...
Epoch: 2 cost time: 22.779065370559692
Epoch: 2, Steps: 89 | Train Loss: 1.857 Vali Loss: 1.743 Vali Acc: 0.483 Test Loss: 1.743 Test Acc: 0.483
Validation loss decreased (-0.171978 --> -0.483269).  Saving model ...
Epoch: 3 cost time: 21.518351316452026
Epoch: 3, Steps: 89 | Train Loss: 0.959 Vali Loss: 1.048 Vali Acc: 0.677 Test Loss: 1.048 Test Acc: 0.677
Validation loss decreased (-0.483269 --> -0.676870).  Saving model ...
Epoch: 4 cost time: 22.53146266937256
Epoch: 4, Steps: 89 | Train Loss: 0.528 Vali Loss: 0.765 Vali Acc: 0.762 Test Loss: 0.765 Test Acc: 0.762
Validation loss decreased (-0.676870 --> -0.761831).  Saving model ...
Epoch: 5 cost time: 22.160322904586792
Epoch: 5, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
Validation loss decreased (-0.761831 --> -0.869772).  Saving model ...
Epoch: 6 cost time: 21.854870319366455
Epoch: 6, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
Validation loss decreased (-0.869772 --> -0.889272).  Saving model ...
Epoch: 7 cost time: 22.078212022781372
Epoch: 7, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
Validation loss decreased (-0.889272 --> -0.899718).  Saving model ...
Epoch: 8 cost time: 21.96436095237732
Epoch: 8, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.288 Vali Acc: 0.921 Test Loss: 0.288 Test Acc: 0.921
Validation loss decreased (-0.899718 --> -0.921306).  Saving model ...
Epoch: 9 cost time: 22.631988048553467
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.297 Vali Acc: 0.916 Test Loss: 0.297 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.035704851150513
Epoch: 10, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.46220636367798
Epoch: 11, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.465 Vali Acc: 0.893 Test Loss: 0.465 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.182128429412842
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.261 Vali Acc: 0.936 Test Loss: 0.261 Test Acc: 0.936
Validation loss decreased (-0.921306 --> -0.935931).  Saving model ...
Epoch: 13 cost time: 23.17846989631653
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.935931 --> -0.936627).  Saving model ...
Epoch: 14 cost time: 24.143545150756836
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.241 Vali Acc: 0.931 Test Loss: 0.241 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.25859761238098
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.249 Vali Acc: 0.929 Test Loss: 0.249 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 22.663665771484375
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.936627 --> -0.949859).  Saving model ...
Epoch: 17 cost time: 21.26750922203064
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 22.411979913711548
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 23.52855682373047
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.945 Test Loss: 0.225 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 23.001984119415283
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 23.22005558013916
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.949859 --> -0.957519).  Saving model ...
Epoch: 22 cost time: 22.994198322296143
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.947 Test Loss: 0.238 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 21.786879301071167
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 22.686063766479492
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 23.00866174697876
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.245 Vali Acc: 0.946 Test Loss: 0.245 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 23.26876974105835
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 23.126587867736816
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 21.83468461036682
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 23.03836679458618
Epoch: 29, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 22.273863792419434
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.419 Vali Acc: 0.932 Test Loss: 0.419 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 22.35143542289734
Epoch: 31, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 23.231652975082397
Epoch: 1, Steps: 89 | Train Loss: 2.811 Vali Loss: 2.695 Vali Acc: 0.270 Test Loss: 2.695 Test Acc: 0.270
Validation loss decreased (inf --> -0.270168).  Saving model ...
Epoch: 2 cost time: 21.540363788604736
Epoch: 2, Steps: 89 | Train Loss: 1.951 Vali Loss: 1.754 Vali Acc: 0.476 Test Loss: 1.754 Test Acc: 0.476
Validation loss decreased (-0.270168 --> -0.476306).  Saving model ...
Epoch: 3 cost time: 21.910434246063232
Epoch: 3, Steps: 89 | Train Loss: 1.038 Vali Loss: 1.149 Vali Acc: 0.636 Test Loss: 1.149 Test Acc: 0.636
Validation loss decreased (-0.476306 --> -0.635782).  Saving model ...
Epoch: 4 cost time: 21.145424604415894
Epoch: 4, Steps: 89 | Train Loss: 0.582 Vali Loss: 0.837 Vali Acc: 0.718 Test Loss: 0.837 Test Acc: 0.718
Validation loss decreased (-0.635782 --> -0.717958).  Saving model ...
Epoch: 5 cost time: 21.53416681289673
Epoch: 5, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
Validation loss decreased (-0.717958 --> -0.816150).  Saving model ...
Epoch: 6 cost time: 21.152084350585938
Epoch: 6, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.465 Vali Acc: 0.863 Test Loss: 0.465 Test Acc: 0.863
Validation loss decreased (-0.816150 --> -0.862809).  Saving model ...
Epoch: 7 cost time: 23.74648380279541
Epoch: 7, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.392 Vali Acc: 0.892 Test Loss: 0.392 Test Acc: 0.892
Validation loss decreased (-0.862809 --> -0.892057).  Saving model ...
Epoch: 8 cost time: 21.40701127052307
Epoch: 8, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.382 Vali Acc: 0.888 Test Loss: 0.382 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.319132328033447
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.87102961540222
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.389 Vali Acc: 0.887 Test Loss: 0.389 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.796964168548584
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.422 Vali Acc: 0.887 Test Loss: 0.422 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 21.730682849884033
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.353 Vali Acc: 0.898 Test Loss: 0.353 Test Acc: 0.898
Validation loss decreased (-0.892057 --> -0.898325).  Saving model ...
Epoch: 13 cost time: 22.363022327423096
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
Validation loss decreased (-0.898325 --> -0.910860).  Saving model ...
Epoch: 14 cost time: 22.895442724227905
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.235536575317383
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.348 Vali Acc: 0.914 Test Loss: 0.348 Test Acc: 0.914
Validation loss decreased (-0.910860 --> -0.913646).  Saving model ...
Epoch: 16 cost time: 25.428282260894775
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
Validation loss decreased (-0.913646 --> -0.924788).  Saving model ...
Epoch: 17 cost time: 22.399150609970093
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
Validation loss decreased (-0.924788 --> -0.936627).  Saving model ...
Epoch: 18 cost time: 25.212818384170532
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
Validation loss decreased (-0.936627 --> -0.942198).  Saving model ...
Epoch: 19 cost time: 22.765647172927856
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.261 Vali Acc: 0.943 Test Loss: 0.261 Test Acc: 0.943
Validation loss decreased (-0.942198 --> -0.942894).  Saving model ...
Epoch: 20 cost time: 23.69527316093445
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.280 Vali Acc: 0.942 Test Loss: 0.280 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 24.051420211791992
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.267 Vali Acc: 0.939 Test Loss: 0.267 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 22.32536482810974
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.325 Vali Acc: 0.929 Test Loss: 0.325 Test Acc: 0.929
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 23.74821400642395
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.431 Vali Acc: 0.912 Test Loss: 0.431 Test Acc: 0.912
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 23.681597471237183
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 23.60602879524231
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.275 Vali Acc: 0.946 Test Loss: 0.275 Test Acc: 0.946
Validation loss decreased (-0.942894 --> -0.946376).  Saving model ...
Epoch: 26 cost time: 22.93547248840332
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.332 Vali Acc: 0.925 Test Loss: 0.332 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 22.67266011238098
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.256 Vali Acc: 0.952 Test Loss: 0.256 Test Acc: 0.952
Validation loss decreased (-0.946376 --> -0.951947).  Saving model ...
Epoch: 28 cost time: 22.619876861572266
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.292 Vali Acc: 0.948 Test Loss: 0.292 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 21.917219161987305
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.279 Vali Acc: 0.948 Test Loss: 0.279 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 22.561788082122803
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.335 Vali Acc: 0.928 Test Loss: 0.335 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 23.6623375415802
Epoch: 31, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.295 Vali Acc: 0.941 Test Loss: 0.295 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 22.958198308944702
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.305 Vali Acc: 0.938 Test Loss: 0.305 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 21.075089693069458
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.270 Vali Acc: 0.952 Test Loss: 0.270 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 21.69890069961548
Epoch: 34, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.285 Vali Acc: 0.945 Test Loss: 0.285 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 21.65432071685791
Epoch: 35, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.328 Vali Acc: 0.943 Test Loss: 0.328 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 24.24659490585327
Epoch: 36, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.402 Vali Acc: 0.929 Test Loss: 0.402 Test Acc: 0.929
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 21.720025777816772
Epoch: 37, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.327 Vali Acc: 0.948 Test Loss: 0.327 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9519498607242339
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 22.160313367843628
Epoch: 1, Steps: 89 | Train Loss: 2.827 Vali Loss: 2.723 Vali Acc: 0.185 Test Loss: 2.723 Test Acc: 0.185
Validation loss decreased (inf --> -0.185210).  Saving model ...
Epoch: 2 cost time: 20.942304611206055
Epoch: 2, Steps: 89 | Train Loss: 2.030 Vali Loss: 1.768 Vali Acc: 0.470 Test Loss: 1.768 Test Acc: 0.470
Validation loss decreased (-0.185210 --> -0.470038).  Saving model ...
Epoch: 3 cost time: 21.26387882232666
Epoch: 3, Steps: 89 | Train Loss: 1.098 Vali Loss: 1.238 Vali Acc: 0.623 Test Loss: 1.238 Test Acc: 0.623
Validation loss decreased (-0.470038 --> -0.622550).  Saving model ...
Epoch: 4 cost time: 20.455730438232422
Epoch: 4, Steps: 89 | Train Loss: 0.638 Vali Loss: 0.986 Vali Acc: 0.692 Test Loss: 0.986 Test Acc: 0.692
Validation loss decreased (-0.622550 --> -0.691494).  Saving model ...
Epoch: 5 cost time: 20.916524410247803
Epoch: 5, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.858 Vali Acc: 0.745 Test Loss: 0.858 Test Acc: 0.745
Validation loss decreased (-0.691494 --> -0.745117).  Saving model ...
Epoch: 6 cost time: 21.66062831878662
Epoch: 6, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
Validation loss decreased (-0.745117 --> -0.806400).  Saving model ...
Epoch: 7 cost time: 20.93798065185547
Epoch: 7, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.485 Vali Acc: 0.866 Test Loss: 0.485 Test Acc: 0.866
Validation loss decreased (-0.806400 --> -0.865594).  Saving model ...
Epoch: 8 cost time: 20.714884281158447
Epoch: 8, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.503 Vali Acc: 0.843 Test Loss: 0.503 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.70843005180359
Epoch: 9, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.478 Vali Acc: 0.865 Test Loss: 0.478 Test Acc: 0.865
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 22.73302912712097
Epoch: 10, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.450 Vali Acc: 0.876 Test Loss: 0.450 Test Acc: 0.876
Validation loss decreased (-0.865594 --> -0.876040).  Saving model ...
Epoch: 11 cost time: 21.35630440711975
Epoch: 11, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.454 Vali Acc: 0.874 Test Loss: 0.454 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.709324598312378
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.332 Vali Acc: 0.920 Test Loss: 0.332 Test Acc: 0.920
Validation loss decreased (-0.876040 --> -0.919913).  Saving model ...
Epoch: 13 cost time: 21.968502044677734
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.355 Vali Acc: 0.905 Test Loss: 0.355 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.89549994468689
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 22.626442193984985
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.350 Vali Acc: 0.903 Test Loss: 0.350 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 24.28427028656006
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.405314922332764
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.316 Vali Acc: 0.912 Test Loss: 0.316 Test Acc: 0.912
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.18128776550293
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.299 Vali Acc: 0.926 Test Loss: 0.299 Test Acc: 0.926
Validation loss decreased (-0.919913 --> -0.926181).  Saving model ...
Epoch: 19 cost time: 24.333253145217896
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.388 Vali Acc: 0.906 Test Loss: 0.388 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 23.5541512966156
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.284 Vali Acc: 0.936 Test Loss: 0.284 Test Acc: 0.936
Validation loss decreased (-0.926181 --> -0.935930).  Saving model ...
Epoch: 21 cost time: 21.350143432617188
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.325 Vali Acc: 0.923 Test Loss: 0.325 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 22.13555121421814
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 21.751021146774292
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.403 Vali Acc: 0.912 Test Loss: 0.403 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 19.957537174224854
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.303 Vali Acc: 0.939 Test Loss: 0.303 Test Acc: 0.939
Validation loss decreased (-0.935930 --> -0.939412).  Saving model ...
Epoch: 25 cost time: 21.61091709136963
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.323 Vali Acc: 0.939 Test Loss: 0.323 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 23.343848943710327
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.305 Vali Acc: 0.932 Test Loss: 0.305 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 22.708452939987183
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.368 Vali Acc: 0.924 Test Loss: 0.368 Test Acc: 0.924
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 20.368261575698853
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.355 Vali Acc: 0.928 Test Loss: 0.355 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 21.819950819015503
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.330 Vali Acc: 0.938 Test Loss: 0.330 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 21.79095482826233
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.351 Vali Acc: 0.928 Test Loss: 0.351 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 22.820216178894043
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 20.558339834213257
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.367 Vali Acc: 0.930 Test Loss: 0.367 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 22.571309328079224
Epoch: 33, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 21.047009706497192
Epoch: 34, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.305 Vali Acc: 0.946 Test Loss: 0.305 Test Acc: 0.946
Validation loss decreased (-0.939412 --> -0.945679).  Saving model ...
Epoch: 35 cost time: 21.961078882217407
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.376 Vali Acc: 0.929 Test Loss: 0.376 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 21.675982236862183
Epoch: 36, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.347 Vali Acc: 0.942 Test Loss: 0.347 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 21.521660327911377
Epoch: 37, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.339 Vali Acc: 0.945 Test Loss: 0.339 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 21.539125680923462
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.388 Vali Acc: 0.939 Test Loss: 0.388 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 22.875706672668457
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.442 Vali Acc: 0.931 Test Loss: 0.442 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 22.674035787582397
Epoch: 40, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.376 Vali Acc: 0.939 Test Loss: 0.376 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 21.546571493148804
Epoch: 41, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.349 Vali Acc: 0.948 Test Loss: 0.349 Test Acc: 0.948
Validation loss decreased (-0.945679 --> -0.947768).  Saving model ...
Epoch: 42 cost time: 22.57456350326538
Epoch: 42, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.352 Vali Acc: 0.946 Test Loss: 0.352 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 22.8098304271698
Epoch: 43, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.445 Vali Acc: 0.935 Test Loss: 0.445 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 21.178927898406982
Epoch: 44, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.331 Vali Acc: 0.945 Test Loss: 0.331 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 23.424825429916382
Epoch: 45, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.480 Vali Acc: 0.935 Test Loss: 0.480 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 22.160679817199707
Epoch: 46, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.476 Vali Acc: 0.919 Test Loss: 0.476 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 22.00225830078125
Epoch: 47, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.388 Vali Acc: 0.941 Test Loss: 0.388 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 22.022902011871338
Epoch: 48, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.394 Vali Acc: 0.940 Test Loss: 0.394 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 24.47657346725464
Epoch: 49, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.413 Vali Acc: 0.938 Test Loss: 0.413 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 23.12936806678772
Epoch: 50, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.386 Vali Acc: 0.941 Test Loss: 0.386 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 22.307841062545776
Epoch: 51, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.374 Vali Acc: 0.951 Test Loss: 0.374 Test Acc: 0.951
Validation loss decreased (-0.947768 --> -0.951250).  Saving model ...
Epoch: 52 cost time: 22.68927550315857
Epoch: 52, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.418 Vali Acc: 0.943 Test Loss: 0.418 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 23.419521808624268
Epoch: 53, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.348 Vali Acc: 0.946 Test Loss: 0.348 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 21.72617506980896
Epoch: 54, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.548 Vali Acc: 0.923 Test Loss: 0.548 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 22.1602144241333
Epoch: 55, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.424 Vali Acc: 0.944 Test Loss: 0.424 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 23.649691104888916
Epoch: 56, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.373 Vali Acc: 0.951 Test Loss: 0.373 Test Acc: 0.951
Validation loss decreased (-0.951250 --> -0.951250).  Saving model ...
Epoch: 57 cost time: 21.836995840072632
Epoch: 57, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.467 Vali Acc: 0.935 Test Loss: 0.467 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 21.14311456680298
Epoch: 58, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.409 Vali Acc: 0.948 Test Loss: 0.409 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 21.653433799743652
Epoch: 59, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.467 Vali Acc: 0.945 Test Loss: 0.467 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 23.273120880126953
Epoch: 60, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.579 Vali Acc: 0.927 Test Loss: 0.579 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 22.095252513885498
Epoch: 61, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.456 Vali Acc: 0.955 Test Loss: 0.456 Test Acc: 0.955
Validation loss decreased (-0.951250 --> -0.954731).  Saving model ...
Epoch: 62 cost time: 23.31609797477722
Epoch: 62, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.422 Vali Acc: 0.955 Test Loss: 0.422 Test Acc: 0.955
Validation loss decreased (-0.954731 --> -0.954731).  Saving model ...
Epoch: 63 cost time: 23.300787687301636
Epoch: 63, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.421 Vali Acc: 0.951 Test Loss: 0.421 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 21.253255605697632
Epoch: 64, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.423 Vali Acc: 0.937 Test Loss: 0.423 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 23.076157569885254
Epoch: 65, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.450 Vali Acc: 0.946 Test Loss: 0.450 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 21.74813747406006
Epoch: 66, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.434 Vali Acc: 0.951 Test Loss: 0.434 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 21.665580987930298
Epoch: 67, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.472 Vali Acc: 0.946 Test Loss: 0.472 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 20.22081708908081
Epoch: 68, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.431 Vali Acc: 0.948 Test Loss: 0.431 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 22.56848430633545
Epoch: 69, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.429 Vali Acc: 0.954 Test Loss: 0.429 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 23.754048109054565
Epoch: 70, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.459 Vali Acc: 0.943 Test Loss: 0.459 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 19.262353897094727
Epoch: 71, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.515 Vali Acc: 0.939 Test Loss: 0.515 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 20.838462352752686
Epoch: 72, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.388 Vali Acc: 0.957 Test Loss: 0.388 Test Acc: 0.957
Validation loss decreased (-0.954731 --> -0.956821).  Saving model ...
Epoch: 73 cost time: 20.458852767944336
Epoch: 73, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.461 Vali Acc: 0.952 Test Loss: 0.461 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 21.938944816589355
Epoch: 74, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.387 Vali Acc: 0.953 Test Loss: 0.387 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 21.152774572372437
Epoch: 75, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.372 Vali Acc: 0.951 Test Loss: 0.372 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 20.934680700302124
Epoch: 76, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 22.182633638381958
Epoch: 77, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.708 Vali Acc: 0.920 Test Loss: 0.708 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 22.013624906539917
Epoch: 78, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.946 Test Loss: 0.490 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 21.169241666793823
Epoch: 79, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.606 Vali Acc: 0.928 Test Loss: 0.606 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 21.369223594665527
Epoch: 80, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.534 Vali Acc: 0.940 Test Loss: 0.534 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 23.526416778564453
Epoch: 81, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.555 Vali Acc: 0.939 Test Loss: 0.555 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 21.102590799331665
Epoch: 82, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.510 Vali Acc: 0.949 Test Loss: 0.510 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9568245125348189
model parameter : 183892
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
fourier enhanced block used!
modes=32, index=[2, 3, 4, 8, 13, 20, 22, 23, 28, 30, 31, 32, 34, 35, 39, 43, 46, 47, 51, 53, 58, 59, 64, 73, 74, 76, 79, 82, 84, 87, 88, 89]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 41, 42]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 29, 30, 33, 37, 38, 40, 41, 42, 43, 44]
modes_kv=32, index_kv=[1, 5, 8, 12, 15, 20, 22, 25, 26, 28, 30, 31, 34, 36, 37, 40, 45, 48, 51, 54, 58, 63, 64, 65, 66, 71, 78, 79, 81, 82, 83, 90]
>>>>>>>start training : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 25.594123125076294
Epoch: 1, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.996 Vali Acc: 0.049 Test Loss: 2.996 Test Acc: 0.049
Validation loss decreased (inf --> -0.049413).  Saving model ...
Epoch: 2 cost time: 20.59470558166504
Epoch: 2, Steps: 89 | Train Loss: 2.996 Vali Loss: 2.995 Vali Acc: 0.049 Test Loss: 2.995 Test Acc: 0.049
Validation loss decreased (-0.049413 --> -0.049413).  Saving model ...
Epoch: 3 cost time: 21.340900421142578
Epoch: 3, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.995 Vali Acc: 0.065 Test Loss: 2.995 Test Acc: 0.065
Validation loss decreased (-0.049413 --> -0.064733).  Saving model ...
Epoch: 4 cost time: 21.300925493240356
Epoch: 4, Steps: 89 | Train Loss: 2.995 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 5 cost time: 21.57835841178894
Epoch: 5, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.994 Vali Acc: 0.065 Test Loss: 2.994 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 6 cost time: 21.263944387435913
Epoch: 6, Steps: 89 | Train Loss: 2.994 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 7 cost time: 22.092686653137207
Epoch: 7, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.993 Vali Acc: 0.065 Test Loss: 2.993 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 8 cost time: 21.795881509780884
Epoch: 8, Steps: 89 | Train Loss: 2.993 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 9 cost time: 22.927136182785034
Epoch: 9, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.992 Vali Acc: 0.065 Test Loss: 2.992 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 10 cost time: 22.693898916244507
Epoch: 10, Steps: 89 | Train Loss: 2.992 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 11 cost time: 22.014645099639893
Epoch: 11, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 12 cost time: 21.430933237075806
Epoch: 12, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.991 Vali Acc: 0.065 Test Loss: 2.991 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 13 cost time: 23.1213595867157
Epoch: 13, Steps: 89 | Train Loss: 2.991 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 14 cost time: 21.670730113983154
Epoch: 14, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 15 cost time: 23.045605897903442
Epoch: 15, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.990 Vali Acc: 0.065 Test Loss: 2.990 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 16 cost time: 22.897258758544922
Epoch: 16, Steps: 89 | Train Loss: 2.990 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 17 cost time: 23.483530282974243
Epoch: 17, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 18 cost time: 21.984404802322388
Epoch: 18, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 19 cost time: 23.59989047050476
Epoch: 19, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.989 Vali Acc: 0.065 Test Loss: 2.989 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 20 cost time: 24.023555278778076
Epoch: 20, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 21 cost time: 21.894609212875366
Epoch: 21, Steps: 89 | Train Loss: 2.989 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 22 cost time: 22.340566873550415
Epoch: 22, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 23 cost time: 21.354964017868042
Epoch: 23, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 24 cost time: 20.489601373672485
Epoch: 24, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 25 cost time: 21.591370344161987
Epoch: 25, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 26 cost time: 21.565215587615967
Epoch: 26, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.988 Vali Acc: 0.065 Test Loss: 2.988 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 27 cost time: 21.894014835357666
Epoch: 27, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 28 cost time: 21.277210235595703
Epoch: 28, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 29 cost time: 23.58988666534424
Epoch: 29, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 30 cost time: 21.223834991455078
Epoch: 30, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 31 cost time: 23.46354031562805
Epoch: 31, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 32 cost time: 23.834975481033325
Epoch: 32, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 33 cost time: 21.499131202697754
Epoch: 33, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 34 cost time: 22.366098642349243
Epoch: 34, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 35 cost time: 22.278485536575317
Epoch: 35, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 36 cost time: 21.570173025131226
Epoch: 36, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 37 cost time: 21.404476404190063
Epoch: 37, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 38 cost time: 22.20906162261963
Epoch: 38, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 39 cost time: 20.678760290145874
Epoch: 39, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 40 cost time: 19.52510690689087
Epoch: 40, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 41 cost time: 21.036120891571045
Epoch: 41, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 42 cost time: 23.192716598510742
Epoch: 42, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 43 cost time: 21.95164656639099
Epoch: 43, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 44 cost time: 21.322101354599
Epoch: 44, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 45 cost time: 22.659605264663696
Epoch: 45, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 46 cost time: 22.436078786849976
Epoch: 46, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 20.970449209213257
Epoch: 47, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 48 cost time: 21.692878484725952
Epoch: 48, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 21.777724266052246
Epoch: 49, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 21.219820976257324
Epoch: 50, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 51 cost time: 20.118497610092163
Epoch: 51, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 22.300275564193726
Epoch: 52, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 53 cost time: 22.604499340057373
Epoch: 53, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 22.690277338027954
Epoch: 54, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 21.4942147731781
Epoch: 55, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 25.077987909317017
Epoch: 56, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 21.600245237350464
Epoch: 57, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 21.76628541946411
Epoch: 58, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 22.345165252685547
Epoch: 59, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 21.136325359344482
Epoch: 60, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 61 cost time: 20.67680788040161
Epoch: 61, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 20.52605891227722
Epoch: 62, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 63 cost time: 22.938039779663086
Epoch: 63, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 21.016149520874023
Epoch: 64, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 20.9870867729187
Epoch: 65, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 20.321892261505127
Epoch: 66, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 67 cost time: 21.123213291168213
Epoch: 67, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 68 cost time: 21.15644121170044
Epoch: 68, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 21.409796953201294
Epoch: 69, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 22.73031234741211
Epoch: 70, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 20.770716428756714
Epoch: 71, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
Validation loss decreased (-0.064733 --> -0.064733).  Saving model ...
Epoch: 72 cost time: 20.522979974746704
Epoch: 72, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 20.621111631393433
Epoch: 73, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 21.135042905807495
Epoch: 74, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 21.23080325126648
Epoch: 75, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 22.328003406524658
Epoch: 76, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 23.707446336746216
Epoch: 77, Steps: 89 | Train Loss: 2.988 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 22.364679098129272
Epoch: 78, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 22.475605249404907
Epoch: 79, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 22.260474681854248
Epoch: 80, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 24.310072422027588
Epoch: 81, Steps: 89 | Train Loss: 2.987 Vali Loss: 2.987 Vali Acc: 0.065 Test Loss: 2.987 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_FEDformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.06476323119777158
model parameter : 183892
model size : 1.95MB
